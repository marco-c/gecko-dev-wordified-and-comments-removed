#
ifndef
mozilla_FileLocation_h
#
define
mozilla_FileLocation_h
#
include
"
nsString
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIFile
.
h
"
#
include
"
FileUtils
.
h
"
class
nsZipArchive
;
class
nsZipItem
;
namespace
mozilla
{
class
FileLocation
{
public
:
FileLocation
(
)
;
~
FileLocation
(
)
;
FileLocation
(
const
FileLocation
&
aOther
)
;
FileLocation
(
FileLocation
&
&
aOther
)
;
FileLocation
&
operator
=
(
const
FileLocation
&
)
=
default
;
explicit
FileLocation
(
nsIFile
*
aFile
)
;
FileLocation
(
nsIFile
*
aZip
const
char
*
aPath
)
;
FileLocation
(
nsZipArchive
*
aZip
const
char
*
aPath
)
;
FileLocation
(
const
FileLocation
&
aFile
const
char
*
aPath
)
;
void
Init
(
nsIFile
*
aFile
)
;
void
Init
(
nsIFile
*
aZip
const
char
*
aPath
)
;
void
Init
(
nsZipArchive
*
aZip
const
char
*
aPath
)
;
void
GetURIString
(
nsACString
&
aResult
)
const
;
already_AddRefed
<
nsIFile
>
GetBaseFile
(
)
;
nsZipArchive
*
GetBaseZip
(
)
{
return
mBaseZip
;
}
bool
IsZip
(
)
const
{
return
!
mPath
.
IsEmpty
(
)
;
}
void
GetPath
(
nsACString
&
aResult
)
const
{
aResult
=
mPath
;
}
explicit
operator
bool
(
)
const
{
return
mBaseFile
|
|
mBaseZip
;
}
bool
Equals
(
const
FileLocation
&
aFile
)
const
;
class
Data
{
public
:
nsresult
GetSize
(
uint32_t
*
aResult
)
;
nsresult
Copy
(
char
*
aBuf
uint32_t
aLen
)
;
protected
:
friend
class
FileLocation
;
nsZipItem
*
mItem
;
RefPtr
<
nsZipArchive
>
mZip
;
mozilla
:
:
AutoFDClose
mFd
;
}
;
nsresult
GetData
(
Data
&
aData
)
;
private
:
nsCOMPtr
<
nsIFile
>
mBaseFile
;
RefPtr
<
nsZipArchive
>
mBaseZip
;
nsCString
mPath
;
}
;
}
#
endif
