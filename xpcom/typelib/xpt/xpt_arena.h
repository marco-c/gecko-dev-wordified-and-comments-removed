#
ifndef
__xpt_arena_h__
#
define
__xpt_arena_h__
#
include
<
stdlib
.
h
>
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
MemoryReporting
.
h
"
#
include
<
stdint
.
h
>
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
typedef
struct
XPTArena
XPTArena
;
XPTArena
*
XPT_NewArena
(
size_t
block_size8
size_t
block_size1
)
;
void
XPT_DestroyArena
(
XPTArena
*
arena
)
;
void
*
XPT_ArenaCalloc
(
XPTArena
*
arena
size_t
size
size_t
alignment
)
;
size_t
XPT_SizeOfArenaIncludingThis
(
XPTArena
*
arena
MozMallocSizeOf
mallocSizeOf
)
;
#
define
XPT_CALLOC8
(
_arena
_bytes
)
XPT_ArenaCalloc
(
(
_arena
)
(
_bytes
)
8
)
#
define
XPT_CALLOC1
(
_arena
_bytes
)
XPT_ArenaCalloc
(
(
_arena
)
(
_bytes
)
1
)
#
define
XPT_NEWZAP
(
_arena
_struct
)
(
(
_struct
*
)
XPT_CALLOC8
(
(
_arena
)
sizeof
(
_struct
)
)
)
#
ifdef
DEBUG
void
XPT_AssertFailed
(
const
char
*
s
const
char
*
file
uint32_t
lineno
)
MOZ_PRETEND_NORETURN_FOR_STATIC_ANALYSIS
;
#
define
XPT_ASSERT
(
_expr
)
\
(
(
_expr
)
?
(
(
void
)
0
)
:
XPT_AssertFailed
(
#
_expr
__FILE__
__LINE__
)
)
#
else
#
define
XPT_ASSERT
(
_expr
)
(
(
void
)
0
)
#
endif
#
ifdef
__cplusplus
}
#
endif
#
endif
