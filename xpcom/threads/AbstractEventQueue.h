#
ifndef
mozilla_AbstractEventQueue_h
#
define
mozilla_AbstractEventQueue_h
#
include
"
mozilla
/
AlreadyAddRefed
.
h
"
#
include
"
mozilla
/
MemoryReporting
.
h
"
#
include
"
mozilla
/
TimeStamp
.
h
"
#
include
"
mozilla
/
Mutex
.
h
"
class
nsIRunnable
;
namespace
mozilla
{
enum
class
EventQueuePriority
{
Idle
DeferredTimers
InputLow
HighLow
Normal
MediumHigh
InputHigh
High
Count
}
;
class
AbstractEventQueue
{
public
:
virtual
void
PutEvent
(
already_AddRefed
<
nsIRunnable
>
&
&
aEvent
EventQueuePriority
aPriority
const
MutexAutoLock
&
aProofOfLock
mozilla
:
:
TimeDuration
*
aDelay
=
nullptr
)
=
0
;
virtual
already_AddRefed
<
nsIRunnable
>
GetEvent
(
EventQueuePriority
*
aPriority
const
MutexAutoLock
&
aProofOfLock
mozilla
:
:
TimeDuration
*
aLastEventDelay
=
nullptr
)
=
0
;
virtual
bool
IsEmpty
(
const
MutexAutoLock
&
aProofOfLock
)
=
0
;
virtual
bool
HasReadyEvent
(
const
MutexAutoLock
&
aProofOfLock
)
=
0
;
virtual
bool
HasPendingHighPriorityEvents
(
const
MutexAutoLock
&
aProofOfLock
)
=
0
;
virtual
size_t
Count
(
const
MutexAutoLock
&
aProofOfLock
)
const
=
0
;
virtual
void
EnableInputEventPrioritization
(
const
MutexAutoLock
&
aProofOfLock
)
=
0
;
virtual
void
FlushInputEventPrioritization
(
const
MutexAutoLock
&
aProofOfLock
)
=
0
;
virtual
void
SuspendInputEventPrioritization
(
const
MutexAutoLock
&
aProofOfLock
)
=
0
;
virtual
void
ResumeInputEventPrioritization
(
const
MutexAutoLock
&
aProofOfLock
)
=
0
;
size_t
SizeOfIncludingThis
(
mozilla
:
:
MallocSizeOf
aMallocSizeOf
)
const
{
return
aMallocSizeOf
(
this
)
+
SizeOfExcludingThis
(
aMallocSizeOf
)
;
}
virtual
size_t
SizeOfExcludingThis
(
mozilla
:
:
MallocSizeOf
aMallocSizeOf
)
const
=
0
;
virtual
~
AbstractEventQueue
(
)
=
default
;
}
;
}
#
endif
