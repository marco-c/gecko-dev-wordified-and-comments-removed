const
{
Services
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
function
run_test
(
)
{
let
complete
=
false
;
let
runnable
=
{
internalQI
:
ChromeUtils
.
generateQI
(
[
Ci
.
nsIRunnable
]
)
QueryInterface
(
iid
)
{
Services
.
tm
.
dispatchToMainThread
(
(
)
=
>
false
)
;
return
this
.
internalQI
(
iid
)
;
}
run
(
)
{
complete
=
true
;
}
}
;
Services
.
tm
.
dispatchToMainThread
(
runnable
)
;
Services
.
tm
.
spinEventLoopUntil
(
(
)
=
>
complete
)
;
}
