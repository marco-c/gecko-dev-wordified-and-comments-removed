#
include
"
mozilla
/
Dafsa
.
h
"
#
include
"
gtest
/
gtest
.
h
"
#
include
"
nsString
.
h
"
using
mozilla
:
:
Dafsa
;
namespace
dafsa_test_1
{
#
include
"
dafsa_test_1
.
inc
"
}
TEST
(
Dafsa
Constructor
)
{
Dafsa
d
(
dafsa_test_1
:
:
kDafsa
)
;
}
TEST
(
Dafsa
StringsFound
)
{
Dafsa
d
(
dafsa_test_1
:
:
kDafsa
)
;
int
tag
=
d
.
Lookup
(
"
foo
.
bar
.
baz
"
_ns
)
;
EXPECT_EQ
(
tag
1
)
;
tag
=
d
.
Lookup
(
"
a
.
test
.
string
"
_ns
)
;
EXPECT_EQ
(
tag
0
)
;
tag
=
d
.
Lookup
(
"
a
.
test
.
string2
"
_ns
)
;
EXPECT_EQ
(
tag
2
)
;
tag
=
d
.
Lookup
(
"
aaaa
"
_ns
)
;
EXPECT_EQ
(
tag
4
)
;
}
TEST
(
Dafsa
StringsNotFound
)
{
Dafsa
d
(
dafsa_test_1
:
:
kDafsa
)
;
int
tag
=
d
.
Lookup
(
"
foo
.
bar
.
ba
"
_ns
)
;
EXPECT_EQ
(
tag
Dafsa
:
:
kKeyNotFound
)
;
tag
=
d
.
Lookup
(
"
a
.
test
.
strings
"
_ns
)
;
EXPECT_EQ
(
tag
Dafsa
:
:
kKeyNotFound
)
;
tag
=
d
.
Lookup
(
"
a
.
test
"
_ns
)
;
EXPECT_EQ
(
tag
Dafsa
:
:
kKeyNotFound
)
;
tag
=
d
.
Lookup
(
"
aaaaa
"
_ns
)
;
EXPECT_EQ
(
tag
Dafsa
:
:
kKeyNotFound
)
;
tag
=
d
.
Lookup
(
"
"
_ns
)
;
EXPECT_EQ
(
tag
Dafsa
:
:
kKeyNotFound
)
;
}
TEST
(
Dafsa
HugeString
)
{
Dafsa
d
(
dafsa_test_1
:
:
kDafsa
)
;
int
tag
=
d
.
Lookup
(
nsLiteralCString
(
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
"
This
is
a
very
long
string
that
is
larger
than
the
dafsa
itself
.
"
)
)
;
EXPECT_EQ
(
tag
Dafsa
:
:
kKeyNotFound
)
;
}
