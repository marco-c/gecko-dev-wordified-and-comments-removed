template
<
typename
T
>
void
nsTPromiseFlatString
<
T
>
:
:
Init
(
const
substring_type
&
str
)
{
if
(
str
.
IsTerminated
(
)
)
{
char_type
*
newData
=
const_cast
<
char_type
*
>
(
static_cast
<
const
char_type
*
>
(
str
.
Data
(
)
)
)
;
size_type
newLength
=
str
.
Length
(
)
;
DataFlags
newDataFlags
=
str
.
GetDataFlags
(
)
&
(
DataFlags
:
:
TERMINATED
|
DataFlags
:
:
LITERAL
)
;
this
-
>
SetData
(
newData
newLength
newDataFlags
)
;
}
else
{
this
-
>
Assign
(
str
)
;
}
}
