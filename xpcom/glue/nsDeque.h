#
ifndef
_NSDEQUE
#
define
_NSDEQUE
#
include
"
nscore
.
h
"
#
include
"
nsDebug
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
fallible
.
h
"
#
include
"
mozilla
/
MemoryReporting
.
h
"
class
nsDequeFunctor
{
public
:
virtual
void
*
operator
(
)
(
void
*
aObject
)
=
0
;
virtual
~
nsDequeFunctor
(
)
{
}
}
;
class
nsDequeIterator
;
class
nsDeque
{
typedef
mozilla
:
:
fallible_t
fallible_t
;
public
:
explicit
nsDeque
(
nsDequeFunctor
*
aDeallocator
=
nullptr
)
;
~
nsDeque
(
)
;
inline
size_t
GetSize
(
)
const
{
return
mSize
;
}
void
Push
(
void
*
aItem
)
{
if
(
!
Push
(
aItem
mozilla
:
:
fallible
)
)
{
NS_ABORT_OOM
(
mSize
*
sizeof
(
void
*
)
)
;
}
}
MOZ_MUST_USE
bool
Push
(
void
*
aItem
const
fallible_t
&
)
;
void
PushFront
(
void
*
aItem
)
{
if
(
!
PushFront
(
aItem
mozilla
:
:
fallible
)
)
{
NS_ABORT_OOM
(
mSize
*
sizeof
(
void
*
)
)
;
}
}
MOZ_MUST_USE
bool
PushFront
(
void
*
aItem
const
fallible_t
&
)
;
void
*
Pop
(
)
;
void
*
PopFront
(
)
;
void
*
Peek
(
)
const
;
void
*
PeekFront
(
)
const
;
void
*
ObjectAt
(
size_t
aIndex
)
const
;
void
Erase
(
)
;
void
ForEach
(
nsDequeFunctor
&
aFunctor
)
const
;
size_t
SizeOfExcludingThis
(
mozilla
:
:
MallocSizeOf
aMallocSizeOf
)
const
;
size_t
SizeOfIncludingThis
(
mozilla
:
:
MallocSizeOf
aMallocSizeOf
)
const
;
protected
:
size_t
mSize
;
size_t
mCapacity
;
size_t
mOrigin
;
nsDequeFunctor
*
mDeallocator
;
void
*
mBuffer
[
8
]
;
void
*
*
mData
;
private
:
nsDeque
(
const
nsDeque
&
aOther
)
;
nsDeque
&
operator
=
(
const
nsDeque
&
aOther
)
;
bool
GrowCapacity
(
)
;
void
SetDeallocator
(
nsDequeFunctor
*
aDeallocator
)
;
void
Empty
(
)
;
}
;
#
endif
