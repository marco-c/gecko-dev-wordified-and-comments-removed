#
ifndef
MustReturnFromCallerChecker_h__
#
define
MustReturnFromCallerChecker_h__
#
include
"
RecurseGuard
.
h
"
#
include
"
StmtToBlockMap
.
h
"
#
include
"
Utils
.
h
"
#
include
"
plugin
.
h
"
class
MustReturnFromCallerChecker
:
public
BaseCheck
{
public
:
MustReturnFromCallerChecker
(
StringRef
CheckName
ContextType
*
Context
=
nullptr
)
:
BaseCheck
(
CheckName
Context
)
{
}
void
registerMatchers
(
MatchFinder
*
AstMatcher
)
override
;
void
check
(
const
MatchFinder
:
:
MatchResult
&
Result
)
override
;
private
:
bool
isIgnorable
(
const
Stmt
*
S
)
;
bool
immediatelyReturns
(
RecurseGuard
<
const
CFGBlock
*
>
Block
ASTContext
*
TheContext
size_t
FromIdx
)
;
}
;
#
endif
