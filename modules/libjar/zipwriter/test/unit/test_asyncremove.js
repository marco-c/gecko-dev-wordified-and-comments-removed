var
TESTS
=
[
"
test
.
txt
"
"
test
.
png
"
]
;
var
observer
=
{
onStartRequest
(
request
)
{
}
onStopRequest
(
request
status
)
{
Assert
.
equal
(
status
Cr
.
NS_OK
)
;
zipW
.
close
(
)
;
var
newTmpFile
=
tmpFile
.
clone
(
)
;
Assert
.
equal
(
newTmpFile
.
fileSize
ZIP_EOCDR_HEADER_SIZE
)
;
do_test_finished
(
)
;
}
}
;
function
run_test
(
)
{
var
testzip
=
do_get_file
(
DATA_DIR
+
"
test
.
zip
"
)
;
testzip
.
copyTo
(
tmpDir
tmpFile
.
leafName
)
;
Assert
.
ok
(
tmpFile
.
exists
(
)
)
;
zipW
.
open
(
tmpFile
PR_RDWR
)
;
for
(
var
i
=
0
;
i
<
TESTS
.
length
;
i
+
+
)
{
Assert
.
ok
(
zipW
.
hasEntry
(
TESTS
[
i
]
)
)
;
zipW
.
removeEntry
(
TESTS
[
i
]
true
)
;
}
do_test_pending
(
)
;
zipW
.
processQueue
(
observer
null
)
;
Assert
.
ok
(
zipW
.
inQueue
)
;
}
