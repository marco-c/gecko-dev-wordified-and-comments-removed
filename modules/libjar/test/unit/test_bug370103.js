var
Cc
=
Components
.
classes
;
var
Ci
=
Components
.
interfaces
;
var
Cu
=
Components
.
utils
;
Cu
.
import
(
"
resource
:
/
/
gre
/
modules
/
NetUtil
.
jsm
"
)
;
function
run_test
(
)
{
var
ioService
=
Cc
[
"
mozilla
.
org
/
network
/
io
-
service
;
1
"
]
.
getService
(
Ci
.
nsIIOService
)
;
var
file
=
do_get_file
(
"
data
/
test_bug370103
.
jar
"
)
;
var
url
=
ioService
.
newFileURI
(
file
)
.
spec
;
url
=
"
jar
:
"
+
url
+
"
!
/
test_bug370103
"
;
var
channel
=
NetUtil
.
newChannel
(
{
uri
:
url
loadUsingSystemPrincipal
:
true
}
)
;
var
exception
=
false
;
try
{
channel
.
asyncOpen2
(
null
)
;
}
catch
(
e
)
{
exception
=
true
;
}
do_check_true
(
exception
)
;
}
