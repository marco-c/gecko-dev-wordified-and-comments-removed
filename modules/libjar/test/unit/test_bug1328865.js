"
use
strict
"
;
const
{
Services
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
const
{
NetUtil
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
NetUtil
.
jsm
"
)
;
add_task
(
async
function
(
)
{
var
file
=
do_get_file
(
"
data
/
test_bug597702
.
zip
"
)
;
var
outerJarBase
=
"
jar
:
"
+
Services
.
io
.
newFileURI
(
file
)
.
spec
+
"
!
/
"
;
var
goodSpec
=
"
jar
:
"
+
outerJarBase
+
"
inner
.
jar
!
/
hello
#
!
/
ignore
%
20this
%
20part
"
;
var
goodChannel
=
NetUtil
.
newChannel
(
{
uri
:
goodSpec
loadUsingSystemPrincipal
:
true
}
)
;
var
instr
=
goodChannel
.
open
(
)
;
ok
(
!
!
instr
"
Should
be
able
to
open
channel
"
)
;
}
)
;
add_task
(
async
function
(
)
{
var
file
=
do_get_file
(
"
data
/
test_bug597702
.
zip
"
)
;
var
outerJarBase
=
"
jar
:
"
+
Services
.
io
.
newFileURI
(
file
)
.
spec
+
"
!
/
"
;
var
goodSpec
=
"
jar
:
"
+
outerJarBase
+
"
inner
.
jar
!
/
hello
?
ignore
%
20this
%
20part
!
/
"
;
var
goodChannel
=
NetUtil
.
newChannel
(
{
uri
:
goodSpec
loadUsingSystemPrincipal
:
true
}
)
;
var
instr
=
goodChannel
.
open
(
)
;
ok
(
!
!
instr
"
Should
be
able
to
open
channel
"
)
;
}
)
;
add_task
(
async
function
(
)
{
var
file
=
do_get_file
(
"
data
/
test_bug597702
.
zip
"
)
;
var
outerJarBase
=
"
jar
:
"
+
Services
.
io
.
newFileURI
(
file
)
.
spec
+
"
!
/
"
;
var
goodSpec
=
"
jar
:
"
+
outerJarBase
+
"
inner
.
jar
!
/
hello
?
ignore
#
this
!
/
part
"
;
var
goodChannel
=
NetUtil
.
newChannel
(
{
uri
:
goodSpec
loadUsingSystemPrincipal
:
true
}
)
;
var
instr
=
goodChannel
.
open
(
)
;
ok
(
!
!
instr
"
Should
be
able
to
open
channel
"
)
;
}
)
;
