#
ifndef
TTINTERP_H_
#
define
TTINTERP_H_
#
include
"
ttobjs
.
h
"
FT_BEGIN_HEADER
#
define
TT_Round_Off
5
#
define
TT_Round_To_Half_Grid
0
#
define
TT_Round_To_Grid
1
#
define
TT_Round_To_Double_Grid
2
#
define
TT_Round_Up_To_Grid
4
#
define
TT_Round_Down_To_Grid
3
#
define
TT_Round_Super
6
#
define
TT_Round_Super_45
7
#
define
TT_MAX_CODE_RANGES
3
typedef
enum
TT_CodeRange_Tag_
{
tt_coderange_none
=
0
tt_coderange_font
tt_coderange_cvt
tt_coderange_glyph
}
TT_CodeRange_Tag
;
typedef
struct
TT_CodeRange_
{
FT_Byte
*
base
;
FT_Long
size
;
}
TT_CodeRange
;
typedef
TT_CodeRange
TT_CodeRangeTable
[
TT_MAX_CODE_RANGES
]
;
typedef
struct
TT_DefRecord_
{
FT_Int
range
;
FT_Long
start
;
FT_Long
end
;
FT_UInt
opc
;
FT_Bool
active
;
}
TT_DefRecord
*
TT_DefArray
;
typedef
FT_F26Dot6
(
*
TT_Round_Func
)
(
TT_ExecContext
exc
FT_F26Dot6
distance
FT_F26Dot6
compensation
)
;
typedef
void
(
*
TT_Move_Func
)
(
TT_ExecContext
exc
TT_GlyphZone
zone
FT_UShort
point
FT_F26Dot6
distance
)
;
typedef
FT_F26Dot6
(
*
TT_Project_Func
)
(
TT_ExecContext
exc
FT_Pos
dx
FT_Pos
dy
)
;
typedef
FT_Long
(
*
TT_Cur_Ppem_Func
)
(
TT_ExecContext
exc
)
;
typedef
FT_F26Dot6
(
*
TT_Get_CVT_Func
)
(
TT_ExecContext
exc
FT_ULong
idx
)
;
typedef
void
(
*
TT_Set_CVT_Func
)
(
TT_ExecContext
exc
FT_ULong
idx
FT_F26Dot6
value
)
;
typedef
struct
TT_CallRec_
{
FT_Int
Caller_Range
;
FT_Long
Caller_IP
;
FT_Long
Cur_Count
;
TT_DefRecord
*
Def
;
}
TT_CallRec
*
TT_CallStack
;
typedef
struct
TT_ExecContextRec_
{
TT_Face
face
;
TT_Size
size
;
FT_Memory
memory
;
TT_Interpreter
interpreter
;
FT_Error
error
;
FT_Long
top
;
FT_Long
stackSize
;
FT_Long
*
stack
;
FT_Long
args
;
FT_Long
new_top
;
TT_GlyphZoneRec
zp0
zp1
zp2
pts
twilight
;
FT_Long
pointSize
;
FT_Size_Metrics
metrics
;
TT_Size_Metrics
tt_metrics
;
TT_GraphicsState
GS
;
FT_Int
iniRange
;
FT_Int
curRange
;
FT_Byte
*
code
;
FT_Long
IP
;
FT_Long
codeSize
;
FT_Byte
opcode
;
FT_Int
length
;
FT_ULong
cvtSize
;
FT_Long
*
cvt
;
FT_ULong
glyfCvtSize
;
FT_Long
*
glyfCvt
;
FT_UInt
glyphSize
;
FT_Byte
*
glyphIns
;
FT_UInt
numFDefs
;
FT_UInt
maxFDefs
;
TT_DefArray
FDefs
;
FT_UInt
numIDefs
;
FT_UInt
maxIDefs
;
TT_DefArray
IDefs
;
FT_UInt
maxFunc
;
FT_UInt
maxIns
;
FT_Int
callTop
callSize
;
TT_CallStack
callStack
;
FT_UShort
maxPoints
;
FT_Short
maxContours
;
TT_CodeRangeTable
codeRangeTable
;
FT_UShort
storeSize
;
FT_Long
*
storage
;
FT_UShort
glyfStoreSize
;
FT_Long
*
glyfStorage
;
FT_F26Dot6
period
;
FT_F26Dot6
phase
;
FT_F26Dot6
threshold
;
FT_Bool
instruction_trap
;
FT_Bool
is_composite
;
FT_Bool
pedantic_hinting
;
TT_Round_Func
func_round
;
FT_Vector
moveVector
;
TT_Project_Func
func_project
func_dualproj
func_freeProj
;
TT_Move_Func
func_move
;
TT_Move_Func
func_move_orig
;
TT_Cur_Ppem_Func
func_cur_ppem
;
TT_Get_CVT_Func
func_read_cvt
;
TT_Set_CVT_Func
func_write_cvt
;
TT_Set_CVT_Func
func_move_cvt
;
FT_Bool
grayscale
;
#
ifdef
TT_SUPPORT_SUBPIXEL_HINTING_MINIMAL
FT_Int
backward_compatibility
;
FT_Render_Mode
mode
;
#
endif
FT_ULong
loopcall_counter
;
FT_ULong
loopcall_counter_max
;
FT_ULong
neg_jump_counter
;
FT_ULong
neg_jump_counter_max
;
}
TT_ExecContextRec
;
extern
const
TT_GraphicsState
tt_default_graphics_state
;
FT_LOCAL
(
void
)
TT_Set_CodeRange
(
TT_ExecContext
exec
FT_Int
range
FT_Byte
*
base
FT_Long
length
)
;
FT_LOCAL
(
void
)
TT_Clear_CodeRange
(
TT_ExecContext
exec
FT_Int
range
)
;
FT_EXPORT
(
TT_ExecContext
)
TT_New_Context
(
TT_Driver
driver
)
;
FT_LOCAL
(
void
)
TT_Done_Context
(
TT_ExecContext
exec
)
;
FT_LOCAL
(
FT_Error
)
TT_Load_Context
(
TT_ExecContext
exec
TT_Face
face
TT_Size
size
)
;
FT_LOCAL
(
void
)
TT_Save_Context
(
TT_ExecContext
exec
TT_Size
size
)
;
FT_LOCAL
(
FT_Error
)
TT_Run_Context
(
TT_ExecContext
exec
TT_Size
size
)
;
FT_EXPORT
(
FT_Error
)
TT_RunIns
(
void
*
exec
)
;
FT_END_HEADER
#
endif
