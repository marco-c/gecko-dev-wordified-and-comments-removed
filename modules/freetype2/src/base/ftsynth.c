#
include
<
freetype
/
ftsynth
.
h
>
#
include
<
freetype
/
internal
/
ftdebug
.
h
>
#
include
<
freetype
/
internal
/
ftobjs
.
h
>
#
include
<
freetype
/
ftoutln
.
h
>
#
include
<
freetype
/
ftbitmap
.
h
>
#
undef
FT_COMPONENT
#
define
FT_COMPONENT
synth
FT_EXPORT_DEF
(
void
)
FT_GlyphSlot_Oblique
(
FT_GlyphSlot
slot
)
{
FT_GlyphSlot_Slant
(
slot
0x0366A
0
)
;
}
FT_EXPORT_DEF
(
void
)
FT_GlyphSlot_Slant
(
FT_GlyphSlot
slot
FT_Fixed
xslant
FT_Fixed
yslant
)
{
FT_Matrix
transform
;
FT_Outline
*
outline
;
if
(
!
slot
)
return
;
outline
=
&
slot
-
>
outline
;
if
(
slot
-
>
format
!
=
FT_GLYPH_FORMAT_OUTLINE
)
return
;
transform
.
xx
=
0x10000L
;
transform
.
yx
=
-
yslant
;
transform
.
xy
=
xslant
;
transform
.
yy
=
0x10000L
;
FT_Outline_Transform
(
outline
&
transform
)
;
}
FT_EXPORT_DEF
(
void
)
FT_GlyphSlot_Embolden
(
FT_GlyphSlot
slot
)
{
FT_Library
library
;
FT_Face
face
;
FT_Error
error
;
FT_Pos
xstr
ystr
;
if
(
!
slot
)
return
;
library
=
slot
-
>
library
;
face
=
slot
-
>
face
;
if
(
slot
-
>
format
!
=
FT_GLYPH_FORMAT_OUTLINE
&
&
slot
-
>
format
!
=
FT_GLYPH_FORMAT_BITMAP
)
return
;
xstr
=
FT_MulFix
(
face
-
>
units_per_EM
face
-
>
size
-
>
metrics
.
y_scale
)
/
24
;
ystr
=
xstr
;
if
(
slot
-
>
format
=
=
FT_GLYPH_FORMAT_OUTLINE
)
FT_Outline_EmboldenXY
(
&
slot
-
>
outline
xstr
ystr
)
;
else
{
xstr
&
=
~
63
;
if
(
xstr
=
=
0
)
xstr
=
1
<
<
6
;
ystr
&
=
~
63
;
if
(
(
ystr
>
>
6
)
>
FT_INT_MAX
|
|
(
ystr
>
>
6
)
<
FT_INT_MIN
)
{
FT_TRACE1
(
(
"
FT_GlyphSlot_Embolden
:
"
)
)
;
FT_TRACE1
(
(
"
too
strong
emboldening
parameter
ystr
=
%
ld
\
n
"
ystr
)
)
;
return
;
}
error
=
FT_GlyphSlot_Own_Bitmap
(
slot
)
;
if
(
error
)
return
;
error
=
FT_Bitmap_Embolden
(
library
&
slot
-
>
bitmap
xstr
ystr
)
;
if
(
error
)
return
;
}
if
(
slot
-
>
advance
.
x
)
slot
-
>
advance
.
x
+
=
xstr
;
if
(
slot
-
>
advance
.
y
)
slot
-
>
advance
.
y
+
=
ystr
;
slot
-
>
metrics
.
width
+
=
xstr
;
slot
-
>
metrics
.
height
+
=
ystr
;
slot
-
>
metrics
.
horiAdvance
+
=
xstr
;
slot
-
>
metrics
.
vertAdvance
+
=
ystr
;
slot
-
>
metrics
.
horiBearingY
+
=
ystr
;
if
(
slot
-
>
format
=
=
FT_GLYPH_FORMAT_BITMAP
)
slot
-
>
bitmap_top
+
=
(
FT_Int
)
(
ystr
>
>
6
)
;
}
