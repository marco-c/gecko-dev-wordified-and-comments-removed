#
include
"
pcfutil
.
h
"
FT_LOCAL_DEF
(
void
)
BitOrderInvert
(
unsigned
char
*
buf
size_t
nbytes
)
{
for
(
;
nbytes
>
0
;
nbytes
-
-
buf
+
+
)
{
unsigned
int
val
=
*
buf
;
val
=
(
(
val
>
>
1
)
&
0x55
)
|
(
(
val
<
<
1
)
&
0xAA
)
;
val
=
(
(
val
>
>
2
)
&
0x33
)
|
(
(
val
<
<
2
)
&
0xCC
)
;
val
=
(
(
val
>
>
4
)
&
0x0F
)
|
(
(
val
<
<
4
)
&
0xF0
)
;
*
buf
=
(
unsigned
char
)
val
;
}
}
#
if
(
defined
(
__clang_major__
)
&
&
__clang_major__
>
=
5
)
|
|
\
(
defined
(
__GNUC__
)
&
&
\
(
__GNUC__
>
4
|
|
(
__GNUC__
=
=
4
&
&
__GNUC_MINOR__
>
=
8
)
)
)
#
define
BSWAP16
(
x
)
__builtin_bswap16
(
x
)
#
define
BSWAP32
(
x
)
__builtin_bswap32
(
x
)
#
elif
defined
(
_MSC_VER
)
&
&
_MSC_VER
>
=
1300
#
pragma
intrinsic
(
_byteswap_ushort
)
#
pragma
intrinsic
(
_byteswap_ulong
)
#
define
BSWAP16
(
x
)
_byteswap_ushort
(
x
)
#
define
BSWAP32
(
x
)
_byteswap_ulong
(
x
)
#
else
#
define
BSWAP16
(
x
)
\
(
FT_UInt16
)
(
(
(
(
x
)
>
>
8
)
&
0xff
)
|
\
(
(
(
x
)
&
0xff
)
<
<
8
)
)
#
define
BSWAP32
(
x
)
\
(
FT_UInt32
)
(
(
(
(
x
)
&
0xff000000u
)
>
>
24
)
|
\
(
(
(
x
)
&
0x00ff0000u
)
>
>
8
)
|
\
(
(
(
x
)
&
0x0000ff00u
)
<
<
8
)
|
\
(
(
(
x
)
&
0x000000ffu
)
<
<
24
)
)
#
endif
FT_LOCAL_DEF
(
void
)
TwoByteSwap
(
unsigned
char
*
buf
size_t
nbytes
)
{
FT_UInt16
*
b
=
(
FT_UInt16
*
)
buf
;
for
(
;
nbytes
>
=
2
;
nbytes
-
=
2
b
+
+
)
*
b
=
BSWAP16
(
*
b
)
;
}
FT_LOCAL_DEF
(
void
)
FourByteSwap
(
unsigned
char
*
buf
size_t
nbytes
)
{
FT_UInt32
*
b
=
(
FT_UInt32
*
)
buf
;
for
(
;
nbytes
>
=
4
;
nbytes
-
=
4
b
+
+
)
*
b
=
BSWAP32
(
*
b
)
;
}
