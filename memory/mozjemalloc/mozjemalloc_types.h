#
ifndef
_JEMALLOC_TYPES_H_
#
define
_JEMALLOC_TYPES_H_
#
ifdef
_MSC_VER
#
include
<
crtdefs
.
h
>
#
else
#
include
<
stddef
.
h
>
#
endif
#
include
<
stdbool
.
h
>
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
typedef
struct
{
bool
opt_junk
;
bool
opt_zero
;
size_t
narenas
;
size_t
quantum
;
size_t
small_max
;
size_t
large_max
;
size_t
chunksize
;
size_t
page_size
;
size_t
dirty_max
;
size_t
mapped
;
size_t
allocated
;
size_t
waste
;
size_t
page_cache
;
size_t
bookkeeping
;
size_t
bin_unused
;
}
jemalloc_stats_t
;
enum
PtrInfoTag
{
TagUnknown
TagLiveSmall
TagLiveLarge
TagLiveHuge
TagFreedSmall
TagFreedPageDirty
TagFreedPageDecommitted
TagFreedPageMadvised
TagFreedPageZeroed
}
;
typedef
struct
{
enum
PtrInfoTag
tag
;
void
*
addr
;
size_t
size
;
}
jemalloc_ptr_info_t
;
static
inline
bool
jemalloc_ptr_is_live
(
jemalloc_ptr_info_t
*
info
)
{
return
info
-
>
tag
=
=
TagLiveSmall
|
|
info
-
>
tag
=
=
TagLiveLarge
|
|
info
-
>
tag
=
=
TagLiveHuge
;
}
static
inline
bool
jemalloc_ptr_is_freed
(
jemalloc_ptr_info_t
*
info
)
{
return
info
-
>
tag
=
=
TagFreedSmall
|
|
info
-
>
tag
=
=
TagFreedPageDirty
|
|
info
-
>
tag
=
=
TagFreedPageDecommitted
|
|
info
-
>
tag
=
=
TagFreedPageMadvised
|
|
info
-
>
tag
=
=
TagFreedPageZeroed
;
}
static
inline
bool
jemalloc_ptr_is_freed_page
(
jemalloc_ptr_info_t
*
info
)
{
return
info
-
>
tag
=
=
TagFreedPageDirty
|
|
info
-
>
tag
=
=
TagFreedPageDecommitted
|
|
info
-
>
tag
=
=
TagFreedPageMadvised
|
|
info
-
>
tag
=
=
TagFreedPageZeroed
;
}
#
ifdef
__cplusplus
}
#
endif
#
endif
