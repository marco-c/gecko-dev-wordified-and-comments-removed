#
ifndef
malloc_decls_h
#
define
malloc_decls_h
#
include
"
mozjemalloc_types
.
h
"
#
define
MALLOC_FUNCS_MALLOC_BASE
1
#
define
MALLOC_FUNCS_MALLOC_EXTRA
2
#
define
MALLOC_FUNCS_MALLOC
\
(
MALLOC_FUNCS_MALLOC_BASE
|
MALLOC_FUNCS_MALLOC_EXTRA
)
#
define
MALLOC_FUNCS_JEMALLOC
4
#
define
MALLOC_FUNCS_INIT
8
#
define
MALLOC_FUNCS_BRIDGE
16
#
define
MALLOC_FUNCS_ARENA_BASE
32
#
define
MALLOC_FUNCS_ARENA_ALLOC
64
#
define
MALLOC_FUNCS_ARENA
(
MALLOC_FUNCS_ARENA_BASE
|
MALLOC_FUNCS_ARENA_ALLOC
)
#
define
MALLOC_FUNCS_ALL
\
(
MALLOC_FUNCS_INIT
|
MALLOC_FUNCS_BRIDGE
|
MALLOC_FUNCS_MALLOC
|
\
MALLOC_FUNCS_JEMALLOC
|
MALLOC_FUNCS_ARENA
)
#
endif
#
ifndef
MALLOC_FUNCS
#
define
MALLOC_FUNCS
\
(
MALLOC_FUNCS_MALLOC
|
MALLOC_FUNCS_JEMALLOC
|
MALLOC_FUNCS_ARENA
)
#
endif
#
ifdef
MALLOC_DECL
#
if
MALLOC_FUNCS
&
MALLOC_FUNCS_INIT
MALLOC_DECL
(
init
void
const
malloc_table_t
*
)
#
endif
#
if
MALLOC_FUNCS
&
MALLOC_FUNCS_BRIDGE
MALLOC_DECL
(
get_bridge
struct
ReplaceMallocBridge
*
)
#
endif
#
if
MALLOC_FUNCS
&
MALLOC_FUNCS_MALLOC_BASE
MALLOC_DECL
(
malloc
void
*
size_t
)
MALLOC_DECL
(
calloc
void
*
size_t
size_t
)
MALLOC_DECL
(
realloc
void
*
void
*
size_t
)
MALLOC_DECL
(
free
void
void
*
)
MALLOC_DECL
(
memalign
void
*
size_t
size_t
)
#
endif
#
if
MALLOC_FUNCS
&
MALLOC_FUNCS_MALLOC_EXTRA
MALLOC_DECL
(
posix_memalign
int
void
*
*
size_t
size_t
)
MALLOC_DECL
(
aligned_alloc
void
*
size_t
size_t
)
MALLOC_DECL
(
valloc
void
*
size_t
)
MALLOC_DECL
(
malloc_usable_size
size_t
usable_ptr_t
)
MALLOC_DECL
(
malloc_good_size
size_t
size_t
)
#
endif
#
if
MALLOC_FUNCS
&
MALLOC_FUNCS_JEMALLOC
MALLOC_DECL
(
jemalloc_stats
void
jemalloc_stats_t
*
)
MALLOC_DECL
(
jemalloc_purge_freed_pages
void
)
MALLOC_DECL
(
jemalloc_free_dirty_pages
void
)
MALLOC_DECL
(
jemalloc_thread_local_arena
void
bool
)
MALLOC_DECL
(
jemalloc_ptr_info
void
const
void
*
jemalloc_ptr_info_t
*
)
#
endif
#
if
MALLOC_FUNCS
&
MALLOC_FUNCS_ARENA_BASE
MALLOC_DECL
(
moz_create_arena_with_params
arena_id_t
arena_params_t
*
)
MALLOC_DECL
(
moz_dispose_arena
void
arena_id_t
)
#
endif
#
if
MALLOC_FUNCS
&
MALLOC_FUNCS_ARENA_ALLOC
MALLOC_DECL
(
moz_arena_malloc
void
*
arena_id_t
size_t
)
MALLOC_DECL
(
moz_arena_calloc
void
*
arena_id_t
size_t
size_t
)
MALLOC_DECL
(
moz_arena_realloc
void
*
arena_id_t
void
*
size_t
)
MALLOC_DECL
(
moz_arena_free
void
arena_id_t
void
*
)
MALLOC_DECL
(
moz_arena_memalign
void
*
arena_id_t
size_t
size_t
)
#
endif
#
endif
#
undef
MALLOC_DECL
#
undef
MALLOC_FUNCS
