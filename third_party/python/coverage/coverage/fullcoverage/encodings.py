"
"
"
Imposter
encodings
module
that
installs
a
coverage
-
style
tracer
.
This
is
NOT
the
encodings
module
;
it
is
an
imposter
that
sets
up
tracing
instrumentation
and
then
replaces
itself
with
the
real
encodings
module
.
If
the
directory
that
holds
this
file
is
placed
first
in
the
PYTHONPATH
when
using
"
coverage
"
to
run
Python
'
s
tests
then
this
file
will
become
the
very
first
module
imported
by
the
internals
of
Python
3
.
It
installs
a
coverage
.
py
-
compatible
trace
function
that
can
watch
Standard
Library
modules
execute
from
the
very
earliest
stages
of
Python
'
s
own
boot
process
.
This
fixes
a
problem
with
coverage
.
py
-
that
it
starts
too
late
to
trace
the
coverage
of
many
of
the
most
fundamental
modules
in
the
Standard
Library
.
"
"
"
import
sys
class
FullCoverageTracer
(
object
)
:
    
def
__init__
(
self
)
:
        
self
.
traces
=
[
]
    
def
fullcoverage_trace
(
self
*
args
)
:
        
frame
event
arg
=
args
        
self
.
traces
.
append
(
(
args
frame
.
f_lineno
)
)
        
return
self
.
fullcoverage_trace
sys
.
settrace
(
FullCoverageTracer
(
)
.
fullcoverage_trace
)
parentdir
=
max
(
filter
(
__file__
.
startswith
sys
.
path
)
key
=
len
)
sys
.
path
.
remove
(
parentdir
)
del
sys
.
modules
[
'
encodings
'
]
import
encodings
