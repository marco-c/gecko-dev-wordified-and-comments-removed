"
"
"
Verifies
that
a
default
gyp
define
can
be
overridden
.
"
"
"
import
os
import
TestGyp
test
=
TestGyp
.
TestGyp
(
)
expect_stderr
=
'
'
if
test
.
format
=
=
'
cmake
'
:
  
expect_stderr
=
(
"
"
"
WARNING
:
Preprocessor
definitions
containing
'
#
'
may
not
be
passed
on
the
"
"
"
"
"
"
compiler
command
line
because
many
compilers
do
not
support
it
.
\
n
"
"
"
"
"
"
CMake
is
dropping
a
preprocessor
definition
:
HASH_VALUE
=
"
a
#
1
"
\
n
"
"
"
"
"
"
Consider
defining
the
macro
in
a
(
configured
)
header
file
.
\
n
\
n
"
"
"
)
test
.
run_gyp
(
'
defines
.
gyp
'
'
-
D
'
'
OS
=
fakeos
'
)
test
.
build
(
'
defines
.
gyp
'
stderr
=
expect_stderr
)
test
.
built_file_must_exist
(
'
fakeosprogram
'
type
=
test
.
EXECUTABLE
)
os
.
remove
(
test
.
built_file_path
(
'
fakeosprogram
'
type
=
test
.
EXECUTABLE
)
)
test
.
run_gyp
(
'
defines
.
gyp
'
)
test
.
build
(
'
defines
.
gyp
'
stderr
=
expect_stderr
)
test
.
built_file_must_not_exist
(
'
fakeosprogram
'
type
=
test
.
EXECUTABLE
)
os
.
environ
[
'
GYP_DEFINES
'
]
=
'
OS
=
fakeos
'
test
.
run_gyp
(
'
defines
.
gyp
'
)
test
.
build
(
'
defines
.
gyp
'
stderr
=
expect_stderr
)
test
.
built_file_must_exist
(
'
fakeosprogram
'
type
=
test
.
EXECUTABLE
)
test
.
pass_test
(
)
