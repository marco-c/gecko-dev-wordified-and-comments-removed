"
"
"
Make
sure
safeseh
setting
is
extracted
properly
.
"
"
"
import
TestGyp
import
sys
if
sys
.
platform
=
=
'
win32
'
:
  
test
=
TestGyp
.
TestGyp
(
)
  
CHDIR
=
'
linker
-
flags
'
  
test
.
run_gyp
(
'
safeseh
.
gyp
'
chdir
=
CHDIR
)
  
test
.
build
(
'
safeseh
.
gyp
'
test
.
ALL
chdir
=
CHDIR
)
  
def
HasSafeExceptionHandlers
(
exe
)
:
    
full_path
=
test
.
built_file_path
(
exe
chdir
=
CHDIR
)
    
output
=
test
.
run_dumpbin
(
'
/
LOADCONFIG
'
full_path
)
    
return
'
Safe
Exception
Handler
Table
'
in
output
  
if
not
HasSafeExceptionHandlers
(
'
test_safeseh_default
.
exe
'
)
:
    
test
.
fail_test
(
)
  
if
HasSafeExceptionHandlers
(
'
test_safeseh_no
.
exe
'
)
:
    
test
.
fail_test
(
)
  
if
not
HasSafeExceptionHandlers
(
'
test_safeseh_yes
.
exe
'
)
:
    
test
.
fail_test
(
)
  
if
HasSafeExceptionHandlers
(
'
test_safeseh_x64
.
exe
'
)
:
    
test
.
fail_test
(
)
  
test
.
pass_test
(
)
