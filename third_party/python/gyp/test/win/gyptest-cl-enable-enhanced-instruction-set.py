"
"
"
Test
VCCLCompilerTool
EnableEnhancedInstructionSet
setting
.
"
"
"
import
TestGyp
import
os
import
sys
if
sys
.
platform
=
=
'
win32
'
:
  
print
"
This
test
is
currently
disabled
:
https
:
/
/
crbug
.
com
/
483696
.
"
  
sys
.
exit
(
0
)
  
test
=
TestGyp
.
TestGyp
(
)
  
CHDIR
=
'
compiler
-
flags
'
  
test
.
run_gyp
(
'
enable
-
enhanced
-
instruction
-
set
.
gyp
'
chdir
=
CHDIR
)
  
test
.
build
(
'
enable
-
enhanced
-
instruction
-
set
.
gyp
'
test
.
ALL
chdir
=
CHDIR
)
  
test
.
run_built_executable
(
'
sse_extensions
'
chdir
=
CHDIR
                            
stdout
=
'
/
arch
:
SSE
\
n
'
)
  
test
.
run_built_executable
(
'
sse2_extensions
'
chdir
=
CHDIR
                            
stdout
=
'
/
arch
:
SSE2
\
n
'
)
  
if
os
.
path
.
exists
(
test
.
built_file_path
(
'
avx_extensions
'
)
)
:
    
test
.
run_built_executable
(
'
avx_extensions
'
chdir
=
CHDIR
                              
stdout
=
'
/
arch
:
AVX
\
n
'
)
  
if
os
.
path
.
exists
(
test
.
built_file_path
(
'
no_extensions
'
)
)
:
    
test
.
run_built_executable
(
'
no_extensions
'
chdir
=
CHDIR
                              
stdout
=
'
/
arch
:
IA32
\
n
'
)
  
if
os
.
path
.
exists
(
test
.
built_file_path
(
'
avx2_extensions
'
)
)
:
    
test
.
run_built_executable
(
'
avx2_extensions
'
chdir
=
CHDIR
                              
stdout
=
'
/
arch
:
AVX2
\
n
'
)
  
test
.
pass_test
(
)
