from
pyasn1
.
type
import
char
from
pyasn1
.
type
import
constraint
from
pyasn1
.
type
import
namedtype
from
pyasn1
.
type
import
namedval
from
pyasn1
.
type
import
univ
from
pyasn1_modules
import
rfc5652
import
string
MAX
=
float
(
'
inf
'
)
class
Algorithm
(
univ
.
Enumerated
)
:
    
namedValues
=
namedval
.
NamedValues
(
        
(
'
canonAlgorithmSimple
'
0
)
        
(
'
canonAlgorithmRelaxed
'
1
)
    
)
class
HeaderFieldStatus
(
univ
.
Integer
)
:
    
namedValues
=
namedval
.
NamedValues
(
        
(
'
duplicated
'
0
)
        
(
'
deleted
'
1
)
        
(
'
modified
'
2
)
    
)
class
HeaderFieldName
(
char
.
VisibleString
)
:
    
subtypeSpec
=
(
        
constraint
.
PermittedAlphabetConstraint
(
*
string
.
printable
)
-
        
constraint
.
PermittedAlphabetConstraint
(
'
:
'
)
    
)
class
HeaderFieldValue
(
char
.
UTF8String
)
:
    
pass
class
HeaderField
(
univ
.
Sequence
)
:
    
componentType
=
namedtype
.
NamedTypes
(
        
namedtype
.
NamedType
(
'
field
-
Name
'
HeaderFieldName
(
)
)
        
namedtype
.
NamedType
(
'
field
-
Value
'
HeaderFieldValue
(
)
)
        
namedtype
.
DefaultedNamedType
(
'
field
-
Status
'
            
HeaderFieldStatus
(
)
.
subtype
(
value
=
'
duplicated
'
)
)
    
)
class
HeaderFields
(
univ
.
SequenceOf
)
:
    
componentType
=
HeaderField
(
)
    
subtypeSpec
=
constraint
.
ValueSizeConstraint
(
1
MAX
)
class
SecureHeaderFields
(
univ
.
Set
)
:
    
componentType
=
namedtype
.
NamedTypes
(
        
namedtype
.
NamedType
(
'
canonAlgorithm
'
Algorithm
(
)
)
        
namedtype
.
NamedType
(
'
secHeaderFields
'
HeaderFields
(
)
)
    
)
id_aa
=
univ
.
ObjectIdentifier
(
(
1
2
840
113549
1
9
16
2
)
)
id_aa_secureHeaderFieldsIdentifier
=
id_aa
+
(
55
)
_cmsAttributesMapUpdate
=
{
    
id_aa_secureHeaderFieldsIdentifier
:
SecureHeaderFields
(
)
}
rfc5652
.
cmsAttributesMap
.
update
(
_cmsAttributesMapUpdate
)
