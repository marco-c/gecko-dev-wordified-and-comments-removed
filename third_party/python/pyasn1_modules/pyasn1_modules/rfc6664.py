from
pyasn1
.
type
import
constraint
from
pyasn1
.
type
import
namedtype
from
pyasn1
.
type
import
tag
from
pyasn1
.
type
import
univ
from
pyasn1_modules
import
rfc5280
from
pyasn1_modules
import
rfc5751
from
pyasn1_modules
import
rfc5480
from
pyasn1_modules
import
rfc4055
from
pyasn1_modules
import
rfc3279
MAX
=
float
(
'
inf
'
)
AlgorithmIdentifier
=
rfc5280
.
AlgorithmIdentifier
dhpublicnumber
=
rfc3279
.
dhpublicnumber
Dss_Parms
=
rfc3279
.
Dss_Parms
id_dsa
=
rfc3279
.
id_dsa
id_ecPublicKey
=
rfc3279
.
id_ecPublicKey
rsaEncryption
=
rfc3279
.
rsaEncryption
id_mgf1
=
rfc4055
.
id_mgf1
id_RSAES_OAEP
=
rfc4055
.
id_RSAES_OAEP
id_RSASSA_PSS
=
rfc4055
.
id_RSASSA_PSS
ECParameters
=
rfc5480
.
ECParameters
id_ecDH
=
rfc5480
.
id_ecDH
id_ecMQV
=
rfc5480
.
id_ecMQV
class
RSAKeySize
(
univ
.
Integer
)
:
    
pass
class
RSAKeyCapabilities
(
univ
.
Sequence
)
:
    
componentType
=
namedtype
.
NamedTypes
(
        
namedtype
.
NamedType
(
'
minKeySize
'
RSAKeySize
(
)
)
        
namedtype
.
OptionalNamedType
(
'
maxKeySize
'
RSAKeySize
(
)
)
    
)
class
RsaSsa_Pss_sig_caps
(
univ
.
Sequence
)
:
    
componentType
=
namedtype
.
NamedTypes
(
        
namedtype
.
NamedType
(
'
hashAlg
'
AlgorithmIdentifier
(
)
)
        
namedtype
.
OptionalNamedType
(
'
maskAlg
'
AlgorithmIdentifier
(
)
)
        
namedtype
.
DefaultedNamedType
(
'
trailerField
'
univ
.
Integer
(
)
.
subtype
(
value
=
1
)
)
    
)
class
DSAKeySize
(
univ
.
Integer
)
:
    
subtypeSpec
=
constraint
.
SingleValueConstraint
(
1024
2048
3072
7680
15360
)
class
DSAKeyCapabilities
(
univ
.
Choice
)
:
    
componentType
=
namedtype
.
NamedTypes
(
        
namedtype
.
NamedType
(
'
keySizes
'
univ
.
Sequence
(
componentType
=
namedtype
.
NamedTypes
(
            
namedtype
.
NamedType
(
'
minKeySize
'
                
DSAKeySize
(
)
)
            
namedtype
.
OptionalNamedType
(
'
maxKeySize
'
                
DSAKeySize
(
)
)
            
namedtype
.
OptionalNamedType
(
'
maxSizeP
'
                
univ
.
Integer
(
)
.
subtype
(
explicitTag
=
tag
.
Tag
(
                    
tag
.
tagClassContext
tag
.
tagFormatSimple
1
)
)
)
            
namedtype
.
OptionalNamedType
(
'
maxSizeQ
'
                
univ
.
Integer
(
)
.
subtype
(
explicitTag
=
tag
.
Tag
(
                    
tag
.
tagClassContext
tag
.
tagFormatSimple
2
)
)
)
            
namedtype
.
OptionalNamedType
(
'
maxSizeG
'
                
univ
.
Integer
(
)
.
subtype
(
explicitTag
=
tag
.
Tag
(
                    
tag
.
tagClassContext
tag
.
tagFormatSimple
3
)
)
)
        
)
)
.
subtype
(
explicitTag
=
tag
.
Tag
(
tag
.
tagClassContext
tag
.
tagFormatConstructed
0
)
)
)
        
namedtype
.
NamedType
(
'
keyParams
'
            
Dss_Parms
(
)
.
subtype
(
explicitTag
=
tag
.
Tag
(
                
tag
.
tagClassContext
tag
.
tagFormatConstructed
1
)
)
)
    
)
class
EC_SMimeCaps
(
univ
.
SequenceOf
)
:
    
componentType
=
ECParameters
(
)
    
subtypeSpec
=
constraint
.
ValueSizeConstraint
(
1
MAX
)
_smimeCapabilityMapUpdate
=
{
    
rsaEncryption
:
RSAKeyCapabilities
(
)
    
id_RSASSA_PSS
:
RSAKeyCapabilities
(
)
    
id_RSAES_OAEP
:
RSAKeyCapabilities
(
)
    
id_dsa
:
DSAKeyCapabilities
(
)
    
dhpublicnumber
:
DSAKeyCapabilities
(
)
    
id_ecPublicKey
:
EC_SMimeCaps
(
)
    
id_ecDH
:
EC_SMimeCaps
(
)
    
id_ecMQV
:
EC_SMimeCaps
(
)
    
id_mgf1
:
AlgorithmIdentifier
(
)
}
rfc5751
.
smimeCapabilityMap
.
update
(
_smimeCapabilityMapUpdate
)
