assert
__name__
=
=
'
__main__
'
import
os
import
sys
sys
.
path
=
[
p
for
p
in
sys
.
path
if
os
.
path
.
basename
(
p
)
not
in
(
'
site
-
packages
'
'
dist
-
packages
'
)
]
try
:
    
import
importlib
.
util
    
spec
=
importlib
.
util
.
spec_from_file_location
(
'
main
'
os
.
path
.
join
(
os
.
path
.
dirname
(
__file__
)
'
__main__
.
py
'
)
)
    
mod
=
importlib
.
util
.
module_from_spec
(
spec
)
    
spec
.
loader
.
exec_module
(
mod
)
except
ImportError
:
    
import
imp
    
mod_info
=
imp
.
find_module
(
'
__main__
'
[
os
.
path
.
dirname
(
__file__
)
]
)
    
mod
=
imp
.
load_module
(
'
main
'
*
mod_info
)
class
fake_zipfile
(
object
)
:
    
class
ZipFile
(
object
)
:
        
def
__init__
(
self
path
mode
)
:
            
self
.
_path
=
path
            
self
.
_mode
=
mode
        
def
open
(
self
path
)
:
            
return
open
(
os
.
path
.
join
(
self
.
_path
path
)
self
.
_mode
+
'
b
'
)
        
def
close
(
self
)
:
            
pass
mod
.
zipfile
=
fake_zipfile
def
run
(
)
:
    
with
mod
.
VersionedFindLoad
(
)
as
finder
:
        
sys
.
meta_path
.
insert
(
0
finder
)
        
finder
.
_register_distutils_finder
(
)
        
from
virtualenv
.
__main__
import
run
as
run_virtualenv
        
run_virtualenv
(
)
if
__name__
=
=
"
__main__
"
:
    
run
(
)
