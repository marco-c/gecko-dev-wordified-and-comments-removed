#
include
<
Python
.
h
>
extern
int
PSUTIL_TESTING
;
extern
int
PSUTIL_DEBUG
;
static
const
int
PSUTIL_CONN_NONE
=
128
;
#
if
PY_MAJOR_VERSION
<
3
#
define
PyUnicode_DecodeFSDefault
PyString_FromString
#
define
PyUnicode_DecodeFSDefaultAndSize
PyString_FromStringAndSize
#
endif
#
if
defined
(
PSUTIL_WINDOWS
)
&
&
\
defined
(
PYPY_VERSION
)
&
&
\
!
defined
(
PyErr_SetFromWindowsErrWithFilename
)
PyObject
*
PyErr_SetFromWindowsErrWithFilename
(
int
ierr
const
char
*
filename
)
;
#
endif
#
if
!
defined
(
SIZEOF_INT
)
#
define
SIZEOF_INT
4
#
endif
#
if
!
defined
(
SIZEOF_LONG
)
#
define
SIZEOF_LONG
8
#
endif
#
if
!
defined
(
SIZEOF_PID_T
)
#
define
SIZEOF_PID_T
PSUTIL_SIZEOF_PID_T
/
/
set
as
a
macro
in
setup
.
py
#
endif
#
ifndef
_Py_PARSE_PID
#
if
SIZEOF_PID_T
=
=
SIZEOF_INT
#
define
_Py_PARSE_PID
"
i
"
#
elif
SIZEOF_PID_T
=
=
SIZEOF_LONG
#
define
_Py_PARSE_PID
"
l
"
#
elif
defined
(
SIZEOF_LONG_LONG
)
&
&
SIZEOF_PID_T
=
=
SIZEOF_LONG_LONG
#
define
_Py_PARSE_PID
"
L
"
#
else
#
error
"
_Py_PARSE_PID
:
sizeof
(
pid_t
)
is
neither
sizeof
(
int
)
"
"
sizeof
(
long
)
or
sizeof
(
long
long
)
"
#
endif
#
endif
#
ifndef
PyLong_FromPid
#
if
(
(
SIZEOF_PID_T
=
=
SIZEOF_INT
)
|
|
(
SIZEOF_PID_T
=
=
SIZEOF_LONG
)
)
#
if
PY_MAJOR_VERSION
>
=
3
#
define
PyLong_FromPid
PyLong_FromLong
#
else
#
define
PyLong_FromPid
PyInt_FromLong
#
endif
#
elif
defined
(
SIZEOF_LONG_LONG
)
&
&
SIZEOF_PID_T
=
=
SIZEOF_LONG_LONG
#
define
PyLong_FromPid
PyLong_FromLongLong
#
else
#
error
"
PyLong_FromPid
:
sizeof
(
pid_t
)
is
neither
sizeof
(
int
)
"
"
sizeof
(
long
)
or
sizeof
(
long
long
)
"
#
endif
#
endif
PyObject
*
AccessDenied
(
const
char
*
msg
)
;
PyObject
*
NoSuchProcess
(
const
char
*
msg
)
;
PyObject
*
PyErr_SetFromOSErrnoWithSyscall
(
const
char
*
syscall
)
;
PyObject
*
psutil_set_testing
(
PyObject
*
self
PyObject
*
args
)
;
void
psutil_debug
(
const
char
*
format
.
.
.
)
;
int
psutil_setup
(
void
)
;
#
ifdef
PSUTIL_WINDOWS
#
include
<
windows
.
h
>
#
include
"
arch
/
windows
/
ntextapi
.
h
"
extern
int
PSUTIL_WINVER
;
extern
SYSTEM_INFO
PSUTIL_SYSTEM_INFO
;
extern
CRITICAL_SECTION
PSUTIL_CRITICAL_SECTION
;
#
define
PSUTIL_WINDOWS_VISTA
60
#
define
PSUTIL_WINDOWS_7
61
#
define
PSUTIL_WINDOWS_8
62
#
define
PSUTIL_WINDOWS_8_1
63
#
define
PSUTIL_WINDOWS_10
100
#
define
PSUTIL_WINDOWS_NEW
MAXLONG
#
define
MALLOC
(
x
)
HeapAlloc
(
GetProcessHeap
(
)
0
(
x
)
)
#
define
MALLOC_ZERO
(
x
)
HeapAlloc
(
GetProcessHeap
(
)
HEAP_ZERO_MEMORY
(
x
)
)
#
define
FREE
(
x
)
HeapFree
(
GetProcessHeap
(
)
0
(
x
)
)
#
define
LO_T
1e
-
7
#
define
HI_T
429
.
4967296
#
ifndef
AF_INET6
#
define
AF_INET6
23
#
endif
int
psutil_load_globals
(
)
;
PVOID
psutil_GetProcAddress
(
LPCSTR
libname
LPCSTR
procname
)
;
PVOID
psutil_GetProcAddressFromLib
(
LPCSTR
libname
LPCSTR
procname
)
;
PVOID
psutil_SetFromNTStatusErr
(
NTSTATUS
Status
const
char
*
syscall
)
;
double
psutil_FiletimeToUnixTime
(
FILETIME
ft
)
;
double
psutil_LargeIntegerToUnixTime
(
LARGE_INTEGER
li
)
;
#
endif
