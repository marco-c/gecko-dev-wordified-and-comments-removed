#
ifndef
RTP_DECODER_H
#
define
RTP_DECODER_H
#
include
"
srtp_priv
.
h
"
#
include
"
rtp
.
h
"
#
define
DEFAULT_RTP_OFFSET
42
typedef
enum
{
mode_rtp
=
0
mode_rtcp
mode_rtcp_mux
}
rtp_decoder_mode_t
;
typedef
struct
rtp_decoder_ctx_t
{
srtp_policy_t
policy
;
srtp_ctx_t
*
srtp_ctx
;
rtp_decoder_mode_t
mode
;
int
rtp_offset
;
struct
timeval
start_tv
;
int
frame_nr
;
int
error_cnt
;
int
rtp_cnt
;
int
rtcp_cnt
;
}
rtp_decoder_ctx_t
;
typedef
struct
rtp_decoder_ctx_t
*
rtp_decoder_t
;
void
hexdump
(
const
void
*
ptr
size_t
size
)
;
void
usage
(
char
*
prog_name
)
;
char
*
decode_sdes
(
char
*
in
char
*
out
)
;
void
rtp_decoder_handle_pkt
(
u_char
*
arg
const
struct
pcap_pkthdr
*
hdr
const
u_char
*
bytes
)
;
rtp_decoder_t
rtp_decoder_alloc
(
void
)
;
void
rtp_decoder_dealloc
(
rtp_decoder_t
rtp_ctx
)
;
int
rtp_decoder_init
(
rtp_decoder_t
dcdr
srtp_policy_t
policy
rtp_decoder_mode_t
mode
int
rtp_packet_offset
)
;
int
rtp_decoder_deinit
(
rtp_decoder_t
decoder
)
;
void
rtp_decoder_srtp_log_handler
(
srtp_log_level_t
level
const
char
*
msg
void
*
data
)
;
void
rtp_decoder_srtp_log_handler
(
srtp_log_level_t
level
const
char
*
msg
void
*
data
)
;
#
endif
