#
ifndef
RTP_DECODER_H
#
define
RTP_DECODER_H
#
include
"
srtp_priv
.
h
"
#
include
"
rtp
.
h
"
#
define
DEFAULT_RTP_OFFSET
42
typedef
struct
rtp_decoder_ctx_t
{
srtp_policy_t
policy
;
srtp_ctx_t
*
srtp_ctx
;
int
rtp_offset
;
struct
timeval
start_tv
;
int
frame_nr
;
rtp_msg_t
message
;
}
rtp_decoder_ctx_t
;
typedef
struct
rtp_decoder_ctx_t
*
rtp_decoder_t
;
void
rtp_print_error
(
srtp_err_status_t
status
char
*
message
)
;
void
hexdump
(
const
void
*
ptr
size_t
size
)
;
void
usage
(
char
*
prog_name
)
;
char
*
decode_sdes
(
char
*
in
char
*
out
)
;
void
rtp_decoder_handle_pkt
(
u_char
*
arg
const
struct
pcap_pkthdr
*
hdr
const
u_char
*
bytes
)
;
rtp_decoder_t
rtp_decoder_alloc
(
void
)
;
void
rtp_decoder_dealloc
(
rtp_decoder_t
rtp_ctx
)
;
int
rtp_decoder_init
(
rtp_decoder_t
dcdr
srtp_policy_t
policy
)
;
srtp_err_status_t
rtp_decoder_init_srtp
(
rtp_decoder_t
decoder
unsigned
int
ssrc
)
;
int
rtp_decoder_deinit_srtp
(
rtp_decoder_t
decoder
)
;
#
endif
