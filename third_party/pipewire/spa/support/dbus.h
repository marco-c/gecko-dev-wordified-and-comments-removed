#
ifndef
SPA_DBUS_H
#
define
SPA_DBUS_H
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
#
include
<
spa
/
support
/
loop
.
h
>
#
ifndef
SPA_API_DBUS
#
ifdef
SPA_API_IMPL
#
define
SPA_API_DBUS
SPA_API_IMPL
#
else
#
define
SPA_API_DBUS
static
inline
#
endif
#
endif
#
define
SPA_TYPE_INTERFACE_DBus
SPA_TYPE_INFO_INTERFACE_BASE
"
DBus
"
#
define
SPA_VERSION_DBUS
0
struct
spa_dbus
{
struct
spa_interface
iface
;
}
;
enum
spa_dbus_type
{
SPA_DBUS_TYPE_SESSION
SPA_DBUS_TYPE_SYSTEM
SPA_DBUS_TYPE_STARTER
}
;
#
define
SPA_DBUS_CONNECTION_EVENT_DESTROY
0
#
define
SPA_DBUS_CONNECTION_EVENT_DISCONNECTED
1
#
define
SPA_DBUS_CONNECTION_EVENT_NUM
2
struct
spa_dbus_connection_events
{
#
define
SPA_VERSION_DBUS_CONNECTION_EVENTS
0
uint32_t
version
;
void
(
*
destroy
)
(
void
*
data
)
;
void
(
*
disconnected
)
(
void
*
data
)
;
}
;
struct
spa_dbus_connection
{
#
define
SPA_VERSION_DBUS_CONNECTION
1
uint32_t
version
;
void
*
(
*
get
)
(
struct
spa_dbus_connection
*
conn
)
;
void
(
*
destroy
)
(
struct
spa_dbus_connection
*
conn
)
;
void
(
*
add_listener
)
(
struct
spa_dbus_connection
*
conn
struct
spa_hook
*
listener
const
struct
spa_dbus_connection_events
*
events
void
*
data
)
;
}
;
SPA_API_DBUS
void
*
spa_dbus_connection_get
(
struct
spa_dbus_connection
*
conn
)
{
return
spa_api_func_r
(
void
*
NULL
conn
get
0
)
;
}
SPA_API_DBUS
void
spa_dbus_connection_destroy
(
struct
spa_dbus_connection
*
conn
)
{
spa_api_func_v
(
conn
destroy
0
)
;
}
SPA_API_DBUS
void
spa_dbus_connection_add_listener
(
struct
spa_dbus_connection
*
conn
struct
spa_hook
*
listener
const
struct
spa_dbus_connection_events
*
events
void
*
data
)
{
spa_api_func_v
(
conn
add_listener
1
listener
events
data
)
;
}
struct
spa_dbus_methods
{
#
define
SPA_VERSION_DBUS_METHODS
0
uint32_t
version
;
struct
spa_dbus_connection
*
(
*
get_connection
)
(
void
*
object
enum
spa_dbus_type
type
)
;
}
;
SPA_API_DBUS
struct
spa_dbus_connection
*
spa_dbus_get_connection
(
struct
spa_dbus
*
dbus
enum
spa_dbus_type
type
)
{
return
spa_api_method_r
(
struct
spa_dbus_connection
*
NULL
spa_dbus
&
dbus
-
>
iface
get_connection
0
type
)
;
}
#
ifdef
__cplusplus
}
#
endif
#
endif
