#
ifndef
SPA_PLUGIN_H
#
define
SPA_PLUGIN_H
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
#
include
<
spa
/
utils
/
defs
.
h
>
#
include
<
spa
/
utils
/
dict
.
h
>
struct
spa_handle
{
#
define
SPA_VERSION_HANDLE
0
uint32_t
version
;
int
(
*
get_interface
)
(
struct
spa_handle
*
handle
const
char
*
type
void
*
*
interface
)
;
int
(
*
clear
)
(
struct
spa_handle
*
handle
)
;
}
;
#
define
spa_handle_get_interface
(
h
.
.
.
)
(
h
)
-
>
get_interface
(
(
h
)
__VA_ARGS__
)
#
define
spa_handle_clear
(
h
)
(
h
)
-
>
clear
(
(
h
)
)
struct
spa_interface_info
{
const
char
*
type
;
}
;
struct
spa_support
{
const
char
*
type
;
void
*
data
;
}
;
static
inline
void
*
spa_support_find
(
const
struct
spa_support
*
support
uint32_t
n_support
const
char
*
type
)
{
uint32_t
i
;
for
(
i
=
0
;
i
<
n_support
;
i
+
+
)
{
if
(
strcmp
(
support
[
i
]
.
type
type
)
=
=
0
)
return
support
[
i
]
.
data
;
}
return
NULL
;
}
#
define
SPA_SUPPORT_INIT
(
type
data
)
(
struct
spa_support
)
{
(
type
)
(
data
)
}
struct
spa_handle_factory
{
#
define
SPA_VERSION_HANDLE_FACTORY
1
uint32_t
version
;
const
char
*
name
;
const
struct
spa_dict
*
info
;
size_t
(
*
get_size
)
(
const
struct
spa_handle_factory
*
factory
const
struct
spa_dict
*
params
)
;
int
(
*
init
)
(
const
struct
spa_handle_factory
*
factory
struct
spa_handle
*
handle
const
struct
spa_dict
*
info
const
struct
spa_support
*
support
uint32_t
n_support
)
;
int
(
*
enum_interface_info
)
(
const
struct
spa_handle_factory
*
factory
const
struct
spa_interface_info
*
*
info
uint32_t
*
index
)
;
}
;
#
define
spa_handle_factory_get_size
(
h
.
.
.
)
(
h
)
-
>
get_size
(
(
h
)
__VA_ARGS__
)
#
define
spa_handle_factory_init
(
h
.
.
.
)
(
h
)
-
>
init
(
(
h
)
__VA_ARGS__
)
#
define
spa_handle_factory_enum_interface_info
(
h
.
.
.
)
(
h
)
-
>
enum_interface_info
(
(
h
)
__VA_ARGS__
)
typedef
int
(
*
spa_handle_factory_enum_func_t
)
(
const
struct
spa_handle_factory
*
*
factory
uint32_t
*
index
)
;
#
define
SPA_HANDLE_FACTORY_ENUM_FUNC_NAME
"
spa_handle_factory_enum
"
int
spa_handle_factory_enum
(
const
struct
spa_handle_factory
*
*
factory
uint32_t
*
index
)
;
#
define
SPA_KEY_FACTORY_NAME
"
factory
.
name
"
/
*
*
<
the
name
of
a
factory
*
/
#
define
SPA_KEY_FACTORY_AUTHOR
"
factory
.
author
"
/
*
*
<
a
comma
separated
list
of
factory
authors
*
/
#
define
SPA_KEY_FACTORY_DESCRIPTION
"
factory
.
description
"
/
*
*
<
description
of
a
factory
*
/
#
define
SPA_KEY_FACTORY_USAGE
"
factory
.
usage
"
/
*
*
<
usage
of
a
factory
*
/
#
define
SPA_KEY_LIBRARY_NAME
"
library
.
name
"
/
*
*
<
the
name
of
a
library
.
This
is
usually
*
the
filename
of
the
plugin
without
the
*
path
or
the
plugin
extension
.
*
/
#
ifdef
__cplusplus
}
#
endif
#
endif
