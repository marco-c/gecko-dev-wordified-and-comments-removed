#
include
"
src
/
cpu
.
h
"
decl_pal_idx_finish_fn
(
dav1d_pal_idx_finish_ssse3
)
;
decl_pal_idx_finish_fn
(
dav1d_pal_idx_finish_avx2
)
;
decl_pal_idx_finish_fn
(
dav1d_pal_idx_finish_avx512icl
)
;
static
ALWAYS_INLINE
void
pal_dsp_init_x86
(
Dav1dPalDSPContext
*
const
c
)
{
const
unsigned
flags
=
dav1d_get_cpu_flags
(
)
;
if
(
!
(
flags
&
DAV1D_X86_CPU_FLAG_SSSE3
)
)
return
;
c
-
>
pal_idx_finish
=
dav1d_pal_idx_finish_ssse3
;
#
if
ARCH_X86_64
if
(
!
(
flags
&
DAV1D_X86_CPU_FLAG_AVX2
)
)
return
;
c
-
>
pal_idx_finish
=
dav1d_pal_idx_finish_avx2
;
if
(
!
(
flags
&
DAV1D_X86_CPU_FLAG_AVX512ICL
)
)
return
;
c
-
>
pal_idx_finish
=
dav1d_pal_idx_finish_avx512icl
;
#
endif
}
