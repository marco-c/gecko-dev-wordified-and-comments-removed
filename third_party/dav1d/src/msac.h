#
ifndef
__DAV1D_SRC_MSAC_H__
#
define
__DAV1D_SRC_MSAC_H__
#
include
<
stdint
.
h
>
#
include
<
stdlib
.
h
>
typedef
uint64_t
ec_win
;
typedef
struct
MsacContext
{
const
uint8_t
*
buf_pos
;
const
uint8_t
*
buf_end
;
ec_win
dif
;
uint16_t
rng
;
int
cnt
;
int
allow_update_cdf
;
}
MsacContext
;
#
define
EC_PROB_SHIFT
6
#
define
EC_BOOL_EPROB
256
void
msac_init
(
MsacContext
*
c
const
uint8_t
*
data
size_t
sz
int
disable_cdf_update_flag
)
;
unsigned
msac_decode_symbol
(
MsacContext
*
s
const
uint16_t
*
cdf
const
unsigned
n_symbols
)
;
unsigned
msac_decode_symbol_adapt
(
MsacContext
*
s
uint16_t
*
cdf
const
unsigned
n_symbols
)
;
unsigned
msac_decode_bool
(
MsacContext
*
s
unsigned
f
)
;
unsigned
msac_decode_bool_adapt
(
MsacContext
*
s
uint16_t
*
cdf
)
;
unsigned
msac_decode_bools
(
MsacContext
*
c
unsigned
l
)
;
int
msac_decode_subexp
(
MsacContext
*
c
int
ref
int
n
unsigned
k
)
;
int
msac_decode_uniform
(
MsacContext
*
c
unsigned
n
)
;
#
endif
