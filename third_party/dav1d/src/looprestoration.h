#
ifndef
DAV1D_SRC_LOOPRESTORATION_H
#
define
DAV1D_SRC_LOOPRESTORATION_H
#
include
<
stdint
.
h
>
#
include
<
stddef
.
h
>
#
include
"
common
/
bitdepth
.
h
"
enum
LrEdgeFlags
{
LR_HAVE_LEFT
=
1
<
<
0
LR_HAVE_RIGHT
=
1
<
<
1
LR_HAVE_TOP
=
1
<
<
2
LR_HAVE_BOTTOM
=
1
<
<
3
}
;
#
ifdef
BITDEPTH
typedef
const
pixel
(
*
const_left_pixel_row
)
[
4
]
;
#
else
typedef
const
void
*
const_left_pixel_row
;
#
endif
#
define
decl_wiener_filter_fn
(
name
)
\
void
(
name
)
(
pixel
*
dst
ptrdiff_t
dst_stride
\
const_left_pixel_row
left
\
const
pixel
*
lpf
ptrdiff_t
lpf_stride
\
int
w
int
h
const
int16_t
filterh
[
7
]
\
const
int16_t
filterv
[
7
]
enum
LrEdgeFlags
edges
\
HIGHBD_DECL_SUFFIX
)
typedef
decl_wiener_filter_fn
(
*
wienerfilter_fn
)
;
#
define
decl_selfguided_filter_fn
(
name
)
\
void
(
name
)
(
pixel
*
dst
ptrdiff_t
dst_stride
\
const_left_pixel_row
left
\
const
pixel
*
lpf
ptrdiff_t
lpf_stride
\
int
w
int
h
int
sgr_idx
const
int16_t
sgr_w
[
2
]
\
const
enum
LrEdgeFlags
edges
HIGHBD_DECL_SUFFIX
)
typedef
decl_selfguided_filter_fn
(
*
selfguided_fn
)
;
typedef
struct
Dav1dLoopRestorationDSPContext
{
wienerfilter_fn
wiener
;
selfguided_fn
selfguided
;
}
Dav1dLoopRestorationDSPContext
;
bitfn_decls
(
void
dav1d_loop_restoration_dsp_init
Dav1dLoopRestorationDSPContext
*
c
)
;
bitfn_decls
(
void
dav1d_loop_restoration_dsp_init_arm
Dav1dLoopRestorationDSPContext
*
c
)
;
bitfn_decls
(
void
dav1d_loop_restoration_dsp_init_x86
Dav1dLoopRestorationDSPContext
*
c
)
;
#
endif
