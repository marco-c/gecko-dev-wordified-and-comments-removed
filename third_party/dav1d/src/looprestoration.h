#
ifndef
DAV1D_SRC_LOOPRESTORATION_H
#
define
DAV1D_SRC_LOOPRESTORATION_H
#
include
<
stdint
.
h
>
#
include
<
stddef
.
h
>
#
include
"
common
/
bitdepth
.
h
"
enum
LrEdgeFlags
{
LR_HAVE_LEFT
=
1
<
<
0
LR_HAVE_RIGHT
=
1
<
<
1
LR_HAVE_TOP
=
1
<
<
2
LR_HAVE_BOTTOM
=
1
<
<
3
}
;
#
ifdef
BITDEPTH
typedef
const
pixel
(
*
const_left_pixel_row
)
[
4
]
;
#
else
typedef
const
void
*
const_left_pixel_row
;
#
endif
typedef
union
LooprestorationParams
{
ALIGN
(
int16_t
filter
[
2
]
[
8
]
16
)
;
struct
{
uint32_t
s0
s1
;
int16_t
w0
w1
;
}
sgr
;
}
LooprestorationParams
;
#
define
decl_lr_filter_fn
(
name
)
\
void
(
name
)
(
pixel
*
dst
ptrdiff_t
dst_stride
\
const_left_pixel_row
left
\
const
pixel
*
lpf
ptrdiff_t
lpf_stride
\
int
w
int
h
const
LooprestorationParams
*
params
\
enum
LrEdgeFlags
edges
HIGHBD_DECL_SUFFIX
)
typedef
decl_lr_filter_fn
(
*
looprestorationfilter_fn
)
;
typedef
struct
Dav1dLoopRestorationDSPContext
{
looprestorationfilter_fn
wiener
[
2
]
;
looprestorationfilter_fn
sgr
[
3
]
;
}
Dav1dLoopRestorationDSPContext
;
bitfn_decls
(
void
dav1d_loop_restoration_dsp_init
Dav1dLoopRestorationDSPContext
*
c
int
bpc
)
;
bitfn_decls
(
void
dav1d_loop_restoration_dsp_init_arm
Dav1dLoopRestorationDSPContext
*
c
int
bpc
)
;
bitfn_decls
(
void
dav1d_loop_restoration_dsp_init_x86
Dav1dLoopRestorationDSPContext
*
c
int
bpc
)
;
bitfn_decls
(
void
dav1d_loop_restoration_dsp_init_ppc
Dav1dLoopRestorationDSPContext
*
c
int
bpc
)
;
#
endif
