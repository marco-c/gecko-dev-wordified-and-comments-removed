#
ifndef
DAV1D_SRC_IPRED_PREPARE_H
#
define
DAV1D_SRC_IPRED_PREPARE_H
#
include
<
stddef
.
h
>
#
include
<
stdint
.
h
>
#
include
"
common
/
bitdepth
.
h
"
#
include
"
src
/
env
.
h
"
#
include
"
src
/
intra_edge
.
h
"
#
include
"
src
/
levels
.
h
"
enum
IntraPredMode
bytefn
(
dav1d_prepare_intra_edges
)
(
int
x
int
have_left
int
y
int
have_top
int
w
int
h
enum
EdgeFlags
edge_flags
const
pixel
*
dst
ptrdiff_t
stride
const
pixel
*
prefilter_toplevel_sb_edge
enum
IntraPredMode
mode
int
*
angle
int
tw
int
th
int
filter_edge
pixel
*
topleft_out
HIGHBD_DECL_SUFFIX
)
;
#
define
ANGLE_USE_EDGE_FILTER_FLAG
1024
#
define
ANGLE_SMOOTH_EDGE_FLAG
512
static
inline
int
sm_flag
(
const
BlockContext
*
const
b
const
int
idx
)
{
if
(
!
b
-
>
intra
[
idx
]
)
return
0
;
const
enum
IntraPredMode
m
=
b
-
>
mode
[
idx
]
;
return
(
m
=
=
SMOOTH_PRED
|
|
m
=
=
SMOOTH_H_PRED
|
|
m
=
=
SMOOTH_V_PRED
)
?
ANGLE_SMOOTH_EDGE_FLAG
:
0
;
}
static
inline
int
sm_uv_flag
(
const
BlockContext
*
const
b
const
int
idx
)
{
const
enum
IntraPredMode
m
=
b
-
>
uvmode
[
idx
]
;
return
(
m
=
=
SMOOTH_PRED
|
|
m
=
=
SMOOTH_H_PRED
|
|
m
=
=
SMOOTH_V_PRED
)
?
ANGLE_SMOOTH_EDGE_FLAG
:
0
;
}
#
endif
