#
include
"
config
.
h
"
#
include
"
common
/
attributes
.
h
"
#
include
"
src
/
loongarch
/
cpu
.
h
"
#
if
defined
(
HAVE_GETAUXVAL
)
#
include
<
sys
/
auxv
.
h
>
#
define
LA_HWCAP_LSX
(
1
<
<
4
)
#
define
LA_HWCAP_LASX
(
1
<
<
5
)
#
endif
COLD
unsigned
dav1d_get_cpu_flags_loongarch
(
void
)
{
unsigned
flags
=
0
;
#
if
defined
(
HAVE_GETAUXVAL
)
unsigned
long
hw_cap
=
getauxval
(
AT_HWCAP
)
;
flags
|
=
(
hw_cap
&
LA_HWCAP_LSX
)
?
DAV1D_LOONGARCH_CPU_FLAG_LSX
:
0
;
flags
|
=
(
hw_cap
&
LA_HWCAP_LASX
)
?
DAV1D_LOONGARCH_CPU_FLAG_LASX
:
0
;
#
endif
return
flags
;
}
