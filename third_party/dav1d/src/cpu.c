#
include
"
config
.
h
"
#
include
<
stdint
.
h
>
#
include
"
src
/
cpu
.
h
"
static
unsigned
flags_mask
=
-
1
;
COLD
unsigned
dav1d_get_cpu_flags
(
void
)
{
static
unsigned
flags
;
static
uint8_t
checked
=
0
;
if
(
!
checked
)
{
#
if
(
ARCH_AARCH64
|
|
ARCH_ARM
)
&
&
HAVE_ASM
flags
=
dav1d_get_cpu_flags_arm
(
)
;
#
elif
ARCH_PPC64LE
&
&
HAVE_ASM
flags
=
dav1d_get_cpu_flags_ppc
(
)
;
#
elif
ARCH_X86
&
&
HAVE_ASM
flags
=
dav1d_get_cpu_flags_x86
(
)
;
#
else
flags
=
0
;
#
endif
checked
=
1
;
}
return
flags
&
flags_mask
;
}
COLD
void
dav1d_set_cpu_flags_mask
(
const
unsigned
mask
)
{
flags_mask
=
mask
;
}
