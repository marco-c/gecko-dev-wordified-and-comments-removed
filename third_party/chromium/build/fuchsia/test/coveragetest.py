"
"
"
Ensure
files
in
the
directory
are
thoroughly
tested
.
"
"
"
import
io
import
sys
import
unittest
import
coverage
def
main
(
)
:
    
"
"
"
Gather
coverage
data
ensure
included
files
are
100
%
covered
.
"
"
"
    
cov
=
coverage
.
coverage
(
data_file
=
None
                            
include
=
'
publish_package
.
py
'
                            
config_file
=
True
)
    
cov
.
start
(
)
    
import
publish_package_unittests
    
suite
=
unittest
.
TestLoader
(
)
.
loadTestsFromModule
(
        
publish_package_unittests
)
    
if
not
unittest
.
TextTestRunner
(
)
.
run
(
suite
)
.
wasSuccessful
(
)
:
        
return
1
    
cov
.
stop
(
)
    
outf
=
io
.
StringIO
(
)
    
percentage
=
cov
.
report
(
file
=
outf
show_missing
=
True
)
    
if
int
(
percentage
)
!
=
100
:
        
print
(
outf
.
getvalue
(
)
)
        
print
(
'
FATAL
:
Insufficient
coverage
(
%
.
f
%
%
)
'
%
int
(
percentage
)
)
        
return
1
    
return
0
if
__name__
=
=
'
__main__
'
:
    
sys
.
exit
(
main
(
)
)
