import
argparse
import
os
import
plist_util
import
sys
def
Main
(
)
:
  
parser
=
argparse
.
ArgumentParser
(
      
description
=
'
A
script
to
write
PkgInfo
files
for
.
app
bundles
.
'
)
  
parser
.
add_argument
(
'
-
-
plist
'
                      
required
=
True
                      
help
=
'
Path
to
the
Info
.
plist
for
the
.
app
.
'
)
  
parser
.
add_argument
(
'
-
-
output
'
                      
required
=
True
                      
help
=
'
Path
to
the
desired
output
file
.
'
)
  
args
=
parser
.
parse_args
(
)
  
try
:
    
os
.
unlink
(
args
.
output
)
  
except
FileNotFoundError
:
    
pass
  
plist
=
plist_util
.
LoadPList
(
args
.
plist
)
  
package_type
=
plist
[
'
CFBundlePackageType
'
]
  
if
package_type
!
=
'
APPL
'
:
    
raise
ValueError
(
'
Expected
CFBundlePackageType
to
be
%
s
got
%
s
'
%
\
        
(
'
APPL
'
package_type
)
)
  
signature_code
=
plist
.
get
(
'
CFBundleSignature
'
'
?
?
?
?
'
)
  
if
len
(
signature_code
)
!
=
4
:
    
raise
ValueError
(
'
CFBundleSignature
should
be
exactly
four
characters
'
+
                     
'
got
%
s
'
%
signature_code
)
  
with
open
(
args
.
output
'
w
'
)
as
fp
:
    
fp
.
write
(
'
%
s
%
s
'
%
(
package_type
signature_code
)
)
  
return
0
if
__name__
=
=
'
__main__
'
:
  
sys
.
exit
(
Main
(
)
)
