use
core
:
:
cell
:
:
UnsafeCell
;
use
core
:
:
ffi
:
:
c_int
;
use
core
:
:
ffi
:
:
c_void
;
use
core
:
:
marker
:
:
{
PhantomData
PhantomPinned
}
;
#
[
repr
(
C
)
]
#
[
allow
(
missing_debug_implementations
)
]
pub
struct
Class
{
#
[
cfg
(
not
(
any
(
feature
=
"
gnustep
-
1
-
7
"
feature
=
"
unstable
-
objfw
"
)
)
)
]
_priv
:
[
*
mut
c_void
;
32
]
#
[
cfg
(
any
(
feature
=
"
gnustep
-
1
-
7
"
feature
=
"
unstable
-
objfw
"
)
)
]
_priv
:
[
u8
;
0
]
_opaque
:
UnsafeCell
<
PhantomData
<
(
*
const
UnsafeCell
<
(
)
>
PhantomPinned
)
>
>
}
extern
"
C
-
unwind
"
{
pub
static
_NSConcreteGlobalBlock
:
Class
;
pub
static
_NSConcreteStackBlock
:
Class
;
#
[
doc
(
alias
=
"
Block_copy
"
)
]
pub
fn
_Block_copy
(
block
:
*
const
c_void
)
-
>
*
mut
c_void
;
#
[
doc
(
alias
=
"
Block_release
"
)
]
pub
fn
_Block_release
(
block
:
*
const
c_void
)
;
pub
fn
_Block_object_assign
(
dest_addr
:
*
mut
c_void
object
:
*
const
c_void
flags
:
c_int
)
;
pub
fn
_Block_object_dispose
(
object
:
*
const
c_void
flags
:
c_int
)
;
}
#
[
allow
(
missing_docs
)
]
#
[
cfg
(
any
(
test
feature
=
"
unstable
-
private
"
)
)
]
pub
mod
private
{
use
super
:
:
*
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
feature
=
"
gnustep
-
1
-
7
"
)
)
]
use
core
:
:
ffi
:
:
c_char
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
feature
=
"
compiler
-
rt
"
)
)
]
use
core
:
:
ffi
:
:
c_ulong
;
extern
"
C
-
unwind
"
{
pub
static
_NSConcreteMallocBlock
:
Class
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
feature
=
"
compiler
-
rt
"
)
)
]
pub
static
_NSConcreteAutoBlock
:
Class
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
feature
=
"
compiler
-
rt
"
)
)
]
pub
static
_NSConcreteFinalizingBlock
:
Class
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
feature
=
"
compiler
-
rt
"
)
)
]
pub
static
_NSConcreteWeakBlockVariable
:
Class
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
feature
=
"
compiler
-
rt
"
)
)
]
pub
fn
Block_size
(
block
:
*
mut
c_void
)
-
>
c_ulong
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
)
)
]
pub
fn
_Block_use_stret
(
block
:
*
mut
c_void
)
-
>
bool
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
)
)
]
pub
fn
_Block_layout
(
block
:
*
mut
c_void
)
-
>
*
const
c_char
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
)
)
]
pub
fn
_Block_extended_layout
(
block
:
*
mut
c_void
)
-
>
*
const
c_char
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
)
)
]
pub
fn
_Block_tryRetain
(
block
:
*
const
c_void
)
-
>
bool
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
)
)
]
pub
fn
_Block_isDeallocating
(
block
:
*
const
c_void
)
-
>
bool
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
feature
=
"
gnustep
-
1
-
7
"
)
)
]
pub
fn
_Block_has_signature
(
block
:
*
mut
c_void
)
-
>
bool
;
#
[
cfg
(
any
(
doc
target_vendor
=
"
apple
"
feature
=
"
gnustep
-
1
-
7
"
)
)
]
pub
fn
_Block_signature
(
block
:
*
mut
c_void
)
-
>
*
const
c_char
;
}
}
#
[
cfg
(
test
)
]
mod
tests
{
use
super
:
:
*
;
use
core
:
:
ptr
;
#
[
test
]
fn
smoke
(
)
{
assert_eq
!
(
unsafe
{
_Block_copy
(
ptr
:
:
null_mut
(
)
)
}
ptr
:
:
null_mut
(
)
)
;
unsafe
{
_Block_release
(
ptr
:
:
null_mut
(
)
)
}
;
}
#
[
test
]
#
[
allow
(
unused_unsafe
)
]
#
[
cfg
(
feature
=
"
std
"
)
]
fn
test_linkable
(
)
{
use
std
:
:
println
;
println
!
(
"
{
:
?
}
"
unsafe
{
ptr
:
:
addr_of
!
(
_NSConcreteGlobalBlock
)
}
)
;
println
!
(
"
{
:
?
}
"
unsafe
{
ptr
:
:
addr_of
!
(
_NSConcreteStackBlock
)
}
)
;
println
!
(
"
{
:
?
}
"
unsafe
{
ptr
:
:
addr_of
!
(
private
:
:
_NSConcreteMallocBlock
)
}
)
;
println
!
(
"
{
:
p
}
"
_Block_copy
as
unsafe
extern
"
C
-
unwind
"
fn
(
_
)
-
>
_
)
;
println
!
(
"
{
:
p
}
"
_Block_object_assign
as
unsafe
extern
"
C
-
unwind
"
fn
(
_
_
_
)
)
;
println
!
(
"
{
:
p
}
"
_Block_object_dispose
as
unsafe
extern
"
C
-
unwind
"
fn
(
_
_
)
)
;
println
!
(
"
{
:
p
}
"
_Block_release
as
unsafe
extern
"
C
-
unwind
"
fn
(
_
)
)
;
}
}
