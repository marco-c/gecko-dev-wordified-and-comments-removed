#
!
[
allow
(
unsafe_code
)
]
use
crate
:
:
backend
;
use
backend
:
:
c
;
use
backend
:
:
fd
:
:
{
BorrowedFd
RawFd
}
;
#
[
doc
(
alias
=
"
AT_FDCWD
"
)
]
pub
const
CWD
:
BorrowedFd
<
'
static
>
=
unsafe
{
BorrowedFd
:
:
<
'
static
>
:
:
borrow_raw
(
c
:
:
AT_FDCWD
as
RawFd
)
}
;
pub
const
ABS
:
BorrowedFd
<
'
static
>
=
unsafe
{
BorrowedFd
:
:
<
'
static
>
:
:
borrow_raw
(
c
:
:
EBADF
.
wrapping_neg
(
)
as
RawFd
)
}
;
#
[
cfg
(
test
)
]
mod
tests
{
use
super
:
:
*
;
use
crate
:
:
fd
:
:
AsRawFd
;
#
[
test
]
fn
test_cwd
(
)
{
assert
!
(
CWD
.
as_raw_fd
(
)
!
=
-
1
)
;
#
[
cfg
(
linux_kernel
)
]
#
[
cfg
(
feature
=
"
io_uring
"
)
]
assert
!
(
CWD
.
as_raw_fd
(
)
!
=
linux_raw_sys
:
:
io_uring
:
:
IORING_REGISTER_FILES_SKIP
)
;
}
#
[
test
]
fn
test_abs
(
)
{
assert
!
(
ABS
.
as_raw_fd
(
)
<
0
)
;
assert
!
(
ABS
.
as_raw_fd
(
)
!
=
-
1
)
;
assert
!
(
ABS
.
as_raw_fd
(
)
!
=
c
:
:
AT_FDCWD
)
;
#
[
cfg
(
linux_kernel
)
]
#
[
cfg
(
feature
=
"
io_uring
"
)
]
assert
!
(
ABS
.
as_raw_fd
(
)
!
=
linux_raw_sys
:
:
io_uring
:
:
IORING_REGISTER_FILES_SKIP
)
;
}
}
