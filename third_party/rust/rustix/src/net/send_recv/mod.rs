#
[
cfg
(
unix
)
]
use
crate
:
:
net
:
:
SocketAddrUnix
;
use
crate
:
:
net
:
:
{
SocketAddr
SocketAddrAny
SocketAddrV4
SocketAddrV6
}
;
use
crate
:
:
{
backend
io
}
;
use
backend
:
:
fd
:
:
{
AsFd
BorrowedFd
}
;
pub
use
backend
:
:
net
:
:
send_recv
:
:
{
RecvFlags
SendFlags
}
;
#
[
cfg
(
not
(
any
(
windows
target_os
=
"
espidf
"
target_os
=
"
redox
"
target_os
=
"
wasi
"
)
)
)
]
mod
msg
;
#
[
cfg
(
not
(
any
(
windows
target_os
=
"
espidf
"
target_os
=
"
redox
"
target_os
=
"
wasi
"
)
)
)
]
pub
use
msg
:
:
*
;
#
[
inline
]
pub
fn
recv
<
Fd
:
AsFd
>
(
fd
:
Fd
buf
:
&
mut
[
u8
]
flags
:
RecvFlags
)
-
>
io
:
:
Result
<
usize
>
{
backend
:
:
net
:
:
syscalls
:
:
recv
(
fd
.
as_fd
(
)
buf
flags
)
}
#
[
inline
]
pub
fn
send
<
Fd
:
AsFd
>
(
fd
:
Fd
buf
:
&
[
u8
]
flags
:
SendFlags
)
-
>
io
:
:
Result
<
usize
>
{
backend
:
:
net
:
:
syscalls
:
:
send
(
fd
.
as_fd
(
)
buf
flags
)
}
#
[
inline
]
pub
fn
recvfrom
<
Fd
:
AsFd
>
(
fd
:
Fd
buf
:
&
mut
[
u8
]
flags
:
RecvFlags
)
-
>
io
:
:
Result
<
(
usize
Option
<
SocketAddrAny
>
)
>
{
backend
:
:
net
:
:
syscalls
:
:
recvfrom
(
fd
.
as_fd
(
)
buf
flags
)
}
pub
fn
sendto
<
Fd
:
AsFd
>
(
fd
:
Fd
buf
:
&
[
u8
]
flags
:
SendFlags
addr
:
&
SocketAddr
)
-
>
io
:
:
Result
<
usize
>
{
_sendto
(
fd
.
as_fd
(
)
buf
flags
addr
)
}
fn
_sendto
(
fd
:
BorrowedFd
<
'
_
>
buf
:
&
[
u8
]
flags
:
SendFlags
addr
:
&
SocketAddr
)
-
>
io
:
:
Result
<
usize
>
{
match
addr
{
SocketAddr
:
:
V4
(
v4
)
=
>
backend
:
:
net
:
:
syscalls
:
:
sendto_v4
(
fd
buf
flags
v4
)
SocketAddr
:
:
V6
(
v6
)
=
>
backend
:
:
net
:
:
syscalls
:
:
sendto_v6
(
fd
buf
flags
v6
)
}
}
pub
fn
sendto_any
<
Fd
:
AsFd
>
(
fd
:
Fd
buf
:
&
[
u8
]
flags
:
SendFlags
addr
:
&
SocketAddrAny
)
-
>
io
:
:
Result
<
usize
>
{
_sendto_any
(
fd
.
as_fd
(
)
buf
flags
addr
)
}
fn
_sendto_any
(
fd
:
BorrowedFd
<
'
_
>
buf
:
&
[
u8
]
flags
:
SendFlags
addr
:
&
SocketAddrAny
)
-
>
io
:
:
Result
<
usize
>
{
match
addr
{
SocketAddrAny
:
:
V4
(
v4
)
=
>
backend
:
:
net
:
:
syscalls
:
:
sendto_v4
(
fd
buf
flags
v4
)
SocketAddrAny
:
:
V6
(
v6
)
=
>
backend
:
:
net
:
:
syscalls
:
:
sendto_v6
(
fd
buf
flags
v6
)
#
[
cfg
(
unix
)
]
SocketAddrAny
:
:
Unix
(
unix
)
=
>
backend
:
:
net
:
:
syscalls
:
:
sendto_unix
(
fd
buf
flags
unix
)
}
}
#
[
inline
]
#
[
doc
(
alias
=
"
sendto
"
)
]
pub
fn
sendto_v4
<
Fd
:
AsFd
>
(
fd
:
Fd
buf
:
&
[
u8
]
flags
:
SendFlags
addr
:
&
SocketAddrV4
)
-
>
io
:
:
Result
<
usize
>
{
backend
:
:
net
:
:
syscalls
:
:
sendto_v4
(
fd
.
as_fd
(
)
buf
flags
addr
)
}
#
[
inline
]
#
[
doc
(
alias
=
"
sendto
"
)
]
pub
fn
sendto_v6
<
Fd
:
AsFd
>
(
fd
:
Fd
buf
:
&
[
u8
]
flags
:
SendFlags
addr
:
&
SocketAddrV6
)
-
>
io
:
:
Result
<
usize
>
{
backend
:
:
net
:
:
syscalls
:
:
sendto_v6
(
fd
.
as_fd
(
)
buf
flags
addr
)
}
#
[
cfg
(
unix
)
]
#
[
inline
]
#
[
doc
(
alias
=
"
sendto
"
)
]
pub
fn
sendto_unix
<
Fd
:
AsFd
>
(
fd
:
Fd
buf
:
&
[
u8
]
flags
:
SendFlags
addr
:
&
SocketAddrUnix
)
-
>
io
:
:
Result
<
usize
>
{
backend
:
:
net
:
:
syscalls
:
:
sendto_unix
(
fd
.
as_fd
(
)
buf
flags
addr
)
}
