use
crate
:
:
error
:
:
*
;
pub
fn
verify_slices_are_equal
(
a
:
&
[
u8
]
b
:
&
[
u8
]
)
-
>
Result
<
(
)
>
{
if
nss
:
:
secport
:
:
secure_memcmp
(
a
b
)
?
{
Ok
(
(
)
)
}
else
{
Err
(
ErrorKind
:
:
InternalError
.
into
(
)
)
}
}
#
[
cfg
(
test
)
]
mod
tests
{
use
super
:
:
*
;
use
nss
:
:
ensure_initialized
;
#
[
test
]
fn
does_compare
(
)
{
ensure_initialized
(
)
;
assert
!
(
verify_slices_are_equal
(
b
"
bobo
"
b
"
bobo
"
)
.
is_ok
(
)
)
;
assert
!
(
verify_slices_are_equal
(
b
"
bobo
"
b
"
obob
"
)
.
is_err
(
)
)
;
assert
!
(
verify_slices_are_equal
(
b
"
bobo
"
b
"
notbobo
"
)
.
is_err
(
)
)
;
}
}
