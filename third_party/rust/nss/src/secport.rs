use
crate
:
:
util
:
:
ensure_nss_initialized
;
use
std
:
:
{
convert
:
:
TryInto
os
:
:
raw
:
:
c_void
}
;
pub
fn
secure_memcmp
(
a
:
&
[
u8
]
b
:
&
[
u8
]
)
-
>
bool
{
ensure_nss_initialized
(
)
;
if
a
.
len
(
)
!
=
b
.
len
(
)
{
return
false
;
}
let
result
=
unsafe
{
nss_sys
:
:
NSS_SecureMemcmp
(
a
.
as_ptr
(
)
as
*
const
c_void
b
.
as_ptr
(
)
as
*
const
c_void
a
.
len
(
)
.
try_into
(
)
.
unwrap
(
)
)
}
;
result
=
=
0
}
