use
crate
:
:
error
:
:
*
;
use
crate
:
:
util
:
:
assert_nss_initialized
;
use
std
:
:
os
:
:
raw
:
:
c_void
;
pub
fn
secure_memcmp
(
a
:
&
[
u8
]
b
:
&
[
u8
]
)
-
>
Result
<
bool
>
{
assert_nss_initialized
(
)
;
if
a
.
len
(
)
!
=
b
.
len
(
)
{
return
Ok
(
false
)
;
}
let
result
=
unsafe
{
nss_sys
:
:
NSS_SecureMemcmp
(
a
.
as_ptr
(
)
as
*
const
c_void
b
.
as_ptr
(
)
as
*
const
c_void
a
.
len
(
)
)
}
;
Ok
(
result
=
=
0
)
}
