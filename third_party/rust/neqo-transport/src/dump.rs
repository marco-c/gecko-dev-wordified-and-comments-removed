use
crate
:
:
connection
:
:
Connection
;
use
crate
:
:
frame
:
:
decode_frame
;
use
crate
:
:
packet
:
:
PacketHdr
;
use
neqo_common
:
:
{
qdebug
Decoder
}
;
#
[
allow
(
clippy
:
:
module_name_repetitions
)
]
pub
fn
dump_packet
(
conn
:
&
Connection
dir
:
&
str
hdr
:
&
PacketHdr
payload
:
&
[
u8
]
)
{
let
mut
s
=
String
:
:
from
(
"
"
)
;
let
mut
d
=
Decoder
:
:
from
(
payload
)
;
while
d
.
remaining
(
)
>
0
{
let
f
=
match
decode_frame
(
&
mut
d
)
{
Ok
(
f
)
=
>
f
Err
(
_
)
=
>
{
s
.
push_str
(
"
[
broken
]
.
.
.
"
)
;
break
;
}
}
;
if
let
Some
(
x
)
=
f
.
dump
(
)
{
s
.
push_str
(
&
format
!
(
"
\
n
{
}
{
}
"
dir
&
x
)
)
;
}
}
qdebug
!
(
[
conn
]
"
pn
=
{
}
type
=
{
:
?
}
{
}
"
hdr
.
pn
hdr
.
tipe
s
)
;
}
