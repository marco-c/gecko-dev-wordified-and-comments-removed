#
!
[
cfg_attr
(
not
(
any
(
target_arch
=
"
wasm32
"
)
)
no_std
)
]
extern
crate
alloc
;
use
alloc
:
:
alloc
:
:
Layout
;
#
[
cfg
(
target_arch
=
"
wasm32
"
)
]
mod
wasm_glue
;
mod
writeable
;
pub
use
writeable
:
:
DiplomatWriteable
;
mod
result
;
pub
use
result
:
:
DiplomatResult
;
pub
type
DiplomatChar
=
u32
;
pub
type
DiplomatStr
=
[
u8
]
;
pub
type
DiplomatStr16
=
[
u16
]
;
pub
type
DiplomatByte
=
u8
;
#
[
no_mangle
]
pub
unsafe
extern
"
C
"
fn
diplomat_alloc
(
size
:
usize
align
:
usize
)
-
>
*
mut
u8
{
alloc
:
:
alloc
:
:
alloc
(
Layout
:
:
from_size_align
(
size
align
)
.
unwrap
(
)
)
}
#
[
no_mangle
]
pub
unsafe
extern
"
C
"
fn
diplomat_free
(
ptr
:
*
mut
u8
size
:
usize
align
:
usize
)
{
alloc
:
:
alloc
:
:
dealloc
(
ptr
Layout
:
:
from_size_align
(
size
align
)
.
unwrap
(
)
)
}
