use
core
:
:
num
:
:
NonZeroU32
;
use
crate
:
:
Error
;
pub
fn
getrandom_inner
(
dest
:
&
mut
[
u8
]
)
-
>
Result
<
(
)
Error
>
{
let
errno
=
unsafe
{
cloudabi
:
:
random_get
(
dest
)
}
;
if
errno
=
=
cloudabi
:
:
errno
:
:
SUCCESS
{
Ok
(
(
)
)
}
else
{
let
code
=
NonZeroU32
:
:
new
(
errno
as
u32
)
.
unwrap
(
)
;
error
!
(
"
cloudabi
:
:
random_get
syscall
failed
with
code
{
}
"
code
)
;
Err
(
Error
:
:
from
(
code
)
)
}
}
#
[
inline
(
always
)
]
pub
fn
error_msg_inner
(
_
:
NonZeroU32
)
-
>
Option
<
&
'
static
str
>
{
None
}
