use
std
:
:
sync
:
:
Once
;
use
tracing_subscriber
:
:
{
fmt
prelude
:
:
*
EnvFilter
}
;
static
TESTING_SUBSCRIBER
:
Once
=
Once
:
:
new
(
)
;
pub
fn
init_for_tests
(
)
{
TESTING_SUBSCRIBER
.
call_once
(
|
|
{
tracing_subscriber
:
:
registry
(
)
.
with
(
fmt
:
:
layer
(
)
)
.
with
(
EnvFilter
:
:
from_default_env
(
)
)
.
init
(
)
;
}
)
;
}
pub
fn
init_for_tests_with_level
(
level
:
crate
:
:
Level
)
{
let
level
:
tracing
:
:
Level
=
level
.
into
(
)
;
TESTING_SUBSCRIBER
.
call_once
(
|
|
{
tracing_subscriber
:
:
registry
(
)
.
with
(
fmt
:
:
layer
(
)
)
.
with
(
EnvFilter
:
:
builder
(
)
.
with_default_directive
(
level
.
into
(
)
)
.
from_env_lossy
(
)
)
.
init
(
)
;
}
)
;
}
