use
shared
:
:
minwindef
:
:
{
BOOL
DWORD
PBOOL
PDWORD
PUCHAR
PULONG
ULONG
}
use
um
:
:
winnt
:
:
{
HANDLE
PACL
PCLAIM_SECURITY_ATTRIBUTES_INFORMATION
PHANDLE
PSID
PTOKEN_PRIVILEGES
}
extern
"
system
"
{
pub
fn
AddResourceAttributeAce
(
pAcl
:
PACL
dwAceRevision
:
DWORD
AceFlags
:
DWORD
AccessMask
:
DWORD
pSid
:
PSID
pAttributeInfo
:
PCLAIM_SECURITY_ATTRIBUTES_INFORMATION
pReturnLength
:
PDWORD
)
-
>
BOOL
;
pub
fn
AddScopedPolicyIDAce
(
pAcl
:
PACL
dwAceRevision
:
DWORD
AceFlags
:
DWORD
AccessMask
:
DWORD
pSid
:
PSID
)
-
>
BOOL
;
pub
fn
AdjustTokenPrivileges
(
TokenHandle
:
HANDLE
DisableAllPrivileges
:
BOOL
NewState
:
PTOKEN_PRIVILEGES
BufferLength
:
DWORD
PreviousState
:
PTOKEN_PRIVILEGES
ReturnLength
:
PDWORD
)
-
>
BOOL
;
pub
fn
AllocateLocallyUniqueId
(
Luid
:
PLUID
)
-
>
BOOL
;
pub
fn
AreAllAccessesGranted
(
GrantedAccess
:
DWORD
DesiredAccess
:
DWORD
)
-
>
BOOL
;
pub
fn
AreAnyAccessesGranted
(
GrantedAccess
:
DWORD
DesiredAccess
:
DWORD
)
-
>
BOOL
;
pub
fn
CheckTokenMembershipEx
(
TokenHandle
:
HANDLE
SidToCheck
:
PSID
Flags
:
DWORD
IsMember
:
PBOOL
)
-
>
BOOL
;
pub
fn
CheckTokenCapability
(
TokenHandle
:
HANDLE
CapabilitySidToCheck
:
PSID
HasCapability
:
PBOOL
)
-
>
BOOL
;
pub
fn
GetAppContainerAce
(
Acl
:
PACL
StartingAceIndex
:
DWORD
AppContainerAce
:
*
mut
PVOID
AppContainerAceIndex
:
*
mut
DWORD
)
-
>
BOOL
;
pub
fn
SetCachedSigningLevel
(
SourceFiles
:
PHANDLE
SourceFileCount
:
ULONG
Flags
:
ULONG
TargetFile
:
HANDLE
)
-
>
BOOL
;
pub
fn
GetCachedSigningLevel
(
File
:
HANDLE
Flags
:
PULONG
SigningLevel
:
PULONG
Thumbprint
:
PUCHAR
ThumbprintSize
:
PULONG
ThumbprintAlgorithm
:
PULONG
)
-
>
BOOL
;
}
