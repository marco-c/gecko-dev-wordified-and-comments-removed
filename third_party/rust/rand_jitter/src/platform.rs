#
[
cfg
(
not
(
any
(
target_os
=
"
macos
"
target_os
=
"
ios
"
target_os
=
"
windows
"
)
)
)
]
pub
fn
get_nstime
(
)
-
>
u64
{
use
std
:
:
time
:
:
{
SystemTime
UNIX_EPOCH
}
;
let
dur
=
SystemTime
:
:
now
(
)
.
duration_since
(
UNIX_EPOCH
)
.
unwrap
(
)
;
dur
.
as_secs
(
)
<
<
30
|
dur
.
subsec_nanos
(
)
as
u64
}
#
[
cfg
(
any
(
target_os
=
"
macos
"
target_os
=
"
ios
"
)
)
]
pub
fn
get_nstime
(
)
-
>
u64
{
use
libc
;
unsafe
{
libc
:
:
mach_absolute_time
(
)
}
}
#
[
cfg
(
target_os
=
"
windows
"
)
]
pub
fn
get_nstime
(
)
-
>
u64
{
use
winapi
;
unsafe
{
let
mut
t
=
super
:
:
mem
:
:
zeroed
(
)
;
winapi
:
:
um
:
:
profileapi
:
:
QueryPerformanceCounter
(
&
mut
t
)
;
*
t
.
QuadPart
(
)
as
u64
}
}
