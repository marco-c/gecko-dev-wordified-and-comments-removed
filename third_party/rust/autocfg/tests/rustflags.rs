extern
crate
autocfg
;
use
std
:
:
env
;
#
[
test
]
fn
test_with_sysroot
(
)
{
let
dir
=
env
:
:
current_exe
(
)
.
unwrap
(
)
.
parent
(
)
.
unwrap
(
)
.
to_path_buf
(
)
;
env
:
:
set_var
(
"
RUSTFLAGS
"
&
format
!
(
"
-
L
{
}
"
dir
.
display
(
)
)
)
;
env
:
:
set_var
(
"
OUT_DIR
"
&
format
!
(
"
{
}
"
dir
.
display
(
)
)
)
;
env
:
:
set_var
(
"
HOST
"
"
lol
"
)
;
let
ac
=
autocfg
:
:
AutoCfg
:
:
new
(
)
.
unwrap
(
)
;
assert
!
(
ac
.
probe_sysroot_crate
(
"
autocfg
"
)
)
;
}
