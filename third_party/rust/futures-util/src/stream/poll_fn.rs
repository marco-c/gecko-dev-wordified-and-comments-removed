use
super
:
:
assert_stream
;
use
core
:
:
fmt
;
use
core
:
:
pin
:
:
Pin
;
use
futures_core
:
:
stream
:
:
Stream
;
use
futures_core
:
:
task
:
:
{
Context
Poll
}
;
#
[
must_use
=
"
streams
do
nothing
unless
polled
"
]
pub
struct
PollFn
<
F
>
{
f
:
F
}
impl
<
F
>
Unpin
for
PollFn
<
F
>
{
}
impl
<
F
>
fmt
:
:
Debug
for
PollFn
<
F
>
{
fn
fmt
(
&
self
f
:
&
mut
fmt
:
:
Formatter
<
'
_
>
)
-
>
fmt
:
:
Result
{
f
.
debug_struct
(
"
PollFn
"
)
.
finish
(
)
}
}
pub
fn
poll_fn
<
T
F
>
(
f
:
F
)
-
>
PollFn
<
F
>
where
F
:
FnMut
(
&
mut
Context
<
'
_
>
)
-
>
Poll
<
Option
<
T
>
>
{
assert_stream
:
:
<
T
_
>
(
PollFn
{
f
}
)
}
impl
<
T
F
>
Stream
for
PollFn
<
F
>
where
F
:
FnMut
(
&
mut
Context
<
'
_
>
)
-
>
Poll
<
Option
<
T
>
>
{
type
Item
=
T
;
fn
poll_next
(
mut
self
:
Pin
<
&
mut
Self
>
cx
:
&
mut
Context
<
'
_
>
)
-
>
Poll
<
Option
<
T
>
>
{
(
&
mut
self
.
f
)
(
cx
)
}
}
