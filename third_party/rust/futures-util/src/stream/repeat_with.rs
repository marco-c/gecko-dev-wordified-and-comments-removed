use
super
:
:
assert_stream
;
use
core
:
:
pin
:
:
Pin
;
use
futures_core
:
:
stream
:
:
{
FusedStream
Stream
}
;
use
futures_core
:
:
task
:
:
{
Context
Poll
}
;
#
[
derive
(
Debug
Clone
)
]
#
[
must_use
=
"
streams
do
nothing
unless
polled
"
]
pub
struct
RepeatWith
<
F
>
{
repeater
:
F
}
impl
<
A
F
:
FnMut
(
)
-
>
A
>
Unpin
for
RepeatWith
<
F
>
{
}
impl
<
A
F
:
FnMut
(
)
-
>
A
>
Stream
for
RepeatWith
<
F
>
{
type
Item
=
A
;
fn
poll_next
(
mut
self
:
Pin
<
&
mut
Self
>
_
:
&
mut
Context
<
'
_
>
)
-
>
Poll
<
Option
<
Self
:
:
Item
>
>
{
Poll
:
:
Ready
(
Some
(
(
&
mut
self
.
repeater
)
(
)
)
)
}
fn
size_hint
(
&
self
)
-
>
(
usize
Option
<
usize
>
)
{
(
usize
:
:
MAX
None
)
}
}
impl
<
A
F
:
FnMut
(
)
-
>
A
>
FusedStream
for
RepeatWith
<
F
>
{
fn
is_terminated
(
&
self
)
-
>
bool
{
false
}
}
pub
fn
repeat_with
<
A
F
:
FnMut
(
)
-
>
A
>
(
repeater
:
F
)
-
>
RepeatWith
<
F
>
{
assert_stream
:
:
<
A
_
>
(
RepeatWith
{
repeater
}
)
}
