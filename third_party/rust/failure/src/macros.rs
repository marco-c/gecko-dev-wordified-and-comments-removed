#
[
macro_export
]
macro_rules
!
bail
{
(
e
:
expr
)
=
>
{
return
Err
(
crate
:
:
err_msg
(
e
)
)
;
}
;
(
fmt
:
expr
(
arg
:
tt
)
*
)
=
>
{
return
Err
(
crate
:
:
err_msg
(
format
!
(
fmt
(
arg
)
*
)
)
)
;
}
;
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ensure
{
(
cond
:
expr
)
=
>
{
if
!
(
cond
)
{
bail
!
(
"
{
}
"
_failure__stringify
!
(
cond
)
)
;
}
}
;
(
cond
:
expr
e
:
expr
)
=
>
{
if
!
(
cond
)
{
bail
!
(
e
)
;
}
}
;
(
cond
:
expr
fmt
:
expr
(
arg
:
tt
)
*
)
=
>
{
if
!
(
cond
)
{
bail
!
(
fmt
(
arg
)
*
)
;
}
}
;
}
#
[
doc
(
hidden
)
]
#
[
macro_export
]
macro_rules
!
_failure__stringify
{
(
(
inner
:
tt
)
*
)
=
>
{
stringify
!
{
(
inner
)
*
}
}
}
#
[
macro_export
]
macro_rules
!
format_err
{
(
(
arg
:
tt
)
*
)
=
>
{
crate
:
:
err_msg
(
format
!
(
(
arg
)
*
)
)
}
}
