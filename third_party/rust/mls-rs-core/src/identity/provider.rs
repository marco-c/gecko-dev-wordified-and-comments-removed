use
crate
:
:
{
error
:
:
IntoAnyError
extension
:
:
ExtensionList
time
:
:
MlsTime
}
;
#
[
cfg
(
mls_build_async
)
]
use
alloc
:
:
boxed
:
:
Box
;
use
alloc
:
:
vec
:
:
Vec
;
use
super
:
:
{
CredentialType
SigningIdentity
}
;
#
[
cfg_attr
(
not
(
mls_build_async
)
maybe_async
:
:
must_be_sync
)
]
#
[
cfg_attr
(
mls_build_async
maybe_async
:
:
must_be_async
)
]
pub
trait
IdentityProvider
:
Send
+
Sync
{
type
Error
:
IntoAnyError
;
async
fn
validate_member
(
&
self
signing_identity
:
&
SigningIdentity
timestamp
:
Option
<
MlsTime
>
extensions
:
Option
<
&
ExtensionList
>
)
-
>
Result
<
(
)
Self
:
:
Error
>
;
async
fn
validate_external_sender
(
&
self
signing_identity
:
&
SigningIdentity
timestamp
:
Option
<
MlsTime
>
extensions
:
Option
<
&
ExtensionList
>
)
-
>
Result
<
(
)
Self
:
:
Error
>
;
async
fn
identity
(
&
self
signing_identity
:
&
SigningIdentity
extensions
:
&
ExtensionList
)
-
>
Result
<
Vec
<
u8
>
Self
:
:
Error
>
;
async
fn
valid_successor
(
&
self
predecessor
:
&
SigningIdentity
successor
:
&
SigningIdentity
extensions
:
&
ExtensionList
)
-
>
Result
<
bool
Self
:
:
Error
>
;
fn
supported_types
(
&
self
)
-
>
Vec
<
CredentialType
>
;
}
