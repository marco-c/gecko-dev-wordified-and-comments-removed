use
std
:
:
ascii
:
:
AsciiExt
;
use
std
:
:
str
:
:
FromStr
;
use
std
:
:
ops
:
:
BitOr
;
bitflags
!
{
flags
Flags
:
u64
{
const
SC_NEGATE_REQS
=
0b0000000000000000000000000000000001
const
SC_REQUIRED
=
0b0000000000000000000000000000000010
const
A_REQUIRED_ELSE_HELP
=
0b0000000000000000000000000000000100
const
GLOBAL_VERSION
=
0b0000000000000000000000000000001000
const
VERSIONLESS_SC
=
0b0000000000000000000000000000010000
const
UNIFIED_HELP
=
0b0000000000000000000000000000100000
const
WAIT_ON_ERROR
=
0b0000000000000000000000000001000000
const
SC_REQUIRED_ELSE_HELP
=
0b0000000000000000000000000010000000
const
NEEDS_LONG_HELP
=
0b0000000000000000000000000100000000
const
NEEDS_LONG_VERSION
=
0b0000000000000000000000001000000000
const
NEEDS_SC_HELP
=
0b0000000000000000000000010000000000
const
DISABLE_VERSION
=
0b0000000000000000000000100000000000
const
HIDDEN
=
0b0000000000000000000001000000000000
const
TRAILING_VARARG
=
0b0000000000000000000010000000000000
const
NO_BIN_NAME
=
0b0000000000000000000100000000000000
const
ALLOW_UNK_SC
=
0b0000000000000000001000000000000000
const
UTF8_STRICT
=
0b0000000000000000010000000000000000
const
UTF8_NONE
=
0b0000000000000000100000000000000000
const
LEADING_HYPHEN
=
0b0000000000000001000000000000000000
const
NO_POS_VALUES
=
0b0000000000000010000000000000000000
const
NEXT_LINE_HELP
=
0b0000000000000100000000000000000000
const
DERIVE_DISP_ORDER
=
0b0000000000001000000000000000000000
const
COLORED_HELP
=
0b0000000000010000000000000000000000
const
COLOR_ALWAYS
=
0b0000000000100000000000000000000000
const
COLOR_AUTO
=
0b0000000001000000000000000000000000
const
COLOR_NEVER
=
0b0000000010000000000000000000000000
const
DONT_DELIM_TRAIL
=
0b0000000100000000000000000000000000
const
ALLOW_NEG_NUMS
=
0b0000001000000000000000000000000000
const
LOW_INDEX_MUL_POS
=
0b0000010000000000000000000000000000
const
DISABLE_HELP_SC
=
0b0000100000000000000000000000000000
const
DONT_COLLAPSE_ARGS
=
0b0001000000000000000000000000000000
const
ARGS_NEGATE_SCS
=
0b0010000000000000000000000000000000
const
PROPAGATE_VALS_DOWN
=
0b0100000000000000000000000000000000
const
ALLOW_MISSING_POS
=
0b1000000000000000000000000000000000
}
}
#
[
doc
(
hidden
)
]
#
[
derive
(
Debug
Copy
Clone
PartialEq
)
]
pub
struct
AppFlags
(
Flags
)
;
impl
BitOr
for
AppFlags
{
type
Output
=
Self
;
fn
bitor
(
self
rhs
:
Self
)
-
>
Self
{
AppFlags
(
self
.
0
|
rhs
.
0
)
}
}
impl
Default
for
AppFlags
{
fn
default
(
)
-
>
Self
{
AppFlags
(
NEEDS_LONG_VERSION
|
NEEDS_LONG_HELP
|
NEEDS_SC_HELP
|
UTF8_NONE
|
COLOR_AUTO
)
}
}
impl
AppFlags
{
pub
fn
new
(
)
-
>
Self
{
AppFlags
:
:
default
(
)
}
impl_settings
!
{
AppSettings
ArgRequiredElseHelp
=
>
A_REQUIRED_ELSE_HELP
ArgsNegateSubcommands
=
>
ARGS_NEGATE_SCS
AllowExternalSubcommands
=
>
ALLOW_UNK_SC
AllowInvalidUtf8
=
>
UTF8_NONE
AllowLeadingHyphen
=
>
LEADING_HYPHEN
AllowNegativeNumbers
=
>
ALLOW_NEG_NUMS
AllowMissingPositional
=
>
ALLOW_MISSING_POS
ColoredHelp
=
>
COLORED_HELP
ColorAlways
=
>
COLOR_ALWAYS
ColorAuto
=
>
COLOR_AUTO
ColorNever
=
>
COLOR_NEVER
DontDelimitTrailingValues
=
>
DONT_DELIM_TRAIL
DontCollapseArgsInUsage
=
>
DONT_COLLAPSE_ARGS
DeriveDisplayOrder
=
>
DERIVE_DISP_ORDER
DisableHelpSubcommand
=
>
DISABLE_HELP_SC
DisableVersion
=
>
DISABLE_VERSION
GlobalVersion
=
>
GLOBAL_VERSION
HidePossibleValuesInHelp
=
>
NO_POS_VALUES
Hidden
=
>
HIDDEN
LowIndexMultiplePositional
=
>
LOW_INDEX_MUL_POS
NeedsLongHelp
=
>
NEEDS_LONG_HELP
NeedsLongVersion
=
>
NEEDS_LONG_VERSION
NeedsSubcommandHelp
=
>
NEEDS_SC_HELP
NoBinaryName
=
>
NO_BIN_NAME
PropagateGlobalValuesDown
=
>
PROPAGATE_VALS_DOWN
StrictUtf8
=
>
UTF8_STRICT
SubcommandsNegateReqs
=
>
SC_NEGATE_REQS
SubcommandRequired
=
>
SC_REQUIRED
SubcommandRequiredElseHelp
=
>
SC_REQUIRED_ELSE_HELP
TrailingVarArg
=
>
TRAILING_VARARG
UnifiedHelpMessage
=
>
UNIFIED_HELP
NextLineHelp
=
>
NEXT_LINE_HELP
VersionlessSubcommands
=
>
VERSIONLESS_SC
WaitOnError
=
>
WAIT_ON_ERROR
}
}
#
[
derive
(
Debug
PartialEq
Copy
Clone
)
]
pub
enum
AppSettings
{
#
[
cfg_attr
(
not
(
unix
)
doc
=
"
ignore
"
)
]
#
[
cfg_attr
(
unix
doc
=
"
"
)
]
AllowInvalidUtf8
AllowLeadingHyphen
AllowNegativeNumbers
AllowMissingPositional
AllowExternalSubcommands
ArgsNegateSubcommands
ArgRequiredElseHelp
ColoredHelp
ColorAuto
ColorAlways
ColorNever
DontCollapseArgsInUsage
DontDelimitTrailingValues
DisableHelpSubcommand
DisableVersion
DeriveDisplayOrder
GlobalVersion
Hidden
HidePossibleValuesInHelp
NoBinaryName
NextLineHelp
PropagateGlobalValuesDown
SubcommandsNegateReqs
SubcommandRequiredElseHelp
#
[
cfg_attr
(
not
(
unix
)
doc
=
"
ignore
"
)
]
#
[
cfg_attr
(
unix
doc
=
"
"
)
]
StrictUtf8
SubcommandRequired
TrailingVarArg
UnifiedHelpMessage
VersionlessSubcommands
WaitOnError
#
[
doc
(
hidden
)
]
NeedsLongVersion
#
[
doc
(
hidden
)
]
NeedsLongHelp
#
[
doc
(
hidden
)
]
NeedsSubcommandHelp
#
[
doc
(
hidden
)
]
LowIndexMultiplePositional
}
impl
FromStr
for
AppSettings
{
type
Err
=
String
;
fn
from_str
(
s
:
&
str
)
-
>
Result
<
Self
<
Self
as
FromStr
>
:
:
Err
>
{
match
&
*
s
.
to_ascii_lowercase
(
)
{
"
argrequiredelsehelp
"
=
>
Ok
(
AppSettings
:
:
ArgRequiredElseHelp
)
"
argsnegatesubcommands
"
=
>
Ok
(
AppSettings
:
:
ArgsNegateSubcommands
)
"
allowinvalidutf8
"
=
>
Ok
(
AppSettings
:
:
AllowInvalidUtf8
)
"
allowleadinghyphen
"
=
>
Ok
(
AppSettings
:
:
AllowLeadingHyphen
)
"
allowexternalsubcommands
"
=
>
Ok
(
AppSettings
:
:
AllowExternalSubcommands
)
"
allownegativenumbers
"
=
>
Ok
(
AppSettings
:
:
AllowNegativeNumbers
)
"
colorauto
"
=
>
Ok
(
AppSettings
:
:
ColorAuto
)
"
coloralways
"
=
>
Ok
(
AppSettings
:
:
ColorAlways
)
"
colornever
"
=
>
Ok
(
AppSettings
:
:
ColorNever
)
"
coloredhelp
"
=
>
Ok
(
AppSettings
:
:
ColoredHelp
)
"
derivedisplayorder
"
=
>
Ok
(
AppSettings
:
:
DeriveDisplayOrder
)
"
dontcollapseargsinusage
"
=
>
Ok
(
AppSettings
:
:
DontCollapseArgsInUsage
)
"
dontdelimittrailingvalues
"
=
>
Ok
(
AppSettings
:
:
DontDelimitTrailingValues
)
"
disablehelpsubcommand
"
=
>
Ok
(
AppSettings
:
:
DisableHelpSubcommand
)
"
disableversion
"
=
>
Ok
(
AppSettings
:
:
DisableVersion
)
"
globalversion
"
=
>
Ok
(
AppSettings
:
:
GlobalVersion
)
"
hidden
"
=
>
Ok
(
AppSettings
:
:
Hidden
)
"
hidepossiblevaluesinhelp
"
=
>
Ok
(
AppSettings
:
:
HidePossibleValuesInHelp
)
"
lowindexmultiplepositional
"
=
>
Ok
(
AppSettings
:
:
LowIndexMultiplePositional
)
"
nobinaryname
"
=
>
Ok
(
AppSettings
:
:
NoBinaryName
)
"
nextlinehelp
"
=
>
Ok
(
AppSettings
:
:
NextLineHelp
)
"
strictutf8
"
=
>
Ok
(
AppSettings
:
:
StrictUtf8
)
"
subcommandsnegatereqs
"
=
>
Ok
(
AppSettings
:
:
SubcommandsNegateReqs
)
"
subcommandrequired
"
=
>
Ok
(
AppSettings
:
:
SubcommandRequired
)
"
subcommandrequiredelsehelp
"
=
>
Ok
(
AppSettings
:
:
SubcommandRequiredElseHelp
)
"
trailingvararg
"
=
>
Ok
(
AppSettings
:
:
TrailingVarArg
)
"
unifiedhelpmessage
"
=
>
Ok
(
AppSettings
:
:
UnifiedHelpMessage
)
"
versionlesssubcommands
"
=
>
Ok
(
AppSettings
:
:
VersionlessSubcommands
)
"
waitonerror
"
=
>
Ok
(
AppSettings
:
:
WaitOnError
)
_
=
>
Err
(
"
unknown
AppSetting
cannot
convert
from
str
"
.
to_owned
(
)
)
}
}
}
#
[
cfg
(
test
)
]
mod
test
{
use
super
:
:
AppSettings
;
#
[
test
]
fn
app_settings_fromstr
(
)
{
assert_eq
!
(
"
argsnegatesubcommands
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
ArgsNegateSubcommands
)
;
assert_eq
!
(
"
argrequiredelsehelp
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
ArgRequiredElseHelp
)
;
assert_eq
!
(
"
allowexternalsubcommands
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
AllowExternalSubcommands
)
;
assert_eq
!
(
"
allowinvalidutf8
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
AllowInvalidUtf8
)
;
assert_eq
!
(
"
allowleadinghyphen
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
AllowLeadingHyphen
)
;
assert_eq
!
(
"
allownegativenumbers
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
AllowNegativeNumbers
)
;
assert_eq
!
(
"
coloredhelp
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
ColoredHelp
)
;
assert_eq
!
(
"
colorauto
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
ColorAuto
)
;
assert_eq
!
(
"
coloralways
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
ColorAlways
)
;
assert_eq
!
(
"
colornever
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
ColorNever
)
;
assert_eq
!
(
"
disablehelpsubcommand
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
DisableHelpSubcommand
)
;
assert_eq
!
(
"
disableversion
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
DisableVersion
)
;
assert_eq
!
(
"
dontcollapseargsinusage
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
DontCollapseArgsInUsage
)
;
assert_eq
!
(
"
dontdelimittrailingvalues
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
DontDelimitTrailingValues
)
;
assert_eq
!
(
"
derivedisplayorder
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
DeriveDisplayOrder
)
;
assert_eq
!
(
"
globalversion
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
GlobalVersion
)
;
assert_eq
!
(
"
hidden
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
Hidden
)
;
assert_eq
!
(
"
hidepossiblevaluesinhelp
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
HidePossibleValuesInHelp
)
;
assert_eq
!
(
"
lowindexmultiplePositional
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
LowIndexMultiplePositional
)
;
assert_eq
!
(
"
nobinaryname
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
NoBinaryName
)
;
assert_eq
!
(
"
nextlinehelp
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
NextLineHelp
)
;
assert_eq
!
(
"
subcommandsnegatereqs
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
SubcommandsNegateReqs
)
;
assert_eq
!
(
"
subcommandrequired
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
SubcommandRequired
)
;
assert_eq
!
(
"
subcommandrequiredelsehelp
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
SubcommandRequiredElseHelp
)
;
assert_eq
!
(
"
strictutf8
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
StrictUtf8
)
;
assert_eq
!
(
"
trailingvararg
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
TrailingVarArg
)
;
assert_eq
!
(
"
unifiedhelpmessage
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
UnifiedHelpMessage
)
;
assert_eq
!
(
"
versionlesssubcommands
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
VersionlessSubcommands
)
;
assert_eq
!
(
"
waitonerror
"
.
parse
:
:
<
AppSettings
>
(
)
.
unwrap
(
)
AppSettings
:
:
WaitOnError
)
;
assert
!
(
"
hahahaha
"
.
parse
:
:
<
AppSettings
>
(
)
.
is_err
(
)
)
;
}
}
