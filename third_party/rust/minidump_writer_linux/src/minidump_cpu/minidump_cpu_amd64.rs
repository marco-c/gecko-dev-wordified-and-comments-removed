#
[
repr
(
C
)
]
pub
struct
MDXmmSaveArea32AMD64
{
pub
control_word
:
u16
pub
status_word
:
u16
pub
tag_word
:
u8
pub
reserved1
:
u8
pub
error_opcode
:
u16
pub
error_offset
:
u32
pub
error_selector
:
u16
pub
reserved2
:
u16
pub
data_offset
:
u32
pub
data_selector
:
u16
pub
reserved3
:
u16
pub
mx_csr
:
u32
pub
mx_csr_mask
:
u32
pub
float_registers
:
[
u128
;
8
]
pub
xmm_registers
:
[
u128
;
16
]
pub
reserved4
:
[
u8
;
96
]
}
impl
Default
for
MDXmmSaveArea32AMD64
{
#
[
inline
]
fn
default
(
)
-
>
Self
{
MDXmmSaveArea32AMD64
{
control_word
:
0
status_word
:
0
tag_word
:
0
reserved1
:
0
error_opcode
:
0
error_offset
:
0
error_selector
:
0
reserved2
:
0
data_offset
:
0
data_selector
:
0
reserved3
:
0
mx_csr
:
0
mx_csr_mask
:
0
float_registers
:
[
0
;
8
]
xmm_registers
:
[
0
;
16
]
reserved4
:
[
0
;
96
]
}
}
}
const
MD_CONTEXT_AMD64_VR_COUNT
:
usize
=
26
;
#
[
repr
(
C
)
]
#
[
derive
(
Default
)
]
pub
struct
MDRawContextAMD64
{
pub
p1_home
:
u64
pub
p2_home
:
u64
pub
p3_home
:
u64
pub
p4_home
:
u64
pub
p5_home
:
u64
pub
p6_home
:
u64
pub
context_flags
:
u32
pub
mx_csr
:
u32
pub
cs
:
u16
pub
ds
:
u16
pub
es
:
u16
pub
fs
:
u16
pub
gs
:
u16
pub
ss
:
u16
pub
eflags
:
u32
pub
dr0
:
u64
pub
dr1
:
u64
pub
dr2
:
u64
pub
dr3
:
u64
pub
dr6
:
u64
pub
dr7
:
u64
pub
rax
:
u64
pub
rcx
:
u64
pub
rdx
:
u64
pub
rbx
:
u64
pub
rsp
:
u64
pub
rbp
:
u64
pub
rsi
:
u64
pub
rdi
:
u64
pub
r8
:
u64
pub
r9
:
u64
pub
r10
:
u64
pub
r11
:
u64
pub
r12
:
u64
pub
r13
:
u64
pub
r14
:
u64
pub
r15
:
u64
pub
rip
:
u64
pub
flt_save
:
MDXmmSaveArea32AMD64
pub
vector_register
:
[
u128
;
MD_CONTEXT_AMD64_VR_COUNT
]
pub
vector_control
:
u64
pub
debug_control
:
u64
pub
last_branch_to_rip
:
u64
pub
last_branch_from_rip
:
u64
pub
last_exception_to_rip
:
u64
pub
last_exception_from_rip
:
u64
}
pub
const
MD_CONTEXT_AMD64
:
u32
=
0x00100000
;
pub
const
MD_CONTEXT_AMD64_CONTROL
:
u32
=
MD_CONTEXT_AMD64
|
0x00000001
;
pub
const
MD_CONTEXT_AMD64_INTEGER
:
u32
=
MD_CONTEXT_AMD64
|
0x00000002
;
pub
const
MD_CONTEXT_AMD64_SEGMENTS
:
u32
=
MD_CONTEXT_AMD64
|
0x00000004
;
pub
const
MD_CONTEXT_AMD64_FLOATING_POINT
:
u32
=
MD_CONTEXT_AMD64
|
0x00000008
;
pub
const
MD_CONTEXT_AMD64_DEBUG_REGISTERS
:
u32
=
MD_CONTEXT_AMD64
|
0x00000010
;
pub
const
MD_CONTEXT_AMD64_XSTATE
:
u32
=
MD_CONTEXT_AMD64
|
0x00000040
;
pub
const
MD_CONTEXT_AMD64_FULL
:
u32
=
MD_CONTEXT_AMD64_CONTROL
|
MD_CONTEXT_AMD64_INTEGER
|
MD_CONTEXT_AMD64_FLOATING_POINT
;
pub
const
MD_CONTEXT_AMD64_ALL
:
u32
=
MD_CONTEXT_AMD64_FULL
|
MD_CONTEXT_AMD64_SEGMENTS
|
MD_CONTEXT_AMD64_DEBUG_REGISTERS
;
