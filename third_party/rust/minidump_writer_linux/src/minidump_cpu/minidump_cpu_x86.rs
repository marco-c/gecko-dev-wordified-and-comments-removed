pub
const
MD_FLOATINGSAVEAREA_X86_REGISTERAREA_SIZE
:
usize
=
80
;
#
[
repr
(
C
)
]
#
[
derive
(
Debug
Default
PartialEq
)
]
pub
struct
MDFloatingSaveAreaX86
{
pub
control_word
:
u32
pub
status_word
:
u32
pub
tag_word
:
u32
pub
error_offset
:
u32
pub
error_selector
:
u32
pub
data_offset
:
u32
pub
data_selector
:
u32
pub
register_area
:
[
u8
;
MD_FLOATINGSAVEAREA_X86_REGISTERAREA_SIZE
]
pub
cr0_npx_state
:
u32
}
const
MD_CONTEXT_X86_EXTENDED_REGISTERS_SIZE
:
usize
=
512
;
#
[
repr
(
C
)
]
#
[
derive
(
Debug
Default
PartialEq
)
]
pub
struct
MDRawContextX86
{
pub
context_flags
:
u32
pub
dr0
:
u32
pub
dr1
:
u32
pub
dr2
:
u32
pub
dr3
:
u32
pub
dr6
:
u32
pub
dr7
:
u32
pub
float_save
:
MDFloatingSaveAreaX86
pub
gs
:
u32
pub
fs
:
u32
pub
es
:
u32
pub
ds
:
u32
pub
edi
:
u32
pub
esi
:
u32
pub
ebx
:
u32
pub
edx
:
u32
pub
ecx
:
u32
pub
eax
:
u32
pub
ebp
:
u32
pub
eip
:
u32
pub
cs
:
u32
pub
eflags
:
u32
pub
esp
:
u32
pub
ss
:
u32
pub
extended_registers
:
[
u8
;
MD_CONTEXT_X86_EXTENDED_REGISTERS_SIZE
]
}
const
MD_CONTEXT_X86
:
u32
=
0x00010000
;
const
MD_CONTEXT_X86_CONTROL
:
u32
=
MD_CONTEXT_X86
|
0x00000001
;
const
MD_CONTEXT_X86_INTEGER
:
u32
=
MD_CONTEXT_X86
|
0x00000002
;
const
MD_CONTEXT_X86_SEGMENTS
:
u32
=
MD_CONTEXT_X86
|
0x00000004
;
const
MD_CONTEXT_X86_FLOATING_POINT
:
u32
=
MD_CONTEXT_X86
|
0x00000008
;
const
MD_CONTEXT_X86_DEBUG_REGISTERS
:
u32
=
MD_CONTEXT_X86
|
0x00000010
;
const
MD_CONTEXT_X86_EXTENDED_REGISTERS
:
u32
=
MD_CONTEXT_X86
|
0x00000020
;
const
MD_CONTEXT_X86_XSTATE
:
u32
=
MD_CONTEXT_X86
|
0x00000040
;
const
MD_CONTEXT_X86_FULL
:
u32
=
MD_CONTEXT_X86_CONTROL
|
MD_CONTEXT_X86_INTEGER
|
MD_CONTEXT_X86_SEGMENTS
;
const
MD_CONTEXT_X86_ALL
:
u32
=
MD_CONTEXT_X86_FULL
|
MD_CONTEXT_X86_FLOATING_POINT
|
MD_CONTEXT_X86_DEBUG_REGISTERS
|
MD_CONTEXT_X86_EXTENDED_REGISTERS
;
