use
cfg_if
:
:
cfg_if
;
#
[
cfg
(
any
(
linux_android
target_os
=
"
redox
"
)
)
]
#
[
macro_use
]
mod
linux
;
#
[
cfg
(
any
(
linux_android
target_os
=
"
redox
"
)
)
]
pub
use
self
:
:
linux
:
:
*
;
#
[
cfg
(
any
(
bsd
solarish
target_os
=
"
haiku
"
)
)
]
#
[
macro_use
]
mod
bsd
;
#
[
cfg
(
any
(
bsd
solarish
target_os
=
"
haiku
"
)
)
]
pub
use
self
:
:
bsd
:
:
*
;
#
[
macro_export
]
#
[
doc
(
hidden
)
]
macro_rules
!
convert_ioctl_res
{
(
w
:
expr
)
=
>
{
{
crate
:
:
errno
:
:
Errno
:
:
result
(
w
)
}
}
;
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_none
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_none
!
(
ioty
nr
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_none_bad
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
nr
:
expr
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
nr
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_read
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
*
mut
ty
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_read
!
(
ioty
nr
:
:
std
:
:
mem
:
:
size_of
:
:
<
ty
>
(
)
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_read_bad
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
*
mut
ty
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
nr
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_write_ptr
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
*
const
ty
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_write
!
(
ioty
nr
:
:
std
:
:
mem
:
:
size_of
:
:
<
ty
>
(
)
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_write_ptr_bad
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
*
const
ty
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
nr
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
cfg_if
!
{
if
#
[
cfg
(
freebsdlike
)
]
{
/
/
/
Generates
a
wrapper
function
for
a
ioctl
that
writes
an
integer
to
the
kernel
.
/
/
/
/
/
/
The
arguments
to
this
macro
are
:
/
/
/
/
/
/
*
The
function
name
/
/
/
*
The
ioctl
identifier
/
/
/
*
The
ioctl
sequence
number
/
/
/
/
/
/
The
generated
function
has
the
following
signature
:
/
/
/
/
/
/
rust
ignore
/
/
/
pub
unsafe
fn
FUNCTION_NAME
(
fd
:
libc
:
:
c_int
data
:
nix
:
:
sys
:
:
ioctl
:
:
ioctl_param_type
)
-
>
Result
<
libc
:
:
c_int
>
/
/
/
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_write_int
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
crate
:
:
sys
:
:
ioctl
:
:
ioctl_param_type
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_write_int
!
(
ioty
nr
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
}
else
{
/
/
/
Generates
a
wrapper
function
for
a
ioctl
that
writes
an
integer
to
the
kernel
.
/
/
/
/
/
/
The
arguments
to
this
macro
are
:
/
/
/
/
/
/
*
The
function
name
/
/
/
*
The
ioctl
identifier
/
/
/
*
The
ioctl
sequence
number
/
/
/
/
/
/
The
generated
function
has
the
following
signature
:
/
/
/
/
/
/
rust
ignore
/
/
/
pub
unsafe
fn
FUNCTION_NAME
(
fd
:
libc
:
:
c_int
data
:
nix
:
:
sys
:
:
ioctl
:
:
ioctl_param_type
)
-
>
Result
<
libc
:
:
c_int
>
/
/
/
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_write_int
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
crate
:
:
sys
:
:
ioctl
:
:
ioctl_param_type
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_write
!
(
ioty
nr
:
:
std
:
:
mem
:
:
size_of
:
:
<
crate
:
:
libc
:
:
c_int
>
(
)
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
}
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_write_int_bad
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
nr
:
expr
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
crate
:
:
libc
:
:
c_int
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
nr
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_readwrite
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
*
mut
ty
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_readwrite
!
(
ioty
nr
:
:
std
:
:
mem
:
:
size_of
:
:
<
ty
>
(
)
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_readwrite_bad
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
*
mut
ty
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
nr
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_read_buf
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
&
mut
[
ty
]
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_read
!
(
ioty
nr
:
:
std
:
:
mem
:
:
size_of_val
(
data
)
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
.
as_mut_ptr
(
)
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_write_buf
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
&
[
ty
]
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_write
!
(
ioty
nr
:
:
std
:
:
mem
:
:
size_of_val
(
data
)
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
.
as_ptr
(
)
)
)
}
}
)
}
#
[
macro_export
(
local_inner_macros
)
]
macro_rules
!
ioctl_readwrite_buf
{
(
(
#
[
attr
:
meta
]
)
*
name
:
ident
ioty
:
expr
nr
:
expr
ty
:
ty
)
=
>
(
(
#
[
attr
]
)
*
pub
unsafe
fn
name
(
fd
:
crate
:
:
libc
:
:
c_int
data
:
&
mut
[
ty
]
)
-
>
crate
:
:
Result
<
crate
:
:
libc
:
:
c_int
>
{
unsafe
{
convert_ioctl_res
!
(
crate
:
:
libc
:
:
ioctl
(
fd
request_code_readwrite
!
(
ioty
nr
:
:
std
:
:
mem
:
:
size_of_val
(
data
)
)
as
crate
:
:
sys
:
:
ioctl
:
:
ioctl_num_type
data
.
as_mut_ptr
(
)
)
)
}
}
)
}
