use
std
:
:
collections
:
:
HashSet
;
mod
engine
;
mod
record
;
mod
ser
;
use
crate
:
:
DeviceType
;
use
anyhow
:
:
Result
;
pub
use
engine
:
:
Engine
;
const
CLIENTS_TTL
:
u32
=
15_552_000
;
pub
(
crate
)
const
CLIENTS_TTL_REFRESH
:
u64
=
604_800
;
pub
trait
CommandProcessor
{
fn
settings
(
&
self
)
-
>
&
Settings
;
fn
fetch_outgoing_commands
(
&
self
)
-
>
Result
<
HashSet
<
Command
>
>
;
fn
apply_incoming_command
(
&
self
command
:
Command
)
-
>
Result
<
CommandStatus
>
;
}
#
[
derive
(
Clone
Copy
Debug
Eq
Hash
PartialEq
)
]
pub
enum
CommandStatus
{
Applied
Ignored
Unsupported
}
#
[
derive
(
Clone
Debug
Eq
Hash
PartialEq
)
]
pub
struct
Settings
{
pub
fxa_device_id
:
String
pub
device_name
:
String
pub
device_type
:
DeviceType
}
#
[
derive
(
Clone
Debug
Eq
Hash
Ord
PartialEq
PartialOrd
)
]
pub
enum
Command
{
Wipe
(
String
)
ResetAll
Reset
(
String
)
}
