#
!
[
allow
(
clippy
:
:
needless_doctest_main
)
]
pub
use
ouroboros_macro
:
:
self_referencing
;
#
[
doc
(
hidden
)
]
pub
mod
macro_help
{
use
stable_deref_trait
:
:
StableDeref
;
use
std
:
:
ops
:
:
DerefMut
;
pub
struct
CheckIfTypeIsStd
<
T
>
(
std
:
:
marker
:
:
PhantomData
<
T
>
)
;
macro_rules
!
std_type_check
{
(
fn_name
:
ident
T
:
ident
check_for
:
ty
)
=
>
{
impl
<
T
:
?
Sized
>
CheckIfTypeIsStd
<
check_for
>
{
pub
fn
fn_name
(
)
{
}
}
}
}
std_type_check
!
(
is_std_box_type
T
std
:
:
boxed
:
:
Box
<
T
>
)
;
std_type_check
!
(
is_std_arc_type
T
std
:
:
sync
:
:
Arc
<
T
>
)
;
std_type_check
!
(
is_std_rc_type
T
std
:
:
rc
:
:
Rc
<
T
>
)
;
pub
unsafe
fn
stable_deref_and_change_lifetime
<
'
old
'
new
:
'
old
T
:
StableDeref
+
'
new
>
(
data
:
&
'
old
T
)
-
>
&
'
new
T
:
:
Target
{
&
*
(
(
&
*
*
data
)
as
*
const
_
)
}
pub
unsafe
fn
stable_deref_and_change_lifetime_mut
<
'
old
'
new
:
'
old
T
:
StableDeref
+
DerefMut
+
'
new
>
(
data
:
&
'
old
mut
T
)
-
>
&
'
new
mut
T
:
:
Target
{
&
mut
*
(
(
&
mut
*
*
data
)
as
*
mut
_
)
}
}
