mod
common
;
mod
metrics
{
use
glean
:
:
private
:
:
*
;
use
glean
:
:
{
Lifetime
TimeUnit
}
;
use
glean_core
:
:
CommonMetricData
;
use
once_cell
:
:
sync
:
:
Lazy
;
#
[
allow
(
non_upper_case_globals
)
]
pub
static
initialization
:
Lazy
<
TimespanMetric
>
=
Lazy
:
:
new
(
|
|
{
TimespanMetric
:
:
new
(
CommonMetricData
{
name
:
"
initialization
"
.
into
(
)
category
:
"
sample
"
.
into
(
)
send_in_pings
:
vec
!
[
"
validation
"
.
into
(
)
]
lifetime
:
Lifetime
:
:
Ping
disabled
:
false
.
.
Default
:
:
default
(
)
}
TimeUnit
:
:
Nanosecond
)
}
)
;
}
mod
pings
{
use
super
:
:
*
;
use
glean
:
:
private
:
:
PingType
;
use
once_cell
:
:
sync
:
:
Lazy
;
#
[
allow
(
non_upper_case_globals
)
]
pub
static
validation
:
Lazy
<
PingType
>
=
Lazy
:
:
new
(
|
|
{
common
:
:
PingBuilder
:
:
new
(
"
validation
"
)
.
with_send_if_empty
(
true
)
.
build
(
)
}
)
;
}
#
[
test
]
fn
never_initialize
(
)
{
common
:
:
enable_test_logging
(
)
;
metrics
:
:
initialization
.
start
(
)
;
pings
:
:
validation
.
submit
(
None
)
;
glean
:
:
shutdown
(
)
;
}
