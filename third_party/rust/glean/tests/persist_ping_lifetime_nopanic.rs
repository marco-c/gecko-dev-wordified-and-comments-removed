mod
common
;
use
glean
:
:
Configuration
;
use
std
:
:
path
:
:
PathBuf
;
fn
cfg_new
(
tmpname
:
PathBuf
)
-
>
Configuration
{
Configuration
{
data_path
:
tmpname
application_id
:
"
firefox
-
desktop
"
.
into
(
)
upload_enabled
:
true
max_events
:
None
delay_ping_lifetime_io
:
true
channel
:
Some
(
"
testing
"
.
into
(
)
)
server_endpoint
:
Some
(
"
invalid
-
test
-
host
"
.
into
(
)
)
uploader
:
None
use_core_mps
:
false
}
}
#
[
test
]
fn
delayed_ping_data
(
)
{
common
:
:
enable_test_logging
(
)
;
let
dir
=
tempfile
:
:
tempdir
(
)
.
unwrap
(
)
;
let
tmpname
=
dir
.
path
(
)
.
to_path_buf
(
)
;
common
:
:
initialize
(
cfg_new
(
tmpname
)
)
;
glean
:
:
persist_ping_lifetime_data
(
)
;
glean
:
:
shutdown
(
)
;
glean
:
:
persist_ping_lifetime_data
(
)
;
}
