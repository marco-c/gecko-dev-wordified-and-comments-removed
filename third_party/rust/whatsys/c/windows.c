#
include
<
stdlib
.
h
>
#
include
<
stdio
.
h
>
#
include
<
string
.
h
>
#
include
<
windows
.
h
>
#
define
LEN
20
const
char
*
get_os_release
(
void
)
{
OSVERSIONINFO
osvi
;
char
*
s
=
malloc
(
LEN
)
;
ZeroMemory
(
&
osvi
sizeof
(
osvi
)
)
;
osvi
.
dwOSVersionInfoSize
=
sizeof
(
osvi
)
;
if
(
GetVersionEx
(
&
osvi
)
)
{
snprintf
(
s
LEN
"
%
ld
.
%
ld
"
osvi
.
dwMajorVersion
osvi
.
dwMinorVersion
)
;
}
else
{
strncpy
(
s
"
unknown
"
LEN
)
;
}
s
[
LEN
-
1
]
=
'
\
0
'
;
return
s
;
}
void
str_free
(
char
*
ptr
)
{
free
(
ptr
)
;
}
