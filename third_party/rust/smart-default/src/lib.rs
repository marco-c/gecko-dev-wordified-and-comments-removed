extern
crate
proc_macro
;
extern
crate
proc_macro2
;
extern
crate
syn
;
extern
crate
quote
;
use
syn
:
:
{
parse_macro_input
DeriveInput
}
;
mod
body_impl
;
mod
default_attr
;
mod
util
;
#
[
proc_macro_derive
(
SmartDefault
attributes
(
default
)
)
]
pub
fn
derive_smart_default
(
input
:
proc_macro
:
:
TokenStream
)
-
>
proc_macro
:
:
TokenStream
{
let
input
=
parse_macro_input
!
(
input
as
DeriveInput
)
;
match
body_impl
:
:
impl_my_derive
(
&
input
)
{
Ok
(
output
)
=
>
{
output
.
into
(
)
}
Err
(
error
)
=
>
{
error
.
to_compile_error
(
)
.
into
(
)
}
}
}
