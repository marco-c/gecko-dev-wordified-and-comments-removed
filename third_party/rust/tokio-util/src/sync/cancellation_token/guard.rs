use
crate
:
:
sync
:
:
CancellationToken
;
#
[
derive
(
Debug
)
]
pub
struct
DropGuard
{
pub
(
super
)
inner
:
Option
<
CancellationToken
>
}
impl
DropGuard
{
pub
fn
disarm
(
mut
self
)
-
>
CancellationToken
{
self
.
inner
.
take
(
)
.
expect
(
"
inner
can
be
only
None
in
a
destructor
"
)
}
}
impl
Drop
for
DropGuard
{
fn
drop
(
&
mut
self
)
{
if
let
Some
(
inner
)
=
&
self
.
inner
{
inner
.
cancel
(
)
;
}
}
}
