#
[
test
]
fn
invalid_regexes_no_crash
(
)
{
assert
!
(
regex_new
!
(
"
(
*
)
"
)
.
is_err
(
)
)
;
assert
!
(
regex_new
!
(
"
(
?
:
?
)
"
)
.
is_err
(
)
)
;
assert
!
(
regex_new
!
(
"
(
?
)
"
)
.
is_err
(
)
)
;
assert
!
(
regex_new
!
(
"
*
"
)
.
is_err
(
)
)
;
}
#
[
test
]
fn
regression_many_repeat_stack_overflow
(
)
{
let
re
=
regex
!
(
"
^
.
{
1
2500
}
"
)
;
assert_eq
!
(
vec
!
[
(
0
1
)
]
findall
!
(
re
"
a
"
)
)
;
}
mat
!
(
regression_unsorted_binary_search_1
r
"
(
?
i
)
[
a_
]
+
"
"
A_
"
Some
(
(
0
2
)
)
)
;
mat
!
(
regression_unsorted_binary_search_2
r
"
(
?
i
)
[
A_
]
+
"
"
a_
"
Some
(
(
0
2
)
)
)
;
mat
!
(
regression_negated_char_class_1
r
"
(
?
i
)
[
^
x
]
"
"
x
"
None
)
;
mat
!
(
regression_negated_char_class_2
r
"
(
?
i
)
[
^
x
]
"
"
X
"
None
)
;
mat
!
(
regression_ascii_word_underscore
r
"
[
[
:
word
:
]
]
"
"
_
"
Some
(
(
0
1
)
)
)
;
#
[
test
]
fn
regression_captures_rep
(
)
{
let
re
=
regex
!
(
r
"
(
[
a
-
f
]
)
{
2
}
(
?
P
<
foo
>
[
x
-
z
]
)
"
)
;
let
caps
=
re
.
captures
(
text
!
(
"
abx
"
)
)
.
unwrap
(
)
;
assert_eq
!
(
match_text
!
(
caps
.
name
(
"
foo
"
)
.
unwrap
(
)
)
text
!
(
"
x
"
)
)
;
}
mat
!
(
regression_alt_in_alt1
r
"
ab
?
|
"
"
az
"
Some
(
(
0
1
)
)
)
;
mat
!
(
regression_alt_in_alt2
r
"
^
(
.
*
?
)
(
\
n
|
\
r
\
n
?
|
)
"
"
ab
\
rcd
"
Some
(
(
0
3
)
)
)
;
mat
!
(
regression_leftmost_first_prefix
r
"
z
*
azb
"
"
azb
"
Some
(
(
0
3
)
)
)
;
mat
!
(
uni_case_lower_nocase_flag
r
"
(
?
i
)
\
p
{
Ll
}
+
"
"
"
Some
(
(
0
10
)
)
)
;
mat
!
(
many_alternates
r
"
1
|
2
|
3
|
4
|
5
|
6
|
7
|
8
|
9
|
10
|
int
"
"
int
"
Some
(
(
0
3
)
)
)
;
mat
!
(
anchored_prefix1
r
"
^
a
\
S
"
"
a
"
None
)
;
mat
!
(
anchored_prefix2
r
"
^
a
\
S
"
"
foo
boo
a
"
None
)
;
mat
!
(
anchored_prefix3
r
"
^
-
[
a
-
z
]
"
"
r
-
f
"
None
)
;
split
!
(
split_on_word_boundary
r
"
\
b
"
r
"
Should
this
(
work
?
)
"
&
[
t
!
(
"
"
)
t
!
(
"
Should
"
)
t
!
(
"
"
)
t
!
(
"
this
"
)
t
!
(
"
(
"
)
t
!
(
"
work
"
)
t
!
(
"
?
)
"
)
]
)
;
matiter
!
(
word_boundary_dfa
r
"
\
b
"
"
a
b
c
"
(
0
0
)
(
1
1
)
(
2
2
)
(
3
3
)
(
4
4
)
(
5
5
)
)
;
matiter
!
(
partial_anchor
r
"
^
a
|
b
"
"
ba
"
(
0
1
)
)
;
mat
!
(
ascii_boundary_no_capture
r
"
(
?
-
u
)
\
B
"
"
\
u
{
28f3e
}
"
Some
(
(
0
0
)
)
)
;
mat
!
(
ascii_boundary_capture
r
"
(
?
-
u
)
(
\
B
)
"
"
\
u
{
28f3e
}
"
Some
(
(
0
0
)
)
)
;
ismatch
!
(
partial_anchor_alternate_begin
r
"
^
a
|
z
"
"
yyyyya
"
false
)
;
ismatch
!
(
partial_anchor_alternate_end
r
"
a
|
z
"
"
ayyyyy
"
false
)
;
mat
!
(
lits_unambiguous1
r
"
(
ABC
|
CDA
|
BC
)
X
"
"
CDAX
"
Some
(
(
0
4
)
)
)
;
mat
!
(
lits_unambiguous2
r
"
(
(
IMG
|
CAM
|
MG
|
MB2
)
_
|
(
DSCN
|
CIMG
)
)
(
?
P
<
n
>
[
0
-
9
]
+
)
"
"
CIMG2341
"
Some
(
(
0
8
)
)
Some
(
(
0
4
)
)
None
Some
(
(
0
4
)
)
Some
(
(
4
8
)
)
)
;
mat
!
(
end_not_wb
r
"
(
?
-
u
:
\
B
)
"
"
\
u
{
5c124
}
\
u
{
b576c
}
"
Some
(
(
8
8
)
)
)
;
mat
!
(
endl_or_wb
r
"
(
?
m
:
)
|
(
?
-
u
:
\
b
)
"
"
\
u
{
6084e
}
"
Some
(
(
4
4
)
)
)
;
mat
!
(
zero_or_end
r
"
(
?
i
-
u
:
\
x00
)
|
"
"
\
u
{
e682f
}
"
Some
(
(
4
4
)
)
)
;
mat
!
(
y_or_endl
r
"
(
?
i
-
u
:
y
)
|
(
?
m
:
)
"
"
\
u
{
b4331
}
"
Some
(
(
4
4
)
)
)
;
mat
!
(
wb_start_x
r
"
(
?
u
:
\
b
)
^
(
?
-
u
:
X
)
"
"
X
"
Some
(
(
0
1
)
)
)
;
