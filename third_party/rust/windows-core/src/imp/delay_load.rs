use
super
:
:
*
;
pub
unsafe
fn
delay_load
<
T
>
(
library
:
crate
:
:
PCSTR
function
:
crate
:
:
PCSTR
)
-
>
Option
<
T
>
{
let
library
=
LoadLibraryExA
(
library
.
0
0
LOAD_LIBRARY_SEARCH_DEFAULT_DIRS
)
;
if
library
=
=
0
{
return
None
;
}
let
address
=
GetProcAddress
(
library
function
.
0
)
;
if
address
.
is_some
(
)
{
return
Some
(
std
:
:
mem
:
:
transmute_copy
(
&
address
)
)
;
}
FreeLibrary
(
library
)
;
None
}
