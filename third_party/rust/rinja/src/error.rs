use
std
:
:
convert
:
:
Infallible
;
use
std
:
:
fmt
:
:
{
self
Display
}
;
pub
type
Result
<
I
E
=
Error
>
=
std
:
:
result
:
:
Result
<
I
E
>
;
#
[
non_exhaustive
]
#
[
derive
(
Debug
)
]
pub
enum
Error
{
Fmt
Custom
(
Box
<
dyn
std
:
:
error
:
:
Error
+
Send
+
Sync
>
)
#
[
cfg
(
feature
=
"
serde_json
"
)
]
Json
(
serde_json
:
:
Error
)
}
impl
std
:
:
error
:
:
Error
for
Error
{
fn
source
(
&
self
)
-
>
Option
<
&
(
dyn
std
:
:
error
:
:
Error
+
'
static
)
>
{
match
*
self
{
Error
:
:
Fmt
=
>
None
Error
:
:
Custom
(
ref
err
)
=
>
Some
(
err
.
as_ref
(
)
)
#
[
cfg
(
feature
=
"
serde_json
"
)
]
Error
:
:
Json
(
ref
err
)
=
>
Some
(
err
)
}
}
}
impl
Display
for
Error
{
fn
fmt
(
&
self
formatter
:
&
mut
fmt
:
:
Formatter
<
'
_
>
)
-
>
fmt
:
:
Result
{
match
self
{
Error
:
:
Fmt
=
>
write
!
(
formatter
"
formatting
error
"
)
Error
:
:
Custom
(
err
)
=
>
write
!
(
formatter
"
{
err
}
"
)
#
[
cfg
(
feature
=
"
serde_json
"
)
]
Error
:
:
Json
(
err
)
=
>
write
!
(
formatter
"
json
conversion
error
:
{
err
}
"
)
}
}
}
impl
From
<
fmt
:
:
Error
>
for
Error
{
#
[
inline
]
fn
from
(
_
:
fmt
:
:
Error
)
-
>
Self
{
Error
:
:
Fmt
}
}
#
[
cfg
(
feature
=
"
serde_json
"
)
]
impl
From
<
serde_json
:
:
Error
>
for
Error
{
#
[
inline
]
fn
from
(
err
:
serde_json
:
:
Error
)
-
>
Self
{
Error
:
:
Json
(
err
)
}
}
impl
From
<
Infallible
>
for
Error
{
#
[
inline
]
fn
from
(
value
:
Infallible
)
-
>
Self
{
match
value
{
}
}
}
#
[
cfg
(
test
)
]
mod
tests
{
use
super
:
:
Error
;
#
[
allow
(
dead_code
)
]
trait
AssertSendSyncStatic
:
Send
+
Sync
+
'
static
{
}
impl
AssertSendSyncStatic
for
Error
{
}
}
