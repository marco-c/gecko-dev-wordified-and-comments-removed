typedef
unsigned
char
uint8_t
;
typedef
unsigned
short
uint16_t
;
typedef
unsigned
int
uint32_t
;
typedef
unsigned
long
long
uint64_t
;
#
define
ETHER_ADDR_LEN
6
/
*
*
<
Length
of
Ethernet
address
.
*
/
struct
ether_addr
{
uint8_t
addr_bytes
[
ETHER_ADDR_LEN
]
;
}
__attribute__
(
(
__packed__
)
)
;
struct
arp_ipv4
{
struct
ether_addr
arp_sha
;
uint32_t
arp_sip
;
struct
ether_addr
arp_tha
;
uint32_t
arp_tip
;
}
__attribute__
(
(
__packed__
)
)
;
struct
arp_hdr
{
uint16_t
arp_hrd
;
#
define
ARP_HRD_ETHER
1
/
*
ARP
Ethernet
address
format
*
/
uint16_t
arp_pro
;
uint8_t
arp_hln
;
uint8_t
arp_pln
;
uint16_t
arp_op
;
#
define
ARP_OP_REQUEST
1
/
*
request
to
resolve
address
*
/
#
define
ARP_OP_REPLY
2
/
*
response
to
previous
request
*
/
#
define
ARP_OP_REVREQUEST
3
/
*
request
proto
addr
given
hardware
*
/
#
define
ARP_OP_REVREPLY
4
/
*
response
giving
protocol
address
*
/
#
define
ARP_OP_INVREQUEST
8
/
*
request
to
identify
peer
*
/
#
define
ARP_OP_INVREPLY
9
/
*
response
identifying
peer
*
/
struct
arp_ipv4
arp_data
;
}
__attribute__
(
(
__packed__
)
)
;
