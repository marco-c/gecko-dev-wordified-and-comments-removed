use
objc2
:
:
runtime
:
:
{
AnyClass
NSObject
}
;
use
objc2
:
:
{
sel
ClassType
Encode
}
;
fn
main
(
)
{
let
cls
=
NSObject
:
:
class
(
)
;
println
!
(
"
NSObject
superclass
:
{
:
?
}
"
cls
.
superclass
(
)
)
;
println
!
(
"
NSObject
size
:
{
}
"
cls
.
instance_size
(
)
)
;
println
!
(
"
-
[
NSObject
alloc
]
would
work
:
{
}
"
cls
.
responds_to
(
sel
!
(
alloc
)
)
)
;
println
!
(
"
+
[
NSObject
alloc
]
would
work
:
{
}
"
cls
.
metaclass
(
)
.
responds_to
(
sel
!
(
alloc
)
)
)
;
let
ivar
=
cls
.
instance_variable
(
c
"
isa
"
)
.
expect
(
"
no
ivar
with
name
'
isa
'
found
on
NSObject
"
)
;
println
!
(
"
Instance
variable
{
:
?
}
has
type
encoding
{
:
?
}
"
ivar
.
name
(
)
ivar
.
type_encoding
(
)
)
;
assert
!
(
<
*
const
AnyClass
>
:
:
ENCODING
.
equivalent_to_str
(
ivar
.
type_encoding
(
)
.
to_str
(
)
.
unwrap
(
)
)
)
;
let
method
=
cls
.
instance_method
(
sel
!
(
hash
)
)
.
unwrap
(
)
;
println
!
(
"
-
[
NSObject
hash
]
takes
{
}
parameters
"
method
.
arguments_count
(
)
)
;
let
hash_return
=
method
.
return_type
(
)
;
println
!
(
"
-
[
NSObject
hash
]
return
type
:
{
hash_return
:
?
}
"
)
;
assert
!
(
usize
:
:
ENCODING
.
equivalent_to_str
(
hash_return
.
to_str
(
)
.
unwrap
(
)
)
)
;
let
obj
=
NSObject
:
:
new
(
)
;
println
!
(
"
NSObject
address
:
{
obj
:
p
}
"
)
;
let
isa
:
*
const
AnyClass
=
unsafe
{
*
ivar
.
load
(
&
obj
)
}
;
println
!
(
"
NSObject
isa
:
{
isa
:
?
}
"
)
;
}
