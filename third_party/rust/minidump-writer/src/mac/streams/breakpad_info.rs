use
super
:
:
*
;
use
format
:
:
{
BreakpadInfoValid
MINIDUMP_BREAKPAD_INFO
as
BreakpadInfo
}
;
impl
MinidumpWriter
{
pub
(
crate
)
fn
write_breakpad_info
(
&
mut
self
buffer
:
&
mut
DumpBuf
_dumper
:
&
TaskDumper
)
-
>
Result
<
MDRawDirectory
WriterError
>
{
let
bp_section
=
MemoryWriter
:
:
<
BreakpadInfo
>
:
:
alloc_with_val
(
buffer
BreakpadInfo
{
validity
:
BreakpadInfoValid
:
:
DumpThreadId
.
bits
(
)
|
BreakpadInfoValid
:
:
RequestingThreadId
.
bits
(
)
dump_thread_id
:
self
.
handler_thread
requesting_thread_id
:
self
.
crash_context
.
as_ref
(
)
.
map
(
|
cc
|
cc
.
thread
)
.
unwrap_or
(
0
)
}
)
?
;
Ok
(
MDRawDirectory
{
stream_type
:
MDStreamType
:
:
BreakpadInfoStream
as
u32
location
:
bp_section
.
location
(
)
}
)
}
}
