use
Rng
;
use
distributions
:
:
Distribution
;
use
std
:
:
f64
:
:
consts
:
:
PI
;
#
[
derive
(
Clone
Copy
Debug
)
]
pub
struct
Cauchy
{
median
:
f64
scale
:
f64
}
impl
Cauchy
{
pub
fn
new
(
median
:
f64
scale
:
f64
)
-
>
Cauchy
{
assert
!
(
scale
>
0
.
0
"
Cauchy
:
:
new
called
with
scale
factor
<
=
0
"
)
;
Cauchy
{
median
scale
}
}
}
impl
Distribution
<
f64
>
for
Cauchy
{
fn
sample
<
R
:
Rng
+
?
Sized
>
(
&
self
rng
:
&
mut
R
)
-
>
f64
{
let
x
=
rng
.
gen
:
:
<
f64
>
(
)
;
let
comp_dev
=
(
PI
*
x
)
.
tan
(
)
;
let
result
=
self
.
median
+
self
.
scale
*
comp_dev
;
result
}
}
#
[
cfg
(
test
)
]
mod
test
{
use
distributions
:
:
Distribution
;
use
super
:
:
Cauchy
;
fn
median
(
mut
numbers
:
&
mut
[
f64
]
)
-
>
f64
{
sort
(
&
mut
numbers
)
;
let
mid
=
numbers
.
len
(
)
/
2
;
numbers
[
mid
]
}
fn
sort
(
numbers
:
&
mut
[
f64
]
)
{
numbers
.
sort_by
(
|
a
b
|
a
.
partial_cmp
(
b
)
.
unwrap
(
)
)
;
}
#
[
test
]
fn
test_cauchy_median
(
)
{
let
cauchy
=
Cauchy
:
:
new
(
10
.
0
5
.
0
)
;
let
mut
rng
=
:
:
test
:
:
rng
(
123
)
;
let
mut
numbers
:
[
f64
;
1000
]
=
[
0
.
0
;
1000
]
;
for
i
in
0
.
.
1000
{
numbers
[
i
]
=
cauchy
.
sample
(
&
mut
rng
)
;
}
let
median
=
median
(
&
mut
numbers
)
;
println
!
(
"
Cauchy
median
:
{
}
"
median
)
;
assert
!
(
(
median
-
10
.
0
)
.
abs
(
)
<
0
.
5
)
;
}
#
[
test
]
fn
test_cauchy_mean
(
)
{
let
cauchy
=
Cauchy
:
:
new
(
10
.
0
5
.
0
)
;
let
mut
rng
=
:
:
test
:
:
rng
(
123
)
;
let
mut
sum
=
0
.
0
;
for
_
in
0
.
.
1000
{
sum
+
=
cauchy
.
sample
(
&
mut
rng
)
;
}
let
mean
=
sum
/
1000
.
0
;
println
!
(
"
Cauchy
mean
:
{
}
"
mean
)
;
assert
!
(
(
mean
-
10
.
0
)
.
abs
(
)
>
0
.
5
)
;
}
#
[
test
]
#
[
should_panic
]
fn
test_cauchy_invalid_scale_zero
(
)
{
Cauchy
:
:
new
(
0
.
0
0
.
0
)
;
}
#
[
test
]
#
[
should_panic
]
fn
test_cauchy_invalid_scale_neg
(
)
{
Cauchy
:
:
new
(
0
.
0
-
10
.
0
)
;
}
}
