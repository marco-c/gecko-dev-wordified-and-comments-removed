extern
crate
ws
;
extern
crate
env_logger
;
use
ws
:
:
{
connect
CloseCode
}
;
fn
main
(
)
{
env_logger
:
:
init
(
)
.
unwrap
(
)
;
if
let
Err
(
error
)
=
connect
(
"
ws
:
/
/
127
.
0
.
0
.
1
:
3012
"
|
out
|
{
if
let
Err
(
_
)
=
out
.
send
(
"
Hello
WebSocket
"
)
{
println
!
(
"
Websocket
couldn
'
t
queue
an
initial
message
.
"
)
}
else
{
println
!
(
"
Client
sent
message
'
Hello
WebSocket
'
.
"
)
}
move
|
msg
|
{
println
!
(
"
Client
got
message
'
{
}
'
.
"
msg
)
;
out
.
close
(
CloseCode
:
:
Normal
)
}
}
)
{
println
!
(
"
Failed
to
create
WebSocket
due
to
:
{
:
?
}
"
error
)
;
}
}
