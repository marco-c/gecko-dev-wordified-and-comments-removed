extern
crate
ws
;
extern
crate
url
;
extern
crate
env_logger
;
use
ws
:
:
{
WebSocket
Sender
}
;
fn
main
(
)
{
env_logger
:
:
init
(
)
.
unwrap
(
)
;
let
mut
name
=
"
Client
"
;
let
mut
ws
=
WebSocket
:
:
new
(
|
output
:
Sender
|
{
if
name
=
=
"
Client
"
{
println
!
(
"
{
}
sending
'
Hello
Websocket
'
"
name
)
;
output
.
send
(
"
Hello
Websocket
"
)
.
unwrap
(
)
;
}
let
handler
=
move
|
msg
|
{
println
!
(
"
{
}
got
'
{
}
'
"
name
msg
)
;
if
name
=
=
"
Server
"
{
println
!
(
"
{
}
sending
'
How
are
you
?
'
"
name
)
;
output
.
send
(
"
How
are
you
?
"
)
}
else
{
output
.
shutdown
(
)
}
}
;
name
=
"
Server
"
;
handler
}
)
.
unwrap
(
)
;
let
url
=
url
:
:
Url
:
:
parse
(
"
ws
:
/
/
127
.
0
.
0
.
1
:
3012
"
)
.
unwrap
(
)
;
ws
.
connect
(
url
)
.
unwrap
(
)
;
ws
.
listen
(
"
127
.
0
.
0
.
1
:
3012
"
)
.
unwrap
(
)
;
println
!
(
"
All
done
.
"
)
}
