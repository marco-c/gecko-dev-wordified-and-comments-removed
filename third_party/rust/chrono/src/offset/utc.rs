use
core
:
:
fmt
;
use
super
:
:
{
FixedOffset
LocalResult
Offset
TimeZone
}
;
use
naive
:
:
{
NaiveDate
NaiveDateTime
}
;
#
[
cfg
(
all
(
feature
=
"
clock
"
not
(
all
(
target_arch
=
"
wasm32
"
not
(
target_os
=
"
wasi
"
)
feature
=
"
wasmbind
"
)
)
)
)
]
use
std
:
:
time
:
:
{
SystemTime
UNIX_EPOCH
}
;
#
[
cfg
(
feature
=
"
clock
"
)
]
use
{
Date
DateTime
}
;
#
[
derive
(
Copy
Clone
PartialEq
Eq
)
]
pub
struct
Utc
;
#
[
cfg
(
feature
=
"
clock
"
)
]
impl
Utc
{
pub
fn
today
(
)
-
>
Date
<
Utc
>
{
Utc
:
:
now
(
)
.
date
(
)
}
#
[
cfg
(
not
(
all
(
target_arch
=
"
wasm32
"
not
(
target_os
=
"
wasi
"
)
feature
=
"
wasmbind
"
)
)
)
]
pub
fn
now
(
)
-
>
DateTime
<
Utc
>
{
let
now
=
SystemTime
:
:
now
(
)
.
duration_since
(
UNIX_EPOCH
)
.
expect
(
"
system
time
before
Unix
epoch
"
)
;
let
naive
=
NaiveDateTime
:
:
from_timestamp
(
now
.
as_secs
(
)
as
i64
now
.
subsec_nanos
(
)
as
u32
)
;
DateTime
:
:
from_utc
(
naive
Utc
)
}
#
[
cfg
(
all
(
target_arch
=
"
wasm32
"
not
(
target_os
=
"
wasi
"
)
feature
=
"
wasmbind
"
)
)
]
pub
fn
now
(
)
-
>
DateTime
<
Utc
>
{
let
now
=
js_sys
:
:
Date
:
:
new_0
(
)
;
DateTime
:
:
<
Utc
>
:
:
from
(
now
)
}
}
impl
TimeZone
for
Utc
{
type
Offset
=
Utc
;
fn
from_offset
(
_state
:
&
Utc
)
-
>
Utc
{
Utc
}
fn
offset_from_local_date
(
&
self
_local
:
&
NaiveDate
)
-
>
LocalResult
<
Utc
>
{
LocalResult
:
:
Single
(
Utc
)
}
fn
offset_from_local_datetime
(
&
self
_local
:
&
NaiveDateTime
)
-
>
LocalResult
<
Utc
>
{
LocalResult
:
:
Single
(
Utc
)
}
fn
offset_from_utc_date
(
&
self
_utc
:
&
NaiveDate
)
-
>
Utc
{
Utc
}
fn
offset_from_utc_datetime
(
&
self
_utc
:
&
NaiveDateTime
)
-
>
Utc
{
Utc
}
}
impl
Offset
for
Utc
{
fn
fix
(
&
self
)
-
>
FixedOffset
{
FixedOffset
:
:
east
(
0
)
}
}
impl
fmt
:
:
Debug
for
Utc
{
fn
fmt
(
&
self
f
:
&
mut
fmt
:
:
Formatter
)
-
>
fmt
:
:
Result
{
write
!
(
f
"
Z
"
)
}
}
impl
fmt
:
:
Display
for
Utc
{
fn
fmt
(
&
self
f
:
&
mut
fmt
:
:
Formatter
)
-
>
fmt
:
:
Result
{
write
!
(
f
"
UTC
"
)
}
}
