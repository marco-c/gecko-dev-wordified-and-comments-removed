use
crate
:
:
provider
:
:
CaseMapV1
;
use
crate
:
:
{
CaseMapper
CaseMapperBorrowed
}
;
use
alloc
:
:
borrow
:
:
Cow
;
use
icu_locale_core
:
:
LanguageIdentifier
;
use
icu_properties
:
:
props
:
:
{
GeneralCategory
GeneralCategoryGroup
}
;
use
icu_properties
:
:
provider
:
:
PropertyEnumGeneralCategoryV1
;
use
icu_properties
:
:
{
CodePointMapData
CodePointMapDataBorrowed
}
;
use
icu_provider
:
:
prelude
:
:
*
;
use
writeable
:
:
Writeable
;
#
[
non_exhaustive
]
#
[
derive
(
Copy
Clone
Default
PartialEq
Eq
Hash
Debug
)
]
pub
enum
TrailingCase
{
Unchanged
#
[
default
]
Lower
}
#
[
non_exhaustive
]
#
[
derive
(
Copy
Clone
Default
PartialEq
Eq
Hash
Debug
)
]
pub
enum
LeadingAdjustment
{
None
#
[
default
]
Auto
ToCased
}
#
[
non_exhaustive
]
#
[
derive
(
Copy
Clone
Default
PartialEq
Eq
Hash
Debug
)
]
pub
struct
TitlecaseOptions
{
pub
trailing_case
:
Option
<
TrailingCase
>
pub
leading_adjustment
:
Option
<
LeadingAdjustment
>
}
#
[
derive
(
Clone
Debug
)
]
pub
struct
TitlecaseMapper
<
CM
>
{
cm
:
CM
gc
:
CodePointMapData
<
GeneralCategory
>
}
impl
TitlecaseMapper
<
CaseMapper
>
{
icu_provider
:
:
gen_buffer_data_constructors
!
(
(
)
-
>
error
:
DataError
functions
:
[
new
:
skip
try_new_with_buffer_provider
try_new_unstable
Self
]
)
;
#
[
doc
=
icu_provider
:
:
gen_buffer_unstable_docs
!
(
UNSTABLE
Self
:
:
new
)
]
pub
fn
try_new_unstable
<
P
>
(
provider
:
&
P
)
-
>
Result
<
Self
DataError
>
where
P
:
DataProvider
<
CaseMapV1
>
+
DataProvider
<
PropertyEnumGeneralCategoryV1
>
+
?
Sized
{
let
cm
=
CaseMapper
:
:
try_new_unstable
(
provider
)
?
;
let
gc
=
icu_properties
:
:
CodePointMapData
:
:
<
icu_properties
:
:
props
:
:
GeneralCategory
>
:
:
try_new_unstable
(
provider
)
?
;
Ok
(
Self
{
cm
gc
}
)
}
}
impl
TitlecaseMapper
<
CaseMapper
>
{
#
[
cfg
(
feature
=
"
compiled_data
"
)
]
#
[
allow
(
clippy
:
:
new_ret_no_self
)
]
pub
const
fn
new
(
)
-
>
TitlecaseMapperBorrowed
<
'
static
>
{
TitlecaseMapperBorrowed
:
:
new
(
)
}
}
impl
<
CM
:
AsRef
<
CaseMapper
>
>
TitlecaseMapper
<
CM
>
{
icu_provider
:
:
gen_buffer_data_constructors
!
(
(
casemapper
:
CM
)
-
>
error
:
DataError
functions
:
[
new_with_mapper
:
skip
try_new_with_mapper_with_buffer_provider
try_new_with_mapper_unstable
Self
]
)
;
#
[
cfg
(
feature
=
"
compiled_data
"
)
]
pub
const
fn
new_with_mapper
(
casemapper
:
CM
)
-
>
Self
{
Self
{
cm
:
casemapper
gc
:
icu_properties
:
:
CodePointMapData
:
:
<
icu_properties
:
:
props
:
:
GeneralCategory
>
:
:
new
(
)
.
static_to_owned
(
)
}
}
#
[
doc
=
icu_provider
:
:
gen_buffer_unstable_docs
!
(
UNSTABLE
Self
:
:
new_with_mapper
)
]
pub
fn
try_new_with_mapper_unstable
<
P
>
(
provider
:
&
P
casemapper
:
CM
)
-
>
Result
<
Self
DataError
>
where
P
:
DataProvider
<
CaseMapV1
>
+
DataProvider
<
PropertyEnumGeneralCategoryV1
>
+
?
Sized
{
let
gc
=
icu_properties
:
:
CodePointMapData
:
:
<
icu_properties
:
:
props
:
:
GeneralCategory
>
:
:
try_new_unstable
(
provider
)
?
;
Ok
(
Self
{
cm
:
casemapper
gc
}
)
}
pub
fn
as_borrowed
(
&
self
)
-
>
TitlecaseMapperBorrowed
<
'
_
>
{
TitlecaseMapperBorrowed
{
cm
:
self
.
cm
.
as_ref
(
)
.
as_borrowed
(
)
gc
:
self
.
gc
.
as_borrowed
(
)
}
}
}
#
[
derive
(
Clone
Debug
Copy
)
]
pub
struct
TitlecaseMapperBorrowed
<
'
a
>
{
cm
:
CaseMapperBorrowed
<
'
a
>
gc
:
CodePointMapDataBorrowed
<
'
a
GeneralCategory
>
}
impl
TitlecaseMapperBorrowed
<
'
static
>
{
#
[
cfg
(
feature
=
"
compiled_data
"
)
]
pub
const
fn
new
(
)
-
>
Self
{
Self
{
cm
:
CaseMapper
:
:
new
(
)
gc
:
icu_properties
:
:
CodePointMapData
:
:
<
icu_properties
:
:
props
:
:
GeneralCategory
>
:
:
new
(
)
}
}
pub
const
fn
static_to_owned
(
self
)
-
>
TitlecaseMapper
<
CaseMapper
>
{
TitlecaseMapper
{
cm
:
self
.
cm
.
static_to_owned
(
)
gc
:
self
.
gc
.
static_to_owned
(
)
}
}
}
#
[
cfg
(
feature
=
"
compiled_data
"
)
]
impl
Default
for
TitlecaseMapperBorrowed
<
'
static
>
{
fn
default
(
)
-
>
Self
{
Self
:
:
new
(
)
}
}
impl
<
'
a
>
TitlecaseMapperBorrowed
<
'
a
>
{
pub
fn
titlecase_segment
(
self
src
:
&
'
a
str
langid
:
&
LanguageIdentifier
options
:
TitlecaseOptions
)
-
>
impl
Writeable
+
'
a
{
if
options
.
leading_adjustment
.
unwrap_or_default
(
)
=
=
LeadingAdjustment
:
:
Auto
{
const
HEAD_GROUPS
:
GeneralCategoryGroup
=
GeneralCategoryGroup
:
:
Letter
.
union
(
GeneralCategoryGroup
:
:
Number
)
.
union
(
GeneralCategoryGroup
:
:
Symbol
)
.
union
(
GeneralCategoryGroup
:
:
PrivateUse
)
;
self
.
cm
.
titlecase_segment_with_adjustment
(
src
langid
options
|
_data
ch
|
{
HEAD_GROUPS
.
contains
(
self
.
gc
.
get
(
ch
)
)
}
)
}
else
{
self
.
cm
.
titlecase_segment_with_adjustment
(
src
langid
options
|
data
ch
|
{
data
.
is_cased
(
ch
)
}
)
}
}
pub
fn
titlecase_segment_to_string
<
'
s
>
(
self
src
:
&
'
s
str
langid
:
&
LanguageIdentifier
options
:
TitlecaseOptions
)
-
>
Cow
<
'
s
str
>
{
writeable
:
:
to_string_or_borrow
(
&
self
.
titlecase_segment
(
src
langid
options
)
src
.
as_bytes
(
)
)
}
}
