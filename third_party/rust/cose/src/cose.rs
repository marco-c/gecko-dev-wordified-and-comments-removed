#
[
macro_use
]
pub
mod
decoder
;
mod
cbor
;
mod
util
;
#
[
derive
(
Debug
PartialEq
)
]
pub
enum
CoseError
{
DecodingFailure
LibraryFailure
MalformedInput
MissingHeader
UnexpectedHeaderValue
UnexpectedTag
UnexpectedType
Unimplemented
VerificationFailed
UnknownSignatureScheme
SigningFailed
InvalidArgument
}
#
[
derive
(
Debug
)
]
#
[
derive
(
PartialEq
)
]
pub
enum
SignatureAlgorithm
{
ES256
ES384
ES512
PS256
}
#
[
cfg
(
test
)
]
#
[
macro_use
(
defer
)
]
extern
crate
scopeguard
;
#
[
cfg
(
test
)
]
mod
nss
;
#
[
cfg
(
test
)
]
mod
test_setup
;
#
[
cfg
(
test
)
]
mod
test_nss
;
#
[
cfg
(
test
)
]
mod
util_test
;
#
[
cfg
(
test
)
]
mod
test_cose
;
#
[
derive
(
Debug
)
]
#
[
cfg
(
test
)
]
pub
struct
SignatureParameters
<
'
a
>
{
certificate
:
&
'
a
[
u8
]
algorithm
:
SignatureAlgorithm
pkcs8
:
&
'
a
[
u8
]
}
#
[
derive
(
Debug
)
]
#
[
cfg
(
test
)
]
pub
struct
Signature
<
'
a
>
{
parameter
:
&
'
a
SignatureParameters
<
'
a
>
signature_bytes
:
Vec
<
u8
>
}
