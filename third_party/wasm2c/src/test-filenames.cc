#
include
"
gtest
/
gtest
.
h
"
#
include
"
src
/
filenames
.
h
"
using
namespace
wabt
;
namespace
{
void
assert_string_view_eq
(
const
char
*
s
string_view
sv
)
{
size_t
len
=
std
:
:
strlen
(
s
)
;
ASSERT_EQ
(
len
sv
.
size
(
)
)
;
for
(
size_t
i
=
0
;
i
<
len
;
+
+
i
)
{
ASSERT_EQ
(
s
[
i
]
sv
[
i
]
)
;
}
}
}
TEST
(
filenames
GetBasename
)
{
assert_string_view_eq
(
"
foo
.
txt
"
GetBasename
(
"
/
bar
/
dir
/
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
.
txt
"
GetBasename
(
"
bar
/
dir
/
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
.
txt
"
GetBasename
(
"
/
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
.
txt
"
GetBasename
(
"
\
\
bar
\
\
dir
\
\
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
.
txt
"
GetBasename
(
"
bar
\
\
dir
\
\
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
.
txt
"
GetBasename
(
"
\
\
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
.
txt
"
GetBasename
(
"
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
"
GetBasename
(
"
foo
"
)
)
;
assert_string_view_eq
(
"
"
GetBasename
(
"
"
)
)
;
}
TEST
(
filenames
GetExtension
)
{
assert_string_view_eq
(
"
.
txt
"
GetExtension
(
"
/
bar
/
dir
/
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
.
txt
"
GetExtension
(
"
bar
/
dir
/
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
.
txt
"
GetExtension
(
"
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
"
GetExtension
(
"
foo
"
)
)
;
assert_string_view_eq
(
"
"
GetExtension
(
"
"
)
)
;
}
TEST
(
filenames
StripExtension
)
{
assert_string_view_eq
(
"
/
bar
/
dir
/
foo
"
StripExtension
(
"
/
bar
/
dir
/
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
bar
/
dir
/
foo
"
StripExtension
(
"
bar
/
dir
/
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
"
StripExtension
(
"
foo
.
txt
"
)
)
;
assert_string_view_eq
(
"
foo
"
StripExtension
(
"
foo
"
)
)
;
assert_string_view_eq
(
"
"
StripExtension
(
"
"
)
)
;
}
