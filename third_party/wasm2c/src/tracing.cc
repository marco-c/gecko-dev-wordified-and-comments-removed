#
define
WABT_TRACING
1
#
include
"
src
/
tracing
.
h
"
namespace
{
size_t
indent
=
0
;
const
char
*
indent_text
=
"
"
;
void
Fill
(
)
{
for
(
size_t
i
=
0
;
i
<
indent
;
+
+
i
)
fputs
(
indent_text
stderr
)
;
}
void
Indent
(
)
{
Fill
(
)
;
+
+
indent
;
}
void
Dedent
(
)
{
if
(
indent
)
{
-
-
indent
;
}
Fill
(
)
;
}
}
namespace
wabt
{
TraceScope
:
:
TraceScope
(
const
char
*
method
)
:
method_
(
method
)
{
PrintEnter
(
method
)
;
PrintNewline
(
)
;
}
TraceScope
:
:
~
TraceScope
(
)
{
Dedent
(
)
;
fputs
(
"
<
-
"
stderr
)
;
fputs
(
method_
stderr
)
;
fputc
(
'
\
n
'
stderr
)
;
}
void
TraceScope
:
:
PrintEnter
(
const
char
*
method
)
{
Indent
(
)
;
fputs
(
"
-
>
"
stderr
)
;
fputs
(
method
stderr
)
;
fputs
(
"
(
"
stderr
)
;
}
void
TraceScope
:
:
PrintNewline
(
)
{
fputs
(
"
)
\
n
"
stderr
)
;
}
}
