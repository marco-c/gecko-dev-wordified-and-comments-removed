#
include
"
absl
/
base
/
prefetch
.
h
"
#
include
<
memory
>
#
include
"
gtest
/
gtest
.
h
"
namespace
{
TEST
(
PrefetchTest
PrefetchToLocalCache_StackA
)
{
char
buf
[
100
]
=
{
}
;
absl
:
:
PrefetchToLocalCache
(
buf
)
;
absl
:
:
PrefetchToLocalCacheNta
(
buf
)
;
absl
:
:
PrefetchToLocalCacheForWrite
(
buf
)
;
}
TEST
(
PrefetchTest
PrefetchToLocalCache_Heap
)
{
auto
memory
=
std
:
:
make_unique
<
char
[
]
>
(
200
<
<
10
)
;
memset
(
memory
.
get
(
)
0
200
<
<
10
)
;
absl
:
:
PrefetchToLocalCache
(
memory
.
get
(
)
)
;
absl
:
:
PrefetchToLocalCacheNta
(
memory
.
get
(
)
)
;
absl
:
:
PrefetchToLocalCacheForWrite
(
memory
.
get
(
)
)
;
absl
:
:
PrefetchToLocalCache
(
memory
.
get
(
)
+
(
50
<
<
10
)
)
;
absl
:
:
PrefetchToLocalCacheNta
(
memory
.
get
(
)
+
(
50
<
<
10
)
)
;
absl
:
:
PrefetchToLocalCacheForWrite
(
memory
.
get
(
)
+
(
50
<
<
10
)
)
;
absl
:
:
PrefetchToLocalCache
(
memory
.
get
(
)
+
(
100
<
<
10
)
)
;
absl
:
:
PrefetchToLocalCacheNta
(
memory
.
get
(
)
+
(
100
<
<
10
)
)
;
absl
:
:
PrefetchToLocalCacheForWrite
(
memory
.
get
(
)
+
(
100
<
<
10
)
)
;
absl
:
:
PrefetchToLocalCache
(
memory
.
get
(
)
+
(
150
<
<
10
)
)
;
absl
:
:
PrefetchToLocalCacheNta
(
memory
.
get
(
)
+
(
150
<
<
10
)
)
;
absl
:
:
PrefetchToLocalCacheForWrite
(
memory
.
get
(
)
+
(
150
<
<
10
)
)
;
}
TEST
(
PrefetchTest
PrefetchToLocalCache_Nullptr
)
{
absl
:
:
PrefetchToLocalCache
(
nullptr
)
;
absl
:
:
PrefetchToLocalCacheNta
(
nullptr
)
;
absl
:
:
PrefetchToLocalCacheForWrite
(
nullptr
)
;
}
TEST
(
PrefetchTest
PrefetchToLocalCache_InvalidPtr
)
{
absl
:
:
PrefetchToLocalCache
(
reinterpret_cast
<
const
void
*
>
(
0x785326532L
)
)
;
absl
:
:
PrefetchToLocalCacheNta
(
reinterpret_cast
<
const
void
*
>
(
0x785326532L
)
)
;
absl
:
:
PrefetchToLocalCacheForWrite
(
reinterpret_cast
<
const
void
*
>
(
0x78532L
)
)
;
}
}
