#
ifndef
__CLIENT_H__
#
define
__CLIENT_H__
#
include
"
mparray
.
h
"
#
include
"
prg
.
h
"
#
include
"
share
.
h
"
typedef
struct
prio_packet_client
*
PrioPacketClient
;
typedef
const
struct
prio_packet_client
*
const_PrioPacketClient
;
struct
server_a_data
{
MPArray
data_shares
;
MPArray
h_points
;
}
;
struct
server_b_data
{
PrioPRGSeed
seed
;
}
;
struct
prio_packet_client
{
BeaverTriple
triple
;
mp_int
f0_share
g0_share
h0_share
;
PrioServerId
for_server
;
union
{
struct
server_a_data
A
;
struct
server_b_data
B
;
}
shares
;
}
;
PrioPacketClient
PrioPacketClient_new
(
const_PrioConfig
cfg
PrioServerId
for_server
)
;
void
PrioPacketClient_clear
(
PrioPacketClient
p
)
;
SECStatus
PrioPacketClient_set_data
(
const_PrioConfig
cfg
const
bool
*
data_in
PrioPacketClient
for_server_a
PrioPacketClient
for_server_b
)
;
SECStatus
PrioPacketClient_decrypt
(
PrioPacketClient
p
const_PrioConfig
cfg
PrivateKey
server_priv
const
unsigned
char
*
data_in
unsigned
int
data_len
)
;
bool
PrioPacketClient_areEqual
(
const_PrioPacketClient
p1
const_PrioPacketClient
p2
)
;
#
endif
