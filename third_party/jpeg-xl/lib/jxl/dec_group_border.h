#
ifndef
LIB_JXL_DEC_GROUP_BORDER_H_
#
define
LIB_JXL_DEC_GROUP_BORDER_H_
#
include
<
stddef
.
h
>
#
include
<
atomic
>
#
include
"
lib
/
jxl
/
base
/
arch_macros
.
h
"
#
include
"
lib
/
jxl
/
base
/
status
.
h
"
#
include
"
lib
/
jxl
/
common
.
h
"
#
include
"
lib
/
jxl
/
image
.
h
"
namespace
jxl
{
class
GroupBorderAssigner
{
public
:
void
Init
(
const
FrameDimensions
&
frame_dim
)
;
void
GroupDone
(
size_t
group_id
size_t
padding
Rect
*
rects_to_finalize
size_t
*
num_to_finalize
)
;
void
ClearDone
(
size_t
group_id
)
;
static
constexpr
size_t
kMaxToFinalize
=
3
;
#
if
defined
(
__ARM_NEON
)
|
|
defined
(
__ARM_NEON__
)
static
constexpr
size_t
kPaddingXRound
=
4
;
#
else
static
constexpr
size_t
kPaddingXRound
=
kBlockDim
;
#
endif
static
size_t
PaddingX
(
size_t
padding
)
{
return
RoundUpTo
(
padding
kPaddingXRound
)
;
}
private
:
FrameDimensions
frame_dim_
;
std
:
:
unique_ptr
<
std
:
:
atomic
<
uint8_t
>
[
]
>
counters_
;
static
constexpr
uint8_t
kTopLeft
=
0x01
;
static
constexpr
uint8_t
kTopRight
=
0x02
;
static
constexpr
uint8_t
kBottomRight
=
0x04
;
static
constexpr
uint8_t
kBottomLeft
=
0x08
;
}
;
}
#
endif
