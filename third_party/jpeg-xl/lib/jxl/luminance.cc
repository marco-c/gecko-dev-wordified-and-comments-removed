#
include
"
lib
/
jxl
/
luminance
.
h
"
#
include
"
lib
/
jxl
/
codec_in_out
.
h
"
#
include
"
lib
/
jxl
/
color_encoding_internal
.
h
"
namespace
jxl
{
void
SetIntensityTarget
(
CodecInOut
*
io
)
{
if
(
io
-
>
target_nits
!
=
0
)
{
io
-
>
metadata
.
m
.
SetIntensityTarget
(
io
-
>
target_nits
)
;
return
;
}
if
(
io
-
>
metadata
.
m
.
color_encoding
.
tf
.
IsPQ
(
)
)
{
io
-
>
metadata
.
m
.
SetIntensityTarget
(
10000
)
;
}
else
if
(
io
-
>
metadata
.
m
.
color_encoding
.
tf
.
IsHLG
(
)
)
{
io
-
>
metadata
.
m
.
SetIntensityTarget
(
1000
)
;
}
else
{
io
-
>
metadata
.
m
.
SetIntensityTarget
(
kDefaultIntensityTarget
)
;
}
}
}
