#
include
"
base
/
files
/
scoped_file
.
h
"
#
include
"
base
/
check
.
h
"
#
include
"
build
/
build_config
.
h
"
#
if
BUILDFLAG
(
IS_POSIX
)
|
|
BUILDFLAG
(
IS_FUCHSIA
)
#
include
<
errno
.
h
>
#
include
<
unistd
.
h
>
#
include
"
base
/
posix
/
eintr_wrapper
.
h
"
#
endif
namespace
base
{
namespace
internal
{
#
if
BUILDFLAG
(
IS_POSIX
)
|
|
BUILDFLAG
(
IS_FUCHSIA
)
void
ScopedFDCloseTraits
:
:
Free
(
int
fd
)
{
int
ret
=
IGNORE_EINTR
(
close
(
fd
)
)
;
#
if
BUILDFLAG
(
IS_LINUX
)
|
|
BUILDFLAG
(
IS_CHROMEOS
)
|
|
BUILDFLAG
(
IS_APPLE
)
|
|
\
BUILDFLAG
(
IS_FUCHSIA
)
|
|
BUILDFLAG
(
IS_ANDROID
)
if
(
ret
!
=
0
&
&
errno
!
=
EBADF
)
ret
=
0
;
#
endif
PCHECK
(
0
=
=
ret
)
;
}
#
endif
}
}
