#
ifndef
PC_VIDEO_TRACK_H_
#
define
PC_VIDEO_TRACK_H_
#
include
<
optional
>
#
include
<
string
>
#
include
"
api
/
media_stream_interface
.
h
"
#
include
"
api
/
media_stream_track
.
h
"
#
include
"
api
/
scoped_refptr
.
h
"
#
include
"
api
/
sequence_checker
.
h
"
#
include
"
api
/
video
/
video_frame
.
h
"
#
include
"
api
/
video
/
video_sink_interface
.
h
"
#
include
"
api
/
video
/
video_source_interface
.
h
"
#
include
"
media
/
base
/
video_source_base
.
h
"
#
include
"
pc
/
video_track_source_proxy
.
h
"
#
include
"
rtc_base
/
system
/
no_unique_address
.
h
"
#
include
"
rtc_base
/
thread
.
h
"
#
include
"
rtc_base
/
thread_annotations
.
h
"
namespace
webrtc
{
class
VideoTrack
:
public
MediaStreamTrack
<
VideoTrackInterface
>
public
VideoSourceBaseGuarded
public
ObserverInterface
{
public
:
static
scoped_refptr
<
VideoTrack
>
Create
(
absl
:
:
string_view
label
scoped_refptr
<
VideoTrackSourceInterface
>
source
Thread
*
worker_thread
)
;
void
AddOrUpdateSink
(
VideoSinkInterface
<
VideoFrame
>
*
sink
const
VideoSinkWants
&
wants
)
override
;
void
RemoveSink
(
VideoSinkInterface
<
VideoFrame
>
*
sink
)
override
;
void
RequestRefreshFrame
(
)
override
;
VideoTrackSourceInterface
*
GetSource
(
)
const
override
;
ContentHint
content_hint
(
)
const
override
;
void
set_content_hint
(
ContentHint
hint
)
override
;
bool
set_enabled
(
bool
enable
)
override
;
bool
enabled
(
)
const
override
;
MediaStreamTrackInterface
:
:
TrackState
state
(
)
const
override
;
std
:
:
string
kind
(
)
const
override
;
VideoTrackSourceInterface
*
GetSourceInternal
(
)
const
;
protected
:
VideoTrack
(
absl
:
:
string_view
id
scoped_refptr
<
VideoTrackSourceProxyWithInternal
<
VideoTrackSourceInterface
>
>
source
Thread
*
worker_thread
)
;
~
VideoTrack
(
)
;
private
:
void
OnChanged
(
)
override
;
RTC_NO_UNIQUE_ADDRESS
SequenceChecker
signaling_thread_
;
Thread
*
const
worker_thread_
;
const
scoped_refptr
<
VideoTrackSourceProxyWithInternal
<
VideoTrackSourceInterface
>
>
video_source_
;
ContentHint
content_hint_
RTC_GUARDED_BY
(
&
signaling_thread_
)
;
bool
enabled_w_
RTC_GUARDED_BY
(
worker_thread_
)
=
true
;
}
;
}
#
endif
