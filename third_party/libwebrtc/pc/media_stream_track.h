#
ifndef
PC_MEDIA_STREAM_TRACK_H_
#
define
PC_MEDIA_STREAM_TRACK_H_
#
include
<
string
>
#
include
"
api
/
media_stream_interface
.
h
"
#
include
"
api
/
notifier
.
h
"
namespace
webrtc
{
template
<
typename
T
>
class
MediaStreamTrack
:
public
Notifier
<
T
>
{
public
:
typedef
typename
T
:
:
TrackState
TypedTrackState
;
std
:
:
string
id
(
)
const
override
{
return
id_
;
}
MediaStreamTrackInterface
:
:
TrackState
state
(
)
const
override
{
return
state_
;
}
bool
enabled
(
)
const
override
{
return
enabled_
;
}
bool
set_enabled
(
bool
enable
)
override
{
bool
fire_on_change
=
(
enable
!
=
enabled_
)
;
enabled_
=
enable
;
if
(
fire_on_change
)
{
Notifier
<
T
>
:
:
FireOnChanged
(
)
;
}
return
fire_on_change
;
}
protected
:
explicit
MediaStreamTrack
(
const
std
:
:
string
&
id
)
:
enabled_
(
true
)
id_
(
id
)
state_
(
MediaStreamTrackInterface
:
:
kLive
)
{
}
bool
set_state
(
MediaStreamTrackInterface
:
:
TrackState
new_state
)
{
bool
fire_on_change
=
(
state_
!
=
new_state
)
;
state_
=
new_state
;
if
(
fire_on_change
)
Notifier
<
T
>
:
:
FireOnChanged
(
)
;
return
true
;
}
private
:
bool
enabled_
;
const
std
:
:
string
id_
;
MediaStreamTrackInterface
:
:
TrackState
state_
;
}
;
}
#
endif
