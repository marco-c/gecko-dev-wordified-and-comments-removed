#
ifndef
PC_SDP_OFFER_ANSWER_H_
#
define
PC_SDP_OFFER_ANSWER_H_
#
include
<
stddef
.
h
>
#
include
<
stdint
.
h
>
#
include
<
functional
>
#
include
<
map
>
#
include
<
memory
>
#
include
<
optional
>
#
include
<
set
>
#
include
<
string
>
#
include
<
vector
>
#
include
"
api
/
audio_options
.
h
"
#
include
"
api
/
candidate
.
h
"
#
include
"
api
/
jsep
.
h
"
#
include
"
api
/
jsep_ice_candidate
.
h
"
#
include
"
api
/
media_stream_interface
.
h
"
#
include
"
api
/
media_types
.
h
"
#
include
"
api
/
peer_connection_interface
.
h
"
#
include
"
api
/
rtc_error
.
h
"
#
include
"
api
/
rtp_transceiver_direction
.
h
"
#
include
"
api
/
rtp_transceiver_interface
.
h
"
#
include
"
api
/
scoped_refptr
.
h
"
#
include
"
api
/
sequence_checker
.
h
"
#
include
"
api
/
set_local_description_observer_interface
.
h
"
#
include
"
api
/
set_remote_description_observer_interface
.
h
"
#
include
"
api
/
uma_metrics
.
h
"
#
include
"
api
/
video
/
video_bitrate_allocator_factory
.
h
"
#
include
"
media
/
base
/
media_channel
.
h
"
#
include
"
media
/
base
/
media_engine
.
h
"
#
include
"
media
/
base
/
stream_params
.
h
"
#
include
"
p2p
/
base
/
port_allocator
.
h
"
#
include
"
pc
/
codec_vendor
.
h
"
#
include
"
pc
/
connection_context
.
h
"
#
include
"
pc
/
data_channel_controller
.
h
"
#
include
"
pc
/
jsep_transport_controller
.
h
"
#
include
"
pc
/
media_options
.
h
"
#
include
"
pc
/
media_session
.
h
"
#
include
"
pc
/
media_stream_observer
.
h
"
#
include
"
pc
/
rtp_receiver
.
h
"
#
include
"
pc
/
rtp_transceiver
.
h
"
#
include
"
pc
/
rtp_transmission_manager
.
h
"
#
include
"
pc
/
sdp_state_provider
.
h
"
#
include
"
pc
/
session_description
.
h
"
#
include
"
pc
/
stream_collection
.
h
"
#
include
"
pc
/
transceiver_list
.
h
"
#
include
"
pc
/
webrtc_session_description_factory
.
h
"
#
include
"
rtc_base
/
operations_chain
.
h
"
#
include
"
rtc_base
/
rtc_certificate_generator
.
h
"
#
include
"
rtc_base
/
ssl_stream_adapter
.
h
"
#
include
"
rtc_base
/
thread
.
h
"
#
include
"
rtc_base
/
thread_annotations
.
h
"
#
include
"
rtc_base
/
unique_id_generator
.
h
"
#
include
"
rtc_base
/
weak_ptr
.
h
"
namespace
webrtc
{
class
SdpOfferAnswerHandler
:
public
SdpStateProvider
{
public
:
~
SdpOfferAnswerHandler
(
)
;
static
std
:
:
unique_ptr
<
SdpOfferAnswerHandler
>
Create
(
PeerConnectionSdpMethods
*
pc
const
PeerConnectionInterface
:
:
RTCConfiguration
&
configuration
std
:
:
unique_ptr
<
RTCCertificateGeneratorInterface
>
cert_generator
std
:
:
unique_ptr
<
webrtc
:
:
VideoBitrateAllocatorFactory
>
video_bitrate_allocator_factory
ConnectionContext
*
context
CodecLookupHelper
*
codec_lookup_helper
)
;
void
ResetSessionDescFactory
(
)
{
RTC_DCHECK_RUN_ON
(
signaling_thread
(
)
)
;
webrtc_session_desc_factory_
.
reset
(
)
;
}
const
WebRtcSessionDescriptionFactory
*
webrtc_session_desc_factory
(
)
const
{
RTC_DCHECK_RUN_ON
(
signaling_thread
(
)
)
;
return
webrtc_session_desc_factory_
.
get
(
)
;
}
void
Close
(
)
;
void
PrepareForShutdown
(
)
;
PeerConnectionInterface
:
:
SignalingState
signaling_state
(
)
const
override
;
const
SessionDescriptionInterface
*
local_description
(
)
const
override
;
const
SessionDescriptionInterface
*
remote_description
(
)
const
override
;
const
SessionDescriptionInterface
*
current_local_description
(
)
const
override
;
const
SessionDescriptionInterface
*
current_remote_description
(
)
const
override
;
const
SessionDescriptionInterface
*
pending_local_description
(
)
const
override
;
const
SessionDescriptionInterface
*
pending_remote_description
(
)
const
override
;
bool
NeedsIceRestart
(
const
std
:
:
string
&
content_name
)
const
override
;
bool
IceRestartPending
(
const
std
:
:
string
&
content_name
)
const
override
;
std
:
:
optional
<
SSLRole
>
GetDtlsRole
(
const
std
:
:
string
&
mid
)
const
override
;
void
RestartIce
(
)
;
void
CreateOffer
(
CreateSessionDescriptionObserver
*
observer
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
options
)
;
void
CreateAnswer
(
CreateSessionDescriptionObserver
*
observer
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
options
)
;
void
SetLocalDescription
(
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
desc
scoped_refptr
<
SetLocalDescriptionObserverInterface
>
observer
)
;
void
SetLocalDescription
(
scoped_refptr
<
SetLocalDescriptionObserverInterface
>
observer
)
;
void
SetLocalDescription
(
SetSessionDescriptionObserver
*
observer
SessionDescriptionInterface
*
desc
)
;
void
SetLocalDescription
(
SetSessionDescriptionObserver
*
observer
)
;
void
SetRemoteDescription
(
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
desc
scoped_refptr
<
SetRemoteDescriptionObserverInterface
>
observer
)
;
void
SetRemoteDescription
(
SetSessionDescriptionObserver
*
observer
SessionDescriptionInterface
*
desc
)
;
PeerConnectionInterface
:
:
RTCConfiguration
GetConfiguration
(
)
;
RTCError
SetConfiguration
(
const
PeerConnectionInterface
:
:
RTCConfiguration
&
configuration
)
;
bool
AddIceCandidate
(
const
IceCandidateInterface
*
candidate
)
;
void
AddIceCandidate
(
std
:
:
unique_ptr
<
IceCandidateInterface
>
candidate
std
:
:
function
<
void
(
RTCError
)
>
callback
)
;
bool
RemoveIceCandidates
(
const
std
:
:
vector
<
Candidate
>
&
candidates
)
;
void
AddLocalIceCandidate
(
const
JsepIceCandidate
*
candidate
)
;
void
RemoveLocalIceCandidates
(
const
std
:
:
vector
<
Candidate
>
&
candidates
)
;
bool
ShouldFireNegotiationNeededEvent
(
uint32_t
event_id
)
;
bool
AddStream
(
MediaStreamInterface
*
local_stream
)
;
void
RemoveStream
(
MediaStreamInterface
*
local_stream
)
;
std
:
:
optional
<
bool
>
is_caller
(
)
const
;
bool
HasNewIceCredentials
(
)
;
void
UpdateNegotiationNeeded
(
)
;
void
AllocateSctpSids
(
)
;
std
:
:
optional
<
SSLRole
>
GuessSslRole
(
)
const
;
void
DestroyMediaChannels
(
)
;
scoped_refptr
<
StreamCollectionInterface
>
local_streams
(
)
;
scoped_refptr
<
StreamCollectionInterface
>
remote_streams
(
)
;
bool
initial_offerer
(
)
{
RTC_DCHECK_RUN_ON
(
signaling_thread
(
)
)
;
if
(
initial_offerer_
)
{
return
*
initial_offerer_
;
}
return
false
;
}
SdpMungingType
sdp_munging_type
(
)
const
{
return
last_sdp_munging_type_
;
}
void
DisableSdpMungingChecksForTesting
(
)
{
disable_sdp_munging_checks_
=
true
;
}
private
:
class
RemoteDescriptionOperation
;
class
ImplicitCreateSessionDescriptionObserver
;
friend
class
ImplicitCreateSessionDescriptionObserver
;
class
SetSessionDescriptionObserverAdapter
;
friend
class
SetSessionDescriptionObserverAdapter
;
enum
class
SessionError
{
kNone
kContent
kTransport
}
;
class
LocalIceCredentialsToReplace
;
explicit
SdpOfferAnswerHandler
(
PeerConnectionSdpMethods
*
pc
ConnectionContext
*
context
)
;
void
Initialize
(
const
PeerConnectionInterface
:
:
RTCConfiguration
&
configuration
std
:
:
unique_ptr
<
RTCCertificateGeneratorInterface
>
cert_generator
std
:
:
unique_ptr
<
webrtc
:
:
VideoBitrateAllocatorFactory
>
video_bitrate_allocator_factory
ConnectionContext
*
context
CodecLookupHelper
*
codec_lookup_helper
)
;
Thread
*
signaling_thread
(
)
const
;
Thread
*
network_thread
(
)
const
;
SessionDescriptionInterface
*
mutable_local_description
(
)
RTC_RUN_ON
(
signaling_thread
(
)
)
{
return
pending_local_description_
?
pending_local_description_
.
get
(
)
:
current_local_description_
.
get
(
)
;
}
SessionDescriptionInterface
*
mutable_remote_description
(
)
RTC_RUN_ON
(
signaling_thread
(
)
)
{
return
pending_remote_description_
?
pending_remote_description_
.
get
(
)
:
current_remote_description_
.
get
(
)
;
}
RTCError
ApplyLocalDescription
(
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
desc
const
std
:
:
map
<
std
:
:
string
const
ContentGroup
*
>
&
bundle_groups_by_mid
)
;
void
ApplyRemoteDescription
(
std
:
:
unique_ptr
<
RemoteDescriptionOperation
>
operation
)
;
RTCError
ReplaceRemoteDescription
(
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
desc
SdpType
sdp_type
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
*
replaced_description
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
ApplyRemoteDescriptionUpdateTransceiverState
(
SdpType
sdp_type
)
;
void
PlanBUpdateSendersAndReceivers
(
const
ContentInfo
*
audio_content
const
AudioContentDescription
*
audio_desc
const
ContentInfo
*
video_content
const
VideoContentDescription
*
video_desc
)
;
void
DoCreateOffer
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
options
scoped_refptr
<
CreateSessionDescriptionObserver
>
observer
)
;
void
DoCreateAnswer
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
options
scoped_refptr
<
CreateSessionDescriptionObserver
>
observer
)
;
void
DoSetLocalDescription
(
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
desc
scoped_refptr
<
SetLocalDescriptionObserverInterface
>
observer
)
;
void
DoSetRemoteDescription
(
std
:
:
unique_ptr
<
RemoteDescriptionOperation
>
operation
)
;
void
SetRemoteDescriptionPostProcess
(
bool
was_answer
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
ChangeSignalingState
(
PeerConnectionInterface
:
:
SignalingState
signaling_state
)
;
RTCError
UpdateSessionState
(
SdpType
type
ContentSource
source
const
SessionDescription
*
description
const
std
:
:
map
<
std
:
:
string
const
ContentGroup
*
>
&
bundle_groups_by_mid
)
;
bool
IsUnifiedPlan
(
)
const
;
void
OnAudioTrackAdded
(
AudioTrackInterface
*
track
MediaStreamInterface
*
stream
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
OnAudioTrackRemoved
(
AudioTrackInterface
*
track
MediaStreamInterface
*
stream
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
OnVideoTrackAdded
(
VideoTrackInterface
*
track
MediaStreamInterface
*
stream
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
OnVideoTrackRemoved
(
VideoTrackInterface
*
track
MediaStreamInterface
*
stream
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
RTCError
Rollback
(
SdpType
desc_type
)
;
void
OnOperationsChainEmpty
(
)
;
void
SetAssociatedRemoteStreams
(
scoped_refptr
<
RtpReceiverInternal
>
receiver
const
std
:
:
vector
<
std
:
:
string
>
&
stream_ids
std
:
:
vector
<
scoped_refptr
<
MediaStreamInterface
>
>
*
added_streams
std
:
:
vector
<
scoped_refptr
<
MediaStreamInterface
>
>
*
removed_streams
)
;
bool
CheckIfNegotiationIsNeeded
(
)
;
void
GenerateNegotiationNeededEvent
(
)
;
RTCError
ValidateSessionDescription
(
const
SessionDescriptionInterface
*
sdesc
ContentSource
source
const
std
:
:
map
<
std
:
:
string
const
ContentGroup
*
>
&
bundle_groups_by_mid
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
RTCError
UpdateTransceiversAndDataChannels
(
ContentSource
source
const
SessionDescriptionInterface
&
new_session
const
SessionDescriptionInterface
*
old_local_description
const
SessionDescriptionInterface
*
old_remote_description
const
std
:
:
map
<
std
:
:
string
const
ContentGroup
*
>
&
bundle_groups_by_mid
)
;
RTCErrorOr
<
scoped_refptr
<
RtpTransceiverProxyWithInternal
<
RtpTransceiver
>
>
>
AssociateTransceiver
(
ContentSource
source
SdpType
type
size_t
mline_index
const
ContentInfo
&
content
const
ContentInfo
*
old_local_content
const
ContentInfo
*
old_remote_content
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
const
ContentInfo
*
FindMediaSectionForTransceiver
(
const
RtpTransceiver
*
transceiver
const
SessionDescriptionInterface
*
sdesc
)
const
;
RTCError
UpdateTransceiverChannel
(
scoped_refptr
<
RtpTransceiverProxyWithInternal
<
RtpTransceiver
>
>
transceiver
const
ContentInfo
&
content
const
ContentGroup
*
bundle_group
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
RTCError
UpdateDataChannelTransport
(
ContentSource
source
const
ContentInfo
&
content
const
ContentGroup
*
bundle_group
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
bool
ExpectSetLocalDescription
(
SdpType
type
)
;
bool
ExpectSetRemoteDescription
(
SdpType
type
)
;
void
FillInMissingRemoteMids
(
SessionDescription
*
remote_description
)
;
scoped_refptr
<
RtpTransceiverProxyWithInternal
<
RtpTransceiver
>
>
FindAvailableTransceiverToReceive
(
webrtc
:
:
MediaType
media_type
)
const
;
void
GetOptionsForOffer
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
offer_answer_options
MediaSessionOptions
*
session_options
)
;
void
GetOptionsForPlanBOffer
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
offer_answer_options
MediaSessionOptions
*
session_options
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
GetOptionsForUnifiedPlanOffer
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
offer_answer_options
MediaSessionOptions
*
session_options
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
GetOptionsForAnswer
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
offer_answer_options
MediaSessionOptions
*
session_options
)
;
void
GetOptionsForPlanBAnswer
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
offer_answer_options
MediaSessionOptions
*
session_options
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
GetOptionsForUnifiedPlanAnswer
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
offer_answer_options
MediaSessionOptions
*
session_options
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
const
char
*
SessionErrorToString
(
SessionError
error
)
const
;
std
:
:
string
GetSessionErrorMsg
(
)
;
SessionError
session_error
(
)
const
{
RTC_DCHECK_RUN_ON
(
signaling_thread
(
)
)
;
return
session_error_
;
}
const
std
:
:
string
&
session_error_desc
(
)
const
{
return
session_error_desc_
;
}
RTCError
HandleLegacyOfferOptions
(
const
PeerConnectionInterface
:
:
RTCOfferAnswerOptions
&
options
)
;
void
RemoveRecvDirectionFromReceivingTransceiversOfType
(
webrtc
:
:
MediaType
media_type
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
AddUpToOneReceivingTransceiverOfType
(
webrtc
:
:
MediaType
media_type
)
;
std
:
:
vector
<
scoped_refptr
<
RtpTransceiverProxyWithInternal
<
RtpTransceiver
>
>
>
GetReceivingTransceiversOfType
(
webrtc
:
:
MediaType
media_type
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
void
ProcessRemovalOfRemoteTrack
(
const
scoped_refptr
<
RtpTransceiverProxyWithInternal
<
RtpTransceiver
>
>
transceiver
std
:
:
vector
<
scoped_refptr
<
RtpTransceiverInterface
>
>
*
remove_list
std
:
:
vector
<
scoped_refptr
<
MediaStreamInterface
>
>
*
removed_streams
)
;
void
RemoveRemoteStreamsIfEmpty
(
const
std
:
:
vector
<
scoped_refptr
<
MediaStreamInterface
>
>
&
remote_streams
std
:
:
vector
<
scoped_refptr
<
MediaStreamInterface
>
>
*
removed_streams
)
;
void
RemoveSenders
(
webrtc
:
:
MediaType
media_type
)
;
void
UpdateLocalSenders
(
const
std
:
:
vector
<
StreamParams
>
&
streams
webrtc
:
:
MediaType
media_type
)
;
void
UpdateRemoteSendersList
(
const
std
:
:
vector
<
StreamParams
>
&
streams
bool
default_track_needed
webrtc
:
:
MediaType
media_type
StreamCollection
*
new_streams
)
;
void
EnableSending
(
)
;
RTCError
PushdownMediaDescription
(
SdpType
type
ContentSource
source
const
std
:
:
map
<
std
:
:
string
const
ContentGroup
*
>
&
bundle_groups_by_mid
)
;
RTCError
PushdownTransportDescription
(
ContentSource
source
SdpType
type
)
;
void
RemoveStoppedTransceivers
(
)
;
void
RemoveUnusedChannels
(
const
SessionDescription
*
desc
)
;
void
UpdateEndedRemoteMediaStreams
(
)
;
bool
UseCandidatesInRemoteDescription
(
)
;
bool
UseCandidate
(
const
IceCandidateInterface
*
candidate
)
;
bool
ReadyToUseRemoteCandidate
(
const
IceCandidateInterface
*
candidate
const
SessionDescriptionInterface
*
remote_desc
bool
*
valid
)
;
RTCErrorOr
<
const
ContentInfo
*
>
FindContentInfo
(
const
SessionDescriptionInterface
*
description
const
IceCandidateInterface
*
candidate
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
RTCError
CreateChannels
(
const
SessionDescription
&
desc
)
;
void
GenerateMediaDescriptionOptions
(
const
SessionDescriptionInterface
*
session_desc
RtpTransceiverDirection
audio_direction
RtpTransceiverDirection
video_direction
std
:
:
optional
<
size_t
>
*
audio_index
std
:
:
optional
<
size_t
>
*
video_index
std
:
:
optional
<
size_t
>
*
data_index
MediaSessionOptions
*
session_options
)
;
MediaDescriptionOptions
GetMediaDescriptionOptionsForActiveData
(
const
std
:
:
string
&
mid
)
const
;
MediaDescriptionOptions
GetMediaDescriptionOptionsForRejectedData
(
const
std
:
:
string
&
mid
)
const
;
bool
UpdatePayloadTypeDemuxingState
(
ContentSource
source
const
std
:
:
map
<
std
:
:
string
const
ContentGroup
*
>
&
bundle_groups_by_mid
)
;
void
SetSessionError
(
SessionError
error
const
std
:
:
string
&
error_desc
)
;
AddIceCandidateResult
AddIceCandidateInternal
(
const
IceCandidateInterface
*
candidate
)
;
void
ReportInitialSdpMunging
(
bool
had_local_description
SdpType
type
)
;
MediaEngineInterface
*
media_engine
(
)
const
;
TransceiverList
*
transceivers
(
)
;
const
TransceiverList
*
transceivers
(
)
const
;
DataChannelController
*
data_channel_controller
(
)
;
const
DataChannelController
*
data_channel_controller
(
)
const
;
PortAllocator
*
port_allocator
(
)
;
const
PortAllocator
*
port_allocator
(
)
const
;
RtpTransmissionManager
*
rtp_manager
(
)
;
const
RtpTransmissionManager
*
rtp_manager
(
)
const
;
JsepTransportController
*
transport_controller_s
(
)
RTC_RUN_ON
(
signaling_thread
(
)
)
;
const
JsepTransportController
*
transport_controller_s
(
)
const
RTC_RUN_ON
(
signaling_thread
(
)
)
;
JsepTransportController
*
transport_controller_n
(
)
RTC_RUN_ON
(
network_thread
(
)
)
;
const
JsepTransportController
*
transport_controller_n
(
)
const
RTC_RUN_ON
(
network_thread
(
)
)
;
const
AudioOptions
&
audio_options
(
)
{
return
audio_options_
;
}
const
VideoOptions
&
video_options
(
)
{
return
video_options_
;
}
bool
ConfiguredForMedia
(
)
const
;
PeerConnectionSdpMethods
*
const
pc_
;
ConnectionContext
*
const
context_
;
std
:
:
unique_ptr
<
WebRtcSessionDescriptionFactory
>
webrtc_session_desc_factory_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
current_local_description_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
pending_local_description_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
current_remote_description_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
pending_remote_description_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
last_created_offer_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
unique_ptr
<
SessionDescriptionInterface
>
last_created_answer_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
SdpMungingType
last_sdp_munging_type_
=
SdpMungingType
:
:
kNoModification
;
PeerConnectionInterface
:
:
SignalingState
signaling_state_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
=
PeerConnectionInterface
:
:
kStable
;
std
:
:
optional
<
bool
>
is_caller_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
const
scoped_refptr
<
StreamCollection
>
local_streams_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
const
scoped_refptr
<
StreamCollection
>
remote_streams_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
vector
<
std
:
:
unique_ptr
<
MediaStreamObserver
>
>
stream_observers_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
scoped_refptr
<
OperationsChain
>
operations_chain_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
const
std
:
:
string
rtcp_cname_
;
UniqueStringGenerator
mid_generator_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
set
<
std
:
:
string
>
pending_ice_restarts_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
unique_ptr
<
LocalIceCredentialsToReplace
>
local_ice_credentials_to_replace_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
bool
remote_peer_supports_msid_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
=
false
;
bool
is_negotiation_needed_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
=
false
;
uint32_t
negotiation_needed_event_id_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
=
0
;
bool
update_negotiation_needed_on_empty_chain_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
=
false
;
bool
pt_demuxing_has_been_used_audio_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
=
false
;
bool
pt_demuxing_has_been_used_video_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
=
false
;
scoped_refptr
<
MediaStreamInterface
>
missing_msid_default_stream_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
SessionError
session_error_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
=
SessionError
:
:
kNone
;
std
:
:
string
session_error_desc_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
AudioOptions
audio_options_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
VideoOptions
video_options_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
unique_ptr
<
VideoBitrateAllocatorFactory
>
video_bitrate_allocator_factory_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
std
:
:
optional
<
bool
>
initial_offerer_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
bool
disable_sdp_munging_checks_
=
false
;
CodecLookupHelper
*
codec_lookup_helper_
=
nullptr
;
bool
has_sdp_munged_ufrag_
=
false
;
WeakPtrFactory
<
SdpOfferAnswerHandler
>
weak_ptr_factory_
RTC_GUARDED_BY
(
signaling_thread
(
)
)
;
}
;
}
#
endif
