#
ifndef
PC_TRANSCEIVER_LIST_H_
#
define
PC_TRANSCEIVER_LIST_H_
#
include
<
stddef
.
h
>
#
include
<
algorithm
>
#
include
<
map
>
#
include
<
string
>
#
include
<
vector
>
#
include
"
absl
/
types
/
optional
.
h
"
#
include
"
api
/
media_types
.
h
"
#
include
"
api
/
rtc_error
.
h
"
#
include
"
api
/
rtp_sender_interface
.
h
"
#
include
"
api
/
scoped_refptr
.
h
"
#
include
"
pc
/
rtp_transceiver
.
h
"
namespace
webrtc
{
typedef
rtc
:
:
scoped_refptr
<
RtpTransceiverProxyWithInternal
<
RtpTransceiver
>
>
RtpTransceiverProxyRefPtr
;
class
TransceiverStableState
{
public
:
TransceiverStableState
(
)
{
}
void
set_newly_created
(
)
;
void
SetMSectionIfUnset
(
absl
:
:
optional
<
std
:
:
string
>
mid
absl
:
:
optional
<
size_t
>
mline_index
)
;
void
SetRemoteStreamIdsIfUnset
(
const
std
:
:
vector
<
std
:
:
string
>
&
ids
)
;
absl
:
:
optional
<
std
:
:
string
>
mid
(
)
const
{
return
mid_
;
}
absl
:
:
optional
<
size_t
>
mline_index
(
)
const
{
return
mline_index_
;
}
absl
:
:
optional
<
std
:
:
vector
<
std
:
:
string
>
>
remote_stream_ids
(
)
const
{
return
remote_stream_ids_
;
}
bool
has_m_section
(
)
const
{
return
has_m_section_
;
}
bool
newly_created
(
)
const
{
return
newly_created_
;
}
private
:
absl
:
:
optional
<
std
:
:
string
>
mid_
;
absl
:
:
optional
<
size_t
>
mline_index_
;
absl
:
:
optional
<
std
:
:
vector
<
std
:
:
string
>
>
remote_stream_ids_
;
bool
has_m_section_
=
false
;
bool
newly_created_
=
false
;
}
;
class
TransceiverList
{
public
:
std
:
:
vector
<
RtpTransceiverProxyRefPtr
>
List
(
)
const
{
return
transceivers_
;
}
void
Add
(
RtpTransceiverProxyRefPtr
transceiver
)
{
transceivers_
.
push_back
(
transceiver
)
;
}
void
Remove
(
RtpTransceiverProxyRefPtr
transceiver
)
{
transceivers_
.
erase
(
std
:
:
remove
(
transceivers_
.
begin
(
)
transceivers_
.
end
(
)
transceiver
)
transceivers_
.
end
(
)
)
;
}
RtpTransceiverProxyRefPtr
FindBySender
(
rtc
:
:
scoped_refptr
<
RtpSenderInterface
>
sender
)
const
;
RtpTransceiverProxyRefPtr
FindByMid
(
const
std
:
:
string
&
mid
)
const
;
RtpTransceiverProxyRefPtr
FindByMLineIndex
(
size_t
mline_index
)
const
;
TransceiverStableState
*
StableState
(
RtpTransceiverProxyRefPtr
transceiver
)
{
return
&
(
transceiver_stable_states_by_transceivers_
[
transceiver
]
)
;
}
void
DiscardStableStates
(
)
{
transceiver_stable_states_by_transceivers_
.
clear
(
)
;
}
std
:
:
map
<
RtpTransceiverProxyRefPtr
TransceiverStableState
>
&
StableStates
(
)
{
return
transceiver_stable_states_by_transceivers_
;
}
private
:
std
:
:
vector
<
RtpTransceiverProxyRefPtr
>
transceivers_
;
std
:
:
map
<
RtpTransceiverProxyRefPtr
TransceiverStableState
>
transceiver_stable_states_by_transceivers_
;
std
:
:
map
<
RtpTransceiverProxyRefPtr
std
:
:
vector
<
std
:
:
string
>
>
remote_stream_ids_by_transceivers_
;
}
;
}
#
endif
