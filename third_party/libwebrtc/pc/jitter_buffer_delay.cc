#
include
"
pc
/
jitter_buffer_delay
.
h
"
#
include
<
optional
>
#
include
"
api
/
sequence_checker
.
h
"
#
include
"
rtc_base
/
numerics
/
safe_conversions
.
h
"
#
include
"
rtc_base
/
numerics
/
safe_minmax
.
h
"
namespace
{
constexpr
int
kDefaultDelay
=
0
;
constexpr
int
kMaximumDelayMs
=
10000
;
}
namespace
webrtc
{
void
JitterBufferDelay
:
:
Set
(
std
:
:
optional
<
double
>
delay_seconds
)
{
RTC_DCHECK_RUN_ON
(
&
worker_thread_checker_
)
;
cached_delay_seconds_
=
delay_seconds
;
}
int
JitterBufferDelay
:
:
GetMs
(
)
const
{
RTC_DCHECK_RUN_ON
(
&
worker_thread_checker_
)
;
return
SafeClamp
(
saturated_cast
<
int
>
(
cached_delay_seconds_
.
value_or
(
kDefaultDelay
)
*
1000
)
0
kMaximumDelayMs
)
;
}
}
