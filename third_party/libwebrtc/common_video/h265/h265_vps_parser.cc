#
include
"
common_video
/
h265
/
h265_vps_parser
.
h
"
#
include
"
common_video
/
h265
/
h265_common
.
h
"
#
include
"
rtc_base
/
bit_buffer
.
h
"
#
include
"
rtc_base
/
bitstream_reader
.
h
"
#
include
"
rtc_base
/
logging
.
h
"
namespace
webrtc
{
H265VpsParser
:
:
VpsState
:
:
VpsState
(
)
=
default
;
absl
:
:
optional
<
H265VpsParser
:
:
VpsState
>
H265VpsParser
:
:
ParseVps
(
const
uint8_t
*
data
size_t
length
)
{
RTC_DCHECK
(
data
)
;
return
ParseInternal
(
H265
:
:
ParseRbsp
(
data
length
)
)
;
}
absl
:
:
optional
<
H265VpsParser
:
:
VpsState
>
H265VpsParser
:
:
ParseInternal
(
rtc
:
:
ArrayView
<
const
uint8_t
>
buffer
)
{
BitstreamReader
reader
(
buffer
)
;
VpsState
vps
;
vps
.
id
=
reader
.
ReadBits
(
4
)
;
if
(
!
reader
.
Ok
(
)
)
{
return
absl
:
:
nullopt
;
}
return
vps
;
}
}
