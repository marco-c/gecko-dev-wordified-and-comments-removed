#
ifndef
MODULES_AUDIO_CODING_NETEQ_TOOLS_PACKET_H_
#
define
MODULES_AUDIO_CODING_NETEQ_TOOLS_PACKET_H_
#
include
<
list
>
#
include
<
memory
>
#
include
"
api
/
rtp_headers
.
h
"
#
include
"
modules
/
rtp_rtcp
/
include
/
rtp_header_extension_map
.
h
"
#
include
"
rtc_base
/
constructor_magic
.
h
"
namespace
webrtc
{
namespace
RtpUtility
{
class
RtpHeaderParser
;
}
namespace
test
{
class
Packet
{
public
:
Packet
(
uint8_t
*
packet_memory
size_t
allocated_bytes
size_t
virtual_packet_length_bytes
double
time_ms
const
RtpUtility
:
:
RtpHeaderParser
&
parser
const
RtpHeaderExtensionMap
*
extension_map
=
nullptr
)
;
Packet
(
const
RTPHeader
&
header
size_t
virtual_packet_length_bytes
size_t
virtual_payload_length_bytes
double
time_ms
)
;
Packet
(
uint8_t
*
packet_memory
size_t
allocated_bytes
double
time_ms
)
;
Packet
(
uint8_t
*
packet_memory
size_t
allocated_bytes
size_t
virtual_packet_length_bytes
double
time_ms
)
;
virtual
~
Packet
(
)
;
bool
ExtractRedHeaders
(
std
:
:
list
<
RTPHeader
*
>
*
headers
)
const
;
static
void
DeleteRedHeaders
(
std
:
:
list
<
RTPHeader
*
>
*
headers
)
;
const
uint8_t
*
payload
(
)
const
{
return
payload_
;
}
size_t
packet_length_bytes
(
)
const
{
return
packet_length_bytes_
;
}
size_t
payload_length_bytes
(
)
const
{
return
payload_length_bytes_
;
}
size_t
virtual_packet_length_bytes
(
)
const
{
return
virtual_packet_length_bytes_
;
}
size_t
virtual_payload_length_bytes
(
)
const
{
return
virtual_payload_length_bytes_
;
}
const
RTPHeader
&
header
(
)
const
{
return
header_
;
}
double
time_ms
(
)
const
{
return
time_ms_
;
}
bool
valid_header
(
)
const
{
return
valid_header_
;
}
private
:
bool
ParseHeader
(
const
webrtc
:
:
RtpUtility
:
:
RtpHeaderParser
&
parser
const
RtpHeaderExtensionMap
*
extension_map
)
;
void
CopyToHeader
(
RTPHeader
*
destination
)
const
;
RTPHeader
header_
;
const
std
:
:
unique_ptr
<
uint8_t
[
]
>
payload_memory_
;
const
uint8_t
*
payload_
=
nullptr
;
const
size_t
packet_length_bytes_
=
0
;
size_t
payload_length_bytes_
=
0
;
const
size_t
virtual_packet_length_bytes_
;
size_t
virtual_payload_length_bytes_
=
0
;
const
double
time_ms_
;
const
bool
valid_header_
;
RTC_DISALLOW_COPY_AND_ASSIGN
(
Packet
)
;
}
;
}
}
#
endif
