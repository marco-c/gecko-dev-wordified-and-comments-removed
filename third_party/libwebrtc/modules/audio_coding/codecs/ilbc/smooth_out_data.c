#
include
"
modules
/
audio_coding
/
codecs
/
ilbc
/
smooth_out_data
.
h
"
#
include
"
modules
/
audio_coding
/
codecs
/
ilbc
/
constants
.
h
"
#
include
"
modules
/
audio_coding
/
codecs
/
ilbc
/
defines
.
h
"
#
include
"
rtc_base
/
sanitizer
.
h
"
static
inline
int32_t
RTC_NO_SANITIZE
(
"
signed
-
integer
-
overflow
"
)
OverflowingAdd_S32_S32_To_S32
(
int32_t
a
int32_t
b
)
{
return
a
+
b
;
}
int32_t
WebRtcIlbcfix_Smooth_odata
(
int16_t
*
odata
int16_t
*
psseq
int16_t
*
surround
int16_t
C
)
{
int
i
;
int16_t
err
;
int32_t
errs
;
for
(
i
=
0
;
i
<
80
;
i
+
+
)
{
odata
[
i
]
=
(
int16_t
)
(
(
C
*
surround
[
i
]
+
1024
)
>
>
11
)
;
}
errs
=
0
;
for
(
i
=
0
;
i
<
80
;
i
+
+
)
{
err
=
(
psseq
[
i
]
-
odata
[
i
]
)
>
>
3
;
errs
=
OverflowingAdd_S32_S32_To_S32
(
errs
err
*
err
)
;
}
return
errs
;
}
