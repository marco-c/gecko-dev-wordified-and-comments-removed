#
include
"
modules
/
video_coding
/
rtp_generic_ref_finder
.
h
"
#
include
<
utility
>
#
include
"
rtc_base
/
logging
.
h
"
namespace
webrtc
{
RtpFrameReferenceFinder
:
:
ReturnVector
RtpGenericFrameRefFinder
:
:
ManageFrame
(
std
:
:
unique_ptr
<
RtpFrameObject
>
frame
const
RTPVideoHeader
:
:
GenericDescriptorInfo
&
descriptor
)
{
frame
-
>
SetId
(
descriptor
.
frame_id
)
;
frame
-
>
SetSpatialIndex
(
descriptor
.
spatial_index
)
;
RtpFrameReferenceFinder
:
:
ReturnVector
res
;
if
(
EncodedFrame
:
:
kMaxFrameReferences
<
descriptor
.
dependencies
.
size
(
)
)
{
RTC_LOG
(
LS_WARNING
)
<
<
"
Too
many
dependencies
in
generic
descriptor
.
"
;
return
res
;
}
frame
-
>
num_references
=
descriptor
.
dependencies
.
size
(
)
;
for
(
size_t
i
=
0
;
i
<
descriptor
.
dependencies
.
size
(
)
;
+
+
i
)
{
frame
-
>
references
[
i
]
=
descriptor
.
dependencies
[
i
]
;
}
res
.
push_back
(
std
:
:
move
(
frame
)
)
;
return
res
;
}
}
