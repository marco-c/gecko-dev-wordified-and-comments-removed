#
include
<
errno
.
h
>
#
include
<
fcntl
.
h
>
#
include
<
poll
.
h
>
#
include
<
stdio
.
h
>
#
include
<
string
.
h
>
#
include
<
sys
/
ioctl
.
h
>
#
include
<
sys
/
mman
.
h
>
#
include
<
sys
/
select
.
h
>
#
include
<
time
.
h
>
#
include
<
unistd
.
h
>
#
if
defined
(
__NetBSD__
)
|
|
defined
(
__OpenBSD__
)
#
include
<
sys
/
videoio
.
h
>
#
elif
defined
(
__sun
)
#
include
<
sys
/
videodev2
.
h
>
#
else
#
include
<
linux
/
videodev2
.
h
>
#
endif
#
include
<
new
>
#
include
<
string
>
#
include
"
api
/
scoped_refptr
.
h
"
#
include
"
media
/
base
/
video_common
.
h
"
#
include
"
modules
/
video_capture
/
linux
/
video_capture_v4l2
.
h
"
#
include
"
modules
/
video_capture
/
video_capture
.
h
"
#
include
"
rtc_base
/
logging
.
h
"
#
include
"
rtc_base
/
ref_counted_object
.
h
"
namespace
webrtc
{
namespace
videocapturemodule
{
rtc
:
:
scoped_refptr
<
VideoCaptureModule
>
VideoCaptureImpl
:
:
Create
(
const
char
*
deviceUniqueId
)
{
auto
implementation
=
rtc
:
:
make_ref_counted
<
VideoCaptureModuleV4L2
>
(
)
;
if
(
implementation
-
>
Init
(
deviceUniqueId
)
!
=
0
)
return
nullptr
;
return
implementation
;
}
}
}
