#
ifndef
MODULES_DESKTOP_CAPTURE_WIN_WINDOW_CAPTURER_WIN_GDI_H_
#
define
MODULES_DESKTOP_CAPTURE_WIN_WINDOW_CAPTURER_WIN_GDI_H_
#
include
<
map
>
#
include
<
memory
>
#
include
<
vector
>
#
include
"
modules
/
desktop_capture
/
desktop_capture_options
.
h
"
#
include
"
modules
/
desktop_capture
/
desktop_capturer
.
h
"
#
include
"
modules
/
desktop_capture
/
desktop_geometry
.
h
"
#
include
"
modules
/
desktop_capture
/
win
/
window_capture_utils
.
h
"
#
include
"
modules
/
desktop_capture
/
window_finder_win
.
h
"
namespace
webrtc
{
class
WindowCapturerWinGdi
:
public
DesktopCapturer
{
public
:
explicit
WindowCapturerWinGdi
(
bool
enumerate_current_process_windows
)
;
WindowCapturerWinGdi
(
const
WindowCapturerWinGdi
&
)
=
delete
;
WindowCapturerWinGdi
&
operator
=
(
const
WindowCapturerWinGdi
&
)
=
delete
;
~
WindowCapturerWinGdi
(
)
override
;
static
std
:
:
unique_ptr
<
DesktopCapturer
>
CreateRawWindowCapturer
(
const
DesktopCaptureOptions
&
options
)
;
void
Start
(
Callback
*
callback
)
override
;
void
CaptureFrame
(
)
override
;
bool
GetSourceList
(
SourceList
*
sources
)
override
;
bool
SelectSource
(
SourceId
id
)
override
;
bool
FocusOnSelectedSource
(
)
override
;
bool
IsOccluded
(
const
DesktopVector
&
pos
)
override
;
private
:
struct
CaptureResults
{
Result
result
;
std
:
:
unique_ptr
<
DesktopFrame
>
frame
;
}
;
CaptureResults
CaptureFrame
(
bool
capture_owned_windows
)
;
Callback
*
callback_
=
nullptr
;
HWND
window_
=
nullptr
;
DesktopSize
previous_size_
;
WindowCaptureHelperWin
window_capture_helper_
;
bool
enumerate_current_process_windows_
;
std
:
:
map
<
HWND
DesktopSize
>
window_size_map_
;
WindowFinderWin
window_finder_
;
std
:
:
vector
<
HWND
>
owned_windows_
;
std
:
:
unique_ptr
<
WindowCapturerWinGdi
>
owned_window_capturer_
;
}
;
}
#
endif
