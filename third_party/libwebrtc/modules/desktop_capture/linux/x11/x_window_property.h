#
ifndef
MODULES_DESKTOP_CAPTURE_LINUX_X11_X_WINDOW_PROPERTY_H_
#
define
MODULES_DESKTOP_CAPTURE_LINUX_X11_X_WINDOW_PROPERTY_H_
#
include
<
X11
/
X
.
h
>
#
include
<
X11
/
Xlib
.
h
>
#
include
<
cstddef
>
namespace
webrtc
{
class
XWindowPropertyBase
{
public
:
XWindowPropertyBase
(
Display
*
display
Window
window
Atom
property
int
expected_size
)
;
virtual
~
XWindowPropertyBase
(
)
;
XWindowPropertyBase
(
const
XWindowPropertyBase
&
)
=
delete
;
XWindowPropertyBase
&
operator
=
(
const
XWindowPropertyBase
&
)
=
delete
;
bool
is_valid
(
)
const
{
return
is_valid_
;
}
size_t
size
(
)
const
{
return
size_
;
}
protected
:
unsigned
char
*
data_
=
nullptr
;
private
:
bool
is_valid_
=
false
;
unsigned
long
size_
=
0
;
}
;
template
<
class
PropertyType
>
class
XWindowProperty
:
public
XWindowPropertyBase
{
public
:
XWindowProperty
(
Display
*
display
const
Window
window
const
Atom
property
)
:
XWindowPropertyBase
(
display
window
property
sizeof
(
PropertyType
)
)
{
}
~
XWindowProperty
(
)
override
=
default
;
XWindowProperty
(
const
XWindowProperty
&
)
=
delete
;
XWindowProperty
&
operator
=
(
const
XWindowProperty
&
)
=
delete
;
const
PropertyType
*
data
(
)
const
{
return
reinterpret_cast
<
PropertyType
*
>
(
data_
)
;
}
PropertyType
*
data
(
)
{
return
reinterpret_cast
<
PropertyType
*
>
(
data_
)
;
}
}
;
}
#
endif
