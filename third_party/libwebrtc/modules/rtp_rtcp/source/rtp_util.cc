#
include
"
modules
/
rtp_rtcp
/
source
/
rtp_util
.
h
"
#
include
<
cstddef
>
#
include
<
cstdint
>
#
include
"
api
/
array_view
.
h
"
namespace
webrtc
{
namespace
{
constexpr
uint8_t
kRtpVersion
=
2
;
constexpr
size_t
kMinRtpPacketLen
=
12
;
constexpr
size_t
kMinRtcpPacketLen
=
4
;
bool
HasCorrectRtpVersion
(
rtc
:
:
ArrayView
<
const
uint8_t
>
packet
)
{
return
packet
[
0
]
>
>
6
=
=
kRtpVersion
;
}
bool
PayloadTypeIsReservedForRtcp
(
uint8_t
payload_type
)
{
return
64
<
=
payload_type
&
&
payload_type
<
96
;
}
}
bool
IsRtpPacket
(
rtc
:
:
ArrayView
<
const
uint8_t
>
packet
)
{
return
packet
.
size
(
)
>
=
kMinRtpPacketLen
&
&
HasCorrectRtpVersion
(
packet
)
&
&
!
PayloadTypeIsReservedForRtcp
(
packet
[
1
]
&
0x7F
)
;
}
bool
IsRtcpPacket
(
rtc
:
:
ArrayView
<
const
uint8_t
>
packet
)
{
return
packet
.
size
(
)
>
=
kMinRtcpPacketLen
&
&
HasCorrectRtpVersion
(
packet
)
&
&
PayloadTypeIsReservedForRtcp
(
packet
[
1
]
&
0x7F
)
;
}
}
