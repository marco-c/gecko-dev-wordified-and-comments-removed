#
include
"
modules
/
audio_processing
/
aec3
/
clockdrift_detector
.
h
"
#
include
"
test
/
gtest
.
h
"
namespace
webrtc
{
TEST
(
ClockdriftDetector
ClockdriftDetector
)
{
ClockdriftDetector
c
;
EXPECT_TRUE
(
c
.
ClockdriftLevel
(
)
=
=
ClockdriftDetector
:
:
Level
:
:
kNone
)
;
for
(
int
i
=
0
;
i
<
100
;
i
+
+
)
c
.
Update
(
1000
)
;
EXPECT_TRUE
(
c
.
ClockdriftLevel
(
)
=
=
ClockdriftDetector
:
:
Level
:
:
kNone
)
;
for
(
int
i
=
0
;
i
<
100
;
i
+
+
)
c
.
Update
(
1001
)
;
EXPECT_TRUE
(
c
.
ClockdriftLevel
(
)
=
=
ClockdriftDetector
:
:
Level
:
:
kNone
)
;
for
(
int
i
=
0
;
i
<
100
;
i
+
+
)
c
.
Update
(
1002
)
;
EXPECT_TRUE
(
c
.
ClockdriftLevel
(
)
=
=
ClockdriftDetector
:
:
Level
:
:
kProbable
)
;
for
(
int
i
=
0
;
i
<
100
;
i
+
+
)
c
.
Update
(
1003
)
;
EXPECT_TRUE
(
c
.
ClockdriftLevel
(
)
=
=
ClockdriftDetector
:
:
Level
:
:
kVerified
)
;
for
(
int
i
=
0
;
i
<
10000
;
i
+
+
)
c
.
Update
(
1003
)
;
EXPECT_TRUE
(
c
.
ClockdriftLevel
(
)
=
=
ClockdriftDetector
:
:
Level
:
:
kNone
)
;
for
(
int
i
=
0
;
i
<
100
;
i
+
+
)
c
.
Update
(
1001
)
;
for
(
int
i
=
0
;
i
<
100
;
i
+
+
)
c
.
Update
(
999
)
;
EXPECT_TRUE
(
c
.
ClockdriftLevel
(
)
=
=
ClockdriftDetector
:
:
Level
:
:
kProbable
)
;
for
(
int
i
=
0
;
i
<
100
;
i
+
+
)
c
.
Update
(
1000
)
;
for
(
int
i
=
0
;
i
<
100
;
i
+
+
)
c
.
Update
(
998
)
;
EXPECT_TRUE
(
c
.
ClockdriftLevel
(
)
=
=
ClockdriftDetector
:
:
Level
:
:
kVerified
)
;
}
}
