#
include
"
modules
/
audio_processing
/
agc2
/
vad_with_level
.
h
"
#
include
"
rtc_base
/
gunit
.
h
"
namespace
webrtc
{
namespace
test
{
TEST
(
AutomaticGainController2VadWithLevelEstimator
PeakLevelGreaterThanRmsLevel
)
{
constexpr
size_t
kSampleRateHz
=
8000
;
std
:
:
array
<
float
kSampleRateHz
/
100
>
frame
;
frame
.
fill
(
1000
.
f
)
;
frame
[
10
]
=
2000
.
f
;
float
*
const
channel0
=
frame
.
data
(
)
;
AudioFrameView
<
float
>
frame_view
(
&
channel0
1
frame
.
size
(
)
)
;
VadWithLevel
vad_with_level
;
auto
levels_and_vad_prob
=
vad_with_level
.
AnalyzeFrame
(
frame_view
)
;
EXPECT_LT
(
levels_and_vad_prob
.
speech_rms_dbfs
levels_and_vad_prob
.
speech_peak_dbfs
)
;
}
}
}
