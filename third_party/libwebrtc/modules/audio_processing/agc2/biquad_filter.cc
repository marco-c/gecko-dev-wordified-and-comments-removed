#
include
"
modules
/
audio_processing
/
agc2
/
biquad_filter
.
h
"
#
include
"
rtc_base
/
arraysize
.
h
"
namespace
webrtc
{
BiQuadFilter
:
:
BiQuadFilter
(
const
Config
&
config
)
:
config_
(
config
)
state_
(
{
}
)
{
}
BiQuadFilter
:
:
~
BiQuadFilter
(
)
=
default
;
void
BiQuadFilter
:
:
SetConfig
(
const
Config
&
config
)
{
config_
=
config
;
state_
=
{
}
;
}
void
BiQuadFilter
:
:
Reset
(
)
{
state_
=
{
}
;
}
void
BiQuadFilter
:
:
Process
(
rtc
:
:
ArrayView
<
const
float
>
x
rtc
:
:
ArrayView
<
float
>
y
)
{
RTC_DCHECK_EQ
(
x
.
size
(
)
y
.
size
(
)
)
;
for
(
size_t
k
=
0
;
k
<
x
.
size
(
)
;
+
+
k
)
{
const
float
tmp
=
x
[
k
]
;
y
[
k
]
=
config_
.
b
[
0
]
*
tmp
+
config_
.
b
[
1
]
*
state_
.
b
[
0
]
+
config_
.
b
[
2
]
*
state_
.
b
[
1
]
-
config_
.
a
[
0
]
*
state_
.
a
[
0
]
-
config_
.
a
[
1
]
*
state_
.
a
[
1
]
;
state_
.
b
[
1
]
=
state_
.
b
[
0
]
;
state_
.
b
[
0
]
=
tmp
;
state_
.
a
[
1
]
=
state_
.
a
[
0
]
;
state_
.
a
[
0
]
=
y
[
k
]
;
}
}
}
