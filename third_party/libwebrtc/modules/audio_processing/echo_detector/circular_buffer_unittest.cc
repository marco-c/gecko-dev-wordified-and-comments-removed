#
include
"
modules
/
audio_processing
/
echo_detector
/
circular_buffer
.
h
"
#
include
"
test
/
gtest
.
h
"
namespace
webrtc
{
TEST
(
CircularBufferTests
LessThanMaxTest
)
{
CircularBuffer
test_buffer
(
3
)
;
test_buffer
.
Push
(
1
.
f
)
;
test_buffer
.
Push
(
2
.
f
)
;
EXPECT_EQ
(
1
.
f
test_buffer
.
Pop
(
)
)
;
EXPECT_EQ
(
2
.
f
test_buffer
.
Pop
(
)
)
;
}
TEST
(
CircularBufferTests
FillTest
)
{
CircularBuffer
test_buffer
(
3
)
;
test_buffer
.
Push
(
1
.
f
)
;
test_buffer
.
Push
(
2
.
f
)
;
test_buffer
.
Push
(
3
.
f
)
;
EXPECT_EQ
(
1
.
f
test_buffer
.
Pop
(
)
)
;
EXPECT_EQ
(
2
.
f
test_buffer
.
Pop
(
)
)
;
EXPECT_EQ
(
3
.
f
test_buffer
.
Pop
(
)
)
;
}
TEST
(
CircularBufferTests
OverflowTest
)
{
CircularBuffer
test_buffer
(
3
)
;
test_buffer
.
Push
(
1
.
f
)
;
test_buffer
.
Push
(
2
.
f
)
;
test_buffer
.
Push
(
3
.
f
)
;
test_buffer
.
Push
(
4
.
f
)
;
EXPECT_EQ
(
2
.
f
test_buffer
.
Pop
(
)
)
;
EXPECT_EQ
(
3
.
f
test_buffer
.
Pop
(
)
)
;
EXPECT_EQ
(
4
.
f
test_buffer
.
Pop
(
)
)
;
}
TEST
(
CircularBufferTests
ReadFromEmpty
)
{
CircularBuffer
test_buffer
(
3
)
;
EXPECT_EQ
(
absl
:
:
nullopt
test_buffer
.
Pop
(
)
)
;
}
}
