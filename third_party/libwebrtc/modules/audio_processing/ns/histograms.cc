#
include
"
modules
/
audio_processing
/
ns
/
histograms
.
h
"
#
include
"
modules
/
audio_processing
/
ns
/
ns_common
.
h
"
#
include
"
modules
/
audio_processing
/
ns
/
signal_model
.
h
"
namespace
webrtc
{
Histograms
:
:
Histograms
(
)
{
Clear
(
)
;
}
void
Histograms
:
:
Clear
(
)
{
lrt_
.
fill
(
0
)
;
spectral_flatness_
.
fill
(
0
)
;
spectral_diff_
.
fill
(
0
)
;
}
void
Histograms
:
:
Update
(
const
SignalModel
&
features_
)
{
constexpr
float
kOneByBinSizeLrt
=
1
.
f
/
kBinSizeLrt
;
if
(
features_
.
lrt
<
kHistogramSize
*
kBinSizeLrt
&
&
features_
.
lrt
>
=
0
.
f
)
{
+
+
lrt_
[
kOneByBinSizeLrt
*
features_
.
lrt
]
;
}
constexpr
float
kOneByBinSizeSpecFlat
=
1
.
f
/
kBinSizeSpecFlat
;
if
(
features_
.
spectral_flatness
<
kHistogramSize
*
kBinSizeSpecFlat
&
&
features_
.
spectral_flatness
>
=
0
.
f
)
{
+
+
spectral_flatness_
[
features_
.
spectral_flatness
*
kOneByBinSizeSpecFlat
]
;
}
constexpr
float
kOneByBinSizeSpecDiff
=
1
.
f
/
kBinSizeSpecDiff
;
if
(
features_
.
spectral_diff
<
kHistogramSize
*
kBinSizeSpecDiff
&
&
features_
.
spectral_diff
>
=
0
.
f
)
{
+
+
spectral_diff_
[
features_
.
spectral_diff
*
kOneByBinSizeSpecDiff
]
;
}
}
}
