#
ifndef
_WIN32
#
error
You
should
only
be
including
windows
/
port
.
cc
in
a
windows
environment
!
#
endif
#
include
<
config
.
h
>
#
include
<
string
.
h
>
#
include
<
assert
.
h
>
#
include
<
stdarg
.
h
>
#
include
<
windows
.
h
>
#
include
"
port
.
h
"
#
if
!
defined
(
__MINGW32__
)
&
&
!
defined
(
__MINGW64__
)
int
safe_vsnprintf
(
char
*
str
size_t
size
const
char
*
format
va_list
ap
)
{
if
(
size
=
=
0
)
return
-
1
;
str
[
size
-
1
]
=
'
\
0
'
;
return
_vsnprintf
(
str
size
-
1
format
ap
)
;
}
#
if
!
(
defined
(
_MSC_VER
)
&
&
_MSC_VER
>
=
1900
)
int
snprintf
(
char
*
str
size_t
size
const
char
*
format
.
.
.
)
{
int
r
;
va_list
ap
;
va_start
(
ap
format
)
;
r
=
vsnprintf
(
str
size
format
ap
)
;
va_end
(
ap
)
;
return
r
;
}
#
endif
#
endif
