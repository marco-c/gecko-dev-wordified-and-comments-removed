#
include
"
media
/
base
/
codec_list
.
h
"
#
include
"
api
/
video_codecs
/
sdp_video_format
.
h
"
#
include
"
test
/
gtest
.
h
"
namespace
cricket
{
namespace
{
TEST
(
CodecList
StoreAndRecall
)
{
CodecList
empty_list
(
std
:
:
vector
<
Codec
>
{
}
)
;
EXPECT_TRUE
(
empty_list
.
empty
(
)
)
;
EXPECT_TRUE
(
empty_list
.
codecs
(
)
.
empty
(
)
)
;
Codec
video_codec
=
CreateVideoCodec
(
{
webrtc
:
:
SdpVideoFormat
{
"
VP8
"
}
}
)
;
CodecList
one_codec
{
{
video_codec
}
}
;
EXPECT_EQ
(
one_codec
.
size
(
)
1U
)
;
EXPECT_EQ
(
one_codec
.
codecs
(
)
[
0
]
video_codec
)
;
}
#
if
GTEST_HAS_DEATH_TEST
&
&
!
defined
(
WEBRTC_ANDROID
)
TEST
(
CodecList
CrashOnIllegalConstructorArguments
)
{
std
:
:
vector
<
Codec
>
apt_without_number
{
CreateVideoCodec
(
{
webrtc
:
:
SdpVideoFormat
{
"
rtx
"
webrtc
:
:
CodecParameterMap
{
{
"
apt
"
"
not
-
a
-
number
"
}
}
}
}
)
}
;
#
if
RTC_DCHECK_IS_ON
EXPECT_DEATH
(
CodecList
bad
(
apt_without_number
)
"
FromString
"
)
;
#
else
CodecList
bad
{
apt_without_number
}
;
EXPECT_EQ
(
bad
.
size
(
)
1U
)
;
#
endif
}
#
endif
}
}
