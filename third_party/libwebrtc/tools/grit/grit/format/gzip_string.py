"
"
"
Provides
gzip
utilities
for
strings
.
"
"
"
from
__future__
import
print_function
import
gzip
import
io
import
subprocess
def
GzipStringRsyncable
(
data
)
:
  
gzip_proc
=
subprocess
.
Popen
(
[
'
gzip
'
'
-
-
stdout
'
'
-
-
rsyncable
'
                                
'
-
-
best
'
'
-
-
no
-
name
'
]
                               
stdin
=
subprocess
.
PIPE
                               
stdout
=
subprocess
.
PIPE
                               
stderr
=
subprocess
.
PIPE
)
  
data
stderr
=
gzip_proc
.
communicate
(
data
)
  
if
gzip_proc
.
returncode
!
=
0
:
    
raise
subprocess
.
CalledProcessError
(
gzip_proc
.
returncode
'
gzip
'
                                        
stderr
)
  
return
data
def
GzipString
(
data
)
:
  
gzip_output
=
io
.
BytesIO
(
)
  
with
gzip
.
GzipFile
(
mode
=
'
wb
'
compresslevel
=
9
fileobj
=
gzip_output
                     
mtime
=
0
)
as
gzip_file
:
    
gzip_file
.
write
(
data
)
  
data
=
gzip_output
.
getvalue
(
)
  
gzip_output
.
close
(
)
  
return
data
