#
include
"
modules
/
audio_processing
/
echo_detector
/
mean_variance_estimator
.
h
"
#
include
<
math
.
h
>
#
include
"
rtc_base
/
checks
.
h
"
namespace
webrtc
{
namespace
{
constexpr
float
kAlpha
=
0
.
001f
;
}
void
MeanVarianceEstimator
:
:
Update
(
float
value
)
{
mean_
=
(
1
.
f
-
kAlpha
)
*
mean_
+
kAlpha
*
value
;
variance_
=
(
1
.
f
-
kAlpha
)
*
variance_
+
kAlpha
*
(
value
-
mean_
)
*
(
value
-
mean_
)
;
RTC_DCHECK
(
std
:
:
isfinite
(
mean_
)
)
;
RTC_DCHECK
(
std
:
:
isfinite
(
variance_
)
)
;
}
float
MeanVarianceEstimator
:
:
std_deviation
(
)
const
{
RTC_DCHECK_GE
(
variance_
0
.
f
)
;
return
sqrtf
(
variance_
)
;
}
float
MeanVarianceEstimator
:
:
mean
(
)
const
{
return
mean_
;
}
void
MeanVarianceEstimator
:
:
Clear
(
)
{
mean_
=
0
.
f
;
variance_
=
0
.
f
;
}
}
