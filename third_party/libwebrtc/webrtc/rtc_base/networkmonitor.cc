#
include
"
rtc_base
/
networkmonitor
.
h
"
#
include
"
rtc_base
/
checks
.
h
"
namespace
{
const
uint32_t
UPDATE_NETWORKS_MESSAGE
=
1
;
rtc
:
:
NetworkMonitorFactory
*
network_monitor_factory
=
nullptr
;
}
namespace
rtc
{
NetworkMonitorInterface
:
:
NetworkMonitorInterface
(
)
{
}
NetworkMonitorInterface
:
:
~
NetworkMonitorInterface
(
)
{
}
NetworkMonitorBase
:
:
NetworkMonitorBase
(
)
:
worker_thread_
(
Thread
:
:
Current
(
)
)
{
}
NetworkMonitorBase
:
:
~
NetworkMonitorBase
(
)
{
}
void
NetworkMonitorBase
:
:
OnNetworksChanged
(
)
{
RTC_LOG
(
LS_VERBOSE
)
<
<
"
Network
change
is
received
at
the
network
monitor
"
;
worker_thread_
-
>
Post
(
RTC_FROM_HERE
this
UPDATE_NETWORKS_MESSAGE
)
;
}
void
NetworkMonitorBase
:
:
OnMessage
(
Message
*
msg
)
{
RTC_DCHECK
(
msg
-
>
message_id
=
=
UPDATE_NETWORKS_MESSAGE
)
;
SignalNetworksChanged
(
)
;
}
NetworkMonitorFactory
:
:
NetworkMonitorFactory
(
)
{
}
NetworkMonitorFactory
:
:
~
NetworkMonitorFactory
(
)
{
}
void
NetworkMonitorFactory
:
:
SetFactory
(
NetworkMonitorFactory
*
factory
)
{
if
(
network_monitor_factory
!
=
nullptr
)
{
delete
network_monitor_factory
;
}
network_monitor_factory
=
factory
;
}
void
NetworkMonitorFactory
:
:
ReleaseFactory
(
NetworkMonitorFactory
*
factory
)
{
if
(
factory
=
=
network_monitor_factory
)
{
SetFactory
(
nullptr
)
;
}
}
NetworkMonitorFactory
*
NetworkMonitorFactory
:
:
GetFactory
(
)
{
return
network_monitor_factory
;
}
}
