#
include
<
sstream
>
#
include
<
string
>
#
include
<
vector
>
#
include
"
rtc_base
/
gunit
.
h
"
#
include
"
rtc_base
/
openssladapter
.
h
"
namespace
rtc
{
TEST
(
OpenSSLAdapterTest
TestTransformAlpnProtocols
)
{
EXPECT_EQ
(
"
"
TransformAlpnProtocols
(
std
:
:
vector
<
std
:
:
string
>
(
)
)
)
;
std
:
:
string
large_protocol
(
256
'
a
'
)
;
EXPECT_EQ
(
"
"
TransformAlpnProtocols
(
std
:
:
vector
<
std
:
:
string
>
{
large_protocol
}
)
)
;
std
:
:
vector
<
std
:
:
string
>
alpn_protos
{
"
h2
"
}
;
std
:
:
stringstream
expected_response
;
expected_response
<
<
static_cast
<
char
>
(
2
)
<
<
"
h2
"
;
EXPECT_EQ
(
expected_response
.
str
(
)
TransformAlpnProtocols
(
alpn_protos
)
)
;
alpn_protos
.
push_back
(
"
http
/
1
.
1
"
)
;
expected_response
<
<
static_cast
<
char
>
(
8
)
<
<
"
http
/
1
.
1
"
;
EXPECT_EQ
(
expected_response
.
str
(
)
TransformAlpnProtocols
(
alpn_protos
)
)
;
}
}
