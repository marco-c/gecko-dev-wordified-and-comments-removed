#
include
<
stddef
.
h
>
#
include
<
stdint
.
h
>
#
include
"
p2p
/
base
/
pseudo_tcp
.
h
"
#
include
"
rtc_base
/
thread
.
h
"
namespace
webrtc
{
class
FakeIPseudoTcpNotify
:
public
webrtc
:
:
IPseudoTcpNotify
{
public
:
void
OnTcpOpen
(
webrtc
:
:
PseudoTcp
*
tcp
)
{
}
void
OnTcpReadable
(
webrtc
:
:
PseudoTcp
*
tcp
)
{
}
void
OnTcpWriteable
(
webrtc
:
:
PseudoTcp
*
tcp
)
{
}
void
OnTcpClosed
(
webrtc
:
:
PseudoTcp
*
tcp
uint32_t
error
)
{
}
webrtc
:
:
IPseudoTcpNotify
:
:
WriteResult
TcpWritePacket
(
webrtc
:
:
PseudoTcp
*
tcp
const
char
*
buffer
size_t
len
)
{
return
webrtc
:
:
IPseudoTcpNotify
:
:
WriteResult
:
:
WR_SUCCESS
;
}
}
;
struct
Environment
{
explicit
Environment
(
webrtc
:
:
IPseudoTcpNotify
*
notifier
)
:
ptcp
(
notifier
0
)
{
}
webrtc
:
:
AutoThread
thread
;
webrtc
:
:
PseudoTcp
ptcp
;
}
;
Environment
*
env
=
new
Environment
(
new
FakeIPseudoTcpNotify
(
)
)
;
void
FuzzOneInput
(
const
uint8_t
*
data
size_t
size
)
{
env
-
>
ptcp
.
NotifyPacket
(
reinterpret_cast
<
const
char
*
>
(
data
)
size
)
;
}
}
