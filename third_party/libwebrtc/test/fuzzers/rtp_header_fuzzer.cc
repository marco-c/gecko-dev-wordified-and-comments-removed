#
include
<
bitset
>
#
include
"
modules
/
rtp_rtcp
/
include
/
rtp_rtcp_defines
.
h
"
#
include
"
modules
/
rtp_rtcp
/
source
/
rtp_packet_received
.
h
"
#
include
"
modules
/
rtp_rtcp
/
source
/
rtp_utility
.
h
"
namespace
webrtc
{
static_assert
(
kRtpExtensionNumberOfExtensions
<
=
32
"
Insufficient
bits
read
to
configure
all
header
extensions
.
Add
"
"
an
extra
byte
and
update
the
switches
.
"
)
;
void
FuzzOneInput
(
const
uint8_t
*
data
size_t
size
)
{
if
(
size
<
=
4
)
return
;
std
:
:
bitset
<
32
>
extensionMask
(
*
reinterpret_cast
<
const
uint32_t
*
>
(
data
)
)
;
data
+
=
4
;
size
-
=
4
;
RtpPacketReceived
:
:
ExtensionManager
extensions
(
true
)
;
int
local_id
=
1
;
for
(
int
i
=
1
;
i
<
kRtpExtensionNumberOfExtensions
;
i
+
+
)
{
RTPExtensionType
extension_type
=
static_cast
<
RTPExtensionType
>
(
i
)
;
if
(
extensionMask
[
i
]
)
{
extensions
.
RegisterByType
(
local_id
+
+
extension_type
)
;
}
}
RTPHeader
rtp_header
;
RtpUtility
:
:
RtpHeaderParser
rtp_parser
(
data
size
)
;
rtp_parser
.
Parse
(
&
rtp_header
&
extensions
)
;
}
}
