#
include
<
cstddef
>
#
include
<
cstdint
>
#
include
"
modules
/
audio_coding
/
codecs
/
opus
/
audio_decoder_opus
.
h
"
#
include
"
test
/
explicit_key_value_config
.
h
"
#
include
"
test
/
fuzzers
/
audio_decoder_fuzzer
.
h
"
namespace
webrtc
{
void
FuzzOneInput
(
const
uint8_t
*
data
size_t
size
)
{
const
size_t
channels
=
(
size
%
2
)
+
1
;
const
int
kSampleRateHz
=
48
'
000
;
AudioDecoderOpusImpl
dec
(
test
:
:
ExplicitKeyValueConfig
(
"
"
)
channels
kSampleRateHz
)
;
const
size_t
kAllocatedOuputSizeSamples
=
kSampleRateHz
/
10
;
int16_t
output
[
kAllocatedOuputSizeSamples
]
;
FuzzAudioDecoder
(
DecoderFunctionType
:
:
kRedundantDecode
data
size
&
dec
kSampleRateHz
sizeof
(
output
)
output
)
;
}
}
