#
include
"
modules
/
rtp_rtcp
/
source
/
video_rtp_depacketizer_av1
.
h
"
#
include
<
stddef
.
h
>
#
include
<
stdint
.
h
>
#
include
<
vector
>
#
include
"
api
/
array_view
.
h
"
#
include
"
test
/
fuzzers
/
fuzz_data_helper
.
h
"
namespace
webrtc
{
void
FuzzOneInput
(
const
uint8_t
*
data
size_t
size
)
{
std
:
:
vector
<
rtc
:
:
ArrayView
<
const
uint8_t
>
>
rtp_payloads
;
test
:
:
FuzzDataHelper
fuzz_input
(
rtc
:
:
MakeArrayView
(
data
size
)
)
;
while
(
fuzz_input
.
CanReadBytes
(
sizeof
(
uint16_t
)
)
)
{
uint16_t
next_size
=
fuzz_input
.
Read
<
uint16_t
>
(
)
%
1200
;
if
(
next_size
>
fuzz_input
.
BytesLeft
(
)
)
{
next_size
=
fuzz_input
.
BytesLeft
(
)
;
}
rtp_payloads
.
push_back
(
fuzz_input
.
ReadByteArray
(
next_size
)
)
;
}
VideoRtpDepacketizerAv1
(
)
.
AssembleFrame
(
rtp_payloads
)
;
}
}
