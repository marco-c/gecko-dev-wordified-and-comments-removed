#
import
<
Foundation
/
Foundation
.
h
>
#
ifdef
WEBRTC_IOS_ENABLE_COVERAGE
extern
"
C
"
void
__llvm_profile_set_filename
(
const
char
*
name
)
;
#
endif
namespace
rtc
{
namespace
test
{
void
ConfigureCoverageReportPath
(
)
{
#
ifdef
WEBRTC_IOS_ENABLE_COVERAGE
static
dispatch_once_t
once_token
;
dispatch_once
(
&
once_token
^
{
NSArray
*
paths
=
NSSearchPathForDirectoriesInDomains
(
NSDocumentDirectory
NSUserDomainMask
YES
)
;
NSString
*
documents_directory
=
[
paths
firstObject
]
;
NSString
*
file_name
=
[
documents_directory
stringByAppendingPathComponent
:
"
coverage
.
profraw
"
]
;
__llvm_profile_set_filename
(
[
file_name
cStringUsingEncoding
:
NSUTF8StringEncoding
]
)
;
NSLog
(
"
Coverage
data
at
%
.
"
file_name
)
;
}
)
;
#
endif
}
}
}
