#
import
<
Foundation
/
Foundation
.
h
>
#
include
<
dlfcn
.
h
>
#
include
<
mach
-
o
/
dyld
.
h
>
#
include
<
stdint
.
h
>
#
include
<
stdlib
.
h
>
#
include
"
rtc_base
/
checks
.
h
"
namespace
webrtc
{
namespace
test
{
void
GetNSExecutablePath
(
std
:
:
string
*
path
)
{
RTC_DCHECK
(
path
)
;
uint32_t
executable_length
=
0
;
_NSGetExecutablePath
(
NULL
&
executable_length
)
;
RTC_DCHECK_GT
(
executable_length
1u
)
;
char
executable_path
[
PATH_MAX
+
1
]
;
int
rv
=
_NSGetExecutablePath
(
executable_path
&
executable_length
)
;
RTC_DCHECK_EQ
(
rv
0
)
;
char
full_path
[
PATH_MAX
]
;
if
(
realpath
(
executable_path
full_path
)
=
=
nullptr
)
{
*
path
=
"
"
;
return
;
}
*
path
=
full_path
;
}
}
}
