#
ifndef
TEST_TESTSUPPORT_FRAME_READER_H_
#
define
TEST_TESTSUPPORT_FRAME_READER_H_
#
include
<
stdio
.
h
>
#
include
<
string
>
#
include
"
api
/
scoped_refptr
.
h
"
namespace
webrtc
{
class
I420Buffer
;
namespace
test
{
class
FrameReader
{
public
:
virtual
~
FrameReader
(
)
{
}
virtual
bool
Init
(
)
=
0
;
virtual
rtc
:
:
scoped_refptr
<
I420Buffer
>
ReadFrame
(
)
=
0
;
virtual
void
Close
(
)
=
0
;
virtual
size_t
FrameLength
(
)
=
0
;
virtual
int
NumberOfFrames
(
)
=
0
;
}
;
class
YuvFrameReaderImpl
:
public
FrameReader
{
public
:
YuvFrameReaderImpl
(
std
:
:
string
input_filename
int
width
int
height
)
;
~
YuvFrameReaderImpl
(
)
override
;
bool
Init
(
)
override
;
rtc
:
:
scoped_refptr
<
I420Buffer
>
ReadFrame
(
)
override
;
void
Close
(
)
override
;
size_t
FrameLength
(
)
override
;
int
NumberOfFrames
(
)
override
;
protected
:
const
std
:
:
string
input_filename_
;
size_t
frame_length_in_bytes_
;
const
int
width_
;
const
int
height_
;
int
number_of_frames_
;
FILE
*
input_file_
;
}
;
class
Y4mFrameReaderImpl
:
public
YuvFrameReaderImpl
{
public
:
Y4mFrameReaderImpl
(
std
:
:
string
input_filename
int
width
int
height
)
;
~
Y4mFrameReaderImpl
(
)
override
;
bool
Init
(
)
override
;
rtc
:
:
scoped_refptr
<
I420Buffer
>
ReadFrame
(
)
override
;
private
:
uint8_t
*
buffer_
;
}
;
}
}
#
endif
