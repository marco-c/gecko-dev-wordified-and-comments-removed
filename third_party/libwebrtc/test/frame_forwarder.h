#
ifndef
TEST_FRAME_FORWARDER_H_
#
define
TEST_FRAME_FORWARDER_H_
#
include
"
api
/
video
/
video_frame
.
h
"
#
include
"
api
/
video
/
video_source_interface
.
h
"
#
include
"
rtc_base
/
synchronization
/
mutex
.
h
"
namespace
webrtc
{
namespace
test
{
class
FrameForwarder
:
public
rtc
:
:
VideoSourceInterface
<
VideoFrame
>
{
public
:
FrameForwarder
(
)
;
~
FrameForwarder
(
)
override
;
virtual
void
IncomingCapturedFrame
(
const
VideoFrame
&
video_frame
)
RTC_LOCKS_EXCLUDED
(
mutex_
)
;
rtc
:
:
VideoSinkWants
sink_wants
(
)
const
RTC_LOCKS_EXCLUDED
(
mutex_
)
;
bool
has_sinks
(
)
const
RTC_LOCKS_EXCLUDED
(
mutex_
)
;
protected
:
rtc
:
:
VideoSinkWants
sink_wants_locked
(
)
const
RTC_EXCLUSIVE_LOCKS_REQUIRED
(
mutex_
)
;
void
AddOrUpdateSink
(
rtc
:
:
VideoSinkInterface
<
VideoFrame
>
*
sink
const
rtc
:
:
VideoSinkWants
&
wants
)
RTC_LOCKS_EXCLUDED
(
mutex_
)
override
;
void
AddOrUpdateSinkLocked
(
rtc
:
:
VideoSinkInterface
<
VideoFrame
>
*
sink
const
rtc
:
:
VideoSinkWants
&
wants
)
RTC_EXCLUSIVE_LOCKS_REQUIRED
(
mutex_
)
;
void
RemoveSink
(
rtc
:
:
VideoSinkInterface
<
VideoFrame
>
*
sink
)
RTC_LOCKS_EXCLUDED
(
mutex_
)
override
;
mutable
Mutex
mutex_
;
rtc
:
:
VideoSinkInterface
<
VideoFrame
>
*
sink_
RTC_GUARDED_BY
(
mutex_
)
;
rtc
:
:
VideoSinkWants
sink_wants_
RTC_GUARDED_BY
(
mutex_
)
;
}
;
}
}
#
endif
