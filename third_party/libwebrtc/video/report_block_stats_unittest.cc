#
include
"
video
/
report_block_stats
.
h
"
#
include
<
cstdint
>
#
include
"
test
/
gtest
.
h
"
namespace
webrtc
{
namespace
{
constexpr
uint32_t
kSsrc1
=
123
;
constexpr
uint32_t
kSsrc2
=
234
;
TEST
(
ReportBlockStatsTest
StoreAndGetFractionLost
)
{
ReportBlockStats
stats
;
EXPECT_EQ
(
-
1
stats
.
FractionLostInPercent
(
)
)
;
stats
.
Store
(
kSsrc1
10
24
'
000
)
;
EXPECT_EQ
(
-
1
stats
.
FractionLostInPercent
(
)
)
;
stats
.
Store
(
kSsrc1
15
24
'
100
)
;
EXPECT_EQ
(
5
stats
.
FractionLostInPercent
(
)
)
;
stats
.
Store
(
kSsrc1
50
24
'
200
)
;
EXPECT_EQ
(
20
stats
.
FractionLostInPercent
(
)
)
;
}
TEST
(
ReportBlockStatsTest
StoreAndGetFractionLost_TwoSsrcs
)
{
ReportBlockStats
stats
;
EXPECT_EQ
(
-
1
stats
.
FractionLostInPercent
(
)
)
;
stats
.
Store
(
kSsrc1
10
24
'
000
)
;
EXPECT_EQ
(
-
1
stats
.
FractionLostInPercent
(
)
)
;
stats
.
Store
(
kSsrc1
15
24
'
100
)
;
EXPECT_EQ
(
5
stats
.
FractionLostInPercent
(
)
)
;
stats
.
Store
(
kSsrc2
111
8
'
500
)
;
EXPECT_EQ
(
5
stats
.
FractionLostInPercent
(
)
)
;
stats
.
Store
(
kSsrc2
136
8
'
800
)
;
EXPECT_EQ
(
7
stats
.
FractionLostInPercent
(
)
)
;
}
}
}
