#
include
"
call
/
create_call
.
h
"
#
include
<
memory
>
#
include
<
optional
>
#
include
"
api
/
test
/
simulated_network
.
h
"
#
include
"
api
/
units
/
time_delta
.
h
"
#
include
"
call
/
call
.
h
"
namespace
webrtc
{
std
:
:
unique_ptr
<
Call
>
CreateCall
(
CallConfig
config
)
{
std
:
:
vector
<
DegradedCall
:
:
TimeScopedNetworkConfig
>
send_degradation_configs
=
GetNetworkConfigs
(
config
.
env
.
field_trials
(
)
true
)
;
std
:
:
vector
<
DegradedCall
:
:
TimeScopedNetworkConfig
>
receive_degradation_configs
=
GetNetworkConfigs
(
config
.
env
.
field_trials
(
)
false
)
;
std
:
:
unique_ptr
<
Call
>
call
=
Call
:
:
Create
(
std
:
:
move
(
config
)
)
;
if
(
!
send_degradation_configs
.
empty
(
)
|
|
!
receive_degradation_configs
.
empty
(
)
)
{
return
std
:
:
make_unique
<
DegradedCall
>
(
std
:
:
move
(
call
)
send_degradation_configs
receive_degradation_configs
)
;
}
return
call
;
}
}
