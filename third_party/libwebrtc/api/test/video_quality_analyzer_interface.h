#
ifndef
API_TEST_VIDEO_QUALITY_ANALYZER_INTERFACE_H_
#
define
API_TEST_VIDEO_QUALITY_ANALYZER_INTERFACE_H_
#
include
<
cstdint
>
#
include
<
optional
>
#
include
<
string
>
#
include
"
absl
/
strings
/
string_view
.
h
"
#
include
"
api
/
array_view
.
h
"
#
include
"
api
/
scoped_refptr
.
h
"
#
include
"
api
/
stats
/
rtc_stats_report
.
h
"
#
include
"
api
/
test
/
stats_observer_interface
.
h
"
#
include
"
api
/
video
/
encoded_image
.
h
"
#
include
"
api
/
video
/
video_frame
.
h
"
#
include
"
api
/
video_codecs
/
video_encoder
.
h
"
#
include
"
rtc_base
/
checks
.
h
"
namespace
webrtc
{
class
VideoQualityAnalyzerInterface
:
public
webrtc_pc_e2e
:
:
StatsObserverInterface
{
public
:
struct
EncoderStats
{
std
:
:
string
encoder_name
=
"
unknown
"
;
uint32_t
target_encode_bitrate
=
0
;
int
qp
=
-
1
;
}
;
struct
DecoderStats
{
std
:
:
string
decoder_name
=
"
unknown
"
;
std
:
:
optional
<
int32_t
>
decode_time_ms
=
std
:
:
nullopt
;
std
:
:
optional
<
uint8_t
>
qp
=
std
:
:
nullopt
;
}
;
~
VideoQualityAnalyzerInterface
(
)
override
=
default
;
virtual
void
Start
(
std
:
:
string
ArrayView
<
const
std
:
:
string
>
int
)
{
}
virtual
uint16_t
OnFrameCaptured
(
absl
:
:
string_view
peer_name
const
std
:
:
string
&
stream_label
const
VideoFrame
&
frame
)
=
0
;
virtual
void
OnFramePreEncode
(
absl
:
:
string_view
const
VideoFrame
&
)
{
}
virtual
void
OnFrameEncoded
(
absl
:
:
string_view
uint16_t
const
EncodedImage
&
const
EncoderStats
&
bool
)
{
}
virtual
void
OnFrameDropped
(
absl
:
:
string_view
EncodedImageCallback
:
:
DropReason
)
{
}
virtual
void
OnFramePreDecode
(
absl
:
:
string_view
uint16_t
const
EncodedImage
&
)
{
}
virtual
void
OnFrameDecoded
(
absl
:
:
string_view
const
VideoFrame
&
const
DecoderStats
&
)
{
}
virtual
void
OnFrameRendered
(
absl
:
:
string_view
const
VideoFrame
&
)
{
}
virtual
void
OnEncoderError
(
absl
:
:
string_view
const
VideoFrame
&
int32_t
)
{
}
virtual
void
OnDecoderError
(
absl
:
:
string_view
uint16_t
int32_t
const
DecoderStats
&
)
{
}
void
OnStatsReports
(
absl
:
:
string_view
const
scoped_refptr
<
const
RTCStatsReport
>
&
)
override
{
}
virtual
void
RegisterParticipantInCall
(
absl
:
:
string_view
)
{
}
virtual
void
UnregisterParticipantInCall
(
absl
:
:
string_view
)
{
}
virtual
void
OnPauseAllStreamsFrom
(
absl
:
:
string_view
absl
:
:
string_view
)
{
}
virtual
void
OnResumeAllStreamsFrom
(
absl
:
:
string_view
absl
:
:
string_view
)
{
}
virtual
void
Stop
(
)
{
}
virtual
std
:
:
string
GetStreamLabel
(
uint16_t
frame_id
)
=
0
;
virtual
std
:
:
string
GetSenderPeerName
(
uint16_t
)
const
{
RTC_CHECK
(
false
)
<
<
"
Not
implemented
.
"
;
}
}
;
}
#
endif
