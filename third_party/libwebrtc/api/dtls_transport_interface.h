#
ifndef
API_DTLS_TRANSPORT_INTERFACE_H_
#
define
API_DTLS_TRANSPORT_INTERFACE_H_
#
include
<
memory
>
#
include
<
optional
>
#
include
"
absl
/
base
/
attributes
.
h
"
#
include
"
api
/
ice_transport_interface
.
h
"
#
include
"
api
/
ref_count
.
h
"
#
include
"
api
/
rtc_error
.
h
"
#
include
"
api
/
scoped_refptr
.
h
"
#
include
"
rtc_base
/
ssl_certificate
.
h
"
#
include
"
rtc_base
/
system
/
rtc_export
.
h
"
namespace
webrtc
{
enum
class
DtlsTransportState
{
kNew
kConnecting
kConnected
kClosed
kFailed
kNumValues
}
;
enum
class
DtlsTransportTlsRole
{
kServer
kClient
}
;
class
RTC_EXPORT
DtlsTransportInformation
{
public
:
DtlsTransportInformation
(
)
;
explicit
DtlsTransportInformation
(
DtlsTransportState
state
)
;
DtlsTransportInformation
(
DtlsTransportState
state
std
:
:
optional
<
DtlsTransportTlsRole
>
role
std
:
:
optional
<
int
>
tls_version
std
:
:
optional
<
int
>
ssl_cipher_suite
std
:
:
optional
<
int
>
srtp_cipher_suite
std
:
:
unique_ptr
<
SSLCertChain
>
remote_ssl_certificates
)
;
ABSL_DEPRECATED
(
"
Use
version
with
role
parameter
"
)
DtlsTransportInformation
(
DtlsTransportState
state
std
:
:
optional
<
int
>
tls_version
std
:
:
optional
<
int
>
ssl_cipher_suite
std
:
:
optional
<
int
>
srtp_cipher_suite
std
:
:
unique_ptr
<
SSLCertChain
>
remote_ssl_certificates
)
;
DtlsTransportInformation
(
const
DtlsTransportInformation
&
c
)
;
DtlsTransportInformation
&
operator
=
(
const
DtlsTransportInformation
&
c
)
;
DtlsTransportInformation
(
DtlsTransportInformation
&
&
other
)
=
default
;
DtlsTransportInformation
&
operator
=
(
DtlsTransportInformation
&
&
other
)
=
default
;
DtlsTransportState
state
(
)
const
{
return
state_
;
}
std
:
:
optional
<
DtlsTransportTlsRole
>
role
(
)
const
{
return
role_
;
}
std
:
:
optional
<
int
>
tls_version
(
)
const
{
return
tls_version_
;
}
std
:
:
optional
<
int
>
ssl_cipher_suite
(
)
const
{
return
ssl_cipher_suite_
;
}
std
:
:
optional
<
int
>
srtp_cipher_suite
(
)
const
{
return
srtp_cipher_suite_
;
}
const
SSLCertChain
*
remote_ssl_certificates
(
)
const
{
return
remote_ssl_certificates_
.
get
(
)
;
}
private
:
DtlsTransportState
state_
;
std
:
:
optional
<
DtlsTransportTlsRole
>
role_
;
std
:
:
optional
<
int
>
tls_version_
;
std
:
:
optional
<
int
>
ssl_cipher_suite_
;
std
:
:
optional
<
int
>
srtp_cipher_suite_
;
std
:
:
unique_ptr
<
SSLCertChain
>
remote_ssl_certificates_
;
}
;
class
DtlsTransportObserverInterface
{
public
:
virtual
void
OnStateChange
(
DtlsTransportInformation
info
)
=
0
;
virtual
void
OnError
(
RTCError
error
)
=
0
;
protected
:
virtual
~
DtlsTransportObserverInterface
(
)
=
default
;
}
;
class
DtlsTransportInterface
:
public
webrtc
:
:
RefCountInterface
{
public
:
virtual
scoped_refptr
<
IceTransportInterface
>
ice_transport
(
)
=
0
;
virtual
DtlsTransportInformation
Information
(
)
=
0
;
virtual
void
RegisterObserver
(
DtlsTransportObserverInterface
*
observer
)
=
0
;
virtual
void
UnregisterObserver
(
)
=
0
;
}
;
}
#
endif
