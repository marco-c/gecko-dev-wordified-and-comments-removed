#
include
"
rtc_base
/
numerics
/
windowed_min_filter
.
h
"
#
include
<
string
>
#
include
"
api
/
units
/
time_delta
.
h
"
#
include
"
test
/
gtest
.
h
"
namespace
webrtc
{
namespace
{
TEST
(
WindowedMinFilterTest
EmptyFilterReturnZero
)
{
WindowedMinFilter
<
TimeDelta
>
filter
(
3
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
TimeDelta
:
:
Zero
(
)
)
;
}
TEST
(
WindowedMinFilterTest
EmptyFilterReturnEmptyString
)
{
WindowedMinFilter
<
std
:
:
string
>
filter
(
3
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
"
"
)
;
}
TEST
(
WindowedMinFilterTest
GetMinReturnsMin
)
{
WindowedMinFilter
<
int
>
filter
(
3
)
;
filter
.
Insert
(
30
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
30
)
;
filter
.
Insert
(
20
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
20
)
;
filter
.
Insert
(
10
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
10
)
;
}
TEST
(
WindowedMinFilterTest
GetMinReturnsMinNotSortedInput
)
{
WindowedMinFilter
<
int
>
filter
(
4
)
;
filter
.
Insert
(
0
)
;
filter
.
Insert
(
30
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
0
)
;
filter
.
Insert
(
10
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
0
)
;
filter
.
Insert
(
40
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
0
)
;
filter
.
Insert
(
40
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
10
)
;
}
TEST
(
WindowedMinFilterTest
GetMinReturnsMinWithStringsNotSorted
)
{
WindowedMinFilter
<
std
:
:
string
>
filter
(
3
)
;
filter
.
Insert
(
"
bbb
"
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
"
bbb
"
)
;
filter
.
Insert
(
"
ccc
"
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
"
bbb
"
)
;
filter
.
Insert
(
"
aaa
"
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
"
aaa
"
)
;
}
TEST
(
WindowedMinFilterTest
GetMinReturnsMinInWindow
)
{
WindowedMinFilter
<
int
>
filter
(
3
)
;
filter
.
Insert
(
10
)
;
filter
.
Insert
(
20
)
;
filter
.
Insert
(
30
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
10
)
;
filter
.
Insert
(
40
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
20
)
;
filter
.
Insert
(
50
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
30
)
;
}
TEST
(
WindowedMinFilterTest
RestartAfterReset
)
{
WindowedMinFilter
<
int
>
filter
(
3
)
;
filter
.
Insert
(
10
)
;
filter
.
Insert
(
20
)
;
ASSERT_EQ
(
filter
.
GetMin
(
)
10
)
;
filter
.
Reset
(
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
0
)
;
filter
.
Insert
(
30
)
;
EXPECT_EQ
(
filter
.
GetMin
(
)
30
)
;
}
}
}
