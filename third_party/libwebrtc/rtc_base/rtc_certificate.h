#
ifndef
RTC_BASE_RTC_CERTIFICATE_H_
#
define
RTC_BASE_RTC_CERTIFICATE_H_
#
include
<
stdint
.
h
>
#
include
<
memory
>
#
include
<
string
>
#
include
"
absl
/
strings
/
string_view
.
h
"
#
include
"
api
/
ref_counted_base
.
h
"
#
include
"
api
/
scoped_refptr
.
h
"
#
include
"
rtc_base
/
ssl_certificate
.
h
"
#
include
"
rtc_base
/
ssl_identity
.
h
"
#
include
"
rtc_base
/
system
/
rtc_export
.
h
"
namespace
webrtc
{
class
RTCCertificatePEM
{
public
:
RTCCertificatePEM
(
absl
:
:
string_view
private_key
absl
:
:
string_view
certificate
)
:
private_key_
(
private_key
)
certificate_
(
certificate
)
{
}
const
std
:
:
string
&
private_key
(
)
const
{
return
private_key_
;
}
const
std
:
:
string
&
certificate
(
)
const
{
return
certificate_
;
}
private
:
std
:
:
string
private_key_
;
std
:
:
string
certificate_
;
}
;
class
RTC_EXPORT
RTCCertificate
final
:
public
rtc
:
:
RefCountedNonVirtual
<
RTCCertificate
>
{
public
:
static
scoped_refptr
<
RTCCertificate
>
Create
(
std
:
:
unique_ptr
<
rtc
:
:
SSLIdentity
>
identity
)
;
uint64_t
Expires
(
)
const
;
bool
HasExpired
(
uint64_t
now
)
const
;
const
rtc
:
:
SSLCertificate
&
GetSSLCertificate
(
)
const
;
const
rtc
:
:
SSLCertChain
&
GetSSLCertificateChain
(
)
const
;
rtc
:
:
SSLIdentity
*
identity
(
)
const
{
return
identity_
.
get
(
)
;
}
RTCCertificatePEM
ToPEM
(
)
const
;
static
scoped_refptr
<
RTCCertificate
>
FromPEM
(
const
RTCCertificatePEM
&
pem
)
;
bool
operator
=
=
(
const
RTCCertificate
&
certificate
)
const
;
bool
operator
!
=
(
const
RTCCertificate
&
certificate
)
const
;
protected
:
explicit
RTCCertificate
(
rtc
:
:
SSLIdentity
*
identity
)
;
friend
class
RefCountedNonVirtual
<
RTCCertificate
>
;
~
RTCCertificate
(
)
;
private
:
const
std
:
:
unique_ptr
<
rtc
:
:
SSLIdentity
>
identity_
;
}
;
}
namespace
rtc
{
using
:
:
webrtc
:
:
RTCCertificate
;
using
:
:
webrtc
:
:
RTCCertificatePEM
;
}
#
endif
