#
ifndef
RTC_BASE_SIGSLOT_TRAMPOLINE_H_
#
define
RTC_BASE_SIGSLOT_TRAMPOLINE_H_
#
include
<
utility
>
#
include
"
absl
/
functional
/
any_invocable
.
h
"
#
include
"
rtc_base
/
callback_list
.
h
"
#
include
"
rtc_base
/
third_party
/
sigslot
/
sigslot
.
h
"
namespace
webrtc
{
template
<
class
T
sigslot
:
:
signal0
<
>
T
:
:
*
member_signal
>
class
SignalTrampoline
:
public
sigslot
:
:
has_slots
<
>
{
public
:
explicit
SignalTrampoline
(
T
*
that
)
{
(
that
-
>
*
member_signal
)
.
connect
(
this
&
SignalTrampoline
:
:
Notify
)
;
}
void
Subscribe
(
absl
:
:
AnyInvocable
<
void
(
)
>
callback
)
{
callbacks_
.
AddReceiver
(
std
:
:
move
(
callback
)
)
;
}
private
:
void
Notify
(
)
{
callbacks_
.
Send
(
)
;
}
CallbackList
<
>
callbacks_
;
}
;
}
#
endif
