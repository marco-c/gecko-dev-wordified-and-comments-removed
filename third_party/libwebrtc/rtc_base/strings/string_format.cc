#
include
"
rtc_base
/
strings
/
string_format
.
h
"
#
include
<
cstdarg
>
#
include
<
cstdio
>
#
include
<
string
>
#
include
"
rtc_base
/
checks
.
h
"
namespace
webrtc
{
namespace
{
constexpr
int
kMaxSize
=
512
;
}
std
:
:
string
StringFormat
(
const
char
*
fmt
.
.
.
)
{
char
buffer
[
kMaxSize
]
;
va_list
args
;
va_start
(
args
fmt
)
;
int
result
=
vsnprintf
(
buffer
kMaxSize
fmt
args
)
;
va_end
(
args
)
;
RTC_DCHECK_GE
(
result
0
)
<
<
"
ERROR
:
vsnprintf
(
)
failed
with
error
"
<
<
result
;
RTC_DCHECK_LT
(
result
kMaxSize
)
<
<
"
WARNING
:
string
was
truncated
from
"
<
<
result
<
<
"
to
"
<
<
(
kMaxSize
-
1
)
<
<
"
characters
"
;
return
std
:
:
string
(
buffer
)
;
}
}
