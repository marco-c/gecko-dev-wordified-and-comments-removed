#
include
"
rtc_base
/
zero_memory
.
h
"
#
include
<
cstddef
>
#
include
<
cstdint
>
#
include
"
api
/
array_view
.
h
"
#
include
"
test
/
gtest
.
h
"
namespace
webrtc
{
TEST
(
ZeroMemoryTest
TestZeroMemory
)
{
static
const
size_t
kBufferSize
=
32
;
uint8_t
buffer
[
kBufferSize
]
;
for
(
size_t
i
=
0
;
i
<
kBufferSize
;
i
+
+
)
{
buffer
[
i
]
=
static_cast
<
uint8_t
>
(
i
+
1
)
;
}
ExplicitZeroMemory
(
buffer
sizeof
(
buffer
)
)
;
for
(
size_t
i
=
0
;
i
<
kBufferSize
;
i
+
+
)
{
EXPECT_EQ
(
buffer
[
i
]
0
)
;
}
}
TEST
(
ZeroMemoryTest
TestZeroArrayView
)
{
static
const
size_t
kBufferSize
=
32
;
uint8_t
buffer
[
kBufferSize
]
;
for
(
size_t
i
=
0
;
i
<
kBufferSize
;
i
+
+
)
{
buffer
[
i
]
=
static_cast
<
uint8_t
>
(
i
+
1
)
;
}
ExplicitZeroMemory
(
ArrayView
<
uint8_t
>
(
buffer
sizeof
(
buffer
)
)
)
;
for
(
size_t
i
=
0
;
i
<
kBufferSize
;
i
+
+
)
{
EXPECT_EQ
(
buffer
[
i
]
0
)
;
}
}
TEST
(
ZeroMemoryTest
TestZeroMemoryUnused
)
{
static
const
size_t
kBufferSize
=
32
;
uint8_t
buffer
[
kBufferSize
]
;
ExplicitZeroMemory
(
buffer
sizeof
(
buffer
)
)
;
}
}
