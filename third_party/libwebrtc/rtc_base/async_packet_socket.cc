#
include
"
rtc_base
/
async_packet_socket
.
h
"
namespace
rtc
{
PacketTimeUpdateParams
:
:
PacketTimeUpdateParams
(
)
=
default
;
PacketTimeUpdateParams
:
:
PacketTimeUpdateParams
(
const
PacketTimeUpdateParams
&
other
)
=
default
;
PacketTimeUpdateParams
:
:
~
PacketTimeUpdateParams
(
)
=
default
;
PacketOptions
:
:
PacketOptions
(
)
=
default
;
PacketOptions
:
:
PacketOptions
(
DiffServCodePoint
dscp
)
:
dscp
(
dscp
)
{
}
PacketOptions
:
:
PacketOptions
(
const
PacketOptions
&
other
)
=
default
;
PacketOptions
:
:
~
PacketOptions
(
)
=
default
;
AsyncPacketSocket
:
:
AsyncPacketSocket
(
)
{
network_checker_
.
Detach
(
)
;
}
AsyncPacketSocket
:
:
~
AsyncPacketSocket
(
)
=
default
;
void
AsyncPacketSocket
:
:
SubscribeClose
(
const
void
*
removal_tag
std
:
:
function
<
void
(
AsyncPacketSocket
*
int
)
>
callback
)
{
RTC_DCHECK_RUN_ON
(
&
network_checker_
)
;
on_close_
.
AddReceiver
(
removal_tag
std
:
:
move
(
callback
)
)
;
}
void
AsyncPacketSocket
:
:
UnsubscribeClose
(
const
void
*
removal_tag
)
{
RTC_DCHECK_RUN_ON
(
&
network_checker_
)
;
on_close_
.
RemoveReceivers
(
removal_tag
)
;
}
void
CopySocketInformationToPacketInfo
(
size_t
packet_size_bytes
const
AsyncPacketSocket
&
socket_from
bool
is_connectionless
rtc
:
:
PacketInfo
*
info
)
{
info
-
>
packet_size_bytes
=
packet_size_bytes
;
info
-
>
ip_overhead_bytes
=
socket_from
.
GetLocalAddress
(
)
.
ipaddr
(
)
.
overhead
(
)
;
}
}
