#
include
"
rtc_base
/
experiments
/
bandwidth_quality_scaler_settings
.
h
"
#
include
"
test
/
field_trial
.
h
"
#
include
"
test
/
gtest
.
h
"
namespace
webrtc
{
namespace
{
TEST
(
BandwidthQualityScalerSettingsTest
ValuesNotSetByDefault
)
{
const
auto
settings
=
BandwidthQualityScalerSettings
:
:
ParseFromFieldTrials
(
)
;
EXPECT_FALSE
(
settings
.
BitrateStateUpdateInterval
(
)
)
;
}
TEST
(
BandwidthQualityScalerSettingsTest
ParseBitrateStateUpdateInterval
)
{
test
:
:
ScopedFieldTrials
field_trials
(
"
WebRTC
-
Video
-
BandwidthQualityScalerSettings
/
"
"
bitrate_state_update_interval_s_
:
100
/
"
)
;
EXPECT_EQ
(
100u
BandwidthQualityScalerSettings
:
:
ParseFromFieldTrials
(
)
.
BitrateStateUpdateInterval
(
)
)
;
}
TEST
(
BandwidthQualityScalerSettingsTest
ParseAll
)
{
test
:
:
ScopedFieldTrials
field_trials
(
"
WebRTC
-
Video
-
BandwidthQualityScalerSettings
/
"
"
bitrate_state_update_interval_s_
:
100
/
"
)
;
EXPECT_EQ
(
100u
BandwidthQualityScalerSettings
:
:
ParseFromFieldTrials
(
)
.
BitrateStateUpdateInterval
(
)
)
;
}
TEST
(
BandwidthQualityScalerSettingsTest
DoesNotParseIncorrectValue
)
{
test
:
:
ScopedFieldTrials
field_trials
(
"
WebRTC
-
Video
-
BandwidthQualityScalerSettings
/
"
"
bitrate_state_update_interval_s_
:
?
?
/
"
)
;
const
auto
settings
=
BandwidthQualityScalerSettings
:
:
ParseFromFieldTrials
(
)
;
EXPECT_FALSE
(
settings
.
BitrateStateUpdateInterval
(
)
)
;
}
}
}
