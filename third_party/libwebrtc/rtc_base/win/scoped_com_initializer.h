#
ifndef
RTC_BASE_WIN_SCOPED_COM_INITIALIZER_H_
#
define
RTC_BASE_WIN_SCOPED_COM_INITIALIZER_H_
#
include
<
comdef
.
h
>
#
include
"
rtc_base
/
logging
.
h
"
namespace
webrtc
{
class
ScopedCOMInitializer
{
public
:
enum
SelectMTA
{
kMTA
}
;
ScopedCOMInitializer
(
)
;
explicit
ScopedCOMInitializer
(
SelectMTA
mta
)
;
~
ScopedCOMInitializer
(
)
;
ScopedCOMInitializer
(
const
ScopedCOMInitializer
&
)
=
delete
;
ScopedCOMInitializer
&
operator
=
(
const
ScopedCOMInitializer
&
)
=
delete
;
bool
Succeeded
(
)
{
return
SUCCEEDED
(
hr_
)
;
}
private
:
void
Initialize
(
COINIT
init
)
;
HRESULT
hr_
;
}
;
}
#
endif
