#
ifndef
RTC_BASE_SYNCHRONIZATION_SEQUENCE_CHECKER_H_
#
define
RTC_BASE_SYNCHRONIZATION_SEQUENCE_CHECKER_H_
#
include
<
type_traits
>
#
include
"
rtc_base
/
checks
.
h
"
#
include
"
rtc_base
/
deprecation
.
h
"
#
include
"
rtc_base
/
synchronization
/
sequence_checker_internal
.
h
"
#
include
"
rtc_base
/
thread_annotations
.
h
"
namespace
webrtc
{
#
if
RTC_DCHECK_IS_ON
class
RTC_LOCKABLE
SequenceChecker
:
public
webrtc_sequence_checker_internal
:
:
SequenceCheckerImpl
{
}
;
#
else
class
RTC_LOCKABLE
SequenceChecker
:
public
webrtc_sequence_checker_internal
:
:
SequenceCheckerDoNothing
{
}
;
#
endif
namespace
webrtc_seq_check_impl
{
using
:
:
webrtc
:
:
webrtc_sequence_checker_internal
:
:
SequenceCheckerScope
;
}
}
#
define
RTC_RUN_ON
(
x
)
\
RTC_THREAD_ANNOTATION_ATTRIBUTE__
(
exclusive_locks_required
(
x
)
)
namespace
webrtc
{
template
<
typename
ThreadLikeObject
>
RTC_DEPRECATED
std
:
:
string
ExpectationToString
(
const
ThreadLikeObject
*
o
)
{
return
webrtc
:
:
webrtc_sequence_checker_internal
:
:
ExpectationToString
(
o
)
;
}
}
#
define
RTC_DCHECK_RUN_ON
(
x
)
\
webrtc
:
:
webrtc_sequence_checker_internal
:
:
SequenceCheckerScope
scope
(
x
)
;
\
RTC_DCHECK
(
(
x
)
-
>
IsCurrent
(
)
)
\
<
<
webrtc
:
:
webrtc_sequence_checker_internal
:
:
ExpectationToString
(
x
)
#
endif
