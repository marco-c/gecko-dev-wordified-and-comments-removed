#
include
"
common_audio
/
resampler
/
include
/
push_resampler
.
h
"
#
include
"
rtc_base
/
checks
.
h
"
#
include
"
test
/
gtest
.
h
"
#
include
"
test
/
testsupport
/
rtc_expect_death
.
h
"
namespace
webrtc
{
#
if
!
defined
(
WEBRTC_WIN
)
&
&
defined
(
__clang__
)
&
&
!
defined
(
NDEBUG
)
TEST
(
PushResamplerTest
VerifiesInputParameters
)
{
PushResampler
<
int16_t
>
resampler
;
EXPECT_EQ
(
0
resampler
.
InitializeIfNeeded
(
16000
16000
1
)
)
;
EXPECT_EQ
(
0
resampler
.
InitializeIfNeeded
(
16000
16000
2
)
)
;
EXPECT_EQ
(
0
resampler
.
InitializeIfNeeded
(
16000
16000
8
)
)
;
}
#
if
RTC_DCHECK_IS_ON
&
&
GTEST_HAS_DEATH_TEST
&
&
!
defined
(
WEBRTC_ANDROID
)
TEST
(
PushResamplerDeathTest
VerifiesBadInputParameters1
)
{
PushResampler
<
int16_t
>
resampler
;
RTC_EXPECT_DEATH
(
resampler
.
InitializeIfNeeded
(
-
1
16000
1
)
"
src_sample_rate_hz
"
)
;
}
TEST
(
PushResamplerDeathTest
VerifiesBadInputParameters2
)
{
PushResampler
<
int16_t
>
resampler
;
RTC_EXPECT_DEATH
(
resampler
.
InitializeIfNeeded
(
16000
-
1
1
)
"
dst_sample_rate_hz
"
)
;
}
TEST
(
PushResamplerDeathTest
VerifiesBadInputParameters3
)
{
PushResampler
<
int16_t
>
resampler
;
RTC_EXPECT_DEATH
(
resampler
.
InitializeIfNeeded
(
16000
16000
0
)
"
num_channels
"
)
;
}
#
endif
#
endif
}
