#
include
"
common_audio
/
fir_filter_factory
.
h
"
#
include
"
common_audio
/
fir_filter_c
.
h
"
#
include
"
rtc_base
/
checks
.
h
"
#
include
"
rtc_base
/
system
/
arch
.
h
"
#
if
defined
(
WEBRTC_HAS_NEON
)
#
include
"
common_audio
/
fir_filter_neon
.
h
"
#
elif
defined
(
WEBRTC_ARCH_X86_FAMILY
)
#
include
"
common_audio
/
fir_filter_avx2
.
h
"
#
include
"
common_audio
/
fir_filter_sse
.
h
"
#
include
"
system_wrappers
/
include
/
cpu_features_wrapper
.
h
"
#
endif
namespace
webrtc
{
FIRFilter
*
CreateFirFilter
(
const
float
*
coefficients
size_t
coefficients_length
size_t
max_input_length
)
{
if
(
!
coefficients
|
|
coefficients_length
<
=
0
|
|
max_input_length
<
=
0
)
{
RTC_NOTREACHED
(
)
;
return
nullptr
;
}
FIRFilter
*
filter
=
nullptr
;
#
if
defined
(
WEBRTC_ARCH_X86_FAMILY
)
if
(
GetCPUInfo
(
kAVX2
)
)
{
filter
=
new
FIRFilterAVX2
(
coefficients
coefficients_length
max_input_length
)
;
}
else
if
(
GetCPUInfo
(
kSSE2
)
)
{
filter
=
new
FIRFilterSSE2
(
coefficients
coefficients_length
max_input_length
)
;
}
else
{
filter
=
new
FIRFilterC
(
coefficients
coefficients_length
)
;
}
#
elif
defined
(
WEBRTC_HAS_NEON
)
filter
=
new
FIRFilterNEON
(
coefficients
coefficients_length
max_input_length
)
;
#
else
filter
=
new
FIRFilterC
(
coefficients
coefficients_length
)
;
#
endif
return
filter
;
}
}
