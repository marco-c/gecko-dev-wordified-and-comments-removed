#
include
"
sdk
/
android
/
src
/
jni
/
pc
/
sdp_observer
.
h
"
#
include
<
utility
>
#
include
"
sdk
/
android
/
generated_peerconnection_jni
/
SdpObserver_jni
.
h
"
#
include
"
sdk
/
android
/
native_api
/
jni
/
java_types
.
h
"
#
include
"
sdk
/
android
/
src
/
jni
/
jni_helpers
.
h
"
#
include
"
sdk
/
media_constraints
.
h
"
namespace
webrtc
{
namespace
jni
{
CreateSdpObserverJni
:
:
CreateSdpObserverJni
(
JNIEnv
*
env
const
JavaRef
<
jobject
>
&
j_observer
std
:
:
unique_ptr
<
MediaConstraints
>
constraints
)
:
j_observer_global_
(
env
j_observer
)
constraints_
(
std
:
:
move
(
constraints
)
)
{
}
CreateSdpObserverJni
:
:
~
CreateSdpObserverJni
(
)
=
default
;
void
CreateSdpObserverJni
:
:
OnSuccess
(
SessionDescriptionInterface
*
desc
)
{
JNIEnv
*
env
=
AttachCurrentThreadIfNeeded
(
)
;
std
:
:
string
sdp
;
RTC_CHECK
(
desc
-
>
ToString
(
&
sdp
)
)
<
<
"
got
so
far
:
"
<
<
sdp
;
Java_SdpObserver_onCreateSuccess
(
env
j_observer_global_
NativeToJavaSessionDescription
(
env
sdp
desc
-
>
type
(
)
)
)
;
delete
desc
;
}
void
CreateSdpObserverJni
:
:
OnFailure
(
webrtc
:
:
RTCError
error
)
{
JNIEnv
*
env
=
AttachCurrentThreadIfNeeded
(
)
;
Java_SdpObserver_onCreateFailure
(
env
j_observer_global_
NativeToJavaString
(
env
error
.
message
(
)
)
)
;
}
SetSdpObserverJni
:
:
SetSdpObserverJni
(
JNIEnv
*
env
const
JavaRef
<
jobject
>
&
j_observer
std
:
:
unique_ptr
<
MediaConstraints
>
constraints
)
:
j_observer_global_
(
env
j_observer
)
constraints_
(
std
:
:
move
(
constraints
)
)
{
}
SetSdpObserverJni
:
:
~
SetSdpObserverJni
(
)
=
default
;
void
SetSdpObserverJni
:
:
OnSuccess
(
)
{
JNIEnv
*
env
=
AttachCurrentThreadIfNeeded
(
)
;
Java_SdpObserver_onSetSuccess
(
env
j_observer_global_
)
;
}
void
SetSdpObserverJni
:
:
OnFailure
(
webrtc
:
:
RTCError
error
)
{
JNIEnv
*
env
=
AttachCurrentThreadIfNeeded
(
)
;
Java_SdpObserver_onSetFailure
(
env
j_observer_global_
NativeToJavaString
(
env
error
.
message
(
)
)
)
;
}
}
}
