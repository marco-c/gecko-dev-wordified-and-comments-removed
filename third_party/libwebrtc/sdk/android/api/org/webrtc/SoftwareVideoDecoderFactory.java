package
org
.
webrtc
;
import
androidx
.
annotation
.
Nullable
;
import
java
.
util
.
List
;
public
class
SoftwareVideoDecoderFactory
implements
VideoDecoderFactory
{
private
static
final
String
TAG
=
"
SoftwareVideoDecoderFactory
"
;
private
final
long
nativeFactory
;
public
SoftwareVideoDecoderFactory
(
)
{
this
.
nativeFactory
=
nativeCreateFactory
(
)
;
}
Nullable
Override
public
VideoDecoder
createDecoder
(
VideoCodecInfo
info
)
{
if
(
!
nativeIsSupported
(
nativeFactory
info
)
)
{
Logging
.
w
(
TAG
"
Trying
to
create
decoder
for
unsupported
format
.
"
+
info
)
;
return
null
;
}
return
new
WrappedNativeVideoDecoder
(
)
{
Override
public
long
createNativeVideoDecoder
(
)
{
return
nativeCreateDecoder
(
nativeFactory
info
)
;
}
Override
public
long
createNative
(
long
webrtcEnvRef
)
{
return
nativeCreate
(
nativeFactory
webrtcEnvRef
info
)
;
}
}
;
}
Override
public
VideoCodecInfo
[
]
getSupportedCodecs
(
)
{
return
nativeGetSupportedCodecs
(
nativeFactory
)
.
toArray
(
new
VideoCodecInfo
[
0
]
)
;
}
private
static
native
long
nativeCreateFactory
(
)
;
private
static
native
long
nativeCreateDecoder
(
long
factory
VideoCodecInfo
videoCodecInfo
)
;
private
static
native
boolean
nativeIsSupported
(
long
factory
VideoCodecInfo
info
)
;
private
static
native
long
nativeCreate
(
long
factory
long
webrtcEnvRef
VideoCodecInfo
info
)
;
private
static
native
List
<
VideoCodecInfo
>
nativeGetSupportedCodecs
(
long
factory
)
;
}
