#
include
"
gtest
/
gtest
.
h
"
#
include
"
av1
/
encoder
/
encoder
.
h
"
namespace
{
constexpr
uint8_t
kSource
[
]
=
{
0
0
1
2
255
3
4
0
0
0
5
6
255
255
255
7
8
0
0
255
255
255
255
255
255
255
0
0
255
255
255
255
255
255
255
0
0
9
10
255
255
255
11
12
0
0
0
13
14
255
15
16
0
0
}
;
constexpr
uint8_t
kExpected
[
]
=
{
0
0
255
255
255
255
255
0
0
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
255
0
0
255
255
255
255
255
0
0
}
;
constexpr
int
kWidth
=
9
;
constexpr
int
kHeight
=
6
;
TEST
(
ScreenContentDetectionMode2
FindDominantValue
)
{
EXPECT_EQ
(
av1_find_dominant_value
(
kSource
kWidth
kHeight
kWidth
)
255
)
;
}
TEST
(
ScreenContentDetectionMode2
DilateBlock
)
{
uint8_t
dilated
[
kWidth
*
kHeight
]
=
{
0
}
;
av1_dilate_block
(
kSource
kWidth
dilated
kWidth
kHeight
kWidth
)
;
for
(
int
r
=
0
;
r
<
kHeight
;
+
+
r
)
{
for
(
int
c
=
0
;
c
<
kWidth
;
+
+
c
)
{
EXPECT_EQ
(
kExpected
[
r
*
kHeight
+
c
]
dilated
[
r
*
kHeight
+
c
]
)
;
}
}
}
}
