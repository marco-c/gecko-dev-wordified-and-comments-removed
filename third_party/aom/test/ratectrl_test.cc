#
include
"
av1
/
encoder
/
firstpass
.
h
"
#
include
"
av1
/
encoder
/
ratectrl
.
h
"
#
include
"
av1
/
encoder
/
tpl_model
.
h
"
#
include
"
third_party
/
googletest
/
src
/
googletest
/
include
/
gtest
/
gtest
.
h
"
namespace
{
TEST
(
RatectrlTest
QModeGetQIndexTest
)
{
int
base_q_index
=
36
;
int
gf_update_type
=
INTNL_ARF_UPDATE
;
int
gf_pyramid_level
=
1
;
int
arf_q
=
100
;
int
q_index
=
av1_q_mode_get_q_index
(
base_q_index
gf_update_type
gf_pyramid_level
arf_q
)
;
EXPECT_EQ
(
q_index
arf_q
)
;
gf_update_type
=
INTNL_ARF_UPDATE
;
gf_pyramid_level
=
3
;
q_index
=
av1_q_mode_get_q_index
(
base_q_index
gf_update_type
gf_pyramid_level
arf_q
)
;
EXPECT_LT
(
q_index
arf_q
)
;
gf_update_type
=
LF_UPDATE
;
q_index
=
av1_q_mode_get_q_index
(
base_q_index
gf_update_type
gf_pyramid_level
arf_q
)
;
EXPECT_EQ
(
q_index
base_q_index
)
;
}
}
