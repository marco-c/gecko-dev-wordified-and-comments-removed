#
ifndef
TEST_ACM_RANDOM_H_
#
define
TEST_ACM_RANDOM_H_
#
include
"
third_party
/
googletest
/
src
/
googletest
/
include
/
gtest
/
gtest
.
h
"
#
include
"
aom
/
aom_integer
.
h
"
namespace
libaom_test
{
class
ACMRandom
{
public
:
ACMRandom
(
)
:
random_
(
DeterministicSeed
(
)
)
{
}
explicit
ACMRandom
(
int
seed
)
:
random_
(
seed
)
{
}
void
Reset
(
int
seed
)
{
random_
.
Reseed
(
seed
)
;
}
uint32_t
Rand31
(
void
)
{
return
random_
.
Generate
(
testing
:
:
internal
:
:
Random
:
:
kMaxRange
)
;
}
uint16_t
Rand16
(
void
)
{
const
uint32_t
value
=
random_
.
Generate
(
testing
:
:
internal
:
:
Random
:
:
kMaxRange
)
;
return
(
value
>
>
15
)
&
0xffff
;
}
int16_t
Rand15Signed
(
void
)
{
const
uint32_t
value
=
random_
.
Generate
(
testing
:
:
internal
:
:
Random
:
:
kMaxRange
)
;
return
(
value
>
>
17
)
&
0xffff
;
}
uint16_t
Rand12
(
void
)
{
const
uint32_t
value
=
random_
.
Generate
(
testing
:
:
internal
:
:
Random
:
:
kMaxRange
)
;
return
(
value
>
>
19
)
&
0xfff
;
}
int16_t
Rand9Signed
(
void
)
{
const
uint32_t
value
=
random_
.
Generate
(
512
)
;
return
static_cast
<
int16_t
>
(
value
)
-
256
;
}
uint8_t
Rand8
(
void
)
{
const
uint32_t
value
=
random_
.
Generate
(
testing
:
:
internal
:
:
Random
:
:
kMaxRange
)
;
return
(
value
>
>
23
)
&
0xff
;
}
uint8_t
Rand8Extremes
(
void
)
{
const
uint8_t
r
=
Rand8
(
)
;
return
r
<
128
?
r
<
<
4
:
r
>
>
4
;
}
int
PseudoUniform
(
int
range
)
{
return
random_
.
Generate
(
range
)
;
}
int
operator
(
)
(
int
n
)
{
return
PseudoUniform
(
n
)
;
}
static
int
DeterministicSeed
(
void
)
{
return
0xbaba
;
}
private
:
testing
:
:
internal
:
:
Random
random_
;
}
;
}
#
endif
