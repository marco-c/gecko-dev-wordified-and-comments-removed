#
ifndef
AOM_AOM_DSP_X86_INTRAPRED_X86_H_
#
define
AOM_AOM_DSP_X86_INTRAPRED_X86_H_
#
include
<
emmintrin
.
h
>
#
include
"
aom
/
aom_integer
.
h
"
#
include
"
config
/
aom_config
.
h
"
static
INLINE
__m128i
dc_sum_16_sse2
(
const
uint8_t
*
ref
)
{
__m128i
x
=
_mm_load_si128
(
(
__m128i
const
*
)
ref
)
;
const
__m128i
zero
=
_mm_setzero_si128
(
)
;
x
=
_mm_sad_epu8
(
x
zero
)
;
const
__m128i
high
=
_mm_unpackhi_epi64
(
x
x
)
;
return
_mm_add_epi16
(
x
high
)
;
}
static
INLINE
__m128i
dc_sum_32_sse2
(
const
uint8_t
*
ref
)
{
__m128i
x0
=
_mm_load_si128
(
(
__m128i
const
*
)
ref
)
;
__m128i
x1
=
_mm_load_si128
(
(
__m128i
const
*
)
(
ref
+
16
)
)
;
const
__m128i
zero
=
_mm_setzero_si128
(
)
;
x0
=
_mm_sad_epu8
(
x0
zero
)
;
x1
=
_mm_sad_epu8
(
x1
zero
)
;
x0
=
_mm_add_epi16
(
x0
x1
)
;
const
__m128i
high
=
_mm_unpackhi_epi64
(
x0
x0
)
;
return
_mm_add_epi16
(
x0
high
)
;
}
#
endif
