#
ifndef
AV1_ENCODER_LOOKAHEAD_H_
#
define
AV1_ENCODER_LOOKAHEAD_H_
#
include
"
aom_scale
/
yv12config
.
h
"
#
include
"
aom
/
aom_integer
.
h
"
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
#
define
MAX_LAG_BUFFERS
25
struct
lookahead_entry
{
YV12_BUFFER_CONFIG
img
;
int64_t
ts_start
;
int64_t
ts_end
;
aom_enc_frame_flags_t
flags
;
}
;
#
define
MAX_PRE_FRAMES
1
struct
lookahead_ctx
{
int
max_sz
;
int
sz
;
int
read_idx
;
int
write_idx
;
struct
lookahead_entry
*
buf
;
}
;
struct
lookahead_ctx
*
av1_lookahead_init
(
unsigned
int
width
unsigned
int
height
unsigned
int
subsampling_x
unsigned
int
subsampling_y
#
if
CONFIG_HIGHBITDEPTH
int
use_highbitdepth
#
endif
unsigned
int
depth
)
;
void
av1_lookahead_destroy
(
struct
lookahead_ctx
*
ctx
)
;
int
av1_lookahead_push
(
struct
lookahead_ctx
*
ctx
YV12_BUFFER_CONFIG
*
src
int64_t
ts_start
int64_t
ts_end
#
if
CONFIG_HIGHBITDEPTH
int
use_highbitdepth
#
endif
aom_enc_frame_flags_t
flags
)
;
struct
lookahead_entry
*
av1_lookahead_pop
(
struct
lookahead_ctx
*
ctx
int
drain
)
;
struct
lookahead_entry
*
av1_lookahead_peek
(
struct
lookahead_ctx
*
ctx
int
index
)
;
unsigned
int
av1_lookahead_depth
(
struct
lookahead_ctx
*
ctx
)
;
#
ifdef
__cplusplus
}
#
endif
#
endif
