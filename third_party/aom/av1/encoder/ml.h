#
ifndef
AOM_AV1_ENCODER_ML_H_
#
define
AOM_AV1_ENCODER_ML_H_
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
#
define
NN_MAX_HIDDEN_LAYERS
10
#
define
NN_MAX_NODES_PER_LAYER
128
typedef
struct
{
int
num_inputs
;
int
num_outputs
;
int
num_hidden_layers
;
int
num_hidden_nodes
[
NN_MAX_HIDDEN_LAYERS
]
;
const
float
*
weights
[
NN_MAX_HIDDEN_LAYERS
+
1
]
;
const
float
*
bias
[
NN_MAX_HIDDEN_LAYERS
+
1
]
;
}
NN_CONFIG
;
void
av1_nn_predict
(
const
float
*
features
const
NN_CONFIG
*
nn_config
float
*
output
)
;
void
av1_nn_softmax
(
const
float
*
input
float
*
output
int
n
)
;
#
ifdef
__cplusplus
}
#
endif
#
endif
