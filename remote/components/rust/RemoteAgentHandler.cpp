#
include
"
mozilla
/
ClearOnShutdown
.
h
"
#
include
"
mozilla
/
StaticPtr
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsICommandLineHandler
.
h
"
#
include
"
nsISupportsUtils
.
h
"
#
include
"
RemoteAgentHandler
.
h
"
namespace
{
extern
"
C
"
{
void
new_remote_agent_handler
(
nsICommandLineHandler
*
*
result
)
;
}
static
mozilla
:
:
StaticRefPtr
<
nsICommandLineHandler
>
sHandler
;
}
already_AddRefed
<
nsICommandLineHandler
>
GetRemoteAgentHandler
(
)
{
nsCOMPtr
<
nsICommandLineHandler
>
handler
;
if
(
sHandler
)
{
handler
=
sHandler
;
}
else
{
new_remote_agent_handler
(
getter_AddRefs
(
handler
)
)
;
sHandler
=
handler
;
mozilla
:
:
ClearOnShutdown
(
&
sHandler
)
;
}
return
handler
.
forget
(
)
;
}
