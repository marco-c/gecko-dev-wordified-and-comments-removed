import
expect
from
'
expect
'
;
import
{
launch
}
from
'
.
/
mocha
-
utils
.
js
'
;
describe
(
'
BFCache
'
function
(
)
{
it
(
'
can
navigate
to
a
BFCached
page
'
async
(
)
=
>
{
const
{
httpsServer
page
close
}
=
await
launch
(
{
ignoreHTTPSErrors
:
true
}
)
;
try
{
page
.
setDefaultTimeout
(
2000
)
;
await
page
.
goto
(
httpsServer
.
PREFIX
+
'
/
cached
/
bfcache
/
index
.
html
'
)
;
await
Promise
.
all
(
[
page
.
waitForNavigation
(
)
page
.
locator
(
'
a
'
)
.
click
(
)
]
)
;
expect
(
page
.
url
(
)
)
.
toContain
(
'
target
.
html
'
)
;
await
Promise
.
all
(
[
page
.
waitForNavigation
(
)
page
.
goBack
(
)
]
)
;
expect
(
await
page
.
evaluate
(
(
)
=
>
{
return
document
.
body
.
innerText
;
}
)
)
.
toBe
(
'
BFCachednext
'
)
;
}
finally
{
await
close
(
)
;
}
}
)
;
}
)
;
