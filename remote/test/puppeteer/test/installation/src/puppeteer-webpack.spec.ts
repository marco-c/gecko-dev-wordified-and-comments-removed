import
{
readFile
rm
writeFile
}
from
'
fs
/
promises
'
;
import
{
join
}
from
'
path
'
;
import
{
describeInstallation
}
from
'
.
/
describeInstallation
.
js
'
;
import
{
execFile
readAsset
}
from
'
.
/
util
.
js
'
;
describeInstallation
(
'
puppeteer
with
Webpack
'
{
dependencies
:
[
'
puppeteer
-
core
'
'
puppeteer
'
]
devDependencies
:
[
'
webpack
'
'
webpack
-
cli
'
]
env
:
cwd
=
>
{
return
{
PUPPETEER_CACHE_DIR
:
join
(
cwd
'
.
cache
'
'
puppeteer
'
)
}
;
}
}
(
{
itEvaluates
}
)
=
>
{
itEvaluates
(
'
Webpack
bundles
'
{
commonjs
:
true
}
async
cwd
=
>
{
await
writeFile
(
join
(
cwd
'
webpack
.
config
.
mjs
'
)
await
readAsset
(
'
puppeteer
'
'
webpack
'
'
webpack
.
config
.
js
'
)
)
;
await
writeFile
(
join
(
cwd
'
index
.
js
'
)
await
readAsset
(
'
puppeteer
'
'
basic
.
js
'
)
)
;
await
execFile
(
'
npx
'
[
'
webpack
'
]
{
cwd
shell
:
true
}
)
;
await
rm
(
'
node_modules
'
{
recursive
:
true
force
:
true
}
)
;
return
await
readFile
(
join
(
cwd
'
bundle
.
js
'
)
'
utf
-
8
'
)
;
}
)
;
}
)
;
