"
use
strict
"
;
var
__importDefault
=
(
this
&
&
this
.
__importDefault
)
|
|
function
(
mod
)
{
return
(
mod
&
&
mod
.
__esModule
)
?
mod
:
{
"
default
"
:
mod
}
;
}
;
Object
.
defineProperty
(
exports
"
__esModule
"
{
value
:
true
}
)
;
const
mocha_1
=
__importDefault
(
require
(
"
mocha
"
)
)
;
const
common_1
=
__importDefault
(
require
(
"
mocha
/
lib
/
interfaces
/
common
"
)
)
;
const
utils_js_1
=
require
(
"
.
/
utils
.
js
"
)
;
const
skippedTests
=
process
.
env
[
'
PUPPETEER_SKIPPED_TEST_CONFIG
'
]
?
JSON
.
parse
(
process
.
env
[
'
PUPPETEER_SKIPPED_TEST_CONFIG
'
]
)
:
[
]
;
skippedTests
.
reverse
(
)
;
function
shouldSkipTest
(
test
)
{
const
testIdForFileName
=
(
0
utils_js_1
.
getTestId
)
(
test
.
file
)
;
const
testIdForTestName
=
(
0
utils_js_1
.
getTestId
)
(
test
.
file
test
.
fullTitle
(
)
)
;
const
definition
=
skippedTests
.
find
(
skippedTest
=
>
{
return
(
'
'
=
=
=
skippedTest
.
testIdPattern
|
|
testIdForFileName
=
=
=
skippedTest
.
testIdPattern
|
|
testIdForTestName
=
=
=
skippedTest
.
testIdPattern
)
;
}
)
;
if
(
definition
&
&
definition
.
skip
)
{
return
true
;
}
return
false
;
}
function
customBDDInterface
(
suite
)
{
const
suites
=
[
suite
]
;
suite
.
on
(
mocha_1
.
default
.
Suite
.
constants
.
EVENT_FILE_PRE_REQUIRE
function
(
context
file
mocha
)
{
const
common
=
(
0
common_1
.
default
)
(
suites
context
mocha
)
;
context
[
'
before
'
]
=
common
.
before
;
context
[
'
after
'
]
=
common
.
after
;
context
[
'
beforeEach
'
]
=
common
.
beforeEach
;
context
[
'
afterEach
'
]
=
common
.
afterEach
;
if
(
mocha
.
options
.
delay
)
{
context
[
'
run
'
]
=
common
.
runWithSuite
(
suite
)
;
}
function
describe
(
title
fn
)
{
return
common
.
suite
.
create
(
{
title
:
title
file
:
file
fn
:
fn
}
)
;
}
describe
.
only
=
function
(
title
fn
)
{
return
common
.
suite
.
only
(
{
title
:
title
file
:
file
fn
:
fn
}
)
;
}
;
describe
.
skip
=
function
(
title
fn
)
{
return
common
.
suite
.
skip
(
{
title
:
title
file
:
file
fn
:
fn
}
)
;
}
;
context
[
'
describe
'
]
=
describe
;
function
it
(
title
fn
)
{
const
suite
=
suites
[
0
]
;
const
test
=
new
mocha_1
.
default
.
Test
(
title
suite
.
isPending
(
)
?
undefined
:
fn
)
;
test
.
file
=
file
;
test
.
parent
=
suite
;
if
(
shouldSkipTest
(
test
)
)
{
const
test
=
new
mocha_1
.
default
.
Test
(
title
)
;
test
.
file
=
file
;
suite
.
addTest
(
test
)
;
return
test
;
}
else
{
suite
.
addTest
(
test
)
;
return
test
;
}
}
it
.
only
=
function
(
title
fn
)
{
return
common
.
test
.
only
(
mocha
context
[
'
it
'
]
(
title
fn
)
)
;
}
;
it
.
skip
=
function
(
title
)
{
return
context
[
'
it
'
]
(
title
)
;
}
;
context
.
it
=
it
;
}
)
;
}
customBDDInterface
.
description
=
'
Custom
BDD
'
;
module
.
exports
=
customBDDInterface
;
