"
use
strict
"
;
importScripts
(
"
resource
:
/
/
gre
/
modules
/
devtools
/
shared
/
worker
-
helper
.
js
"
)
;
const
snapshots
=
Object
.
create
(
null
)
;
workerHelper
.
createTask
(
self
"
readHeapSnapshot
"
(
{
snapshotFilePath
}
)
=
>
{
snapshots
[
snapshotFilePath
]
=
ThreadSafeChromeUtils
.
readHeapSnapshot
(
snapshotFilePath
)
;
return
true
;
}
)
;
workerHelper
.
createTask
(
self
"
takeCensus
"
(
{
snapshotFilePath
censusOptions
}
)
=
>
{
if
(
!
snapshots
[
snapshotFilePath
]
)
{
throw
new
Error
(
No
known
heap
snapshot
for
'
{
snapshotFilePath
}
'
)
;
}
return
snapshots
[
snapshotFilePath
]
.
takeCensus
(
censusOptions
)
;
}
)
;
