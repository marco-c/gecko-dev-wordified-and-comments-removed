#
include
"
ProxyUtils
.
h
"
namespace
mozilla
{
namespace
toolkit
{
namespace
system
{
bool
IsHostProxyEntry
(
const
nsACString
&
aHost
const
nsACString
&
aOverride
)
{
nsAutoCString
host
(
aHost
)
;
nsAutoCString
override
(
aOverride
)
;
int32_t
overrideLength
=
override
.
Length
(
)
;
int32_t
tokenStart
=
0
;
int32_t
offset
=
0
;
bool
star
=
false
;
while
(
tokenStart
<
overrideLength
)
{
int32_t
tokenEnd
=
override
.
FindChar
(
'
*
'
tokenStart
)
;
if
(
tokenEnd
=
=
tokenStart
)
{
star
=
true
;
tokenStart
+
+
;
if
(
override
.
FindChar
(
'
.
'
tokenStart
)
=
=
tokenStart
)
{
tokenStart
+
+
;
}
}
else
{
if
(
tokenEnd
=
=
-
1
)
{
tokenEnd
=
overrideLength
;
}
nsAutoCString
token
(
Substring
(
override
tokenStart
tokenEnd
-
tokenStart
)
)
;
offset
=
host
.
Find
(
token
offset
)
;
if
(
offset
=
=
-
1
|
|
(
!
star
&
&
offset
)
)
{
return
false
;
}
star
=
false
;
tokenStart
=
tokenEnd
;
offset
+
=
token
.
Length
(
)
;
}
}
return
(
star
|
|
(
offset
=
=
host
.
Length
(
)
)
)
;
}
}
}
}
