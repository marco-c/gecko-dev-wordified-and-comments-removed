#
include
"
gtest
/
gtest
.
h
"
#
include
"
nsWindowsPackageManager
.
h
"
#
include
"
nsServiceManagerUtils
.
h
"
using
namespace
mozilla
:
:
toolkit
:
:
system
;
TEST
(
WindowsPackageManager
TestWithMatches
)
{
nsCOMPtr
<
nsIWindowsPackageManager
>
wpm
(
do_GetService
(
"
mozilla
.
org
/
windows
-
package
-
manager
;
1
"
)
)
;
nsTArray
<
nsString
>
prefixes
packages
;
prefixes
.
AppendElement
(
u
"
Microsoft
"
_ns
)
;
nsresult
retVal
=
wpm
-
>
FindUserInstalledPackages
(
prefixes
packages
)
;
ASSERT_GT
(
packages
.
Length
(
)
0
)
;
ASSERT_EQ
(
NS_OK
retVal
)
;
}
TEST
(
WindowsPackageManager
TestWithoutMatches
)
{
nsCOMPtr
<
nsIWindowsPackageManager
>
wpm
(
do_GetService
(
"
mozilla
.
org
/
windows
-
package
-
manager
;
1
"
)
)
;
nsTArray
<
nsString
>
prefixes
packages
;
prefixes
.
AppendElement
(
u
"
DoesntExist
"
_ns
)
;
nsresult
retVal
=
wpm
-
>
FindUserInstalledPackages
(
prefixes
packages
)
;
ASSERT_EQ
(
packages
.
Length
(
)
0
)
;
ASSERT_EQ
(
NS_OK
retVal
)
;
}
