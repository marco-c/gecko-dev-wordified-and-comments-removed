extern
crate
rustc_version
;
use
rustc_version
:
:
{
version
Version
}
;
fn
main
(
)
{
let
ver
=
version
(
)
.
unwrap
(
)
;
let
mut
bootstrap
=
false
;
if
ver
>
=
Version
:
:
parse
(
"
1
.
24
.
0
"
)
.
unwrap
(
)
&
&
ver
<
Version
:
:
parse
(
"
1
.
27
.
0
"
)
.
unwrap
(
)
{
println
!
(
"
cargo
:
rustc
-
cfg
=
feature
=
\
"
oom_with_global_alloc
\
"
"
)
;
bootstrap
=
true
;
}
else
if
ver
>
=
Version
:
:
parse
(
"
1
.
28
.
0
-
alpha
"
)
.
unwrap
(
)
&
&
ver
<
Version
:
:
parse
(
"
1
.
29
.
0
"
)
.
unwrap
(
)
{
println
!
(
"
cargo
:
rustc
-
cfg
=
feature
=
\
"
oom_with_hook
\
"
"
)
;
bootstrap
=
true
;
}
else
if
std
:
:
env
:
:
var
(
"
MOZ_AUTOMATION
"
)
.
is_ok
(
)
&
&
ver
>
=
Version
:
:
parse
(
"
1
.
29
.
0
-
alpha
"
)
.
unwrap
(
)
{
panic
!
(
"
Builds
on
automation
must
use
a
version
of
rust
that
supports
OOM
hooking
"
)
}
if
bootstrap
{
println
!
(
"
cargo
:
rustc
-
env
=
RUSTC_BOOTSTRAP
=
1
"
)
;
}
}
