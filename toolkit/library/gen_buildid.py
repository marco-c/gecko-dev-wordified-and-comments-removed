import
os
from
io
import
StringIO
import
buildconfig
from
mozbuild
.
preprocessor
import
Preprocessor
def
main
(
output
input_file
)
:
    
with
open
(
input_file
)
as
fh
:
        
objs
=
[
l
.
strip
(
)
for
l
in
fh
.
readlines
(
)
]
    
pp
=
Preprocessor
(
)
    
pp
.
out
=
StringIO
(
)
    
pp
.
do_include
(
os
.
path
.
join
(
buildconfig
.
topobjdir
"
buildid
.
h
"
)
)
    
buildid
=
pp
.
context
[
"
MOZ_BUILDID
"
]
    
output
.
write
(
'
extern
const
char
gToolkitBuildID
[
]
=
"
%
s
"
;
'
%
buildid
)
    
return
set
(
        
os
.
path
.
join
(
"
build
"
o
)
        
for
o
in
objs
        
if
os
.
path
.
splitext
(
os
.
path
.
basename
(
o
)
)
[
0
]
!
=
"
buildid
"
    
)
