#
ifndef
mozilla_CertAnnotator_h
#
define
mozilla_CertAnnotator_h
#
include
"
mozilla
/
Move
.
h
"
#
include
"
mozilla
/
Mutex
.
h
"
#
include
"
nsDataHashtable
.
h
"
#
include
"
nsIObserver
.
h
"
#
include
"
nsIThread
.
h
"
#
include
"
nsString
.
h
"
#
include
"
nsTArray
.
h
"
namespace
mozilla
{
class
CertAnnotator
final
:
public
nsIObserver
{
public
:
NS_DECL_THREADSAFE_ISUPPORTS
NS_DECL_NSIOBSERVER
static
void
Register
(
)
;
private
:
CertAnnotator
(
)
=
default
;
virtual
~
CertAnnotator
(
)
;
bool
Init
(
)
;
void
RecordInitialCertInfo
(
)
;
void
RecordCertInfo
(
const
nsAString
&
aLibPath
const
bool
aDoSerialize
)
;
void
Serialize
(
)
;
void
Annotate
(
const
nsCString
&
aAnnotation
)
;
nsDataHashtable
<
nsStringHashKey
nsTArray
<
nsString
>
>
mCertTable
;
nsCOMPtr
<
nsIThread
>
mAnnotatorThread
;
}
;
}
#
endif
