package
main
import
(
"
debug
/
macho
"
)
import
"
C
"
func
getArchStringFromHeader
(
header
macho
.
FileHeader
)
string
{
if
header
.
Cpu
=
=
C
.
kCPU_TYPE_ARM64
&
&
header
.
SubCpu
=
=
C
.
kCPU_SUBTYPE_ARM64_ALL
{
return
"
arm64
"
}
if
header
.
Cpu
=
=
C
.
kCPU_TYPE_ARM64
&
&
header
.
SubCpu
=
=
C
.
kCPU_SUBTYPE_ARM64_E
{
return
"
arm64e
"
}
if
header
.
Cpu
=
=
C
.
kCPU_TYPE_ARM
&
&
header
.
SubCpu
=
=
C
.
kCPU_SUBTYPE_ARM_V7S
{
return
"
armv7s
"
}
cstr
:
=
C
.
GetNXArchInfoName
(
C
.
cpu_type_t
(
header
.
Cpu
)
C
.
cpu_subtype_t
(
header
.
SubCpu
)
)
if
cstr
=
=
nil
{
return
"
"
}
return
C
.
GoString
(
cstr
)
}
const
(
MachODylib
macho
.
Type
=
C
.
kMachHeaderFtypeDylib
MachOBundle
=
C
.
kMachHeaderFtypeBundle
MachOExe
=
C
.
kMachHeaderFtypeExe
MachODylinker
=
C
.
kMachHeaderFtypeDylinker
)
