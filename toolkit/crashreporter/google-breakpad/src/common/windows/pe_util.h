#
ifndef
COMMON_WINDOWS_PE_UTIL_H_
#
define
COMMON_WINDOWS_PE_UTIL_H_
#
include
<
windows
.
h
>
#
include
"
common
/
windows
/
module_info
.
h
"
namespace
google_breakpad
{
using
std
:
:
wstring
;
bool
ReadModuleInfo
(
const
wstring
&
pe_file
PDBModuleInfo
*
info
)
;
bool
ReadPEInfo
(
const
wstring
&
pe_file
PEModuleInfo
*
info
)
;
bool
PrintPEFrameData
(
const
wstring
&
pe_file
FILE
*
out_file
)
;
wstring
GenerateDebugIdentifier
(
DWORD
age
GUID
signature
)
;
wstring
GenerateDebugIdentifier
(
DWORD
age
DWORD
signature
)
;
constexpr
const
wchar_t
*
FileHeaderMachineToCpuString
(
WORD
machine
)
{
switch
(
machine
)
{
case
IMAGE_FILE_MACHINE_I386
:
{
return
L
"
x86
"
;
}
case
IMAGE_FILE_MACHINE_IA64
:
case
IMAGE_FILE_MACHINE_AMD64
:
{
return
L
"
x86_64
"
;
}
default
:
{
return
L
"
unknown
"
;
}
}
}
}
#
endif
