use
std
:
:
ffi
:
:
OsStr
;
use
std
:
:
os
:
:
windows
:
:
ffi
:
:
OsStrExt
;
use
windows_sys
:
:
core
:
:
PCWSTR
;
pub
struct
WideString
(
Vec
<
u16
>
)
;
impl
WideString
{
pub
fn
new
(
os_str
:
impl
AsRef
<
OsStr
>
)
-
>
Self
{
WideString
(
os_str
.
as_ref
(
)
.
encode_wide
(
)
.
chain
(
std
:
:
iter
:
:
once
(
0
)
)
.
filter
(
|
c
|
*
c
!
=
0x2068
&
&
*
c
!
=
0x2069
)
.
collect
(
)
)
}
pub
fn
pcwstr
(
&
self
)
-
>
PCWSTR
{
self
.
0
.
as_ptr
(
)
}
pub
fn
as_slice
(
&
self
)
-
>
&
[
u16
]
{
&
self
.
0
}
}
