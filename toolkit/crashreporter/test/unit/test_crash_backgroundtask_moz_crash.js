add_task
(
async
function
run_test
(
)
{
if
(
!
AppConstants
.
MOZ_BACKGROUNDTASKS
)
{
return
;
}
await
do_backgroundtask_crash
(
CrashTestUtils
.
CRASH_MOZ_CRASH
{
TestKey
:
"
TestValue
"
}
function
(
mdump
extra
)
{
Assert
.
equal
(
extra
.
TestKey
"
TestValue
"
)
;
Assert
.
equal
(
extra
.
BackgroundTaskMode
"
1
"
)
;
Assert
.
equal
(
extra
.
BackgroundTaskName
"
crash
"
)
;
Assert
.
equal
(
extra
.
HeadlessMode
"
1
"
)
;
Assert
.
equal
(
false
"
OOMAllocationSize
"
in
extra
)
;
Assert
.
equal
(
false
"
JSOutOfMemory
"
in
extra
)
;
Assert
.
equal
(
false
"
JSLargeAllocationFailure
"
in
extra
)
;
}
true
)
;
}
)
;
