#
include
"
nsExceptionHandlerUtils
.
h
"
#
include
"
mozilla
/
double
-
conversion
.
h
"
bool
SimpleNoCLibDtoA
(
double
aValue
char
*
aBuffer
int
aBufferLength
)
{
aBuffer
[
aBufferLength
-
1
]
=
'
\
0
'
;
if
(
aValue
<
0
)
{
return
false
;
}
int
length
point
i
;
bool
sign
;
bool
ok
=
true
;
double_conversion
:
:
DoubleToStringConverter
:
:
DoubleToAscii
(
aValue
double_conversion
:
:
DoubleToStringConverter
:
:
SHORTEST
8
aBuffer
aBufferLength
&
sign
&
length
&
point
)
;
if
(
length
>
point
&
&
(
length
+
1
)
<
(
aBufferLength
-
1
)
)
{
aBuffer
[
length
+
1
]
=
'
\
0
'
;
for
(
i
=
length
;
i
>
point
;
i
-
=
1
)
{
aBuffer
[
i
]
=
aBuffer
[
i
-
1
]
;
}
aBuffer
[
i
]
=
'
.
'
;
}
else
if
(
length
<
point
)
{
for
(
i
=
length
;
i
<
point
;
i
+
=
1
)
{
if
(
i
>
=
aBufferLength
-
2
)
{
ok
=
false
;
}
aBuffer
[
i
]
=
'
0
'
;
}
aBuffer
[
i
]
=
'
\
0
'
;
}
return
ok
;
}
