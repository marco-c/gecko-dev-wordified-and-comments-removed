"
use
strict
"
;
var
{
XPCOMUtils
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
gre
/
modules
/
XPCOMUtils
.
sys
.
mjs
"
)
;
const
{
AppConstants
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
gre
/
modules
/
AppConstants
.
sys
.
mjs
"
)
;
ChromeUtils
.
defineESModuleGetters
(
this
{
Subprocess
:
"
resource
:
/
/
gre
/
modules
/
Subprocess
.
sys
.
mjs
"
}
)
;
async
function
getRealPythonExecutable
(
pathToPython
)
{
const
TEST_SCRIPT
=
do_get_file
(
"
data_test_script
.
py
"
)
.
path
;
let
proc
=
await
Subprocess
.
call
(
{
command
:
pathToPython
arguments
:
[
"
-
u
"
TEST_SCRIPT
"
print_python_executable_path
"
]
}
)
;
let
{
exitCode
}
=
await
proc
.
wait
(
)
;
equal
(
exitCode
0
"
Successfully
got
executable
path
"
)
;
let
count
=
await
proc
.
stdout
.
readUint32
(
)
;
let
realPythonPath
=
await
proc
.
stdout
.
readString
(
count
)
;
ok
(
realPythonPath
Found
path
to
Python
program
:
{
realPythonPath
}
)
;
return
realPythonPath
;
}
