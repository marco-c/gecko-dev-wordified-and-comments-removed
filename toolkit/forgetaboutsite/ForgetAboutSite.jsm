"
use
strict
"
;
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
var
EXPORTED_SYMBOLS
=
[
"
ForgetAboutSite
"
]
;
var
ForgetAboutSite
=
{
async
removeDataFromDomain
(
aDomain
)
{
let
promises
=
[
]
;
let
errorCount
=
0
;
[
"
http
:
/
/
"
"
https
:
/
/
"
]
.
forEach
(
scheme
=
>
{
promises
.
push
(
new
Promise
(
resolve
=
>
{
Services
.
clearData
.
deleteDataFromHost
(
aDomain
true
Ci
.
nsIClearDataService
.
CLEAR_FORGET_ABOUT_SITE
value
=
>
{
errorCount
+
=
bitCounting
(
value
)
;
resolve
(
)
;
}
)
;
}
)
)
;
}
)
;
await
Promise
.
all
(
promises
)
;
if
(
errorCount
!
=
=
0
)
{
throw
new
Error
(
There
were
a
total
of
{
errorCount
}
errors
during
removal
)
;
}
}
}
;
function
bitCounting
(
value
)
{
const
count
=
value
-
(
(
value
>
>
1
)
&
0o33333333333
)
-
(
(
value
>
>
2
)
&
0o11111111111
)
;
return
(
(
count
+
(
count
>
>
3
)
)
&
0o30707070707
)
%
63
;
}
