#
include
"
mozilla
/
Viaduct
.
h
"
#
include
"
mozilla
/
ViaductRequest
.
h
"
namespace
mozilla
{
namespace
{
extern
"
C
"
{
uint8_t
viaduct_initialize
(
ViaductByteBuffer
(
*
fetch_callback
)
(
ViaductByteBuffer
)
)
;
}
static
ViaductByteBuffer
ViaductCallback
(
ViaductByteBuffer
buffer
)
{
MOZ_ASSERT
(
!
NS_IsMainThread
(
)
"
Background
thread
only
!
"
)
;
RefPtr
<
ViaductRequest
>
request
=
new
ViaductRequest
(
)
;
return
request
-
>
MakeRequest
(
buffer
)
;
}
}
void
InitializeViaduct
(
)
{
viaduct_initialize
(
ViaductCallback
)
;
}
}
