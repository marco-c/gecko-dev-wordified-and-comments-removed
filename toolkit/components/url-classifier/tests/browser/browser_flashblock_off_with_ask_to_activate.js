"
use
strict
"
;
requestLongerTimeout
(
3
)
;
Services
.
scriptloader
.
loadSubScript
(
"
chrome
:
/
/
mochitests
/
content
/
browser
/
toolkit
/
components
/
url
-
classifier
/
tests
/
browser
/
classifierHelper
.
js
"
this
)
;
Services
.
scriptloader
.
loadSubScript
(
"
chrome
:
/
/
mochitests
/
content
/
browser
/
toolkit
/
components
/
url
-
classifier
/
tests
/
browser
/
classifierTester
.
js
"
this
)
;
add_task
(
async
function
checkFlashBlockLists
(
)
{
classifierTester
.
setPrefs
(
{
setDBs
:
true
flashBlockEnable
:
false
flashSetting
:
classifierTester
.
ASK_TO_ACTIVATE_PREF_VALUE
}
)
;
await
classifierHelper
.
waitForInit
(
)
;
await
classifierHelper
.
addUrlToDB
(
classifierTester
.
dbUrls
)
;
for
(
let
testCase
of
classifierTester
.
testCases
)
{
info
(
RUNNING
TEST
:
{
testCase
.
name
}
(
Ask
to
Activate
Flashblock
off
)
)
;
let
tab
=
await
classifierTester
.
buildTestCaseInNewTab
(
gBrowser
testCase
)
;
let
depth
=
testCase
.
domains
.
length
-
1
;
let
pluginInfo
=
await
classifierTester
.
getPluginInfo
(
tab
.
linkedBrowser
depth
)
;
classifierTester
.
checkPluginInfo
(
pluginInfo
"
unknown
"
classifierTester
.
ASK_TO_ACTIVATE_PREF_VALUE
)
;
await
BrowserTestUtils
.
removeTab
(
tab
)
;
}
}
)
;
