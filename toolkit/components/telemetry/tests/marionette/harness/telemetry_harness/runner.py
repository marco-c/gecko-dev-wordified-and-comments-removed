from
marionette_harness
import
BaseMarionetteTestRunner
from
telemetry_harness
.
testcase
import
TelemetryTestCase
SERVER_URL
=
"
http
:
/
/
localhost
:
8000
"
class
TelemetryTestRunner
(
BaseMarionetteTestRunner
)
:
    
"
"
"
TestRunner
for
the
telemetry
-
tests
-
client
suite
.
"
"
"
    
def
__init__
(
self
*
*
kwargs
)
:
        
"
"
"
Set
test
variables
and
preferences
specific
to
Firefox
client
        
telemetry
.
        
"
"
"
        
kwargs
[
"
app
"
]
=
"
fxdesktop
"
        
prefs
=
kwargs
.
pop
(
"
prefs
"
{
}
)
        
prefs
[
"
fission
.
autostart
"
]
=
True
        
if
kwargs
[
"
disable_fission
"
]
:
            
prefs
[
"
fission
.
autostart
"
]
=
False
        
prefs
.
update
(
            
{
                
"
browser
.
region
.
network
.
url
"
:
"
"
                
"
browser
.
cache
.
disk
.
smart_size
.
enabled
"
:
False
                
"
toolkit
.
telemetry
.
server
"
:
f
"
{
SERVER_URL
}
/
pings
"
                
"
telemetry
.
fog
.
test
.
localhost_port
"
:
-
1
                
"
toolkit
.
telemetry
.
initDelay
"
:
1
                
"
toolkit
.
telemetry
.
minSubsessionLength
"
:
0
                
"
datareporting
.
healthreport
.
uploadEnabled
"
:
True
                
"
datareporting
.
policy
.
dataSubmissionEnabled
"
:
True
                
"
datareporting
.
policy
.
dataSubmissionPolicyBypassNotification
"
:
True
                
"
datareporting
.
usage
.
uploadEnabled
"
:
True
                
"
toolkit
.
telemetry
.
log
.
level
"
:
"
Trace
"
                
"
toolkit
.
telemetry
.
log
.
dump
"
:
True
                
"
toolkit
.
telemetry
.
send
.
overrideOfficialCheck
"
:
True
                
"
toolkit
.
telemetry
.
testing
.
disableFuzzingDelay
"
:
True
                
"
app
.
normandy
.
enabled
"
:
False
                
"
app
.
shield
.
optoutstudies
.
enabled
"
:
False
                
"
screenshots
.
browser
.
component
.
enabled
"
:
False
            
}
        
)
        
super
(
TelemetryTestRunner
self
)
.
__init__
(
prefs
=
prefs
*
*
kwargs
)
        
self
.
testvars
[
"
server_root
"
]
=
kwargs
[
"
server_root
"
]
        
self
.
testvars
[
"
server_url
"
]
=
SERVER_URL
        
self
.
test_handlers
=
[
TelemetryTestCase
]
