import
requests
import
simplejson
as
json
from
telemetry_harness
.
testcase
import
TelemetryTestCase
class
TestPingServer
(
TelemetryTestCase
)
:
    
def
test_ping_server_received_ping
(
self
)
:
        
data
=
{
'
sender
'
:
'
John
'
'
receiver
'
:
'
Joe
'
'
message
'
:
'
We
did
it
!
'
}
        
headers
=
{
'
Content
-
type
'
:
'
application
/
json
'
'
Accept
'
:
'
text
/
plain
'
}
        
req
=
requests
.
post
(
self
.
ping_server_url
data
=
json
.
dumps
(
data
)
headers
=
headers
)
        
assert
req
.
status_code
=
=
200
        
assert
len
(
self
.
ping_list
)
=
=
1
        
assert
data
[
'
sender
'
]
=
=
self
.
ping_list
[
-
1
]
[
'
sender
'
]
