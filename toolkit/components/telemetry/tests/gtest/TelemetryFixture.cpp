#
include
"
TelemetryFixture
.
h
"
#
include
"
mozilla
/
dom
/
SimpleGlobalObject
.
h
"
using
namespace
mozilla
;
void
TelemetryTestFixture
:
:
SetUp
(
)
{
mTelemetry
=
do_GetService
(
"
mozilla
.
org
/
base
/
telemetry
;
1
"
)
;
mCleanGlobal
=
dom
:
:
SimpleGlobalObject
:
:
Create
(
dom
:
:
SimpleGlobalObject
:
:
GlobalType
:
:
BindingDetail
)
;
ASSERT_NE
(
mCleanGlobal
nullptr
)
<
<
"
SimpleGlobalObject
must
return
a
valid
global
object
.
"
;
}
AutoJSContextWithGlobal
:
:
AutoJSContextWithGlobal
(
JSObject
*
aGlobalObject
)
:
mCx
(
nullptr
)
{
MOZ_ALWAYS_TRUE
(
mJsAPI
.
Init
(
aGlobalObject
)
)
;
}
JSContext
*
AutoJSContextWithGlobal
:
:
GetJSContext
(
)
const
{
return
mJsAPI
.
cx
(
)
;
}
