ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
TelemetryEnvironment
.
jsm
"
this
)
;
function
checkString
(
aValue
)
{
return
typeof
aValue
=
=
"
string
"
&
&
aValue
!
=
"
"
;
}
function
checkNullOrString
(
aValue
)
{
if
(
aValue
)
{
return
checkString
(
aValue
)
;
}
else
if
(
aValue
=
=
=
null
)
{
return
true
;
}
return
false
;
}
function
checkNullOrBool
(
aValue
)
{
return
aValue
=
=
=
null
|
|
typeof
aValue
=
=
"
boolean
"
;
}
function
checkSystemSection
(
data
)
{
Assert
.
ok
(
"
system
"
in
data
"
There
must
be
a
system
section
in
Environment
.
"
)
;
if
(
gIsAndroid
)
{
let
deviceData
=
data
.
system
.
device
;
Assert
.
ok
(
checkNullOrString
(
deviceData
.
model
)
)
;
Assert
.
ok
(
checkNullOrString
(
deviceData
.
manufacturer
)
)
;
Assert
.
ok
(
checkNullOrString
(
deviceData
.
hardware
)
)
;
Assert
.
ok
(
checkNullOrBool
(
deviceData
.
isTablet
)
)
;
}
}
add_task
(
async
function
test_systemEnvironment
(
)
{
let
environmentData
=
TelemetryEnvironment
.
currentEnvironment
;
checkSystemSection
(
environmentData
)
;
}
)
;
