#
ifndef
mozilla_clearsitedata_h
#
define
mozilla_clearsitedata_h
#
include
"
nsIObserver
.
h
"
#
include
"
nsTArray
.
h
"
class
nsIHttpChannel
;
class
nsIPrincipal
;
class
nsIURI
;
namespace
mozilla
{
class
ClearSiteData
final
:
public
nsIObserver
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIOBSERVER
static
void
Initialize
(
)
;
static
void
Shutdown
(
)
;
private
:
ClearSiteData
(
)
;
~
ClearSiteData
(
)
;
class
PendingCleanupHolder
;
void
ClearDataFromChannel
(
nsIHttpChannel
*
aChannel
)
;
bool
IsSecureURI
(
nsIURI
*
aURI
)
const
;
uint32_t
ParseHeader
(
nsIHttpChannel
*
aChannel
nsIURI
*
aURI
)
const
;
enum
Type
{
eCache
=
0x01
eCookies
=
0x02
eStorage
=
0x04
eExecutionContexts
=
0x08
}
;
void
LogOpToConsole
(
nsIHttpChannel
*
aChannel
nsIURI
*
aURI
Type
aType
)
const
;
void
LogErrorToConsole
(
nsIHttpChannel
*
aChannel
nsIURI
*
aURI
const
nsACString
&
aUnknownType
)
const
;
void
LogToConsoleInternal
(
nsIHttpChannel
*
aChannel
nsIURI
*
aURI
const
char
*
aMsg
const
nsTArray
<
nsString
>
&
aParams
)
const
;
void
TypeToString
(
Type
aType
nsAString
&
aStr
)
const
;
void
BrowsingContextsReload
(
PendingCleanupHolder
*
aHolder
nsIPrincipal
*
aPrincipal
)
const
;
}
;
}
#
endif
