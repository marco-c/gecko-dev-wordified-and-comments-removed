"
use
strict
"
;
add_task
(
async
function
test_backgroundtask_specific_pref
(
)
{
Assert
.
equal
(
-
1
Services
.
prefs
.
getIntPref
(
"
test
.
backgroundtask_specific_pref
.
exitCode
"
-
1
)
)
;
let
exitCode
=
await
do_backgroundtask
(
"
backgroundtask_specific_pref
"
{
extraArgs
:
[
"
test
.
backgroundtask_specific_pref
.
exitCode
"
]
}
)
;
Assert
.
equal
(
79
exitCode
)
;
}
)
;
add_task
(
async
function
test_backgroundtask_browser_pref_inherited
(
)
{
Assert
.
equal
(
15
Services
.
prefs
.
getIntPref
(
"
toolkit
.
backgroundtasks
.
tests
.
browserPrefsInherited
"
-
1
)
)
;
let
exitCode
=
await
do_backgroundtask
(
"
backgroundtask_specific_pref
"
{
extraArgs
:
[
"
toolkit
.
backgroundtasks
.
tests
.
browserPrefsInherited
"
]
}
)
;
Assert
.
equal
(
15
exitCode
)
;
}
)
;
add_task
(
async
function
test_backgroundtask_gecko_pref_overridden
(
)
{
Assert
.
equal
(
16
Services
.
prefs
.
getIntPref
(
"
toolkit
.
backgroundtasks
.
tests
.
browserPrefsOverriden
"
-
1
)
)
;
let
exitCode
=
await
do_backgroundtask
(
"
backgroundtask_specific_pref
"
{
extraArgs
:
[
"
toolkit
.
backgroundtasks
.
tests
.
browserPrefsOverriden
"
]
}
)
;
Assert
.
equal
(
26
exitCode
)
;
}
)
;
add_task
(
async
function
test_backgroundtask_gecko_pref_inherited
(
)
{
Assert
.
equal
(
17
Services
.
prefs
.
getIntPref
(
"
toolkit
.
backgroundtasks
.
tests
.
geckoPrefsInherited
"
-
1
)
)
;
let
exitCode
=
await
do_backgroundtask
(
"
backgroundtask_specific_pref
"
{
extraArgs
:
[
"
toolkit
.
backgroundtasks
.
tests
.
geckoPrefsInherited
"
]
}
)
;
Assert
.
equal
(
17
exitCode
)
;
}
)
;
add_task
(
async
function
test_backgroundtask_gecko_pref_overridden
(
)
{
Assert
.
equal
(
18
Services
.
prefs
.
getIntPref
(
"
toolkit
.
backgroundtasks
.
tests
.
geckoPrefsOverriden
"
-
1
)
)
;
let
exitCode
=
await
do_backgroundtask
(
"
backgroundtask_specific_pref
"
{
extraArgs
:
[
"
toolkit
.
backgroundtasks
.
tests
.
geckoPrefsOverriden
"
]
}
)
;
Assert
.
equal
(
28
exitCode
)
;
}
)
;
