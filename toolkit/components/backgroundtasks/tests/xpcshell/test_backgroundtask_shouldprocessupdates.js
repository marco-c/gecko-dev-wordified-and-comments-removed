add_task
(
async
function
test_backgroundtask_shouldprocessupdates
(
)
{
let
exitCode
=
await
do_backgroundtask
(
"
shouldprocessupdates
"
{
extraArgs
:
[
"
-
-
test
-
process
-
updates
"
]
}
)
;
Assert
.
equal
(
80
exitCode
)
;
let
file
=
do_get_profile
(
)
;
file
.
append
(
"
customExePath
"
)
;
let
syncManager
=
Cc
[
"
mozilla
.
org
/
updates
/
update
-
sync
-
manager
;
1
"
]
.
getService
(
Ci
.
nsIUpdateSyncManager
)
;
syncManager
.
resetLock
(
file
)
;
exitCode
=
await
do_backgroundtask
(
"
shouldprocessupdates
"
)
;
Assert
.
equal
(
81
exitCode
)
;
}
)
;
