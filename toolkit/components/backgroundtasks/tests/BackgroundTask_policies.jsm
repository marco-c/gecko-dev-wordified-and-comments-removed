var
EXPORTED_SYMBOLS
=
[
"
runBackgroundTask
"
]
;
const
{
Checker
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
UpdateService
.
jsm
"
)
;
const
{
EnterprisePolicyTesting
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
testing
-
common
/
EnterprisePolicyTesting
.
sys
.
mjs
"
)
;
async
function
runBackgroundTask
(
commandLine
)
{
let
filePath
=
commandLine
.
getArgument
(
0
)
;
await
EnterprisePolicyTesting
.
setupPolicyEngineWithJson
(
filePath
)
;
let
checker
=
new
Checker
(
)
;
let
actual
=
await
checker
.
getUpdateURL
(
)
;
let
expected
=
commandLine
.
getArgument
(
1
)
;
let
exitCode
=
expected
=
=
actual
?
0
:
4
;
console
.
error
(
runBackgroundTask
:
policies
read
AppUpdateURL
'
{
actual
}
'
expected
'
{
expected
}
'
exiting
with
exitCode
{
exitCode
}
)
;
return
exitCode
;
}
