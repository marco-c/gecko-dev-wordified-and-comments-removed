"
use
strict
"
;
const
{
MLEngine
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
gre
/
actors
/
MLEngineParent
.
sys
.
mjs
"
)
;
add_task
(
async
function
test_request_lifecycle_management
(
)
{
info
(
"
Testing
request
lifecycle
management
"
)
;
const
engine
=
new
MLEngine
(
{
mlEngineParent
:
{
}
pipelineOptions
:
{
engineId
:
"
test
-
request
-
lifecycle
"
}
notificationsCallback
:
null
}
)
;
let
errorThrown
=
false
;
try
{
await
engine
.
run
(
{
args
:
[
"
test
"
]
}
)
;
}
catch
(
error
)
{
errorThrown
=
true
;
Assert
.
ok
(
error
.
message
.
includes
(
"
Port
does
not
exist
"
)
"
Should
fail
on
port
check
"
)
;
}
Assert
.
ok
(
errorThrown
"
run
(
)
without
port
should
throw
"
)
;
await
MLEngine
.
removeInstance
(
"
test
-
request
-
lifecycle
"
false
false
)
;
info
(
"
Request
lifecycle
management
works
correctly
"
)
;
}
)
;
