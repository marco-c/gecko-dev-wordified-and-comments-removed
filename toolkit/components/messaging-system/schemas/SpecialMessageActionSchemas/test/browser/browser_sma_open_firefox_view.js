"
use
strict
"
;
const
{
assertFirefoxViewTab
closeFirefoxViewTab
init
:
FirefoxViewTestUtilsInit
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
testing
-
common
/
FirefoxViewTestUtils
.
sys
.
mjs
"
)
;
FirefoxViewTestUtilsInit
(
this
)
;
add_setup
(
async
(
)
=
>
{
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
browser
.
tabs
.
firefox
-
view
"
true
]
]
}
)
;
CustomizableUI
.
addWidgetToArea
(
"
firefox
-
view
-
button
"
CustomizableUI
.
AREA_TABSTRIP
0
)
;
registerCleanupFunction
(
async
(
)
=
>
{
CustomizableUI
.
removeWidgetFromArea
(
"
firefox
-
view
-
button
"
)
;
await
SpecialPowers
.
popPrefEnv
(
)
;
}
)
;
}
)
;
add_task
(
async
function
test_open_firefox_view
(
)
{
let
newTabOpened
=
BrowserTestUtils
.
waitForEvent
(
gBrowser
.
tabContainer
"
TabOpen
"
)
;
await
SMATestUtils
.
executeAndValidateAction
(
{
type
:
"
OPEN_FIREFOX_VIEW
"
}
)
;
await
newTabOpened
;
assertFirefoxViewTab
(
window
)
;
closeFirefoxViewTab
(
window
)
;
}
)
;
