var
dir
=
do_get_profile
(
)
;
dir
.
append
(
"
temp
"
)
;
dir
.
create
(
dir
.
DIRECTORY_TYPE
-
1
)
;
var
path
=
dir
.
path
+
"
/
"
;
var
file
=
dir
.
clone
(
)
;
file
.
append
(
"
test_file
"
)
;
file
.
create
(
file
.
NORMAL_FILE_TYPE
-
1
)
;
file
=
dir
.
clone
(
)
;
file
.
append
(
"
other_file
"
)
;
file
.
create
(
file
.
NORMAL_FILE_TYPE
-
1
)
;
dir
.
append
(
"
test_dir
"
)
;
dir
.
create
(
dir
.
DIRECTORY_TYPE
-
1
)
;
var
gListener
=
{
onSearchResult
(
aSearch
aResult
)
{
Assert
.
equal
(
aResult
.
searchString
"
test
"
)
;
Assert
.
equal
(
aResult
.
searchResult
aResult
.
RESULT_SUCCESS
)
;
Assert
.
equal
(
aResult
.
matchCount
2
)
;
Assert
.
equal
(
aResult
.
getValueAt
(
0
)
"
test_dir
"
)
;
Assert
.
equal
(
aResult
.
getStyleAt
(
0
)
"
directory
"
)
;
Assert
.
equal
(
aResult
.
getValueAt
(
1
)
"
test_file
"
)
;
Assert
.
equal
(
aResult
.
getStyleAt
(
1
)
"
file
"
)
;
}
}
;
function
run_test
(
)
{
Components
.
classes
[
"
mozilla
.
org
/
autocomplete
/
search
;
1
?
name
=
file
"
]
.
getService
(
Components
.
interfaces
.
nsIAutoCompleteSearch
)
.
startSearch
(
"
test
"
path
null
gListener
)
;
}
