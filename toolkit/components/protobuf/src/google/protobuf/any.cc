#
include
<
google
/
protobuf
/
any
.
h
>
#
include
<
google
/
protobuf
/
arenastring
.
h
>
#
include
<
google
/
protobuf
/
descriptor
.
h
>
#
include
<
google
/
protobuf
/
generated_message_util
.
h
>
#
include
<
google
/
protobuf
/
message
.
h
>
#
include
<
google
/
protobuf
/
port_def
.
inc
>
namespace
google
{
namespace
protobuf
{
namespace
internal
{
bool
AnyMetadata
:
:
PackFrom
(
Arena
*
arena
const
Message
&
message
)
{
return
PackFrom
(
arena
message
kTypeGoogleApisComPrefix
)
;
}
bool
AnyMetadata
:
:
PackFrom
(
Arena
*
arena
const
Message
&
message
StringPiece
type_url_prefix
)
{
type_url_
-
>
Set
(
GetTypeUrl
(
message
.
GetDescriptor
(
)
-
>
full_name
(
)
type_url_prefix
)
arena
)
;
return
message
.
SerializeToString
(
value_
-
>
Mutable
(
arena
)
)
;
}
bool
AnyMetadata
:
:
UnpackTo
(
Message
*
message
)
const
{
if
(
!
InternalIs
(
message
-
>
GetDescriptor
(
)
-
>
full_name
(
)
)
)
{
return
false
;
}
return
message
-
>
ParseFromString
(
value_
-
>
Get
(
)
)
;
}
bool
GetAnyFieldDescriptors
(
const
Message
&
message
const
FieldDescriptor
*
*
type_url_field
const
FieldDescriptor
*
*
value_field
)
{
const
Descriptor
*
descriptor
=
message
.
GetDescriptor
(
)
;
if
(
descriptor
-
>
full_name
(
)
!
=
kAnyFullTypeName
)
{
return
false
;
}
*
type_url_field
=
descriptor
-
>
FindFieldByNumber
(
1
)
;
*
value_field
=
descriptor
-
>
FindFieldByNumber
(
2
)
;
return
(
*
type_url_field
!
=
nullptr
&
&
(
*
type_url_field
)
-
>
type
(
)
=
=
FieldDescriptor
:
:
TYPE_STRING
&
&
*
value_field
!
=
nullptr
&
&
(
*
value_field
)
-
>
type
(
)
=
=
FieldDescriptor
:
:
TYPE_BYTES
)
;
}
}
}
}
#
include
<
google
/
protobuf
/
port_undef
.
inc
>
