#
ifndef
GOOGLE_PROTOBUF_UTIL_CONVERTER_PROTOSTREAM_OBJECTSOURCE_H__
#
define
GOOGLE_PROTOBUF_UTIL_CONVERTER_PROTOSTREAM_OBJECTSOURCE_H__
#
include
<
functional
>
#
include
<
google
/
protobuf
/
stubs
/
hash
.
h
>
#
include
<
string
>
#
include
<
google
/
protobuf
/
stubs
/
common
.
h
>
#
include
<
google
/
protobuf
/
type
.
pb
.
h
>
#
include
<
google
/
protobuf
/
util
/
internal
/
object_source
.
h
>
#
include
<
google
/
protobuf
/
util
/
internal
/
object_writer
.
h
>
#
include
<
google
/
protobuf
/
util
/
internal
/
type_info
.
h
>
#
include
<
google
/
protobuf
/
util
/
type_resolver
.
h
>
#
include
<
google
/
protobuf
/
stubs
/
stringpiece
.
h
>
#
include
<
google
/
protobuf
/
stubs
/
status
.
h
>
#
include
<
google
/
protobuf
/
stubs
/
statusor
.
h
>
namespace
google
{
namespace
protobuf
{
class
Field
;
class
Type
;
}
namespace
protobuf
{
namespace
util
{
namespace
converter
{
class
TypeInfo
;
class
LIBPROTOBUF_EXPORT
ProtoStreamObjectSource
:
public
ObjectSource
{
public
:
ProtoStreamObjectSource
(
google
:
:
protobuf
:
:
io
:
:
CodedInputStream
*
stream
TypeResolver
*
type_resolver
const
google
:
:
protobuf
:
:
Type
&
type
)
;
virtual
~
ProtoStreamObjectSource
(
)
;
virtual
util
:
:
Status
NamedWriteTo
(
StringPiece
name
ObjectWriter
*
ow
)
const
;
void
set_use_lower_camel_for_enums
(
bool
value
)
{
use_lower_camel_for_enums_
=
value
;
}
void
set_use_ints_for_enums
(
bool
value
)
{
use_ints_for_enums_
=
value
;
}
void
set_preserve_proto_field_names
(
bool
value
)
{
preserve_proto_field_names_
=
value
;
}
void
set_max_recursion_depth
(
int
max_depth
)
{
max_recursion_depth_
=
max_depth
;
}
protected
:
virtual
util
:
:
Status
WriteMessage
(
const
google
:
:
protobuf
:
:
Type
&
descriptor
StringPiece
name
const
uint32
end_tag
bool
include_start_and_end
ObjectWriter
*
ow
)
const
;
virtual
util
:
:
StatusOr
<
uint32
>
RenderList
(
const
google
:
:
protobuf
:
:
Field
*
field
StringPiece
name
uint32
list_tag
ObjectWriter
*
ow
)
const
;
const
google
:
:
protobuf
:
:
Field
*
FindAndVerifyField
(
const
google
:
:
protobuf
:
:
Type
&
type
uint32
tag
)
const
;
util
:
:
Status
RenderField
(
const
google
:
:
protobuf
:
:
Field
*
field
StringPiece
field_name
ObjectWriter
*
ow
)
const
;
const
string
ReadFieldValueAsString
(
const
google
:
:
protobuf
:
:
Field
&
field
)
const
;
private
:
ProtoStreamObjectSource
(
google
:
:
protobuf
:
:
io
:
:
CodedInputStream
*
stream
const
TypeInfo
*
typeinfo
const
google
:
:
protobuf
:
:
Type
&
type
)
;
typedef
util
:
:
Status
(
*
TypeRenderer
)
(
const
ProtoStreamObjectSource
*
const
google
:
:
protobuf
:
:
Type
&
StringPiece
ObjectWriter
*
)
;
util
:
:
StatusOr
<
uint32
>
RenderMap
(
const
google
:
:
protobuf
:
:
Field
*
field
StringPiece
name
uint32
list_tag
ObjectWriter
*
ow
)
const
;
util
:
:
Status
RenderPacked
(
const
google
:
:
protobuf
:
:
Field
*
field
ObjectWriter
*
ow
)
const
;
static
util
:
:
Status
RenderTimestamp
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderDuration
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderDouble
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderFloat
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderInt64
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderUInt64
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderInt32
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderUInt32
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderBool
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderString
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderBytes
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderStruct
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderStructValue
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderStructListValue
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderAny
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
util
:
:
Status
RenderFieldMask
(
const
ProtoStreamObjectSource
*
os
const
google
:
:
protobuf
:
:
Type
&
type
StringPiece
name
ObjectWriter
*
ow
)
;
static
hash_map
<
string
TypeRenderer
>
*
renderers_
;
static
void
InitRendererMap
(
)
;
static
void
DeleteRendererMap
(
)
;
static
TypeRenderer
*
FindTypeRenderer
(
const
string
&
type_url
)
;
util
:
:
Status
RenderNonMessageField
(
const
google
:
:
protobuf
:
:
Field
*
field
StringPiece
field_name
ObjectWriter
*
ow
)
const
;
bool
IsMap
(
const
google
:
:
protobuf
:
:
Field
&
field
)
const
;
std
:
:
pair
<
int64
int32
>
ReadSecondsAndNanos
(
const
google
:
:
protobuf
:
:
Type
&
type
)
const
;
util
:
:
Status
IncrementRecursionDepth
(
StringPiece
type_name
StringPiece
field_name
)
const
;
google
:
:
protobuf
:
:
io
:
:
CodedInputStream
*
stream_
;
const
TypeInfo
*
typeinfo_
;
bool
own_typeinfo_
;
const
google
:
:
protobuf
:
:
Type
&
type_
;
bool
use_lower_camel_for_enums_
;
bool
use_ints_for_enums_
;
bool
preserve_proto_field_names_
;
mutable
int
recursion_depth_
;
int
max_recursion_depth_
;
bool
render_unknown_fields_
;
bool
render_unknown_enum_values_
;
bool
add_trailing_zeros_for_timestamp_and_duration_
;
GOOGLE_DISALLOW_IMPLICIT_CONSTRUCTORS
(
ProtoStreamObjectSource
)
;
}
;
}
}
}
}
#
endif
