var
http
=
require
(
"
http
"
)
;
const
PORT
=
8080
;
const
loggedOutLink
=
"
<
html
>
<
body
>
<
a
href
=
'
/
set
'
>
login
<
/
a
>
<
/
body
>
<
/
html
>
"
;
const
loggedInLink
=
"
<
html
>
<
body
>
<
a
href
=
'
/
reset
'
>
logout
<
/
a
>
<
/
body
>
<
/
html
>
"
;
const
OUT
=
0
;
const
IN
=
1
;
var
state
=
OUT
;
function
handleRequest
(
request
response
)
{
if
(
request
.
url
=
=
"
/
reset
"
)
{
state
=
OUT
;
response
.
writeHead
(
302
{
location
:
"
/
"
}
)
;
response
.
end
(
)
;
}
else
if
(
request
.
url
=
=
"
/
set
"
)
{
state
=
IN
;
response
.
writeHead
(
302
{
location
:
"
/
test
"
}
)
;
response
.
end
(
)
;
}
else
if
(
request
.
url
=
=
"
/
test
"
)
{
if
(
state
=
=
IN
)
{
response
.
setHeader
(
"
Content
-
Type
"
"
text
/
html
"
)
;
response
.
end
(
<
meta
http
-
equiv
=
"
refresh
"
content
=
"
0
;
url
=
https
:
/
/
support
.
mozilla
.
org
/
kb
/
captive
-
portal
"
/
>
)
;
return
;
}
response
.
writeHead
(
302
{
location
:
"
/
"
}
)
;
response
.
end
(
)
;
}
else
{
response
.
setHeader
(
"
Content
-
Type
"
"
text
/
html
"
)
;
response
.
end
(
state
=
=
IN
?
loggedInLink
:
loggedOutLink
)
;
}
}
var
server
=
http
.
createServer
(
handleRequest
)
;
server
.
listen
(
PORT
function
(
)
{
console
.
log
(
"
Server
listening
on
:
http
:
/
/
localhost
:
%
s
"
PORT
)
;
}
)
;
