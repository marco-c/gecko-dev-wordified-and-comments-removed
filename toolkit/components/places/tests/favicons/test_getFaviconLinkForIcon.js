add_task
(
async
function
test_basic
(
)
{
for
(
let
protocol
of
[
"
http
:
/
/
"
"
https
:
/
/
"
]
)
{
let
url
=
PlacesUtils
.
favicons
.
getFaviconLinkForIcon
(
Services
.
io
.
newURI
(
protocol
+
"
test
/
test
.
png
"
)
)
.
spec
;
Assert
.
equal
(
url
"
cached
-
favicon
:
"
+
protocol
+
"
test
/
test
.
png
"
)
;
}
}
)
;
add_task
(
async
function
test_directRequestProtocols
(
)
{
for
(
let
protocol
of
[
"
about
:
"
"
cached
-
favicon
:
"
"
chrome
:
/
/
"
"
data
:
"
"
file
:
/
/
/
"
"
moz
-
page
-
thumb
:
/
/
"
"
page
-
icon
:
"
"
resource
:
/
/
"
]
)
{
let
url
=
PlacesUtils
.
favicons
.
getFaviconLinkForIcon
(
Services
.
io
.
newURI
(
protocol
+
"
test
/
test
.
png
"
)
)
.
spec
;
Assert
.
equal
(
url
protocol
+
"
test
/
test
.
png
"
)
;
}
}
)
;
