#
ifndef
mock_Link_h__
#
define
mock_Link_h__
#
include
"
mozilla
/
MemoryReporting
.
h
"
#
include
"
mozilla
/
dom
/
Link
.
h
"
class
mock_Link
:
public
mozilla
:
:
dom
:
:
Link
{
public
:
NS_DECL_ISUPPORTS
explicit
mock_Link
(
void
(
*
aHandlerFunction
)
(
nsLinkState
)
bool
aRunNextTest
=
true
)
:
mozilla
:
:
dom
:
:
Link
(
)
mHandler
(
aHandlerFunction
)
mRunNextTest
(
aRunNextTest
)
{
mDeathGrip
=
this
;
}
virtual
void
SetLinkState
(
nsLinkState
aState
)
override
{
mHandler
(
aState
)
;
mDeathGrip
=
nullptr
;
}
virtual
size_t
SizeOfExcludingThis
(
mozilla
:
:
SizeOfState
&
aState
)
const
override
{
return
0
;
}
void
NodeInfoChanged
(
nsIDocument
*
aOldDoc
)
final
{
}
protected
:
~
mock_Link
(
)
{
if
(
mRunNextTest
)
{
run_next_test
(
)
;
}
}
private
:
void
(
*
mHandler
)
(
nsLinkState
)
;
bool
mRunNextTest
;
RefPtr
<
Link
>
mDeathGrip
;
}
;
NS_IMPL_ISUPPORTS
(
mock_Link
mozilla
:
:
dom
:
:
Link
)
#
endif
