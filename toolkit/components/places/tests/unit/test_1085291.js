add_task
(
async
function
(
)
{
let
root
=
PlacesUtils
.
getFolderContents
(
PlacesUtils
.
bookmarks
.
toolbarGuid
)
.
root
;
async
function
insertAndTest
(
bmInfo
)
{
bmInfo
=
await
PlacesUtils
.
bookmarks
.
insert
(
bmInfo
)
;
let
node
=
root
.
getChild
(
root
.
childCount
-
1
)
;
Assert
.
equal
(
node
.
bookmarkGuid
bmInfo
.
guid
)
;
Assert
.
equal
(
node
.
dateAdded
bmInfo
.
dateAdded
*
1000
)
;
Assert
.
equal
(
node
.
lastModified
bmInfo
.
lastModified
*
1000
)
;
}
await
insertAndTest
(
{
parentGuid
:
root
.
bookmarkGuid
type
:
PlacesUtils
.
bookmarks
.
TYPE_BOOKMARK
title
:
"
Test
Bookmark
"
url
:
"
http
:
/
/
test
.
url
.
tld
"
}
)
;
await
insertAndTest
(
{
parentGuid
:
root
.
bookmarkGuid
type
:
PlacesUtils
.
bookmarks
.
TYPE_BOOKMARK
title
:
"
Test
Query
"
url
:
place
:
parent
=
{
PlacesUtils
.
bookmarks
.
menuGuid
}
}
)
;
await
insertAndTest
(
{
parentGuid
:
root
.
bookmarkGuid
type
:
PlacesUtils
.
bookmarks
.
TYPE_FOLDER
title
:
"
Test
Folder
"
}
)
;
await
insertAndTest
(
{
parentGuid
:
root
.
bookmarkGuid
type
:
PlacesUtils
.
bookmarks
.
TYPE_SEPARATOR
}
)
;
root
.
containerOpen
=
false
;
}
)
;
