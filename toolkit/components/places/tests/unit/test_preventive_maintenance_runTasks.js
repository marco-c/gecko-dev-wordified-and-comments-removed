Components
.
utils
.
import
(
"
resource
:
/
/
gre
/
modules
/
PlacesDBUtils
.
jsm
"
)
;
add_task
(
async
function
(
)
{
let
tasksStatusMap
=
await
PlacesDBUtils
.
runTasks
(
[
PlacesDBUtils
.
reindex
]
)
;
let
numberOfTasksRun
=
tasksStatusMap
.
size
;
let
successfulTasks
=
[
]
;
let
failedTasks
=
[
]
;
tasksStatusMap
.
forEach
(
val
=
>
{
if
(
val
.
succeeded
)
{
successfulTasks
.
push
(
val
)
;
}
else
{
failedTasks
.
push
(
val
)
;
}
}
)
;
Assert
.
equal
(
numberOfTasksRun
1
"
Check
that
we
have
run
all
tasks
.
"
)
;
Assert
.
equal
(
successfulTasks
.
length
1
"
Check
that
we
have
run
all
tasks
successfully
"
)
;
Assert
.
equal
(
failedTasks
.
length
0
"
Check
that
no
task
is
failing
"
)
;
}
)
;
