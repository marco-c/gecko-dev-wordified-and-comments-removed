Components
.
utils
.
import
(
"
resource
:
/
/
gre
/
modules
/
XPCOMUtils
.
jsm
"
)
;
var
hs
=
Cc
[
"
mozilla
.
org
/
browser
/
nav
-
history
-
service
;
1
"
]
.
getService
(
Ci
.
nsINavHistoryService
)
;
function
callback
(
aService
)
{
this
.
callCount
=
0
;
this
.
service
=
aService
;
}
callback
.
prototype
=
{
runBatched
(
aUserData
)
{
this
.
callCount
+
+
;
if
(
this
.
callCount
=
=
1
)
{
this
.
service
.
runInBatchMode
(
this
null
)
;
return
;
}
Assert
.
equal
(
this
.
callCount
2
)
;
do_test_finished
(
)
;
}
QueryInterface
:
XPCOMUtils
.
generateQI
(
[
Ci
.
nsINavHistoryBatchCallback
]
)
}
;
function
run_test
(
)
{
do_test_pending
(
)
;
hs
.
runInBatchMode
(
new
callback
(
hs
)
null
)
;
do_test_pending
(
)
;
PlacesUtils
.
bookmarks
.
runInBatchMode
(
new
callback
(
PlacesUtils
.
bookmarks
)
null
)
;
}
