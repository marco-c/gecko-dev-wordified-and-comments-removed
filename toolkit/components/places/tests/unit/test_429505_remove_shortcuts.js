add_task
(
async
function
test_query_with_remove_shortcut
(
)
{
let
folder
=
await
PlacesUtils
.
bookmarks
.
insert
(
{
parentGuid
:
PlacesUtils
.
bookmarks
.
toolbarGuid
title
:
"
"
type
:
PlacesUtils
.
bookmarks
.
TYPE_FOLDER
}
)
;
let
folderId
=
await
PlacesUtils
.
promiseItemId
(
folder
.
guid
)
;
let
query
=
await
PlacesUtils
.
bookmarks
.
insert
(
{
parentGuid
:
PlacesUtils
.
bookmarks
.
toolbarGuid
title
:
"
"
url
:
place
:
folder
=
{
folderId
}
}
)
;
var
root
=
PlacesUtils
.
getFolderContents
(
PlacesUtils
.
toolbarFolderId
false
true
)
.
root
;
var
oldCount
=
root
.
childCount
;
await
PlacesUtils
.
bookmarks
.
remove
(
query
.
guid
)
;
do_check_eq
(
root
.
childCount
oldCount
-
1
)
;
root
.
containerOpen
=
false
;
await
PlacesTestUtils
.
promiseAsyncUpdates
(
)
;
}
)
;
