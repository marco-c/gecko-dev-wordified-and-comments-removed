#
define
NOTIFY_OBSERVERS
(
canFire
array
type
method
)
\
PR_BEGIN_MACRO
\
if
(
canFire
)
{
\
ENUMERATE_WEAKARRAY
(
array
type
method
)
\
}
\
PR_END_MACRO
;
#
define
NOTIFY_BOOKMARKS_OBSERVERS
(
canFire
array
skipIf
method
)
\
PR_BEGIN_MACRO
\
if
(
canFire
)
{
\
for
(
uint32_t
idx
=
0
;
idx
<
array
.
Length
(
)
;
+
+
idx
)
{
\
const
nsCOMPtr
<
nsINavBookmarkObserver
>
&
e
=
\
array
.
ElementAt
(
idx
)
.
GetValue
(
)
;
\
if
(
e
)
{
\
if
(
skipIf
(
e
)
)
continue
;
\
e
-
>
method
;
\
}
\
}
\
}
\
PR_END_MACRO
;
#
define
PLACES_FACTORY_SINGLETON_IMPLEMENTATION
(
_className
_sInstance
)
\
_className
*
_className
:
:
_sInstance
=
nullptr
;
\
\
already_AddRefed
<
_className
>
_className
:
:
GetSingleton
(
)
{
\
if
(
_sInstance
)
{
\
RefPtr
<
_className
>
ret
=
_sInstance
;
\
return
ret
.
forget
(
)
;
\
}
\
_sInstance
=
new
_className
(
)
;
\
RefPtr
<
_className
>
ret
=
_sInstance
;
\
if
(
NS_FAILED
(
_sInstance
-
>
Init
(
)
)
)
{
\
/
*
Null
out
ret
before
_sInstance
so
the
destructor
doesn
'
t
assert
*
/
\
ret
=
nullptr
;
\
_sInstance
=
nullptr
;
\
return
nullptr
;
\
}
\
return
ret
.
forget
(
)
;
\
}
