"
use
strict
"
;
const
{
classes
:
Cc
interfaces
:
Ci
utils
:
Cu
}
=
Components
;
XPCOMUtils
.
defineLazyModuleGetter
(
this
"
Services
"
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
extensions
.
on
(
"
startup
"
(
type
extension
)
=
>
{
if
(
extension
.
hasPermission
(
"
geolocation
"
)
&
&
Services
.
perms
.
testPermission
(
extension
.
principal
.
URI
"
geo
"
)
=
=
Services
.
perms
.
UNKNOWN_ACTION
)
{
Services
.
perms
.
add
(
extension
.
principal
.
URI
"
geo
"
Services
.
perms
.
ALLOW_ACTION
Services
.
perms
.
EXPIRE_SESSION
)
;
}
}
)
;
extensions
.
on
(
"
shutdown
"
(
type
extension
)
=
>
{
if
(
extension
.
hasPermission
(
"
geolocation
"
)
&
&
Services
.
perms
.
testPermission
(
extension
.
principal
.
URI
"
geo
"
)
=
=
Services
.
perms
.
ALLOW_ACTION
)
{
Services
.
perms
.
remove
(
extension
.
principal
.
URI
"
geo
"
)
;
}
}
)
;
