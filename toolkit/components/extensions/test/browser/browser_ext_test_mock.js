"
use
strict
"
;
async
function
checkExtensionStartupAndUnload
(
ext
)
{
await
ext
.
startup
(
)
;
Assert
.
ok
(
ext
.
id
"
Extension
ID
should
be
available
"
)
;
Assert
.
ok
(
ext
.
uuid
"
Extension
UUID
should
be
available
"
)
;
await
ext
.
unload
(
)
;
Assert
.
ok
(
ext
.
uuid
"
Extension
UUID
exists
after
unload
"
)
;
}
add_task
(
async
function
test_MockExtension
(
)
{
let
ext
=
ExtensionTestUtils
.
loadExtension
(
{
useAddonManager
:
"
permanent
"
manifest
:
{
applications
:
{
gecko
:
{
id
:
"
permanent
-
mock
-
extension
"
}
}
}
}
)
;
Assert
.
ok
(
!
ext
.
id
"
Extension
ID
is
initially
unavailable
"
)
;
Assert
.
ok
(
!
ext
.
uuid
"
Extension
UUID
is
initially
unavailable
"
)
;
await
checkExtensionStartupAndUnload
(
ext
)
;
Assert
.
ok
(
ext
.
id
"
Extension
ID
exists
after
unload
"
)
;
}
)
;
add_task
(
async
function
test_generated_Extension
(
)
{
let
ext
=
ExtensionTestUtils
.
loadExtension
(
{
manifest
:
{
}
}
)
;
Assert
.
ok
(
!
ext
.
id
"
Extension
ID
is
initially
unavailable
"
)
;
Assert
.
ok
(
!
ext
.
uuid
"
Extension
UUID
is
initially
unavailable
"
)
;
await
checkExtensionStartupAndUnload
(
ext
)
;
Assert
.
ok
(
ext
.
id
"
Extension
ID
exists
after
unload
"
)
;
}
)
;
