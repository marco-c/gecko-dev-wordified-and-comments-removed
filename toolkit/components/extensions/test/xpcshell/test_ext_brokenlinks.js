"
use
strict
"
;
add_task
(
async
function
testXPIMissingBackGroundScript
(
)
{
let
extension
=
ExtensionTestUtils
.
loadExtension
(
{
manifest
:
{
background
:
{
scripts
:
[
"
missing
.
js
"
]
persistent
:
false
}
}
}
)
;
await
extension
.
startup
(
)
;
await
extension
.
unload
(
)
;
ok
(
true
"
load
/
unload
completed
without
timing
out
"
)
;
}
)
;
add_task
(
async
function
testXPIMissingPageScript
(
)
{
async
function
pageScript
(
)
{
browser
.
test
.
sendMessage
(
"
pageReady
"
)
;
}
let
extension
=
ExtensionTestUtils
.
loadExtension
(
{
background
(
)
{
browser
.
test
.
sendMessage
(
"
ready
"
browser
.
runtime
.
getURL
(
"
page
.
html
"
)
)
;
}
files
:
{
"
page
.
html
"
:
<
html
>
<
head
>
<
script
src
=
"
missing
.
js
"
>
<
/
script
>
<
script
src
=
"
page
.
js
"
>
<
/
script
>
<
/
head
>
<
/
html
>
"
page
.
js
"
:
pageScript
}
}
)
;
await
extension
.
startup
(
)
;
let
url
=
await
extension
.
awaitMessage
(
"
ready
"
)
;
let
contentPage
=
await
ExtensionTestUtils
.
loadContentPage
(
url
)
;
await
extension
.
awaitMessage
(
"
pageReady
"
)
;
await
extension
.
unload
(
)
;
await
contentPage
.
close
(
)
;
ok
(
true
"
load
/
unload
completed
without
timing
out
"
)
;
}
)
;
