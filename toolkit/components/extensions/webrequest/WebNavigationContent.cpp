#
include
"
mozilla
/
extensions
/
WebNavigationContent
.
h
"
#
include
"
mozilla
/
ClearOnShutdown
.
h
"
#
include
"
mozilla
/
dom
/
Event
.
h
"
#
include
"
mozilla
/
dom
/
EventTarget
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
mozilla
/
Services
.
h
"
#
include
"
nsCRT
.
h
"
#
include
"
nsIObserverService
.
h
"
#
include
"
nsQueryObject
.
h
"
namespace
mozilla
{
namespace
extensions
{
WebNavigationContent
:
:
WebNavigationContent
(
)
{
}
already_AddRefed
<
WebNavigationContent
>
WebNavigationContent
:
:
GetSingleton
(
)
{
static
RefPtr
<
WebNavigationContent
>
sSingleton
;
if
(
!
sSingleton
)
{
sSingleton
=
new
WebNavigationContent
(
)
;
sSingleton
-
>
Init
(
)
;
ClearOnShutdown
(
&
sSingleton
)
;
}
return
do_AddRef
(
sSingleton
)
;
}
NS_IMPL_ISUPPORTS
(
WebNavigationContent
nsIObserver
)
void
WebNavigationContent
:
:
Init
(
)
{
nsCOMPtr
<
nsIObserverService
>
obs
=
services
:
:
GetObserverService
(
)
;
obs
-
>
AddObserver
(
this
"
chrome
-
event
-
target
-
created
"
false
)
;
obs
-
>
AddObserver
(
this
"
webNavigation
-
createdNavigationTarget
-
from
-
js
"
false
)
;
}
NS_IMETHODIMP
WebNavigationContent
:
:
Observe
(
nsISupports
*
aSubject
char
const
*
aTopic
char16_t
const
*
aData
)
{
if
(
!
nsCRT
:
:
strcmp
(
aTopic
"
chrome
-
event
-
target
-
created
"
)
)
{
if
(
RefPtr
<
dom
:
:
EventTarget
>
eventTarget
=
do_QueryObject
(
aSubject
)
)
{
AttachListeners
(
eventTarget
)
;
}
}
else
if
(
!
nsCRT
:
:
strcmp
(
aTopic
"
webNavigation
-
createdNavigationTarget
-
from
-
js
"
)
)
{
}
return
NS_OK
;
}
void
WebNavigationContent
:
:
AttachListeners
(
mozilla
:
:
dom
:
:
EventTarget
*
aEventTarget
)
{
}
NS_IMETHODIMP
WebNavigationContent
:
:
HandleEvent
(
dom
:
:
Event
*
aEvent
)
{
return
NS_OK
;
}
}
}
