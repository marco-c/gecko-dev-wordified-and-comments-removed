#
ifndef
nsWebBrowser_h__
#
define
nsWebBrowser_h__
#
include
"
nsDocShellTreeOwner
.
h
"
#
include
"
nsAutoPtr
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsCycleCollectionParticipant
.
h
"
#
include
"
nsIBaseWindow
.
h
"
#
include
"
nsIDocShell
.
h
"
#
include
"
nsIDocShellTreeItem
.
h
"
#
include
"
nsIInterfaceRequestor
.
h
"
#
include
"
nsIInterfaceRequestorUtils
.
h
"
#
include
"
nsIScrollable
.
h
"
#
include
"
nsISHistory
.
h
"
#
include
"
nsIWidget
.
h
"
#
include
"
nsIWebProgress
.
h
"
#
include
"
nsISecureBrowserUI
.
h
"
#
include
"
nsIWebBrowser
.
h
"
#
include
"
nsIWebNavigation
.
h
"
#
include
"
nsIWebBrowserPersist
.
h
"
#
include
"
nsIWindowWatcher
.
h
"
#
include
"
nsIPrintSettings
.
h
"
#
include
"
nsIWidgetListener
.
h
"
#
include
"
mozilla
/
BasePrincipal
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
nsIWeakReferenceUtils
.
h
"
class
nsWebBrowserInitInfo
{
public
:
int32_t
x
;
int32_t
y
;
int32_t
cx
;
int32_t
cy
;
bool
visible
;
nsString
name
;
}
;
#
define
NS_WEBBROWSER_CID
\
{
\
0xcda5863a
0xaa9c
0x411e
{
\
0xbe
0x49
0xea
0x0d
0x52
0x5a
0xb4
0xb5
\
}
\
}
class
mozIDOMWindowProxy
;
class
nsWebBrowser
final
:
public
nsIWebBrowser
public
nsIWebNavigation
public
nsIDocShellTreeItem
public
nsIBaseWindow
public
nsIScrollable
public
nsIInterfaceRequestor
public
nsIWebBrowserPersist
public
nsIWebProgressListener
public
nsSupportsWeakReference
{
friend
class
nsDocShellTreeOwner
;
public
:
class
WidgetListenerDelegate
:
public
nsIWidgetListener
{
public
:
explicit
WidgetListenerDelegate
(
nsWebBrowser
*
aWebBrowser
)
:
mWebBrowser
(
aWebBrowser
)
{
}
MOZ_CAN_RUN_SCRIPT_BOUNDARY
virtual
void
WindowActivated
(
)
override
;
MOZ_CAN_RUN_SCRIPT_BOUNDARY
virtual
void
WindowDeactivated
(
)
override
;
MOZ_CAN_RUN_SCRIPT_BOUNDARY
virtual
bool
PaintWindow
(
nsIWidget
*
aWidget
mozilla
:
:
LayoutDeviceIntRegion
aRegion
)
override
;
private
:
nsWebBrowser
*
mWebBrowser
;
}
;
NS_DECL_CYCLE_COLLECTING_ISUPPORTS
NS_DECL_CYCLE_COLLECTION_CLASS_AMBIGUOUS
(
nsWebBrowser
nsIWebBrowser
)
NS_DECL_NSIBASEWINDOW
NS_DECL_NSIDOCSHELLTREEITEM
NS_DECL_NSIINTERFACEREQUESTOR
NS_DECL_NSISCROLLABLE
NS_DECL_NSIWEBBROWSER
NS_DECL_NSIWEBNAVIGATION
NS_DECL_NSIWEBBROWSERPERSIST
NS_DECL_NSICANCELABLE
NS_DECL_NSIWEBPROGRESSLISTENER
void
SetAllowDNSPrefetch
(
bool
aAllowPrefetch
)
;
void
FocusActivate
(
)
;
void
FocusDeactivate
(
)
;
static
already_AddRefed
<
nsWebBrowser
>
Create
(
nsIWebBrowserChrome
*
aContainerWindow
nsIWidget
*
aParentWidget
const
mozilla
:
:
OriginAttributes
&
aOriginAttributes
mozilla
:
:
dom
:
:
BrowsingContext
*
aBrowsingContext
bool
aDisableHistory
=
false
)
;
protected
:
virtual
~
nsWebBrowser
(
)
;
NS_IMETHOD
InternalDestroy
(
)
;
NS_IMETHOD
SetDocShell
(
nsIDocShell
*
aDocShell
)
;
NS_IMETHOD
EnsureDocShellTreeOwner
(
)
;
NS_IMETHOD
BindListener
(
nsISupports
*
aListener
const
nsIID
&
aIID
)
;
NS_IMETHOD
EnableGlobalHistory
(
bool
aEnable
)
;
nsIWidget
*
EnsureWidget
(
)
;
MOZ_CAN_RUN_SCRIPT
void
WindowActivated
(
)
;
MOZ_CAN_RUN_SCRIPT
void
WindowDeactivated
(
)
;
MOZ_CAN_RUN_SCRIPT
bool
PaintWindow
(
nsIWidget
*
aWidget
mozilla
:
:
LayoutDeviceIntRegion
aRegion
)
;
explicit
nsWebBrowser
(
int
aItemType
)
;
protected
:
RefPtr
<
nsDocShellTreeOwner
>
mDocShellTreeOwner
;
nsCOMPtr
<
nsIDocShell
>
mDocShell
;
nsCOMPtr
<
nsIInterfaceRequestor
>
mDocShellAsReq
;
nsCOMPtr
<
nsIBaseWindow
>
mDocShellAsWin
;
nsCOMPtr
<
nsIWebNavigation
>
mDocShellAsNav
;
nsCOMPtr
<
nsIScrollable
>
mDocShellAsScrollable
;
mozilla
:
:
OriginAttributes
mOriginAttributes
;
nsCOMPtr
<
nsIWidget
>
mInternalWidget
;
nsCOMPtr
<
nsIWindowWatcher
>
mWWatch
;
const
uint32_t
mContentType
;
bool
mActivating
;
bool
mShouldEnableHistory
;
bool
mIsActive
;
nativeWindow
mParentNativeWindow
;
nsIWebProgressListener
*
mProgressListener
;
nsCOMPtr
<
nsIWebProgress
>
mWebProgress
;
nsCOMPtr
<
nsIPrintSettings
>
mPrintSettings
;
WidgetListenerDelegate
mWidgetListenerDelegate
;
nscolor
mBackgroundColor
;
nsCOMPtr
<
nsIWebBrowserPersist
>
mPersist
;
uint32_t
mPersistCurrentState
;
nsresult
mPersistResult
;
uint32_t
mPersistFlags
;
nsIWidget
*
mParentWidget
;
}
;
#
endif
