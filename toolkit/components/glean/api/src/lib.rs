pub
extern
crate
chrono
;
pub
extern
crate
once_cell
;
pub
extern
crate
uuid
;
pub
mod
metrics
;
pub
mod
ping_upload
;
pub
mod
pings
;
pub
mod
private
;
pub
(
crate
)
mod
dispatcher
;
pub
mod
ipc
;
fn
with_glean
<
F
R
>
(
f
:
F
)
-
>
R
where
F
:
FnOnce
(
&
mut
glean_core
:
:
Glean
)
-
>
R
{
let
mut
lock
=
glean_core
:
:
global_glean
(
)
.
expect
(
"
Global
Glean
object
not
initialized
"
)
.
lock
(
)
.
unwrap
(
)
;
f
(
&
mut
lock
)
}
pub
fn
is_upload_enabled
(
)
-
>
bool
{
with_glean
(
|
glean
|
glean
.
is_upload_enabled
(
)
)
}
pub
fn
flush_init
(
)
-
>
Result
<
(
)
dispatcher
:
:
DispatchError
>
{
dispatcher
:
:
flush_init
(
)
}
pub
fn
shutdown
(
)
{
if
let
Err
(
e
)
=
dispatcher
:
:
try_shutdown
(
)
{
log
:
:
error
!
(
"
Can
'
t
shutdown
dispatcher
thread
:
{
:
?
}
"
e
)
;
}
}
