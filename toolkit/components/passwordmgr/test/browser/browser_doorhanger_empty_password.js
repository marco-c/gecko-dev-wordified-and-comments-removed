add_task
(
async
function
setup
(
)
{
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
signon
.
rememberSignons
.
visibilityToggle
"
true
]
]
}
)
;
}
)
;
add_task
(
async
function
test_empty_password
(
)
{
await
BrowserTestUtils
.
withNewTab
(
{
gBrowser
url
:
"
https
:
/
/
example
.
com
/
browser
/
toolkit
/
components
/
passwordmgr
/
test
/
browser
/
form_basic
.
html
"
}
async
function
(
browser
)
{
await
ContentTask
.
spawn
(
browser
null
async
function
(
)
{
let
doc
=
content
.
document
;
doc
.
getElementById
(
"
form
-
basic
-
username
"
)
.
value
=
"
username
"
;
doc
.
getElementById
(
"
form
-
basic
-
password
"
)
.
value
=
"
pw
"
;
doc
.
getElementById
(
"
form
-
basic
"
)
.
submit
(
)
;
}
)
;
await
waitForDoorhanger
(
browser
"
password
-
save
"
)
;
await
updateDoorhangerInputValues
(
{
password
:
"
"
}
)
;
let
notificationElement
=
PopupNotifications
.
panel
.
childNodes
[
0
]
;
let
mainActionButton
=
notificationElement
.
button
;
Assert
.
ok
(
mainActionButton
.
disabled
"
Main
action
button
is
disabled
"
)
;
await
hideDoorhangerPopup
(
)
;
}
)
;
}
)
;
