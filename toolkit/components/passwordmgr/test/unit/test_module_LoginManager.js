"
use
strict
"
;
const
{
LoginManager
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
LoginManager
.
jsm
"
)
;
add_task
(
async
function
test_ensureCurrentSyncID
(
)
{
let
loginManager
=
new
LoginManager
(
)
;
await
loginManager
.
setSyncID
(
1
)
;
await
loginManager
.
setLastSync
(
100
)
;
Assert
.
equal
(
await
loginManager
.
ensureCurrentSyncID
(
1
)
1
)
;
Assert
.
equal
(
await
loginManager
.
getSyncID
(
)
1
"
sync
ID
shouldn
'
t
change
"
)
;
Assert
.
equal
(
await
loginManager
.
getLastSync
(
)
100
"
last
sync
shouldn
'
t
change
"
)
;
Assert
.
equal
(
await
loginManager
.
ensureCurrentSyncID
(
2
)
2
)
;
Assert
.
equal
(
await
loginManager
.
getSyncID
(
)
2
"
sync
ID
should
be
updated
"
)
;
Assert
.
equal
(
await
loginManager
.
getLastSync
(
)
0
"
last
sync
should
be
reset
"
)
;
}
)
;
