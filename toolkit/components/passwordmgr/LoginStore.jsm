"
use
strict
"
;
const
EXPORTED_SYMBOLS
=
[
"
LoginStore
"
]
;
const
{
Services
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
ChromeUtils
.
defineModuleGetter
(
this
"
JSONFile
"
"
resource
:
/
/
gre
/
modules
/
JSONFile
.
jsm
"
)
;
const
kDataVersion
=
2
;
const
PERMISSION_SAVE_LOGINS
=
"
login
-
saving
"
;
function
LoginStore
(
aPath
)
{
JSONFile
.
call
(
this
{
path
:
aPath
dataPostProcessor
:
this
.
_dataPostProcessor
.
bind
(
this
)
}
)
;
}
LoginStore
.
prototype
=
Object
.
create
(
JSONFile
.
prototype
)
;
LoginStore
.
prototype
.
constructor
=
LoginStore
;
LoginStore
.
prototype
.
_dataPostProcessor
=
function
(
data
)
{
if
(
data
.
nextId
=
=
=
undefined
)
{
data
.
nextId
=
1
;
}
if
(
!
data
.
logins
)
{
data
.
logins
=
[
]
;
}
data
.
version
=
kDataVersion
;
return
data
;
}
;
