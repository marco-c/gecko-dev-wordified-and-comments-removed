#
ifndef
mozilla_nsCookieInjector_h__
#
define
mozilla_nsCookieInjector_h__
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsICookieBannerRule
.
h
"
#
include
"
nsIHttpChannel
.
h
"
#
include
"
nsIObserver
.
h
"
namespace
mozilla
{
class
nsCookieInjector
final
:
public
nsIObserver
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIOBSERVER
static
already_AddRefed
<
nsCookieInjector
>
GetSingleton
(
)
;
[
[
nodiscard
]
]
nsresult
Init
(
)
;
[
[
nodiscard
]
]
nsresult
Shutdown
(
)
;
private
:
nsCookieInjector
(
)
=
default
;
~
nsCookieInjector
(
)
=
default
;
bool
mIsInitialized
=
false
;
static
bool
IsEnabledForCurrentPrefState
(
)
;
static
void
OnPrefChange
(
const
char
*
aPref
void
*
aData
)
;
nsresult
MaybeInjectCookies
(
nsIHttpChannel
*
aChannel
const
char
*
aTopic
)
;
nsresult
InjectCookiesFromRules
(
const
nsCString
&
aHostPort
const
nsTArray
<
RefPtr
<
nsICookieRule
>
>
&
aRules
OriginAttributes
&
aOriginAttributes
)
;
}
;
}
#
endif
