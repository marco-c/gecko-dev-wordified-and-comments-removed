"
use
strict
"
;
const
GleanTest
=
new
Proxy
(
{
async
testResetFOG
(
)
{
return
SpecialPowers
.
spawnChrome
(
[
]
async
(
)
=
>
{
await
Services
.
fog
.
testFlushAllChildren
(
)
;
Services
.
fog
.
testResetFOG
(
)
;
}
)
;
}
async
flush
(
)
{
return
SpecialPowers
.
spawnChrome
(
[
]
async
(
)
=
>
{
await
Services
.
fog
.
testFlushAllChildren
(
)
;
}
)
;
}
}
{
get
(
gleanTestObj
catProp
)
{
if
(
catProp
in
gleanTestObj
)
{
return
gleanTestObj
[
catProp
]
;
}
return
new
Proxy
(
{
}
{
get
(
categoryObj
metProp
)
{
return
{
async
testGetValue
(
)
{
return
SpecialPowers
.
spawnChrome
(
[
catProp
metProp
]
async
(
categoryName
metricName
)
=
>
{
await
Services
.
fog
.
testFlushAllChildren
(
)
;
const
window
=
this
.
browsingContext
.
topChromeWindow
;
return
window
.
Glean
[
categoryName
]
[
metricName
]
.
testGetValue
(
)
;
}
)
;
}
}
;
}
}
)
;
}
}
)
;
