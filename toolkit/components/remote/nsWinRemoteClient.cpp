#
include
"
nsWinRemoteClient
.
h
"
#
include
<
windows
.
h
>
#
include
"
RemoteUtils
.
h
"
#
include
"
WinRemoteMessage
.
h
"
using
namespace
mozilla
;
nsresult
nsWinRemoteClient
:
:
Init
(
)
{
return
NS_OK
;
}
nsresult
nsWinRemoteClient
:
:
SendCommandLine
(
const
char
*
aProgram
const
char
*
aProfile
int32_t
argc
const
char
*
*
argv
bool
aRaise
)
{
nsString
className
;
BuildClassName
(
aProgram
aProfile
className
)
;
HWND
handle
=
:
:
FindWindowW
(
className
.
get
(
)
0
)
;
if
(
!
handle
)
{
return
NS_ERROR_NOT_AVAILABLE
;
}
WCHAR
cwd
[
MAX_PATH
]
;
_wgetcwd
(
cwd
MAX_PATH
)
;
WinRemoteMessageSender
sender
(
argc
argv
nsDependentString
(
cwd
)
)
;
if
(
aRaise
)
{
:
:
SetForegroundWindow
(
handle
)
;
}
:
:
SendMessageW
(
handle
WM_COPYDATA
0
reinterpret_cast
<
LPARAM
>
(
sender
.
CopyData
(
)
)
)
;
return
NS_OK
;
}
