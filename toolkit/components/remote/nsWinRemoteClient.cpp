#
include
"
nsWinRemoteClient
.
h
"
#
include
<
windows
.
h
>
#
include
"
RemoteUtils
.
h
"
#
include
"
WinRemoteMessage
.
h
"
using
namespace
mozilla
;
nsresult
nsWinRemoteClient
:
:
Init
(
)
{
return
NS_OK
;
}
nsresult
nsWinRemoteClient
:
:
SendCommandLine
(
const
char
*
aProgram
const
char
*
aProfile
int32_t
argc
char
*
*
argv
const
char
*
aDesktopStartupID
char
*
*
aResponse
bool
*
aSucceeded
)
{
*
aSucceeded
=
false
;
nsString
className
;
BuildClassName
(
aProgram
aProfile
className
)
;
HWND
handle
=
:
:
FindWindowW
(
className
.
get
(
)
0
)
;
if
(
!
handle
)
{
return
NS_OK
;
}
WCHAR
cwd
[
MAX_PATH
]
;
_wgetcwd
(
cwd
MAX_PATH
)
;
WinRemoteMessageSender
sender
(
:
:
GetCommandLineW
(
)
cwd
)
;
:
:
SetForegroundWindow
(
handle
)
;
:
:
SendMessageW
(
handle
WM_COPYDATA
0
reinterpret_cast
<
LPARAM
>
(
sender
.
CopyData
(
)
)
)
;
*
aSucceeded
=
true
;
return
NS_OK
;
}
