#
ifndef
__WinRemoteMessage_h__
#
define
__WinRemoteMessage_h__
#
include
<
windows
.
h
>
#
include
"
nsICommandLineRunner
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsString
.
h
"
enum
class
WinRemoteMessageVersion
:
uint32_t
{
CommandLineOnly
=
0
CommandLineAndWorkingDir
CommandLineAndWorkingDirInUtf16
}
;
class
WinRemoteMessageSender
final
{
COPYDATASTRUCT
mData
;
nsAutoString
mUtf16Buffer
;
nsAutoCString
mUtf8Buffer
;
public
:
WinRemoteMessageSender
(
const
wchar_t
*
aCommandLine
const
wchar_t
*
aWorkingDir
)
;
WinRemoteMessageSender
(
const
WinRemoteMessageSender
&
)
=
delete
;
WinRemoteMessageSender
(
WinRemoteMessageSender
&
&
)
=
delete
;
WinRemoteMessageSender
&
operator
=
(
const
WinRemoteMessageSender
&
)
=
delete
;
WinRemoteMessageSender
&
operator
=
(
WinRemoteMessageSender
&
&
)
=
delete
;
COPYDATASTRUCT
*
CopyData
(
)
;
explicit
WinRemoteMessageSender
(
const
char
*
aCommandLine
)
;
WinRemoteMessageSender
(
const
char
*
aCommandLine
const
char
*
aWorkingDir
)
;
}
;
class
WinRemoteMessageReceiver
final
{
nsCOMPtr
<
nsICommandLineRunner
>
mCommandLine
;
nsresult
ParseV0
(
const
nsACString
&
aBuffer
)
;
nsresult
ParseV1
(
const
nsACString
&
aBuffer
)
;
nsresult
ParseV2
(
const
nsAString
&
aBuffer
)
;
public
:
WinRemoteMessageReceiver
(
)
=
default
;
WinRemoteMessageReceiver
(
const
WinRemoteMessageReceiver
&
)
=
delete
;
WinRemoteMessageReceiver
(
WinRemoteMessageReceiver
&
&
)
=
delete
;
WinRemoteMessageReceiver
&
operator
=
(
const
WinRemoteMessageReceiver
&
)
=
delete
;
WinRemoteMessageReceiver
&
operator
=
(
WinRemoteMessageReceiver
&
&
)
=
delete
;
nsresult
Parse
(
const
COPYDATASTRUCT
*
aMessageData
)
;
nsICommandLineRunner
*
CommandLineRunner
(
)
;
}
;
#
endif
