add_task
(
async
function
test
(
)
{
let
remoteService
=
Cc
[
"
mozilla
.
org
/
remote
;
1
"
]
.
getService
(
Ci
.
nsIRemoteService
)
;
let
newTabOpened
=
BrowserTestUtils
.
waitForNewTab
(
gBrowser
"
https
:
/
/
example
.
org
/
"
true
)
;
remoteService
.
sendCommandLine
(
PathUtils
.
profileDir
[
"
https
:
/
/
example
.
org
/
"
]
)
;
Assert
.
ok
(
true
"
Successfully
sent
remote
message
"
)
;
let
newTab
=
await
newTabOpened
;
BrowserTestUtils
.
removeTab
(
newTab
)
;
let
newWinOpened
=
BrowserTestUtils
.
waitForNewWindow
(
)
;
remoteService
.
sendCommandLine
(
PathUtils
.
profileDir
[
]
)
;
Assert
.
ok
(
true
"
Successfully
sent
remote
message
"
)
;
let
newWindow
=
await
newWinOpened
;
await
BrowserTestUtils
.
closeWindow
(
newWindow
)
;
Assert
.
throws
(
(
)
=
>
{
remoteService
.
sendCommandLine
(
"
invalid
/
path
"
[
]
)
;
}
/
NS_ERROR_NOT_AVAILABLE
/
"
Should
throw
for
a
missing
instance
"
)
;
}
)
;
