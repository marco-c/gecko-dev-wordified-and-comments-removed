#
ifndef
ApplicationReputation_h__
#
define
ApplicationReputation_h__
#
include
"
nsIApplicationReputation
.
h
"
#
include
"
nsISupports
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsString
.
h
"
#
include
"
mozilla
/
Logging
.
h
"
class
nsIRequest
;
class
PendingDBLookup
;
class
PendingLookup
;
class
ApplicationReputationService
final
:
public
nsIApplicationReputationService
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIAPPLICATIONREPUTATIONSERVICE
public
:
static
const
char
*
const
kNonBinaryExecutables
[
4
]
;
#
ifdef
XP_WIN
static
const
char
*
const
kBinaryFileExtensions
[
187
]
;
#
else
static
const
char
*
const
kBinaryFileExtensions
[
186
]
;
#
endif
static
already_AddRefed
<
ApplicationReputationService
>
GetSingleton
(
)
;
private
:
friend
class
PendingLookup
;
friend
class
PendingDBLookup
;
static
ApplicationReputationService
*
gApplicationReputationService
;
static
mozilla
:
:
LazyLogModule
prlog
;
ApplicationReputationService
(
)
;
~
ApplicationReputationService
(
)
;
nsresult
QueryReputationInternal
(
nsIApplicationReputationQuery
*
aQuery
nsIApplicationReputationCallback
*
aCallback
)
;
}
;
#
endif
