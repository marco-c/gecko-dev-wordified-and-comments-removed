#
ifndef
mozilla_URLQueryStringStripper_h
#
define
mozilla_URLQueryStringStripper_h
#
include
"
nsIObserver
.
h
"
#
include
"
nsStringFwd
.
h
"
#
include
"
nsTHashSet
.
h
"
class
nsIURI
;
namespace
mozilla
{
class
URLQueryStringStripper
final
:
public
nsIObserver
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIOBSERVER
static
bool
Strip
(
nsIURI
*
aURI
nsCOMPtr
<
nsIURI
>
&
aOutput
)
;
private
:
URLQueryStringStripper
(
)
=
default
;
~
URLQueryStringStripper
(
)
=
default
;
static
URLQueryStringStripper
*
GetOrCreate
(
)
;
void
Init
(
)
;
void
Shutdown
(
)
;
bool
StripQueryString
(
nsIURI
*
aURI
nsCOMPtr
<
nsIURI
>
&
aOutput
)
;
bool
CheckAllowList
(
nsIURI
*
aURI
)
;
void
PopulateStripList
(
)
;
void
PopulateAllowList
(
)
;
nsTHashSet
<
nsString
>
mList
;
nsTHashSet
<
nsCString
>
mAllowList
;
}
;
}
#
endif
