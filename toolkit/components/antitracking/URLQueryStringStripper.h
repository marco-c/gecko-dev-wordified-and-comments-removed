#
ifndef
mozilla_URLQueryStringStripper_h
#
define
mozilla_URLQueryStringStripper_h
#
include
"
nsIURLQueryStrippingListService
.
h
"
#
include
"
nsStringFwd
.
h
"
#
include
"
nsTHashSet
.
h
"
class
nsIURI
;
namespace
mozilla
{
class
URLQueryStringStripper
final
:
public
nsIURLQueryStrippingListObserver
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIURLQUERYSTRIPPINGLISTOBSERVER
static
uint32_t
Strip
(
nsIURI
*
aURI
bool
aIsPBM
nsCOMPtr
<
nsIURI
>
&
aOutput
)
;
static
void
TestGetStripList
(
nsACString
&
aStripList
)
;
private
:
URLQueryStringStripper
(
)
;
~
URLQueryStringStripper
(
)
=
default
;
static
URLQueryStringStripper
*
GetOrCreate
(
)
;
static
void
OnPrefChange
(
const
char
*
aPref
void
*
aData
)
;
nsresult
Init
(
)
;
nsresult
Shutdown
(
)
;
uint32_t
StripQueryString
(
nsIURI
*
aURI
nsCOMPtr
<
nsIURI
>
&
aOutput
)
;
bool
CheckAllowList
(
nsIURI
*
aURI
)
;
void
PopulateStripList
(
const
nsAString
&
aList
)
;
void
PopulateAllowList
(
const
nsACString
&
aList
)
;
nsTHashSet
<
nsString
>
mList
;
nsTHashSet
<
nsCString
>
mAllowList
;
nsCOMPtr
<
nsIURLQueryStrippingListService
>
mListService
;
bool
mIsInitialized
;
}
;
}
#
endif
