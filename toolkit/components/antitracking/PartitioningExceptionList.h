#
ifndef
mozilla_PartitioningExceptionList_h
#
define
mozilla_PartitioningExceptionList_h
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIPartitioningExceptionListService
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
nsString
.
h
"
class
nsIChannel
;
class
nsIPrincipal
;
namespace
mozilla
{
class
PartitioningExceptionList
:
public
nsIPartitioningExceptionListObserver
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIPARTITIONINGEXCEPTIONLISTOBSERVER
static
bool
Check
(
const
nsACString
&
aFirstPartyOrigin
const
nsACString
&
aThirdPartyOrigin
)
;
private
:
static
PartitioningExceptionList
*
GetOrCreate
(
)
;
PartitioningExceptionList
(
)
=
default
;
virtual
~
PartitioningExceptionList
(
)
=
default
;
nsresult
Init
(
)
;
void
Shutdown
(
)
;
struct
PartitionExceptionListPattern
{
nsCString
mScheme
;
nsCString
mSuffix
;
bool
mIsWildCard
=
false
;
}
;
struct
PartitionExceptionListEntry
{
PartitionExceptionListPattern
mFirstParty
;
PartitionExceptionListPattern
mThirdParty
;
}
;
static
nsresult
GetSchemeFromOrigin
(
const
nsACString
&
aOrigin
nsACString
&
aScheme
nsACString
&
aOriginNoScheme
)
;
static
bool
OriginMatchesPattern
(
const
nsACString
&
aOrigin
const
PartitionExceptionListPattern
&
aPattern
)
;
static
nsresult
GetExceptionListPattern
(
const
nsACString
&
aOriginPattern
PartitionExceptionListPattern
&
aPattern
)
;
nsCOMPtr
<
nsIPartitioningExceptionListService
>
mService
;
nsTArray
<
PartitionExceptionListEntry
>
mExceptionList
;
}
;
}
#
endif
