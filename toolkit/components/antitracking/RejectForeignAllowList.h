#
ifndef
mozilla_RejectForeignAllowList_h
#
define
mozilla_RejectForeignAllowList_h
#
include
"
nsIUrlClassifierExceptionListService
.
h
"
#
include
"
nsIPrincipal
.
h
"
class
nsIHttpChannel
;
class
nsIURI
;
namespace
mozilla
{
namespace
dom
{
class
Document
;
}
class
RejectForeignAllowList
final
:
public
nsIUrlClassifierExceptionListObserver
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIURLCLASSIFIEREXCEPTIONLISTOBSERVER
static
bool
Check
(
dom
:
:
Document
*
aDocument
)
;
static
bool
Check
(
nsIHttpChannel
*
aChannel
)
;
static
bool
Check
(
nsIPrincipal
*
aPrincipal
)
;
static
bool
Check
(
nsIURI
*
aURI
)
;
private
:
static
RejectForeignAllowList
*
GetOrCreate
(
)
;
RejectForeignAllowList
(
)
;
~
RejectForeignAllowList
(
)
;
bool
CheckInternal
(
nsIURI
*
aURI
)
;
bool
CheckInternal
(
nsIPrincipal
*
aPrincipal
)
;
nsCString
mList
;
}
;
}
#
endif
