#
ifndef
mozilla_contentblockingnotifier_h
#
define
mozilla_contentblockingnotifier_h
#
include
"
nsStringFwd
.
h
"
#
include
"
mozilla
/
Maybe
.
h
"
#
define
ANTITRACKING_CONSOLE_CATEGORY
"
Content
Blocking
"
_ns
class
nsIChannel
;
class
nsPIDOMWindowInner
;
class
nsPIDOMWindowOuter
;
namespace
mozilla
{
namespace
dom
{
class
BrowsingContext
;
}
class
ContentBlockingNotifier
final
{
public
:
enum
class
BlockingDecision
{
eBlock
eAllow
}
;
enum
StorageAccessPermissionGrantedReason
{
eStorageAccessAPI
eOpenerAfterUserInteraction
eOpener
ePrivilegeStorageAccessForOriginAPI
}
;
enum
CanvasFingerprinter
{
eFingerprintJS
eAkamai
eVariant1
eVariant2
eVariant3
eVariant4
eMaybe
}
;
static
void
OnDecision
(
nsIChannel
*
aChannel
BlockingDecision
aDecision
uint32_t
aRejectedReason
)
;
static
void
OnDecision
(
nsPIDOMWindowInner
*
aWindow
BlockingDecision
aDecision
uint32_t
aRejectedReason
)
;
static
void
OnDecision
(
dom
:
:
BrowsingContext
*
aBrowsingContext
BlockingDecision
aDecision
uint32_t
aRejectedReason
)
;
static
void
OnEvent
(
nsIChannel
*
aChannel
uint32_t
aRejectedReason
bool
aBlocked
=
true
)
;
static
void
OnEvent
(
nsIChannel
*
aChannel
bool
aBlocked
uint32_t
aRejectedReason
const
nsACString
&
aTrackingOrigin
const
:
:
mozilla
:
:
Maybe
<
StorageAccessPermissionGrantedReason
>
&
aReason
=
Nothing
(
)
const
Maybe
<
CanvasFingerprinter
>
&
aCanvasFingerprinter
=
Nothing
(
)
const
Maybe
<
bool
>
aCanvasFingerprinterKnownText
=
Nothing
(
)
)
;
static
void
ReportUnblockingToConsole
(
dom
:
:
BrowsingContext
*
aBrowsingContext
const
nsAString
&
aTrackingOrigin
StorageAccessPermissionGrantedReason
aReason
)
;
}
;
}
#
endif
