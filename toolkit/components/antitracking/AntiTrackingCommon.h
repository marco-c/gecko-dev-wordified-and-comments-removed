#
ifndef
mozilla_antitrackingservice_h
#
define
mozilla_antitrackingservice_h
#
include
"
nsString
.
h
"
class
nsIHttpChannel
;
class
nsIPrincipal
;
class
nsIURI
;
class
nsPIDOMWindowInner
;
namespace
mozilla
{
class
AntiTrackingCommon
final
{
public
:
static
bool
IsFirstPartyStorageAccessGrantedFor
(
nsPIDOMWindowInner
*
a3rdPartyTrackingWindow
nsIURI
*
aURI
)
;
static
bool
MaybeIsFirstPartyStorageAccessGrantedFor
(
nsPIDOMWindowInner
*
aFirstPartyWindow
nsIURI
*
aURI
)
;
static
bool
IsFirstPartyStorageAccessGrantedFor
(
nsIHttpChannel
*
a3rdPartyTrackingChannel
nsIURI
*
aURI
)
;
static
void
AddFirstPartyStorageAccessGrantedFor
(
const
nsAString
&
aOrigin
nsPIDOMWindowInner
*
a3rdPartyTrackingWindow
)
;
static
void
SaveFirstPartyStorageAccessGrantedForOriginOnParentProcess
(
nsIPrincipal
*
aPrincipal
const
nsCString
&
aParentOrigin
const
nsCString
&
aGrantedOrigin
)
;
}
;
}
#
endif
