#
ifndef
mozilla_ClearDataCallback_h__
#
define
mozilla_ClearDataCallback_h__
#
include
"
mozilla
/
MozPromise
.
h
"
#
include
"
mozilla
/
glean
/
bindings
/
GleanMetric
.
h
"
#
include
"
nsIClearDataService
.
h
"
#
include
"
nsIURIClassifier
.
h
"
namespace
mozilla
{
using
ClearDataMozPromise
=
MozPromise
<
nsCString
uint32_t
true
>
;
extern
LazyLogModule
gBounceTrackingProtectionLog
;
class
ClearDataCallback
final
:
public
nsIClearDataCallback
public
nsIUrlClassifierFeatureCallback
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSICLEARDATACALLBACK
NS_DECL_NSIURLCLASSIFIERFEATURECALLBACK
explicit
ClearDataCallback
(
ClearDataMozPromise
:
:
Private
*
aPromise
const
nsACString
&
aHost
)
;
private
:
virtual
~
ClearDataCallback
(
)
;
nsCString
mHost
;
RefPtr
<
ClearDataMozPromise
:
:
Private
>
mPromise
;
void
RecordClearDurationTelemetry
(
)
;
glean
:
:
TimerId
mClearDurationTimer
;
void
RecordPurgeCountTelemetry
(
bool
aFailed
)
;
void
RecordURLClassifierTelemetry
(
)
;
static
nsTArray
<
RefPtr
<
nsIUrlClassifierFeature
>
>
sUrlClassifierFeatures
;
}
;
}
#
endif
