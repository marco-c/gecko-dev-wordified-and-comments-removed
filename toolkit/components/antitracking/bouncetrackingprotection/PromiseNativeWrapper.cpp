#
include
"
PromiseNativeWrapper
.
h
"
namespace
mozilla
{
NS_IMPL_ISUPPORTS0
(
PromiseNativeWrapper
)
;
RefPtr
<
GenericNonExclusivePromise
>
PromiseNativeWrapper
:
:
ConvertJSPromiseToMozPromise
(
const
RefPtr
<
dom
:
:
Promise
>
&
jsPromise
)
{
MozPromiseHolder
<
GenericNonExclusivePromise
>
holder
;
RefPtr
<
GenericNonExclusivePromise
>
mozPromise
=
holder
.
Ensure
(
__func__
)
;
RefPtr
<
PromiseNativeWrapper
>
handler
=
new
PromiseNativeWrapper
(
std
:
:
move
(
holder
)
)
;
jsPromise
-
>
AppendNativeHandler
(
handler
)
;
return
mozPromise
.
forget
(
)
;
}
}
