#
ifndef
mozilla_BounceTrackingProtection_h__
#
define
mozilla_BounceTrackingProtection_h__
#
include
"
mozilla
/
Logging
.
h
"
#
include
"
nsIBounceTrackingProtection
.
h
"
#
include
"
nsTHashMap
.
h
"
class
nsIPrincipal
;
namespace
mozilla
{
class
BounceTrackingState
;
extern
LazyLogModule
gBounceTrackingProtectionLog
;
class
BounceTrackingProtection
final
:
public
nsIBounceTrackingProtection
{
NS_DECL_ISUPPORTS
NS_DECL_NSIBOUNCETRACKINGPROTECTION
public
:
static
already_AddRefed
<
BounceTrackingProtection
>
GetSingleton
(
)
;
nsresult
RecordStatefulBounces
(
BounceTrackingState
*
aBounceTrackingState
)
;
nsresult
RecordUserActivation
(
nsIPrincipal
*
aPrincipal
)
;
private
:
BounceTrackingProtection
(
)
=
default
;
~
BounceTrackingProtection
(
)
=
default
;
nsTHashMap
<
nsCStringHashKey
PRTime
>
mUserActivation
{
}
;
nsTHashMap
<
nsCStringHashKey
PRTime
>
mBounceTrackers
{
}
;
}
;
}
#
endif
