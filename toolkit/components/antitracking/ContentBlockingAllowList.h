#
ifndef
mozilla_contentblockingallowlist_h
#
define
mozilla_contentblockingallowlist_h
class
nsIHttpChannel
;
class
nsIPrincipal
;
class
nsIURI
;
class
nsPIDOMWindowInner
;
namespace
mozilla
{
class
OriginAttributes
;
struct
ContentBlockingAllowListCache
;
class
ContentBlockingAllowList
final
{
public
:
static
nsresult
Check
(
nsIPrincipal
*
aContentBlockingAllowListPrincipal
bool
aIsPrivateBrowsing
bool
&
aIsAllowListed
)
;
static
bool
Check
(
nsIHttpChannel
*
aChannel
)
;
static
void
ComputePrincipal
(
nsIPrincipal
*
aDocumentPrincipal
nsIPrincipal
*
*
aPrincipal
)
;
static
void
RecomputePrincipal
(
nsIURI
*
aURIBeingLoaded
const
OriginAttributes
&
aAttrs
nsIPrincipal
*
*
aPrincipal
)
;
private
:
static
ContentBlockingAllowListCache
&
Cache
(
)
;
static
bool
Check
(
nsIPrincipal
*
aTopWinPrincipal
bool
aIsPrivateBrowsing
)
;
static
bool
Check
(
nsPIDOMWindowInner
*
aWindow
)
;
friend
class
ContentBlocking
;
}
;
}
#
endif
