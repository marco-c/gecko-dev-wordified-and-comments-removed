async
function
setupPlayer
(
originatingBrowser
videoData
)
{
window
.
windowUtils
.
setChromeMargin
(
0
0
0
0
)
;
let
holder
=
document
.
querySelector
(
"
.
player
-
holder
"
)
;
let
browser
=
document
.
getElementById
(
"
browser
"
)
;
browser
.
remove
(
)
;
browser
.
setAttribute
(
"
nodefaultsrc
"
"
true
"
)
;
browser
.
sameProcessAsFrameLoader
=
originatingBrowser
.
frameLoader
;
holder
.
appendChild
(
browser
)
;
browser
.
loadURI
(
"
about
:
blank
"
{
triggeringPrincipal
:
originatingBrowser
.
contentPrincipal
}
)
;
let
mm
=
browser
.
frameLoader
.
messageManager
;
mm
.
sendAsyncMessage
(
"
PictureInPicture
:
SetupPlayer
"
)
;
browser
.
addEventListener
(
"
oop
-
browser
-
crashed
"
(
)
=
>
{
window
.
close
(
)
;
}
)
;
await
window
.
promiseDocumentFlushed
(
(
)
=
>
{
}
)
;
browser
.
style
.
MozWindowDragging
=
"
drag
"
;
}
