function
run_test
(
)
{
installTestEngine
(
)
;
do_get_file
(
"
data
/
metadata
.
json
"
)
.
copyTo
(
gProfD
"
search
-
metadata
.
json
"
)
;
run_next_test
(
)
;
}
add_task
(
function
*
test_async_metadata_migration
(
)
{
yield
asyncInit
(
)
;
yield
promiseAfterCache
(
)
;
let
metadata
=
yield
promiseEngineMetadata
(
)
;
do_check_eq
(
metadata
[
"
engine
"
]
.
order
1
)
;
do_check_eq
(
metadata
[
"
engine
"
]
.
alias
"
foo
"
)
;
metadata
=
yield
promiseGlobalMetadata
(
)
;
do_check_eq
(
metadata
[
"
searchDefaultExpir
"
]
1471013469846
)
;
}
)
;
