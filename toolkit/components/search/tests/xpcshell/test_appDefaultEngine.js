"
use
strict
"
;
const
CONFIG
=
[
{
identifier
:
"
default
-
engine
"
}
{
identifier
:
"
an
-
engine
"
variants
:
[
{
environment
:
{
regions
:
[
"
an
"
]
}
}
]
}
{
identifier
:
"
tr
-
engine
"
}
{
specificDefaults
:
[
{
default
:
"
an
-
engine
"
environment
:
{
regions
:
[
"
an
"
]
}
}
{
default
:
"
tr
-
engine
"
environment
:
{
regions
:
[
"
tr
"
]
}
}
]
}
]
;
add_setup
(
async
function
(
)
{
Region
.
_setHomeRegion
(
"
an
"
false
)
;
SearchTestUtils
.
setRemoteSettingsConfig
(
CONFIG
)
;
}
)
;
add_task
(
async
function
test_appDefaultEngine
(
)
{
await
Promise
.
all
(
[
Services
.
search
.
init
(
)
promiseAfterSettings
(
)
]
)
;
Assert
.
equal
(
Services
.
search
.
appDefaultEngine
.
name
"
an
-
engine
"
"
Should
have
returned
the
correct
app
default
engine
"
)
;
}
)
;
add_task
(
async
function
test_changeRegion
(
)
{
await
promiseSetHomeRegion
(
"
tr
"
)
;
Assert
.
equal
(
Services
.
search
.
appDefaultEngine
.
name
"
tr
-
engine
"
"
Should
have
returned
the
correct
engine
for
the
new
locale
"
)
;
}
)
;
