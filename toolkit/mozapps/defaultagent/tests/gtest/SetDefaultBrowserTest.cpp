#
include
"
gtest
/
gtest
.
h
"
#
include
<
windows
.
h
>
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
WindowsUserChoice
.
h
"
#
include
"
SetDefaultBrowser
.
h
"
TEST
(
SetDefaultBrowserUserChoice
Hash
)
{
const
wchar_t
*
sid
=
L
"
S
-
1
-
5
-
21
-
636376821
-
3290315252
-
1794850287
-
1001
"
;
EXPECT_STREQ
(
GenerateUserChoiceHash
(
L
"
https
"
sid
L
"
FirefoxURL
-
308046B0AF4A39CB
"
(
SYSTEMTIME
)
{
2021
4
1
19
23
7
56
506
}
)
.
get
(
)
L
"
uzpIsMVyZ1g
=
"
)
;
EXPECT_STREQ
(
GenerateUserChoiceHash
(
L
"
.
html
"
sid
L
"
FirefoxHTML
-
308046B0AF4A39CB
"
(
SYSTEMTIME
)
{
2021
4
1
19
23
7
56
519
}
)
.
get
(
)
L
"
7fjRtUPASlc
=
"
)
;
EXPECT_STREQ
(
GenerateUserChoiceHash
(
L
"
https
"
sid
L
"
MSEdgeHTM
"
(
SYSTEMTIME
)
{
2021
4
1
19
23
3
48
119
}
)
.
get
(
)
L
"
Fz0kA3Ymmps
=
"
)
;
EXPECT_STREQ
(
GenerateUserChoiceHash
(
L
"
.
html
"
sid
L
"
ChromeHTML
"
(
SYSTEMTIME
)
{
2021
4
1
19
23
6
3
628
}
)
.
get
(
)
L
"
R5TD9LGJ5Xw
=
"
)
;
EXPECT_STREQ
(
GenerateUserChoiceHash
(
L
"
.
html
"
sid
L
"
FirefoxHTML
-
B
D
"
(
SYSTEMTIME
)
{
2021
4
2
20
0
38
55
101
}
)
.
get
(
)
L
"
F3NsK3uNv5E
=
"
)
;
}
