const
URL_PREFIX
=
URL_HOST
+
"
/
"
;
function
run_test
(
)
{
setupTestCommon
(
)
;
standardInit
(
)
;
executeSoon
(
run_test_pt1
)
;
}
function
run_test_pt1
(
)
{
gCheckFunc
=
check_test_pt1
;
let
url
=
URL_PREFIX
;
debugDump
(
"
testing
url
force
param
is
present
:
"
+
url
)
;
setUpdateURL
(
url
)
;
gUpdateChecker
.
checkForUpdates
(
updateCheckListener
true
)
;
}
function
check_test_pt1
(
)
{
let
url
=
URL_PREFIX
+
"
?
force
=
1
"
;
Assert
.
equal
(
gRequestURL
url
"
the
url
"
+
MSG_SHOULD_EQUAL
)
;
run_test_pt2
(
)
;
}
function
run_test_pt2
(
)
{
gCheckFunc
=
check_test_pt2
;
let
url
=
URL_PREFIX
+
"
?
testparam
=
1
"
;
debugDump
(
"
testing
url
force
param
when
there
is
already
a
param
present
:
"
+
url
)
;
setUpdateURL
(
url
)
;
gUpdateChecker
.
checkForUpdates
(
updateCheckListener
true
)
;
}
function
check_test_pt2
(
)
{
let
url
=
URL_PREFIX
+
"
?
testparam
=
1
&
force
=
1
"
;
Assert
.
equal
(
gRequestURL
url
"
the
url
"
+
MSG_SHOULD_EQUAL
)
;
doTestFinish
(
)
;
}
