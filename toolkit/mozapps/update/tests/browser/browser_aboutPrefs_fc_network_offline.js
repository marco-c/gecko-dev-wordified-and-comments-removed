"
use
strict
"
;
add_task
(
async
function
aboutPrefs_foregroundCheck_network_offline
(
)
{
info
(
"
[
OFFLINE
]
Setting
Services
.
io
.
offline
(
do
not
forget
to
reset
it
!
)
"
)
;
Services
.
io
.
manageOfflineStatus
=
false
;
Services
.
io
.
offline
=
true
;
registerCleanupFunction
(
(
)
=
>
{
info
(
"
[
ONLINE
]
Resetting
Services
.
io
.
offline
"
)
;
Services
.
io
.
offline
=
false
;
Services
.
io
.
manageOfflineStatus
=
true
;
}
)
;
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
network
.
disable
-
localhost
-
when
-
offline
"
true
]
[
"
network
.
dns
.
offline
-
localhost
"
false
]
]
}
)
;
await
runAboutPrefsUpdateTest
(
{
}
[
{
panelId
:
"
checkingFailed
"
}
]
)
;
}
)
;
