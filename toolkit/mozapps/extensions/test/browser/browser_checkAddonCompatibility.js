async
function
test
(
)
{
waitForExplicitFinish
(
)
;
Services
.
prefs
.
setBoolPref
(
PREF_STRICT_COMPAT
true
)
;
ok
(
AddonManager
.
strictCompatibility
"
Strict
compatibility
should
be
enabled
"
)
;
let
aAddons
=
await
AddonManager
.
getAllAddons
(
)
;
aAddons
.
sort
(
function
compareTypeName
(
a
b
)
{
return
a
.
type
.
localeCompare
(
b
.
type
)
|
|
a
.
name
.
localeCompare
(
b
.
name
)
;
}
)
;
let
allCompatible
=
true
;
for
(
let
a
of
aAddons
)
{
if
(
a
.
type
=
=
"
plugin
"
|
|
a
.
id
=
=
"
workerbootstrap
-
test
mozilla
.
org
"
)
{
continue
;
}
ok
(
a
.
isCompatible
a
.
type
+
"
"
+
a
.
name
+
"
"
+
a
.
version
+
"
should
be
compatible
"
)
;
allCompatible
=
allCompatible
&
&
a
.
isCompatible
;
}
finish
(
)
;
}
