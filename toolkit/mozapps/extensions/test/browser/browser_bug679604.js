async
function
test
(
)
{
waitForExplicitFinish
(
)
;
let
aWindow
=
await
open_manager
(
null
)
;
var
categories
=
aWindow
.
document
.
getElementById
(
"
categories
"
)
;
categories
.
setAttribute
(
"
last
-
selected
"
"
foo
"
)
;
Services
.
xulStore
.
persist
(
categories
"
last
-
selected
"
)
;
await
close_manager
(
aWindow
)
;
Services
.
prefs
.
clearUserPref
(
PREF_UI_LASTCATEGORY
)
;
aWindow
=
await
open_manager
(
null
)
;
is
(
new
CategoryUtilities
(
aWindow
)
.
selectedCategory
"
discover
"
"
Should
have
loaded
the
right
view
"
)
;
close_manager
(
aWindow
finish
)
;
}
