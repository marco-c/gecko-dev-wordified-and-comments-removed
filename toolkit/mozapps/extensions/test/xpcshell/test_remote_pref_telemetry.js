"
use
strict
"
;
AddonTestUtils
.
init
(
this
)
;
AddonTestUtils
.
createAppInfo
(
"
xpcshell
tests
.
mozilla
.
org
"
"
XPCShell
"
"
42
"
"
42
"
)
;
add_setup
(
async
(
)
=
>
{
do_get_profile
(
)
;
Services
.
fog
.
initializeFOG
(
)
;
}
)
;
add_task
(
async
function
test_remote_extensions_pref_telemetry
(
)
{
let
original
=
Services
.
prefs
.
getBoolPref
(
"
extensions
.
webextensions
.
remote
"
)
;
await
AddonTestUtils
.
promiseStartupManager
(
)
;
equal
(
original
Glean
.
extensions
.
useRemotePref
.
testGetValue
(
)
"
useRemotePref
flag
in
glean
is
correct
.
"
)
;
equal
(
original
Glean
.
extensions
.
useRemotePolicy
.
testGetValue
(
)
"
useRemotePolicy
flag
in
glean
is
correct
.
"
)
;
Services
.
prefs
.
setBoolPref
(
"
extensions
.
webextensions
.
remote
"
!
original
)
;
equal
(
!
original
Glean
.
extensions
.
useRemotePref
.
testGetValue
(
)
"
useRemotePref
flag
reflects
the
changed
pref
.
"
)
;
equal
(
original
Glean
.
extensions
.
useRemotePolicy
.
testGetValue
(
)
"
useRemotePolicy
flag
still
equal
to
original
pref
value
.
"
)
;
}
)
;
