Services
.
prefs
.
setBoolPref
(
PREF_XPI_SIGNATURES_REQUIRED
true
)
;
gUseRealCertChecks
=
true
;
const
profileDir
=
gProfD
.
clone
(
)
;
profileDir
.
append
(
"
extensions
"
)
;
const
ID
=
"
bootstrap1
tests
.
mozilla
.
org
"
;
add_task
(
function
*
(
)
{
createAppInfo
(
"
xpcshell
tests
.
mozilla
.
org
"
"
XPCShell
"
"
1
"
"
1
.
9
.
2
"
)
;
AddonTestUtils
.
manuallyInstall
(
do_get_addon
(
"
test_cache_certdb
"
)
profileDir
ID
)
;
startupManager
(
)
;
const
{
XPIProvider
}
=
Components
.
utils
.
import
(
"
resource
:
/
/
gre
/
modules
/
addons
/
XPIProvider
.
jsm
"
{
}
)
;
yield
XPIProvider
.
verifySignatures
(
)
;
let
addon
=
yield
AddonManager
.
getAddonByID
(
ID
)
;
do_check_eq
(
addon
.
signedState
AddonManager
.
SIGNEDSTATE_MISSING
)
;
do_check_false
(
addon
.
isActive
)
;
do_check_true
(
addon
.
appDisabled
)
;
}
)
;
