function
run_test
(
)
{
run_next_test
(
)
;
}
let
profileDir
;
add_task
(
async
function
setup
(
)
{
profileDir
=
gProfD
.
clone
(
)
;
profileDir
.
append
(
"
extensions
"
)
;
createAppInfo
(
"
xpcshell
tests
.
mozilla
.
org
"
"
XPCShell
"
"
1
"
"
1
.
9
.
2
"
)
;
startupManager
(
)
;
}
)
;
add_task
(
async
function
test_bad_unpacked_path
(
)
{
let
MANIFEST_ID
=
"
webext_bad_path
tests
.
mozilla
.
org
"
;
let
manifest
=
{
name
:
"
path
test
"
description
:
"
test
of
a
bad
directory
name
"
manifest_version
:
2
version
:
"
1
.
0
"
browser_specific_settings
:
{
gecko
:
{
id
:
MANIFEST_ID
}
}
}
;
const
directories
=
[
"
not
a
valid
ID
"
'
"
quotes
"
tests
.
mozilla
.
org
'
]
;
for
(
let
dir
of
directories
)
{
try
{
await
promiseWriteWebManifestForExtension
(
manifest
profileDir
dir
)
;
}
catch
(
ex
)
{
continue
;
}
await
promiseRestartManager
(
)
;
let
addon
=
await
promiseAddonByID
(
dir
)
;
do_check_eq
(
addon
null
)
;
addon
=
await
promiseAddonByID
(
MANIFEST_ID
)
;
do_check_eq
(
addon
null
)
;
}
}
)
;
