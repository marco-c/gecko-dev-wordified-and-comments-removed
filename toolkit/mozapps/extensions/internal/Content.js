"
use
strict
"
;
(
function
(
)
{
var
{
classes
:
Cc
interfaces
:
Ci
utils
:
Cu
}
=
Components
;
var
{
Services
}
=
Cu
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
{
}
)
;
var
nsIFile
=
Components
.
Constructor
(
"
mozilla
.
org
/
file
/
local
;
1
"
"
nsIFile
"
"
initWithPath
"
)
;
const
MSG_JAR_FLUSH
=
"
AddonJarFlush
"
;
const
MSG_MESSAGE_MANAGER_CACHES_FLUSH
=
"
AddonMessageManagerCachesFlush
"
;
try
{
if
(
Services
.
appinfo
.
processType
!
=
=
Services
.
appinfo
.
PROCESS_TYPE_DEFAULT
)
{
addMessageListener
(
MSG_JAR_FLUSH
function
(
message
)
{
let
file
=
new
nsIFile
(
message
.
data
)
;
Services
.
obs
.
notifyObservers
(
file
"
flush
-
cache
-
entry
"
null
)
;
}
)
;
addMessageListener
(
MSG_MESSAGE_MANAGER_CACHES_FLUSH
function
(
)
{
Services
.
obs
.
notifyObservers
(
null
"
message
-
manager
-
flush
-
caches
"
null
)
;
}
)
;
}
}
catch
(
e
)
{
Cu
.
reportError
(
e
)
;
}
}
)
(
)
;
