#
include
"
NotificationFactory
.
h
"
HRESULT
STDMETHODCALLTYPE
NotificationFactory
:
:
CreateInstance
(
IUnknown
*
pUnkOuter
REFIID
riid
void
*
*
ppvObject
)
{
if
(
pUnkOuter
!
=
nullptr
)
{
return
CLASS_E_NOAGGREGATION
;
}
if
(
!
ppvObject
)
{
return
E_INVALIDARG
;
}
*
ppvObject
=
nullptr
;
using
namespace
Microsoft
:
:
WRL
;
ComPtr
<
NotificationCallback
>
callback
=
Make
<
NotificationCallback
const
GUID
&
const
path
&
>
(
notificationGuid
installDir
)
;
switch
(
callback
-
>
QueryInterface
(
riid
ppvObject
)
)
{
case
S_OK
:
return
S_OK
;
case
E_NOINTERFACE
:
return
E_NOINTERFACE
;
default
:
return
E_UNEXPECTED
;
}
}
