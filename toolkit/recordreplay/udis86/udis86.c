#
include
"
udint
.
h
"
#
include
"
decode
.
h
"
static
void
ud_inp_init
(
struct
ud
*
u
)
;
extern
void
ud_set_mode
(
struct
ud
*
u
uint8_t
m
)
{
switch
(
m
)
{
case
16
:
case
32
:
case
64
:
u
-
>
dis_mode
=
m
;
return
;
default
:
u
-
>
dis_mode
=
16
;
return
;
}
}
extern
void
ud_init
(
struct
ud
*
u
)
{
memset
(
(
void
*
)
u
0
sizeof
(
struct
ud
)
)
;
ud_set_mode
(
u
16
)
;
u
-
>
mnemonic
=
UD_Iinvalid
;
}
const
struct
ud_operand
*
ud_insn_opr
(
const
struct
ud
*
u
unsigned
int
n
)
{
if
(
n
>
2
|
|
u
-
>
operand
[
n
]
.
type
=
=
UD_NONE
)
{
return
NULL
;
}
else
{
return
&
u
-
>
operand
[
n
]
;
}
}
enum
ud_mnemonic_code
ud_insn_mnemonic
(
const
struct
ud
*
u
)
{
return
u
-
>
mnemonic
;
}
static
void
ud_inp_init
(
struct
ud
*
u
)
{
u
-
>
inp_buf
=
NULL
;
u
-
>
inp_buf_size
=
0
;
u
-
>
inp_buf_index
=
0
;
u
-
>
inp_curr
=
0
;
u
-
>
inp_ctr
=
0
;
u
-
>
inp_end
=
0
;
}
void
ud_set_input_buffer
(
struct
ud
*
u
const
uint8_t
*
buf
size_t
len
)
{
ud_inp_init
(
u
)
;
u
-
>
inp_buf
=
buf
;
u
-
>
inp_buf_size
=
len
;
u
-
>
inp_buf_index
=
0
;
}
