use
super
:
:
detect
:
:
{
get_conflicting_mitigations
ConflictingMitigationStatus
}
;
#
[
no_mangle
]
pub
unsafe
extern
"
C
"
fn
detect_win32k_conflicting_mitigations
(
conflicting_mitigations
:
&
mut
ConflictingMitigationStatus
)
-
>
bool
{
let
process_path
=
std
:
:
env
:
:
current_exe
(
)
.
expect
(
"
unable
to
determine
the
path
of
our
executable
"
)
;
let
file_name
=
process_path
.
file_name
(
)
.
expect
(
"
executable
doesn
'
t
have
a
file
name
"
)
;
match
get_conflicting_mitigations
(
file_name
)
{
Ok
(
status
)
=
>
{
*
conflicting_mitigations
=
status
;
true
}
Err
(
e
)
=
>
{
log
:
:
error
!
(
"
Failed
to
get
Win32k
Lockdown
conflicting
mitigation
status
:
{
}
"
e
)
;
false
}
}
}
