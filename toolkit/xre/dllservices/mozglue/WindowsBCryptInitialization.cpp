#
include
"
mozilla
/
WindowsBCryptInitialization
.
h
"
#
include
"
mozilla
/
RandomNum
.
h
"
#
include
"
nsWindowsDllInterceptor
.
h
"
#
include
<
bcrypt
.
h
>
#
pragma
comment
(
lib
"
bcrypt
.
lib
"
)
namespace
mozilla
{
bool
WindowsBCryptInitialization
(
)
{
UCHAR
buffer
[
32
]
;
NTSTATUS
status
=
:
:
BCryptGenRandom
(
nullptr
buffer
sizeof
(
buffer
)
BCRYPT_USE_SYSTEM_PREFERRED_RNG
)
;
return
NT_SUCCESS
(
status
)
;
}
}
