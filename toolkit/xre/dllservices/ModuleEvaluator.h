#
ifndef
mozilla_ModuleEvaluator_h
#
define
mozilla_ModuleEvaluator_h
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
Maybe
.
h
"
#
include
"
mozilla
/
UntrustedModulesData
.
h
"
#
include
"
mozilla
/
Vector
.
h
"
#
include
"
mozilla
/
WinHeaderOnlyUtils
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIFile
.
h
"
#
include
"
nsString
.
h
"
#
include
<
shtypes
.
h
>
namespace
mozilla
{
class
ModuleRecord
;
class
MOZ_RAII
ModuleEvaluator
final
{
public
:
ModuleEvaluator
(
)
;
explicit
operator
bool
(
)
const
;
Maybe
<
ModuleTrustFlags
>
GetTrust
(
const
ModuleRecord
&
aModuleRecord
)
const
;
private
:
static
bool
ResolveKnownFolder
(
REFKNOWNFOLDERID
aFolderId
nsIFile
*
*
aOutFile
)
;
private
:
Maybe
<
ModuleVersion
>
mExeVersion
;
nsCOMPtr
<
nsIFile
>
mExeDirectory
;
nsCOMPtr
<
nsIFile
>
mSysDirectory
;
nsCOMPtr
<
nsIFile
>
mWinSxSDirectory
;
Vector
<
nsString
>
mKeyboardLayoutDlls
;
}
;
}
#
endif
