#
!
[
no_main
]
use
libfuzzer_sys
:
:
fuzz_target
;
use
std
:
:
io
:
:
Cursor
;
extern
crate
mozprofile
;
fuzz_target
!
(
|
data
:
&
[
u8
]
|
{
let
buf
=
Vec
:
:
new
(
)
;
let
mut
out
=
Cursor
:
:
new
(
buf
)
;
mozprofile
:
:
prefreader
:
:
parse
(
data
)
.
map
(
|
parsed
|
{
mozprofile
:
:
prefreader
:
:
serialize
(
&
parsed
&
mut
out
)
;
}
)
;
}
)
;
