'
use
strict
'
;
const
https
=
require
(
'
https
'
)
;
const
fs
=
require
(
'
fs
'
)
;
const
{
WebSocket
WebSocketServer
}
=
require
(
'
.
.
'
)
;
const
server
=
https
.
createServer
(
{
cert
:
fs
.
readFileSync
(
'
.
.
/
test
/
fixtures
/
certificate
.
pem
'
)
key
:
fs
.
readFileSync
(
'
.
.
/
test
/
fixtures
/
key
.
pem
'
)
}
)
;
const
wss
=
new
WebSocketServer
(
{
server
}
)
;
wss
.
on
(
'
connection
'
function
connection
(
ws
)
{
ws
.
on
(
'
message
'
function
message
(
msg
)
{
console
.
log
(
msg
.
toString
(
)
)
;
}
)
;
}
)
;
server
.
listen
(
function
listening
(
)
{
const
ws
=
new
WebSocket
(
wss
:
/
/
localhost
:
{
server
.
address
(
)
.
port
}
{
rejectUnauthorized
:
false
}
)
;
ws
.
on
(
'
open
'
function
open
(
)
{
ws
.
send
(
'
All
glory
to
WebSockets
!
'
)
;
}
)
;
}
)
;
