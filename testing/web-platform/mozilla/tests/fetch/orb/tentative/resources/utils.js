function
promise_internal_response_is_filtered
(
fetchPromise
message
)
{
return
promise_test
(
async
(
)
=
>
{
const
response
=
await
fetchPromise
;
const
unfiltered
=
SpecialPowers
.
wrap
(
response
)
.
cloneUnfiltered
(
)
;
assert_equals
(
await
SpecialPowers
.
unwrap
(
unfiltered
)
.
text
(
)
"
"
"
The
internal
response
should
be
empty
"
)
;
assert_equals
(
Array
.
from
(
await
SpecialPowers
.
unwrap
(
unfiltered
)
.
headers
)
.
length
0
"
The
internal
response
should
have
no
headers
"
)
;
}
message
)
;
}
