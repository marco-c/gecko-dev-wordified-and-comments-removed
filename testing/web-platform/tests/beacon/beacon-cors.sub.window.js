"
use
strict
"
;
[
true
false
]
.
forEach
(
function
(
allowCors
)
{
self
.
buildBaseUrl
=
function
(
baseUrl
)
{
return
"
http
:
/
/
{
{
domains
[
www
]
}
}
:
{
{
ports
[
http
]
[
0
]
}
}
"
;
}
;
self
.
buildTargetUrl
=
function
(
targetUrl
)
{
return
allowCors
?
{
targetUrl
}
&
origin
=
http
:
/
/
{
{
host
}
}
:
{
{
ports
[
http
]
[
0
]
}
}
&
credentials
=
true
:
targetUrl
;
}
const
tests
=
[
]
;
for
(
const
test
of
sampleTests
)
{
const
copy
=
Object
.
assign
(
{
}
test
)
;
copy
.
id
=
{
test
.
id
}
-
{
allowCors
?
"
CORS
-
ALLOW
"
:
"
CORS
-
FORBID
"
}
;
tests
.
push
(
copy
)
;
}
runTests
(
tests
)
;
}
)
;
{
self
.
buildBaseUrl
=
function
(
baseUrl
)
{
return
"
http
:
/
/
{
{
domains
[
www
]
}
}
:
{
{
ports
[
http
]
[
0
]
}
}
"
;
}
;
self
.
buildTargetUrl
=
function
(
targetUrl
)
{
return
{
targetUrl
}
&
origin
=
http
:
/
/
{
{
host
}
}
:
{
{
ports
[
http
]
[
0
]
}
}
&
credentials
=
true
&
preflightExpected
=
true
;
}
const
tests
=
[
]
;
for
(
const
test
of
preflightTests
)
{
const
copy
=
Object
.
assign
(
{
}
test
)
;
copy
.
id
=
{
test
.
id
}
-
PREFLIGHT
-
ALLOW
;
tests
.
push
(
copy
)
;
}
runTests
(
tests
)
;
}
done
(
)
;
