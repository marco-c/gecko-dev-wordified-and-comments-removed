'
use
strict
'
;
function
registerPassthroughAnimator
(
)
{
return
runInAnimationWorklet
(
registerAnimator
(
'
passthrough
'
class
{
animate
(
currentTime
effect
)
{
effect
.
localTime
=
currentTime
;
}
}
)
;
)
;
}
function
registerConstantLocalTimeAnimator
(
localTime
)
{
return
runInAnimationWorklet
(
registerAnimator
(
'
constant_time
'
class
{
animate
(
currentTime
effect
)
{
effect
.
localTime
=
{
localTime
}
;
}
}
)
;
)
;
}
function
runInAnimationWorklet
(
code
)
{
return
CSS
.
animationWorklet
.
addModule
(
URL
.
createObjectURL
(
new
Blob
(
[
code
]
{
type
:
'
text
/
javascript
'
}
)
)
)
;
}
function
waitForAsyncAnimationFrames
(
count
)
{
return
waitForAnimationFrames
(
count
+
1
)
;
}
async
function
waitForAnimationFrameWithCondition
(
condition
)
{
do
{
await
new
Promise
(
window
.
requestAnimationFrame
)
;
}
while
(
!
condition
(
)
)
}
;
