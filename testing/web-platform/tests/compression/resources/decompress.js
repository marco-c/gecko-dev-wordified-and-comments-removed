async
function
decompressData
(
chunk
format
)
{
const
ds
=
new
DecompressionStream
(
format
)
;
const
writer
=
ds
.
writable
.
getWriter
(
)
;
writer
.
write
(
chunk
)
;
writer
.
close
(
)
;
const
decompressedChunkList
=
await
Array
.
fromAsync
(
ds
.
readable
)
;
const
mergedBlob
=
new
Blob
(
decompressedChunkList
)
;
return
await
mergedBlob
.
bytes
(
)
;
}
async
function
decompressDataOrPako
(
chunk
format
)
{
if
(
[
"
deflate
"
"
gzip
"
]
.
includes
(
format
)
)
{
return
pako
.
inflate
(
chunk
)
;
}
if
(
format
=
=
=
"
deflate
-
raw
"
)
{
return
pako
.
inflateRaw
(
chunk
)
;
}
return
decompressData
(
chunk
format
)
;
}
