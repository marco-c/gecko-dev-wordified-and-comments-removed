'
use
strict
'
;
function
parseAssertionResult
(
assertionResultStr
)
{
const
assertionResult
=
JSON
.
parse
(
atob
(
assertionResultStr
)
)
;
const
{
idp
}
=
assertionResult
;
const
assertion
=
JSON
.
parse
(
assertionResult
.
assertion
)
;
return
{
idp
assertion
}
;
}
function
getIdpDomains
(
)
{
if
(
window
.
location
.
hostname
=
=
=
'
www1
.
web
-
platform
.
test
'
)
{
return
[
'
www
.
web
-
platform
.
test
'
'
www2
.
web
-
platform
.
test
'
]
;
}
else
if
(
window
.
location
.
hostname
=
=
=
'
www2
.
web
-
platform
.
test
'
)
{
return
[
'
www
.
web
-
platform
.
test
'
'
www1
.
web
-
platform
.
test
'
]
;
}
else
{
return
[
'
www1
.
web
-
platform
.
test
'
'
www2
.
web
-
platform
.
test
'
]
;
}
}
function
assert_rtcerror_rejection
(
errorDetail
promise
desc
)
{
return
promise
.
then
(
res
=
>
{
assert_unreached
(
Expect
promise
to
be
rejected
with
RTCError
but
instead
got
{
res
}
)
;
}
err
=
>
{
assert_true
(
err
instanceof
RTCError
'
Expect
error
object
to
be
instance
of
RTCError
'
)
;
assert_equals
(
err
.
errorDetail
errorDetail
Expect
RTCError
object
have
errorDetail
set
to
{
errorDetail
}
)
;
return
err
;
}
)
;
}
function
hostString
(
domain
port
)
{
if
(
port
=
=
=
'
'
)
{
return
domain
;
}
else
{
return
{
domain
}
:
{
port
}
;
}
}
