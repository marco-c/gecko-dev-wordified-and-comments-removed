'
use
strict
'
;
const
test_desc
=
'
A
device
disconnecting
after
the
BluetoothDevice
object
'
+
'
has
been
GC
\
'
ed
should
not
access
freed
memory
.
'
;
bluetooth_test
(
async
(
)
=
>
{
let
{
fake_peripheral
}
=
await
getConnectedHealthThermometerDevice
(
)
;
await
fake_peripheral
.
simulateGATTDisconnection
(
)
;
fake_peripheral
=
undefined
;
await
runGarbageCollection
(
)
;
await
new
Promise
(
resolve
=
>
step_timeout
(
resolve
50
)
)
;
}
test_desc
)
;
