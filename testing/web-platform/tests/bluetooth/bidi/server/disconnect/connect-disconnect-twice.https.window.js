'
use
strict
'
;
const
test_desc
=
'
Connect
+
Disconnect
twice
still
results
in
'
+
'
\
'
connected
\
'
being
false
.
'
;
let
device
fake_peripheral
;
bluetooth_bidi_test
(
async
(
)
=
>
{
let
{
device
fake_peripheral
}
=
await
getDiscoveredHealthThermometerDevice
(
)
;
await
fake_peripheral
.
setNextGATTConnectionResponse
(
{
code
:
HCI_SUCCESS
}
)
;
let
gattServer
=
await
device
.
gatt
.
connect
(
)
;
await
gattServer
.
disconnect
(
)
;
assert_false
(
gattServer
.
connected
)
;
gattServer
=
await
device
.
gatt
.
connect
(
)
;
await
gattServer
.
disconnect
(
)
;
assert_false
(
gattServer
.
connected
)
;
}
test_desc
)
;
