'
use
strict
'
;
const
test_desc
=
'
disconnect
(
)
and
connect
(
)
called
during
'
+
'
FUNCTION_NAME
.
Reject
with
NetworkError
.
'
;
const
expected
=
new
DOMException
(
'
GATT
Server
is
disconnected
.
Cannot
retrieve
characteristics
.
'
+
'
(
Re
)
connect
first
with
device
.
gatt
.
connect
.
'
'
NetworkError
'
)
;
let
device
;
bluetooth_test
(
(
)
=
>
getHealthThermometerDeviceWithServicesDiscovered
(
{
filters
:
[
{
services
:
[
health_thermometer
.
name
]
}
]
}
)
.
then
(
_
=
>
(
{
device
}
=
_
)
)
.
then
(
(
)
=
>
device
.
gatt
.
getPrimaryService
(
health_thermometer
.
name
)
)
.
then
(
service
=
>
Promise
.
all
(
[
assert_promise_rejects_with_message
(
service
.
CALLS
(
[
getCharacteristic
(
measurement_interval
.
name
)
|
getCharacteristics
(
)
|
getCharacteristics
(
measurement_interval
.
name
)
[
UUID
]
]
)
expected
)
device
.
gatt
.
disconnect
(
)
device
.
gatt
.
connect
(
)
]
)
)
test_desc
)
;
