function
executeTestsSerially
(
testList
setup
teardown
)
{
var
tests
=
testList
.
map
(
function
(
t
)
{
return
{
test
:
async_test
(
t
[
0
]
)
code
:
t
[
1
]
}
;
}
)
;
var
executeNextTest
=
function
(
)
{
var
current
=
tests
.
shift
(
)
;
if
(
current
=
=
=
undefined
)
{
return
;
}
if
(
setup
)
{
setup
(
)
;
}
if
(
teardown
)
{
current
.
test
.
add_cleanup
(
teardown
)
;
}
current
.
test
.
step
(
current
.
code
)
;
}
;
add_result_callback
(
function
(
)
{
setTimeout
(
executeNextTest
0
)
}
)
;
executeNextTest
(
)
;
}
