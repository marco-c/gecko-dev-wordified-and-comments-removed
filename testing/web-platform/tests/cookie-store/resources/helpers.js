self
.
createIframe
=
(
url
t
)
=
>
new
Promise
(
resolve
=
>
{
const
iframe
=
document
.
createElement
(
'
iframe
'
)
;
iframe
.
addEventListener
(
'
load
'
(
)
=
>
{
resolve
(
iframe
)
;
}
{
once
:
true
}
)
;
iframe
.
src
=
url
;
document
.
documentElement
.
appendChild
(
iframe
)
;
t
.
add_cleanup
(
(
)
=
>
iframe
.
remove
(
)
)
;
}
)
;
self
.
waitForMessage
=
(
)
=
>
new
Promise
(
resolve
=
>
{
window
.
addEventListener
(
'
message
'
event
=
>
{
resolve
(
event
.
data
)
;
}
{
once
:
true
}
)
;
}
)
;
