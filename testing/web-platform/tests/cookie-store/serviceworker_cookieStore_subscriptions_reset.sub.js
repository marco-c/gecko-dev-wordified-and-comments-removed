self
.
GLOBAL
=
{
isWindow
:
function
(
)
{
return
false
;
}
isWorker
:
function
(
)
{
return
true
;
}
}
;
importScripts
(
"
/
resources
/
testharness
.
js
"
)
;
self
.
addEventListener
(
'
install
'
event
=
>
{
event
.
waitUntil
(
(
async
(
)
=
>
{
try
{
await
cookieStore
.
subscribeToChanges
(
[
{
name
:
'
cookie
-
name
'
matchType
:
'
equals
'
url
:
'
/
cookie
-
store
/
scope
/
path
'
}
]
)
;
}
catch
(
err
)
{
}
}
)
(
)
)
;
}
)
;
self
.
addEventListener
(
'
message
'
async
event
=
>
{
const
subscriptions
=
await
cookieStore
.
getChangeSubscriptions
(
)
;
event
.
ports
[
0
]
.
postMessage
(
subscriptions
.
length
)
;
}
)
;
