navigator
.
serviceWorker
.
addEventListener
(
"
message
"
async
ev
=
>
{
if
(
ev
.
data
=
=
=
"
notification
-
create
"
)
{
const
scope
=
"
scope
"
+
window
.
location
.
pathname
;
const
reg
=
await
navigator
.
serviceWorker
.
getRegistration
(
scope
)
;
await
reg
.
showNotification
(
"
Created
from
window
"
)
;
reg
.
active
.
postMessage
(
"
notification
-
created
"
)
;
}
}
)
;
promise_setup
(
(
)
=
>
{
return
test_driver
.
set_permission
(
{
name
:
"
notifications
"
}
"
granted
"
)
;
}
)
;
service_worker_test
(
"
getnotifications
-
sw
.
js
"
"
Service
worker
test
setup
"
)
;
