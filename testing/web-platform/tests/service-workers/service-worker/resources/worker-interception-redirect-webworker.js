const
resources_url
=
new
URL
(
"
/
service
-
workers
/
service
-
worker
/
resources
/
"
self
.
location
)
;
let
greeting
=
'
%
GREETING_TEXT
%
'
;
if
(
!
greeting
)
greeting
=
'
the
shared
worker
script
was
served
from
network
'
;
self
.
onconnect
=
async
function
(
e
)
{
const
port
=
e
.
ports
[
0
]
;
port
.
start
(
)
;
port
.
postMessage
(
greeting
)
;
const
fetch_url
=
new
URL
(
'
simple
.
txt
'
resources_url
)
;
const
response
=
await
fetch
(
fetch_url
)
;
const
text
=
await
response
.
text
(
)
;
port
.
postMessage
(
'
fetch
(
)
:
'
+
text
)
;
}
;
