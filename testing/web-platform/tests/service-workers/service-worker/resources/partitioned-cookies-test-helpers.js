function
worker_message_generator
(
)
{
const
buffer
=
[
]
;
let
resolve
=
null
;
navigator
.
serviceWorker
.
addEventListener
(
'
message
'
message
=
>
{
buffer
.
push
(
message
.
data
)
;
if
(
resolve
)
{
resolve
(
)
;
}
}
)
;
return
async
function
(
)
{
if
(
buffer
.
length
!
=
0
)
{
return
buffer
.
shift
(
)
;
}
await
new
Promise
(
r
=
>
resolve
=
r
)
;
return
buffer
.
shift
(
)
;
}
}
