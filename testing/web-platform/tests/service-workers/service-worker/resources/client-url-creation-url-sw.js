addEventListener
(
'
message
'
message_event
=
>
{
const
port
=
message_event
.
data
.
port
;
const
async_work
=
async
(
)
=
>
{
try
{
const
clients
=
await
self
.
clients
.
matchAll
(
)
;
if
(
clients
.
length
=
=
1
)
{
const
client
=
clients
[
0
]
;
port
.
postMessage
(
client
.
url
)
;
}
else
{
port
.
postMessage
(
error
:
expected
1
client
not
{
clients
.
length
}
)
;
}
}
catch
(
error
)
{
port
.
postMessage
(
error
:
{
error
.
message
}
)
;
}
}
;
message_event
.
waitUntil
(
async_work
(
)
)
;
}
)
;
