globalThis
.
setShadowRealmGlobalProperties
=
function
(
queryString
fetchAdaptor
)
{
globalThis
.
fetch_json
=
(
resource
)
=
>
{
const
executor
=
fetchAdaptor
(
resource
)
;
return
new
Promise
(
executor
)
.
then
(
(
s
)
=
>
JSON
.
parse
(
s
)
)
;
}
;
globalThis
.
fetch_spec
=
(
spec
)
=
>
{
const
resource
=
/
interfaces
/
{
spec
}
.
idl
;
const
executor
=
fetchAdaptor
(
resource
)
;
return
new
Promise
(
executor
)
.
then
(
idl
=
>
(
{
spec
idl
}
)
(
)
=
>
{
throw
new
IdlHarnessError
(
Error
fetching
{
resource
}
.
)
;
}
)
;
}
globalThis
.
location
=
{
search
:
queryString
}
;
}
;
globalThis
.
GLOBAL
=
{
isWindow
:
function
(
)
{
return
false
;
}
isWorker
:
function
(
)
{
return
false
;
}
isShadowRealm
:
function
(
)
{
return
true
;
}
}
;
