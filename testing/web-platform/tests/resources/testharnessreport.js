function
dump_test_results
(
tests
status
)
{
var
results_element
=
document
.
createElement
(
"
script
"
)
;
results_element
.
type
=
"
text
/
json
"
;
results_element
.
id
=
"
__testharness__results__
"
;
var
test_results
=
tests
.
map
(
function
(
x
)
{
return
{
name
:
x
.
name
status
:
x
.
status
message
:
x
.
message
stack
:
x
.
stack
}
}
)
;
var
data
=
{
test
:
window
.
location
.
href
tests
:
test_results
status
:
status
.
status
message
:
status
.
message
stack
:
status
.
stack
}
;
results_element
.
textContent
=
JSON
.
stringify
(
data
)
;
var
parent
=
document
.
body
?
document
.
body
:
document
.
documentElement
;
parent
.
appendChild
(
results_element
)
;
}
add_completion_callback
(
dump_test_results
)
;
try
{
if
(
window
.
opener
&
&
"
testharness_properties
"
in
window
.
opener
)
{
setup
(
JSON
.
parse
(
JSON
.
stringify
(
window
.
opener
.
testharness_properties
)
)
)
;
}
}
catch
(
e
)
{
}
