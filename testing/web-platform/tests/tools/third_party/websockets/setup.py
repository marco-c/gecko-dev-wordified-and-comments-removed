import
os
import
pathlib
import
re
import
setuptools
root_dir
=
pathlib
.
Path
(
__file__
)
.
parent
exec
(
(
root_dir
/
"
src
"
/
"
websockets
"
/
"
version
.
py
"
)
.
read_text
(
encoding
=
"
utf
-
8
"
)
)
long_description
=
re
.
sub
(
    
r
"
^
\
.
\
.
raw
:
:
html
.
*
?
^
(
?
=
\
w
)
"
    
"
"
    
(
root_dir
/
"
README
.
rst
"
)
.
read_text
(
encoding
=
"
utf
-
8
"
)
    
flags
=
re
.
DOTALL
|
re
.
MULTILINE
)
if
os
.
environ
.
get
(
"
BUILD_EXTENSION
"
)
=
=
"
no
"
:
    
ext_modules
=
[
]
else
:
    
ext_modules
=
[
        
setuptools
.
Extension
(
            
"
websockets
.
speedups
"
            
sources
=
[
"
src
/
websockets
/
speedups
.
c
"
]
            
optional
=
os
.
environ
.
get
(
"
BUILD_EXTENSION
"
)
!
=
"
yes
"
        
)
    
]
setuptools
.
setup
(
    
version
=
version
    
long_description
=
long_description
    
ext_modules
=
ext_modules
)
