"
use
strict
;
"
const
privateRequests
=
[
'
resources
/
trusted
-
bidding
-
signals
.
py
'
'
update
-
url
.
py
'
'
wasm
-
helper
.
py
'
'
bidding
-
logic
.
py
'
'
decision
-
logic
.
py
'
'
trusted
-
scoring
-
signals
.
py
'
'
trusted
-
bidding
-
signals
.
py
'
'
bidder_report
'
'
seller_report
'
]
;
const
publicRequests
=
[
'
direct
-
from
-
seller
-
signals
.
py
'
]
;
self
.
addEventListener
(
'
fetch
'
(
event
)
=
>
{
const
privateRequestChannel
=
new
BroadcastChannel
(
'
private
-
requests
-
test
'
)
;
const
publicRequestChannel
=
new
BroadcastChannel
(
'
public
-
requests
-
test
'
)
;
privateRequests
.
forEach
(
privateRequest
=
>
{
if
(
event
.
request
.
url
.
includes
(
privateRequest
)
)
{
privateRequestChannel
.
postMessage
(
{
result
:
'
failed
'
message
:
"
service
worker
should
not
have
seen
:
"
+
privateRequest
}
)
;
}
}
)
;
publicRequests
.
forEach
(
publicRequest
=
>
{
if
(
event
.
request
.
url
.
includes
(
publicRequest
)
)
{
publicRequestChannel
.
postMessage
(
{
result
:
'
passed
'
message
:
"
service
worker
properly
saw
:
"
+
publicRequest
}
)
;
}
}
)
;
if
(
event
.
request
.
url
.
includes
(
'
COMPLETE
-
TEST
'
)
)
{
privateRequestChannel
.
postMessage
(
{
result
:
'
completed
'
}
)
;
}
}
)
;
