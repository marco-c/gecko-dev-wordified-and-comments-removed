async
function
openWebSocket
(
remoteContextHelper
)
{
let
return_value
=
await
remoteContextHelper
.
executeScript
(
(
domain
)
=
>
{
return
new
Promise
(
(
resolve
)
=
>
{
var
webSocketInNotRestoredReasonsTests
=
new
WebSocket
(
domain
+
'
/
echo
'
)
;
webSocketInNotRestoredReasonsTests
.
onopen
=
(
)
=
>
{
resolve
(
42
)
;
}
;
}
)
;
}
[
SCHEME_DOMAIN_PORT
]
)
;
assert_equals
(
return_value
42
)
;
}
async
function
openThenCloseWebSocket
(
remoteContextHelper
)
{
let
return_value
=
await
remoteContextHelper
.
executeScript
(
(
domain
)
=
>
{
return
new
Promise
(
(
resolve
)
=
>
{
var
testWebSocket
=
new
WebSocket
(
domain
+
'
/
echo
'
)
;
testWebSocket
.
onopen
=
(
)
=
>
{
testWebSocket
.
close
(
)
}
;
testWebSocket
.
onclose
=
(
)
=
>
{
resolve
(
42
)
}
;
}
)
;
}
[
SCHEME_DOMAIN_PORT
]
)
;
assert_equals
(
return_value
42
)
;
}
