const
test_cases
=
[
{
origin
:
get_host_info
(
)
.
HTTP_REMOTE_ORIGIN
signature
:
signature
=
:
WZp87p7X3ELfgIKL
/
qxsY
/
CT6XArMvZRaxcJ3uy1QklEcLf0c8tol2
+
W2pvaXX4jnd7hGevFVkzWE77rCOIzAA
=
=
:
}
{
origin
:
get_host_info
(
)
.
HTTPS_REMOTE_ORIGIN
signature
:
signature
=
:
lMzR8lIXYG0Iz0MmTXcRTcBfNw6TgBAPfaNLAU1LzsxWC5dlez8SNe7aCW7avHTWKgaqTGBCMW1LgxkHlijgDA
=
=
:
}
]
for
(
const
test_case
of
test_cases
)
{
const
request
=
{
cors
:
true
body
:
"
window
.
hello
=
world
;
"
digest
:
"
sha
-
256
=
:
PZJ
+
9CdAAIacg7wfUe4t
/
RkDQJVKM0mCZ2K7qiRhHFc
=
:
"
signatureInput
:
signature
=
(
"
unencoded
-
digest
"
;
sf
"
scheme
"
;
req
)
;
keyid
=
"
{
kValidKeys
[
'
rfc
'
]
}
"
;
tag
=
"
sri
"
signature
:
test_case
.
signature
}
;
generate_fetch_test
(
request
{
origin
:
test_case
.
origin
}
EXPECT_LOADED
Valid
signature
(
{
request
.
signature
}
)
no
integrity
check
:
loads
.
)
;
generate_fetch_test
(
request
{
origin
:
test_case
.
origin
integrity
:
ed25519
-
{
kValidKeys
[
'
rfc
'
]
}
}
EXPECT_LOADED
Valid
signature
(
{
request
.
signature
}
)
matching
integrity
check
:
loads
.
)
;
generate_fetch_test
(
request
{
origin
:
test_case
.
origin
integrity
:
ed25519
-
{
kInvalidKey
}
}
EXPECT_BLOCKED
Valid
signature
(
{
request
.
signature
}
)
mismatched
integrity
check
:
blocked
.
)
;
}
