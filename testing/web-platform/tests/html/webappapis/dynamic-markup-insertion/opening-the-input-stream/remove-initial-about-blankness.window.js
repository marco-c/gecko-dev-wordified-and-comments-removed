async_test
(
t
=
>
{
const
iframe
=
document
.
createElement
(
"
iframe
"
)
;
iframe
.
src
=
"
/
common
/
blank
.
html
"
;
document
.
body
.
append
(
iframe
)
;
iframe
.
contentWindow
.
persistedString
=
"
Hello
world
!
"
;
iframe
.
contentDocument
.
open
(
)
;
iframe
.
src
=
"
/
common
/
blank
.
html
"
;
iframe
.
addEventListener
(
"
load
"
t
.
step_func_done
(
(
)
=
>
{
assert_equals
(
iframe
.
contentDocument
.
URL
iframe
.
src
"
Prerequisite
check
:
we
are
getting
the
right
load
event
"
)
;
assert_equals
(
iframe
.
contentWindow
.
persistedString
undefined
)
;
}
)
{
once
:
true
}
)
;
}
"
document
.
open
(
)
removes
the
initial
about
:
blank
-
ness
of
the
document
"
)
;
async_test
(
t
=
>
{
const
iframe
=
document
.
createElement
(
"
iframe
"
)
;
iframe
.
src
=
"
/
common
/
blank
.
html
"
;
document
.
body
.
append
(
iframe
)
;
iframe
.
contentWindow
.
persistedString
=
"
Hello
world
!
"
;
iframe
.
src
=
"
/
common
/
blank
.
html
"
;
iframe
.
addEventListener
(
"
load
"
t
.
step_func_done
(
(
)
=
>
{
assert_equals
(
iframe
.
contentDocument
.
URL
iframe
.
src
"
Prerequisite
check
:
we
are
getting
the
right
load
event
"
)
;
assert_equals
(
iframe
.
contentWindow
.
persistedString
"
Hello
world
!
"
)
;
}
)
{
once
:
true
}
)
;
}
"
Double
-
check
:
without
document
.
open
(
)
Window
reuse
indeed
happens
"
)
;
