function
runStructuredCloneBatteryOfTests
(
runner
)
{
const
defaultRunner
=
{
setup
(
)
{
}
preTest
(
)
{
}
postTest
(
)
{
}
teardown
(
)
{
}
hasDocument
:
true
}
;
runner
=
Object
.
assign
(
{
}
defaultRunner
runner
)
;
let
setupPromise
=
runner
.
setup
(
)
;
const
allTests
=
structuredCloneBatteryOfTests
.
map
(
test
=
>
{
if
(
!
runner
.
hasDocument
&
&
test
.
requiresDocument
)
{
return
;
}
return
new
Promise
(
resolve
=
>
{
promise_test
(
async
t
=
>
{
test
=
await
test
;
await
setupPromise
;
await
runner
.
preTest
(
test
)
;
await
test
.
f
(
runner
t
)
await
runner
.
postTest
(
test
)
;
resolve
(
)
;
}
test
.
description
)
;
}
)
.
catch
(
_
=
>
{
}
)
;
}
)
;
Promise
.
all
(
allTests
)
.
then
(
_
=
>
runner
.
teardown
(
)
)
;
}
