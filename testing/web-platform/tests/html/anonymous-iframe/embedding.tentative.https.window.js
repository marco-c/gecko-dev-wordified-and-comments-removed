const
{
REMOTE_ORIGIN
}
=
get_host_info
(
)
;
subsetTest
(
embeddingTest
"
Parent
embeds
same
-
origin
credentialless
iframe
"
{
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
Parent
embeds
cross
-
origin
credentialless
iframe
"
{
child_origin
:
REMOTE_ORIGIN
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
COEP
:
require
-
corp
parent
embeds
same
-
origin
credentialless
iframe
"
{
parent_headers
:
coep_require_corp
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
COEP
:
require
-
corp
parent
embeds
cross
-
origin
credentialless
iframe
"
{
parent_headers
:
coep_require_corp
child_origin
:
REMOTE_ORIGIN
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
COEP
:
credentialless
parent
embeds
same
-
origin
credentialless
iframe
"
{
parent_headers
:
coep_credentialless
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
COEP
:
credentialless
parent
embeds
cross
-
origin
credentialless
iframe
"
{
parent_headers
:
coep_credentialless
child_origin
:
REMOTE_ORIGIN
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
COOP
:
same
-
origin
+
COEP
:
require
-
corp
embeds
same
-
origin
credentialless
iframe
"
{
parent_headers
:
coop_same_origin
+
coep_require_corp
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
COOP
:
same
-
origin
+
COEP
:
require
-
corp
embeds
cross
-
origin
credentialless
iframe
"
{
parent_headers
:
coop_same_origin
+
coep_require_corp
child_origin
:
REMOTE_ORIGIN
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
COOP
:
same
-
origin
+
COEP
:
credentialless
embeds
same
-
origin
credentialless
iframe
"
{
parent_headers
:
coop_same_origin
+
coep_credentialless
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
COOP
:
same
-
origin
+
COEP
:
credentialless
embeds
cross
-
origin
credentialless
iframe
"
{
parent_headers
:
coop_same_origin
+
coep_credentialless
child_origin
:
REMOTE_ORIGIN
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
Parents
embeds
a
CSP
:
frame
-
ancestors
credentialless
iframe
"
{
child_headers
:
"
|
header
(
Content
-
Security
-
Policy
frame
-
ancestors
'
none
'
)
"
expectation
:
EXPECT_BLOCK
}
)
;
subsetTest
(
embeddingTest
"
Cross
-
Origin
-
Isolated
parent
embeds
same
-
origin
COEP
credentialless
iframe
"
{
parent_headers
:
coop_same_origin
+
coep_require_corp
child_headers
:
coop_same_origin
+
coep_require_corp
expectation
:
EXPECT_LOAD
}
)
;
subsetTest
(
embeddingTest
"
Cross
-
Origin
-
Isolated
parent
embeds
cross
-
origin
COEP
credentialless
iframe
"
{
parent_headers
:
coop_same_origin
+
coep_require_corp
child_headers
:
coop_same_origin
+
coep_require_corp
child_origin
:
REMOTE_ORIGIN
expectation
:
EXPECT_LOAD
}
)
;
