promise_test
(
async
test
=
>
{
const
test_token
=
token
(
)
;
const
child_token
=
token
(
)
;
const
redirecting_child_url
=
cross_origin
+
"
/
common
/
dispatcher
/
executor
.
html
?
uuid
=
"
+
child_token
;
const
child_url
=
same_origin
+
"
/
html
/
cross
-
origin
-
embedder
-
policy
/
credentialless
/
resources
/
redirect_none_to_credentialless
.
py
?
redirectTo
=
"
+
redirecting_child_url
;
await
send
(
newWindow
(
coep_credentialless
)
let
iframe
=
document
.
createElement
(
"
iframe
"
)
;
iframe
.
src
=
"
{
child_url
}
"
;
document
.
body
.
appendChild
(
iframe
)
;
)
;
await
send
(
child_token
send
(
"
{
test_token
}
"
"
load
"
)
;
)
;
step_timeout
(
(
)
=
>
send
(
test_token
"
block
"
)
6000
)
;
assert_equals
(
await
receive
(
test_token
)
EXPECT_LOAD
)
;
}
)
;
