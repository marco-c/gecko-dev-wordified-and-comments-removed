'
use
strict
'
;
promise_test
(
async
t
=
>
{
await
ensureLanguageModel
(
)
;
const
session
=
await
createLanguageModel
(
)
;
const
streamingResponse
=
session
.
promptStreaming
(
kTestPrompt
)
;
assert_equals
(
Object
.
prototype
.
toString
.
call
(
streamingResponse
)
"
[
object
ReadableStream
]
"
)
;
const
reader
=
streamingResponse
.
getReader
(
)
;
let
result
=
"
"
;
while
(
true
)
{
const
{
value
done
}
=
await
reader
.
read
(
)
;
if
(
done
)
{
break
;
}
if
(
value
)
{
result
+
=
value
;
}
}
assert_greater_than
(
result
.
length
0
"
The
result
should
not
be
empty
.
"
)
;
}
)
;
