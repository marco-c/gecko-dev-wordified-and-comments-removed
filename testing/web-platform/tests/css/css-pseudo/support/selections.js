function
selectRangeWith
(
fun
)
{
const
selection
=
getSelection
(
)
;
selection
.
removeAllRanges
(
)
;
const
range
=
document
.
createRange
(
)
;
fun
(
range
)
;
selection
.
addRange
(
range
)
;
}
function
selectNodeContents
(
node
)
{
const
previousActive
=
document
.
activeElement
;
selectRangeWith
(
range
=
>
range
.
selectNodeContents
(
node
)
)
;
if
(
document
.
activeElement
!
=
previousActive
)
{
document
.
activeElement
.
blur
(
)
;
}
}
function
trySpellcheck
(
.
.
.
nodes
)
{
const
interval
=
setInterval
(
(
)
=
>
{
if
(
nodes
.
length
>
0
)
{
const
node
=
nodes
.
shift
(
)
;
node
.
focus
(
)
;
node
.
blur
(
)
;
}
else
{
clearInterval
(
interval
)
;
}
}
250
)
;
}
