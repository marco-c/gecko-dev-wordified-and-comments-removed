'
use
strict
'
;
function
set_up_fuzzy_color_test
(
epsilon
)
{
if
(
!
epsilon
)
{
epsilon
=
0
.
01
;
}
function
fuzzy_compare_colors
(
input
expected
)
{
const
colorElementDividers
=
/
(
|
\
(
|
)
/
;
function
getNonNumbers
(
color
)
{
return
color
.
replace
(
/
[
0
-
9
\
.
]
/
g
'
'
)
;
}
function
getNumbers
(
color
)
{
const
result
=
[
]
;
color
.
split
(
colorElementDividers
)
.
forEach
(
element
=
>
{
const
numberElement
=
parseFloat
(
element
)
;
if
(
!
isNaN
(
numberElement
)
)
{
result
.
push
(
numberElement
)
;
}
}
)
;
return
result
;
}
try
{
assert_array_approx_equals
(
getNumbers
(
input
)
getNumbers
(
expected
)
epsilon
"
Numeric
parameters
are
approximately
equal
.
"
)
;
assert_equals
(
getNonNumbers
(
input
)
getNonNumbers
(
expected
)
"
Color
format
is
correct
.
"
)
;
}
catch
(
error
)
{
throw
Colors
do
not
match
.
\
nActual
:
{
input
}
\
nExpected
:
{
expected
}
.
\
n
{
error
}
}
}
return
fuzzy_compare_colors
;
}
function
fuzzy_test_computed_color
(
specified
computed
epsilon
)
{
if
(
!
computed
)
{
test_computed_value
(
"
color
"
specified
)
;
return
;
}
test_computed_value
(
"
color
"
specified
computed
undefined
{
comparisonFunction
:
set_up_fuzzy_color_test
(
epsilon
)
}
)
;
}
function
fuzzy_test_valid_color
(
specified
parsed
epsilon
)
{
if
(
!
parsed
)
{
test_valid_value
(
"
color
"
specified
)
;
return
;
}
test_valid_value
(
"
color
"
specified
parsed
{
comparisonFunction
:
set_up_fuzzy_color_test
(
epsilon
)
}
)
;
}
