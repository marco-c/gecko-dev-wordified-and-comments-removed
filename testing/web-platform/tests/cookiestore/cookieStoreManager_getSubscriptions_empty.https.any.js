'
use
strict
'
;
promise_test
(
async
testCase
=
>
{
if
(
self
.
GLOBAL
.
isWindow
(
)
)
{
const
registration
=
await
service_worker_unregister_and_register
(
testCase
'
resources
/
empty_sw
.
js
'
'
resources
/
does
/
not
/
exist
'
)
;
testCase
.
add_cleanup
(
(
)
=
>
registration
.
unregister
(
)
)
;
await
wait_for_state
(
testCase
registration
.
installing
'
activated
'
)
;
self
.
registration
=
registration
;
}
else
{
await
new
Promise
(
resolve
=
>
{
self
.
addEventListener
(
'
activate
'
event
=
>
{
resolve
(
)
;
}
)
;
}
)
;
}
const
subscriptions
=
await
registration
.
cookies
.
getSubscriptions
(
)
;
assert_equals
(
subscriptions
.
length
0
)
;
}
'
getSubscriptions
returns
an
empty
array
when
there
are
no
subscriptions
'
)
;
