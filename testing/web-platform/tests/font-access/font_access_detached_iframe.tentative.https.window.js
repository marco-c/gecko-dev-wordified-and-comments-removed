'
use
strict
'
;
font_access_test
(
async
t
=
>
{
const
iframe
=
document
.
createElement
(
'
iframe
'
)
;
document
.
body
.
appendChild
(
iframe
)
;
const
iframeFontManager
=
iframe
.
contentWindow
.
navigator
.
fonts
;
const
frameDOMException
=
iframe
.
contentWindow
.
DOMException
;
iframe
.
remove
(
)
;
await
promise_rejects_dom
(
t
'
InvalidStateError
'
frameDOMException
iframeFontManager
.
query
(
)
)
;
}
'
query
(
)
must
return
an
error
when
called
from
a
detached
iframe
.
'
)
;
font_access_test
(
async
t
=
>
{
const
iframe
=
document
.
createElement
(
'
iframe
'
)
;
document
.
body
.
appendChild
(
iframe
)
;
const
iframeFontManager
=
iframe
.
contentWindow
.
navigator
.
fonts
;
iframeFontManager
.
query
(
)
;
iframe
.
remove
(
)
;
await
navigator
.
fonts
.
query
(
)
;
}
'
Detaching
iframe
while
query
(
)
settles
.
'
)
;
