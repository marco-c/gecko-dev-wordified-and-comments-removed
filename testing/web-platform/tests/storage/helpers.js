function
createDB
(
dbName
objectStoreName
t
)
{
return
new
Promise
(
(
resolve
reject
)
=
>
{
const
openRequest
=
indexedDB
.
open
(
dbName
)
;
t
.
add_cleanup
(
(
)
=
>
{
indexedDB
.
deleteDatabase
(
dbName
)
;
}
)
;
openRequest
.
onerror
=
(
)
=
>
{
reject
(
openRequest
.
error
)
;
}
;
openRequest
.
onsuccess
=
(
)
=
>
{
resolve
(
openRequest
.
result
)
;
}
;
openRequest
.
onupgradeneeded
=
event
=
>
{
openRequest
.
result
.
createObjectStore
(
objectStoreName
)
;
}
;
}
)
;
}
function
transactionPromise
(
transaction
)
{
return
new
Promise
(
(
resolve
reject
)
=
>
{
transaction
.
onabort
=
(
)
=
>
{
reject
(
transaction
.
error
)
;
}
;
transaction
.
oncomplete
=
(
)
=
>
{
resolve
(
)
;
}
;
}
)
;
}
