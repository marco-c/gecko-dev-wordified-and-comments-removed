'
use
strict
'
;
function
waitForDocumentReady
(
)
{
return
new
Promise
(
resolve
=
>
{
if
(
document
.
readyState
=
=
=
'
complete
'
)
{
resolve
(
)
;
}
window
.
addEventListener
(
'
load
'
(
)
=
>
{
resolve
(
)
;
}
{
once
:
true
}
)
;
}
)
;
}
function
addSpeculationRulesAndLink
(
speculationRules
targetUrl
linkText
=
'
Test
Link
'
)
{
const
script
=
document
.
createElement
(
'
script
'
)
;
script
.
type
=
'
speculationrules
'
;
script
.
textContent
=
JSON
.
stringify
(
speculationRules
)
;
document
.
head
.
appendChild
(
script
)
;
const
link
=
document
.
createElement
(
'
a
'
)
;
link
.
href
=
targetUrl
;
link
.
textContent
=
linkText
;
document
.
body
.
appendChild
(
link
)
;
return
{
script
link
}
;
}
