promise_test
(
async
(
)
=
>
{
assert_equals
(
resources_script_result
'
loaded
from
webbundle
'
)
;
}
'
A
subresource
script
.
js
should
be
loaded
from
WebBundle
using
the
relative
'
+
'
URL
.
'
)
;
promise_test
(
async
(
)
=
>
{
const
resource_url
=
'
/
web
-
bundle
/
resources
/
wbn
/
root
.
js
'
;
const
element
=
createWebBundleElement
(
'
.
.
/
resources
/
wbn
/
subresource
.
wbn
'
[
resource_url
]
)
;
document
.
body
.
appendChild
(
element
)
;
const
response
=
await
fetch
(
resource_url
)
;
assert_true
(
response
.
ok
)
;
const
root
=
await
response
.
text
(
)
;
assert_equals
(
root
'
export
*
from
\
'
.
/
submodule
.
js
\
'
;
\
n
'
)
;
}
'
Subresources
with
relative
URLs
should
be
loaded
from
the
WebBundle
.
'
)
;
promise_test
(
async
(
)
=
>
{
const
resource_url
=
'
web
-
bundle
/
resources
/
wbn
/
root
.
js
'
;
const
element
=
createWebBundleElement
(
'
.
.
/
resources
/
wbn
/
subresource
.
wbn
'
[
resource_url
]
)
;
document
.
body
.
appendChild
(
element
)
;
const
response
=
await
fetch
(
resource_url
)
;
assert_false
(
response
.
ok
)
;
}
'
Wrong
relative
URL
should
result
in
a
failed
fetch
.
'
)
;
