function
appendIframeWith
(
t
doc
func
)
{
return
new
Promise
(
resolve
=
>
{
const
child
=
doc
.
createElement
(
"
iframe
"
)
;
func
(
child
)
;
child
.
onload
=
(
)
=
>
{
resolve
(
child
)
;
}
;
doc
.
body
.
appendChild
(
child
)
;
t
.
add_cleanup
(
(
)
=
>
{
doc
.
body
.
removeChild
(
child
)
;
}
)
;
}
)
;
}
function
appendIframe
(
t
doc
src
)
{
return
appendIframeWith
(
t
doc
child
=
>
{
child
.
src
=
src
;
}
)
;
}
function
futureMessage
(
)
{
return
new
Promise
(
resolve
=
>
{
window
.
addEventListener
(
"
message
"
e
=
>
resolve
(
e
.
data
)
)
;
}
)
;
}
;
