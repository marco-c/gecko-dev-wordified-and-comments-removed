'
use
strict
'
;
const
QUOTA_PER_ORIGIN
=
64
*
1024
;
const
QUOTA_PER_CROSS_ORIGIN
=
8
*
1024
;
const
QUOTA_PER_REPORTING_ORIGIN
=
64
*
1024
;
function
getRemainingQuota
(
maxQuota
url
headers
=
{
}
)
{
let
quota
=
maxQuota
-
url
.
length
;
if
(
headers
instanceof
Headers
)
{
for
(
const
kv
of
headers
.
entries
(
)
)
{
quota
-
=
kv
[
0
]
.
length
+
kv
[
1
]
.
length
;
}
}
return
quota
>
0
?
quota
:
0
;
}
