'
use
strict
'
;
promise_test
(
async
t
=
>
{
const
response
=
await
fetch
(
'
.
.
/
resources
/
huge
-
response
.
py
'
)
;
const
reader
=
response
.
body
.
getReader
(
)
;
const
{
value
done
}
=
await
reader
.
read
(
)
;
assert_false
(
done
'
there
should
be
some
data
'
)
;
assert_greater_than
(
value
.
byteLength
0
'
the
chunk
should
be
non
-
empty
'
)
;
await
new
Promise
(
resolve
=
>
t
.
step_timeout
(
resolve
2000
)
)
;
reader
.
cancel
(
)
;
}
'
fetching
a
huge
cacheable
file
but
not
reading
it
should
not
crash
'
)
;
