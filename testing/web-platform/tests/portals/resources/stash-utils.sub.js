const
STASH_RESPONDER
=
"
wss
:
/
/
{
{
host
}
}
:
{
{
ports
[
wss
]
[
0
]
}
}
/
stash_responder_blocking
"
;
class
StashUtils
{
static
putValue
(
key
value
)
{
return
new
Promise
(
resolve
=
>
{
const
ws
=
new
WebSocket
(
STASH_RESPONDER
)
;
ws
.
onopen
=
(
)
=
>
{
ws
.
send
(
JSON
.
stringify
(
{
action
:
'
set
'
key
:
key
value
:
value
}
)
)
;
}
;
ws
.
onmessage
=
e
=
>
{
ws
.
close
(
)
;
resolve
(
)
;
}
;
}
)
;
}
static
takeValue
(
key
)
{
return
new
Promise
(
resolve
=
>
{
const
ws
=
new
WebSocket
(
STASH_RESPONDER
)
;
ws
.
onopen
=
(
)
=
>
{
ws
.
send
(
JSON
.
stringify
(
{
action
:
'
get
'
key
:
key
}
)
)
;
}
;
ws
.
onmessage
=
e
=
>
{
ws
.
close
(
)
;
resolve
(
JSON
.
parse
(
e
.
data
)
.
value
)
;
}
;
}
)
;
}
}
