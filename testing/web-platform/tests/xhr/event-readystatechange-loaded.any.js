var
test
=
async_test
(
)
;
test
.
step
(
function
(
)
{
var
client
=
new
XMLHttpRequest
(
)
;
var
countedLoading
=
0
;
client
.
onreadystatechange
=
test
.
step_func
(
function
(
)
{
if
(
client
.
readyState
=
=
=
3
)
{
countedLoading
+
=
1
;
}
if
(
client
.
readyState
=
=
=
4
)
{
assert_greater_than
(
countedLoading
1
"
LOADING
state
change
may
be
emitted
multiple
times
"
)
;
test
.
done
(
)
;
}
}
)
;
client
.
open
(
"
GET
"
"
resources
/
trickle
.
py
?
count
=
10
"
)
;
client
.
send
(
null
)
;
}
)
;
