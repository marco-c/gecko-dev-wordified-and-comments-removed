var
idx
=
0
;
class
PromiseProcessor
extends
AudioWorkletProcessor
{
constructor
(
options
)
{
super
(
options
)
;
}
process
(
inputs
outputs
)
{
if
(
idx
%
2
!
=
0
)
{
this
.
port
.
postMessage
(
"
ko
"
)
;
return
false
;
}
Promise
.
resolve
(
)
.
then
(
(
)
=
>
{
idx
+
+
;
if
(
idx
=
=
100
)
{
this
.
port
.
postMessage
(
"
ok
"
)
;
}
}
)
;
return
true
;
}
}
registerProcessor
(
'
promise
-
processor
'
PromiseProcessor
)
;
