const
url_base
=
"
/
feature
-
policy
/
experimental
-
features
/
resources
/
"
;
window
.
messageResponseCallback
=
null
;
function
setFeatureState
(
iframe
feature
origins
)
{
iframe
.
setAttribute
(
"
allow
"
{
feature
}
{
origins
}
;
)
;
}
function
loadUrlInIframe
(
iframe
url
)
{
return
new
Promise
(
(
resolve
)
=
>
{
iframe
.
addEventListener
(
"
load
"
resolve
)
;
iframe
.
src
=
url
;
}
)
;
}
function
sendMessageAndGetResponse
(
target
message
)
{
return
new
Promise
(
(
resolve
)
=
>
{
window
.
messageResponseCallback
=
resolve
;
target
.
postMessage
(
message
"
*
"
)
;
}
)
;
}
function
onMessage
(
e
)
{
if
(
window
.
messageResponseCallback
)
{
window
.
messageResponseCallback
(
e
.
data
)
;
window
.
messageResponseCallback
=
null
;
}
}
window
.
addEventListener
(
"
message
"
onMessage
)
;
