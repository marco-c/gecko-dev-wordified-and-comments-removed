'
use
strict
'
;
promise_test
(
async
t
=
>
{
const
rcHelper
=
new
RemoteContextHelper
(
{
scripts
:
[
'
.
/
resources
/
unload
-
helper
.
js
'
]
}
)
;
const
main
=
await
rcHelper
.
addWindow
(
)
;
const
sameOriginSubframe
=
await
main
.
addIframe
(
)
;
const
crossOriginSubframe
=
await
main
.
addIframe
(
{
origin
:
'
HTTP_REMOTE_ORIGIN
'
}
)
;
await
assertWindowRunsUnload
(
sameOriginSubframe
'
sameOriginSubframe
'
{
shouldRunUnload
:
true
}
)
;
await
assertWindowRunsUnload
(
crossOriginSubframe
'
crossOriginSubframe
'
{
shouldRunUnload
:
true
}
)
;
await
assertWindowRunsUnload
(
main
'
main
'
{
shouldRunUnload
:
true
}
)
;
}
)
;
