'
use
strict
'
;
promise_test
(
async
t
=
>
{
const
rcHelper
=
new
RemoteContextHelper
(
{
scripts
:
[
'
.
/
resources
/
unload
-
helper
.
js
'
]
}
)
;
const
main
=
await
rcHelper
.
addWindow
(
{
headers
:
[
[
'
Permissions
-
Policy
'
'
unload
=
*
'
]
]
}
)
;
const
subframe
=
await
main
.
addIframe
(
{
headers
:
[
[
'
Permissions
-
Policy
'
'
unload
=
(
)
'
]
]
}
)
;
await
assertWindowRunsUnload
(
subframe
'
subframe
'
{
shouldRunUnload
:
false
}
)
;
await
assertWindowRunsUnload
(
main
'
main
'
{
shouldRunUnload
:
true
}
)
;
}
)
;
