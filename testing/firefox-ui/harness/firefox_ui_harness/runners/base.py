from
__future__
import
absolute_import
import
os
import
shutil
import
tempfile
import
mozfile
import
mozinfo
from
marionette_harness
import
BaseMarionetteTestRunner
MarionetteTestCase
class
FirefoxUITestRunner
(
BaseMarionetteTestRunner
)
:
    
def
__init__
(
self
*
*
kwargs
)
:
        
super
(
FirefoxUITestRunner
self
)
.
__init__
(
*
*
kwargs
)
        
self
.
app
=
'
fxdesktop
'
        
moz_log
=
'
'
        
if
'
MOZ_LOG
'
in
os
.
environ
:
            
moz_log
=
os
.
environ
[
'
MOZ_LOG
'
]
        
if
len
(
moz_log
)
>
0
:
            
moz_log
+
=
'
'
        
moz_log
+
=
'
UrlClassifierStreamUpdater
:
1
'
        
os
.
environ
[
'
MOZ_LOG
'
]
=
moz_log
        
self
.
test_handlers
=
[
MarionetteTestCase
]
    
def
duplicate_application
(
self
application_folder
)
:
        
"
"
"
Creates
a
copy
of
the
specified
binary
.
"
"
"
        
if
self
.
workspace
:
            
target_folder
=
os
.
path
.
join
(
self
.
workspace_path
'
application
.
copy
'
)
        
else
:
            
target_folder
=
tempfile
.
mkdtemp
(
'
.
application
.
copy
'
)
        
self
.
logger
.
info
(
'
Creating
a
copy
of
the
application
at
"
%
s
"
.
'
%
target_folder
)
        
mozfile
.
remove
(
target_folder
)
        
shutil
.
copytree
(
application_folder
target_folder
)
        
return
target_folder
    
def
get_application_folder
(
self
binary
)
:
        
"
"
"
Returns
the
directory
of
the
application
.
"
"
"
        
if
mozinfo
.
isMac
:
            
end_index
=
binary
.
find
(
'
.
app
'
)
+
4
            
return
binary
[
:
end_index
]
        
else
:
            
return
os
.
path
.
dirname
(
binary
)
