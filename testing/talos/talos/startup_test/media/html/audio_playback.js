var
audioPlayback
=
function
(
)
{
var
test
=
this
;
var
cleanupTimeout
=
5000
;
var
audio
=
document
.
createElement
(
'
audio
'
)
;
initiateAudioRecording
(
test
)
;
if
(
test
.
failed
)
{
test
.
finished
=
true
;
runNextTest
(
)
;
return
;
}
audio
.
addEventListener
(
'
ended
'
function
(
evt
)
{
cleanupAudioRecording
(
test
)
;
if
(
!
test
.
failed
)
{
getSNRAndDelay
(
test
)
;
var
res
=
JSON
.
parse
(
test
.
http_response
)
;
if
(
res
[
"
SNR
-
DELAY
"
]
)
{
var
testName
=
test
.
name
;
var
snr_delay
=
res
[
"
SNR
-
DELAY
"
]
.
split
(
"
"
)
;
test
.
name
=
testName
+
"
_snr_in_db
"
;
test
.
results
=
snr_delay
[
0
]
;
updateResults
(
test
)
;
test
.
name
=
testName
+
"
_delay_in_ms
"
;
test
.
results
=
snr_delay
[
1
]
;
updateResults
(
test
)
;
test
.
name
=
testName
;
}
}
test
.
finished
=
true
;
runNextTest
(
)
;
}
)
;
audio
.
addEventListener
(
'
error
'
function
(
evt
)
{
cleanupAudioRecording
(
test
)
;
test
.
finished
=
true
;
runNextTest
(
)
;
}
)
;
audio
.
volume
=
0
.
9
;
audio
.
src
=
test
.
src
;
audio
.
play
(
)
;
}
;
