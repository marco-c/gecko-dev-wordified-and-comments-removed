"
use
strict
"
;
const
Services
=
require
(
"
Services
"
)
;
const
{
openToolboxAndLog
reloadPageAndLog
}
=
require
(
"
damp
-
test
/
tests
/
head
"
)
;
const
INITIALIZED_EVENT
=
"
Accessibility
:
Initialized
"
;
const
PREF_ACCESSIBILITY_FORCE_DISABLED
=
"
accessibility
.
force_disabled
"
;
exports
.
shutdownAccessibilityService
=
function
(
)
{
Services
.
prefs
.
setIntPref
(
PREF_ACCESSIBILITY_FORCE_DISABLED
1
)
;
Services
.
prefs
.
clearUserPref
(
PREF_ACCESSIBILITY_FORCE_DISABLED
)
;
}
;
exports
.
openAccessibilityAndLog
=
function
(
label
)
{
return
openToolboxAndLog
(
{
label
}
.
accessibility
"
accessibility
"
(
toolbox
panel
)
=
>
panel
.
panelWin
.
once
(
INITIALIZED_EVENT
)
)
;
}
;
exports
.
reloadAccessibilityAndLog
=
async
function
(
label
toolbox
)
{
const
onReload
=
async
function
(
)
{
let
accessibility
=
await
toolbox
.
getPanelWhenReady
(
"
accessibility
"
)
;
await
accessibility
.
panelWin
.
once
(
INITIALIZED_EVENT
)
;
}
;
await
reloadPageAndLog
(
{
label
}
.
accessibility
toolbox
onReload
)
;
}
;
