"
use
strict
"
;
const
{
testSetup
testTeardown
runTest
}
=
require
(
"
damp
-
test
/
tests
/
head
"
)
;
const
{
BrowserLoader
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
devtools
/
shared
/
loader
/
browser
-
loader
.
js
"
)
;
const
{
require
:
browserRequire
}
=
BrowserLoader
(
{
baseURI
:
"
resource
:
/
/
devtools
/
client
/
shared
/
"
window
:
dampWindow
}
)
;
const
sourceMap
=
browserRequire
(
"
devtools
/
client
/
shared
/
source
-
map
/
index
"
)
;
const
SOURCE_MAP_WORKER
=
"
resource
:
/
/
devtools
/
client
/
shared
/
source
-
map
/
worker
.
js
"
;
const
SOURCE_MAP_WORKER_ASSETS
=
"
resource
:
/
/
devtools
/
client
/
shared
/
source
-
map
/
assets
/
"
;
module
.
exports
=
async
function
(
)
{
await
testSetup
(
"
data
:
text
/
html
source
-
map
"
)
;
sourceMap
.
startSourceMapWorker
(
SOURCE_MAP_WORKER
SOURCE_MAP_WORKER_ASSETS
)
;
const
fakeGeneratedSource
=
{
id
:
"
fake
-
id
"
url
:
"
http
:
/
/
example
.
com
/
tests
/
devtools
/
addon
/
content
/
tests
/
source
-
map
/
angular
-
min
.
js
"
sourceMapBaseURL
:
"
http
:
/
/
example
.
com
/
tests
/
devtools
/
addon
/
content
/
tests
/
source
-
map
/
"
sourceMapURL
:
"
angular
-
min
.
js
.
map
"
}
;
{
const
test
=
runTest
(
source
-
map
-
loader
.
init
.
DAMP
)
;
await
sourceMap
.
getOriginalURLs
(
fakeGeneratedSource
)
;
test
.
done
(
)
;
}
{
const
test
=
runTest
(
source
-
map
-
loader
.
getOriginalLocation
.
DAMP
)
;
for
(
let
x
=
0
;
x
<
1000
;
x
+
+
)
{
await
sourceMap
.
getOriginalLocation
(
{
sourceId
:
fakeGeneratedSource
.
id
line
:
10
column
:
0
sourceUrl
:
fakeGeneratedSource
.
url
}
)
;
}
test
.
done
(
)
;
}
sourceMap
.
clearSourceMaps
(
)
;
await
testTeardown
(
)
;
}
;
