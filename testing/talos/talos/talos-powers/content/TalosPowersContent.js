var
TalosPowersContent
;
var
TalosPowersParent
;
(
function
(
)
{
TalosPowersContent
=
{
forceCCAndGC
(
)
{
var
event
=
new
CustomEvent
(
"
TalosPowersContentForceCCAndGC
"
{
bubbles
:
true
}
)
;
document
.
dispatchEvent
(
event
)
;
}
focus
(
callback
)
{
if
(
callback
)
{
addEventListener
(
"
TalosPowersContentFocused
"
function
focused
(
)
{
removeEventListener
(
"
TalosPowersContentFocused
"
focused
)
;
callback
(
)
;
}
)
;
}
;
document
.
dispatchEvent
(
new
CustomEvent
(
"
TalosPowersContentFocus
"
{
bubbles
:
true
}
)
)
;
}
getStartupInfo
(
)
{
return
new
Promise
(
(
resolve
)
=
>
{
var
event
=
new
CustomEvent
(
"
TalosPowersContentGetStartupInfo
"
{
bubbles
:
true
}
)
;
document
.
dispatchEvent
(
event
)
;
addEventListener
(
"
TalosPowersContentGetStartupInfoResult
"
function
onResult
(
e
)
{
removeEventListener
(
"
TalosPowersContentGetStartupInfoResult
"
onResult
)
;
resolve
(
e
.
detail
)
;
}
)
;
}
)
;
}
}
;
TalosPowersParent
=
{
replyId
:
1
exec
:
function
(
commandName
arg
callback
opt_custom_window
)
{
let
win
=
opt_custom_window
|
|
window
;
let
replyEvent
=
"
TalosPowers
:
ParentExec
:
ReplyEvent
:
"
+
this
.
replyId
+
+
;
if
(
callback
)
{
win
.
addEventListener
(
replyEvent
function
(
e
)
{
callback
(
e
.
detail
)
;
}
{
once
:
true
}
)
;
}
win
.
dispatchEvent
(
new
win
.
CustomEvent
(
"
TalosPowers
:
ParentExec
:
QueryEvent
"
{
bubbles
:
true
detail
:
{
command
:
{
name
:
commandName
data
:
arg
}
listeningTo
:
replyEvent
}
}
)
)
;
}
}
;
}
)
(
)
;
