from
mozperftest
.
metrics
.
common
import
filtered_metrics
from
mozperftest
.
layers
import
Layer
RESULTS_TEMPLATE
=
"
"
"
\
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
                    
Results
(
{
}
)
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
{
}
"
"
"
class
ConsoleOutput
(
Layer
)
:
    
"
"
"
Output
metrics
in
the
console
.
    
"
"
"
    
name
=
"
console
"
    
activated
=
False
    
arguments
=
{
        
"
metrics
"
:
{
            
"
nargs
"
:
"
*
"
            
"
default
"
:
[
]
            
"
help
"
:
"
The
metrics
that
should
be
retrieved
from
the
data
.
"
        
}
        
"
prefix
"
:
{
            
"
type
"
:
str
            
"
default
"
:
"
"
            
"
help
"
:
"
Prefix
used
by
the
output
files
.
"
        
}
    
}
    
def
__call__
(
self
metadata
)
:
        
results
=
filtered_metrics
(
            
metadata
            
self
.
get_arg
(
"
output
"
)
            
self
.
get_arg
(
"
prefix
"
)
            
metrics
=
self
.
get_arg
(
"
metrics
"
)
        
)
        
if
not
results
:
            
self
.
warning
(
"
No
results
left
after
filtering
"
)
            
return
metadata
        
for
name
res
in
results
.
items
(
)
:
            
subtests
=
[
                
"
{
}
:
{
}
"
.
format
(
r
[
"
subtest
"
]
[
v
[
"
value
"
]
for
v
in
r
[
"
data
"
]
]
)
                
for
r
in
res
            
]
            
self
.
info
(
                
"
\
n
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
\
n
"
                
"
=
Results
=
\
n
"
                
"
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
=
"
                
"
\
n
"
+
"
\
n
"
.
join
(
subtests
)
+
"
\
n
"
            
)
        
return
metadata
