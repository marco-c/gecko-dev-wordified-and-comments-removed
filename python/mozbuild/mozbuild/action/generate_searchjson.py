import
sys
import
json
import
copy
engines
=
[
]
locale
=
sys
.
argv
[
2
]
output_file
=
sys
.
argv
[
3
]
output
=
open
(
output_file
'
w
'
)
with
open
(
sys
.
argv
[
1
]
)
as
f
:
  
searchinfo
=
json
.
load
(
f
)
if
locale
in
searchinfo
[
"
locales
"
]
:
  
localeSearchInfo
=
searchinfo
[
"
locales
"
]
[
locale
]
else
:
  
localeSearchInfo
=
{
}
  
localeSearchInfo
[
"
default
"
]
=
searchinfo
[
"
default
"
]
if
"
regionOverrides
"
in
searchinfo
:
  
regionOverrides
=
searchinfo
[
"
regionOverrides
"
]
  
for
region
in
regionOverrides
:
    
if
not
region
in
localeSearchInfo
:
      
if
set
(
localeSearchInfo
[
"
default
"
]
[
"
visibleDefaultEngines
"
]
)
&
set
(
regionOverrides
[
region
]
.
keys
(
)
)
:
        
localeSearchInfo
[
region
]
=
copy
.
deepcopy
(
localeSearchInfo
[
"
default
"
]
)
      
else
:
        
continue
    
for
i
engine
in
enumerate
(
localeSearchInfo
[
region
]
[
"
visibleDefaultEngines
"
]
)
:
      
if
engine
in
regionOverrides
[
region
]
:
        
localeSearchInfo
[
region
]
[
"
visibleDefaultEngines
"
]
[
i
]
=
regionOverrides
[
region
]
[
engine
]
output
.
write
(
json
.
dumps
(
localeSearchInfo
)
)
output
.
close
(
)
;
