package
org
.
mozilla
.
focus
.
locale
;
import
android
.
content
.
res
.
Resources
;
import
android
.
support
.
v4
.
app
.
Fragment
;
import
android
.
view
.
animation
.
Animation
;
import
android
.
view
.
animation
.
AnimationSet
;
import
android
.
view
.
animation
.
AnimationUtils
;
import
java
.
util
.
Locale
;
public
abstract
class
LocaleAwareFragment
extends
Fragment
{
private
Locale
cachedLocale
=
null
;
private
AnimationSet
animationSet
;
public
void
cancelAnimation
(
)
{
if
(
animationSet
!
=
null
)
{
animationSet
.
setDuration
(
0
)
;
animationSet
.
cancel
(
)
;
}
}
public
abstract
void
applyLocale
(
)
;
Override
public
Animation
onCreateAnimation
(
int
transit
boolean
enter
int
nextAnim
)
{
Animation
animation
=
super
.
onCreateAnimation
(
transit
enter
nextAnim
)
;
if
(
animation
=
=
null
&
&
nextAnim
!
=
0
)
{
try
{
animation
=
AnimationUtils
.
loadAnimation
(
getActivity
(
)
nextAnim
)
;
}
catch
(
Resources
.
NotFoundException
e
)
{
return
null
;
}
}
if
(
animation
!
=
null
)
{
final
AnimationSet
animSet
=
new
AnimationSet
(
true
)
;
animSet
.
addAnimation
(
animation
)
;
this
.
animationSet
=
animSet
;
return
animSet
;
}
else
{
return
null
;
}
}
Override
public
void
onResume
(
)
{
super
.
onResume
(
)
;
LocaleManager
.
getInstance
(
)
.
correctLocale
(
getContext
(
)
getResources
(
)
getResources
(
)
.
getConfiguration
(
)
)
;
if
(
cachedLocale
=
=
null
)
{
cachedLocale
=
Locale
.
getDefault
(
)
;
}
else
{
Locale
newLocale
=
LocaleManager
.
getInstance
(
)
.
getCurrentLocale
(
getActivity
(
)
.
getApplicationContext
(
)
)
;
if
(
newLocale
=
=
null
)
{
newLocale
=
Locale
.
getDefault
(
)
;
}
if
(
!
newLocale
.
equals
(
cachedLocale
)
)
{
cachedLocale
=
newLocale
;
applyLocale
(
)
;
}
}
}
}
