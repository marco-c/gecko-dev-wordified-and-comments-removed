package
org
.
mozilla
.
focus
.
webkit
;
import
android
.
content
.
Context
;
import
android
.
graphics
.
Bitmap
;
import
android
.
webkit
.
WebResourceResponse
;
import
android
.
webkit
.
WebView
;
import
android
.
webkit
.
WebViewClient
;
import
org
.
mozilla
.
focus
.
R
;
import
org
.
mozilla
.
focus
.
webkit
.
matcher
.
UrlMatcher
;
public
class
TrackingProtectionWebViewClient
extends
WebViewClient
{
private
String
currentPageURL
;
private
final
UrlMatcher
matcher
;
public
TrackingProtectionWebViewClient
(
final
Context
context
)
{
matcher
=
new
UrlMatcher
(
context
R
.
raw
.
blocklist
R
.
raw
.
entitylist
)
;
}
Override
public
WebResourceResponse
shouldInterceptRequest
(
WebView
view
String
url
)
{
if
(
matcher
.
matches
(
url
currentPageURL
)
)
{
return
new
WebResourceResponse
(
null
null
null
)
;
}
return
super
.
shouldInterceptRequest
(
view
url
)
;
}
public
void
notifyCurrentURL
(
final
String
url
)
{
currentPageURL
=
url
;
}
Override
public
void
onPageStarted
(
WebView
view
String
url
Bitmap
favicon
)
{
currentPageURL
=
url
;
super
.
onPageStarted
(
view
url
favicon
)
;
}
Override
public
boolean
shouldOverrideUrlLoading
(
WebView
view
String
url
)
{
currentPageURL
=
url
;
return
super
.
shouldOverrideUrlLoading
(
view
url
)
;
}
}
