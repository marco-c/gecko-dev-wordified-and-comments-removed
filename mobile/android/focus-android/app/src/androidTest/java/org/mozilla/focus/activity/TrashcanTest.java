package
org
.
mozilla
.
focus
.
activity
;
import
android
.
content
.
Context
;
import
android
.
content
.
Intent
;
import
android
.
os
.
RemoteException
;
import
android
.
preference
.
PreferenceManager
;
import
android
.
support
.
test
.
InstrumentationRegistry
;
import
android
.
support
.
test
.
rule
.
ActivityTestRule
;
import
android
.
support
.
test
.
runner
.
AndroidJUnit4
;
import
android
.
support
.
test
.
uiautomator
.
By
;
import
android
.
support
.
test
.
uiautomator
.
UiObjectNotFoundException
;
import
android
.
support
.
test
.
uiautomator
.
Until
;
import
org
.
junit
.
Rule
;
import
org
.
junit
.
Test
;
import
org
.
junit
.
runner
.
RunWith
;
import
static
android
.
support
.
test
.
espresso
.
action
.
ViewActions
.
click
;
import
static
junit
.
framework
.
Assert
.
assertFalse
;
import
static
junit
.
framework
.
Assert
.
assertTrue
;
import
static
org
.
hamcrest
.
core
.
IsNull
.
notNullValue
;
import
static
org
.
junit
.
Assert
.
assertThat
;
import
static
org
.
mozilla
.
focus
.
activity
.
TestHelper
.
waitingTime
;
import
static
org
.
mozilla
.
focus
.
fragment
.
FirstrunFragment
.
FIRSTRUN_PREF
;
RunWith
(
AndroidJUnit4
.
class
)
public
class
TrashcanTest
{
Rule
public
ActivityTestRule
<
MainActivity
>
mActivityTestRule
=
new
ActivityTestRule
<
MainActivity
>
(
MainActivity
.
class
)
{
Override
protected
void
beforeActivityLaunched
(
)
{
super
.
beforeActivityLaunched
(
)
;
Context
appContext
=
InstrumentationRegistry
.
getInstrumentation
(
)
.
getTargetContext
(
)
.
getApplicationContext
(
)
;
PreferenceManager
.
getDefaultSharedPreferences
(
appContext
)
.
edit
(
)
.
putBoolean
(
FIRSTRUN_PREF
true
)
.
apply
(
)
;
}
}
;
Test
public
void
TrashTest
(
)
throws
InterruptedException
UiObjectNotFoundException
{
TestHelper
.
urlBar
.
waitForExists
(
waitingTime
)
;
TestHelper
.
urlBar
.
click
(
)
;
TestHelper
.
inlineAutocompleteEditText
.
waitForExists
(
waitingTime
)
;
TestHelper
.
inlineAutocompleteEditText
.
clearTextField
(
)
;
TestHelper
.
inlineAutocompleteEditText
.
setText
(
"
mozilla
"
)
;
TestHelper
.
hint
.
waitForExists
(
waitingTime
)
;
TestHelper
.
pressEnterKey
(
)
;
TestHelper
.
webView
.
waitForExists
(
waitingTime
)
;
TestHelper
.
floatingEraseButton
.
perform
(
click
(
)
)
;
TestHelper
.
erasedMsg
.
waitForExists
(
waitingTime
)
;
assertTrue
(
TestHelper
.
erasedMsg
.
exists
(
)
)
;
assertTrue
(
TestHelper
.
urlBar
.
exists
(
)
)
;
}
Test
public
void
systemBarTest
(
)
throws
InterruptedException
UiObjectNotFoundException
{
TestHelper
.
urlBar
.
waitForExists
(
waitingTime
)
;
TestHelper
.
urlBar
.
click
(
)
;
TestHelper
.
inlineAutocompleteEditText
.
waitForExists
(
waitingTime
)
;
TestHelper
.
inlineAutocompleteEditText
.
clearTextField
(
)
;
TestHelper
.
inlineAutocompleteEditText
.
setText
(
"
mozilla
"
)
;
TestHelper
.
hint
.
waitForExists
(
waitingTime
)
;
TestHelper
.
pressEnterKey
(
)
;
TestHelper
.
webView
.
waitForExists
(
waitingTime
)
;
TestHelper
.
menuButton
.
perform
(
click
(
)
)
;
TestHelper
.
blockCounterItem
.
waitForExists
(
waitingTime
)
;
TestHelper
.
openNotification
(
)
;
TestHelper
.
notificationBarDeleteItem
.
waitForExists
(
waitingTime
)
;
TestHelper
.
notificationBarDeleteItem
.
click
(
)
;
TestHelper
.
erasedMsg
.
waitForExists
(
waitingTime
)
;
assertTrue
(
TestHelper
.
erasedMsg
.
exists
(
)
)
;
assertTrue
(
TestHelper
.
urlBar
.
exists
(
)
)
;
assertFalse
(
TestHelper
.
menulist
.
exists
(
)
)
;
}
Test
public
void
systemBarHomeViewTest
(
)
throws
InterruptedException
UiObjectNotFoundException
RemoteException
{
final
int
LAUNCH_TIMEOUT
=
5000
;
final
String
FOCUS_DEBUG_APP
=
"
org
.
mozilla
.
focus
.
debug
"
;
TestHelper
.
urlBar
.
waitForExists
(
waitingTime
)
;
TestHelper
.
urlBar
.
click
(
)
;
TestHelper
.
inlineAutocompleteEditText
.
waitForExists
(
waitingTime
)
;
TestHelper
.
inlineAutocompleteEditText
.
clearTextField
(
)
;
TestHelper
.
inlineAutocompleteEditText
.
setText
(
"
mozilla
"
)
;
TestHelper
.
hint
.
waitForExists
(
waitingTime
)
;
TestHelper
.
pressEnterKey
(
)
;
TestHelper
.
webView
.
waitForExists
(
waitingTime
)
;
TestHelper
.
pressHomeKey
(
)
;
TestHelper
.
openNotification
(
)
;
TestHelper
.
notificationBarDeleteItem
.
waitForExists
(
waitingTime
)
;
TestHelper
.
notificationBarDeleteItem
.
click
(
)
;
final
String
launcherPackage
=
TestHelper
.
mDevice
.
getLauncherPackageName
(
)
;
assertThat
(
launcherPackage
notNullValue
(
)
)
;
TestHelper
.
mDevice
.
wait
(
Until
.
hasObject
(
By
.
pkg
(
launcherPackage
)
.
depth
(
0
)
)
LAUNCH_TIMEOUT
)
;
Context
context
=
InstrumentationRegistry
.
getInstrumentation
(
)
.
getTargetContext
(
)
.
getApplicationContext
(
)
;
final
Intent
intent
=
context
.
getPackageManager
(
)
.
getLaunchIntentForPackage
(
FOCUS_DEBUG_APP
)
;
context
.
startActivity
(
intent
)
;
TestHelper
.
urlBar
.
waitForExists
(
waitingTime
)
;
assertTrue
(
TestHelper
.
urlBar
.
exists
(
)
)
;
}
}
