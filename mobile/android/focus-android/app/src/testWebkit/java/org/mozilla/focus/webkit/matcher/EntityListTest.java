package
org
.
mozilla
.
focus
.
webkit
.
matcher
;
import
android
.
net
.
Uri
;
import
org
.
junit
.
Test
;
import
org
.
junit
.
runner
.
RunWith
;
import
org
.
mozilla
.
focus
.
webkit
.
matcher
.
util
.
FocusString
;
import
org
.
robolectric
.
RobolectricTestRunner
;
import
static
org
.
junit
.
Assert
.
assertFalse
;
import
static
org
.
junit
.
Assert
.
assertTrue
;
RunWith
(
RobolectricTestRunner
.
class
)
public
class
EntityListTest
{
Test
public
void
testWhitelist
(
)
{
final
String
mozillaOrg
=
"
mozilla
.
org
"
;
final
String
fooMozillaOrg
=
"
foo
.
mozilla
.
org
"
;
final
String
fooCom
=
"
foo
.
com
"
;
final
String
barCom
=
"
bar
.
com
"
;
final
EntityList
entityList
=
new
EntityList
(
)
;
final
Trie
fooComTrie
=
Trie
.
createRootNode
(
)
;
fooComTrie
.
put
(
FocusString
.
create
(
fooCom
)
.
reverse
(
)
)
;
final
Trie
barComTrie
=
Trie
.
createRootNode
(
)
;
barComTrie
.
put
(
FocusString
.
create
(
barCom
)
.
reverse
(
)
)
;
entityList
.
putWhiteList
(
FocusString
.
create
(
mozillaOrg
)
.
reverse
(
)
fooComTrie
)
;
entityList
.
putWhiteList
(
FocusString
.
create
(
fooMozillaOrg
)
.
reverse
(
)
barComTrie
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
mozillaOrg
)
Uri
.
parse
(
"
http
:
/
/
"
+
fooCom
)
)
)
;
assertFalse
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
mozillaOrg
)
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
)
)
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
fooMozillaOrg
)
Uri
.
parse
(
"
http
:
/
/
"
+
fooCom
)
)
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
fooMozillaOrg
)
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
)
)
)
;
assertFalse
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
)
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
)
)
)
;
assertFalse
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
)
Uri
.
parse
(
"
http
:
/
/
"
+
mozillaOrg
)
)
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
"
hello
.
"
+
fooMozillaOrg
)
Uri
.
parse
(
"
http
:
/
/
"
+
fooCom
)
)
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
"
hello
.
"
+
fooMozillaOrg
)
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
)
)
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
"
hello
.
"
+
mozillaOrg
)
Uri
.
parse
(
"
http
:
/
/
"
+
fooCom
)
)
)
;
assertFalse
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
"
hello
.
"
+
mozillaOrg
)
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
)
)
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
mozillaOrg
+
"
/
somewhere
"
)
Uri
.
parse
(
"
http
:
/
/
"
+
fooCom
+
"
/
somewhereElse
/
bla
/
bla
"
)
)
)
;
assertFalse
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
mozillaOrg
+
"
/
another
/
page
.
html
?
u
=
a
"
)
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
+
"
/
hello
"
)
)
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
fooMozillaOrg
+
"
/
somewhere
"
)
Uri
.
parse
(
"
http
:
/
/
"
+
fooCom
+
"
/
somewhereElse
/
bla
/
bla
"
)
)
)
;
assertTrue
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
http
:
/
/
"
+
fooMozillaOrg
+
"
/
another
/
page
.
html
?
u
=
a
"
)
Uri
.
parse
(
"
http
:
/
/
"
+
barCom
+
"
/
hello
"
)
)
)
;
assertFalse
(
entityList
.
isWhiteListed
(
Uri
.
parse
(
"
data
:
text
/
html
;
stuff
"
)
Uri
.
parse
(
"
http
:
/
/
"
+
fooCom
+
"
/
somewhereElse
/
bla
/
bla
"
)
)
)
;
}
}
