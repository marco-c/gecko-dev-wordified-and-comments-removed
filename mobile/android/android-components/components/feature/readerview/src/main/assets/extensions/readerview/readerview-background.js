browser
.
runtime
.
onMessage
.
addListener
(
async
(
message
sender
sendResponse
)
=
>
{
switch
(
message
.
action
)
{
case
'
addSerializedDoc
'
:
browser
.
storage
.
session
.
set
(
{
[
message
.
id
]
:
message
.
doc
}
)
;
break
;
case
'
getSerializedDoc
'
:
let
doc
=
await
browser
.
storage
.
session
.
get
(
message
.
id
)
;
browser
.
storage
.
session
.
remove
(
message
.
id
)
;
sendResponse
(
doc
)
;
break
;
default
:
console
.
error
(
Received
unsupported
action
{
message
.
action
}
)
;
}
}
)
;
