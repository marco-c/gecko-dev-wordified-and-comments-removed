package
org
.
mozilla
.
geckoview_example
.
utils
;
import
android
.
os
.
Build
;
import
android
.
view
.
View
;
import
android
.
view
.
Window
;
import
android
.
view
.
WindowManager
;
import
androidx
.
core
.
graphics
.
Insets
;
import
androidx
.
core
.
view
.
ViewCompat
;
import
androidx
.
core
.
view
.
WindowCompat
;
import
androidx
.
core
.
view
.
WindowInsetsCompat
;
public
class
WindowUtils
{
public
static
void
setupPersistentInsets
(
Window
window
)
{
if
(
Build
.
VERSION
.
SDK_INT
>
=
Build
.
VERSION_CODES
.
Q
)
{
WindowCompat
.
setDecorFitsSystemWindows
(
window
false
)
;
View
rootView
=
window
.
getDecorView
(
)
.
findViewById
(
android
.
R
.
id
.
content
)
;
int
persistentInsetsTypes
=
WindowInsetsCompat
.
Type
.
systemBars
(
)
|
WindowInsetsCompat
.
Type
.
displayCutout
(
)
;
ViewCompat
.
setOnApplyWindowInsetsListener
(
rootView
(
v
windowInsets
)
-
>
{
boolean
isInImmersiveMode
=
(
window
.
getAttributes
(
)
.
flags
&
WindowManager
.
LayoutParams
.
FLAG_LAYOUT_NO_LIMITS
)
!
=
0
;
Insets
persistentInsets
=
isInImmersiveMode
?
Insets
.
of
(
0
0
0
0
)
:
windowInsets
.
getInsets
(
persistentInsetsTypes
)
;
rootView
.
setPadding
(
persistentInsets
.
left
persistentInsets
.
top
persistentInsets
.
right
persistentInsets
.
bottom
)
;
return
windowInsets
;
}
)
;
}
}
SuppressWarnings
(
"
DEPRECATION
"
)
public
static
void
setupImeBehavior
(
Window
window
)
{
if
(
Build
.
VERSION
.
SDK_INT
<
Build
.
VERSION_CODES
.
Q
)
{
window
.
setSoftInputMode
(
WindowManager
.
LayoutParams
.
SOFT_INPUT_STATE_UNSPECIFIED
|
WindowManager
.
LayoutParams
.
SOFT_INPUT_ADJUST_RESIZE
)
;
}
}
}
