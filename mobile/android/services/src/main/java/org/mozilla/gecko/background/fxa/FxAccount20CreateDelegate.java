package
org
.
mozilla
.
gecko
.
background
.
fxa
;
import
org
.
json
.
simple
.
JSONObject
;
import
org
.
mozilla
.
gecko
.
sync
.
Utils
;
import
java
.
io
.
UnsupportedEncodingException
;
import
java
.
security
.
GeneralSecurityException
;
public
class
FxAccount20CreateDelegate
{
protected
final
byte
[
]
emailUTF8
;
protected
final
byte
[
]
authPW
;
protected
final
boolean
preVerified
;
public
FxAccount20CreateDelegate
(
byte
[
]
emailUTF8
byte
[
]
quickStretchedPW
boolean
preVerified
)
throws
UnsupportedEncodingException
GeneralSecurityException
{
this
.
emailUTF8
=
emailUTF8
;
this
.
authPW
=
FxAccountUtils
.
generateAuthPW
(
quickStretchedPW
)
;
this
.
preVerified
=
preVerified
;
}
SuppressWarnings
(
"
unchecked
"
)
public
JSONObject
getCreateBody
(
)
throws
FxAccountClientException
{
final
JSONObject
body
=
new
JSONObject
(
)
;
try
{
body
.
put
(
"
email
"
new
String
(
emailUTF8
"
UTF
-
8
"
)
)
;
body
.
put
(
"
authPW
"
Utils
.
byte2Hex
(
authPW
)
)
;
if
(
preVerified
)
{
body
.
put
(
"
preVerified
"
preVerified
)
;
}
return
body
;
}
catch
(
UnsupportedEncodingException
e
)
{
throw
new
FxAccountClientException
(
e
)
;
}
}
}
