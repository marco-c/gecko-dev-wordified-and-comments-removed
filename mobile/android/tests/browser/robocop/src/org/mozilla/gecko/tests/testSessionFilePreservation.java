package
org
.
mozilla
.
gecko
.
tests
;
import
android
.
content
.
Intent
;
import
android
.
util
.
Log
;
import
org
.
mozilla
.
gecko
.
Tab
;
import
org
.
mozilla
.
gecko
.
Tabs
;
import
org
.
mozilla
.
gecko
.
tests
.
helpers
.
GeckoHelper
;
public
class
testSessionFilePreservation
extends
SessionTest
{
private
Session
mSession
;
Override
public
void
setActivityIntent
(
Intent
intent
)
{
mSession
=
createTestSession
(
2
)
;
injectSessionToRestore
(
intent
mSession
)
;
super
.
setActivityIntent
(
intent
)
;
}
public
void
testSessionFilePreservation
(
)
{
GeckoHelper
.
blockForReady
(
)
;
deleteProfileFile
(
"
sessionstore
.
js
"
)
;
Tab
tab
=
Tabs
.
getInstance
(
)
.
addTab
(
)
;
Tabs
.
getInstance
(
)
.
closeTab
(
tab
)
;
VerifyJSONCondition
verifyJSONCondition
=
new
VerifyJSONCondition
(
mSession
)
;
boolean
success
=
mSolo
.
waitForCondition
(
verifyJSONCondition
SESSION_TIMEOUT
)
;
if
(
success
)
{
mAsserter
.
ok
(
true
"
verified
session
JSON
"
null
)
;
}
else
{
mAsserter
.
ok
(
false
"
failed
to
verify
session
JSON
"
Log
.
getStackTraceString
(
verifyJSONCondition
.
getLastException
(
)
)
)
;
}
}
}
