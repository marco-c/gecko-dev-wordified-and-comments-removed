const
{
classes
:
Cc
interfaces
:
Ci
utils
:
Cu
}
=
Components
;
Cu
.
import
(
"
resource
:
/
/
gre
/
modules
/
ctypes
.
jsm
"
)
;
Cu
.
import
(
"
resource
:
/
/
gre
/
modules
/
JNI
.
jsm
"
)
;
add_task
(
function
test_isUserRestricted
(
)
{
do_check_true
(
"
mozilla
.
org
/
parental
-
controls
-
service
;
1
"
in
Cc
)
;
let
pc
=
Cc
[
"
mozilla
.
org
/
parental
-
controls
-
service
;
1
"
]
.
createInstance
(
Ci
.
nsIParentalControlsService
)
;
do_check_false
(
pc
.
parentalControlsEnabled
)
;
do_check_false
(
pc
.
blockFileDownloadsEnabled
)
;
do_check_true
(
pc
.
isAllowed
(
Ci
.
nsIParentalControlsService
.
DOWNLOAD
)
)
;
do_check_true
(
pc
.
isAllowed
(
Ci
.
nsIParentalControlsService
.
INSTALL_EXTENSION
)
)
;
do_check_true
(
pc
.
isAllowed
(
Ci
.
nsIParentalControlsService
.
INSTALL_APP
)
)
;
do_check_true
(
pc
.
isAllowed
(
Ci
.
nsIParentalControlsService
.
VISIT_FILE_URLS
)
)
;
do_check_true
(
pc
.
isAllowed
(
Ci
.
nsIParentalControlsService
.
SHARE
)
)
;
do_check_true
(
pc
.
isAllowed
(
Ci
.
nsIParentalControlsService
.
BOOKMARK
)
)
;
do_check_true
(
pc
.
isAllowed
(
Ci
.
nsIParentalControlsService
.
INSTALL_EXTENSION
)
)
;
do_check_true
(
pc
.
isAllowed
(
Ci
.
nsIParentalControlsService
.
MODIFY_ACCOUNTS
)
)
;
}
)
;
run_next_test
(
)
;
