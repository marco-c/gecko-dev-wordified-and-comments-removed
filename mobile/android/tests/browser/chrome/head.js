function
promiseBrowserEvent
(
browser
eventType
)
{
return
new
Promise
(
(
resolve
)
=
>
{
function
handle
(
event
)
{
if
(
event
.
target
!
=
browser
.
contentDocument
|
|
event
.
target
.
location
.
href
=
=
"
about
:
blank
"
)
{
info
(
"
Skipping
spurious
'
"
+
eventType
+
"
'
event
"
+
"
for
"
+
event
.
target
.
location
.
href
)
;
return
;
}
info
(
"
Received
event
"
+
eventType
+
"
from
browser
"
)
;
browser
.
removeEventListener
(
eventType
handle
true
)
;
resolve
(
event
)
;
}
browser
.
addEventListener
(
eventType
handle
true
)
;
info
(
"
Now
waiting
for
"
+
eventType
+
"
event
from
browser
"
)
;
}
)
;
}
