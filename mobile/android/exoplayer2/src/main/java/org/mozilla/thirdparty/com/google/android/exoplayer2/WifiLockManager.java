package
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
;
import
android
.
content
.
Context
;
import
android
.
net
.
wifi
.
WifiManager
;
import
android
.
net
.
wifi
.
WifiManager
.
WifiLock
;
import
androidx
.
annotation
.
Nullable
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
util
.
Log
;
final
class
WifiLockManager
{
private
static
final
String
TAG
=
"
WifiLockManager
"
;
private
static
final
String
WIFI_LOCK_TAG
=
"
ExoPlayer
:
WifiLockManager
"
;
Nullable
private
final
WifiManager
wifiManager
;
Nullable
private
WifiLock
wifiLock
;
private
boolean
enabled
;
private
boolean
stayAwake
;
public
WifiLockManager
(
Context
context
)
{
wifiManager
=
(
WifiManager
)
context
.
getApplicationContext
(
)
.
getSystemService
(
Context
.
WIFI_SERVICE
)
;
}
public
void
setEnabled
(
boolean
enabled
)
{
if
(
enabled
&
&
wifiLock
=
=
null
)
{
if
(
wifiManager
=
=
null
)
{
Log
.
w
(
TAG
"
WifiManager
is
null
therefore
not
creating
the
WifiLock
.
"
)
;
return
;
}
wifiLock
=
wifiManager
.
createWifiLock
(
WifiManager
.
WIFI_MODE_FULL_HIGH_PERF
WIFI_LOCK_TAG
)
;
wifiLock
.
setReferenceCounted
(
false
)
;
}
this
.
enabled
=
enabled
;
updateWifiLock
(
)
;
}
public
void
setStayAwake
(
boolean
stayAwake
)
{
this
.
stayAwake
=
stayAwake
;
updateWifiLock
(
)
;
}
private
void
updateWifiLock
(
)
{
if
(
wifiLock
=
=
null
)
{
return
;
}
if
(
enabled
&
&
stayAwake
)
{
wifiLock
.
acquire
(
)
;
}
else
{
wifiLock
.
release
(
)
;
}
}
}
