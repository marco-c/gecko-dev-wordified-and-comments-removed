package
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
extractor
.
ts
;
import
android
.
util
.
SparseArray
;
import
androidx
.
annotation
.
IntDef
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
ParserException
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
extractor
.
ExtractorOutput
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
extractor
.
TrackOutput
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
util
.
ParsableByteArray
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
util
.
TimestampAdjuster
;
import
java
.
lang
.
annotation
.
Documented
;
import
java
.
lang
.
annotation
.
Retention
;
import
java
.
lang
.
annotation
.
RetentionPolicy
;
import
java
.
util
.
Collections
;
import
java
.
util
.
List
;
public
interface
TsPayloadReader
{
interface
Factory
{
SparseArray
<
TsPayloadReader
>
createInitialPayloadReaders
(
)
;
TsPayloadReader
createPayloadReader
(
int
streamType
EsInfo
esInfo
)
;
}
final
class
EsInfo
{
public
final
int
streamType
;
public
final
String
language
;
public
final
List
<
DvbSubtitleInfo
>
dvbSubtitleInfos
;
public
final
byte
[
]
descriptorBytes
;
public
EsInfo
(
int
streamType
String
language
List
<
DvbSubtitleInfo
>
dvbSubtitleInfos
byte
[
]
descriptorBytes
)
{
this
.
streamType
=
streamType
;
this
.
language
=
language
;
this
.
dvbSubtitleInfos
=
dvbSubtitleInfos
=
=
null
?
Collections
.
emptyList
(
)
:
Collections
.
unmodifiableList
(
dvbSubtitleInfos
)
;
this
.
descriptorBytes
=
descriptorBytes
;
}
}
final
class
DvbSubtitleInfo
{
public
final
String
language
;
public
final
int
type
;
public
final
byte
[
]
initializationData
;
public
DvbSubtitleInfo
(
String
language
int
type
byte
[
]
initializationData
)
{
this
.
language
=
language
;
this
.
type
=
type
;
this
.
initializationData
=
initializationData
;
}
}
final
class
TrackIdGenerator
{
private
static
final
int
ID_UNSET
=
Integer
.
MIN_VALUE
;
private
final
String
formatIdPrefix
;
private
final
int
firstTrackId
;
private
final
int
trackIdIncrement
;
private
int
trackId
;
private
String
formatId
;
public
TrackIdGenerator
(
int
firstTrackId
int
trackIdIncrement
)
{
this
(
ID_UNSET
firstTrackId
trackIdIncrement
)
;
}
public
TrackIdGenerator
(
int
programNumber
int
firstTrackId
int
trackIdIncrement
)
{
this
.
formatIdPrefix
=
programNumber
!
=
ID_UNSET
?
programNumber
+
"
/
"
:
"
"
;
this
.
firstTrackId
=
firstTrackId
;
this
.
trackIdIncrement
=
trackIdIncrement
;
trackId
=
ID_UNSET
;
}
public
void
generateNewId
(
)
{
trackId
=
trackId
=
=
ID_UNSET
?
firstTrackId
:
trackId
+
trackIdIncrement
;
formatId
=
formatIdPrefix
+
trackId
;
}
public
int
getTrackId
(
)
{
maybeThrowUninitializedError
(
)
;
return
trackId
;
}
public
String
getFormatId
(
)
{
maybeThrowUninitializedError
(
)
;
return
formatId
;
}
private
void
maybeThrowUninitializedError
(
)
{
if
(
trackId
=
=
ID_UNSET
)
{
throw
new
IllegalStateException
(
"
generateNewId
(
)
must
be
called
before
retrieving
ids
.
"
)
;
}
}
}
Documented
Retention
(
RetentionPolicy
.
SOURCE
)
IntDef
(
flag
=
true
value
=
{
FLAG_PAYLOAD_UNIT_START_INDICATOR
FLAG_RANDOM_ACCESS_INDICATOR
FLAG_DATA_ALIGNMENT_INDICATOR
}
)
interface
Flags
{
}
int
FLAG_PAYLOAD_UNIT_START_INDICATOR
=
1
;
int
FLAG_RANDOM_ACCESS_INDICATOR
=
1
<
<
1
;
int
FLAG_DATA_ALIGNMENT_INDICATOR
=
1
<
<
2
;
void
init
(
TimestampAdjuster
timestampAdjuster
ExtractorOutput
extractorOutput
TrackIdGenerator
idGenerator
)
;
void
seek
(
)
;
void
consume
(
ParsableByteArray
data
Flags
int
flags
)
throws
ParserException
;
}
