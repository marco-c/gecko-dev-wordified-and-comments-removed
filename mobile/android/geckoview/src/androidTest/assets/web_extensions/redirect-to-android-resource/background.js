"
use
strict
"
;
function
setupRedirect
(
fromUrl
redirectUrl
)
{
browser
.
webRequest
.
onBeforeRequest
.
addListener
(
(
)
=
>
{
console
.
log
(
Extension
redirects
from
{
fromUrl
}
to
{
redirectUrl
}
)
;
return
{
redirectUrl
}
;
}
{
urls
:
[
fromUrl
]
}
[
"
blocking
"
]
)
;
}
setupRedirect
(
"
http
:
/
/
trackertest
.
org
/
tracker
.
js
"
"
data
:
text
/
javascript
document
.
body
.
textContent
=
'
start
'
"
)
;
setupRedirect
(
"
https
:
/
/
tracking
.
example
.
com
/
tracker
.
js
"
browser
.
runtime
.
getURL
(
"
web
-
accessible
-
script
.
js
"
)
)
;
setupRedirect
(
"
https
:
/
/
itisatracker
.
org
/
tracker
.
js
"
data
:
text
/
javascript
document
.
body
.
textContent
+
=
'
end
'
)
;
var
listenerReady
=
browser
.
webRequest
.
getSecurityInfo
(
"
"
)
.
catch
(
(
)
=
>
{
}
)
;
listenerReady
.
then
(
(
)
=
>
{
browser
.
runtime
.
sendNativeMessage
(
"
browser
"
"
setupReadyStartTest
"
)
;
}
)
;
