package
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
upstream
;
import
static
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
util
.
Util
.
castNonNull
;
import
androidx
.
annotation
.
Nullable
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
C
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
util
.
Assertions
;
import
java
.
io
.
ByteArrayOutputStream
;
import
java
.
io
.
IOException
;
import
org
.
checkerframework
.
checker
.
nullness
.
qual
.
MonotonicNonNull
;
public
final
class
ByteArrayDataSink
implements
DataSink
{
private
MonotonicNonNull
ByteArrayOutputStream
stream
;
Override
public
void
open
(
DataSpec
dataSpec
)
{
if
(
dataSpec
.
length
=
=
C
.
LENGTH_UNSET
)
{
stream
=
new
ByteArrayOutputStream
(
)
;
}
else
{
Assertions
.
checkArgument
(
dataSpec
.
length
<
=
Integer
.
MAX_VALUE
)
;
stream
=
new
ByteArrayOutputStream
(
(
int
)
dataSpec
.
length
)
;
}
}
Override
public
void
close
(
)
throws
IOException
{
castNonNull
(
stream
)
.
close
(
)
;
}
Override
public
void
write
(
byte
[
]
buffer
int
offset
int
length
)
{
castNonNull
(
stream
)
.
write
(
buffer
offset
length
)
;
}
Nullable
public
byte
[
]
getData
(
)
{
return
stream
=
=
null
?
null
:
stream
.
toByteArray
(
)
;
}
}
