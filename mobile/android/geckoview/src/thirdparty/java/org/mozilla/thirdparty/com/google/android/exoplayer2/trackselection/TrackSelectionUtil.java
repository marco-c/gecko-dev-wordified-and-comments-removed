package
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
trackselection
;
import
androidx
.
annotation
.
Nullable
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
source
.
TrackGroupArray
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
trackselection
.
DefaultTrackSelector
.
SelectionOverride
;
import
org
.
mozilla
.
thirdparty
.
com
.
google
.
android
.
exoplayer2
.
trackselection
.
TrackSelection
.
Definition
;
import
org
.
checkerframework
.
checker
.
nullness
.
compatqual
.
NullableType
;
public
final
class
TrackSelectionUtil
{
private
TrackSelectionUtil
(
)
{
}
public
interface
AdaptiveTrackSelectionFactory
{
TrackSelection
createAdaptiveTrackSelection
(
Definition
trackSelectionDefinition
)
;
}
public
static
NullableType
TrackSelection
[
]
createTrackSelectionsForDefinitions
(
NullableType
Definition
[
]
definitions
AdaptiveTrackSelectionFactory
adaptiveTrackSelectionFactory
)
{
TrackSelection
[
]
selections
=
new
TrackSelection
[
definitions
.
length
]
;
boolean
createdAdaptiveTrackSelection
=
false
;
for
(
int
i
=
0
;
i
<
definitions
.
length
;
i
+
+
)
{
Definition
definition
=
definitions
[
i
]
;
if
(
definition
=
=
null
)
{
continue
;
}
if
(
definition
.
tracks
.
length
>
1
&
&
!
createdAdaptiveTrackSelection
)
{
createdAdaptiveTrackSelection
=
true
;
selections
[
i
]
=
adaptiveTrackSelectionFactory
.
createAdaptiveTrackSelection
(
definition
)
;
}
else
{
selections
[
i
]
=
new
FixedTrackSelection
(
definition
.
group
definition
.
tracks
[
0
]
definition
.
reason
definition
.
data
)
;
}
}
return
selections
;
}
public
static
DefaultTrackSelector
.
Parameters
updateParametersWithOverride
(
DefaultTrackSelector
.
Parameters
parameters
int
rendererIndex
TrackGroupArray
trackGroupArray
boolean
isDisabled
Nullable
SelectionOverride
override
)
{
DefaultTrackSelector
.
ParametersBuilder
builder
=
parameters
.
buildUpon
(
)
.
clearSelectionOverrides
(
rendererIndex
)
.
setRendererDisabled
(
rendererIndex
isDisabled
)
;
if
(
override
!
=
null
)
{
builder
.
setSelectionOverride
(
rendererIndex
trackGroupArray
override
)
;
}
return
builder
.
build
(
)
;
}
}
