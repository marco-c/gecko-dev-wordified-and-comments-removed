package
org
.
mozilla
.
geckoview
;
import
android
.
support
.
annotation
.
AnyThread
;
import
android
.
support
.
annotation
.
NonNull
;
import
org
.
json
.
JSONException
;
import
org
.
json
.
JSONObject
;
import
org
.
mozilla
.
gecko
.
EventDispatcher
;
import
org
.
mozilla
.
gecko
.
util
.
GeckoBundle
;
public
final
class
RuntimeTelemetry
{
private
final
EventDispatcher
mEventDispatcher
;
RuntimeTelemetry
(
final
NonNull
GeckoRuntime
runtime
)
{
mEventDispatcher
=
EventDispatcher
.
getInstance
(
)
;
}
AnyThread
public
NonNull
GeckoResult
<
JSONObject
>
getSnapshots
(
final
boolean
clear
)
{
final
GeckoBundle
msg
=
new
GeckoBundle
(
1
)
;
msg
.
putBoolean
(
"
clear
"
clear
)
;
final
GeckoSession
.
CallbackResult
<
JSONObject
>
result
=
new
GeckoSession
.
CallbackResult
<
JSONObject
>
(
)
{
Override
public
void
sendSuccess
(
final
Object
value
)
{
try
{
complete
(
(
(
GeckoBundle
)
value
)
.
toJSONObject
(
)
)
;
}
catch
(
JSONException
ex
)
{
completeExceptionally
(
ex
)
;
}
}
}
;
mEventDispatcher
.
dispatch
(
"
GeckoView
:
TelemetrySnapshots
"
msg
result
)
;
return
result
;
}
}
