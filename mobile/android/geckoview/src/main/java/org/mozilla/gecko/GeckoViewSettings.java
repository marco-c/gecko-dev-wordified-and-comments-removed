package
org
.
mozilla
.
gecko
;
import
org
.
mozilla
.
gecko
.
util
.
GeckoBundle
;
import
android
.
os
.
Parcel
;
import
android
.
os
.
Parcelable
;
import
android
.
util
.
Log
;
public
final
class
GeckoViewSettings
implements
Parcelable
{
private
static
final
String
LOGTAG
=
"
GeckoViewSettings
"
;
private
static
final
boolean
DEBUG
=
false
;
private
static
class
Key
<
T
>
{
private
final
String
text
;
public
Key
(
final
String
text
)
{
this
.
text
=
text
;
}
}
public
enum
DisplayMode
{
BROWSER
(
0
)
MINIMAL_UI
(
1
)
STANDALONE
(
2
)
FULLSCREEN
(
3
)
;
private
final
int
mMode
;
DisplayMode
(
int
mode
)
{
mMode
=
mode
;
}
public
int
value
(
)
{
return
mMode
;
}
}
public
static
final
Key
<
Boolean
>
USE_TRACKING_PROTECTION
=
new
Key
<
Boolean
>
(
"
useTrackingProtection
"
)
;
public
static
final
Key
<
Boolean
>
USE_PRIVATE_MODE
=
new
Key
<
Boolean
>
(
"
usePrivateMode
"
)
;
public
static
final
Key
<
Boolean
>
USE_MULTIPROCESS
=
new
Key
<
Boolean
>
(
"
useMultiprocess
"
)
;
public
static
final
Key
<
Integer
>
DISPLAY_MODE
=
new
Key
<
Integer
>
(
"
displayMode
"
)
;
public
static
final
Key
<
Boolean
>
USE_REMOTE_DEBUGGER
=
new
Key
<
Boolean
>
(
"
useRemoteDebugger
"
)
;
public
static
final
Key
<
String
>
DEBUGGER_SOCKET_DIR
=
new
Key
<
String
>
(
"
debuggerSocketDir
"
)
;
private
final
EventDispatcher
mEventDispatcher
;
private
final
GeckoBundle
mBundle
;
public
GeckoViewSettings
(
)
{
this
(
null
)
;
}
GeckoViewSettings
(
EventDispatcher
eventDispatcher
)
{
mEventDispatcher
=
eventDispatcher
;
mBundle
=
new
GeckoBundle
(
)
;
setBoolean
(
USE_TRACKING_PROTECTION
false
)
;
setBoolean
(
USE_PRIVATE_MODE
false
)
;
setBoolean
(
USE_MULTIPROCESS
true
)
;
setInt
(
DISPLAY_MODE
DisplayMode
.
BROWSER
.
value
(
)
)
;
setBoolean
(
USE_REMOTE_DEBUGGER
false
)
;
setString
(
DEBUGGER_SOCKET_DIR
"
"
)
;
}
GeckoViewSettings
(
GeckoViewSettings
settings
EventDispatcher
eventDispatcher
)
{
mBundle
=
new
GeckoBundle
(
settings
.
mBundle
)
;
mEventDispatcher
=
eventDispatcher
;
}
public
void
setBoolean
(
final
Key
<
Boolean
>
key
boolean
value
)
{
synchronized
(
mBundle
)
{
final
Object
old
=
mBundle
.
get
(
key
.
text
)
;
if
(
old
!
=
null
&
&
old
.
equals
(
value
)
)
{
return
;
}
mBundle
.
putBoolean
(
key
.
text
value
)
;
}
dispatchUpdate
(
)
;
}
public
boolean
getBoolean
(
final
Key
<
Boolean
>
key
)
{
synchronized
(
mBundle
)
{
return
mBundle
.
getBoolean
(
key
.
text
)
;
}
}
public
void
setInt
(
final
Key
<
Integer
>
key
int
value
)
{
synchronized
(
mBundle
)
{
final
Object
old
=
mBundle
.
get
(
key
.
text
)
;
if
(
old
!
=
null
&
&
old
.
equals
(
value
)
)
{
return
;
}
mBundle
.
putInt
(
key
.
text
value
)
;
}
dispatchUpdate
(
)
;
}
public
int
getInt
(
final
Key
<
Integer
>
key
)
{
synchronized
(
mBundle
)
{
return
mBundle
.
getInt
(
key
.
text
)
;
}
}
public
void
setString
(
final
Key
<
String
>
key
final
String
value
)
{
synchronized
(
mBundle
)
{
final
Object
old
=
mBundle
.
get
(
key
.
text
)
;
if
(
old
!
=
null
&
&
old
.
equals
(
value
)
)
{
return
;
}
mBundle
.
putString
(
key
.
text
value
)
;
}
dispatchUpdate
(
)
;
}
public
String
getString
(
final
Key
<
String
>
key
)
{
synchronized
(
mBundle
)
{
return
mBundle
.
getString
(
key
.
text
)
;
}
}
GeckoBundle
asBundle
(
)
{
return
mBundle
;
}
private
void
dispatchUpdate
(
)
{
if
(
mEventDispatcher
!
=
null
)
{
mEventDispatcher
.
dispatch
(
"
GeckoView
:
UpdateSettings
"
null
)
;
}
}
Override
public
int
describeContents
(
)
{
return
0
;
}
Override
public
void
writeToParcel
(
Parcel
out
int
flags
)
{
mBundle
.
writeToParcel
(
out
flags
)
;
}
public
void
readFromParcel
(
final
Parcel
source
)
{
mBundle
.
readFromParcel
(
source
)
;
}
public
static
final
Parcelable
.
Creator
<
GeckoViewSettings
>
CREATOR
=
new
Parcelable
.
Creator
<
GeckoViewSettings
>
(
)
{
Override
public
GeckoViewSettings
createFromParcel
(
final
Parcel
in
)
{
final
GeckoViewSettings
settings
=
new
GeckoViewSettings
(
)
;
settings
.
readFromParcel
(
in
)
;
return
settings
;
}
Override
public
GeckoViewSettings
[
]
newArray
(
final
int
size
)
{
return
new
GeckoViewSettings
[
size
]
;
}
}
;
}
