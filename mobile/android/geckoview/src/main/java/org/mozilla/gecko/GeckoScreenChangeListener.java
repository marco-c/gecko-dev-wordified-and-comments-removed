package
org
.
mozilla
.
gecko
;
import
android
.
content
.
Context
;
import
android
.
hardware
.
display
.
DisplayManager
;
import
android
.
util
.
Log
;
import
android
.
view
.
Display
;
import
org
.
mozilla
.
gecko
.
util
.
ThreadUtils
;
public
class
GeckoScreenChangeListener
implements
DisplayManager
.
DisplayListener
{
private
static
final
String
LOGTAG
=
"
ScreenChangeListener
"
;
private
static
final
boolean
DEBUG
=
false
;
private
static
final
int
NOTIFY_SCREEN_DELAY_MS
=
100
;
public
GeckoScreenChangeListener
(
)
{
}
Override
public
void
onDisplayAdded
(
final
int
displayId
)
{
}
Override
public
void
onDisplayRemoved
(
final
int
displayId
)
{
}
Override
public
void
onDisplayChanged
(
final
int
displayId
)
{
if
(
DEBUG
)
{
Log
.
d
(
LOGTAG
"
onDisplayChanged
"
)
;
}
if
(
displayId
!
=
Display
.
DEFAULT_DISPLAY
)
{
if
(
DEBUG
)
{
Log
.
d
(
LOGTAG
"
Primary
display
is
only
supported
"
)
;
}
return
;
}
ThreadUtils
.
postToUiThreadDelayed
(
new
Runnable
(
)
{
Override
public
void
run
(
)
{
if
(
GeckoScreenOrientation
.
getInstance
(
)
.
update
(
)
)
{
return
;
}
ScreenManagerHelper
.
refreshScreenInfo
(
)
;
}
}
NOTIFY_SCREEN_DELAY_MS
)
;
}
private
static
DisplayManager
getDisplayManager
(
)
{
return
(
DisplayManager
)
GeckoAppShell
.
getApplicationContext
(
)
.
getSystemService
(
Context
.
DISPLAY_SERVICE
)
;
}
public
void
enable
(
)
{
final
DisplayManager
displayManager
=
getDisplayManager
(
)
;
if
(
displayManager
=
=
null
)
{
return
;
}
displayManager
.
registerDisplayListener
(
this
null
)
;
}
public
void
disable
(
)
{
final
DisplayManager
displayManager
=
getDisplayManager
(
)
;
if
(
displayManager
=
=
null
)
{
return
;
}
displayManager
.
unregisterDisplayListener
(
this
)
;
}
}
