browser
.
runtime
.
onMessage
.
addListener
(
notify
)
;
function
sendMessageToTabs
(
tabs
cookies
)
{
for
(
let
tab
of
tabs
)
{
browser
.
tabs
.
sendMessage
(
tab
.
id
{
cookies
}
)
;
}
}
function
notify
(
message
)
{
if
(
message
.
checkCookies
)
{
browser
.
cookies
.
getAll
(
{
}
)
.
then
(
cookies
=
>
{
browser
.
tabs
.
query
(
{
currentWindow
:
true
active
:
true
}
)
.
then
(
tabs
=
>
{
sendMessageToTabs
(
tabs
cookies
)
;
}
)
;
}
)
;
}
}
