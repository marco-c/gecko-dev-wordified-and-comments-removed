package
org
.
mozilla
.
gecko
.
menu
;
import
org
.
mozilla
.
gecko
.
R
;
import
android
.
content
.
Context
;
import
android
.
graphics
.
Color
;
import
android
.
graphics
.
drawable
.
ColorDrawable
;
import
android
.
view
.
LayoutInflater
;
import
android
.
view
.
View
;
import
android
.
view
.
ViewGroup
;
import
android
.
widget
.
FrameLayout
;
import
android
.
widget
.
PopupWindow
;
public
class
MenuPopup
extends
PopupWindow
{
private
final
FrameLayout
mPanel
;
private
final
int
mPopupWidth
;
public
MenuPopup
(
Context
context
)
{
super
(
context
)
;
setFocusable
(
true
)
;
mPopupWidth
=
context
.
getResources
(
)
.
getDimensionPixelSize
(
R
.
dimen
.
menu_popup_width
)
;
setBackgroundDrawable
(
new
ColorDrawable
(
Color
.
TRANSPARENT
)
)
;
setWindowLayoutMode
(
ViewGroup
.
LayoutParams
.
WRAP_CONTENT
ViewGroup
.
LayoutParams
.
WRAP_CONTENT
)
;
LayoutInflater
inflater
=
LayoutInflater
.
from
(
context
)
;
mPanel
=
(
FrameLayout
)
inflater
.
inflate
(
R
.
layout
.
menu_popup
null
)
;
setContentView
(
mPanel
)
;
setAnimationStyle
(
R
.
style
.
PopupAnimation
)
;
}
public
void
setPanelView
(
View
view
)
{
view
.
setLayoutParams
(
new
FrameLayout
.
LayoutParams
(
mPopupWidth
FrameLayout
.
LayoutParams
.
WRAP_CONTENT
)
)
;
mPanel
.
removeAllViews
(
)
;
mPanel
.
addView
(
view
)
;
}
Override
public
void
showAsDropDown
(
View
anchor
)
{
setHeight
(
mPanel
.
getHeight
(
)
)
;
final
int
xOffset
=
anchor
.
getWidth
(
)
/
2
-
mPopupWidth
/
2
;
showAsDropDown
(
anchor
xOffset
-
anchor
.
getHeight
(
)
)
;
}
}
