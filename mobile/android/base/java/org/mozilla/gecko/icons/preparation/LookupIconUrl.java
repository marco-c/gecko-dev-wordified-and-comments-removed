package
org
.
mozilla
.
gecko
.
icons
.
preparation
;
import
org
.
mozilla
.
gecko
.
icons
.
IconDescriptor
;
import
org
.
mozilla
.
gecko
.
icons
.
IconRequest
;
import
org
.
mozilla
.
gecko
.
icons
.
storage
.
DiskStorage
;
import
org
.
mozilla
.
gecko
.
icons
.
storage
.
MemoryStorage
;
public
class
LookupIconUrl
implements
Preparer
{
Override
public
void
prepare
(
IconRequest
request
)
{
if
(
lookupFromMemory
(
request
)
)
{
return
;
}
lookupFromDisk
(
request
)
;
}
private
boolean
lookupFromMemory
(
IconRequest
request
)
{
final
String
iconUrl
=
MemoryStorage
.
get
(
)
.
getMapping
(
request
.
getPageUrl
(
)
)
;
if
(
iconUrl
!
=
null
)
{
request
.
modify
(
)
.
icon
(
IconDescriptor
.
createLookupIcon
(
iconUrl
)
)
.
deferBuild
(
)
;
return
true
;
}
return
false
;
}
private
boolean
lookupFromDisk
(
IconRequest
request
)
{
final
String
iconUrl
=
DiskStorage
.
get
(
request
.
getContext
(
)
)
.
getMapping
(
request
.
getPageUrl
(
)
)
;
if
(
iconUrl
!
=
null
)
{
request
.
modify
(
)
.
icon
(
IconDescriptor
.
createLookupIcon
(
iconUrl
)
)
.
deferBuild
(
)
;
return
true
;
}
return
false
;
}
}
