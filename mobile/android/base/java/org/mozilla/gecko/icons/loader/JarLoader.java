package
org
.
mozilla
.
gecko
.
icons
.
loader
;
import
android
.
content
.
Context
;
import
android
.
util
.
Log
;
import
org
.
mozilla
.
gecko
.
icons
.
IconRequest
;
import
org
.
mozilla
.
gecko
.
icons
.
IconResponse
;
import
org
.
mozilla
.
gecko
.
util
.
GeckoJarReader
;
public
class
JarLoader
implements
IconLoader
{
private
static
final
String
LOGTAG
=
"
Gecko
/
JarLoader
"
;
Override
public
IconResponse
load
(
IconRequest
request
)
{
if
(
request
.
shouldSkipDisk
(
)
)
{
return
null
;
}
final
String
iconUrl
=
request
.
getBestIcon
(
)
.
getUrl
(
)
;
if
(
!
iconUrl
.
startsWith
(
"
jar
:
jar
:
"
)
)
{
return
null
;
}
try
{
final
Context
context
=
request
.
getContext
(
)
;
return
IconResponse
.
create
(
GeckoJarReader
.
getBitmap
(
context
context
.
getResources
(
)
iconUrl
)
)
;
}
catch
(
Exception
e
)
{
Log
.
w
(
LOGTAG
"
Error
fetching
favicon
from
JAR
.
"
e
)
;
return
null
;
}
}
}
