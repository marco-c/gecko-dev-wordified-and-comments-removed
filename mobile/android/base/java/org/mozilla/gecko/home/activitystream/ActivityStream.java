package
org
.
mozilla
.
gecko
.
home
.
activitystream
;
import
android
.
content
.
Context
;
import
android
.
database
.
Cursor
;
import
android
.
os
.
Bundle
;
import
android
.
support
.
v4
.
app
.
FragmentManager
;
import
android
.
support
.
v4
.
app
.
LoaderManager
;
import
android
.
support
.
v4
.
content
.
Loader
;
import
android
.
support
.
v7
.
widget
.
LinearLayoutManager
;
import
android
.
support
.
v7
.
widget
.
RecyclerView
;
import
android
.
util
.
AttributeSet
;
import
android
.
widget
.
FrameLayout
;
import
org
.
mozilla
.
gecko
.
GeckoProfile
;
import
org
.
mozilla
.
gecko
.
R
;
import
org
.
mozilla
.
gecko
.
animation
.
PropertyAnimator
;
import
org
.
mozilla
.
gecko
.
home
.
HomeBanner
;
import
org
.
mozilla
.
gecko
.
home
.
HomeFragment
;
import
org
.
mozilla
.
gecko
.
home
.
HomeScreen
;
import
org
.
mozilla
.
gecko
.
home
.
SimpleCursorLoader
;
public
class
ActivityStream
extends
FrameLayout
implements
HomeScreen
{
private
StreamRecyclerAdapter
adapter
;
public
ActivityStream
(
Context
context
AttributeSet
attrs
)
{
super
(
context
attrs
)
;
inflate
(
context
R
.
layout
.
as_content
this
)
;
}
Override
public
boolean
isVisible
(
)
{
return
true
;
}
Override
public
void
onToolbarFocusChange
(
boolean
hasFocus
)
{
}
Override
public
void
showPanel
(
String
panelId
Bundle
restoreData
)
{
}
Override
public
void
setOnPanelChangeListener
(
OnPanelChangeListener
listener
)
{
}
Override
public
void
setPanelStateChangeListener
(
HomeFragment
.
PanelStateChangeListener
listener
)
{
}
Override
public
void
setBanner
(
HomeBanner
banner
)
{
}
Override
public
void
load
(
LoaderManager
lm
FragmentManager
fm
String
panelId
Bundle
restoreData
PropertyAnimator
animator
)
{
RecyclerView
rv
=
(
RecyclerView
)
findViewById
(
R
.
id
.
activity_stream_main_recyclerview
)
;
adapter
=
new
StreamRecyclerAdapter
(
)
;
rv
.
setAdapter
(
adapter
)
;
rv
.
setLayoutManager
(
new
LinearLayoutManager
(
getContext
(
)
)
)
;
rv
.
setHasFixedSize
(
true
)
;
lm
.
initLoader
(
0
null
new
CursorLoaderCallbacks
(
)
)
;
}
Override
public
void
unload
(
)
{
}
private
static
class
HistoryLoader
extends
SimpleCursorLoader
{
public
HistoryLoader
(
Context
context
)
{
super
(
context
)
;
}
Override
protected
Cursor
loadCursor
(
)
{
final
Context
context
=
getContext
(
)
;
return
GeckoProfile
.
get
(
context
)
.
getDB
(
)
.
getRecentHistory
(
context
.
getContentResolver
(
)
10
)
;
}
}
private
class
CursorLoaderCallbacks
implements
LoaderManager
.
LoaderCallbacks
<
Cursor
>
{
Override
public
Loader
<
Cursor
>
onCreateLoader
(
int
id
Bundle
args
)
{
return
new
HistoryLoader
(
getContext
(
)
)
;
}
Override
public
void
onLoadFinished
(
Loader
<
Cursor
>
loader
Cursor
data
)
{
adapter
.
swapCursor
(
data
)
;
}
Override
public
void
onLoaderReset
(
Loader
<
Cursor
>
loader
)
{
adapter
.
swapCursor
(
null
)
;
}
}
}
