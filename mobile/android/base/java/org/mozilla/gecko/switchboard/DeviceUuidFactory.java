package
org
.
mozilla
.
gecko
.
switchboard
;
import
java
.
util
.
UUID
;
import
android
.
content
.
Context
;
import
android
.
content
.
SharedPreferences
;
public
class
DeviceUuidFactory
{
protected
static
final
String
PREFS_FILE
=
"
com
.
keepsafe
.
switchboard
.
uuid
"
;
protected
static
final
String
PREFS_DEVICE_ID
=
"
device_id
"
;
private
static
UUID
uuid
=
null
;
public
DeviceUuidFactory
(
Context
context
)
{
if
(
uuid
=
=
null
)
{
synchronized
(
DeviceUuidFactory
.
class
)
{
if
(
uuid
=
=
null
)
{
final
SharedPreferences
prefs
=
context
.
getSharedPreferences
(
PREFS_FILE
Context
.
MODE_PRIVATE
)
;
final
String
id
=
prefs
.
getString
(
PREFS_DEVICE_ID
null
)
;
if
(
id
!
=
null
)
{
uuid
=
UUID
.
fromString
(
id
)
;
}
else
{
uuid
=
UUID
.
randomUUID
(
)
;
prefs
.
edit
(
)
.
putString
(
PREFS_DEVICE_ID
uuid
.
toString
(
)
)
.
apply
(
)
;
}
}
}
}
}
public
UUID
getDeviceUuid
(
)
{
return
uuid
;
}
}
