package
org
.
mozilla
.
gecko
.
switchboard
;
import
android
.
content
.
Context
;
import
android
.
content
.
SharedPreferences
;
import
android
.
support
.
annotation
.
Nullable
;
public
class
Preferences
{
private
static
final
String
switchBoardSettings
=
"
com
.
keepsafe
.
switchboard
.
settings
"
;
private
static
final
String
CONFIG_JSON
=
"
config
-
json
"
;
private
static
final
String
OVERRIDE_PREFIX
=
"
experiment
.
override
.
"
;
Nullable
public
static
String
getDynamicConfigJson
(
Context
c
)
{
final
SharedPreferences
prefs
=
c
.
getApplicationContext
(
)
.
getSharedPreferences
(
switchBoardSettings
Context
.
MODE_PRIVATE
)
;
return
prefs
.
getString
(
CONFIG_JSON
null
)
;
}
public
static
void
setDynamicConfigJson
(
Context
c
String
configJson
)
{
final
SharedPreferences
.
Editor
editor
=
c
.
getApplicationContext
(
)
.
getSharedPreferences
(
switchBoardSettings
Context
.
MODE_PRIVATE
)
.
edit
(
)
;
editor
.
putString
(
CONFIG_JSON
configJson
)
;
editor
.
apply
(
)
;
}
Nullable
public
static
Boolean
getOverrideValue
(
Context
c
String
experimentName
)
{
final
SharedPreferences
prefs
=
c
.
getApplicationContext
(
)
.
getSharedPreferences
(
switchBoardSettings
Context
.
MODE_PRIVATE
)
;
final
String
key
=
OVERRIDE_PREFIX
+
experimentName
;
if
(
prefs
.
contains
(
key
)
)
{
return
prefs
.
getBoolean
(
key
false
)
;
}
return
null
;
}
public
static
void
setOverrideValue
(
Context
c
String
experimentName
boolean
isEnabled
)
{
final
SharedPreferences
.
Editor
editor
=
c
.
getApplicationContext
(
)
.
getSharedPreferences
(
switchBoardSettings
Context
.
MODE_PRIVATE
)
.
edit
(
)
;
editor
.
putBoolean
(
OVERRIDE_PREFIX
+
experimentName
isEnabled
)
;
editor
.
apply
(
)
;
}
public
static
void
clearOverrideValue
(
Context
c
String
experimentName
)
{
final
SharedPreferences
.
Editor
editor
=
c
.
getApplicationContext
(
)
.
getSharedPreferences
(
switchBoardSettings
Context
.
MODE_PRIVATE
)
.
edit
(
)
;
editor
.
remove
(
OVERRIDE_PREFIX
+
experimentName
)
;
editor
.
apply
(
)
;
}
}
