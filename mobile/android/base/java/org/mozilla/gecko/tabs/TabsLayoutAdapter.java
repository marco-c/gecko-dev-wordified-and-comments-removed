package
org
.
mozilla
.
gecko
.
tabs
;
import
org
.
mozilla
.
gecko
.
Tab
;
import
org
.
mozilla
.
gecko
.
Tabs
;
import
org
.
mozilla
.
gecko
.
util
.
JavaUtil
;
import
android
.
content
.
Context
;
import
android
.
support
.
annotation
.
NonNull
;
import
android
.
support
.
v7
.
widget
.
RecyclerView
;
import
android
.
util
.
Log
;
import
android
.
view
.
LayoutInflater
;
import
android
.
view
.
View
;
import
android
.
view
.
ViewGroup
;
import
android
.
widget
.
Button
;
import
java
.
util
.
ArrayList
;
public
class
TabsLayoutAdapter
extends
RecyclerView
.
Adapter
<
TabsLayoutAdapter
.
TabsListViewHolder
>
{
private
static
final
String
LOGTAG
=
"
Gecko
"
+
TabsLayoutAdapter
.
class
.
getSimpleName
(
)
;
private
final
int
tabLayoutId
;
private
NonNull
ArrayList
<
Tab
>
tabs
;
private
final
LayoutInflater
inflater
;
private
final
boolean
isPrivate
;
private
final
Button
.
OnClickListener
closeOnClickListener
;
public
static
class
TabsListViewHolder
extends
RecyclerView
.
ViewHolder
{
public
TabsListViewHolder
(
View
itemView
)
{
super
(
itemView
)
;
}
}
public
TabsLayoutAdapter
(
Context
context
int
tabLayoutId
boolean
isPrivate
Button
.
OnClickListener
closeOnClickListener
)
{
inflater
=
LayoutInflater
.
from
(
context
)
;
this
.
tabLayoutId
=
tabLayoutId
;
this
.
isPrivate
=
isPrivate
;
this
.
closeOnClickListener
=
closeOnClickListener
;
tabs
=
new
ArrayList
<
>
(
0
)
;
}
final
void
setTabs
(
NonNull
ArrayList
<
Tab
>
tabs
)
{
this
.
tabs
=
tabs
;
notifyDataSetChanged
(
)
;
}
final
void
clear
(
)
{
tabs
=
new
ArrayList
<
>
(
0
)
;
notifyDataSetChanged
(
)
;
}
final
boolean
removeTab
(
Tab
tab
)
{
final
int
position
=
getPositionForTab
(
tab
)
;
if
(
position
=
=
-
1
)
{
return
false
;
}
tabs
.
remove
(
position
)
;
notifyItemRemoved
(
position
)
;
return
true
;
}
final
int
getPositionForTab
(
Tab
tab
)
{
if
(
tab
=
=
null
)
{
return
-
1
;
}
return
tabs
.
indexOf
(
tab
)
;
}
void
notifyTabChanged
(
Tab
tab
)
{
final
int
position
=
getPositionForTab
(
tab
)
;
if
(
position
!
=
-
1
)
{
notifyItemChanged
(
position
)
;
}
}
void
notifyTabInserted
(
Tab
tab
int
index
)
{
if
(
index
>
=
0
&
&
index
<
=
tabs
.
size
(
)
)
{
tabs
.
add
(
index
tab
)
;
notifyItemInserted
(
index
)
;
}
else
{
tabs
.
add
(
tab
)
;
notifyItemInserted
(
tabs
.
size
(
)
-
1
)
;
Log
.
e
(
LOGTAG
"
Tab
was
inserted
at
an
invalid
position
:
"
+
Integer
.
toString
(
index
)
)
;
}
}
boolean
moveTab
(
int
fromPosition
int
toPosition
)
{
final
int
fromTabId
=
tabs
.
get
(
fromPosition
)
.
getId
(
)
;
final
int
toTabId
=
tabs
.
get
(
toPosition
)
.
getId
(
)
;
JavaUtil
.
moveInList
(
tabs
fromPosition
toPosition
)
;
notifyItemMoved
(
fromPosition
toPosition
)
;
Tabs
.
getInstance
(
)
.
moveTab
(
fromTabId
fromPosition
toTabId
toPosition
)
;
return
true
;
}
Override
public
int
getItemCount
(
)
{
return
tabs
.
size
(
)
;
}
private
Tab
getItem
(
int
position
)
{
return
tabs
.
get
(
position
)
;
}
Override
public
void
onBindViewHolder
(
TabsListViewHolder
viewHolder
int
position
)
{
final
Tab
tab
=
getItem
(
position
)
;
final
TabsLayoutItemView
itemView
=
(
TabsLayoutItemView
)
viewHolder
.
itemView
;
itemView
.
assignValues
(
tab
)
;
}
Override
public
TabsListViewHolder
onCreateViewHolder
(
ViewGroup
parent
int
viewType
)
{
final
TabsLayoutItemView
viewItem
=
(
TabsLayoutItemView
)
inflater
.
inflate
(
tabLayoutId
parent
false
)
;
viewItem
.
setPrivateMode
(
isPrivate
)
;
viewItem
.
setCloseOnClickListener
(
closeOnClickListener
)
;
return
new
TabsListViewHolder
(
viewItem
)
;
}
}
