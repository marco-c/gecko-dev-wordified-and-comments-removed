#
ifndef
RLBOX_CONFIG
#
define
RLBOX_CONFIG
#
include
"
mozilla
/
Assertions
.
h
"
#
ifdef
XP_MACOSX
#
include
"
mozilla
/
RWLock
.
h
"
namespace
rlbox
{
struct
rlbox_shared_lock
{
mozilla
:
:
detail
:
:
StaticRWLock
rwlock
;
}
;
}
#
define
RLBOX_USE_CUSTOM_SHARED_LOCK
#
define
RLBOX_SHARED_LOCK
(
name
)
rlbox
:
:
rlbox_shared_lock
name
#
define
RLBOX_ACQUIRE_SHARED_GUARD
(
name
.
.
.
)
\
mozilla
:
:
detail
:
:
StaticAutoReadLock
name
(
(
__VA_ARGS__
)
.
rwlock
)
#
define
RLBOX_ACQUIRE_UNIQUE_GUARD
(
name
.
.
.
)
\
mozilla
:
:
detail
:
:
StaticAutoWriteLock
name
(
(
__VA_ARGS__
)
.
rwlock
)
#
endif
#
define
RLBOX_SINGLE_THREADED_INVOCATIONS
#
define
RLBOX_CUSTOM_ABORT
(
msg
)
MOZ_CRASH_UNSAFE_PRINTF
(
"
RLBox
crash
:
%
s
"
msg
)
#
define
RLBOX_EMBEDDER_PROVIDES_TLS_STATIC_VARIABLES
#
endif
