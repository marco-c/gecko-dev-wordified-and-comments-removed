const
{
classes
:
Cc
interfaces
:
Ci
utils
:
Cu
results
:
Cr
}
=
Components
;
Cu
.
import
(
"
resource
:
/
/
gre
/
modules
/
NetUtil
.
jsm
"
)
;
Cu
.
import
(
"
resource
:
/
/
gre
/
modules
/
XPCOMUtils
.
jsm
"
)
;
XPCOMUtils
.
defineLazyServiceGetter
(
this
"
gContentSecurityManager
"
"
mozilla
.
org
/
contentsecuritymanager
;
1
"
"
nsIContentSecurityManager
"
)
;
add_task
(
function
*
test_isURIPotentiallyTrustworthy
(
)
{
for
(
let
[
uriSpec
expectedResult
]
of
[
[
"
http
:
/
/
example
.
com
/
"
false
]
[
"
https
:
/
/
example
.
com
/
"
true
]
[
"
http
:
/
/
localhost
/
"
true
]
[
"
http
:
/
/
127
.
0
.
0
.
1
/
"
true
]
[
"
file
:
/
/
/
"
true
]
[
"
resource
:
/
/
/
"
true
]
[
"
about
:
config
"
false
]
[
"
urn
:
generic
"
false
]
]
)
{
let
uri
=
NetUtil
.
newURI
(
uriSpec
)
;
Assert
.
equal
(
gContentSecurityManager
.
isURIPotentiallyTrustworthy
(
uri
)
expectedResult
)
;
}
}
)
;
