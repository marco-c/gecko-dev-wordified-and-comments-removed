#
ifndef
mozilla_dom_SRICheck_h
#
define
mozilla_dom_SRICheck_h
#
include
"
mozilla
/
CORSMode
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
SRIMetadata
.
h
"
class
nsIDocument
;
class
nsIStreamLoader
;
class
nsIUnicharStreamLoader
;
namespace
mozilla
{
namespace
dom
{
class
SRICheck
final
{
public
:
static
const
uint32_t
MAX_METADATA_LENGTH
=
24
*
1024
;
static
const
uint32_t
MAX_METADATA_TOKENS
=
512
;
static
nsresult
IntegrityMetadata
(
const
nsAString
&
aMetadataList
const
nsIDocument
*
aDocument
SRIMetadata
*
outMetadata
)
;
static
nsresult
VerifyIntegrity
(
const
SRIMetadata
&
aMetadata
nsIUnicharStreamLoader
*
aLoader
const
CORSMode
aCORSMode
const
nsAString
&
aString
const
nsIDocument
*
aDocument
)
;
static
nsresult
VerifyIntegrity
(
const
SRIMetadata
&
aMetadata
nsIStreamLoader
*
aLoader
const
CORSMode
aCORSMode
uint32_t
aStringLen
const
uint8_t
*
aString
const
nsIDocument
*
aDocument
)
;
}
;
}
}
#
endif
