#
ifndef
mozilla_dom_FramingChecker_h
#
define
mozilla_dom_FramingChecker_h
class
nsIDocShell
;
class
nsIChannel
;
class
nsIHttpChannel
;
class
nsIDocShellTreeItem
;
class
nsIURI
;
class
nsIContentSecurityPolicy
;
namespace
mozilla
{
namespace
dom
{
class
BrowsingContext
;
}
}
class
FramingChecker
{
public
:
static
bool
CheckFrameOptions
(
nsIChannel
*
aChannel
nsIContentSecurityPolicy
*
aCSP
)
;
protected
:
enum
XFOHeader
{
eDENY
eSAMEORIGIN
}
;
static
void
ReportError
(
const
char
*
aMessageTag
nsIURI
*
aParentURI
nsIURI
*
aChildURI
const
nsAString
&
aPolicy
uint64_t
aInnerWindowID
)
;
static
void
ReportError
(
const
char
*
aMessageTag
BrowsingContext
*
aParentContext
nsIURI
*
aChildURI
const
nsAString
&
aPolicy
uint64_t
aInnerWindowID
)
;
static
bool
CheckOneFrameOptionsPolicy
(
nsIHttpChannel
*
aHttpChannel
const
nsAString
&
aPolicy
)
;
}
;
#
endif
