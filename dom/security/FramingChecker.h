#
ifndef
mozilla_dom_FramingChecker_h
#
define
mozilla_dom_FramingChecker_h
#
include
"
nsStringFwd
.
h
"
class
nsIDocShell
;
class
nsIChannel
;
class
nsIHttpChannel
;
class
nsIDocShellTreeItem
;
class
nsIURI
;
class
nsIContentSecurityPolicy
;
namespace
mozilla
:
:
dom
{
class
BrowsingContext
;
}
class
FramingChecker
{
public
:
static
bool
CheckFrameOptions
(
nsIChannel
*
aChannel
nsIContentSecurityPolicy
*
aCSP
bool
&
outIsFrameCheckingSkipped
)
;
protected
:
enum
XFOHeader
{
eDENY
eSAMEORIGIN
}
;
static
void
ReportError
(
const
char
*
aMessageTag
nsIHttpChannel
*
aChannel
nsIURI
*
aURI
const
nsAString
&
aPolicy
)
;
static
bool
CheckOneFrameOptionsPolicy
(
nsIHttpChannel
*
aHttpChannel
const
nsAString
&
aPolicy
)
;
}
;
#
endif
