#
ifndef
mozilla_dom_ContentVerifier_h
#
define
mozilla_dom_ContentVerifier_h
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIContentSignatureVerifier
.
h
"
#
include
"
nsIObserver
.
h
"
#
include
"
nsIStreamListener
.
h
"
#
include
"
nsString
.
h
"
#
include
"
nsTArray
.
h
"
class
ContentVerifier
:
public
nsIStreamListener
public
nsIContentSignatureReceiverCallback
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSISTREAMLISTENER
NS_DECL_NSIREQUESTOBSERVER
NS_DECL_NSICONTENTSIGNATURERECEIVERCALLBACK
explicit
ContentVerifier
(
nsIStreamListener
*
aMediatedListener
nsISupports
*
aMediatedContext
)
:
mNextListener
(
aMediatedListener
)
mContextCreated
(
false
)
mContentRead
(
false
)
{
}
nsresult
Init
(
const
nsACString
&
aContentSignatureHeader
nsIRequest
*
aRequest
nsISupports
*
aContext
)
;
protected
:
virtual
~
ContentVerifier
(
)
{
}
private
:
void
FinishSignature
(
)
;
FallibleTArray
<
nsCString
>
mContent
;
nsCOMPtr
<
nsIStreamListener
>
mNextListener
;
nsCOMPtr
<
nsIContentSignatureVerifier
>
mVerifier
;
nsCOMPtr
<
nsIRequest
>
mContentRequest
;
nsCOMPtr
<
nsISupports
>
mContentContext
;
bool
mContextCreated
;
bool
mContentRead
;
}
;
#
endif
