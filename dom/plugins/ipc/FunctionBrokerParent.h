#
ifndef
mozilla_plugins_functionbrokerparent_h
#
define
mozilla_plugins_functionbrokerparent_h
#
include
"
mozilla
/
plugins
/
PFunctionBrokerParent
.
h
"
namespace
mozilla
{
namespace
plugins
{
class
FunctionBrokerThread
;
class
FunctionBrokerParent
:
public
PFunctionBrokerParent
{
public
:
static
FunctionBrokerParent
*
Create
(
Endpoint
<
PFunctionBrokerParent
>
&
&
aParentEnd
)
;
static
void
Destroy
(
FunctionBrokerParent
*
aInst
)
;
void
ActorDestroy
(
ActorDestroyReason
aWhy
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvBrokerFunction
(
const
FunctionHookId
&
aFunctionId
const
IpdlTuple
&
aInTuple
IpdlTuple
*
aOutTuple
)
override
;
private
:
explicit
FunctionBrokerParent
(
FunctionBrokerThread
*
aThread
Endpoint
<
PFunctionBrokerParent
>
&
&
aParentEnd
)
;
void
ShutdownOnBrokerThread
(
)
;
void
Bind
(
Endpoint
<
PFunctionBrokerParent
>
&
&
aEnd
)
;
static
bool
RunBrokeredFunction
(
base
:
:
ProcessId
aClientId
const
FunctionHookId
&
aFunctionId
const
IPC
:
:
IpdlTuple
&
aInTuple
IPC
:
:
IpdlTuple
*
aOutTuple
)
;
nsAutoPtr
<
FunctionBrokerThread
>
mThread
;
Monitor
mMonitor
;
bool
mShutdownDone
;
}
;
}
}
#
endif
