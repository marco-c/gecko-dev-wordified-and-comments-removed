#
ifndef
mozilla_dom_MutableBlobStreamListener_h
#
define
mozilla_dom_MutableBlobStreamListener_h
#
include
"
nsIStreamListener
.
h
"
#
include
"
nsIThreadRetargetableStreamListener
.
h
"
#
include
"
nsTString
.
h
"
#
include
"
mozilla
/
dom
/
MutableBlobStorage
.
h
"
class
nsIEventTarget
;
namespace
mozilla
:
:
dom
{
class
MutableBlobStreamListener
final
:
public
nsIStreamListener
public
nsIThreadRetargetableStreamListener
{
public
:
NS_DECL_THREADSAFE_ISUPPORTS
NS_DECL_NSISTREAMLISTENER
NS_DECL_NSITHREADRETARGETABLESTREAMLISTENER
NS_DECL_NSIREQUESTOBSERVER
MutableBlobStreamListener
(
MutableBlobStorage
:
:
MutableBlobStorageType
aType
const
nsACString
&
aContentType
MutableBlobStorageCallback
*
aCallback
nsIEventTarget
*
aEventTarget
=
nullptr
)
;
private
:
~
MutableBlobStreamListener
(
)
;
static
nsresult
WriteSegmentFun
(
nsIInputStream
*
aWriter
void
*
aClosure
const
char
*
aFromSegment
uint32_t
aOffset
uint32_t
aCount
uint32_t
*
aWriteCount
)
;
RefPtr
<
MutableBlobStorage
>
mStorage
;
RefPtr
<
MutableBlobStorageCallback
>
mCallback
;
MutableBlobStorage
:
:
MutableBlobStorageType
mStorageType
;
nsCString
mContentType
;
nsCOMPtr
<
nsIEventTarget
>
mEventTarget
;
}
;
}
#
endif
