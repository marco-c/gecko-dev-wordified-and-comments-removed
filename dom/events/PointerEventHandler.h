#
ifndef
mozilla_PointerEventHandler_h
#
define
mozilla_PointerEventHandler_h
#
include
"
mozilla
/
EventForwards
.
h
"
class
nsIFrame
;
class
nsIContent
;
namespace
mozilla
{
class
PresShell
;
class
PointerCaptureInfo
final
{
public
:
nsCOMPtr
<
nsIContent
>
mPendingContent
;
nsCOMPtr
<
nsIContent
>
mOverrideContent
;
explicit
PointerCaptureInfo
(
nsIContent
*
aPendingContent
)
:
mPendingContent
(
aPendingContent
)
{
MOZ_COUNT_CTOR
(
PointerCaptureInfo
)
;
}
~
PointerCaptureInfo
(
)
{
MOZ_COUNT_DTOR
(
PointerCaptureInfo
)
;
}
bool
Empty
(
)
{
return
!
(
mPendingContent
|
|
mOverrideContent
)
;
}
}
;
class
PointerEventHandler
final
{
public
:
static
void
Initialize
(
)
;
static
void
InitializeStatics
(
)
;
static
void
ReleaseStatics
(
)
;
static
bool
IsPointerEventEnabled
(
)
;
static
bool
IsPointerEventImplicitCaptureForTouchEnabled
(
)
;
static
void
UpdateActivePointerState
(
WidgetMouseEvent
*
aEvent
)
;
static
void
SetPointerCaptureById
(
uint32_t
aPointerId
nsIContent
*
aContent
)
;
static
void
ReleasePointerCaptureById
(
uint32_t
aPointerId
)
;
static
PointerCaptureInfo
*
GetPointerCaptureInfo
(
uint32_t
aPointerId
)
;
static
bool
GetPointerInfo
(
uint32_t
aPointerId
bool
&
aActiveState
)
;
static
void
CheckPointerCaptureState
(
WidgetPointerEvent
*
aEvent
)
;
static
void
ImplicitlyCapturePointer
(
nsIFrame
*
aFrame
WidgetEvent
*
aEvent
)
;
static
void
ImplicitlyReleasePointerCapture
(
WidgetEvent
*
aEvent
)
;
static
nsIFrame
*
GetPointerCapturingFrame
(
nsIFrame
*
aFrameUnderCursor
WidgetGUIEvent
*
aEvent
)
;
static
nsIContent
*
GetPointerCapturingContent
(
uint32_t
aPointerId
)
;
static
void
ReleaseIfCaptureByDescendant
(
nsIContent
*
aContent
)
;
static
void
PreHandlePointerEventsPreventDefault
(
WidgetPointerEvent
*
aPointerEvent
WidgetGUIEvent
*
aMouseOrTouchEvent
)
;
static
void
PostHandlePointerEventsPreventDefault
(
WidgetPointerEvent
*
aPointerEvent
WidgetGUIEvent
*
aMouseOrTouchEvent
)
;
static
void
DispatchPointerFromMouseOrTouch
(
PresShell
*
aShell
nsIFrame
*
aFrame
WidgetGUIEvent
*
aEvent
bool
aDontRetargetEvents
nsEventStatus
*
aStatus
nsIContent
*
*
aTargetContent
)
;
private
:
static
uint16_t
GetPointerType
(
uint32_t
aPointerId
)
;
static
bool
GetPointerPrimaryState
(
uint32_t
aPointerId
)
;
static
void
DispatchGotOrLostPointerCaptureEvent
(
bool
aIsGotCapture
const
WidgetPointerEvent
*
aPointerEvent
nsIContent
*
aCaptureTarget
)
;
}
;
}
#
endif
