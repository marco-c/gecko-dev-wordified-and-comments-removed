#
include
"
mozilla
/
dom
/
CommandEvent
.
h
"
#
include
"
mozilla
/
StaticPrefs_dom
.
h
"
#
include
"
mozilla
/
MiscEvents
.
h
"
#
include
"
nsContentUtils
.
h
"
#
include
"
prtime
.
h
"
namespace
mozilla
:
:
dom
{
bool
CommandEvent
:
:
IsCallerChromeOrCommandForEnabled
(
JSContext
*
aCx
JSObject
*
aGlobal
)
{
return
nsContentUtils
:
:
ThreadsafeIsSystemCaller
(
aCx
)
|
|
StaticPrefs
:
:
dom_element_commandfor_enabled
(
)
;
}
CommandEvent
:
:
CommandEvent
(
EventTarget
*
aOwner
nsPresContext
*
aPresContext
WidgetCommandEvent
*
aEvent
)
:
Event
(
aOwner
aPresContext
aEvent
?
aEvent
:
new
WidgetCommandEvent
(
)
)
{
if
(
aEvent
)
{
mEventIsInternal
=
false
;
}
else
{
mEventIsInternal
=
true
;
}
}
void
CommandEvent
:
:
GetCommand
(
nsAString
&
aCommand
)
{
nsAtom
*
command
=
mEvent
-
>
AsCommandEvent
(
)
-
>
mCommand
;
if
(
command
)
{
command
-
>
ToString
(
aCommand
)
;
}
else
{
aCommand
.
Truncate
(
)
;
}
}
}
using
namespace
mozilla
;
using
namespace
mozilla
:
:
dom
;
already_AddRefed
<
CommandEvent
>
NS_NewDOMCommandEvent
(
EventTarget
*
aOwner
nsPresContext
*
aPresContext
WidgetCommandEvent
*
aEvent
)
{
RefPtr
<
CommandEvent
>
it
=
new
CommandEvent
(
aOwner
aPresContext
aEvent
)
;
return
it
.
forget
(
)
;
}
