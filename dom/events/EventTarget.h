#
ifndef
mozilla_dom_EventTarget_h_
#
define
mozilla_dom_EventTarget_h_
#
include
"
nsIDOMEventTarget
.
h
"
#
include
"
nsWrapperCache
.
h
"
#
include
"
nsIAtom
.
h
"
class
nsPIDOMWindowOuter
;
class
nsIGlobalObject
;
namespace
mozilla
{
class
ErrorResult
;
class
EventListenerManager
;
namespace
dom
{
class
Event
;
class
EventListener
;
class
EventHandlerNonNull
;
template
<
class
T
>
struct
Nullable
;
#
define
NS_EVENTTARGET_IID
\
{
0xde651c36
0x0053
0x4c67
\
{
0xb1
0x3d
0x67
0xb9
0x40
0xfc
0x82
0xe4
}
}
class
EventTarget
:
public
nsIDOMEventTarget
public
nsWrapperCache
{
public
:
NS_DECLARE_STATIC_IID_ACCESSOR
(
NS_EVENTTARGET_IID
)
using
nsIDOMEventTarget
:
:
AddEventListener
;
using
nsIDOMEventTarget
:
:
RemoveEventListener
;
using
nsIDOMEventTarget
:
:
DispatchEvent
;
virtual
void
AddEventListener
(
const
nsAString
&
aType
EventListener
*
aCallback
bool
aCapture
const
Nullable
<
bool
>
&
aWantsUntrusted
ErrorResult
&
aRv
)
=
0
;
virtual
void
RemoveEventListener
(
const
nsAString
&
aType
EventListener
*
aCallback
bool
aCapture
ErrorResult
&
aRv
)
;
bool
DispatchEvent
(
Event
&
aEvent
ErrorResult
&
aRv
)
;
EventHandlerNonNull
*
GetEventHandler
(
const
nsAString
&
aType
)
{
nsCOMPtr
<
nsIAtom
>
type
=
NS_Atomize
(
aType
)
;
return
GetEventHandler
(
type
EmptyString
(
)
)
;
}
void
SetEventHandler
(
const
nsAString
&
aType
EventHandlerNonNull
*
aHandler
ErrorResult
&
rv
)
;
virtual
void
EventListenerAdded
(
nsIAtom
*
aType
)
{
}
virtual
void
EventListenerRemoved
(
nsIAtom
*
aType
)
{
}
virtual
nsPIDOMWindowOuter
*
GetOwnerGlobalForBindings
(
)
=
0
;
virtual
nsIGlobalObject
*
GetOwnerGlobal
(
)
const
=
0
;
virtual
EventListenerManager
*
GetOrCreateListenerManager
(
)
=
0
;
virtual
EventListenerManager
*
GetExistingListenerManager
(
)
const
=
0
;
virtual
bool
HasApzAwareListeners
(
)
const
;
protected
:
EventHandlerNonNull
*
GetEventHandler
(
nsIAtom
*
aType
const
nsAString
&
aTypeString
)
;
void
SetEventHandler
(
nsIAtom
*
aType
const
nsAString
&
aTypeString
EventHandlerNonNull
*
aHandler
)
;
}
;
NS_DEFINE_STATIC_IID_ACCESSOR
(
EventTarget
NS_EVENTTARGET_IID
)
}
}
#
endif
