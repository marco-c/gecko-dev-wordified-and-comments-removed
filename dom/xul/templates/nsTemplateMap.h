#
ifndef
nsTemplateMap_h__
#
define
nsTemplateMap_h__
#
include
"
pldhash
.
h
"
#
include
"
nsXULElement
.
h
"
class
nsTemplateMap
{
protected
:
struct
Entry
:
public
PLDHashEntryHdr
{
nsIContent
*
mContent
;
nsIContent
*
mTemplate
;
}
;
PLDHashTable
mTable
;
public
:
nsTemplateMap
(
)
:
mTable
(
PL_DHashGetStubOps
(
)
sizeof
(
Entry
)
)
{
}
~
nsTemplateMap
(
)
{
}
void
Put
(
nsIContent
*
aContent
nsIContent
*
aTemplate
)
{
NS_ASSERTION
(
!
mTable
.
Search
(
aContent
)
"
aContent
already
in
map
"
)
;
auto
entry
=
static_cast
<
Entry
*
>
(
mTable
.
Add
(
aContent
fallible
)
)
;
if
(
entry
)
{
entry
-
>
mContent
=
aContent
;
entry
-
>
mTemplate
=
aTemplate
;
}
}
void
Remove
(
nsIContent
*
aContent
)
{
mTable
.
Remove
(
aContent
)
;
for
(
nsIContent
*
child
=
aContent
-
>
GetFirstChild
(
)
;
child
;
child
=
child
-
>
GetNextSibling
(
)
)
{
Remove
(
child
)
;
}
}
void
GetTemplateFor
(
nsIContent
*
aContent
nsIContent
*
*
aResult
)
{
auto
entry
=
static_cast
<
Entry
*
>
(
mTable
.
Search
(
aContent
)
)
;
if
(
entry
)
NS_IF_ADDREF
(
*
aResult
=
entry
-
>
mTemplate
)
;
else
*
aResult
=
nullptr
;
}
void
Clear
(
)
{
mTable
.
Clear
(
)
;
}
}
;
#
endif
