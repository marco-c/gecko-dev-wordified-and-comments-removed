#
ifndef
mozilla_dom_bluetooth_bluedroid_BluetoothDaemonInterface_h
#
define
mozilla_dom_bluetooth_bluedroid_BluetoothDaemonInterface_h
#
include
"
BluetoothInterface
.
h
"
#
include
"
mozilla
/
ipc
/
DaemonSocketConsumer
.
h
"
#
include
"
mozilla
/
ipc
/
ListenSocketConsumer
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
namespace
mozilla
{
namespace
ipc
{
class
DaemonSocket
;
class
ListenSocket
;
}
}
BEGIN_BLUETOOTH_NAMESPACE
class
BluetoothDaemonA2dpInterface
;
class
BluetoothDaemonAvrcpInterface
;
class
BluetoothDaemonCoreInterface
;
class
BluetoothDaemonGattInterface
;
class
BluetoothDaemonHandsfreeInterface
;
class
BluetoothDaemonProtocol
;
class
BluetoothDaemonSetupInterface
;
class
BluetoothDaemonSocketInterface
;
class
BluetoothDaemonHidInterface
;
class
BluetoothDaemonInterface
final
:
public
BluetoothInterface
public
mozilla
:
:
ipc
:
:
DaemonSocketConsumer
public
mozilla
:
:
ipc
:
:
ListenSocketConsumer
{
public
:
class
CleanupResultHandler
;
class
InitResultHandler
;
friend
class
CleanupResultHandler
;
friend
class
InitResultHandler
;
static
BluetoothDaemonInterface
*
GetInstance
(
)
;
void
Init
(
BluetoothNotificationHandler
*
aNotificationHandler
BluetoothResultHandler
*
aRes
)
override
;
void
Cleanup
(
BluetoothResultHandler
*
aRes
)
override
;
BluetoothSetupInterface
*
GetBluetoothSetupInterface
(
)
override
;
BluetoothCoreInterface
*
GetBluetoothCoreInterface
(
)
override
;
BluetoothSocketInterface
*
GetBluetoothSocketInterface
(
)
override
;
BluetoothHandsfreeInterface
*
GetBluetoothHandsfreeInterface
(
)
override
;
BluetoothA2dpInterface
*
GetBluetoothA2dpInterface
(
)
override
;
BluetoothAvrcpInterface
*
GetBluetoothAvrcpInterface
(
)
override
;
BluetoothGattInterface
*
GetBluetoothGattInterface
(
)
override
;
BluetoothHidInterface
*
GetBluetoothHidInterface
(
)
override
;
protected
:
enum
Channel
{
LISTEN_SOCKET
CMD_CHANNEL
NTF_CHANNEL
}
;
BluetoothDaemonInterface
(
)
;
~
BluetoothDaemonInterface
(
)
;
void
OnConnectSuccess
(
int
aIndex
)
override
;
void
OnConnectError
(
int
aIndex
)
override
;
void
OnDisconnect
(
int
aIndex
)
override
;
private
:
void
DispatchError
(
BluetoothResultHandler
*
aRes
BluetoothStatus
aStatus
)
;
void
DispatchError
(
BluetoothResultHandler
*
aRes
nsresult
aRv
)
;
static
BluetoothNotificationHandler
*
sNotificationHandler
;
nsCString
mListenSocketName
;
RefPtr
<
mozilla
:
:
ipc
:
:
ListenSocket
>
mListenSocket
;
RefPtr
<
mozilla
:
:
ipc
:
:
DaemonSocket
>
mCmdChannel
;
RefPtr
<
mozilla
:
:
ipc
:
:
DaemonSocket
>
mNtfChannel
;
UniquePtr
<
BluetoothDaemonProtocol
>
mProtocol
;
nsTArray
<
RefPtr
<
BluetoothResultHandler
>
>
mResultHandlerQ
;
UniquePtr
<
BluetoothDaemonSetupInterface
>
mSetupInterface
;
UniquePtr
<
BluetoothDaemonCoreInterface
>
mCoreInterface
;
UniquePtr
<
BluetoothDaemonSocketInterface
>
mSocketInterface
;
UniquePtr
<
BluetoothDaemonHidInterface
>
mHidInterface
;
UniquePtr
<
BluetoothDaemonHandsfreeInterface
>
mHandsfreeInterface
;
UniquePtr
<
BluetoothDaemonA2dpInterface
>
mA2dpInterface
;
UniquePtr
<
BluetoothDaemonAvrcpInterface
>
mAvrcpInterface
;
UniquePtr
<
BluetoothDaemonGattInterface
>
mGattInterface
;
}
;
END_BLUETOOTH_NAMESPACE
#
endif
