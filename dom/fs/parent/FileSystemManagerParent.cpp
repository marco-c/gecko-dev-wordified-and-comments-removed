#
include
"
FileSystemManagerParent
.
h
"
#
include
"
nsNetCID
.
h
"
#
include
"
mozilla
/
dom
/
FileSystemTypes
.
h
"
#
include
"
mozilla
/
ipc
/
Endpoint
.
h
"
using
IPCResult
=
mozilla
:
:
ipc
:
:
IPCResult
;
namespace
mozilla
{
extern
LazyLogModule
gOPFSLog
;
}
#
define
LOG
(
args
)
MOZ_LOG
(
mozilla
:
:
gOPFSLog
mozilla
:
:
LogLevel
:
:
Verbose
args
)
#
define
LOG_DEBUG
(
args
)
\
MOZ_LOG
(
mozilla
:
:
gOPFSLog
mozilla
:
:
LogLevel
:
:
Debug
args
)
namespace
mozilla
:
:
dom
{
FileSystemManagerParent
:
:
FileSystemManagerParent
(
TaskQueue
*
aTaskQueue
const
EntryId
&
aRootEntry
)
:
mTaskQueue
(
aTaskQueue
)
mData
(
)
mRootEntry
(
aRootEntry
)
{
}
IPCResult
FileSystemManagerParent
:
:
RecvGetRootHandleMsg
(
GetRootHandleMsgResolver
&
&
aResolver
)
{
FileSystemGetHandleResponse
response
(
mRootEntry
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvGetDirectoryHandleMsg
(
FileSystemGetHandleRequest
&
&
GetDirectoryHandleMsgResolver
&
&
aResolver
)
{
FileSystemGetHandleResponse
response
(
NS_ERROR_NOT_IMPLEMENTED
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvGetFileHandleMsg
(
FileSystemGetHandleRequest
&
&
aRequest
GetFileHandleMsgResolver
&
&
aResolver
)
{
FileSystemGetHandleResponse
response
(
NS_ERROR_NOT_IMPLEMENTED
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvGetFileMsg
(
FileSystemGetFileRequest
&
&
aRequest
GetFileMsgResolver
&
&
aResolver
)
{
FileSystemGetFileResponse
response
(
NS_ERROR_NOT_IMPLEMENTED
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvResolveMsg
(
FileSystemResolveRequest
&
&
aRequest
ResolveMsgResolver
&
&
aResolver
)
{
FileSystemResolveResponse
response
(
NS_ERROR_NOT_IMPLEMENTED
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvGetEntriesMsg
(
FileSystemGetEntriesRequest
&
&
aRequest
GetEntriesMsgResolver
&
&
aResolver
)
{
FileSystemGetEntriesResponse
response
(
NS_ERROR_NOT_IMPLEMENTED
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvRemoveEntryMsg
(
FileSystemRemoveEntryRequest
&
&
aRequest
RemoveEntryMsgResolver
&
&
aResolver
)
{
FileSystemRemoveEntryResponse
response
(
NS_ERROR_NOT_IMPLEMENTED
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvCloseFile
(
FileSystemGetFileRequest
&
&
aRequest
)
{
LOG
(
(
"
Closing
file
"
)
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvGetAccessHandle
(
FileSystemGetFileRequest
&
&
aRequest
GetAccessHandleResolver
&
&
aResolver
)
{
FileSystemGetAccessHandleResponse
response
(
NS_ERROR_NOT_IMPLEMENTED
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvGetWritable
(
FileSystemGetFileRequest
&
&
aRequest
GetWritableResolver
&
&
aResolver
)
{
FileSystemGetAccessHandleResponse
response
(
NS_ERROR_NOT_IMPLEMENTED
)
;
aResolver
(
response
)
;
return
IPC_OK
(
)
;
}
IPCResult
FileSystemManagerParent
:
:
RecvNeedQuota
(
FileSystemQuotaRequest
&
&
aRequest
NeedQuotaResolver
&
&
aResolver
)
{
aResolver
(
0u
)
;
return
IPC_OK
(
)
;
}
FileSystemManagerParent
:
:
~
FileSystemManagerParent
(
)
{
LOG
(
(
"
Destroying
FileSystemManagerParent
%
p
"
this
)
)
;
if
(
mTaskQueue
)
{
mTaskQueue
-
>
BeginShutdown
(
)
;
}
}
}
