#
include
"
StartedTransaction
.
h
"
#
include
"
ResultConnection
.
h
"
#
include
"
mozilla
/
dom
/
quota
/
QuotaCommon
.
h
"
#
include
"
mozilla
/
dom
/
quota
/
ResultExtensions
.
h
"
namespace
mozilla
:
:
dom
:
:
fs
{
Result
<
StartedTransaction
QMResult
>
StartedTransaction
:
:
Create
(
const
ResultConnection
&
aConn
)
{
auto
transaction
=
MakeUnique
<
mozStorageTransaction
>
(
aConn
.
get
(
)
false
mozIStorageConnection
:
:
TRANSACTION_IMMEDIATE
)
;
QM_TRY
(
QM_TO_RESULT
(
transaction
-
>
Start
(
)
)
)
;
return
StartedTransaction
(
std
:
:
move
(
transaction
)
)
;
}
nsresult
StartedTransaction
:
:
Commit
(
)
{
return
mTransaction
-
>
Commit
(
)
;
}
nsresult
StartedTransaction
:
:
Rollback
(
)
{
return
mTransaction
-
>
Rollback
(
)
;
}
StartedTransaction
:
:
StartedTransaction
(
UniquePtr
<
mozStorageTransaction
>
&
&
aTransaction
)
:
mTransaction
(
std
:
:
move
(
aTransaction
)
)
{
}
}
