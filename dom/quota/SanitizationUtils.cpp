#
include
"
SanitizationUtils
.
h
"
#
include
<
string
>
#
include
"
mozilla
/
dom
/
quota
/
QuotaManager
.
h
"
#
include
"
nsString
.
h
"
namespace
mozilla
:
:
dom
:
:
quota
{
nsAutoCString
MakeSanitizedOriginCString
(
const
nsACString
&
aOrigin
)
{
#
ifdef
XP_WIN
NS_ASSERTION
(
!
strcmp
(
QuotaManager
:
:
kReplaceChars
FILE_ILLEGAL_CHARACTERS
FILE_PATH_SEPARATOR
)
"
Illegal
file
characters
have
changed
!
"
)
;
#
endif
nsAutoCString
res
{
aOrigin
}
;
res
.
ReplaceChar
(
QuotaManager
:
:
kReplaceChars
'
+
'
)
;
return
res
;
}
nsAutoString
MakeSanitizedOriginString
(
const
nsACString
&
aOrigin
)
{
return
NS_ConvertASCIItoUTF16
(
MakeSanitizedOriginCString
(
aOrigin
)
)
;
}
}
