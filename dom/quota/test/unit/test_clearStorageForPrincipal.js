async
function
testSteps
(
)
{
const
testingOrigins
=
[
{
origin
:
"
http
:
/
/
example
.
com
"
path
:
"
storage
/
default
/
http
+
+
+
example
.
com
/
"
only_idb
:
false
}
{
origin
:
"
http
:
/
/
www
.
mozilla
.
org
"
path
:
"
storage
/
default
/
http
+
+
+
www
.
mozilla
.
org
/
"
only_idb
:
true
}
]
;
const
removingClient
=
"
idb
"
;
info
(
"
Installing
package
to
create
the
environment
"
)
;
installPackage
(
"
clearStorageForPrincipal_profile
"
)
;
let
request
;
let
file
;
for
(
let
i
=
0
;
i
<
testingOrigins
.
length
;
+
+
i
)
{
info
(
"
Clearing
"
)
;
request
=
clearClient
(
getPrincipal
(
testingOrigins
[
i
]
.
origin
)
null
removingClient
)
;
await
requestFinished
(
request
)
;
info
(
"
Verifying
"
)
;
file
=
getRelativeFile
(
testingOrigins
[
i
]
.
path
+
removingClient
)
;
ok
(
!
file
.
exists
(
)
"
Client
file
doesn
'
t
exist
"
)
;
file
=
getRelativeFile
(
testingOrigins
[
i
]
.
path
)
;
if
(
testingOrigins
[
i
]
.
only_idb
)
{
ok
(
!
file
.
exists
(
)
"
Origin
file
doesn
'
t
exist
"
)
;
}
else
{
ok
(
file
.
exists
(
)
"
Origin
file
does
exist
"
)
;
}
}
}
