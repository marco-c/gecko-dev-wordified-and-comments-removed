async
function
testSteps
(
)
{
const
allowListFiles
=
[
"
.
dot
-
file
"
"
desktop
.
ini
"
"
Desktop
.
ini
"
"
Thumbs
.
db
"
"
thumbs
.
db
"
]
;
for
(
let
allowListFile
of
allowListFiles
)
{
info
(
"
Testing
"
+
allowListFile
+
"
in
the
repository
"
)
;
info
(
"
Creating
unknown
file
"
)
;
for
(
let
dir
of
[
"
persistenceType
dir
"
"
origin
dir
"
]
)
{
let
dirPath
=
dir
=
=
"
persistenceType
dir
"
?
"
storage
/
default
/
"
:
"
storage
/
default
/
http
+
+
+
example
.
com
/
"
;
let
file
=
getRelativeFile
(
dirPath
+
allowListFile
)
;
file
.
create
(
Ci
.
nsIFile
.
NORMAL_FILE_TYPE
parseInt
(
"
0644
"
8
)
)
;
}
info
(
"
Initializing
an
origin
"
)
;
let
request
=
initStorageAndOrigin
(
getPrincipal
(
"
http
:
/
/
example
.
com
"
)
"
default
"
)
;
await
requestFinished
(
request
)
;
info
(
"
Resetting
"
)
;
request
=
reset
(
)
;
await
requestFinished
(
request
)
;
info
(
"
Getting
usage
"
)
;
request
=
getCurrentUsage
(
continueToNextStepSync
)
;
await
requestFinished
(
request
)
;
info
(
"
Clearing
"
)
;
request
=
clear
(
)
;
await
requestFinished
(
request
)
;
}
}
