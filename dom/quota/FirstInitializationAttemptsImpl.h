#
ifndef
DOM_QUOTA_FIRSTINITIALIZATIONATTEMPTSIMPL_H_
#
define
DOM_QUOTA_FIRSTINITIALIZATIONATTEMPTSIMPL_H_
#
include
"
FirstInitializationAttempts
.
h
"
#
include
"
mozilla
/
Assertions
.
h
"
#
include
"
mozilla
/
TelemetryHistogramEnums
.
h
"
#
include
"
mozilla
/
glean
/
DomQuotaMetrics
.
h
"
#
include
"
nsError
.
h
"
namespace
mozilla
:
:
dom
:
:
quota
{
template
<
typename
Initialization
typename
StringGenerator
>
void
FirstInitializationAttempts
<
Initialization
StringGenerator
>
:
:
RecordFirstInitializationAttempt
(
const
Initialization
aInitialization
const
nsresult
aRv
)
{
MOZ_ASSERT
(
!
FirstInitializationAttemptRecorded
(
aInitialization
)
)
;
mFirstInitializationAttempts
|
=
aInitialization
;
if
constexpr
(
!
std
:
:
is_same_v
<
StringGenerator
Nothing
>
)
{
glean
:
:
dom_quota
:
:
first_initialization_attempt
.
Get
(
StringGenerator
:
:
GetString
(
aInitialization
)
NS_SUCCEEDED
(
aRv
)
?
"
true
"
_ns
:
"
false
"
_ns
)
.
Add
(
)
;
}
}
}
#
endif
