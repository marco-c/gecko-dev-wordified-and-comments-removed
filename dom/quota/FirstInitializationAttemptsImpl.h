#
ifndef
DOM_QUOTA_FIRSTINITIALIZATIONATTEMPTSIMPL_H_
#
define
DOM_QUOTA_FIRSTINITIALIZATIONATTEMPTSIMPL_H_
#
include
"
FirstInitializationAttempts
.
h
"
#
include
"
mozilla
/
Assertions
.
h
"
#
include
"
mozilla
/
Telemetry
.
h
"
#
include
"
mozilla
/
TelemetryHistogramEnums
.
h
"
#
include
"
nsError
.
h
"
namespace
mozilla
:
:
dom
:
:
quota
{
template
<
typename
Initialization
typename
StringGenerator
>
void
FirstInitializationAttempts
<
Initialization
StringGenerator
>
:
:
RecordFirstInitializationAttempt
(
const
Initialization
aInitialization
const
nsresult
aRv
)
{
MOZ_ASSERT
(
FirstInitializationAttemptPending
(
aInitialization
)
)
;
mFirstInitializationAttempts
|
=
aInitialization
;
if
constexpr
(
!
std
:
:
is_same_v
<
StringGenerator
Nothing
>
)
{
Telemetry
:
:
Accumulate
(
Telemetry
:
:
QM_FIRST_INITIALIZATION_ATTEMPT
StringGenerator
:
:
GetString
(
aInitialization
)
static_cast
<
uint32_t
>
(
NS_SUCCEEDED
(
aRv
)
)
)
;
}
}
}
#
endif
