#
include
"
mozilla
/
dom
/
cache
/
ActorChild
.
h
"
#
include
"
mozilla
/
dom
/
cache
/
CacheWorkerRef
.
h
"
#
include
"
nsThreadUtils
.
h
"
namespace
mozilla
:
:
dom
:
:
cache
{
void
ActorChild
:
:
SetWorkerRef
(
SafeRefPtr
<
CacheWorkerRef
>
aWorkerRef
)
{
if
(
mWorkerRef
)
{
MOZ_DIAGNOSTIC_ASSERT
(
mWorkerRef
=
=
aWorkerRef
)
;
return
;
}
mWorkerRef
=
std
:
:
move
(
aWorkerRef
)
;
if
(
mWorkerRef
)
{
mWorkerRef
-
>
AddActor
(
this
)
;
}
}
void
ActorChild
:
:
RemoveWorkerRef
(
)
{
MOZ_ASSERT_IF
(
!
NS_IsMainThread
(
)
mWorkerRef
)
;
if
(
mWorkerRef
)
{
mWorkerRef
-
>
RemoveActor
(
this
)
;
mWorkerRef
=
nullptr
;
}
}
const
SafeRefPtr
<
CacheWorkerRef
>
&
ActorChild
:
:
GetWorkerRefPtr
(
)
const
{
return
mWorkerRef
;
}
bool
ActorChild
:
:
WorkerRefNotified
(
)
const
{
return
mWorkerRef
&
&
mWorkerRef
-
>
Notified
(
)
;
}
ActorChild
:
:
ActorChild
(
)
=
default
;
ActorChild
:
:
~
ActorChild
(
)
{
MOZ_DIAGNOSTIC_ASSERT
(
!
mWorkerRef
)
;
}
}
