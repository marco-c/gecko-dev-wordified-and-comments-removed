#
ifndef
include_dom_media_ipc_RemoteMediaDataDecoder_h
#
define
include_dom_media_ipc_RemoteMediaDataDecoder_h
#
include
"
PlatformDecoderModule
.
h
"
#
include
"
MediaData
.
h
"
namespace
mozilla
{
class
GpuDecoderModule
;
class
IRemoteDecoderChild
;
class
RemoteDecoderModule
;
class
RemoteMediaDataDecoder
;
DDLoggedTypeCustomNameAndBase
(
RemoteMediaDataDecoder
RemoteMediaDataDecoder
MediaDataDecoder
)
;
class
RemoteMediaDataDecoder
:
public
MediaDataDecoder
public
DecoderDoctorLifeLogger
<
RemoteMediaDataDecoder
>
{
public
:
friend
class
GpuDecoderModule
;
friend
class
RemoteDecoderModule
;
RefPtr
<
InitPromise
>
Init
(
)
override
;
RefPtr
<
DecodePromise
>
Decode
(
MediaRawData
*
aSample
)
override
;
bool
CanDecodeBatch
(
)
override
{
return
true
;
}
RefPtr
<
DecodePromise
>
DecodeBatch
(
nsTArray
<
RefPtr
<
MediaRawData
>
>
&
&
aSamples
)
override
;
RefPtr
<
DecodePromise
>
Drain
(
)
override
;
RefPtr
<
FlushPromise
>
Flush
(
)
override
;
RefPtr
<
ShutdownPromise
>
Shutdown
(
)
override
;
bool
IsHardwareAccelerated
(
nsACString
&
aFailureReason
)
const
override
;
void
SetSeekThreshold
(
const
media
:
:
TimeUnit
&
aTime
)
override
;
nsCString
GetDescriptionName
(
)
const
override
;
ConversionRequired
NeedsConversion
(
)
const
override
;
private
:
explicit
RemoteMediaDataDecoder
(
IRemoteDecoderChild
*
aChild
)
;
~
RemoteMediaDataDecoder
(
)
;
RefPtr
<
IRemoteDecoderChild
>
mChild
;
nsCString
mDescription
=
NS_LITERAL_CSTRING
(
"
RemoteMediaDataDecoder
"
)
;
bool
mIsHardwareAccelerated
=
false
;
nsCString
mHardwareAcceleratedReason
;
ConversionRequired
mConversion
=
ConversionRequired
:
:
kNeedNone
;
}
;
}
#
endif
