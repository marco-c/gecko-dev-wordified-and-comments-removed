#
include
"
DDLogMessage
.
h
"
#
include
"
DDLifetimes
.
h
"
namespace
mozilla
{
nsCString
DDLogMessage
:
:
Print
(
)
const
{
nsCString
str
;
str
.
AppendPrintf
(
"
%
"
PRImi
"
|
%
f
|
%
s
[
%
p
]
|
%
s
|
%
s
|
"
mIndex
.
Value
(
)
ToSeconds
(
mTimeStamp
)
mObject
.
TypeName
(
)
mObject
.
Pointer
(
)
ToShortString
(
mClass
)
mLabel
)
;
AppendToString
(
mValue
str
)
;
return
str
;
}
nsCString
DDLogMessage
:
:
Print
(
const
DDLifetimes
&
aLifetimes
)
const
{
nsCString
str
;
const
DDLifetime
*
lifetime
=
aLifetimes
.
FindLifetime
(
mObject
mIndex
)
;
str
.
AppendPrintf
(
"
%
"
PRImi
"
|
%
f
|
"
mIndex
.
Value
(
)
ToSeconds
(
mTimeStamp
)
)
;
lifetime
-
>
AppendPrintf
(
str
)
;
str
.
AppendPrintf
(
"
|
%
s
|
%
s
|
"
ToShortString
(
mClass
)
mLabel
)
;
if
(
!
mValue
.
is
<
DDLogObject
>
(
)
)
{
AppendToString
(
mValue
str
)
;
}
else
{
const
DDLifetime
*
lifetime2
=
aLifetimes
.
FindLifetime
(
mValue
.
as
<
DDLogObject
>
(
)
mIndex
)
;
if
(
lifetime2
)
{
lifetime2
-
>
AppendPrintf
(
str
)
;
}
else
{
AppendToString
(
mValue
str
)
;
}
}
return
str
;
}
}
