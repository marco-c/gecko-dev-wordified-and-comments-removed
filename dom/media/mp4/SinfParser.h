#
ifndef
SINF_PARSER_H_
#
define
SINF_PARSER_H_
#
include
"
Atom
.
h
"
#
include
"
AtomType
.
h
"
#
include
"
nsTArray
.
h
"
namespace
mozilla
{
class
Box
;
class
Sinf
:
public
Atom
{
public
:
Sinf
(
)
:
mDefaultIVSize
(
0
)
mDefaultCryptByteBlock
(
0
)
mDefaultSkipByteBlock
(
0
)
{
}
explicit
Sinf
(
const
Box
&
aBox
)
;
bool
IsValid
(
)
const
override
{
return
!
!
mDefaultEncryptionType
&
&
(
mDefaultIVSize
>
0
|
|
mDefaultConstantIV
.
Length
(
)
>
0
)
;
}
uint8_t
mDefaultIVSize
;
AtomType
mDefaultEncryptionType
;
uint8_t
mDefaultKeyID
[
16
]
;
uint8_t
mDefaultCryptByteBlock
;
uint8_t
mDefaultSkipByteBlock
;
CopyableTArray
<
uint8_t
>
mDefaultConstantIV
;
}
;
class
SinfParser
{
public
:
explicit
SinfParser
(
const
Box
&
aBox
)
;
Sinf
&
GetSinf
(
)
{
return
mSinf
;
}
private
:
Result
<
Ok
nsresult
>
ParseSchm
(
const
Box
&
aBox
)
;
Result
<
Ok
nsresult
>
ParseSchi
(
const
Box
&
aBox
)
;
Result
<
Ok
nsresult
>
ParseTenc
(
const
Box
&
aBox
)
;
Sinf
mSinf
;
}
;
}
#
endif
