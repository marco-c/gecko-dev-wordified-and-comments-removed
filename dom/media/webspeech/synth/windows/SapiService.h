#
ifndef
mozilla_dom_SapiService_h
#
define
mozilla_dom_SapiService_h
#
include
<
windows
.
h
>
#
include
<
sapi
.
h
>
#
include
"
mozilla
/
StaticPtr
.
h
"
#
include
"
nsIObserver
.
h
"
#
include
"
nsISpeechService
.
h
"
#
include
"
nsRefPtrHashtable
.
h
"
#
include
"
nsTArray
.
h
"
class
nsISynthVoiceRegistry
;
namespace
mozilla
:
:
dom
{
class
SapiCallback
;
class
SapiService
final
:
public
nsISpeechService
public
nsIObserver
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSISPEECHSERVICE
NS_DECL_NSIOBSERVER
SapiService
(
)
;
bool
Init
(
)
;
static
SapiService
*
GetInstance
(
)
;
static
already_AddRefed
<
SapiService
>
GetInstanceForService
(
)
;
static
void
__stdcall
SpeechEventCallback
(
WPARAM
aWParam
LPARAM
aLParam
)
;
private
:
virtual
~
SapiService
(
)
;
already_AddRefed
<
ISpVoice
>
InitSapiInstance
(
)
;
bool
RegisterVoices
(
)
;
bool
RegisterVoices
(
nsCOMPtr
<
nsISynthVoiceRegistry
>
&
registry
const
WCHAR
*
categoryId
)
;
nsRefPtrHashtable
<
nsStringHashKey
ISpObjectToken
>
mVoices
;
nsTArray
<
RefPtr
<
SapiCallback
>
>
mCallbacks
;
bool
mInitialized
;
static
StaticRefPtr
<
SapiService
>
sSingleton
;
}
;
}
#
endif
