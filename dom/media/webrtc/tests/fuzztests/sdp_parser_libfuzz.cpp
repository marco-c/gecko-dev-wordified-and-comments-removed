#
include
<
string
>
#
include
"
gtest
/
gtest
.
h
"
#
include
"
FuzzingInterface
.
h
"
#
include
"
sdp
/
SipccSdpParser
.
h
"
using
namespace
mozilla
;
MOZ_RUNINIT
static
mozilla
:
:
UniquePtr
<
SdpParser
:
:
Results
>
sdpPtr
;
MOZ_RUNINIT
static
SipccSdpParser
mParser
;
int
FuzzingInitSdpParser
(
int
*
argc
char
*
*
*
argv
)
{
return
0
;
}
static
int
RunSdpParserFuzzing
(
const
uint8_t
*
data
size_t
size
)
{
std
:
:
string
message
(
reinterpret_cast
<
const
char
*
>
(
data
)
size
)
;
sdpPtr
=
mParser
.
Parse
(
message
)
;
return
0
;
}
MOZ_FUZZING_INTERFACE_RAW
(
FuzzingInitSdpParser
RunSdpParserFuzzing
SdpParser
)
;
