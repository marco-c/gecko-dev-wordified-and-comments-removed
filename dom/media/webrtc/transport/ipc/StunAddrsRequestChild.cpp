#
include
"
StunAddrsRequestChild
.
h
"
#
include
"
mozilla
/
net
/
NeckoChild
.
h
"
#
include
"
nsISerialEventTarget
.
h
"
using
namespace
mozilla
:
:
ipc
;
namespace
mozilla
{
namespace
net
{
StunAddrsRequestChild
:
:
StunAddrsRequestChild
(
StunAddrsListener
*
listener
nsISerialEventTarget
*
mainThreadEventTarget
)
:
mListener
(
listener
)
{
if
(
mainThreadEventTarget
)
{
gNeckoChild
-
>
SetEventTargetForActor
(
this
mainThreadEventTarget
)
;
}
gNeckoChild
-
>
SendPStunAddrsRequestConstructor
(
this
)
;
AddIPDLReference
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
StunAddrsRequestChild
:
:
RecvOnMDNSQueryComplete
(
const
nsCString
&
hostname
const
Maybe
<
nsCString
>
&
address
)
{
if
(
mListener
)
{
mListener
-
>
OnMDNSQueryComplete
(
hostname
address
)
;
}
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
StunAddrsRequestChild
:
:
RecvOnStunAddrsAvailable
(
const
NrIceStunAddrArray
&
addrs
)
{
if
(
mListener
)
{
mListener
-
>
OnStunAddrsAvailable
(
addrs
)
;
}
return
IPC_OK
(
)
;
}
void
StunAddrsRequestChild
:
:
Cancel
(
)
{
mListener
=
nullptr
;
}
NS_IMPL_ADDREF
(
StunAddrsRequestChild
)
NS_IMPL_RELEASE
(
StunAddrsRequestChild
)
NS_IMPL_ADDREF
(
StunAddrsListener
)
NS_IMPL_RELEASE
(
StunAddrsListener
)
}
}
