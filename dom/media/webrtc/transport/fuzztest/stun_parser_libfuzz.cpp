#
include
<
string
>
#
include
"
FuzzingInterface
.
h
"
#
include
"
gtest
/
gtest
.
h
"
extern
"
C
"
{
#
include
<
csi_platform
.
h
>
#
include
"
stun_codec
.
h
"
#
include
"
stun_msg
.
h
"
}
int
FuzzingInitStunParser
(
int
*
argc
char
*
*
*
argv
)
{
return
0
;
}
static
int
RunStunParserFuzzing
(
const
uint8_t
*
data
size_t
size
)
{
nr_stun_message
*
req
=
0
;
UCHAR
*
mes
=
(
UCHAR
*
)
data
;
if
(
!
nr_stun_message_create2
(
&
req
mes
size
)
)
{
nr_stun_decode_message
(
req
nullptr
nullptr
)
;
nr_stun_message_destroy
(
&
req
)
;
}
return
0
;
}
MOZ_FUZZING_INTERFACE_RAW
(
FuzzingInitStunParser
RunStunParserFuzzing
StunParser
)
;
