#
ifndef
WIN32
#
include
<
sys
/
uio
.
h
>
#
include
<
pwd
.
h
>
#
include
<
dirent
.
h
>
#
endif
#
include
<
string
.
h
>
#
include
<
errno
.
h
>
#
include
<
ctype
.
h
>
#
include
<
sys
/
stat
.
h
>
#
ifdef
OPENSSL
#
include
<
openssl
/
evp
.
h
>
#
endif
#
include
<
csi_platform
.
h
>
#
include
"
r_common
.
h
"
#
include
"
registry
.
h
"
#
include
"
util
.
h
"
#
include
"
r_log
.
h
"
int
nr_util_default_log_facility
=
LOG_COMMON
;
int
nr_bin2hex
(
UCHAR
*
in
int
len
UCHAR
*
out
)
{
while
(
len
)
{
sprintf
(
(
char
*
)
out
"
%
.
2x
"
in
[
0
]
&
0xff
)
;
in
+
=
1
;
out
+
=
2
;
len
-
-
;
}
return
(
0
)
;
}
#
if
defined
(
LINUX
)
|
|
defined
(
WIN32
)
size_t
strlcat
(
char
*
dst
const
char
*
src
size_t
siz
)
{
char
*
d
=
dst
;
const
char
*
s
=
src
;
size_t
n
=
siz
;
size_t
dlen
;
while
(
n
-
-
!
=
0
&
&
*
d
!
=
'
\
0
'
)
d
+
+
;
dlen
=
d
-
dst
;
n
=
siz
-
dlen
;
if
(
n
=
=
0
)
return
(
dlen
+
strlen
(
s
)
)
;
while
(
*
s
!
=
'
\
0
'
)
{
if
(
n
!
=
1
)
{
*
d
+
+
=
*
s
;
n
-
-
;
}
s
+
+
;
}
*
d
=
'
\
0
'
;
return
(
dlen
+
(
s
-
src
)
)
;
}
#
endif
#
ifdef
WIN32
#
include
<
time
.
h
>
int
gettimeofday
(
struct
timeval
*
tv
void
*
tz
)
{
SYSTEMTIME
st
;
FILETIME
ft
;
ULARGE_INTEGER
u
;
GetLocalTime
(
&
st
)
;
SystemTimeToFileTime
(
&
st
&
ft
)
;
u
.
HighPart
=
ft
.
dwHighDateTime
;
u
.
LowPart
=
ft
.
dwLowDateTime
;
tv
-
>
tv_sec
=
(
long
)
(
u
.
QuadPart
/
10000000L
)
;
tv
-
>
tv_usec
=
(
long
)
(
st
.
wMilliseconds
*
1000
)
;
;
return
0
;
}
#
endif
