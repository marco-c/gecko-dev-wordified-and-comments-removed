#
ifndef
MOZILLA_TRACKUNIONSTREAM_H_
#
define
MOZILLA_TRACKUNIONSTREAM_H_
#
include
"
MediaStreamGraph
.
h
"
#
include
"
nsAutoPtr
.
h
"
#
include
<
algorithm
>
namespace
mozilla
{
class
TrackUnionStream
:
public
ProcessedMediaStream
{
public
:
TrackUnionStream
(
TrackRate
aSampleRate
MediaSegment
:
:
Type
aType
)
;
virtual
TrackUnionStream
*
AsTrackUnionStream
(
)
override
{
return
this
;
}
friend
class
DOMMediaStream
;
void
AddInput
(
MediaInputPort
*
aPort
)
override
;
void
RemoveInput
(
MediaInputPort
*
aPort
)
override
;
void
ProcessInput
(
GraphTime
aFrom
GraphTime
aTo
uint32_t
aFlags
)
override
;
void
SetEnabledImpl
(
DisabledTrackMode
aMode
)
override
;
friend
class
MediaStreamGraphImpl
;
protected
:
void
SetInput
(
MediaInputPort
*
aPort
)
;
void
ProcessInputImpl
(
MediaStream
*
aSource
MediaSegment
*
aSegment
GraphTime
aFrom
GraphTime
aTo
uint32_t
aFlags
)
;
void
AddDirectListenerImpl
(
already_AddRefed
<
DirectMediaStreamTrackListener
>
aListener
)
override
;
void
RemoveDirectListenerImpl
(
DirectMediaStreamTrackListener
*
aListener
)
override
;
void
RemoveAllDirectListenersImpl
(
)
override
;
nsTArray
<
RefPtr
<
DirectMediaStreamTrackListener
>
>
mOwnedDirectListeners
;
MediaInputPort
*
mInputPort
=
nullptr
;
}
;
}
#
endif
