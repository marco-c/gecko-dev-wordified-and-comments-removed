#
include
"
DirectShowDecoder
.
h
"
#
include
"
DirectShowReader
.
h
"
#
include
"
DirectShowUtils
.
h
"
#
include
"
MediaContentType
.
h
"
#
include
"
MediaDecoderStateMachine
.
h
"
#
include
"
mozilla
/
Preferences
.
h
"
#
include
"
mozilla
/
WindowsVersion
.
h
"
namespace
mozilla
{
MediaDecoderStateMachine
*
DirectShowDecoder
:
:
CreateStateMachine
(
)
{
return
new
MediaDecoderStateMachine
(
this
new
DirectShowReader
(
this
)
)
;
}
bool
DirectShowDecoder
:
:
GetSupportedCodecs
(
const
MediaContentType
&
aType
char
const
*
const
*
*
aCodecList
)
{
if
(
!
IsEnabled
(
)
)
{
return
false
;
}
static
char
const
*
const
mp3AudioCodecs
[
]
=
{
"
mp3
"
nullptr
}
;
if
(
aType
.
Type
(
)
=
=
MEDIAMIMETYPE
(
"
audio
/
mpeg
"
)
|
|
aType
.
Type
(
)
=
=
MEDIAMIMETYPE
(
"
audio
/
mp3
"
)
)
{
if
(
aCodecList
)
{
*
aCodecList
=
mp3AudioCodecs
;
}
return
true
;
}
return
false
;
}
bool
DirectShowDecoder
:
:
IsEnabled
(
)
{
return
CanDecodeMP3UsingDirectShow
(
)
&
&
Preferences
:
:
GetBool
(
"
media
.
directshow
.
enabled
"
)
;
}
DirectShowDecoder
:
:
DirectShowDecoder
(
MediaDecoderOwner
*
aOwner
)
:
MediaDecoder
(
aOwner
)
{
}
DirectShowDecoder
:
:
~
DirectShowDecoder
(
)
=
default
;
}
