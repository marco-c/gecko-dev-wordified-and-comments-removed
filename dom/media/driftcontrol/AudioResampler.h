#
ifndef
DOM_MEDIA_DRIFTCONTROL_AUDIORESAMPLER_H_
#
define
DOM_MEDIA_DRIFTCONTROL_AUDIORESAMPLER_H_
#
include
"
AudioChunkList
.
h
"
#
include
"
AudioSegment
.
h
"
#
include
"
DynamicResampler
.
h
"
#
include
"
TimeUnits
.
h
"
namespace
mozilla
{
class
AudioResampler
final
{
public
:
AudioResampler
(
uint32_t
aInRate
uint32_t
aOutRate
media
:
:
TimeUnit
aPreBufferDuration
const
PrincipalHandle
&
aPrincipalHandle
)
;
void
AppendInput
(
const
AudioSegment
&
aInSegment
)
;
uint32_t
InputCapacityFrames
(
)
const
;
uint32_t
InputReadableFrames
(
)
const
;
AudioSegment
Resample
(
uint32_t
aOutFrames
bool
*
aHasUnderrun
)
;
void
UpdateOutRate
(
uint32_t
aOutRate
)
{
Update
(
aOutRate
mResampler
.
GetChannels
(
)
)
;
}
void
SetPreBufferDuration
(
media
:
:
TimeUnit
aPreBufferDuration
)
{
mResampler
.
SetPreBufferDuration
(
aPreBufferDuration
)
;
}
private
:
void
UpdateChannels
(
uint32_t
aChannels
)
{
Update
(
mResampler
.
GetOutRate
(
)
aChannels
)
;
}
void
Update
(
uint32_t
aOutRate
uint32_t
aChannels
)
;
private
:
DynamicResampler
mResampler
;
AudioChunkList
mOutputChunks
;
bool
mIsSampleFormatSet
=
false
;
}
;
}
#
endif
