#
ifndef
ChromiumCDMVideoDecoder_h_
#
define
ChromiumCDMVideoDecoder_h_
#
include
"
ChromiumCDMParent
.
h
"
#
include
"
PlatformDecoderModule
.
h
"
#
include
"
mozilla
/
layers
/
KnowsCompositor
.
h
"
namespace
mozilla
{
class
CDMProxy
;
struct
GMPVideoDecoderParams
;
DDLoggedTypeDeclNameAndBase
(
ChromiumCDMVideoDecoder
MediaDataDecoder
)
;
class
ChromiumCDMVideoDecoder
:
public
MediaDataDecoder
public
DecoderDoctorLifeLogger
<
ChromiumCDMVideoDecoder
>
{
public
:
ChromiumCDMVideoDecoder
(
const
GMPVideoDecoderParams
&
aParams
CDMProxy
*
aCDMProxy
)
;
RefPtr
<
InitPromise
>
Init
(
)
override
;
RefPtr
<
DecodePromise
>
Decode
(
MediaRawData
*
aSample
)
override
;
RefPtr
<
FlushPromise
>
Flush
(
)
override
;
RefPtr
<
DecodePromise
>
Drain
(
)
override
;
RefPtr
<
ShutdownPromise
>
Shutdown
(
)
override
;
nsCString
GetDescriptionName
(
)
const
override
;
nsCString
GetCodecName
(
)
const
override
;
ConversionRequired
NeedsConversion
(
)
const
override
;
private
:
~
ChromiumCDMVideoDecoder
(
)
;
RefPtr
<
gmp
:
:
ChromiumCDMParent
>
mCDMParent
;
const
VideoInfo
mConfig
;
RefPtr
<
GMPCrashHelper
>
mCrashHelper
;
nsCOMPtr
<
nsISerialEventTarget
>
mGMPThread
;
RefPtr
<
layers
:
:
ImageContainer
>
mImageContainer
;
RefPtr
<
layers
:
:
KnowsCompositor
>
mKnowsCompositor
;
MozPromiseHolder
<
InitPromise
>
mInitPromise
;
bool
mConvertToAnnexB
=
false
;
}
;
}
#
endif
