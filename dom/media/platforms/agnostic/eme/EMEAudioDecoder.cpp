#
include
"
EMEAudioDecoder
.
h
"
#
include
"
mozilla
/
CDMProxy
.
h
"
namespace
mozilla
{
void
EMEAudioCallbackAdapter
:
:
Error
(
GMPErr
aErr
)
{
if
(
aErr
=
=
GMPNoKeyErr
)
{
NS_WARNING
(
"
GMP
failed
to
decrypt
due
to
lack
of
key
"
)
;
return
;
}
AudioCallbackAdapter
:
:
Error
(
aErr
)
;
}
EMEAudioDecoder
:
:
EMEAudioDecoder
(
CDMProxy
*
aProxy
const
GMPAudioDecoderParams
&
aParams
)
:
GMPAudioDecoder
(
GMPAudioDecoderParams
(
aParams
)
.
WithAdapter
(
new
EMEAudioCallbackAdapter
(
aParams
.
mCallback
)
)
)
mProxy
(
aProxy
)
{
}
void
EMEAudioDecoder
:
:
InitTags
(
nsTArray
<
nsCString
>
&
aTags
)
{
aTags
.
AppendElement
(
NS_LITERAL_CSTRING
(
"
aac
"
)
)
;
aTags
.
AppendElement
(
NS_ConvertUTF16toUTF8
(
mProxy
-
>
KeySystem
(
)
)
)
;
}
nsCString
EMEAudioDecoder
:
:
GetNodeId
(
)
{
return
mProxy
-
>
GetNodeId
(
)
;
}
}
