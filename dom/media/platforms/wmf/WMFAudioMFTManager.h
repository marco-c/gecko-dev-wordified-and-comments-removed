#
if
!
defined
(
WMFAudioOutputSource_h_
)
#
define
WMFAudioOutputSource_h_
#
include
"
MFTDecoder
.
h
"
#
include
"
WMF
.
h
"
#
include
"
WMFMediaDataDecoder
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
namespace
mozilla
{
class
WMFAudioMFTManager
:
public
MFTManager
{
public
:
explicit
WMFAudioMFTManager
(
const
AudioInfo
&
aConfig
)
;
~
WMFAudioMFTManager
(
)
;
bool
Init
(
)
;
HRESULT
Input
(
MediaRawData
*
aSample
)
override
;
HRESULT
Output
(
int64_t
aStreamOffset
RefPtr
<
MediaData
>
&
aOutput
)
override
;
void
Shutdown
(
)
override
;
TrackInfo
:
:
TrackType
GetType
(
)
override
{
return
TrackInfo
:
:
kAudioTrack
;
}
nsCString
GetDescriptionName
(
)
const
override
{
return
NS_LITERAL_CSTRING
(
"
wmf
audio
decoder
"
)
;
}
private
:
HRESULT
UpdateOutputType
(
)
;
uint32_t
mAudioChannels
;
uint32_t
mAudioRate
;
nsTArray
<
BYTE
>
mUserData
;
media
:
:
TimeUnit
mAudioTimeOffset
;
int64_t
mAudioFrameSum
=
0
;
enum
StreamType
{
Unknown
AAC
MP3
}
;
StreamType
mStreamType
;
const
GUID
&
GetMFTGUID
(
)
;
const
GUID
&
GetMediaSubtypeGUID
(
)
;
bool
mMustRecaptureAudioPosition
=
true
;
}
;
}
#
endif
