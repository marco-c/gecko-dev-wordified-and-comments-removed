#
include
"
OmxDecoderModule
.
h
"
#
include
"
OmxDataDecoder
.
h
"
#
include
"
OmxPlatformLayer
.
h
"
#
ifdef
MOZ_OMX
#
include
"
PureOmxPlatformLayer
.
h
"
#
endif
namespace
mozilla
{
bool
OmxDecoderModule
:
:
Init
(
)
{
#
ifdef
MOZ_OMX
return
PureOmxPlatformLayer
:
:
Init
(
)
;
#
endif
return
false
;
}
OmxDecoderModule
*
OmxDecoderModule
:
:
Create
(
)
{
#
ifdef
MOZ_OMX
if
(
Init
(
)
)
{
return
new
OmxDecoderModule
(
)
;
}
#
endif
return
nullptr
;
}
already_AddRefed
<
MediaDataDecoder
>
OmxDecoderModule
:
:
CreateVideoDecoder
(
const
CreateDecoderParams
&
aParams
)
{
RefPtr
<
OmxDataDecoder
>
decoder
=
new
OmxDataDecoder
(
aParams
.
mConfig
aParams
.
mImageContainer
)
;
return
decoder
.
forget
(
)
;
}
already_AddRefed
<
MediaDataDecoder
>
OmxDecoderModule
:
:
CreateAudioDecoder
(
const
CreateDecoderParams
&
aParams
)
{
RefPtr
<
OmxDataDecoder
>
decoder
=
new
OmxDataDecoder
(
aParams
.
mConfig
nullptr
)
;
return
decoder
.
forget
(
)
;
}
media
:
:
DecodeSupportSet
OmxDecoderModule
:
:
SupportsMimeType
(
const
nsACString
&
aMimeType
DecoderDoctorDiagnostics
*
aDiagnostics
)
const
{
if
(
OmxPlatformLayer
:
:
SupportsMimeType
(
aMimeType
)
)
{
return
media
:
:
DecodeSupport
:
:
SoftwareDecode
;
}
return
media
:
:
DecodeSupport
:
:
Unsupported
;
}
}
