#
ifndef
DecoderDoctorDiagnostics_h_
#
define
DecoderDoctorDiagnostics_h_
#
include
"
nsString
.
h
"
class
nsIDocument
;
namespace
mozilla
{
struct
DecoderDoctorEvent
{
enum
Domain
{
}
mDomain
;
nsresult
mResult
;
}
;
class
DecoderDoctorDiagnostics
{
public
:
void
StoreFormatDiagnostics
(
nsIDocument
*
aDocument
const
nsAString
&
aFormat
bool
aCanPlay
const
char
*
aCallSite
)
;
void
StoreMediaKeySystemAccess
(
nsIDocument
*
aDocument
const
nsAString
&
aKeySystem
bool
aIsSupported
const
char
*
aCallSite
)
;
void
StoreEvent
(
nsIDocument
*
aDocument
const
DecoderDoctorEvent
&
aEvent
const
char
*
aCallSite
)
;
enum
DiagnosticsType
{
eUnsaved
eFormatSupportCheck
eMediaKeySystemAccessRequest
eEvent
}
;
DiagnosticsType
Type
(
)
const
{
return
mDiagnosticsType
;
}
nsCString
GetDescription
(
)
const
;
const
nsAString
&
Format
(
)
const
{
return
mFormat
;
}
bool
CanPlay
(
)
const
{
return
mCanPlay
;
}
void
SetWMFFailedToLoad
(
)
{
mWMFFailedToLoad
=
true
;
}
bool
DidWMFFailToLoad
(
)
const
{
return
mWMFFailedToLoad
;
}
void
SetFFmpegFailedToLoad
(
)
{
mFFmpegFailedToLoad
=
true
;
}
bool
DidFFmpegFailToLoad
(
)
const
{
return
mFFmpegFailedToLoad
;
}
void
SetGMPPDMFailedToStartup
(
)
{
mGMPPDMFailedToStartup
=
true
;
}
bool
DidGMPPDMFailToStartup
(
)
const
{
return
mGMPPDMFailedToStartup
;
}
void
SetVideoFormatNotSupport
(
)
{
mVideoNotSupported
=
true
;
}
void
SetAudioFormatNotSupport
(
)
{
mAudioNotSupported
=
true
;
}
void
SetGMP
(
const
nsACString
&
aGMP
)
{
mGMP
=
aGMP
;
}
const
nsACString
&
GMP
(
)
const
{
return
mGMP
;
}
const
nsAString
&
KeySystem
(
)
const
{
return
mKeySystem
;
}
bool
IsKeySystemSupported
(
)
const
{
return
mIsKeySystemSupported
;
}
enum
KeySystemIssue
{
eUnset
eWidevineWithNoWMF
}
;
void
SetKeySystemIssue
(
KeySystemIssue
aKeySystemIssue
)
{
mKeySystemIssue
=
aKeySystemIssue
;
}
KeySystemIssue
GetKeySystemIssue
(
)
const
{
return
mKeySystemIssue
;
}
DecoderDoctorEvent
event
(
)
const
{
return
mEvent
;
}
private
:
DiagnosticsType
mDiagnosticsType
=
eUnsaved
;
nsString
mFormat
;
bool
mCanPlay
=
false
;
bool
mWMFFailedToLoad
=
false
;
bool
mFFmpegFailedToLoad
=
false
;
bool
mGMPPDMFailedToStartup
=
false
;
bool
mVideoNotSupported
=
false
;
bool
mAudioNotSupported
=
false
;
nsCString
mGMP
;
nsString
mKeySystem
;
bool
mIsKeySystemSupported
=
false
;
KeySystemIssue
mKeySystemIssue
=
eUnset
;
DecoderDoctorEvent
mEvent
;
}
;
}
#
endif
