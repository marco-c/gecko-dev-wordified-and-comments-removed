#
ifndef
mozilla_MediaTaskUtils_h
#
define
mozilla_MediaTaskUtils_h
#
include
"
nsThreadUtils
.
h
"
#
include
"
base
/
task
.
h
"
namespace
mozilla
{
namespace
media
{
template
<
typename
OnRunType
>
class
LambdaTask
:
public
Runnable
{
public
:
explicit
LambdaTask
(
OnRunType
&
&
aOnRun
)
:
Runnable
(
"
media
:
:
LambdaTask
"
)
mOnRun
(
std
:
:
move
(
aOnRun
)
)
{
}
private
:
NS_IMETHOD
Run
(
)
override
{
mOnRun
(
)
;
return
NS_OK
;
}
OnRunType
mOnRun
;
}
;
template
<
typename
OnRunType
>
already_AddRefed
<
LambdaTask
<
OnRunType
>
>
NewTaskFrom
(
OnRunType
&
&
aOnRun
)
{
typedef
LambdaTask
<
OnRunType
>
LambdaType
;
RefPtr
<
LambdaType
>
lambda
=
new
LambdaType
(
std
:
:
forward
<
OnRunType
>
(
aOnRun
)
)
;
return
lambda
.
forget
(
)
;
}
}
}
#
endif
