#
ifndef
DOM_MEDIA_MEDIACONTROL_MEDIACONTROLLER_H_
#
define
DOM_MEDIA_MEDIACONTROL_MEDIACONTROLLER_H_
#
include
"
nsDataHashtable
.
h
"
#
include
"
nsISupportsImpl
.
h
"
namespace
mozilla
{
namespace
dom
{
class
BrowsingContext
;
enum
class
MediaControlActions
:
uint32_t
{
ePlay
ePause
eStop
eActionsNum
}
;
class
MediaController
{
public
:
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
MediaController
)
;
explicit
MediaController
(
uint64_t
aContextId
)
:
mBrowsingContextId
(
aContextId
)
{
}
virtual
void
Play
(
)
=
0
;
virtual
void
Pause
(
)
=
0
;
virtual
void
Stop
(
)
=
0
;
virtual
void
Shutdown
(
)
=
0
;
virtual
void
NotifyMediaActiveChanged
(
bool
aActive
)
=
0
;
virtual
void
NotifyMediaAudibleChanged
(
bool
aAudible
)
=
0
;
bool
IsPlaying
(
)
const
{
return
mIsPlaying
;
}
uint64_t
Id
(
)
const
{
return
mBrowsingContextId
;
}
virtual
uint64_t
ControlledMediaNum
(
)
const
{
return
0
;
}
virtual
bool
IsAudible
(
)
const
{
return
false
;
}
protected
:
virtual
~
MediaController
(
)
=
default
;
already_AddRefed
<
BrowsingContext
>
GetContext
(
)
const
;
uint64_t
mBrowsingContextId
;
bool
mIsPlaying
=
false
;
}
;
class
TabMediaController
final
:
public
MediaController
{
public
:
explicit
TabMediaController
(
uint64_t
aContextId
)
;
void
Play
(
)
override
;
void
Pause
(
)
override
;
void
Stop
(
)
override
;
void
Shutdown
(
)
override
;
uint64_t
ControlledMediaNum
(
)
const
override
;
bool
IsAudible
(
)
const
override
;
void
NotifyMediaActiveChanged
(
bool
aActive
)
override
;
void
NotifyMediaAudibleChanged
(
bool
aAudible
)
override
;
protected
:
~
TabMediaController
(
)
;
private
:
void
IncreaseControlledMediaNum
(
)
;
void
DecreaseControlledMediaNum
(
)
;
void
Activate
(
)
;
void
Deactivate
(
)
;
int64_t
mControlledMediaNum
=
0
;
bool
mAudible
=
false
;
}
;
}
}
#
endif
