#
ifndef
DOM_MEDIA_MEDIACONTROL_MEDIACONTROLKEYMANAGER_H_
#
define
DOM_MEDIA_MEDIACONTROL_MEDIACONTROLKEYMANAGER_H_
#
include
"
MediaControlKeySource
.
h
"
#
include
"
MediaEventSource
.
h
"
#
include
"
nsIObserver
.
h
"
namespace
mozilla
{
namespace
dom
{
class
MediaControlKeyManager
final
:
public
MediaControlKeySource
public
MediaControlKeyListener
{
public
:
NS_INLINE_DECL_REFCOUNTING
(
MediaControlKeyManager
override
)
MediaControlKeyManager
(
)
;
bool
Open
(
)
override
;
bool
IsOpened
(
)
const
override
;
void
SetControlledTabBrowsingContextId
(
Maybe
<
uint64_t
>
aTopLevelBrowsingContextId
)
override
;
void
SetPlaybackState
(
MediaSessionPlaybackState
aState
)
override
;
MediaSessionPlaybackState
GetPlaybackState
(
)
const
override
;
void
OnActionPerformed
(
const
MediaControlAction
&
aAction
)
override
;
void
ControllerAmountChanged
(
uint64_t
aControllerAmount
)
;
void
SetMediaMetadata
(
const
MediaMetadataBase
&
aMetadata
)
override
;
void
SetSupportedMediaKeys
(
const
MediaKeysArray
&
aSupportedKeys
)
override
;
void
SetEnableFullScreen
(
bool
aIsEnabled
)
override
;
void
SetEnablePictureInPictureMode
(
bool
aIsEnabled
)
override
;
void
SetPositionState
(
const
PositionState
&
aState
)
override
;
private
:
~
MediaControlKeyManager
(
)
;
void
Shutdown
(
)
;
class
Observer
final
:
public
nsIObserver
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIOBSERVER
explicit
Observer
(
MediaControlKeyManager
*
aManager
)
;
protected
:
virtual
~
Observer
(
)
=
default
;
MediaControlKeyManager
*
MOZ_OWNING_REF
mManager
;
}
;
RefPtr
<
Observer
>
mObserver
;
void
OnPreferenceChange
(
)
;
void
StartMonitoringControlKeys
(
)
;
void
StopMonitoringControlKeys
(
)
;
RefPtr
<
MediaControlKeySource
>
mEventSource
;
MediaEventListener
mControllerAmountChangedListener
;
MediaMetadataBase
mMetadata
;
nsTArray
<
MediaControlKey
>
mSupportedKeys
;
}
;
}
}
#
endif
