#
include
"
gtest
/
gtest
.
h
"
#
include
"
GMPUtils
.
h
"
#
include
<
string
>
#
include
<
vector
>
using
namespace
std
;
using
namespace
mozilla
;
struct
SplitAtTest
{
string
mInput
;
const
char
*
mDelims
;
vector
<
string
>
mTokens
;
}
;
static
const
SplitAtTest
sSplitAtTests
[
]
{
{
"
1
2
3
4
"
"
"
{
"
1
"
"
2
"
"
3
"
"
4
"
}
}
{
"
a
simple
comma
seperated
list
"
"
"
{
"
a
simple
"
"
comma
"
"
seperated
"
"
list
"
}
}
{
"
line1
\
r
\
n
"
"
line2
\
r
"
"
line3
\
n
"
"
line4
"
"
\
r
\
n
"
{
"
line1
"
"
line2
"
"
line3
"
"
line4
"
}
}
}
;
TEST
(
GeckoMediaPlugins
GMPUtils
)
{
for
(
const
SplitAtTest
&
test
:
sSplitAtTests
)
{
nsCString
input
(
test
.
mInput
.
c_str
(
)
test
.
mInput
.
size
(
)
)
;
nsTArray
<
nsCString
>
tokens
=
SplitAt
(
test
.
mDelims
input
)
;
EXPECT_EQ
(
tokens
.
Length
(
)
test
.
mTokens
.
size
(
)
)
<
<
"
Should
get
expected
number
of
tokens
"
;
for
(
size_t
i
=
0
;
i
<
tokens
.
Length
(
)
;
i
+
+
)
{
EXPECT_TRUE
(
tokens
[
i
]
.
EqualsASCII
(
test
.
mTokens
[
i
]
.
c_str
(
)
)
)
<
<
"
Tokenize
fail
;
expected
=
"
<
<
test
.
mTokens
[
i
]
<
<
"
got
=
"
<
<
tokens
[
i
]
.
BeginReading
(
)
;
}
}
}
