#
include
"
gtest
/
gtest
.
h
"
#
include
"
VideoSegment
.
h
"
using
namespace
mozilla
;
namespace
mozilla
{
namespace
layer
{
class
Image
;
}
}
TEST
(
VideoSegment
TestAppendFrameForceBlack
)
{
RefPtr
<
layers
:
:
Image
>
testImage
=
nullptr
;
VideoSegment
segment
;
segment
.
AppendFrame
(
testImage
.
forget
(
)
mozilla
:
:
StreamTime
(
90000
)
mozilla
:
:
gfx
:
:
IntSize
(
640
480
)
PRINCIPAL_HANDLE_NONE
true
)
;
VideoSegment
:
:
ChunkIterator
iter
(
segment
)
;
while
(
!
iter
.
IsEnded
(
)
)
{
VideoChunk
chunk
=
*
iter
;
EXPECT_TRUE
(
chunk
.
mFrame
.
GetForceBlack
(
)
)
;
iter
.
Next
(
)
;
}
}
TEST
(
VideoSegment
TestAppendFrameNotForceBlack
)
{
RefPtr
<
layers
:
:
Image
>
testImage
=
nullptr
;
VideoSegment
segment
;
segment
.
AppendFrame
(
testImage
.
forget
(
)
mozilla
:
:
StreamTime
(
90000
)
mozilla
:
:
gfx
:
:
IntSize
(
640
480
)
PRINCIPAL_HANDLE_NONE
)
;
VideoSegment
:
:
ChunkIterator
iter
(
segment
)
;
while
(
!
iter
.
IsEnded
(
)
)
{
VideoChunk
chunk
=
*
iter
;
EXPECT_FALSE
(
chunk
.
mFrame
.
GetForceBlack
(
)
)
;
iter
.
Next
(
)
;
}
}
