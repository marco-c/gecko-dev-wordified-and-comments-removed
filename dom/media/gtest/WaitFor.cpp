#
include
"
WaitFor
.
h
"
namespace
mozilla
{
void
WaitFor
(
MediaEventSource
<
void
>
&
aEvent
)
{
bool
done
=
false
;
MediaEventListener
listener
=
aEvent
.
Connect
(
AbstractThread
:
:
GetCurrent
(
)
[
&
]
{
done
=
true
;
}
)
;
SpinEventLoopUntil
<
ProcessFailureBehavior
:
:
IgnoreAndContinue
>
(
"
WaitFor
(
MediaEventSource
<
void
>
&
aEvent
)
"
_ns
[
&
]
{
return
done
;
}
)
;
listener
.
Disconnect
(
)
;
}
}
