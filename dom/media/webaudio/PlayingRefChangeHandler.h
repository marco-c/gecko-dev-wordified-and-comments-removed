#
ifndef
PlayingRefChangeHandler_h__
#
define
PlayingRefChangeHandler_h__
#
include
"
nsThreadUtils
.
h
"
#
include
"
AudioNodeStream
.
h
"
namespace
mozilla
{
namespace
dom
{
class
PlayingRefChangeHandler
final
:
public
Runnable
{
public
:
enum
ChangeType
{
ADDREF
RELEASE
}
;
PlayingRefChangeHandler
(
AudioNodeStream
*
aStream
ChangeType
aChange
)
:
mStream
(
aStream
)
mChange
(
aChange
)
{
}
NS_IMETHOD
Run
(
)
override
{
RefPtr
<
AudioNode
>
node
=
mStream
-
>
Engine
(
)
-
>
NodeMainThread
(
)
;
if
(
node
)
{
if
(
mChange
=
=
ADDREF
)
{
node
-
>
MarkActive
(
)
;
}
else
if
(
mChange
=
=
RELEASE
)
{
node
-
>
MarkInactive
(
)
;
}
}
return
NS_OK
;
}
private
:
RefPtr
<
AudioNodeStream
>
mStream
;
ChangeType
mChange
;
}
;
}
}
#
endif
