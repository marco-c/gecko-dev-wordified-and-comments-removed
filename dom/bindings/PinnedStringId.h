#
ifndef
DOM_BINDINGS_PINNEDSTRINGID_H_
#
define
DOM_BINDINGS_PINNEDSTRINGID_H_
#
include
"
js
/
GCAnnotations
.
h
"
#
include
"
js
/
Id
.
h
"
#
include
"
js
/
RootingAPI
.
h
"
#
include
"
js
/
String
.
h
"
#
include
"
jsapi
.
h
"
class
JSString
;
struct
JSContext
;
namespace
mozilla
:
:
dom
{
class
PinnedStringId
{
jsid
id
;
public
:
constexpr
PinnedStringId
(
)
:
id
(
JSID_VOID
)
{
}
bool
init
(
JSContext
*
cx
const
char
*
string
)
{
JSString
*
str
=
JS_AtomizeAndPinString
(
cx
string
)
;
if
(
!
str
)
{
return
false
;
}
id
=
JS
:
:
PropertyKey
:
:
fromPinnedString
(
str
)
;
return
true
;
}
operator
const
jsid
&
(
)
const
{
return
id
;
}
operator
JS
:
:
Handle
<
jsid
>
(
)
const
{
return
JS
:
:
Handle
<
jsid
>
:
:
fromMarkedLocation
(
&
id
)
;
}
}
JS_HAZ_ROOTED
;
}
#
endif
