#
include
"
mozilla
/
dom
/
CallbackInterface
.
h
"
#
include
"
js
/
CallAndConstruct
.
h
"
#
include
"
js
/
CharacterEncoding
.
h
"
#
include
"
js
/
PropertyAndElement
.
h
"
#
include
"
jsapi
.
h
"
#
include
"
mozilla
/
dom
/
BindingUtils
.
h
"
#
include
"
nsPrintfCString
.
h
"
namespace
mozilla
:
:
dom
{
bool
CallbackInterface
:
:
GetCallableProperty
(
BindingCallContext
&
cx
JS
:
:
Handle
<
jsid
>
aPropId
JS
:
:
MutableHandle
<
JS
:
:
Value
>
aCallable
)
{
JS
:
:
Rooted
<
JSObject
*
>
obj
(
cx
CallbackKnownNotGray
(
)
)
;
if
(
!
JS_GetPropertyById
(
cx
obj
aPropId
aCallable
)
)
{
return
false
;
}
if
(
!
aCallable
.
isObject
(
)
|
|
!
JS
:
:
IsCallable
(
&
aCallable
.
toObject
(
)
)
)
{
JS
:
:
Rooted
<
JSString
*
>
propId
(
cx
aPropId
.
toString
(
)
)
;
JS
:
:
UniqueChars
propName
=
JS_EncodeStringToUTF8
(
cx
propId
)
;
nsPrintfCString
description
(
"
Property
'
%
s
'
"
propName
.
get
(
)
)
;
cx
.
ThrowErrorMessage
<
MSG_NOT_CALLABLE
>
(
description
.
get
(
)
)
;
return
false
;
}
return
true
;
}
}
