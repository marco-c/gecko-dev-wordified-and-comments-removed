#
ifndef
mozilla_dom_workers_WorkerCSPContext_h__
#
define
mozilla_dom_workers_WorkerCSPContext_h__
#
include
"
mozilla
/
Result
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
mozilla
/
dom
/
nsCSPUtils
.
h
"
#
include
"
mozilla
/
ipc
/
PBackgroundSharedTypes
.
h
"
#
include
"
nscore
.
h
"
class
nsIContentSecurityPolicy
;
namespace
mozilla
:
:
dom
{
class
WorkerCSPContext
final
{
public
:
explicit
WorkerCSPContext
(
mozilla
:
:
ipc
:
:
CSPInfo
&
&
aInfo
)
:
mCSPInfo
(
aInfo
)
{
}
static
Result
<
UniquePtr
<
WorkerCSPContext
>
nsresult
>
CreateFromCSP
(
nsIContentSecurityPolicy
*
aCSP
)
;
const
mozilla
:
:
ipc
:
:
CSPInfo
&
CSPInfo
(
)
const
{
return
mCSPInfo
;
}
const
nsTArray
<
UniquePtr
<
const
nsCSPPolicy
>
>
&
Policies
(
)
;
bool
IsEvalAllowed
(
bool
&
aReportViolation
)
;
bool
IsWasmEvalAllowed
(
bool
&
aReportViolation
)
;
private
:
void
EnsureIPCPoliciesRead
(
)
;
mozilla
:
:
ipc
:
:
CSPInfo
mCSPInfo
;
nsTArray
<
UniquePtr
<
const
nsCSPPolicy
>
>
mPolicies
;
}
;
}
#
endif
