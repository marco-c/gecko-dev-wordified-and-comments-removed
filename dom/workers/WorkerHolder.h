#
ifndef
mozilla_dom_workers_WorkerHolder_h
#
define
mozilla_dom_workers_WorkerHolder_h
#
include
"
mozilla
/
dom
/
workers
/
WorkerCommon
.
h
"
BEGIN_WORKERS_NAMESPACE
#
ifdef
Status
#
undef
Status
#
endif
enum
Status
{
Pending
=
0
Running
Closing
Terminating
Canceling
Killing
Dead
}
;
class
WorkerHolder
{
public
:
enum
Behavior
{
AllowIdleShutdownStart
PreventIdleShutdownStart
}
;
explicit
WorkerHolder
(
const
char
*
aName
Behavior
aBehavior
=
PreventIdleShutdownStart
)
;
virtual
~
WorkerHolder
(
)
;
bool
HoldWorker
(
WorkerPrivate
*
aWorkerPrivate
Status
aFailStatus
)
;
void
ReleaseWorker
(
)
;
virtual
bool
Notify
(
Status
aStatus
)
=
0
;
Behavior
GetBehavior
(
)
const
;
const
char
*
Name
(
)
const
{
return
mName
;
}
protected
:
void
ReleaseWorkerInternal
(
)
;
WorkerPrivate
*
MOZ_NON_OWNING_REF
mWorkerPrivate
;
private
:
void
AssertIsOwningThread
(
)
const
;
const
Behavior
mBehavior
;
void
*
mThread
;
const
char
*
mName
;
}
;
END_WORKERS_NAMESPACE
#
endif
