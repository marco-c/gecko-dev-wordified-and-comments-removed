"
use
strict
"
;
const
TAB_URL
=
EXAMPLE_URL
+
"
bug1047663_tab
.
html
"
;
const
WORKER_URL
=
EXAMPLE_URL
+
"
bug1047663_worker
.
sjs
"
;
function
test
(
)
{
waitForExplicitFinish
(
)
;
Task
.
spawn
(
function
*
(
)
{
let
tab
=
yield
addTab
(
TAB_URL
)
;
yield
createWorkerInTab
(
tab
WORKER_URL
)
;
let
message
=
yield
postMessageToWorkerInTab
(
tab
WORKER_URL
"
ping
"
)
;
is
(
message
"
one
"
)
;
yield
terminateWorkerInTab
(
tab
WORKER_URL
)
;
yield
createWorkerInTab
(
tab
WORKER_URL
)
;
message
=
yield
postMessageToWorkerInTab
(
tab
WORKER_URL
"
ping
"
)
;
is
(
message
"
one
"
)
;
yield
terminateWorkerInTab
(
tab
WORKER_URL
)
;
yield
disableCacheInTab
(
tab
)
;
yield
createWorkerInTab
(
tab
WORKER_URL
)
;
message
=
yield
postMessageToWorkerInTab
(
tab
WORKER_URL
"
ping
"
)
;
is
(
message
"
two
"
)
;
yield
terminateWorkerInTab
(
tab
WORKER_URL
)
;
removeTab
(
tab
)
;
finish
(
)
;
}
)
;
}
