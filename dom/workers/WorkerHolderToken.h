#
ifndef
mozilla_dom_workers_WorkerHolderToken_h
#
define
mozilla_dom_workers_WorkerHolderToken_h
#
include
"
nsISupportsImpl
.
h
"
#
include
"
nsTObserverArray
.
h
"
#
include
"
WorkerHolder
.
h
"
namespace
mozilla
{
namespace
dom
{
namespace
workers
{
class
WorkerPrivate
;
}
class
WorkerHolderToken
final
:
public
WorkerHolder
{
public
:
class
Listener
{
public
:
virtual
void
WorkerShuttingDown
(
)
=
0
;
}
;
static
already_AddRefed
<
WorkerHolderToken
>
Create
(
workers
:
:
WorkerPrivate
*
aWorkerPrivate
WorkerStatus
aShutdownStatus
Behavior
aBehavior
=
PreventIdleShutdownStart
)
;
void
AddListener
(
Listener
*
aListener
)
;
void
RemoveListener
(
Listener
*
aListener
)
;
bool
IsShuttingDown
(
)
const
;
workers
:
:
WorkerPrivate
*
GetWorkerPrivate
(
)
const
;
private
:
WorkerHolderToken
(
WorkerStatus
aShutdownStatus
Behavior
aBehavior
)
;
~
WorkerHolderToken
(
)
;
virtual
bool
Notify
(
WorkerStatus
aStatus
)
override
;
nsTObserverArray
<
Listener
*
>
mListenerList
;
const
WorkerStatus
mShutdownStatus
;
bool
mShuttingDown
;
public
:
NS_INLINE_DECL_REFCOUNTING
(
WorkerHolderToken
)
}
;
}
}
#
endif
