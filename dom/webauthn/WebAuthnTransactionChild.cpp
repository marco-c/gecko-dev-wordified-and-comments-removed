#
include
"
mozilla
/
dom
/
WebAuthnTransactionChild
.
h
"
#
include
"
mozilla
/
dom
/
WebAuthnManager
.
h
"
namespace
mozilla
{
namespace
dom
{
WebAuthnTransactionChild
:
:
WebAuthnTransactionChild
(
)
{
NS_ADDREF_THIS
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
WebAuthnTransactionChild
:
:
RecvConfirmRegister
(
nsTArray
<
uint8_t
>
&
&
aRegBuffer
nsTArray
<
uint8_t
>
&
&
aSigBuffer
)
{
RefPtr
<
WebAuthnManager
>
mgr
=
WebAuthnManager
:
:
Get
(
)
;
MOZ_ASSERT
(
mgr
)
;
mgr
-
>
FinishMakeCredential
(
aRegBuffer
aSigBuffer
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
WebAuthnTransactionChild
:
:
RecvConfirmSign
(
nsTArray
<
uint8_t
>
&
&
aCredentialId
nsTArray
<
uint8_t
>
&
&
aBuffer
)
{
RefPtr
<
WebAuthnManager
>
mgr
=
WebAuthnManager
:
:
Get
(
)
;
MOZ_ASSERT
(
mgr
)
;
mgr
-
>
FinishGetAssertion
(
aCredentialId
aBuffer
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
WebAuthnTransactionChild
:
:
RecvCancel
(
const
nsresult
&
aError
)
{
RefPtr
<
WebAuthnManager
>
mgr
=
WebAuthnManager
:
:
Get
(
)
;
MOZ_ASSERT
(
mgr
)
;
mgr
-
>
Cancel
(
aError
)
;
return
IPC_OK
(
)
;
}
void
WebAuthnTransactionChild
:
:
ActorDestroy
(
ActorDestroyReason
why
)
{
RefPtr
<
WebAuthnManager
>
mgr
=
WebAuthnManager
:
:
Get
(
)
;
if
(
mgr
)
{
mgr
-
>
ActorDestroyed
(
)
;
}
}
}
}
