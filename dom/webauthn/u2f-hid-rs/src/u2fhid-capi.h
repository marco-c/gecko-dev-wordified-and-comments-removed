#
ifndef
__U2FHID_CAPI
#
define
__U2FHID_CAPI
#
include
<
stdlib
.
h
>
#
include
"
nsString
.
h
"
extern
"
C
"
{
const
uint8_t
U2F_RESBUF_ID_REGISTRATION
=
0
;
const
uint8_t
U2F_RESBUF_ID_KEYHANDLE
=
1
;
const
uint8_t
U2F_RESBUF_ID_SIGNATURE
=
2
;
struct
rust_u2f_manager
;
struct
rust_u2f_key_handles
;
struct
rust_u2f_result
;
typedef
void
(
*
rust_u2f_callback
)
(
uint64_t
rust_u2f_result
*
)
;
rust_u2f_manager
*
rust_u2f_mgr_new
(
)
;
void
rust_u2f_mgr_free
(
rust_u2f_manager
*
mgr
)
;
uint64_t
rust_u2f_mgr_register
(
rust_u2f_manager
*
mgr
uint64_t
timeout
rust_u2f_callback
const
uint8_t
*
challenge_ptr
size_t
challenge_len
const
uint8_t
*
application_ptr
size_t
application_len
const
rust_u2f_key_handles
*
khs
)
;
uint64_t
rust_u2f_mgr_sign
(
rust_u2f_manager
*
mgr
uint64_t
timeout
rust_u2f_callback
const
uint8_t
*
challenge_ptr
size_t
challenge_len
const
uint8_t
*
application_ptr
size_t
application_len
const
rust_u2f_key_handles
*
khs
)
;
uint64_t
rust_u2f_mgr_cancel
(
rust_u2f_manager
*
mgr
)
;
rust_u2f_key_handles
*
rust_u2f_khs_new
(
)
;
void
rust_u2f_khs_add
(
rust_u2f_key_handles
*
khs
const
uint8_t
*
key_handle
size_t
key_handle_len
)
;
void
rust_u2f_khs_free
(
rust_u2f_key_handles
*
khs
)
;
bool
rust_u2f_resbuf_length
(
const
rust_u2f_result
*
res
uint8_t
bid
size_t
*
len
)
;
bool
rust_u2f_resbuf_copy
(
const
rust_u2f_result
*
res
uint8_t
bid
uint8_t
*
dst
)
;
void
rust_u2f_res_free
(
rust_u2f_result
*
res
)
;
}
#
endif
