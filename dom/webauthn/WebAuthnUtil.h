#
ifndef
mozilla_dom_WebAuthnUtil_h
#
define
mozilla_dom_WebAuthnUtil_h
#
include
"
ipc
/
IPCMessageUtils
.
h
"
#
include
"
mozilla
/
dom
/
WebAuthenticationBinding
.
h
"
namespace
mozilla
:
:
dom
{
class
WindowGlobalParent
;
bool
IsValidAppId
(
const
nsCOMPtr
<
nsIPrincipal
>
&
aPrincipal
const
nsCString
&
aAppId
)
;
bool
IsWebAuthnAllowedInDocument
(
const
nsCOMPtr
<
Document
>
&
aDoc
)
;
bool
IsWebAuthnAllowedInContext
(
WindowGlobalParent
*
aContext
)
;
bool
IsWebAuthnAllowedForTransportSecurityInfo
(
nsITransportSecurityInfo
*
aSecurityInfo
)
;
nsresult
DefaultRpId
(
const
nsCOMPtr
<
nsIPrincipal
>
&
aPrincipal
nsACString
&
aRpId
)
;
bool
IsValidRpId
(
const
nsCOMPtr
<
nsIPrincipal
>
&
aPrincipal
const
nsACString
&
aRpId
)
;
nsresult
HashCString
(
const
nsACString
&
aIn
nsTArray
<
uint8_t
>
&
aOut
)
;
}
#
endif
