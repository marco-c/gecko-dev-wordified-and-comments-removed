#
ifndef
CtapArgs_h
#
define
CtapArgs_h
#
include
"
mozilla
/
dom
/
WebAuthnTransactionChild
.
h
"
#
include
"
mozilla
/
ipc
/
BackgroundParent
.
h
"
#
include
"
nsIWebAuthnArgs
.
h
"
namespace
mozilla
:
:
dom
{
class
CtapRegisterArgs
final
:
public
nsICtapRegisterArgs
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSICTAPREGISTERARGS
explicit
CtapRegisterArgs
(
const
WebAuthnMakeCredentialInfo
&
aInfo
)
:
mInfo
(
aInfo
)
mCredProps
(
false
)
mHmacCreateSecret
(
false
)
mMinPinLength
(
false
)
{
mozilla
:
:
ipc
:
:
AssertIsOnBackgroundThread
(
)
;
for
(
const
WebAuthnExtension
&
ext
:
mInfo
.
Extensions
(
)
)
{
switch
(
ext
.
type
(
)
)
{
case
WebAuthnExtension
:
:
TWebAuthnExtensionCredProps
:
mCredProps
=
ext
.
get_WebAuthnExtensionCredProps
(
)
.
credProps
(
)
;
break
;
case
WebAuthnExtension
:
:
TWebAuthnExtensionHmacSecret
:
mHmacCreateSecret
=
ext
.
get_WebAuthnExtensionHmacSecret
(
)
.
hmacCreateSecret
(
)
;
break
;
case
WebAuthnExtension
:
:
TWebAuthnExtensionMinPinLength
:
mMinPinLength
=
ext
.
get_WebAuthnExtensionMinPinLength
(
)
.
minPinLength
(
)
;
break
;
case
WebAuthnExtension
:
:
TWebAuthnExtensionAppId
:
break
;
case
WebAuthnExtension
:
:
T__None
:
break
;
}
}
}
private
:
~
CtapRegisterArgs
(
)
=
default
;
const
WebAuthnMakeCredentialInfo
&
mInfo
;
bool
mCredProps
;
bool
mHmacCreateSecret
;
bool
mMinPinLength
;
}
;
class
CtapSignArgs
final
:
public
nsICtapSignArgs
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSICTAPSIGNARGS
explicit
CtapSignArgs
(
const
WebAuthnGetAssertionInfo
&
aInfo
)
:
mInfo
(
aInfo
)
{
mozilla
:
:
ipc
:
:
AssertIsOnBackgroundThread
(
)
;
}
private
:
~
CtapSignArgs
(
)
=
default
;
const
WebAuthnGetAssertionInfo
&
mInfo
;
}
;
}
#
endif
