#
include
"
cbor
-
cpp
/
src
/
cbor
.
h
"
#
include
"
mozilla
/
dom
/
WebAuthnCBORUtil
.
h
"
#
include
"
mozilla
/
dom
/
WebAuthnUtil
.
h
"
namespace
mozilla
:
:
dom
{
nsresult
CBOREncodeNoneAttestationObj
(
const
CryptoBuffer
&
aAuthDataBuf
CryptoBuffer
&
aAttestationObj
)
{
cbor
:
:
output_dynamic
cborAttOut
;
cbor
:
:
encoder
encoder
(
cborAttOut
)
;
encoder
.
write_map
(
3
)
;
{
encoder
.
write_string
(
"
fmt
"
)
;
encoder
.
write_string
(
"
none
"
)
;
encoder
.
write_string
(
"
attStmt
"
)
;
encoder
.
write_map
(
0
)
;
encoder
.
write_string
(
"
authData
"
)
;
encoder
.
write_bytes
(
aAuthDataBuf
.
Elements
(
)
aAuthDataBuf
.
Length
(
)
)
;
}
if
(
!
aAttestationObj
.
Assign
(
cborAttOut
.
data
(
)
cborAttOut
.
size
(
)
)
)
{
return
NS_ERROR_OUT_OF_MEMORY
;
}
return
NS_OK
;
}
}
