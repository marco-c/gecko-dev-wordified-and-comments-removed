#
ifndef
DOM_NOTIFICATION_NOTIFICATIONPARENT_H_
#
define
DOM_NOTIFICATION_NOTIFICATIONPARENT_H_
#
include
"
mozilla
/
dom
/
DOMTypes
.
h
"
#
include
"
mozilla
/
dom
/
notification
/
PNotificationParent
.
h
"
#
include
"
mozilla
/
ipc
/
PBackgroundParent
.
h
"
namespace
mozilla
:
:
dom
:
:
notification
{
enum
class
CloseMode
;
enum
class
AlertTopic
:
uint8_t
{
Disable
Settings
Click
Show
Finished
}
;
struct
NotificationParentArgs
{
NotNull
<
nsCOMPtr
<
nsIPrincipal
>
>
mPrincipal
;
NotNull
<
nsCOMPtr
<
nsIPrincipal
>
>
mEffectiveStoragePrincipal
;
bool
mIsSecureContext
;
nsString
mScope
;
IPCNotification
mNotification
;
}
;
class
NotificationParent
final
:
public
PNotificationParent
public
nsISupports
public
SupportsWeakPtr
{
using
IPCResult
=
mozilla
:
:
ipc
:
:
IPCResult
;
public
:
NS_DECL_ISUPPORTS
nsresult
HandleAlertTopic
(
AlertTopic
aTopic
)
;
IPCResult
RecvShow
(
ShowResolver
&
&
aResolver
)
;
IPCResult
RecvClose
(
)
;
static
nsresult
CreateOnMainThread
(
NotificationParentArgs
&
&
mArgs
Endpoint
<
PNotificationParent
>
&
&
aParentEndpoint
PBackgroundParent
:
:
CreateNotificationParentResolver
&
&
aResolver
)
;
private
:
explicit
NotificationParent
(
NotificationParentArgs
&
&
aArgs
)
:
mId
(
aArgs
.
mNotification
.
id
(
)
)
mArgs
(
std
:
:
move
(
aArgs
)
)
{
}
;
~
NotificationParent
(
)
=
default
;
nsresult
Show
(
)
;
nsresult
FireClickEvent
(
)
;
void
Unregister
(
)
;
Maybe
<
NotificationParent
:
:
ShowResolver
>
mResolver
;
nsString
mId
;
const
NotificationParentArgs
mArgs
;
bool
mDangling
=
false
;
}
;
}
#
endif
