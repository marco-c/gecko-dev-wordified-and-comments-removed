#
ifndef
nsGenericHTMLFrameElement_h
#
define
nsGenericHTMLFrameElement_h
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
ErrorResult
.
h
"
#
include
"
mozilla
/
dom
/
nsBrowserElement
.
h
"
#
include
"
nsFrameLoader
.
h
"
#
include
"
nsGenericHTMLElement
.
h
"
#
include
"
nsIDOMEventListener
.
h
"
#
include
"
nsIFrameLoader
.
h
"
#
include
"
nsIMozBrowserFrame
.
h
"
class
nsXULElement
;
class
nsGenericHTMLFrameElement
:
public
nsGenericHTMLElement
public
nsIFrameLoaderOwner
public
mozilla
:
:
nsBrowserElement
public
nsIMozBrowserFrame
{
public
:
nsGenericHTMLFrameElement
(
already_AddRefed
<
mozilla
:
:
dom
:
:
NodeInfo
>
&
aNodeInfo
mozilla
:
:
dom
:
:
FromParser
aFromParser
)
:
nsGenericHTMLElement
(
aNodeInfo
)
nsBrowserElement
(
)
mNetworkCreated
(
aFromParser
=
=
mozilla
:
:
dom
:
:
FROM_PARSER_NETWORK
)
mIsPrerendered
(
false
)
mBrowserFrameListenersRegistered
(
false
)
mFrameLoaderCreationDisallowed
(
false
)
mReallyIsBrowser
(
false
)
{
}
NS_DECL_ISUPPORTS_INHERITED
NS_DECL_NSIFRAMELOADEROWNER
NS_DECL_NSIDOMMOZBROWSERFRAME
NS_DECL_NSIMOZBROWSERFRAME
virtual
bool
IsHTMLFocusable
(
bool
aWithMouse
bool
*
aIsFocusable
int32_t
*
aTabIndex
)
override
;
virtual
nsresult
BindToTree
(
nsIDocument
*
aDocument
nsIContent
*
aParent
nsIContent
*
aBindingParent
bool
aCompileEventHandlers
)
override
;
virtual
void
UnbindFromTree
(
bool
aDeep
=
true
bool
aNullParent
=
true
)
override
;
virtual
void
DestroyContent
(
)
override
;
nsresult
CopyInnerTo
(
mozilla
:
:
dom
:
:
Element
*
aDest
bool
aPreallocateChildren
)
;
virtual
int32_t
TabIndexDefault
(
)
override
;
virtual
nsIMozBrowserFrame
*
GetAsMozBrowserFrame
(
)
override
{
return
this
;
}
NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED
(
nsGenericHTMLFrameElement
nsGenericHTMLElement
)
void
SwapFrameLoaders
(
mozilla
:
:
dom
:
:
HTMLIFrameElement
&
aOtherLoaderOwner
mozilla
:
:
ErrorResult
&
aError
)
;
void
SwapFrameLoaders
(
nsXULElement
&
aOtherLoaderOwner
mozilla
:
:
ErrorResult
&
aError
)
;
void
SwapFrameLoaders
(
nsIFrameLoaderOwner
*
aOtherLoaderOwner
mozilla
:
:
ErrorResult
&
rv
)
;
void
PresetOpenerWindow
(
mozIDOMWindowProxy
*
aOpenerWindow
mozilla
:
:
ErrorResult
&
aRv
)
;
static
void
InitStatics
(
)
;
static
bool
BrowserFramesEnabled
(
)
;
static
int32_t
MapScrollingAttribute
(
const
nsAttrValue
*
aValue
)
;
protected
:
virtual
~
nsGenericHTMLFrameElement
(
)
;
void
EnsureFrameLoader
(
)
;
nsresult
LoadSrc
(
)
;
nsIDocument
*
GetContentDocument
(
nsIPrincipal
&
aSubjectPrincipal
)
;
nsresult
GetContentDocument
(
nsIDOMDocument
*
*
aContentDocument
)
;
already_AddRefed
<
nsPIDOMWindowOuter
>
GetContentWindow
(
)
;
virtual
nsresult
AfterSetAttr
(
int32_t
aNameSpaceID
nsAtom
*
aName
const
nsAttrValue
*
aValue
const
nsAttrValue
*
aOldValue
bool
aNotify
)
override
;
virtual
nsresult
OnAttrSetButNotChanged
(
int32_t
aNamespaceID
nsAtom
*
aName
const
nsAttrValueOrString
&
aValue
bool
aNotify
)
override
;
RefPtr
<
nsFrameLoader
>
mFrameLoader
;
nsCOMPtr
<
nsPIDOMWindowOuter
>
mOpenerWindow
;
bool
mNetworkCreated
;
bool
mIsPrerendered
;
bool
mBrowserFrameListenersRegistered
;
bool
mFrameLoaderCreationDisallowed
;
bool
mReallyIsBrowser
;
bool
mFullscreenFlag
=
false
;
private
:
void
GetManifestURL
(
nsAString
&
aOut
)
;
void
AfterMaybeChangeAttr
(
int32_t
aNamespaceID
nsAtom
*
aName
const
nsAttrValueOrString
*
aValue
bool
aNotify
)
;
}
;
#
endif
