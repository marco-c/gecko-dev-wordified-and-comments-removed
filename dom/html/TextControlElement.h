#
ifndef
mozilla_TextControlElement_h
#
define
mozilla_TextControlElement_h
#
include
"
mozilla
/
dom
/
FromParser
.
h
"
#
include
"
mozilla
/
dom
/
NodeInfo
.
h
"
#
include
"
nsGenericHTMLElement
.
h
"
class
nsIContent
;
class
nsISelectionController
;
class
nsFrameSelection
;
class
nsTextControlFrame
;
namespace
mozilla
{
class
ErrorResult
;
class
TextControlState
;
class
TextEditor
;
class
TextControlElement
:
public
nsGenericHTMLFormControlElementWithState
{
public
:
TextControlElement
(
already_AddRefed
<
dom
:
:
NodeInfo
>
&
&
aNodeInfo
dom
:
:
FromParser
aFromParser
FormControlType
aType
)
:
nsGenericHTMLFormControlElementWithState
(
std
:
:
move
(
aNodeInfo
)
aFromParser
aType
)
{
}
;
NS_DECL_ISUPPORTS_INHERITED
NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED
(
TextControlElement
nsGenericHTMLFormControlElementWithState
)
bool
IsTextControlElement
(
)
const
final
{
return
true
;
}
virtual
bool
IsSingleLineTextControlOrTextArea
(
)
const
=
0
;
NS_IMPL_FROMNODE_HELPER
(
TextControlElement
IsTextControlElement
(
)
)
virtual
void
SetValueChanged
(
bool
)
=
0
;
virtual
bool
IsSingleLineTextControl
(
)
const
=
0
;
virtual
bool
IsTextArea
(
)
const
=
0
;
virtual
bool
IsPasswordTextControl
(
)
const
=
0
;
virtual
Maybe
<
int32_t
>
GetCols
(
)
=
0
;
int32_t
GetColsOrDefault
(
)
{
return
GetCols
(
)
.
valueOr
(
DEFAULT_COLS
)
;
}
virtual
int32_t
GetWrapCols
(
)
=
0
;
virtual
int32_t
GetRows
(
)
=
0
;
virtual
void
GetDefaultValueFromContent
(
nsAString
&
aValue
bool
aForDisplay
)
=
0
;
virtual
bool
ValueChanged
(
)
const
=
0
;
virtual
int32_t
UsedMaxLength
(
)
const
=
0
;
virtual
void
GetTextEditorValue
(
nsAString
&
aValue
)
const
=
0
;
MOZ_CAN_RUN_SCRIPT
virtual
TextEditor
*
GetTextEditor
(
)
=
0
;
virtual
TextEditor
*
GetExtantTextEditor
(
)
const
=
0
;
virtual
nsISelectionController
*
GetSelectionController
(
)
=
0
;
virtual
nsFrameSelection
*
GetIndependentFrameSelection
(
)
const
=
0
;
virtual
TextControlState
*
GetTextControlState
(
)
const
=
0
;
virtual
nsresult
BindToFrame
(
nsTextControlFrame
*
aFrame
)
=
0
;
MOZ_CAN_RUN_SCRIPT
virtual
void
UnbindFromFrame
(
nsTextControlFrame
*
aFrame
)
=
0
;
MOZ_CAN_RUN_SCRIPT
virtual
nsresult
CreateEditor
(
)
=
0
;
virtual
void
SetPreviewValue
(
const
nsAString
&
aValue
)
=
0
;
virtual
void
GetPreviewValue
(
nsAString
&
aValue
)
=
0
;
virtual
void
SetAutofillState
(
const
nsAString
&
aState
)
=
0
;
virtual
void
GetAutofillState
(
nsAString
&
aState
)
=
0
;
virtual
void
EnablePreview
(
)
=
0
;
virtual
bool
IsPreviewEnabled
(
)
=
0
;
virtual
void
InitializeKeyboardEventListeners
(
)
=
0
;
enum
class
ValueChangeKind
{
Internal
Script
UserInteraction
}
;
virtual
void
OnValueChanged
(
ValueChangeKind
bool
aNewValueEmpty
const
nsAString
*
aKnownNewValue
)
=
0
;
void
OnValueChanged
(
ValueChangeKind
aKind
const
nsAString
&
aNewValue
)
{
return
OnValueChanged
(
aKind
aNewValue
.
IsEmpty
(
)
&
aNewValue
)
;
}
virtual
void
GetValueFromSetRangeText
(
nsAString
&
aValue
)
=
0
;
MOZ_CAN_RUN_SCRIPT
virtual
nsresult
SetValueFromSetRangeText
(
const
nsAString
&
aValue
)
=
0
;
inline
static
constexpr
int32_t
DEFAULT_COLS
=
20
;
inline
static
constexpr
int32_t
DEFAULT_ROWS
=
1
;
inline
static
constexpr
int32_t
DEFAULT_ROWS_TEXTAREA
=
2
;
inline
static
constexpr
int32_t
DEFAULT_UNDO_CAP
=
1000
;
virtual
bool
HasCachedSelection
(
)
=
0
;
static
already_AddRefed
<
TextControlElement
>
GetTextControlElementFromEditingHost
(
nsIContent
*
aHost
)
;
protected
:
virtual
~
TextControlElement
(
)
=
default
;
enum
class
FocusTristate
{
eUnfocusable
eInactiveWindow
eActiveWindow
}
;
FocusTristate
FocusState
(
)
;
}
;
}
#
endif
