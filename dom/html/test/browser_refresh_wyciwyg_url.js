var
testURL
=
"
http
:
/
/
mochi
.
test
:
8888
/
browser
/
dom
/
html
/
test
/
file_refresh_wyciwyg_url
.
html
"
;
let
aTab
aBrowser
test_btn
;
function
test
(
)
{
waitForExplicitFinish
(
)
;
aTab
=
BrowserTestUtils
.
addTab
(
gBrowser
testURL
)
;
aBrowser
=
gBrowser
.
getBrowserForTab
(
aTab
)
;
BrowserTestUtils
.
browserLoaded
(
aBrowser
)
.
then
(
(
)
=
>
{
is
(
aBrowser
.
contentDocument
.
URL
testURL
"
Make
sure
we
start
at
the
correct
URL
"
)
;
test_btn
=
aBrowser
.
contentDocument
.
getElementById
(
"
test_btn
"
)
;
test_btn
.
click
(
)
;
return
BrowserTestUtils
.
browserLoaded
(
aBrowser
)
;
}
)
.
then
(
(
)
=
>
{
test_btn
.
click
(
)
;
todo_is
(
aBrowser
.
contentDocument
.
URL
testURL
"
Document
URL
should
be
identical
after
reload
"
)
;
gBrowser
.
removeTab
(
aTab
)
;
finish
(
)
;
}
)
;
}
