#
ifndef
__AutoplayPermissionRequestManager_h__
#
define
__AutoplayPermissionRequestManager_h__
#
include
"
mozilla
/
MozPromise
.
h
"
#
include
"
mozilla
/
WeakPtr
.
h
"
#
include
"
nsIContentPermissionPrompt
.
h
"
#
include
"
nsISupports
.
h
"
#
include
"
nsIWeakReferenceUtils
.
h
"
#
include
"
nsWeakReference
.
h
"
class
nsGlobalWindowInner
;
class
nsIEventTarget
;
namespace
mozilla
{
class
AutoplayPermissionManager
final
:
public
SupportsWeakPtr
<
AutoplayPermissionManager
>
{
public
:
MOZ_DECLARE_WEAKREFERENCE_TYPENAME
(
AutoplayPermissionManager
)
NS_INLINE_DECL_REFCOUNTING
(
AutoplayPermissionManager
)
explicit
AutoplayPermissionManager
(
nsGlobalWindowInner
*
aWindow
)
;
RefPtr
<
GenericPromise
>
RequestWithPrompt
(
)
;
void
ApprovePlayRequest
(
)
;
void
DenyPlayRequest
(
)
;
private
:
~
AutoplayPermissionManager
(
)
;
nsWeakPtr
mWindow
;
MozPromiseHolder
<
GenericPromise
>
mPromiseHolder
;
bool
mRequestDispatched
=
false
;
}
;
}
#
endif
