#
ifndef
mozilla_dom_U2FUtil_h
#
define
mozilla_dom_U2FUtil_h
namespace
mozilla
{
namespace
dom
{
static
nsresult
HashCString
(
nsICryptoHash
*
aHashService
const
nsACString
&
aIn
CryptoBuffer
&
aOut
)
{
MOZ_ASSERT
(
aHashService
)
;
nsresult
rv
=
aHashService
-
>
Init
(
nsICryptoHash
:
:
SHA256
)
;
if
(
NS_WARN_IF
(
NS_FAILED
(
rv
)
)
)
{
return
rv
;
}
rv
=
aHashService
-
>
Update
(
reinterpret_cast
<
const
uint8_t
*
>
(
aIn
.
BeginReading
(
)
)
aIn
.
Length
(
)
)
;
if
(
NS_WARN_IF
(
NS_FAILED
(
rv
)
)
)
{
return
rv
;
}
nsAutoCString
fullHash
;
rv
=
aHashService
-
>
Finish
(
false
fullHash
)
;
if
(
NS_WARN_IF
(
NS_FAILED
(
rv
)
)
)
{
return
rv
;
}
aOut
.
Assign
(
fullHash
)
;
return
rv
;
}
}
}
#
endif
