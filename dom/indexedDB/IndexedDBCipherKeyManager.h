#
ifndef
mozilla_dom_indexeddbcipherKeyManager_h
#
define
mozilla_dom_indexeddbcipherKeyManager_h
#
include
"
mozilla
/
dom
/
quota
/
IPCStreamCipherStrategy
.
h
"
#
include
"
mozilla
/
DataMutex
.
h
"
#
include
"
nsTHashMap
.
h
"
namespace
mozilla
:
:
dom
:
:
indexedDB
{
namespace
{
using
IndexedDBCipherStrategy
=
quota
:
:
IPCStreamCipherStrategy
;
using
CipherKey
=
IndexedDBCipherStrategy
:
:
KeyType
;
class
IndexedDBCipherKeyManager
{
public
:
using
PrivateBrowsingInfoHashtable
=
nsTHashMap
<
nsCStringHashKey
nsTHashMap
<
nsCStringHashKey
CipherKey
>
>
;
IndexedDBCipherKeyManager
(
)
:
mPrivateBrowsingInfoHashTable
(
"
IndexedDBCipherKeyManager
"
)
{
}
;
Maybe
<
CipherKey
>
Get
(
const
nsCString
&
aDatabaseID
const
nsCString
&
keyStoreID
=
"
default
"
_ns
)
;
CipherKey
Ensure
(
const
nsCString
&
aDatabaseID
const
nsCString
&
keyStoreID
=
"
default
"
_ns
)
;
bool
Remove
(
const
nsCString
&
aDatabaseID
)
;
private
:
DataMutex
<
PrivateBrowsingInfoHashtable
>
mPrivateBrowsingInfoHashTable
;
}
;
}
}
#
endif
