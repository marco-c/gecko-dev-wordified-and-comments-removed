#
ifndef
DOM_INDEXEDDB_INDEXEDDBCIPHERKEYMANAGER_H_
#
define
DOM_INDEXEDDB_INDEXEDDBCIPHERKEYMANAGER_H_
#
include
"
FlippedOnce
.
h
"
#
include
"
mozilla
/
DataMutex
.
h
"
#
include
"
mozilla
/
dom
/
quota
/
IPCStreamCipherStrategy
.
h
"
#
include
"
nsTHashMap
.
h
"
namespace
mozilla
:
:
dom
:
:
indexedDB
{
using
IndexedDBCipherStrategy
=
quota
:
:
IPCStreamCipherStrategy
;
using
CipherKey
=
IndexedDBCipherStrategy
:
:
KeyType
;
class
IndexedDBCipherKeyManager
{
public
:
IndexedDBCipherKeyManager
(
)
:
mCipherKeys
(
"
IndexedDBCipherKeyManager
"
)
{
}
;
Maybe
<
CipherKey
>
Get
(
const
nsACString
&
aKeyId
=
"
default
"
_ns
)
;
CipherKey
Ensure
(
const
nsACString
&
aKeyId
=
"
default
"
_ns
)
;
bool
Invalidated
(
)
;
void
Invalidate
(
)
;
private
:
DataMutex
<
nsTHashMap
<
nsCStringHashKey
CipherKey
>
>
mCipherKeys
;
FlippedOnce
<
false
>
mInvalidated
;
}
;
}
#
endif
