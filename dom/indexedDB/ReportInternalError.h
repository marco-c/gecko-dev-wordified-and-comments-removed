#
ifndef
mozilla_dom_indexeddb_reportinternalerror_h__
#
define
mozilla_dom_indexeddb_reportinternalerror_h__
#
include
"
nsDebug
.
h
"
#
include
"
IndexedDatabase
.
h
"
#
define
IDB_WARNING
(
.
.
.
)
\
do
{
\
nsPrintfCString
s
(
__VA_ARGS__
)
;
\
mozilla
:
:
dom
:
:
indexedDB
:
:
ReportInternalError
(
__FILE__
__LINE__
s
.
get
(
)
)
;
\
NS_WARNING
(
s
.
get
(
)
)
;
\
}
while
(
0
)
#
define
IDB_REPORT_INTERNAL_ERR
(
)
\
mozilla
:
:
dom
:
:
indexedDB
:
:
ReportInternalError
(
__FILE__
__LINE__
"
UnknownErr
"
)
#
define
IDB_REPORT_INTERNAL_ERR_LAMBDA
\
[
]
(
const
auto
&
)
{
IDB_REPORT_INTERNAL_ERR
(
)
;
}
#
define
IDB_ENSURE_TRUE
(
x
ret
)
\
do
{
\
if
(
MOZ_UNLIKELY
(
!
(
x
)
)
)
{
\
IDB_REPORT_INTERNAL_ERR
(
)
;
\
NS_WARNING
(
"
IDB_ENSURE_TRUE
(
"
#
x
"
)
failed
"
)
;
\
return
ret
;
\
}
\
}
while
(
0
)
namespace
mozilla
{
namespace
dom
{
namespace
indexedDB
{
void
ReportInternalError
(
const
char
*
aFile
uint32_t
aLine
const
char
*
aStr
)
;
}
}
}
#
endif
