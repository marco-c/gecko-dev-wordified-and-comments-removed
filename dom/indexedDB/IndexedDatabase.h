#
ifndef
mozilla_dom_indexeddatabase_h__
#
define
mozilla_dom_indexeddatabase_h__
#
include
"
js
/
StructuredClone
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsTArray
.
h
"
namespace
mozilla
{
namespace
dom
{
class
Blob
;
class
IDBDatabase
;
class
IDBMutableFile
;
namespace
indexedDB
{
class
FileInfo
;
class
SerializedStructuredCloneReadInfo
;
struct
StructuredCloneFile
{
enum
FileType
{
eBlob
eMutableFile
eStructuredClone
eWasmBytecode
eWasmCompiled
eEndGuard
}
;
RefPtr
<
Blob
>
mBlob
;
RefPtr
<
IDBMutableFile
>
mMutableFile
;
RefPtr
<
FileInfo
>
mFileInfo
;
FileType
mType
;
inline
explicit
StructuredCloneFile
(
FileType
aType
RefPtr
<
Blob
>
aBlob
=
{
}
)
;
inline
explicit
StructuredCloneFile
(
RefPtr
<
IDBMutableFile
>
aMutableFile
)
;
inline
~
StructuredCloneFile
(
)
;
inline
bool
operator
=
=
(
const
StructuredCloneFile
&
aOther
)
const
;
}
;
struct
StructuredCloneReadInfo
{
JSStructuredCloneData
mData
;
nsTArray
<
StructuredCloneFile
>
mFiles
;
IDBDatabase
*
mDatabase
;
bool
mHasPreprocessInfo
;
inline
explicit
StructuredCloneReadInfo
(
JS
:
:
StructuredCloneScope
aScope
)
;
inline
StructuredCloneReadInfo
(
)
;
inline
StructuredCloneReadInfo
(
JSStructuredCloneData
&
&
aData
nsTArray
<
StructuredCloneFile
>
aFiles
IDBDatabase
*
aDatabase
bool
aHasPreprocessInfo
)
;
#
ifdef
NS_BUILD_REFCNT_LOGGING
inline
~
StructuredCloneReadInfo
(
)
;
inline
StructuredCloneReadInfo
(
StructuredCloneReadInfo
&
&
aOther
)
noexcept
;
inline
StructuredCloneReadInfo
&
operator
=
(
StructuredCloneReadInfo
&
&
aOther
)
noexcept
;
#
else
StructuredCloneReadInfo
(
StructuredCloneReadInfo
&
&
aOther
)
=
default
;
StructuredCloneReadInfo
&
operator
=
(
StructuredCloneReadInfo
&
&
aOther
)
=
default
;
#
endif
StructuredCloneReadInfo
(
const
StructuredCloneReadInfo
&
aOther
)
=
delete
;
StructuredCloneReadInfo
&
operator
=
(
const
StructuredCloneReadInfo
&
aOther
)
=
delete
;
inline
size_t
Size
(
)
const
;
}
;
}
}
}
#
endif
