var
testGenerator
=
testSteps
(
)
;
function
*
testSteps
(
)
{
const
url
=
"
moz
-
extension
:
/
/
8ea6d31b
-
917c
-
431f
-
a204
-
15b95e904d4f
"
;
const
dbName
=
"
Hello
.
"
;
const
dbVersion
=
1
;
clearAllDatabases
(
continueToNextStepSync
)
;
yield
;
installPackagedProfile
(
"
obsoleteOriginAttributes_profile
"
)
;
let
request
=
indexedDB
.
openForPrincipal
(
getPrincipal
(
url
)
dbName
dbVersion
)
;
request
.
onerror
=
errorHandler
;
request
.
onupgradeneeded
=
unexpectedSuccessHandler
;
request
.
onsuccess
=
grabEventAndContinueHandler
;
let
event
=
yield
;
is
(
event
.
type
"
success
"
"
Correct
event
type
"
)
;
resetAllDatabases
(
continueToNextStepSync
)
;
yield
;
request
=
indexedDB
.
openForPrincipal
(
getPrincipal
(
url
)
dbName
dbVersion
)
;
request
.
onerror
=
errorHandler
;
request
.
onupgradeneeded
=
unexpectedSuccessHandler
;
request
.
onsuccess
=
grabEventAndContinueHandler
;
event
=
yield
;
is
(
event
.
type
"
success
"
"
Correct
event
type
"
)
;
finishTest
(
)
;
}
