#
ifndef
GPU_ComputePassEncoder_H_
#
define
GPU_ComputePassEncoder_H_
#
include
"
mozilla
/
Scoped
.
h
"
#
include
"
mozilla
/
dom
/
TypedArray
.
h
"
#
include
"
ObjectModel
.
h
"
namespace
mozilla
{
class
ErrorResult
;
namespace
dom
{
struct
GPUComputePassDescriptor
;
}
namespace
webgpu
{
namespace
ffi
{
struct
WGPUComputePass
;
}
class
BindGroup
;
class
Buffer
;
class
CommandEncoder
;
class
ComputePipeline
;
struct
ScopedFfiComputeTraits
{
using
type
=
ffi
:
:
WGPUComputePass
*
;
static
type
empty
(
)
;
static
void
release
(
type
raw
)
;
}
;
class
ComputePassEncoder
final
:
public
ObjectBase
public
ChildOf
<
CommandEncoder
>
{
public
:
GPU_DECL_CYCLE_COLLECTION
(
ComputePassEncoder
)
GPU_DECL_JS_WRAP
(
ComputePassEncoder
)
ComputePassEncoder
(
CommandEncoder
*
const
aParent
const
dom
:
:
GPUComputePassDescriptor
&
aDesc
)
;
private
:
virtual
~
ComputePassEncoder
(
)
;
void
Cleanup
(
)
{
}
Scoped
<
ScopedFfiComputeTraits
>
mPass
;
nsTArray
<
RefPtr
<
const
BindGroup
>
>
mUsedBindGroups
;
nsTArray
<
RefPtr
<
const
ComputePipeline
>
>
mUsedPipelines
;
public
:
void
SetBindGroup
(
uint32_t
aSlot
const
BindGroup
&
aBindGroup
const
dom
:
:
Sequence
<
uint32_t
>
&
aDynamicOffsets
)
;
void
SetPipeline
(
const
ComputePipeline
&
aPipeline
)
;
void
Dispatch
(
uint32_t
x
uint32_t
y
uint32_t
z
)
;
void
DispatchIndirect
(
const
Buffer
&
aIndirectBuffer
uint64_t
aIndirectOffset
)
;
void
EndPass
(
ErrorResult
&
aRv
)
;
}
;
}
}
#
endif
