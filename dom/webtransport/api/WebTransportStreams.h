#
ifndef
DOM_WEBTRANSPORT_API_WEBTRANSPORTSTREAMS__H_
#
define
DOM_WEBTRANSPORT_API_WEBTRANSPORTSTREAMS__H_
#
include
"
mozilla
/
dom
/
UnderlyingSourceCallbackHelpers
.
h
"
#
include
"
mozilla
/
dom
/
WritableStream
.
h
"
namespace
mozilla
:
:
dom
{
class
WebTransport
;
class
WebTransportIncomingStreamsAlgorithms
:
public
UnderlyingSourceAlgorithmsWrapper
{
public
:
enum
class
StreamType
:
uint8_t
{
Unidirectional
Bidirectional
}
;
WebTransportIncomingStreamsAlgorithms
(
StreamType
aUnidirectional
WebTransport
*
aTransport
)
;
NS_DECL_ISUPPORTS_INHERITED
NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED
(
WebTransportIncomingStreamsAlgorithms
UnderlyingSourceAlgorithmsWrapper
)
already_AddRefed
<
Promise
>
PullCallbackImpl
(
JSContext
*
aCx
ReadableStreamController
&
aController
ErrorResult
&
aRv
)
override
;
MOZ_CAN_RUN_SCRIPT_BOUNDARY
void
BuildStream
(
JSContext
*
aCx
ErrorResult
&
aRv
)
;
void
NotifyIncomingStream
(
)
;
void
NotifyRejectAll
(
)
;
protected
:
~
WebTransportIncomingStreamsAlgorithms
(
)
override
;
private
:
const
StreamType
mUnidirectional
;
RefPtr
<
WebTransport
>
mTransport
;
RefPtr
<
Promise
>
mCallback
;
}
;
}
#
endif
