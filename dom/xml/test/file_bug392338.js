Components
.
utils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
var
modifyObserver
=
{
observe
:
function
(
subject
topic
data
)
{
if
(
topic
=
=
'
http
-
on
-
modify
-
request
'
)
{
var
testOk
=
false
;
try
{
var
ir
=
subject
.
QueryInterface
(
Components
.
interfaces
.
nsIChannel
)
.
notificationCallbacks
;
testOk
=
ir
.
toString
(
)
.
indexOf
(
Components
.
interfaces
.
nsIInterfaceRequestor
)
!
=
-
1
;
}
catch
(
e
)
{
}
sendAsyncMessage
(
'
modify
-
request
-
completed
'
testOk
)
;
Services
.
obs
.
removeObserver
(
modifyObserver
'
http
-
on
-
modify
-
request
'
)
;
}
}
}
;
Services
.
obs
.
addObserver
(
modifyObserver
'
http
-
on
-
modify
-
request
'
false
)
;
