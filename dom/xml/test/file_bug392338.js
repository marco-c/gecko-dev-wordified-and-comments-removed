const
{
Services
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
var
modifyObserver
=
{
observe
:
function
(
subject
topic
data
)
{
if
(
topic
=
=
'
http
-
on
-
modify
-
request
'
)
{
var
testOk
=
false
;
try
{
var
ir
=
subject
.
QueryInterface
(
Ci
.
nsIChannel
)
.
notificationCallbacks
;
testOk
=
ir
.
toString
(
)
.
includes
(
Ci
.
nsIInterfaceRequestor
)
;
}
catch
(
e
)
{
}
sendAsyncMessage
(
'
modify
-
request
-
completed
'
testOk
)
;
Services
.
obs
.
removeObserver
(
modifyObserver
'
http
-
on
-
modify
-
request
'
)
;
}
}
}
;
Services
.
obs
.
addObserver
(
modifyObserver
'
http
-
on
-
modify
-
request
'
)
;
