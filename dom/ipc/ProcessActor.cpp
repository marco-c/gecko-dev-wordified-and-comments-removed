#
include
"
mozilla
/
dom
/
ProcessActor
.
h
"
#
include
"
mozilla
/
ContentBlockingAllowList
.
h
"
#
include
"
mozilla
/
Logging
.
h
"
#
include
"
mozilla
/
dom
/
JSActorService
.
h
"
#
include
"
mozilla
/
dom
/
JSProcessActorChild
.
h
"
#
include
"
mozilla
/
dom
/
JSProcessActorParent
.
h
"
#
include
"
mozilla
/
dom
/
JSProcessActorProtocol
.
h
"
#
include
"
nsContentUtils
.
h
"
namespace
mozilla
:
:
dom
{
already_AddRefed
<
JSActorProtocol
>
ProcessActor
:
:
MatchingJSActorProtocol
(
JSActorService
*
aActorSvc
const
nsACString
&
aName
ErrorResult
&
aRv
)
{
RefPtr
<
JSProcessActorProtocol
>
proto
=
aActorSvc
-
>
GetJSProcessActorProtocol
(
aName
)
;
if
(
!
proto
)
{
aRv
.
ThrowNotFoundError
(
nsPrintfCString
(
"
No
such
JSProcessActor
'
%
s
'
"
PromiseFlatCString
(
aName
)
.
get
(
)
)
)
;
return
nullptr
;
}
if
(
!
proto
-
>
Matches
(
GetRemoteType
(
)
aRv
)
)
{
MOZ_ASSERT
(
aRv
.
Failed
(
)
)
;
return
nullptr
;
}
MOZ_ASSERT
(
!
aRv
.
Failed
(
)
)
;
return
proto
.
forget
(
)
;
}
}
