#
include
"
CoalescedInputData
.
h
"
#
include
"
BrowserChild
.
h
"
#
include
"
mozilla
/
PresShell
.
h
"
#
include
"
nsRefreshDriver
.
h
"
using
namespace
mozilla
;
using
namespace
mozilla
:
:
dom
;
void
CoalescedInputFlusher
:
:
StartObserver
(
)
{
nsRefreshDriver
*
refreshDriver
=
GetRefreshDriver
(
)
;
if
(
mRefreshDriver
&
&
mRefreshDriver
=
=
refreshDriver
)
{
return
;
}
RemoveObserver
(
)
;
if
(
refreshDriver
)
{
mRefreshDriver
=
refreshDriver
;
mRefreshDriver
-
>
AddRefreshObserver
(
this
FlushType
:
:
Event
"
Coalesced
input
move
flusher
"
)
;
}
}
CoalescedInputFlusher
:
:
CoalescedInputFlusher
(
BrowserChild
*
aBrowserChild
)
:
mBrowserChild
(
aBrowserChild
)
{
}
void
CoalescedInputFlusher
:
:
RemoveObserver
(
)
{
if
(
mRefreshDriver
)
{
mRefreshDriver
-
>
RemoveRefreshObserver
(
this
FlushType
:
:
Event
)
;
mRefreshDriver
=
nullptr
;
}
}
CoalescedInputFlusher
:
:
~
CoalescedInputFlusher
(
)
=
default
;
nsRefreshDriver
*
CoalescedInputFlusher
:
:
GetRefreshDriver
(
)
{
if
(
PresShell
*
presShell
=
mBrowserChild
-
>
GetTopLevelPresShell
(
)
)
{
return
presShell
-
>
GetRefreshDriver
(
)
;
}
return
nullptr
;
}
