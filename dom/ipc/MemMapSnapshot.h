#
ifndef
dom_ipc_MemMapSnapshot_h
#
define
dom_ipc_MemMapSnapshot_h
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
Maybe
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
mozilla
/
RangedPtr
.
h
"
#
include
"
mozilla
/
Result
.
h
"
#
include
"
mozilla
/
ipc
/
SharedMemoryMapping
.
h
"
#
include
"
ErrorList
.
h
"
namespace
mozilla
:
:
ipc
{
class
MOZ_RAII
MemMapSnapshot
{
public
:
Result
<
Ok
nsresult
>
Init
(
size_t
aSize
)
;
Result
<
ReadOnlySharedMemoryHandle
nsresult
>
Finalize
(
)
;
template
<
typename
T
>
RangedPtr
<
T
>
Get
(
)
{
MOZ_ASSERT
(
mMem
)
;
auto
span
=
mMem
.
DataAsSpan
<
T
>
(
)
;
return
{
span
.
data
(
)
span
.
size
(
)
}
;
}
private
:
FreezableSharedMemoryMapping
mMem
;
}
;
}
#
endif
