#
ifndef
dom_ipc_MemMapSnapshot_h
#
define
dom_ipc_MemMapSnapshot_h
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
Maybe
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
mozilla
/
RangedPtr
.
h
"
#
include
"
mozilla
/
Result
.
h
"
#
include
"
mozilla
/
ipc
/
SharedMemory
.
h
"
#
include
"
ErrorList
.
h
"
namespace
mozilla
:
:
ipc
{
class
MOZ_RAII
MemMapSnapshot
{
public
:
Result
<
Ok
nsresult
>
Init
(
size_t
aSize
)
;
Result
<
Ok
nsresult
>
Finalize
(
RefPtr
<
SharedMemory
>
&
aMem
)
;
template
<
typename
T
>
RangedPtr
<
T
>
Get
(
)
{
MOZ_ASSERT
(
mMem
)
;
return
{
static_cast
<
T
*
>
(
mMem
-
>
Memory
(
)
)
mMem
-
>
MaxSize
(
)
/
sizeof
(
T
)
}
;
}
private
:
RefPtr
<
SharedMemory
>
mMem
;
}
;
}
#
endif
