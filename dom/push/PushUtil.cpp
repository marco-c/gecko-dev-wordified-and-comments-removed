#
include
"
mozilla
/
dom
/
PushUtil
.
h
"
#
include
"
mozilla
/
dom
/
UnionTypes
.
h
"
namespace
mozilla
:
:
dom
{
bool
PushUtil
:
:
CopyBufferSourceToArray
(
const
OwningArrayBufferViewOrArrayBuffer
&
aSource
nsTArray
<
uint8_t
>
&
aArray
)
{
MOZ_ASSERT
(
aArray
.
IsEmpty
(
)
)
;
return
AppendTypedArrayDataTo
(
aSource
aArray
)
;
}
void
PushUtil
:
:
CopyArrayToArrayBuffer
(
JSContext
*
aCx
const
nsTArray
<
uint8_t
>
&
aArray
JS
:
:
MutableHandle
<
JSObject
*
>
aValue
ErrorResult
&
aRv
)
{
if
(
aArray
.
IsEmpty
(
)
)
{
aValue
.
set
(
nullptr
)
;
return
;
}
JS
:
:
Rooted
<
JSObject
*
>
buffer
(
aCx
ArrayBuffer
:
:
Create
(
aCx
aArray
)
)
;
if
(
NS_WARN_IF
(
!
buffer
)
)
{
aRv
.
Throw
(
NS_ERROR_OUT_OF_MEMORY
)
;
return
;
}
aValue
.
set
(
buffer
)
;
}
}
