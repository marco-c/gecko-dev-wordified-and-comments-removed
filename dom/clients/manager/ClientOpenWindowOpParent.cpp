#
include
"
ClientOpenWindowOpParent
.
h
"
namespace
mozilla
{
namespace
dom
{
using
mozilla
:
:
ipc
:
:
IPCResult
;
void
ClientOpenWindowOpParent
:
:
ActorDestroy
(
ActorDestroyReason
aReason
)
{
if
(
mPromise
)
{
CopyableErrorResult
rv
;
rv
.
ThrowDOMException
(
NS_ERROR_DOM_ABORT_ERR
"
Client
aborted
"
)
;
mPromise
-
>
Reject
(
rv
__func__
)
;
mPromise
=
nullptr
;
}
}
IPCResult
ClientOpenWindowOpParent
:
:
Recv__delete__
(
const
ClientOpResult
&
aResult
)
{
if
(
aResult
.
type
(
)
=
=
ClientOpResult
:
:
TCopyableErrorResult
&
&
aResult
.
get_CopyableErrorResult
(
)
.
Failed
(
)
)
{
mPromise
-
>
Reject
(
aResult
.
get_CopyableErrorResult
(
)
__func__
)
;
mPromise
=
nullptr
;
return
IPC_OK
(
)
;
}
mPromise
-
>
Resolve
(
aResult
__func__
)
;
mPromise
=
nullptr
;
return
IPC_OK
(
)
;
}
ClientOpenWindowOpParent
:
:
ClientOpenWindowOpParent
(
const
ClientOpenWindowArgs
&
aArgs
ClientOpPromise
:
:
Private
*
aPromise
)
:
mPromise
(
aPromise
)
{
MOZ_DIAGNOSTIC_ASSERT
(
mPromise
)
;
}
ClientOpenWindowOpParent
:
:
~
ClientOpenWindowOpParent
(
)
{
MOZ_DIAGNOSTIC_ASSERT
(
!
mPromise
)
;
}
}
}
