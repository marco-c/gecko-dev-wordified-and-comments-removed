#
include
"
StreamUtils
.
h
"
#
include
<
cmath
>
#
include
"
mozilla
/
dom
/
QueuingStrategyBinding
.
h
"
namespace
mozilla
:
:
dom
{
double
ExtractHighWaterMark
(
const
QueuingStrategy
&
aStrategy
double
aDefaultHWM
mozilla
:
:
ErrorResult
&
aRv
)
{
if
(
!
aStrategy
.
mHighWaterMark
.
WasPassed
(
)
)
{
return
aDefaultHWM
;
}
double
highWaterMark
=
aStrategy
.
mHighWaterMark
.
Value
(
)
;
if
(
std
:
:
isnan
(
highWaterMark
)
|
|
highWaterMark
<
0
)
{
aRv
.
ThrowRangeError
(
"
Invalid
highWaterMark
"
)
;
return
0
.
0
;
}
return
highWaterMark
;
}
}
