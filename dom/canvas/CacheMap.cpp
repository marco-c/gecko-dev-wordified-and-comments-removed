#
include
"
CacheMap
.
h
"
namespace
mozilla
{
void
CacheMapInvalidator
:
:
InvalidateCaches
(
)
const
{
while
(
mCacheEntries
.
size
(
)
)
{
const
auto
pEntry
=
*
(
mCacheEntries
.
begin
(
)
)
;
pEntry
-
>
Invalidate
(
)
;
MOZ_ASSERT
(
mCacheEntries
.
find
(
pEntry
)
=
=
mCacheEntries
.
end
(
)
)
;
}
}
namespace
detail
{
CacheMapUntypedEntry
:
:
CacheMapUntypedEntry
(
std
:
:
vector
<
const
CacheMapInvalidator
*
>
&
&
invalidators
)
:
mInvalidators
(
std
:
:
move
(
invalidators
)
)
{
for
(
const
auto
&
cur
:
mInvalidators
)
{
(
void
)
cur
-
>
mCacheEntries
.
insert
(
this
)
;
}
}
CacheMapUntypedEntry
:
:
~
CacheMapUntypedEntry
(
)
{
for
(
const
auto
&
cur
:
mInvalidators
)
{
(
void
)
cur
-
>
mCacheEntries
.
erase
(
this
)
;
}
}
}
}
