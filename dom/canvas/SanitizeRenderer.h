#
ifndef
mozilla_RendererSanitizer_h
#
define
mozilla_RendererSanitizer_h
#
include
<
string
>
namespace
mozilla
{
namespace
dom
{
inline
static
void
SanitizeRenderer
(
std
:
:
string
&
aRenderer
)
{
if
(
aRenderer
.
empty
(
)
)
{
return
;
}
if
(
aRenderer
.
back
(
)
!
=
'
)
'
)
{
return
;
}
auto
pos
=
aRenderer
.
find
(
"
DRM
"
)
;
if
(
pos
!
=
std
:
:
string
:
:
npos
)
{
aRenderer
.
resize
(
pos
)
;
aRenderer
.
push_back
(
'
)
'
)
;
return
;
}
pos
=
aRenderer
.
find
(
"
(
DRM
"
)
;
if
(
pos
!
=
std
:
:
string
:
:
npos
)
{
aRenderer
.
resize
(
pos
)
;
return
;
}
}
}
;
}
;
#
endif
