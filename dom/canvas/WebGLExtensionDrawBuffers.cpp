#
include
"
WebGLExtensions
.
h
"
#
include
<
algorithm
>
#
include
"
GLContext
.
h
"
#
include
"
mozilla
/
dom
/
WebGLRenderingContextBinding
.
h
"
#
include
"
WebGLContext
.
h
"
#
include
"
WebGLFramebuffer
.
h
"
#
include
"
WebGLRenderbuffer
.
h
"
#
include
"
WebGLTexture
.
h
"
namespace
mozilla
{
WebGLExtensionDrawBuffers
:
:
WebGLExtensionDrawBuffers
(
WebGLContext
*
webgl
)
:
WebGLExtensionBase
(
webgl
)
{
MOZ_ASSERT
(
IsSupported
(
webgl
)
"
Don
'
t
construct
extension
if
unsupported
.
"
)
;
webgl
-
>
mImplMaxColorAttachments
=
webgl
-
>
mGLMaxColorAttachments
;
webgl
-
>
mImplMaxDrawBuffers
=
std
:
:
min
(
webgl
-
>
mGLMaxDrawBuffers
webgl
-
>
mImplMaxColorAttachments
)
;
}
WebGLExtensionDrawBuffers
:
:
~
WebGLExtensionDrawBuffers
(
)
{
}
void
WebGLExtensionDrawBuffers
:
:
DrawBuffersWEBGL
(
const
dom
:
:
Sequence
<
GLenum
>
&
buffers
)
{
if
(
mIsLost
)
{
mContext
-
>
ErrorInvalidOperation
(
"
drawBuffersWEBGL
:
Extension
is
lost
.
"
)
;
return
;
}
mContext
-
>
DrawBuffers
(
buffers
)
;
}
bool
WebGLExtensionDrawBuffers
:
:
IsSupported
(
const
WebGLContext
*
webgl
)
{
gl
:
:
GLContext
*
gl
=
webgl
-
>
GL
(
)
;
if
(
!
gl
-
>
IsSupported
(
gl
:
:
GLFeature
:
:
draw_buffers
)
)
return
false
;
if
(
webgl
-
>
mGLMaxDrawBuffers
<
webgl
-
>
kMinMaxDrawBuffers
|
|
webgl
-
>
mGLMaxColorAttachments
<
webgl
-
>
kMinMaxColorAttachments
)
{
return
false
;
}
return
true
;
}
IMPL_WEBGL_EXTENSION_GOOP
(
WebGLExtensionDrawBuffers
WEBGL_draw_buffers
)
}
