#
ifndef
WEBGLCHILD_H_
#
define
WEBGLCHILD_H_
#
include
<
string
>
#
include
"
mozilla
/
dom
/
PWebGLChild
.
h
"
#
include
"
mozilla
/
dom
/
IpdlQueue
.
h
"
#
include
"
mozilla
/
dom
/
WebGLParent
.
h
"
namespace
mozilla
{
class
ClientWebGLContext
;
namespace
dom
{
struct
FlushedCmdInfo
final
{
size_t
flushes
=
0
;
size_t
flushedCmdBytes
=
0
;
}
;
class
WebGLChild
final
:
public
PWebGLChild
public
SupportsWeakPtr
<
WebGLChild
>
public
mozilla
:
:
webgl
:
:
PcqActor
{
std
:
:
unique_ptr
<
webgl
:
:
ShmemCmdBuffer
>
mPendingCmds
;
FlushedCmdInfo
mFlushedCmdInfo
;
public
:
MOZ_DECLARE_WEAKREFERENCE_TYPENAME
(
WebGLChild
)
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
WebGLChild
override
)
;
using
OtherSideActor
=
WebGLParent
;
ClientWebGLContext
&
mContext
;
explicit
WebGLChild
(
ClientWebGLContext
&
)
;
static
IpdlQueueProtocol
GetIpdlQueueProtocol
(
size_t
aCmd
.
.
.
)
;
Maybe
<
Range
<
uint8_t
>
>
AllocPendingCmdBytes
(
size_t
)
;
void
FlushPendingCmds
(
)
;
private
:
friend
PWebGLChild
;
virtual
~
WebGLChild
(
)
;
public
:
mozilla
:
:
ipc
:
:
IPCResult
RecvJsWarning
(
const
std
:
:
string
&
)
const
;
mozilla
:
:
ipc
:
:
IPCResult
RecvOnContextLoss
(
webgl
:
:
ContextLossReason
)
const
;
}
;
}
}
#
endif
