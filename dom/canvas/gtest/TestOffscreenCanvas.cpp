#
include
"
OffscreenCanvasDisplayHelper
.
h
"
#
include
"
gtest
/
gtest
.
h
"
#
include
"
mozilla
/
dom
/
CanvasRenderingContextHelper
.
h
"
#
include
"
mozilla
/
dom
/
WorkerRef
.
h
"
namespace
mozilla
:
:
dom
{
TEST
(
OffscreenCanvasDisplayHelper
UpdateContextPreservesImageContainer
)
{
RefPtr
<
OffscreenCanvasDisplayHelper
>
helper
=
MakeRefPtr
<
OffscreenCanvasDisplayHelper
>
(
nullptr
100
100
)
;
EXPECT_EQ
(
helper
-
>
GetImageContainer
(
)
nullptr
)
;
helper
-
>
UpdateContext
(
nullptr
nullptr
CanvasContextType
:
:
Canvas2D
Nothing
(
)
)
;
RefPtr
<
layers
:
:
ImageContainer
>
container1
=
helper
-
>
GetImageContainer
(
)
;
EXPECT_NE
(
container1
nullptr
)
;
helper
-
>
UpdateContext
(
nullptr
nullptr
CanvasContextType
:
:
Canvas2D
Nothing
(
)
)
;
RefPtr
<
layers
:
:
ImageContainer
>
container2
=
helper
-
>
GetImageContainer
(
)
;
EXPECT_EQ
(
container1
.
get
(
)
container2
.
get
(
)
)
;
}
}
