#
ifndef
WEBGL_CONTEXT_UTILS_H_
#
define
WEBGL_CONTEXT_UTILS_H_
#
include
"
WebGLContext
.
h
"
#
include
"
mozilla
/
Assertions
.
h
"
#
include
"
mozilla
/
dom
/
BindingUtils
.
h
"
#
include
"
WebGLStrongTypes
.
h
"
namespace
mozilla
{
TexTarget
TexImageTargetToTexTarget
(
TexImageTarget
texImageTarget
)
;
JS
:
:
Value
StringValue
(
JSContext
*
cx
const
char
*
str
ErrorResult
&
rv
)
;
struct
GLComponents
{
unsigned
char
mComponents
;
enum
Components
{
Red
=
(
1
<
<
0
)
Green
=
(
1
<
<
1
)
Blue
=
(
1
<
<
2
)
Alpha
=
(
1
<
<
3
)
Stencil
=
(
1
<
<
4
)
Depth
=
(
1
<
<
5
)
}
;
GLComponents
(
)
:
mComponents
(
0
)
{
}
explicit
GLComponents
(
TexInternalFormat
format
)
;
bool
IsSubsetOf
(
const
GLComponents
&
other
)
const
;
}
;
template
<
typename
WebGLObjectType
>
JS
:
:
Value
WebGLContext
:
:
WebGLObjectAsJSValue
(
JSContext
*
cx
const
WebGLObjectType
*
object
ErrorResult
&
rv
)
const
{
if
(
!
object
)
return
JS
:
:
NullValue
(
)
;
MOZ_ASSERT
(
this
=
=
object
-
>
mContext
)
;
JS
:
:
Rooted
<
JS
:
:
Value
>
v
(
cx
)
;
JS
:
:
Rooted
<
JSObject
*
>
wrapper
(
cx
GetWrapper
(
)
)
;
JSAutoRealm
ar
(
cx
wrapper
)
;
if
(
!
dom
:
:
GetOrCreateDOMReflector
(
cx
const_cast
<
WebGLObjectType
*
>
(
object
)
&
v
)
)
{
rv
.
Throw
(
NS_ERROR_FAILURE
)
;
return
JS
:
:
NullValue
(
)
;
}
return
v
;
}
template
<
typename
WebGLObjectType
>
JSObject
*
WebGLContext
:
:
WebGLObjectAsJSObject
(
JSContext
*
cx
const
WebGLObjectType
*
object
ErrorResult
&
rv
)
const
{
JS
:
:
Value
v
=
WebGLObjectAsJSValue
(
cx
object
rv
)
;
if
(
v
.
isNull
(
)
)
return
nullptr
;
return
&
v
.
toObject
(
)
;
}
const
char
*
InfoFrom
(
WebGLTexImageFunc
func
WebGLTexDimensions
dims
)
;
JS
:
:
Value
StringValue
(
JSContext
*
cx
const
nsAString
&
str
ErrorResult
&
er
)
;
}
#
endif
