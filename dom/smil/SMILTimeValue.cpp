#
include
"
SMILTimeValue
.
h
"
#
include
"
nsMathUtils
.
h
"
namespace
mozilla
{
const
SMILTime
SMILTimeValue
:
:
kUnresolvedMillis
=
std
:
:
numeric_limits
<
SMILTime
>
:
:
max
(
)
;
static
inline
int8_t
Cmp
(
int64_t
aA
int64_t
aB
)
{
return
aA
=
=
aB
?
0
:
(
aA
>
aB
?
1
:
-
1
)
;
}
int8_t
SMILTimeValue
:
:
CompareTo
(
const
SMILTimeValue
&
aOther
)
const
{
int8_t
result
;
if
(
mState
=
=
STATE_DEFINITE
)
{
result
=
(
aOther
.
mState
=
=
STATE_DEFINITE
)
?
Cmp
(
mMilliseconds
aOther
.
mMilliseconds
)
:
-
1
;
}
else
if
(
mState
=
=
STATE_INDEFINITE
)
{
if
(
aOther
.
mState
=
=
STATE_DEFINITE
)
result
=
1
;
else
if
(
aOther
.
mState
=
=
STATE_INDEFINITE
)
result
=
0
;
else
result
=
-
1
;
}
else
{
result
=
(
aOther
.
mState
!
=
STATE_UNRESOLVED
)
?
1
:
0
;
}
return
result
;
}
void
SMILTimeValue
:
:
SetMillis
(
double
aMillis
Rounding
aRounding
)
{
mState
=
STATE_DEFINITE
;
mMilliseconds
=
NS_round
(
aMillis
)
;
if
(
aRounding
=
=
Rounding
:
:
EnsureNonZero
&
&
!
mMilliseconds
&
&
aMillis
)
{
mMilliseconds
=
std
:
:
copysign
(
1
.
0
aMillis
)
;
}
}
}
