#
include
"
mozilla
/
dom
/
SVGFEDiffuseLightingElement
.
h
"
#
include
"
mozilla
/
SVGFilterInstance
.
h
"
#
include
"
mozilla
/
dom
/
BindContext
.
h
"
#
include
"
mozilla
/
dom
/
Document
.
h
"
#
include
"
mozilla
/
dom
/
SVGFEDiffuseLightingElementBinding
.
h
"
NS_IMPL_NS_NEW_SVG_ELEMENT
(
FEDiffuseLighting
)
using
namespace
mozilla
:
:
gfx
;
namespace
mozilla
:
:
dom
{
JSObject
*
SVGFEDiffuseLightingElement
:
:
WrapNode
(
JSContext
*
aCx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
{
return
SVGFEDiffuseLightingElement_Binding
:
:
Wrap
(
aCx
this
aGivenProto
)
;
}
NS_IMPL_ELEMENT_CLONE_WITH_INIT
(
SVGFEDiffuseLightingElement
)
already_AddRefed
<
DOMSVGAnimatedString
>
SVGFEDiffuseLightingElement
:
:
In1
(
)
{
return
mStringAttributes
[
IN1
]
.
ToDOMAnimatedString
(
this
)
;
}
already_AddRefed
<
DOMSVGAnimatedNumber
>
SVGFEDiffuseLightingElement
:
:
SurfaceScale
(
)
{
return
mNumberAttributes
[
SURFACE_SCALE
]
.
ToDOMAnimatedNumber
(
this
)
;
}
already_AddRefed
<
DOMSVGAnimatedNumber
>
SVGFEDiffuseLightingElement
:
:
DiffuseConstant
(
)
{
return
mNumberAttributes
[
DIFFUSE_CONSTANT
]
.
ToDOMAnimatedNumber
(
this
)
;
}
already_AddRefed
<
DOMSVGAnimatedNumber
>
SVGFEDiffuseLightingElement
:
:
KernelUnitLengthX
(
)
{
return
mNumberPairAttributes
[
KERNEL_UNIT_LENGTH
]
.
ToDOMAnimatedNumber
(
SVGAnimatedNumberPair
:
:
eFirst
this
)
;
}
already_AddRefed
<
DOMSVGAnimatedNumber
>
SVGFEDiffuseLightingElement
:
:
KernelUnitLengthY
(
)
{
return
mNumberPairAttributes
[
KERNEL_UNIT_LENGTH
]
.
ToDOMAnimatedNumber
(
SVGAnimatedNumberPair
:
:
eSecond
this
)
;
}
FilterPrimitiveDescription
SVGFEDiffuseLightingElement
:
:
GetPrimitiveDescription
(
SVGFilterInstance
*
aInstance
const
IntRect
&
aFilterSubregion
const
nsTArray
<
bool
>
&
aInputsAreTainted
nsTArray
<
RefPtr
<
SourceSurface
>
>
&
aInputImages
)
{
float
diffuseConstant
=
mNumberAttributes
[
DIFFUSE_CONSTANT
]
.
GetAnimValue
(
)
;
DiffuseLightingAttributes
atts
;
atts
.
mLightingConstant
=
diffuseConstant
;
if
(
!
AddLightingAttributes
(
&
atts
aInstance
)
)
{
return
FilterPrimitiveDescription
(
)
;
}
return
FilterPrimitiveDescription
(
AsVariant
(
std
:
:
move
(
atts
)
)
)
;
}
bool
SVGFEDiffuseLightingElement
:
:
AttributeAffectsRendering
(
int32_t
aNameSpaceID
nsAtom
*
aAttribute
)
const
{
return
SVGFEDiffuseLightingElementBase
:
:
AttributeAffectsRendering
(
aNameSpaceID
aAttribute
)
|
|
(
aNameSpaceID
=
=
kNameSpaceID_None
&
&
aAttribute
=
=
nsGkAtoms
:
:
diffuseConstant
)
;
}
nsresult
SVGFEDiffuseLightingElement
:
:
BindToTree
(
BindContext
&
aCtx
nsINode
&
aParent
)
{
if
(
aCtx
.
InComposedDoc
(
)
)
{
aCtx
.
OwnerDoc
(
)
.
SetUseCounter
(
eUseCounter_custom_feDiffuseLighting
)
;
}
return
SVGFEDiffuseLightingElementBase
:
:
BindToTree
(
aCtx
aParent
)
;
}
}
