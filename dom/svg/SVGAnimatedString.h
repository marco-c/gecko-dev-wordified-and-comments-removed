#
ifndef
__NS_SVGSTRING_H__
#
define
__NS_SVGSTRING_H__
#
include
"
DOMSVGAnimatedString
.
h
"
#
include
"
nsAutoPtr
.
h
"
#
include
"
nsError
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
namespace
mozilla
{
class
SMILValue
;
namespace
dom
{
class
SVGElement
;
}
class
SVGAnimatedString
{
public
:
typedef
mozilla
:
:
dom
:
:
SVGElement
SVGElement
;
void
Init
(
uint8_t
aAttrEnum
)
{
mAnimVal
=
nullptr
;
mAttrEnum
=
aAttrEnum
;
mIsBaseSet
=
false
;
}
void
SetBaseValue
(
const
nsAString
&
aValue
SVGElement
*
aSVGElement
bool
aDoSetAttr
)
;
void
GetBaseValue
(
nsAString
&
aValue
const
SVGElement
*
aSVGElement
)
const
{
aSVGElement
-
>
GetStringBaseValue
(
mAttrEnum
aValue
)
;
}
void
SetAnimValue
(
const
nsAString
&
aValue
SVGElement
*
aSVGElement
)
;
void
GetAnimValue
(
nsAString
&
aResult
const
SVGElement
*
aSVGElement
)
const
;
bool
IsExplicitlySet
(
)
const
{
return
!
!
mAnimVal
|
|
mIsBaseSet
;
}
already_AddRefed
<
mozilla
:
:
dom
:
:
DOMSVGAnimatedString
>
ToDOMAnimatedString
(
SVGElement
*
aSVGElement
)
;
mozilla
:
:
UniquePtr
<
SMILAttr
>
ToSMILAttr
(
SVGElement
*
aSVGElement
)
;
private
:
nsAutoPtr
<
nsString
>
mAnimVal
;
uint8_t
mAttrEnum
;
bool
mIsBaseSet
;
public
:
struct
DOMAnimatedString
final
:
public
mozilla
:
:
dom
:
:
DOMSVGAnimatedString
{
NS_DECL_CYCLE_COLLECTING_ISUPPORTS
NS_DECL_CYCLE_COLLECTION_SCRIPT_HOLDER_CLASS
(
DOMAnimatedString
)
DOMAnimatedString
(
SVGAnimatedString
*
aVal
SVGElement
*
aSVGElement
)
:
mozilla
:
:
dom
:
:
DOMSVGAnimatedString
(
aSVGElement
)
mVal
(
aVal
)
{
}
SVGAnimatedString
*
mVal
;
void
GetBaseVal
(
nsAString
&
aResult
)
override
{
mVal
-
>
GetBaseValue
(
aResult
mSVGElement
)
;
}
void
SetBaseVal
(
const
nsAString
&
aValue
)
override
{
mVal
-
>
SetBaseValue
(
aValue
mSVGElement
true
)
;
}
void
GetAnimVal
(
nsAString
&
aResult
)
override
{
mSVGElement
-
>
FlushAnimations
(
)
;
mVal
-
>
GetAnimValue
(
aResult
mSVGElement
)
;
}
private
:
virtual
~
DOMAnimatedString
(
)
;
}
;
struct
SMILString
:
public
SMILAttr
{
public
:
SMILString
(
SVGAnimatedString
*
aVal
SVGElement
*
aSVGElement
)
:
mVal
(
aVal
)
mSVGElement
(
aSVGElement
)
{
}
SVGAnimatedString
*
mVal
;
SVGElement
*
mSVGElement
;
virtual
nsresult
ValueFromString
(
const
nsAString
&
aStr
const
mozilla
:
:
dom
:
:
SVGAnimationElement
*
aSrcElement
SMILValue
&
aValue
bool
&
aPreventCachingOfSandwich
)
const
override
;
virtual
SMILValue
GetBaseValue
(
)
const
override
;
virtual
void
ClearAnimValue
(
)
override
;
virtual
nsresult
SetAnimValue
(
const
SMILValue
&
aValue
)
override
;
}
;
}
;
}
#
endif
