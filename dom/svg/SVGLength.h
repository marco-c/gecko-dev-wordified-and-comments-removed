#
ifndef
DOM_SVG_SVGLENGTH_H_
#
define
DOM_SVG_SVGLENGTH_H_
#
include
"
nsDebug
.
h
"
#
include
"
nsMathUtils
.
h
"
#
include
"
mozilla
/
FloatingPoint
.
h
"
#
include
"
mozilla
/
dom
/
SVGAnimatedLength
.
h
"
#
include
"
mozilla
/
dom
/
SVGLengthBinding
.
h
"
namespace
mozilla
{
namespace
dom
{
class
SVGElement
;
}
class
SVGLength
{
public
:
SVGLength
(
)
:
mValue
(
0
.
0f
)
mUnit
(
dom
:
:
SVGLength_Binding
:
:
SVG_LENGTHTYPE_UNKNOWN
)
{
}
SVGLength
(
float
aValue
uint8_t
aUnit
)
:
mValue
(
aValue
)
mUnit
(
aUnit
)
{
NS_ASSERTION
(
IsValid
(
)
"
Constructed
an
invalid
length
"
)
;
}
bool
operator
=
=
(
const
SVGLength
&
rhs
)
const
{
return
mValue
=
=
rhs
.
mValue
&
&
mUnit
=
=
rhs
.
mUnit
;
}
void
GetValueAsString
(
nsAString
&
aValue
)
const
;
bool
SetValueFromString
(
const
nsAString
&
aString
)
;
float
GetValueInCurrentUnits
(
)
const
{
return
mValue
;
}
uint8_t
GetUnit
(
)
const
{
return
mUnit
;
}
void
SetValueInCurrentUnits
(
float
aValue
)
{
mValue
=
aValue
;
NS_ASSERTION
(
IsValid
(
)
"
Set
invalid
SVGLength
"
)
;
}
void
SetValueAndUnit
(
float
aValue
uint8_t
aUnit
)
{
mValue
=
aValue
;
mUnit
=
aUnit
;
NS_ASSERTION
(
IsValidUnitType
(
mUnit
)
"
Set
invalid
SVGLength
"
)
;
}
float
GetValueInPixels
(
const
dom
:
:
SVGElement
*
aElement
uint8_t
aAxis
)
const
{
return
mValue
*
GetPixelsPerUnit
(
dom
:
:
SVGElementMetrics
(
const_cast
<
dom
:
:
SVGElement
*
>
(
aElement
)
)
aAxis
)
;
}
float
GetValueInSpecifiedUnit
(
uint8_t
aUnit
const
dom
:
:
SVGElement
*
aElement
uint8_t
aAxis
)
const
;
bool
IsPercentage
(
)
const
{
return
mUnit
=
=
dom
:
:
SVGLength_Binding
:
:
SVG_LENGTHTYPE_PERCENTAGE
;
}
float
GetPixelsPerUnit
(
const
dom
:
:
UserSpaceMetrics
&
aMetrics
uint8_t
aAxis
)
const
{
return
GetPixelsPerUnit
(
aMetrics
mUnit
aAxis
)
;
}
static
bool
IsValidUnitType
(
uint16_t
aUnitType
)
{
return
aUnitType
>
dom
:
:
SVGLength_Binding
:
:
SVG_LENGTHTYPE_UNKNOWN
&
&
aUnitType
<
=
dom
:
:
SVGLength_Binding
:
:
SVG_LENGTHTYPE_PC
;
}
static
bool
IsAbsoluteUnit
(
uint8_t
aUnit
)
;
static
float
GetAbsUnitsPerAbsUnit
(
uint8_t
aUnits
uint8_t
aPerUnit
)
;
static
void
GetUnitString
(
nsAString
&
aUnit
uint16_t
aUnitType
)
;
static
uint16_t
GetUnitTypeForString
(
const
nsAString
&
aUnit
)
;
static
float
GetPixelsPerUnit
(
const
dom
:
:
UserSpaceMetrics
&
aMetrics
uint8_t
aUnitType
uint8_t
aAxis
)
;
private
:
#
ifdef
DEBUG
bool
IsValid
(
)
const
{
return
std
:
:
isfinite
(
mValue
)
&
&
IsValidUnitType
(
mUnit
)
;
}
#
endif
float
mValue
;
uint8_t
mUnit
;
}
;
}
#
endif
