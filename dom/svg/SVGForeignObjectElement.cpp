#
include
"
mozilla
/
dom
/
SVGForeignObjectElement
.
h
"
#
include
"
mozilla
/
AlreadyAddRefed
.
h
"
#
include
"
mozilla
/
ArrayUtils
.
h
"
#
include
"
mozilla
/
dom
/
SVGDocument
.
h
"
#
include
"
mozilla
/
dom
/
SVGForeignObjectElementBinding
.
h
"
#
include
"
mozilla
/
dom
/
SVGLengthBinding
.
h
"
#
include
"
SVGGeometryProperty
.
h
"
NS_IMPL_NS_NEW_SVG_ELEMENT
(
ForeignObject
)
namespace
mozilla
{
namespace
dom
{
JSObject
*
SVGForeignObjectElement
:
:
WrapNode
(
JSContext
*
aCx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
{
return
SVGForeignObjectElement_Binding
:
:
Wrap
(
aCx
this
aGivenProto
)
;
}
SVGElement
:
:
LengthInfo
SVGForeignObjectElement
:
:
sLengthInfo
[
4
]
=
{
{
nsGkAtoms
:
:
x
0
SVGLength_Binding
:
:
SVG_LENGTHTYPE_NUMBER
SVGContentUtils
:
:
X
}
{
nsGkAtoms
:
:
y
0
SVGLength_Binding
:
:
SVG_LENGTHTYPE_NUMBER
SVGContentUtils
:
:
Y
}
{
nsGkAtoms
:
:
width
0
SVGLength_Binding
:
:
SVG_LENGTHTYPE_NUMBER
SVGContentUtils
:
:
X
}
{
nsGkAtoms
:
:
height
0
SVGLength_Binding
:
:
SVG_LENGTHTYPE_NUMBER
SVGContentUtils
:
:
Y
}
}
;
SVGForeignObjectElement
:
:
SVGForeignObjectElement
(
already_AddRefed
<
mozilla
:
:
dom
:
:
NodeInfo
>
&
&
aNodeInfo
)
:
SVGGraphicsElement
(
std
:
:
move
(
aNodeInfo
)
)
{
}
namespace
SVGT
=
SVGGeometryProperty
:
:
Tags
;
NS_IMPL_ELEMENT_CLONE_WITH_INIT
(
SVGForeignObjectElement
)
already_AddRefed
<
DOMSVGAnimatedLength
>
SVGForeignObjectElement
:
:
X
(
)
{
return
mLengthAttributes
[
ATTR_X
]
.
ToDOMAnimatedLength
(
this
)
;
}
already_AddRefed
<
DOMSVGAnimatedLength
>
SVGForeignObjectElement
:
:
Y
(
)
{
return
mLengthAttributes
[
ATTR_Y
]
.
ToDOMAnimatedLength
(
this
)
;
}
already_AddRefed
<
DOMSVGAnimatedLength
>
SVGForeignObjectElement
:
:
Width
(
)
{
return
mLengthAttributes
[
ATTR_WIDTH
]
.
ToDOMAnimatedLength
(
this
)
;
}
already_AddRefed
<
DOMSVGAnimatedLength
>
SVGForeignObjectElement
:
:
Height
(
)
{
return
mLengthAttributes
[
ATTR_HEIGHT
]
.
ToDOMAnimatedLength
(
this
)
;
}
gfxMatrix
SVGForeignObjectElement
:
:
PrependLocalTransformsTo
(
const
gfxMatrix
&
aMatrix
SVGTransformTypes
aWhich
)
const
{
gfxMatrix
fromUserSpace
=
SVGGraphicsElement
:
:
PrependLocalTransformsTo
(
aMatrix
aWhich
)
;
if
(
aWhich
=
=
eUserSpaceToParent
)
{
return
fromUserSpace
;
}
float
x
y
;
if
(
!
SVGGeometryProperty
:
:
ResolveAll
<
SVGT
:
:
X
SVGT
:
:
Y
>
(
this
&
x
&
y
)
)
{
const_cast
<
SVGForeignObjectElement
*
>
(
this
)
-
>
GetAnimatedLengthValues
(
&
x
&
y
nullptr
)
;
}
gfxMatrix
toUserSpace
=
gfxMatrix
:
:
Translation
(
x
y
)
;
if
(
aWhich
=
=
eChildToUserSpace
)
{
return
toUserSpace
*
aMatrix
;
}
MOZ_ASSERT
(
aWhich
=
=
eAllTransforms
"
Unknown
TransformTypes
"
)
;
return
toUserSpace
*
fromUserSpace
;
}
bool
SVGForeignObjectElement
:
:
HasValidDimensions
(
)
const
{
float
width
height
;
MOZ_ASSERT
(
GetPrimaryFrame
(
)
)
;
SVGGeometryProperty
:
:
ResolveAll
<
SVGT
:
:
Width
SVGT
:
:
Height
>
(
const_cast
<
SVGForeignObjectElement
*
>
(
this
)
&
width
&
height
)
;
return
width
>
0
&
&
height
>
0
;
}
NS_IMETHODIMP_
(
bool
)
SVGForeignObjectElement
:
:
IsAttributeMapped
(
const
nsAtom
*
name
)
const
{
static
const
MappedAttributeEntry
*
const
map
[
]
=
{
sFEFloodMap
sFiltersMap
sFontSpecificationMap
sGradientStopMap
sLightingEffectsMap
sMarkersMap
sTextContentElementsMap
sViewportsMap
}
;
return
IsInLengthInfo
(
name
sLengthInfo
)
|
|
FindAttributeDependence
(
name
map
)
|
|
SVGGraphicsElement
:
:
IsAttributeMapped
(
name
)
;
}
SVGElement
:
:
LengthAttributesInfo
SVGForeignObjectElement
:
:
GetLengthInfo
(
)
{
return
LengthAttributesInfo
(
mLengthAttributes
sLengthInfo
ArrayLength
(
sLengthInfo
)
)
;
}
nsCSSPropertyID
SVGForeignObjectElement
:
:
GetCSSPropertyIdForAttrEnum
(
uint8_t
aAttrEnum
)
{
switch
(
aAttrEnum
)
{
case
ATTR_X
:
return
eCSSProperty_x
;
case
ATTR_Y
:
return
eCSSProperty_y
;
case
ATTR_WIDTH
:
return
eCSSProperty_width
;
case
ATTR_HEIGHT
:
return
eCSSProperty_height
;
default
:
MOZ_ASSERT_UNREACHABLE
(
"
Unknown
attr
enum
"
)
;
return
eCSSProperty_UNKNOWN
;
}
}
}
}
