#
ifndef
mozilla_dom_SVGMarkerElement_h
#
define
mozilla_dom_SVGMarkerElement_h
#
include
"
nsAutoPtr
.
h
"
#
include
"
nsSVGAngle
.
h
"
#
include
"
nsSVGEnum
.
h
"
#
include
"
nsSVGLength2
.
h
"
#
include
"
nsSVGViewBox
.
h
"
#
include
"
SVGAnimatedPreserveAspectRatio
.
h
"
#
include
"
nsSVGElement
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
dom
/
SVGAnimatedEnumeration
.
h
"
#
include
"
mozilla
/
dom
/
SVGMarkerElementBinding
.
h
"
class
nsSVGMarkerFrame
;
struct
nsSVGMark
;
nsresult
NS_NewSVGMarkerElement
(
nsIContent
*
*
aResult
already_AddRefed
<
mozilla
:
:
dom
:
:
NodeInfo
>
&
&
aNodeInfo
)
;
namespace
mozilla
{
namespace
dom
{
static
const
uint16_t
SVG_MARKER_ORIENT_AUTO_START_REVERSE
=
3
;
class
nsSVGOrientType
{
public
:
nsSVGOrientType
(
)
:
mAnimVal
(
SVGMarkerElement_Binding
:
:
SVG_MARKER_ORIENT_ANGLE
)
mBaseVal
(
SVGMarkerElement_Binding
:
:
SVG_MARKER_ORIENT_ANGLE
)
{
}
nsresult
SetBaseValue
(
uint16_t
aValue
nsSVGElement
*
aSVGElement
)
;
void
SetBaseValue
(
uint16_t
aValue
)
{
mAnimVal
=
mBaseVal
=
uint8_t
(
aValue
)
;
}
void
SetAnimValue
(
uint16_t
aValue
)
{
mAnimVal
=
uint8_t
(
aValue
)
;
}
uint16_t
GetBaseValue
(
)
const
{
return
mAnimVal
=
=
SVG_MARKER_ORIENT_AUTO_START_REVERSE
?
SVGMarkerElement_Binding
:
:
SVG_MARKER_ORIENT_UNKNOWN
:
mBaseVal
;
}
uint16_t
GetAnimValue
(
)
const
{
return
mAnimVal
=
=
SVG_MARKER_ORIENT_AUTO_START_REVERSE
?
SVGMarkerElement_Binding
:
:
SVG_MARKER_ORIENT_UNKNOWN
:
mAnimVal
;
}
uint16_t
GetAnimValueInternal
(
)
const
{
return
mAnimVal
;
}
already_AddRefed
<
SVGAnimatedEnumeration
>
ToDOMAnimatedEnum
(
nsSVGElement
*
aSVGElement
)
;
private
:
nsSVGEnumValue
mAnimVal
;
nsSVGEnumValue
mBaseVal
;
struct
DOMAnimatedEnum
final
:
public
SVGAnimatedEnumeration
{
DOMAnimatedEnum
(
nsSVGOrientType
*
aVal
nsSVGElement
*
aSVGElement
)
:
SVGAnimatedEnumeration
(
aSVGElement
)
mVal
(
aVal
)
{
}
nsSVGOrientType
*
mVal
;
using
mozilla
:
:
dom
:
:
SVGAnimatedEnumeration
:
:
SetBaseVal
;
virtual
uint16_t
BaseVal
(
)
override
{
return
mVal
-
>
GetBaseValue
(
)
;
}
virtual
void
SetBaseVal
(
uint16_t
aBaseVal
ErrorResult
&
aRv
)
override
{
aRv
=
mVal
-
>
SetBaseValue
(
aBaseVal
mSVGElement
)
;
}
virtual
uint16_t
AnimVal
(
)
override
{
return
mVal
-
>
GetAnimValue
(
)
;
}
}
;
}
;
typedef
nsSVGElement
SVGMarkerElementBase
;
class
SVGMarkerElement
:
public
SVGMarkerElementBase
{
friend
class
:
:
nsSVGMarkerFrame
;
protected
:
friend
nsresult
(
:
:
NS_NewSVGMarkerElement
(
nsIContent
*
*
aResult
already_AddRefed
<
mozilla
:
:
dom
:
:
NodeInfo
>
&
&
aNodeInfo
)
)
;
explicit
SVGMarkerElement
(
already_AddRefed
<
mozilla
:
:
dom
:
:
NodeInfo
>
&
aNodeInfo
)
;
virtual
JSObject
*
WrapNode
(
JSContext
*
cx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
override
;
public
:
NS_IMETHOD_
(
bool
)
IsAttributeMapped
(
const
nsAtom
*
name
)
const
override
;
virtual
nsresult
AfterSetAttr
(
int32_t
aNamespaceID
nsAtom
*
aName
const
nsAttrValue
*
aValue
const
nsAttrValue
*
aOldValue
nsIPrincipal
*
aMaybeScriptedPrincipal
bool
aNotify
)
override
;
virtual
bool
HasValidDimensions
(
)
const
override
;
gfx
:
:
Matrix
GetMarkerTransform
(
float
aStrokeWidth
const
nsSVGMark
&
aMark
)
;
nsSVGViewBoxRect
GetViewBoxRect
(
)
;
gfx
:
:
Matrix
GetViewBoxTransform
(
)
;
virtual
nsresult
Clone
(
mozilla
:
:
dom
:
:
NodeInfo
*
aNodeInfo
nsINode
*
*
aResult
bool
aPreallocateChildren
)
const
override
;
nsSVGOrientType
*
GetOrientType
(
)
{
return
&
mOrientType
;
}
already_AddRefed
<
SVGAnimatedRect
>
ViewBox
(
)
;
already_AddRefed
<
DOMSVGAnimatedPreserveAspectRatio
>
PreserveAspectRatio
(
)
;
already_AddRefed
<
SVGAnimatedLength
>
RefX
(
)
;
already_AddRefed
<
SVGAnimatedLength
>
RefY
(
)
;
already_AddRefed
<
SVGAnimatedEnumeration
>
MarkerUnits
(
)
;
already_AddRefed
<
SVGAnimatedLength
>
MarkerWidth
(
)
;
already_AddRefed
<
SVGAnimatedLength
>
MarkerHeight
(
)
;
already_AddRefed
<
SVGAnimatedEnumeration
>
OrientType
(
)
;
already_AddRefed
<
SVGAnimatedAngle
>
OrientAngle
(
)
;
void
SetOrientToAuto
(
)
;
void
SetOrientToAngle
(
SVGAngle
&
angle
ErrorResult
&
rv
)
;
protected
:
virtual
bool
ParseAttribute
(
int32_t
aNameSpaceID
nsAtom
*
aName
const
nsAString
&
aValue
nsIPrincipal
*
aMaybeScriptedPrincipal
nsAttrValue
&
aResult
)
override
;
void
SetParentCoordCtxProvider
(
SVGViewportElement
*
aContext
)
;
virtual
LengthAttributesInfo
GetLengthInfo
(
)
override
;
virtual
AngleAttributesInfo
GetAngleInfo
(
)
override
;
virtual
EnumAttributesInfo
GetEnumInfo
(
)
override
;
virtual
nsSVGViewBox
*
GetViewBox
(
)
override
;
virtual
SVGAnimatedPreserveAspectRatio
*
GetPreserveAspectRatio
(
)
override
;
enum
{
REFX
REFY
MARKERWIDTH
MARKERHEIGHT
}
;
nsSVGLength2
mLengthAttributes
[
4
]
;
static
LengthInfo
sLengthInfo
[
4
]
;
enum
{
MARKERUNITS
}
;
nsSVGEnum
mEnumAttributes
[
1
]
;
static
nsSVGEnumMapping
sUnitsMap
[
]
;
static
EnumInfo
sEnumInfo
[
1
]
;
enum
{
ORIENT
}
;
nsSVGAngle
mAngleAttributes
[
1
]
;
static
AngleInfo
sAngleInfo
[
1
]
;
nsSVGViewBox
mViewBox
;
SVGAnimatedPreserveAspectRatio
mPreserveAspectRatio
;
nsSVGOrientType
mOrientType
;
SVGViewportElement
*
mCoordCtx
;
nsAutoPtr
<
gfx
:
:
Matrix
>
mViewBoxToViewportTransform
;
}
;
}
}
#
endif
