#
ifndef
__NS_SVGENUM_H__
#
define
__NS_SVGENUM_H__
#
include
"
nsCycleCollectionParticipant
.
h
"
#
include
"
nsError
.
h
"
#
include
"
nsISMILAttr
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
mozilla
/
dom
/
SVGAnimatedEnumeration
.
h
"
#
include
"
mozilla
/
dom
/
SVGElement
.
h
"
class
nsAtom
;
namespace
mozilla
{
class
SMILValue
;
namespace
dom
{
class
SVGAnimationElement
;
}
typedef
uint8_t
SVGEnumValue
;
struct
SVGEnumMapping
{
nsStaticAtom
*
const
mKey
;
const
SVGEnumValue
mVal
;
}
;
class
SVGEnum
{
public
:
typedef
mozilla
:
:
dom
:
:
SVGElement
SVGElement
;
void
Init
(
uint8_t
aAttrEnum
uint16_t
aValue
)
{
mAnimVal
=
mBaseVal
=
uint8_t
(
aValue
)
;
mAttrEnum
=
aAttrEnum
;
mIsAnimated
=
false
;
mIsBaseSet
=
false
;
}
nsresult
SetBaseValueAtom
(
const
nsAtom
*
aValue
SVGElement
*
aSVGElement
)
;
nsAtom
*
GetBaseValueAtom
(
SVGElement
*
aSVGElement
)
;
nsresult
SetBaseValue
(
uint16_t
aValue
SVGElement
*
aSVGElement
)
;
uint16_t
GetBaseValue
(
)
const
{
return
mBaseVal
;
}
void
SetAnimValue
(
uint16_t
aValue
SVGElement
*
aSVGElement
)
;
uint16_t
GetAnimValue
(
)
const
{
return
mAnimVal
;
}
bool
IsExplicitlySet
(
)
const
{
return
mIsAnimated
|
|
mIsBaseSet
;
}
already_AddRefed
<
mozilla
:
:
dom
:
:
SVGAnimatedEnumeration
>
ToDOMAnimatedEnum
(
SVGElement
*
aSVGElement
)
;
mozilla
:
:
UniquePtr
<
nsISMILAttr
>
ToSMILAttr
(
SVGElement
*
aSVGElement
)
;
private
:
SVGEnumValue
mAnimVal
;
SVGEnumValue
mBaseVal
;
uint8_t
mAttrEnum
;
bool
mIsAnimated
;
bool
mIsBaseSet
;
const
SVGEnumMapping
*
GetMapping
(
SVGElement
*
aSVGElement
)
;
public
:
struct
DOMAnimatedEnum
final
:
public
mozilla
:
:
dom
:
:
SVGAnimatedEnumeration
{
DOMAnimatedEnum
(
SVGEnum
*
aVal
SVGElement
*
aSVGElement
)
:
mozilla
:
:
dom
:
:
SVGAnimatedEnumeration
(
aSVGElement
)
mVal
(
aVal
)
{
}
virtual
~
DOMAnimatedEnum
(
)
;
SVGEnum
*
mVal
;
using
mozilla
:
:
dom
:
:
SVGAnimatedEnumeration
:
:
SetBaseVal
;
virtual
uint16_t
BaseVal
(
)
override
{
return
mVal
-
>
GetBaseValue
(
)
;
}
virtual
void
SetBaseVal
(
uint16_t
aBaseVal
mozilla
:
:
ErrorResult
&
aRv
)
override
{
aRv
=
mVal
-
>
SetBaseValue
(
aBaseVal
mSVGElement
)
;
}
virtual
uint16_t
AnimVal
(
)
override
{
mSVGElement
-
>
FlushAnimations
(
)
;
return
mVal
-
>
GetAnimValue
(
)
;
}
}
;
struct
SMILEnum
:
public
nsISMILAttr
{
public
:
SMILEnum
(
SVGEnum
*
aVal
SVGElement
*
aSVGElement
)
:
mVal
(
aVal
)
mSVGElement
(
aSVGElement
)
{
}
SVGEnum
*
mVal
;
SVGElement
*
mSVGElement
;
virtual
nsresult
ValueFromString
(
const
nsAString
&
aStr
const
mozilla
:
:
dom
:
:
SVGAnimationElement
*
aSrcElement
SMILValue
&
aValue
bool
&
aPreventCachingOfSandwich
)
const
override
;
virtual
SMILValue
GetBaseValue
(
)
const
override
;
virtual
void
ClearAnimValue
(
)
override
;
virtual
nsresult
SetAnimValue
(
const
SMILValue
&
aValue
)
override
;
}
;
}
;
}
#
endif
