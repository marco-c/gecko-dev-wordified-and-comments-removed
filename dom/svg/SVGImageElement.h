#
ifndef
DOM_SVG_SVGIMAGEELEMENT_H_
#
define
DOM_SVG_SVGIMAGEELEMENT_H_
#
include
"
nsImageLoadingContent
.
h
"
#
include
"
mozilla
/
dom
/
SVGAnimatedLength
.
h
"
#
include
"
mozilla
/
dom
/
SVGAnimatedString
.
h
"
#
include
"
mozilla
/
dom
/
SVGGeometryElement
.
h
"
#
include
"
mozilla
/
dom
/
SVGAnimatedPreserveAspectRatio
.
h
"
nsresult
NS_NewSVGImageElement
(
nsIContent
*
*
aResult
already_AddRefed
<
mozilla
:
:
dom
:
:
NodeInfo
>
&
&
aNodeInfo
)
;
namespace
mozilla
{
class
SVGImageFrame
;
namespace
dom
{
class
DOMSVGAnimatedPreserveAspectRatio
;
using
SVGImageElementBase
=
SVGGeometryElement
;
class
SVGImageElement
final
:
public
SVGImageElementBase
public
nsImageLoadingContent
{
friend
class
mozilla
:
:
SVGImageFrame
;
protected
:
explicit
SVGImageElement
(
already_AddRefed
<
mozilla
:
:
dom
:
:
NodeInfo
>
&
&
aNodeInfo
)
;
virtual
~
SVGImageElement
(
)
;
JSObject
*
WrapNode
(
JSContext
*
aCx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
override
;
friend
nsresult
(
:
:
NS_NewSVGImageElement
(
nsIContent
*
*
aResult
already_AddRefed
<
mozilla
:
:
dom
:
:
NodeInfo
>
&
&
aNodeInfo
)
)
;
public
:
NS_DECL_ISUPPORTS_INHERITED
void
AsyncEventRunning
(
AsyncEventDispatcher
*
aEvent
)
override
;
CORSMode
GetCORSMode
(
)
override
;
bool
ParseAttribute
(
int32_t
aNamespaceID
nsAtom
*
aAttribute
const
nsAString
&
aValue
nsIPrincipal
*
aMaybeScriptedPrincipal
nsAttrValue
&
aResult
)
override
;
void
AfterSetAttr
(
int32_t
aNamespaceID
nsAtom
*
aName
const
nsAttrValue
*
aValue
const
nsAttrValue
*
aOldValue
nsIPrincipal
*
aSubjectPrincipal
bool
aNotify
)
override
;
bool
IsSVGGeometryElement
(
)
const
final
{
return
false
;
}
nsresult
BindToTree
(
BindContext
&
nsINode
&
aParent
)
override
;
void
UnbindFromTree
(
bool
aNullParent
)
override
;
ElementState
IntrinsicState
(
)
const
override
;
void
DestroyContent
(
)
override
;
NS_IMETHOD_
(
bool
)
IsAttributeMapped
(
const
nsAtom
*
name
)
const
override
;
bool
GetGeometryBounds
(
Rect
*
aBounds
const
StrokeOptions
&
aStrokeOptions
const
Matrix
&
aToBoundsSpace
const
Matrix
*
aToNonScalingStrokeSpace
=
nullptr
)
override
{
*
aBounds
=
GeometryBounds
(
aToBoundsSpace
)
;
return
true
;
}
already_AddRefed
<
Path
>
BuildPath
(
PathBuilder
*
aBuilder
)
override
;
bool
HasValidDimensions
(
)
const
override
;
nsresult
Clone
(
dom
:
:
NodeInfo
*
nsINode
*
*
aResult
)
const
override
;
void
MaybeLoadSVGImage
(
)
;
already_AddRefed
<
DOMSVGAnimatedLength
>
X
(
)
;
already_AddRefed
<
DOMSVGAnimatedLength
>
Y
(
)
;
already_AddRefed
<
DOMSVGAnimatedLength
>
Width
(
)
;
already_AddRefed
<
DOMSVGAnimatedLength
>
Height
(
)
;
already_AddRefed
<
DOMSVGAnimatedPreserveAspectRatio
>
PreserveAspectRatio
(
)
;
already_AddRefed
<
DOMSVGAnimatedString
>
Href
(
)
;
void
GetCrossOrigin
(
nsAString
&
aCrossOrigin
)
{
GetEnumAttr
(
nsGkAtoms
:
:
crossorigin
nullptr
aCrossOrigin
)
;
}
void
SetCrossOrigin
(
const
nsAString
&
aCrossOrigin
ErrorResult
&
aError
)
{
SetOrRemoveNullableStringAttr
(
nsGkAtoms
:
:
crossorigin
aCrossOrigin
aError
)
;
}
void
SetDecoding
(
const
nsAString
&
aDecoding
ErrorResult
&
aError
)
{
SetAttr
(
nsGkAtoms
:
:
decoding
aDecoding
aError
)
;
}
void
GetDecoding
(
nsAString
&
aValue
)
;
already_AddRefed
<
Promise
>
Decode
(
ErrorResult
&
aRv
)
;
static
nsCSSPropertyID
GetCSSPropertyIdForAttrEnum
(
uint8_t
aAttrEnum
)
;
gfx
:
:
Rect
GeometryBounds
(
const
gfx
:
:
Matrix
&
aToBoundsSpace
)
;
protected
:
nsresult
LoadSVGImage
(
bool
aForce
bool
aNotify
)
;
bool
ShouldLoadImage
(
)
const
;
LengthAttributesInfo
GetLengthInfo
(
)
override
;
SVGAnimatedPreserveAspectRatio
*
GetAnimatedPreserveAspectRatio
(
)
override
;
StringAttributesInfo
GetStringInfo
(
)
override
;
nsIContent
*
AsContent
(
)
override
{
return
this
;
}
enum
{
ATTR_X
ATTR_Y
ATTR_WIDTH
ATTR_HEIGHT
}
;
SVGAnimatedLength
mLengthAttributes
[
4
]
;
static
LengthInfo
sLengthInfo
[
4
]
;
SVGAnimatedPreserveAspectRatio
mPreserveAspectRatio
;
enum
{
HREF
XLINK_HREF
}
;
SVGAnimatedString
mStringAttributes
[
2
]
;
static
StringInfo
sStringInfo
[
2
]
;
}
;
}
}
#
endif
