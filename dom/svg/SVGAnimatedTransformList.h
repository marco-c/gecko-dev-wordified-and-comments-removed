#
ifndef
MOZILLA_SVGANIMATEDTRANSFORMLIST_H__
#
define
MOZILLA_SVGANIMATEDTRANSFORMLIST_H__
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
SMILAttr
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
nsAutoPtr
.
h
"
#
include
"
SVGTransformList
.
h
"
class
nsAtom
;
namespace
mozilla
{
class
SMILValue
;
namespace
dom
{
class
SVGAnimationElement
;
class
SVGElement
;
class
DOMSVGTransform
;
}
class
SVGAnimatedTransformList
{
friend
class
dom
:
:
DOMSVGTransform
;
friend
class
DOMSVGTransformList
;
public
:
SVGAnimatedTransformList
(
)
:
mIsAttrSet
(
false
)
mRequiresFrameReconstruction
(
true
)
{
}
const
SVGTransformList
&
GetBaseValue
(
)
const
{
return
mBaseVal
;
}
nsresult
SetBaseValue
(
const
SVGTransformList
&
aValue
dom
:
:
SVGElement
*
aSVGElement
)
;
nsresult
SetBaseValueString
(
const
nsAString
&
aValue
dom
:
:
SVGElement
*
aSVGElement
)
;
void
ClearBaseValue
(
)
;
const
SVGTransformList
&
GetAnimValue
(
)
const
{
return
mAnimVal
?
*
mAnimVal
:
mBaseVal
;
}
nsresult
SetAnimValue
(
const
SVGTransformList
&
aNewAnimValue
dom
:
:
SVGElement
*
aElement
)
;
void
ClearAnimValue
(
dom
:
:
SVGElement
*
aElement
)
;
bool
IsExplicitlySet
(
)
const
;
bool
HasTransform
(
)
const
{
return
(
mAnimVal
&
&
!
mAnimVal
-
>
IsEmpty
(
)
)
|
|
!
mBaseVal
.
IsEmpty
(
)
;
}
bool
IsAnimating
(
)
const
{
return
!
!
mAnimVal
;
}
bool
RequiresFrameReconstruction
(
)
const
{
return
mRequiresFrameReconstruction
;
}
mozilla
:
:
UniquePtr
<
SMILAttr
>
ToSMILAttr
(
dom
:
:
SVGElement
*
aSVGElement
)
;
private
:
SVGTransformList
mBaseVal
;
nsAutoPtr
<
SVGTransformList
>
mAnimVal
;
bool
mIsAttrSet
;
bool
mRequiresFrameReconstruction
;
struct
SMILAnimatedTransformList
:
public
SMILAttr
{
public
:
SMILAnimatedTransformList
(
SVGAnimatedTransformList
*
aVal
dom
:
:
SVGElement
*
aSVGElement
)
:
mVal
(
aVal
)
mElement
(
aSVGElement
)
{
}
virtual
nsresult
ValueFromString
(
const
nsAString
&
aStr
const
dom
:
:
SVGAnimationElement
*
aSrcElement
SMILValue
&
aValue
bool
&
aPreventCachingOfSandwich
)
const
override
;
virtual
SMILValue
GetBaseValue
(
)
const
override
;
virtual
void
ClearAnimValue
(
)
override
;
virtual
nsresult
SetAnimValue
(
const
SMILValue
&
aValue
)
override
;
protected
:
static
void
ParseValue
(
const
nsAString
&
aSpec
const
nsAtom
*
aTransformType
SMILValue
&
aResult
)
;
static
int32_t
ParseParameterList
(
const
nsAString
&
aSpec
float
*
aVars
int32_t
aNVars
)
;
SVGAnimatedTransformList
*
mVal
;
dom
:
:
SVGElement
*
mElement
;
}
;
}
;
}
#
endif
