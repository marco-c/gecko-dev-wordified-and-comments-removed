#
ifndef
moz_dom_ServiceWorkerProxy_h
#
define
moz_dom_ServiceWorkerProxy_h
#
include
"
nsProxyRelease
.
h
"
#
include
"
ServiceWorkerDescriptor
.
h
"
namespace
mozilla
{
namespace
dom
{
class
ServiceWorkerCloneData
;
class
ServiceWorkerInfo
;
class
ServiceWorkerParent
;
class
ServiceWorkerProxy
final
{
ServiceWorkerParent
*
mActor
;
nsCOMPtr
<
nsISerialEventTarget
>
mEventTarget
;
ServiceWorkerDescriptor
mDescriptor
;
nsMainThreadPtrHandle
<
ServiceWorkerInfo
>
mInfo
;
~
ServiceWorkerProxy
(
)
;
void
MaybeShutdownOnBGThread
(
)
;
void
SetStateOnBGThread
(
ServiceWorkerState
aState
)
;
void
InitOnMainThread
(
)
;
void
MaybeShutdownOnMainThread
(
)
;
void
StopListeningOnMainThread
(
)
;
public
:
explicit
ServiceWorkerProxy
(
const
ServiceWorkerDescriptor
&
aDescriptor
)
;
void
Init
(
ServiceWorkerParent
*
aActor
)
;
void
RevokeActor
(
ServiceWorkerParent
*
aActor
)
;
void
PostMessage
(
RefPtr
<
ServiceWorkerCloneData
>
&
&
aData
const
ClientInfo
&
aClientInfo
const
ClientState
&
aState
)
;
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
ServiceWorkerProxy
)
;
}
;
}
}
#
endif
