onmessage
=
function
(
e
)
{
self
.
registration
.
update
(
)
.
then
(
function
(
v
)
{
return
v
instanceof
ServiceWorkerRegistration
?
"
FINISH
"
:
"
FAIL
"
;
}
)
.
catch
(
function
(
ex
)
{
return
"
FAIL
"
;
}
)
.
then
(
function
(
result
)
{
clients
.
matchAll
(
)
.
then
(
function
(
c
)
{
if
(
c
.
length
=
=
0
)
{
dump
(
"
!
!
!
!
!
!
!
!
!
!
!
WORKER
HAS
NO
CLIENTS
TO
FINISH
TEST
!
!
!
!
!
!
!
!
!
!
!
!
\
n
"
)
;
return
;
}
c
[
0
]
.
postMessage
(
result
)
;
}
)
;
}
)
;
}
;
