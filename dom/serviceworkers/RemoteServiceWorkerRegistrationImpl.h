#
ifndef
mozilla_dom_remoteserviceworkerregistrationimpl_h__
#
define
mozilla_dom_remoteserviceworkerregistrationimpl_h__
#
include
"
ServiceWorkerRegistration
.
h
"
namespace
mozilla
:
:
dom
{
class
ServiceWorkerRegistrationChild
;
class
RemoteServiceWorkerRegistrationImpl
final
:
public
ServiceWorkerRegistration
:
:
Inner
{
RefPtr
<
ServiceWorkerRegistrationChild
>
mActor
;
ServiceWorkerRegistration
*
mOuter
;
bool
mShutdown
;
~
RemoteServiceWorkerRegistrationImpl
(
)
;
void
Shutdown
(
)
;
void
SetServiceWorkerRegistration
(
ServiceWorkerRegistration
*
aReg
)
override
;
void
ClearServiceWorkerRegistration
(
ServiceWorkerRegistration
*
aReg
)
override
;
void
Update
(
const
nsCString
&
aNewestWorkerScriptUrl
ServiceWorkerRegistrationCallback
&
&
aSuccessCB
ServiceWorkerFailureCallback
&
&
aFailureCB
)
override
;
void
Unregister
(
ServiceWorkerBoolCallback
&
&
aSuccessCB
ServiceWorkerFailureCallback
&
&
aFailureCB
)
override
;
void
SetNavigationPreloadEnabled
(
bool
aEnabled
ServiceWorkerBoolCallback
&
&
aSuccessCB
ServiceWorkerFailureCallback
&
&
aFailureCB
)
override
;
void
SetNavigationPreloadHeader
(
const
nsCString
&
aHeader
ServiceWorkerBoolCallback
&
&
aSuccessCB
ServiceWorkerFailureCallback
&
&
aFailureCB
)
override
;
void
GetNavigationPreloadState
(
NavigationPreloadGetStateCallback
&
&
aSuccessCB
ServiceWorkerFailureCallback
&
&
aFailureCB
)
override
;
public
:
explicit
RemoteServiceWorkerRegistrationImpl
(
const
ServiceWorkerRegistrationDescriptor
&
aDescriptor
)
;
void
RevokeActor
(
ServiceWorkerRegistrationChild
*
aActor
)
;
void
UpdateState
(
const
ServiceWorkerRegistrationDescriptor
&
aDescriptor
)
;
void
FireUpdateFound
(
)
;
NS_INLINE_DECL_REFCOUNTING
(
RemoteServiceWorkerRegistrationImpl
override
)
}
;
}
#
endif
