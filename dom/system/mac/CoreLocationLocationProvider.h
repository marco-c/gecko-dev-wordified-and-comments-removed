#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIGeolocationProvider
.
h
"
class
CoreLocationObjects
;
class
MLSFallback
;
class
CoreLocationLocationProvider
:
public
nsIGeolocationProvider
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIGEOLOCATIONPROVIDER
CoreLocationLocationProvider
(
)
;
MOZ_CAN_RUN_SCRIPT_BOUNDARY
void
NotifyError
(
uint16_t
aErrorCode
)
;
void
Update
(
nsIDOMGeoPosition
*
aSomewhere
)
;
void
CreateMLSFallbackProvider
(
)
;
void
CancelMLSFallbackProvider
(
)
;
bool
IsEverUpdated
(
)
const
{
return
mEverUpdated
;
}
private
:
virtual
~
CoreLocationLocationProvider
(
)
=
default
;
CoreLocationObjects
*
mCLObjects
;
nsCOMPtr
<
nsIGeolocationUpdate
>
mCallback
;
RefPtr
<
MLSFallback
>
mMLSFallbackProvider
;
bool
mEverUpdated
=
false
;
class
MLSUpdate
:
public
nsIGeolocationUpdate
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIGEOLOCATIONUPDATE
explicit
MLSUpdate
(
CoreLocationLocationProvider
&
parentProvider
)
;
private
:
CoreLocationLocationProvider
&
mParentLocationProvider
;
virtual
~
MLSUpdate
(
)
=
default
;
}
;
}
;
