#
include
"
mozilla
/
dom
/
ReportingUtils
.
h
"
#
include
"
mozilla
/
dom
/
ReportBody
.
h
"
#
include
"
mozilla
/
dom
/
ReportDeliver
.
h
"
#
include
"
mozilla
/
dom
/
Report
.
h
"
#
include
"
mozilla
/
ipc
/
BackgroundChild
.
h
"
#
include
"
mozilla
/
ipc
/
BackgroundUtils
.
h
"
#
include
"
mozilla
/
ipc
/
PBackgroundChild
.
h
"
#
include
"
nsAtom
.
h
"
#
include
"
nsIGlobalObject
.
h
"
namespace
mozilla
:
:
dom
{
void
ReportingUtils
:
:
Report
(
nsIGlobalObject
*
aGlobal
nsAtom
*
aType
const
nsAString
&
aGroupName
const
nsAString
&
aURL
ReportBody
*
aBody
)
{
MOZ_ASSERT
(
aGlobal
)
;
MOZ_ASSERT
(
aBody
)
;
nsDependentAtomString
type
(
aType
)
;
RefPtr
<
mozilla
:
:
dom
:
:
Report
>
report
=
new
mozilla
:
:
dom
:
:
Report
(
aGlobal
type
aURL
aBody
)
;
aGlobal
-
>
BroadcastReport
(
report
)
;
if
(
!
NS_IsMainThread
(
)
)
{
return
;
}
nsCOMPtr
<
nsPIDOMWindowInner
>
window
=
do_QueryInterface
(
aGlobal
)
;
if
(
!
window
)
{
return
;
}
ReportDeliver
:
:
Record
(
window
type
aGroupName
aURL
aBody
)
;
}
}
