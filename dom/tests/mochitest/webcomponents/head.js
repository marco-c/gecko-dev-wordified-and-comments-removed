"
use
strict
"
;
function
setShadowDOMPrefAndCreateIframe
(
aSrcDoc
)
{
return
new
Promise
(
function
(
aResolve
aReject
)
{
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
dom
.
webcomponents
.
shadowdom
.
enabled
"
true
]
]
}
(
)
=
>
{
let
iframe
=
document
.
createElement
(
"
iframe
"
)
;
iframe
.
onload
=
function
(
)
{
aResolve
(
iframe
.
contentDocument
)
;
}
iframe
.
onerror
=
function
(
)
{
aReject
(
'
Failed
to
load
iframe
'
)
;
}
if
(
aSrcDoc
)
{
iframe
.
srcdoc
=
aSrcDoc
;
}
document
.
body
.
appendChild
(
iframe
)
;
}
)
;
}
)
;
}
