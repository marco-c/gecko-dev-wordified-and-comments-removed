#
ifndef
mozilla_dom_Console_h
#
define
mozilla_dom_Console_h
#
include
"
mozilla
/
dom
/
BindingDeclarations
.
h
"
#
include
"
mozilla
/
ErrorResult
.
h
"
#
include
"
mozilla
/
JSObjectHolder
.
h
"
#
include
"
nsCycleCollectionParticipant
.
h
"
#
include
"
nsDataHashtable
.
h
"
#
include
"
nsHashKeys
.
h
"
#
include
"
nsIObserver
.
h
"
#
include
"
nsWeakReference
.
h
"
#
include
"
nsWrapperCache
.
h
"
#
include
"
nsDOMNavigationTiming
.
h
"
#
include
"
nsPIDOMWindow
.
h
"
class
nsIConsoleAPIStorage
;
class
nsIPrincipal
;
namespace
mozilla
{
namespace
dom
{
class
ConsoleCallData
;
class
ConsoleRunnable
;
class
ConsoleCallDataRunnable
;
class
ConsoleProfileRunnable
;
struct
ConsoleStackEntry
;
class
Console
final
:
public
nsIObserver
public
nsWrapperCache
public
nsSupportsWeakReference
{
~
Console
(
)
;
public
:
NS_DECL_CYCLE_COLLECTING_ISUPPORTS
NS_DECL_CYCLE_COLLECTION_SCRIPT_HOLDER_CLASS_AMBIGUOUS
(
Console
nsIObserver
)
NS_DECL_NSIOBSERVER
explicit
Console
(
nsPIDOMWindowInner
*
aWindow
)
;
nsPIDOMWindowInner
*
GetParentObject
(
)
const
{
return
mWindow
;
}
virtual
JSObject
*
WrapObject
(
JSContext
*
aCx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
override
;
void
Log
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Info
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Warn
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Error
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Exception
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Debug
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Table
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Trace
(
JSContext
*
aCx
)
;
void
Dir
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Dirxml
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Group
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
GroupCollapsed
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
GroupEnd
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Time
(
JSContext
*
aCx
const
JS
:
:
Handle
<
JS
:
:
Value
>
aTime
)
;
void
TimeEnd
(
JSContext
*
aCx
const
JS
:
:
Handle
<
JS
:
:
Value
>
aTime
)
;
void
TimeStamp
(
JSContext
*
aCx
const
JS
:
:
Handle
<
JS
:
:
Value
>
aData
)
;
void
Profile
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
ProfileEnd
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Assert
(
JSContext
*
aCx
bool
aCondition
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
Count
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
NoopMethod
(
)
;
private
:
enum
MethodName
{
MethodLog
MethodInfo
MethodWarn
MethodError
MethodException
MethodDebug
MethodTable
MethodTrace
MethodDir
MethodDirxml
MethodGroup
MethodGroupCollapsed
MethodGroupEnd
MethodTime
MethodTimeEnd
MethodTimeStamp
MethodAssert
MethodCount
}
;
void
Method
(
JSContext
*
aCx
MethodName
aName
const
nsAString
&
aString
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
void
ProcessCallData
(
ConsoleCallData
*
aData
JS
:
:
Handle
<
JSObject
*
>
aGlobal
const
Sequence
<
JS
:
:
Value
>
&
aArguments
)
;
bool
ProcessArguments
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
Sequence
<
JS
:
:
Value
>
&
aSequence
Sequence
<
JS
:
:
Value
>
&
aStyles
)
const
;
void
MakeFormatString
(
nsCString
&
aFormat
int32_t
aInteger
int32_t
aMantissa
char
aCh
)
const
;
void
ComposeGroupName
(
JSContext
*
aCx
const
Sequence
<
JS
:
:
Value
>
&
aData
nsAString
&
aName
)
const
;
JS
:
:
Value
StartTimer
(
JSContext
*
aCx
const
JS
:
:
Value
&
aName
DOMHighResTimeStamp
aTimestamp
)
;
JS
:
:
Value
StopTimer
(
JSContext
*
aCx
const
JS
:
:
Value
&
aName
DOMHighResTimeStamp
aTimestamp
)
;
bool
ArgumentsToValueList
(
const
Sequence
<
JS
:
:
Value
>
&
aData
Sequence
<
JS
:
:
Value
>
&
aSequence
)
const
;
void
ProfileMethod
(
JSContext
*
aCx
const
nsAString
&
aAction
const
Sequence
<
JS
:
:
Value
>
&
aData
)
;
JS
:
:
Value
IncreaseCounter
(
JSContext
*
aCx
const
ConsoleStackEntry
&
aFrame
const
Sequence
<
JS
:
:
Value
>
&
aArguments
)
;
bool
ShouldIncludeStackTrace
(
MethodName
aMethodName
)
const
;
JSObject
*
GetOrCreateSandbox
(
JSContext
*
aCx
nsIPrincipal
*
aPrincipal
)
;
void
RegisterConsoleCallData
(
ConsoleCallData
*
aData
)
;
void
UnregisterConsoleCallData
(
ConsoleCallData
*
aData
)
;
nsCOMPtr
<
nsPIDOMWindowInner
>
mWindow
;
nsCOMPtr
<
nsIConsoleAPIStorage
>
mStorage
;
RefPtr
<
JSObjectHolder
>
mSandbox
;
nsDataHashtable
<
nsStringHashKey
DOMHighResTimeStamp
>
mTimerRegistry
;
nsDataHashtable
<
nsStringHashKey
uint32_t
>
mCounterRegistry
;
nsTArray
<
ConsoleCallData
*
>
mConsoleCallDataArray
;
uint64_t
mOuterID
;
uint64_t
mInnerID
;
friend
class
ConsoleCallData
;
friend
class
ConsoleRunnable
;
friend
class
ConsoleCallDataRunnable
;
friend
class
ConsoleProfileRunnable
;
}
;
}
}
#
endif
