#
ifndef
nsMimeTypeArray_h___
#
define
nsMimeTypeArray_h___
#
include
"
nsWrapperCache
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsPIDOMWindow
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
mozilla
/
dom
/
BindingDeclarations
.
h
"
class
nsMimeType
;
class
nsPluginElement
;
class
nsMimeTypeArray
final
:
public
nsISupports
public
nsWrapperCache
{
public
:
nsMimeTypeArray
(
nsPIDOMWindowInner
*
aWindow
const
mozilla
:
:
Array
<
RefPtr
<
nsMimeType
>
2
>
&
aMimeTypes
)
;
NS_DECL_CYCLE_COLLECTING_ISUPPORTS
NS_DECL_CYCLE_COLLECTION_SCRIPT_HOLDER_CLASS
(
nsMimeTypeArray
)
nsPIDOMWindowInner
*
GetParentObject
(
)
const
;
virtual
JSObject
*
WrapObject
(
JSContext
*
aCx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
override
;
uint32_t
Length
(
)
{
return
ForceNoPlugins
(
)
?
0
:
ArrayLength
(
mMimeTypes
)
;
}
nsMimeType
*
Item
(
uint32_t
aIndex
)
{
bool
unused
;
return
IndexedGetter
(
aIndex
unused
)
;
}
nsMimeType
*
NamedItem
(
const
nsAString
&
aName
)
{
bool
unused
;
return
NamedGetter
(
aName
unused
)
;
}
nsMimeType
*
IndexedGetter
(
uint32_t
index
bool
&
found
)
;
nsMimeType
*
NamedGetter
(
const
nsAString
&
name
bool
&
found
)
;
void
GetSupportedNames
(
nsTArray
<
nsString
>
&
retval
)
;
protected
:
virtual
~
nsMimeTypeArray
(
)
;
static
bool
ForceNoPlugins
(
)
;
nsCOMPtr
<
nsPIDOMWindowInner
>
mWindow
;
mozilla
:
:
Array
<
RefPtr
<
nsMimeType
>
2
>
mMimeTypes
;
}
;
class
nsMimeType
final
:
public
nsWrapperCache
{
public
:
NS_INLINE_DECL_CYCLE_COLLECTING_NATIVE_REFCOUNTING
(
nsMimeType
)
NS_DECL_CYCLE_COLLECTION_SCRIPT_HOLDER_NATIVE_CLASS
(
nsMimeType
)
nsMimeType
(
nsPluginElement
*
aPluginElement
const
nsAString
&
aName
)
;
nsPluginElement
*
GetParentObject
(
)
const
{
return
mPluginElement
;
}
virtual
JSObject
*
WrapObject
(
JSContext
*
aCx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
override
;
void
GetDescription
(
mozilla
:
:
dom
:
:
DOMString
&
retval
)
const
{
retval
.
SetKnownLiveString
(
kMimeDescription
)
;
}
already_AddRefed
<
nsPluginElement
>
EnabledPlugin
(
)
const
{
return
do_AddRef
(
mPluginElement
)
;
}
void
GetSuffixes
(
mozilla
:
:
dom
:
:
DOMString
&
retval
)
const
{
retval
.
SetKnownLiveString
(
kMimeSuffix
)
;
}
void
GetType
(
nsString
&
retval
)
const
{
retval
=
mName
;
}
const
nsString
&
Name
(
)
const
{
return
mName
;
}
protected
:
virtual
~
nsMimeType
(
)
;
static
constexpr
nsLiteralString
kMimeDescription
=
u
"
Portable
Document
Format
"
_ns
;
static
constexpr
nsLiteralString
kMimeSuffix
=
u
"
pdf
"
_ns
;
RefPtr
<
nsPluginElement
>
mPluginElement
;
nsString
mName
;
}
;
#
endif
