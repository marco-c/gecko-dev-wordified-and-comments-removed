#
ifndef
mozilla_dom_VisualViewport_h
#
define
mozilla_dom_VisualViewport_h
#
include
"
mozilla
/
DOMEventTargetHelper
.
h
"
#
include
"
mozilla
/
WeakPtr
.
h
"
#
include
"
mozilla
/
dom
/
VisualViewportBinding
.
h
"
#
include
"
Units
.
h
"
#
include
"
nsIPresShell
.
h
"
namespace
mozilla
{
class
PresShell
;
namespace
dom
{
class
VisualViewport
final
:
public
mozilla
:
:
DOMEventTargetHelper
{
public
:
explicit
VisualViewport
(
nsPIDOMWindowInner
*
aWindow
)
;
double
OffsetLeft
(
)
const
;
double
OffsetTop
(
)
const
;
double
PageLeft
(
)
const
;
double
PageTop
(
)
const
;
double
Width
(
)
const
;
double
Height
(
)
const
;
double
Scale
(
)
const
;
IMPL_EVENT_HANDLER
(
resize
)
IMPL_EVENT_HANDLER
(
scroll
)
virtual
JSObject
*
WrapObject
(
JSContext
*
aCx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
override
;
void
GetEventTargetParent
(
EventChainPreVisitor
&
aVisitor
)
override
;
void
PostResizeEvent
(
)
;
void
PostScrollEvent
(
const
nsPoint
&
aPrevVisualOffset
const
nsPoint
&
aPrevLayoutOffset
)
;
class
VisualViewportResizeEvent
:
public
Runnable
{
public
:
NS_DECL_NSIRUNNABLE
VisualViewportResizeEvent
(
VisualViewport
*
aViewport
nsPresContext
*
aPresContext
)
;
bool
HasPresContext
(
nsPresContext
*
aContext
)
const
;
void
Revoke
(
)
;
private
:
VisualViewport
*
mViewport
;
WeakPtr
<
nsPresContext
>
mPresContext
;
}
;
class
VisualViewportScrollEvent
:
public
Runnable
{
public
:
NS_DECL_NSIRUNNABLE
VisualViewportScrollEvent
(
VisualViewport
*
aViewport
nsPresContext
*
aPresContext
const
nsPoint
&
aPrevVisualOffset
const
nsPoint
&
aPrevLayoutOffset
)
;
bool
HasPresContext
(
nsPresContext
*
aContext
)
const
;
void
Revoke
(
)
;
nsPoint
PrevVisualOffset
(
)
const
{
return
mPrevVisualOffset
;
}
nsPoint
PrevLayoutOffset
(
)
const
{
return
mPrevLayoutOffset
;
}
private
:
VisualViewport
*
mViewport
;
WeakPtr
<
nsPresContext
>
mPresContext
;
const
nsPoint
mPrevVisualOffset
;
const
nsPoint
mPrevLayoutOffset
;
}
;
private
:
virtual
~
VisualViewport
(
)
;
CSSSize
VisualViewportSize
(
)
const
;
CSSPoint
VisualViewportOffset
(
)
const
;
CSSPoint
LayoutViewportOffset
(
)
const
;
PresShell
*
GetPresShell
(
)
const
;
nsPresContext
*
GetPresContext
(
)
const
;
void
FireResizeEvent
(
)
;
void
FireScrollEvent
(
)
;
RefPtr
<
VisualViewportResizeEvent
>
mResizeEvent
;
RefPtr
<
VisualViewportScrollEvent
>
mScrollEvent
;
}
;
}
}
#
endif
