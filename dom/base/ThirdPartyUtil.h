#
ifndef
ThirdPartyUtil_h__
#
define
ThirdPartyUtil_h__
#
include
<
cstdint
>
#
include
"
ErrorList
.
h
"
#
include
"
mozIThirdPartyUtil
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
nsISupports
.
h
"
#
include
"
nsString
.
h
"
class
mozIDOMWindowProxy
;
class
nsEffectiveTLDService
;
class
nsIChannel
;
class
nsIPrincipal
;
class
nsIURI
;
class
nsPIDOMWindowOuter
;
namespace
mozilla
{
namespace
dom
{
class
WindowGlobalParent
;
}
}
class
ThirdPartyUtil
final
:
public
mozIThirdPartyUtil
{
public
:
NS_DECL_THREADSAFE_ISUPPORTS
NS_DECL_MOZITHIRDPARTYUTIL
nsresult
Init
(
)
;
static
void
Startup
(
)
;
static
ThirdPartyUtil
*
GetInstance
(
)
;
nsresult
IsThirdPartyGlobal
(
mozilla
:
:
dom
:
:
WindowGlobalParent
*
aWindowGlobal
bool
*
aResult
)
;
private
:
~
ThirdPartyUtil
(
)
;
bool
IsThirdPartyInternal
(
const
nsCString
&
aFirstDomain
const
nsCString
&
aSecondDomain
)
{
return
aFirstDomain
!
=
aSecondDomain
;
}
nsresult
IsThirdPartyInternal
(
const
nsCString
&
aFirstDomain
nsIURI
*
aSecondURI
bool
*
aResult
)
;
nsCString
GetBaseDomainFromWindow
(
nsPIDOMWindowOuter
*
aWindow
)
;
RefPtr
<
nsEffectiveTLDService
>
mTLDService
;
}
;
#
endif
