#
ifndef
mozAutoDocUpdate_h_
#
define
mozAutoDocUpdate_h_
#
include
"
nsContentUtils
.
h
"
#
include
"
nsIDocument
.
h
"
#
include
"
nsIDocumentObserver
.
h
"
class
MOZ_STACK_CLASS
mozAutoDocUpdate
{
public
:
mozAutoDocUpdate
(
nsIDocument
*
aDocument
bool
aNotify
)
:
mDocument
(
aNotify
?
aDocument
:
nullptr
)
{
if
(
mDocument
)
{
mDocument
-
>
BeginUpdate
(
)
;
}
else
{
nsContentUtils
:
:
AddScriptBlocker
(
)
;
}
}
~
mozAutoDocUpdate
(
)
{
if
(
mDocument
)
{
mDocument
-
>
EndUpdate
(
)
;
}
else
{
nsContentUtils
:
:
RemoveScriptBlocker
(
)
;
}
}
private
:
nsCOMPtr
<
nsIDocument
>
mDocument
;
}
;
#
define
MOZ_AUTO_DOC_UPDATE_PASTE2
(
tok
line
)
tok
#
#
line
#
define
MOZ_AUTO_DOC_UPDATE_PASTE
(
tok
line
)
\
MOZ_AUTO_DOC_UPDATE_PASTE2
(
tok
line
)
#
define
MOZ_AUTO_DOC_UPDATE
(
doc
notify
)
\
mozAutoDocUpdate
MOZ_AUTO_DOC_UPDATE_PASTE
(
_autoDocUpdater_
__LINE__
)
(
\
doc
notify
)
#
endif
