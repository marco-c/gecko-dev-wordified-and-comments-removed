#
ifndef
mozilla_dom_ImageTracker
#
define
mozilla_dom_ImageTracker
#
include
"
nsTHashMap
.
h
"
#
include
"
nsHashKeys
.
h
"
class
imgIRequest
;
namespace
mozilla
{
struct
MediaFeatureChange
;
}
namespace
mozilla
{
namespace
dom
{
class
ImageTracker
{
public
:
ImageTracker
(
)
;
ImageTracker
(
const
ImageTracker
&
)
=
delete
;
ImageTracker
&
operator
=
(
const
ImageTracker
&
)
=
delete
;
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
ImageTracker
)
nsresult
Add
(
imgIRequest
*
aImage
)
;
enum
{
REQUEST_DISCARD
=
0x1
}
;
nsresult
Remove
(
imgIRequest
*
aImage
uint32_t
aFlags
=
0
)
;
void
SetLockingState
(
bool
aLocked
)
;
bool
GetLockingState
(
)
const
{
return
mLocking
;
}
void
SetAnimatingState
(
bool
aAnimating
)
;
void
RequestDiscardAll
(
)
;
void
MediaFeatureValuesChangedAllDocuments
(
const
MediaFeatureChange
&
)
;
private
:
~
ImageTracker
(
)
;
nsTHashMap
<
nsPtrHashKey
<
imgIRequest
>
uint32_t
>
mImages
;
bool
mLocking
=
false
;
bool
mAnimating
=
true
;
}
;
}
}
#
endif
