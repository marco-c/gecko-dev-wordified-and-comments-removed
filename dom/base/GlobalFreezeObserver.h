#
ifndef
DOM_BASE_GLOBALFREEZEOBSERVER_H_
#
define
DOM_BASE_GLOBALFREEZEOBSERVER_H_
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
nsIGlobalObject
.
h
"
#
include
"
nsISupports
.
h
"
namespace
mozilla
{
class
GlobalFreezeObserver
:
public
nsISupports
public
LinkedListElement
<
GlobalFreezeObserver
>
{
public
:
virtual
void
FrozenCallback
(
nsIGlobalObject
*
aOwner
)
=
0
;
virtual
void
ThawedCallback
(
nsIGlobalObject
*
aOwner
)
{
}
;
bool
Observing
(
)
{
return
!
!
mOwner
;
}
void
DisconnectFreezeObserver
(
)
{
if
(
mOwner
)
{
mOwner
-
>
RemoveGlobalFreezeObserver
(
this
)
;
mOwner
=
nullptr
;
}
}
protected
:
virtual
~
GlobalFreezeObserver
(
)
{
DisconnectFreezeObserver
(
)
;
}
void
BindToOwner
(
nsIGlobalObject
*
aOwner
)
{
MOZ_ASSERT
(
!
mOwner
)
;
if
(
aOwner
)
{
MOZ_ASSERT
(
NS_IsMainThread
(
)
"
GlobalFreezeObserver
is
currently
only
supported
in
window
object
"
)
;
mOwner
=
aOwner
;
aOwner
-
>
AddGlobalFreezeObserver
(
this
)
;
}
}
private
:
nsIGlobalObject
*
MOZ_NON_OWNING_REF
mOwner
=
nullptr
;
}
;
}
#
endif
