#
ifndef
mozilla_dom_Navigator_h
#
define
mozilla_dom_Navigator_h
#
include
"
mozilla
/
MemoryReporting
.
h
"
#
include
"
mozilla
/
dom
/
BindingDeclarations
.
h
"
#
include
"
mozilla
/
dom
/
Fetch
.
h
"
#
include
"
mozilla
/
dom
/
Nullable
.
h
"
#
include
"
mozilla
/
ErrorResult
.
h
"
#
include
"
nsIDOMNavigator
.
h
"
#
include
"
nsIMozNavigatorNetwork
.
h
"
#
include
"
nsWrapperCache
.
h
"
#
include
"
nsHashKeys
.
h
"
#
include
"
nsInterfaceHashtable
.
h
"
#
include
"
nsString
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
nsWeakPtr
.
h
"
#
include
"
mozilla
/
dom
/
MediaKeySystemAccessManager
.
h
"
class
nsPluginArray
;
class
nsMimeTypeArray
;
class
nsPIDOMWindowInner
;
class
nsIDOMNavigatorSystemMessages
;
class
nsIPrincipal
;
class
nsIURI
;
namespace
mozilla
{
namespace
dom
{
class
BodyExtractorBase
;
class
Geolocation
;
class
systemMessageCallback
;
class
MediaDevices
;
struct
MediaStreamConstraints
;
class
WakeLock
;
class
ArrayBufferOrArrayBufferViewOrBlobOrFormDataOrUSVStringOrURLSearchParams
;
class
ServiceWorkerContainer
;
class
DOMRequest
;
struct
FlyWebPublishOptions
;
struct
FlyWebFilter
;
class
WebAuthentication
;
}
}
namespace
mozilla
{
namespace
dom
{
class
Permissions
;
namespace
battery
{
class
BatteryManager
;
}
class
Promise
;
class
DesktopNotificationCenter
;
class
MozIdleObserver
;
class
Gamepad
;
class
GamepadServiceTest
;
class
NavigatorUserMediaSuccessCallback
;
class
NavigatorUserMediaErrorCallback
;
class
MozGetUserMediaDevicesSuccessCallback
;
namespace
network
{
class
Connection
;
}
class
PowerManager
;
class
Presentation
;
class
LegacyMozTCPSocket
;
class
VRDisplay
;
class
VRServiceTest
;
class
StorageManager
;
namespace
time
{
class
TimeManager
;
}
namespace
system
{
#
ifdef
MOZ_AUDIO_CHANNEL_MANAGER
class
AudioChannelManager
;
#
endif
}
class
Navigator
final
:
public
nsIDOMNavigator
public
nsIMozNavigatorNetwork
public
nsWrapperCache
{
public
:
explicit
Navigator
(
nsPIDOMWindowInner
*
aInnerWindow
)
;
NS_DECL_CYCLE_COLLECTING_ISUPPORTS
NS_DECL_CYCLE_COLLECTION_SCRIPT_HOLDER_CLASS_AMBIGUOUS
(
Navigator
nsIDOMNavigator
)
NS_DECL_NSIDOMNAVIGATOR
NS_DECL_NSIMOZNAVIGATORNETWORK
static
void
Init
(
)
;
void
Invalidate
(
)
;
nsPIDOMWindowInner
*
GetWindow
(
)
const
{
return
mWindow
;
}
void
RefreshMIMEArray
(
)
;
size_t
SizeOfIncludingThis
(
mozilla
:
:
MallocSizeOf
aMallocSizeOf
)
const
;
void
SetWindow
(
nsPIDOMWindowInner
*
aInnerWindow
)
;
void
OnNavigation
(
)
;
void
GetAppName
(
nsAString
&
aAppName
CallerType
aCallerType
)
const
;
void
GetAppVersion
(
nsAString
&
aAppName
CallerType
aCallerType
ErrorResult
&
aRv
)
const
;
void
GetPlatform
(
nsAString
&
aPlatform
CallerType
aCallerType
ErrorResult
&
aRv
)
const
;
void
GetUserAgent
(
nsAString
&
aUserAgent
CallerType
aCallerType
ErrorResult
&
aRv
)
const
;
bool
OnLine
(
)
;
void
RegisterProtocolHandler
(
const
nsAString
&
aScheme
const
nsAString
&
aURL
const
nsAString
&
aTitle
ErrorResult
&
aRv
)
;
void
RegisterContentHandler
(
const
nsAString
&
aMIMEType
const
nsAString
&
aURL
const
nsAString
&
aTitle
ErrorResult
&
aRv
)
;
nsMimeTypeArray
*
GetMimeTypes
(
ErrorResult
&
aRv
)
;
nsPluginArray
*
GetPlugins
(
ErrorResult
&
aRv
)
;
Permissions
*
GetPermissions
(
ErrorResult
&
aRv
)
;
Geolocation
*
GetGeolocation
(
ErrorResult
&
aRv
)
;
Promise
*
GetBattery
(
ErrorResult
&
aRv
)
;
already_AddRefed
<
Promise
>
PublishServer
(
const
nsAString
&
aName
const
FlyWebPublishOptions
&
aOptions
ErrorResult
&
aRv
)
;
static
void
AppName
(
nsAString
&
aAppName
bool
aUsePrefOverriddenValue
)
;
static
nsresult
GetPlatform
(
nsAString
&
aPlatform
bool
aUsePrefOverriddenValue
)
;
static
nsresult
GetAppVersion
(
nsAString
&
aAppVersion
bool
aUsePrefOverriddenValue
)
;
static
nsresult
GetUserAgent
(
nsPIDOMWindowInner
*
aWindow
nsIURI
*
aURI
bool
aIsCallerChrome
nsAString
&
aUserAgent
)
;
void
ClearUserAgentCache
(
)
;
bool
Vibrate
(
uint32_t
aDuration
)
;
bool
Vibrate
(
const
nsTArray
<
uint32_t
>
&
aDuration
)
;
void
SetVibrationPermission
(
bool
aPermitted
bool
aPersistent
)
;
uint32_t
MaxTouchPoints
(
)
;
void
GetAppCodeName
(
nsString
&
aAppCodeName
ErrorResult
&
aRv
)
{
aRv
=
GetAppCodeName
(
aAppCodeName
)
;
}
void
GetOscpu
(
nsAString
&
aOscpu
CallerType
aCallerType
ErrorResult
&
aRv
)
const
;
bool
CookieEnabled
(
)
;
void
GetBuildID
(
nsAString
&
aBuildID
CallerType
aCallerType
ErrorResult
&
aRv
)
const
;
PowerManager
*
GetMozPower
(
ErrorResult
&
aRv
)
;
bool
JavaEnabled
(
CallerType
aCallerType
ErrorResult
&
aRv
)
;
uint64_t
HardwareConcurrency
(
)
;
bool
CpuHasSSE2
(
)
;
bool
TaintEnabled
(
)
{
return
false
;
}
void
AddIdleObserver
(
MozIdleObserver
&
aObserver
ErrorResult
&
aRv
)
;
void
RemoveIdleObserver
(
MozIdleObserver
&
aObserver
ErrorResult
&
aRv
)
;
already_AddRefed
<
WakeLock
>
RequestWakeLock
(
const
nsAString
&
aTopic
ErrorResult
&
aRv
)
;
DesktopNotificationCenter
*
GetMozNotification
(
ErrorResult
&
aRv
)
;
already_AddRefed
<
LegacyMozTCPSocket
>
MozTCPSocket
(
)
;
network
:
:
Connection
*
GetConnection
(
ErrorResult
&
aRv
)
;
MediaDevices
*
GetMediaDevices
(
ErrorResult
&
aRv
)
;
void
GetGamepads
(
nsTArray
<
RefPtr
<
Gamepad
>
>
&
aGamepads
ErrorResult
&
aRv
)
;
GamepadServiceTest
*
RequestGamepadServiceTest
(
)
;
already_AddRefed
<
Promise
>
GetVRDisplays
(
ErrorResult
&
aRv
)
;
void
GetActiveVRDisplays
(
nsTArray
<
RefPtr
<
VRDisplay
>
>
&
aDisplays
)
const
;
VRServiceTest
*
RequestVRServiceTest
(
)
;
#
ifdef
MOZ_TIME_MANAGER
time
:
:
TimeManager
*
GetMozTime
(
ErrorResult
&
aRv
)
;
#
endif
#
ifdef
MOZ_AUDIO_CHANNEL_MANAGER
system
:
:
AudioChannelManager
*
GetMozAudioChannelManager
(
ErrorResult
&
aRv
)
;
#
endif
Presentation
*
GetPresentation
(
ErrorResult
&
aRv
)
;
bool
SendBeacon
(
const
nsAString
&
aUrl
const
Nullable
<
fetch
:
:
BodyInit
>
&
aData
ErrorResult
&
aRv
)
;
void
MozGetUserMedia
(
const
MediaStreamConstraints
&
aConstraints
NavigatorUserMediaSuccessCallback
&
aOnSuccess
NavigatorUserMediaErrorCallback
&
aOnError
CallerType
aCallerType
ErrorResult
&
aRv
)
;
void
MozGetUserMediaDevices
(
const
MediaStreamConstraints
&
aConstraints
MozGetUserMediaDevicesSuccessCallback
&
aOnSuccess
NavigatorUserMediaErrorCallback
&
aOnError
uint64_t
aInnerWindowID
const
nsAString
&
aCallID
ErrorResult
&
aRv
)
;
already_AddRefed
<
ServiceWorkerContainer
>
ServiceWorker
(
)
;
mozilla
:
:
dom
:
:
WebAuthentication
*
Authentication
(
)
;
void
GetLanguages
(
nsTArray
<
nsString
>
&
aLanguages
)
;
bool
MozE10sEnabled
(
)
;
StorageManager
*
Storage
(
)
;
static
void
GetAcceptLanguages
(
nsTArray
<
nsString
>
&
aLanguages
)
;
static
bool
HasWakeLockSupport
(
JSContext
*
JSObject
*
)
;
static
bool
HasWifiManagerSupport
(
JSContext
*
JSObject
*
aGlobal
)
;
static
bool
HasUserMediaSupport
(
JSContext
*
JSObject
*
)
;
static
bool
IsE10sEnabled
(
JSContext
*
aCx
JSObject
*
aGlobal
)
;
nsPIDOMWindowInner
*
GetParentObject
(
)
const
{
return
GetWindow
(
)
;
}
virtual
JSObject
*
WrapObject
(
JSContext
*
cx
JS
:
:
Handle
<
JSObject
*
>
aGivenProto
)
override
;
static
already_AddRefed
<
nsPIDOMWindowInner
>
GetWindowFromGlobal
(
JSObject
*
aGlobal
)
;
already_AddRefed
<
Promise
>
RequestMediaKeySystemAccess
(
const
nsAString
&
aKeySystem
const
Sequence
<
MediaKeySystemConfiguration
>
&
aConfig
ErrorResult
&
aRv
)
;
private
:
RefPtr
<
MediaKeySystemAccessManager
>
mMediaKeySystemAccessManager
;
public
:
void
NotifyVRDisplaysUpdated
(
)
;
void
NotifyActiveVRDisplaysChanged
(
)
;
private
:
virtual
~
Navigator
(
)
;
bool
CheckPermission
(
const
char
*
type
)
;
static
bool
CheckPermission
(
nsPIDOMWindowInner
*
aWindow
const
char
*
aType
)
;
enum
BeaconType
{
eBeaconTypeBlob
eBeaconTypeArrayBuffer
eBeaconTypeOther
}
;
bool
SendBeaconInternal
(
const
nsAString
&
aUrl
BodyExtractorBase
*
aBody
BeaconType
aType
ErrorResult
&
aRv
)
;
RefPtr
<
nsMimeTypeArray
>
mMimeTypes
;
RefPtr
<
nsPluginArray
>
mPlugins
;
RefPtr
<
Permissions
>
mPermissions
;
RefPtr
<
Geolocation
>
mGeolocation
;
RefPtr
<
DesktopNotificationCenter
>
mNotification
;
RefPtr
<
battery
:
:
BatteryManager
>
mBatteryManager
;
RefPtr
<
Promise
>
mBatteryPromise
;
RefPtr
<
PowerManager
>
mPowerManager
;
RefPtr
<
network
:
:
Connection
>
mConnection
;
RefPtr
<
WebAuthentication
>
mAuthentication
;
#
ifdef
MOZ_AUDIO_CHANNEL_MANAGER
RefPtr
<
system
:
:
AudioChannelManager
>
mAudioChannelManager
;
#
endif
RefPtr
<
MediaDevices
>
mMediaDevices
;
RefPtr
<
time
:
:
TimeManager
>
mTimeManager
;
RefPtr
<
ServiceWorkerContainer
>
mServiceWorkerContainer
;
nsCOMPtr
<
nsPIDOMWindowInner
>
mWindow
;
RefPtr
<
Presentation
>
mPresentation
;
RefPtr
<
GamepadServiceTest
>
mGamepadServiceTest
;
nsTArray
<
RefPtr
<
Promise
>
>
mVRGetDisplaysPromises
;
RefPtr
<
VRServiceTest
>
mVRServiceTest
;
nsTArray
<
uint32_t
>
mRequestedVibrationPattern
;
RefPtr
<
StorageManager
>
mStorageManager
;
}
;
}
}
#
endif
