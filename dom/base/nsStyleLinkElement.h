#
ifndef
nsStyleLinkElement_h___
#
define
nsStyleLinkElement_h___
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
CORSMode
.
h
"
#
include
"
mozilla
/
StyleSheetInlines
.
h
"
#
include
"
mozilla
/
Unused
.
h
"
#
include
"
mozilla
/
net
/
ReferrerPolicy
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIStyleSheetLinkingElement
.
h
"
#
include
"
nsTArray
.
h
"
class
nsIDocument
;
class
nsIURI
;
namespace
mozilla
{
class
CSSStyleSheet
;
namespace
dom
{
class
ShadowRoot
;
}
}
class
nsStyleLinkElement
:
public
nsIStyleSheetLinkingElement
{
protected
:
enum
class
IsInline
{
Yes
No
}
;
enum
class
HasAlternateRel
{
Yes
No
}
;
struct
MOZ_STACK_CLASS
StyleSheetInfo
{
const
nsIContent
*
mContent
;
nsCOMPtr
<
nsIURI
>
mURI
;
nsCOMPtr
<
nsIPrincipal
>
mTriggeringPrincipal
;
mozilla
:
:
net
:
:
ReferrerPolicy
mReferrerPolicy
;
mozilla
:
:
CORSMode
mCORSMode
;
nsAutoString
mTitle
;
nsAutoString
mMedia
;
nsAutoString
mIntegrity
;
bool
mIsAlternate
:
1
;
bool
mHasAlternateRel
:
1
;
bool
mIsInline
:
1
;
StyleSheetInfo
(
const
nsIDocument
&
const
nsIContent
*
already_AddRefed
<
nsIURI
>
aURI
already_AddRefed
<
nsIPrincipal
>
aTriggeringPrincipal
mozilla
:
:
net
:
:
ReferrerPolicy
aReferrerPolicy
mozilla
:
:
CORSMode
aCORSMode
const
nsAString
&
aTitle
const
nsAString
&
aMedia
HasAlternateRel
aHasAlternateRel
IsInline
aIsInline
)
;
~
StyleSheetInfo
(
)
;
}
;
public
:
nsStyleLinkElement
(
)
;
virtual
~
nsStyleLinkElement
(
)
;
NS_IMETHOD
QueryInterface
(
REFNSIID
aIID
void
*
*
aInstancePtr
)
override
=
0
;
mozilla
:
:
StyleSheet
*
GetSheet
(
)
const
{
return
mStyleSheet
;
}
void
SetStyleSheet
(
mozilla
:
:
StyleSheet
*
aStyleSheet
)
override
;
mozilla
:
:
StyleSheet
*
GetStyleSheet
(
)
override
;
void
InitStyleLinkElement
(
bool
aDontLoadStyle
)
override
;
mozilla
:
:
Result
<
Update
nsresult
>
UpdateStyleSheet
(
nsICSSLoaderObserver
*
ForceUpdate
)
override
;
void
SetEnableUpdates
(
bool
aEnableUpdates
)
override
;
void
GetCharset
(
nsAString
&
aCharset
)
override
;
void
OverrideBaseURI
(
nsIURI
*
aNewBaseURI
)
override
;
void
SetLineNumber
(
uint32_t
aLineNumber
)
override
;
uint32_t
GetLineNumber
(
)
override
;
enum
RelValue
{
ePREFETCH
=
0x00000001
eDNS_PREFETCH
=
0x00000002
eSTYLESHEET
=
0x00000004
eNEXT
=
0x00000008
eALTERNATE
=
0x00000010
ePRECONNECT
=
0x00000020
ePRELOAD
=
0x00000080
}
;
static
uint32_t
ParseLinkTypes
(
const
nsAString
&
aTypes
)
;
void
UpdateStyleSheetInternal
(
)
{
mozilla
:
:
Unused
<
<
UpdateStyleSheetInternal
(
nullptr
nullptr
)
;
}
protected
:
mozilla
:
:
Result
<
Update
nsresult
>
UpdateStyleSheetInternal
(
nsIDocument
*
aOldDocument
mozilla
:
:
dom
:
:
ShadowRoot
*
aOldShadowRoot
ForceUpdate
=
ForceUpdate
:
:
No
)
;
virtual
mozilla
:
:
Maybe
<
StyleSheetInfo
>
GetStyleSheetInfo
(
)
=
0
;
void
Unlink
(
)
;
void
Traverse
(
nsCycleCollectionTraversalCallback
&
cb
)
;
private
:
mozilla
:
:
Result
<
Update
nsresult
>
DoUpdateStyleSheet
(
nsIDocument
*
aOldDocument
mozilla
:
:
dom
:
:
ShadowRoot
*
aOldShadowRoot
nsICSSLoaderObserver
*
aObserver
ForceUpdate
)
;
RefPtr
<
mozilla
:
:
StyleSheet
>
mStyleSheet
;
protected
:
nsCOMPtr
<
nsIPrincipal
>
mTriggeringPrincipal
;
bool
mDontLoadStyle
;
bool
mUpdatesEnabled
;
uint32_t
mLineNumber
;
}
;
#
endif
