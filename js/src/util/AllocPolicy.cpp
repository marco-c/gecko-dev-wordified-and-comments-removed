#
include
"
js
/
AllocPolicy
.
h
"
#
include
"
frontend
/
FrontendContext
.
h
"
#
include
"
vm
/
JSContext
.
h
"
using
namespace
js
;
void
*
TempAllocPolicy
:
:
onOutOfMemory
(
arena_id_t
arenaId
AllocFunction
allocFunc
size_t
nbytes
void
*
reallocPtr
)
{
void
*
result
;
if
(
hasJSContext
(
)
)
{
result
=
cx
(
)
-
>
onOutOfMemory
(
allocFunc
arenaId
nbytes
reallocPtr
)
;
}
else
{
result
=
fc
(
)
-
>
onOutOfMemory
(
allocFunc
arenaId
nbytes
reallocPtr
)
;
}
return
result
;
}
void
TempAllocPolicy
:
:
reportAllocOverflow
(
)
const
{
if
(
hasJSContext
(
)
)
{
ReportAllocationOverflow
(
cx
(
)
)
;
}
else
{
ReportAllocationOverflow
(
fc
(
)
)
;
}
}
