const
text
=
'
a
b
'
;
function
doReplace
(
regex
replacement
)
{
return
RegExp
.
prototype
[
Symbol
.
replace
]
.
call
(
regex
text
replacement
)
;
}
assert
.
sameValue
(
doReplace
(
/
/
g
'
-
'
)
"
-
a
-
b
-
"
"
Basic
replace
with
g
flag
"
)
;
assert
.
sameValue
(
doReplace
(
/
/
v
'
-
'
)
"
-
a
b
"
"
Replace
with
v
flag
"
)
;
assert
.
sameValue
(
doReplace
(
/
\
p
{
Script
=
Han
}
/
gv
'
X
'
)
"
XaXbX
"
"
Unicode
property
escapes
with
v
flag
"
)
;
assert
.
sameValue
(
doReplace
(
/
.
/
gv
'
&
&
'
)
"
aa
bb
"
"
Dot
with
v
flag
"
)
;
assert
.
sameValue
(
doReplace
(
/
.
/
gv
(
match
index
)
=
>
[
{
match
}
:
{
index
}
]
)
"
[
:
0
]
[
a
:
2
]
[
:
3
]
[
b
:
5
]
[
:
6
]
"
"
Replace
with
function
"
)
;
reportCompare
(
0
0
)
;
