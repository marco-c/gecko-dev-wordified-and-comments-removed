const
otherGlobal
=
createNewGlobal
(
)
;
const
intArrayConstructors
=
[
otherGlobal
.
Int32Array
otherGlobal
.
Int16Array
otherGlobal
.
Int8Array
otherGlobal
.
Uint32Array
otherGlobal
.
Uint16Array
otherGlobal
.
Uint8Array
]
;
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
ta
[
0
]
=
1
;
assert
.
sameValue
(
Atomics
.
load
(
ta
0
)
1
)
;
}
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
Atomics
.
store
(
ta
0
1
)
;
assert
.
sameValue
(
ta
[
0
]
1
)
;
}
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
ta
[
0
]
=
1
;
let
val
=
Atomics
.
compareExchange
(
ta
0
1
2
)
;
assert
.
sameValue
(
val
1
)
;
assert
.
sameValue
(
ta
[
0
]
2
)
;
}
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
ta
[
0
]
=
1
;
let
val
=
Atomics
.
exchange
(
ta
0
2
)
;
assert
.
sameValue
(
val
1
)
;
assert
.
sameValue
(
ta
[
0
]
2
)
;
}
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
ta
[
0
]
=
1
;
let
val
=
Atomics
.
add
(
ta
0
2
)
;
assert
.
sameValue
(
val
1
)
;
assert
.
sameValue
(
ta
[
0
]
3
)
;
}
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
ta
[
0
]
=
3
;
let
val
=
Atomics
.
sub
(
ta
0
2
)
;
assert
.
sameValue
(
val
3
)
;
assert
.
sameValue
(
ta
[
0
]
1
)
;
}
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
ta
[
0
]
=
3
;
let
val
=
Atomics
.
and
(
ta
0
1
)
;
assert
.
sameValue
(
val
3
)
;
assert
.
sameValue
(
ta
[
0
]
1
)
;
}
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
ta
[
0
]
=
2
;
let
val
=
Atomics
.
or
(
ta
0
1
)
;
assert
.
sameValue
(
val
2
)
;
assert
.
sameValue
(
ta
[
0
]
3
)
;
}
for
(
let
TA
of
intArrayConstructors
)
{
let
ta
=
new
TA
(
new
otherGlobal
.
SharedArrayBuffer
(
4
)
)
;
ta
[
0
]
=
3
;
let
val
=
Atomics
.
xor
(
ta
0
1
)
;
assert
.
sameValue
(
val
3
)
;
assert
.
sameValue
(
ta
[
0
]
2
)
;
}
reportCompare
(
0
0
)
;
