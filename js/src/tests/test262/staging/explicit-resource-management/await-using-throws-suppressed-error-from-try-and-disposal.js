asyncTest
(
async
function
(
)
{
let
userCodeError
=
new
Test262Error
(
'
User
code
is
throwing
!
'
)
;
let
disposeError
=
new
Test262Error
(
'
Symbol
.
asyncDispose
is
throwing
!
'
)
;
async
function
TestDisposeMethodAndUserCodeThrow
(
)
{
await
using
x
=
{
value
:
1
[
Symbol
.
asyncDispose
]
(
)
{
throw
disposeError
;
}
}
;
throw
userCodeError
;
}
;
await
assert
.
throwsAsync
(
SuppressedError
(
)
=
>
TestDisposeMethodAndUserCodeThrow
(
)
'
An
error
was
suppressed
during
disposal
'
)
;
async
function
RunTestDisposeMethodAndUserCodeThrow
(
)
{
try
{
TestDisposeMethodAndUserCodeThrow
(
)
;
}
catch
(
error
)
{
assert
(
error
instanceof
SuppressedError
'
error
is
an
instanceof
SuppressedError
'
)
;
assert
.
sameValue
(
error
.
error
disposeError
'
error
.
error
'
)
;
assert
.
sameValue
(
error
.
suppressed
userCodeError
'
error
.
suppressed
'
)
;
}
}
RunTestDisposeMethodAndUserCodeThrow
(
)
;
}
)
;
