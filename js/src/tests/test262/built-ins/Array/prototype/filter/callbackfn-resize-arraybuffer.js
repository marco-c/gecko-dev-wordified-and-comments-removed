assert
.
sameValue
(
typeof
ArrayBuffer
.
prototype
.
resize
'
function
'
)
;
testWithTypedArrayConstructors
(
function
(
TA
)
{
var
BPE
=
TA
.
BYTES_PER_ELEMENT
;
var
buffer
=
new
ArrayBuffer
(
BPE
*
3
{
maxByteLength
:
BPE
*
4
}
)
;
var
sample
=
new
TA
(
buffer
)
;
var
expectedElements
expectedIndices
expectedArrays
;
var
elements
indices
arrays
result
;
elements
=
[
]
;
indices
=
[
]
;
arrays
=
[
]
;
result
=
Array
.
prototype
.
filter
.
call
(
sample
function
(
element
index
array
)
{
if
(
elements
.
length
=
=
=
0
)
{
try
{
buffer
.
resize
(
2
*
BPE
)
;
expectedElements
=
[
0
0
]
;
expectedIndices
=
[
0
1
]
;
expectedArrays
=
[
sample
sample
]
;
}
catch
(
_
)
{
expectedElements
=
[
0
0
0
]
;
expectedIndices
=
[
0
1
2
]
;
expectedArrays
=
[
sample
sample
sample
]
;
}
}
elements
.
push
(
element
)
;
indices
.
push
(
index
)
;
arrays
.
push
(
array
)
;
return
true
;
}
)
;
assert
.
compareArray
(
elements
expectedElements
'
elements
(
shrink
)
'
)
;
assert
.
compareArray
(
indices
expectedIndices
'
indices
(
shrink
)
'
)
;
assert
.
compareArray
(
arrays
expectedArrays
'
arrays
(
shrink
)
'
)
;
assert
.
compareArray
(
result
expectedElements
'
result
(
shrink
)
'
)
;
elements
=
[
]
;
indices
=
[
]
;
arrays
=
[
]
;
result
=
Array
.
prototype
.
filter
.
call
(
sample
function
(
element
index
array
)
{
if
(
elements
.
length
=
=
=
0
)
{
try
{
buffer
.
resize
(
4
*
BPE
)
;
}
catch
(
_
)
{
}
}
elements
.
push
(
element
)
;
indices
.
push
(
index
)
;
arrays
.
push
(
array
)
;
return
true
;
}
)
;
assert
.
compareArray
(
elements
expectedElements
'
elements
(
grow
)
'
)
;
assert
.
compareArray
(
indices
expectedIndices
'
indices
(
grow
)
'
)
;
assert
.
compareArray
(
arrays
expectedArrays
'
arrays
(
grow
)
'
)
;
assert
.
compareArray
(
result
expectedElements
'
result
(
grow
)
'
)
;
}
)
;
reportCompare
(
0
0
)
;
