let
values
;
let
rab
;
let
resizeAfter
;
let
resizeTo
;
function
ShrinkMidIteration
(
n
ix
ta
)
{
CollectValuesAndResize
(
n
values
rab
resizeAfter
resizeTo
)
;
if
(
ta
instanceof
BigInt64Array
|
|
ta
instanceof
BigUint64Array
)
{
return
0n
;
}
return
0
;
}
for
(
let
ctor
of
ctors
)
{
values
=
[
]
;
rab
=
CreateRabForTest
(
ctor
)
;
const
fixedLength
=
new
ctor
(
rab
0
4
)
;
resizeAfter
=
2
;
resizeTo
=
3
*
ctor
.
BYTES_PER_ELEMENT
;
Array
.
prototype
.
map
.
call
(
fixedLength
ShrinkMidIteration
)
;
assert
.
compareArray
(
values
[
0
2
]
)
;
}
for
(
let
ctor
of
ctors
)
{
values
=
[
]
;
rab
=
CreateRabForTest
(
ctor
)
;
const
fixedLengthWithOffset
=
new
ctor
(
rab
2
*
ctor
.
BYTES_PER_ELEMENT
2
)
;
resizeAfter
=
1
;
resizeTo
=
3
*
ctor
.
BYTES_PER_ELEMENT
;
Array
.
prototype
.
map
.
call
(
fixedLengthWithOffset
ShrinkMidIteration
)
;
assert
.
compareArray
(
values
[
4
]
)
;
}
for
(
let
ctor
of
ctors
)
{
values
=
[
]
;
rab
=
CreateRabForTest
(
ctor
)
;
const
lengthTracking
=
new
ctor
(
rab
0
)
;
resizeAfter
=
2
;
resizeTo
=
3
*
ctor
.
BYTES_PER_ELEMENT
;
Array
.
prototype
.
map
.
call
(
lengthTracking
ShrinkMidIteration
)
;
assert
.
compareArray
(
values
[
0
2
4
]
)
;
}
for
(
let
ctor
of
ctors
)
{
values
=
[
]
;
rab
=
CreateRabForTest
(
ctor
)
;
const
lengthTrackingWithOffset
=
new
ctor
(
rab
2
*
ctor
.
BYTES_PER_ELEMENT
)
;
resizeAfter
=
1
;
resizeTo
=
3
*
ctor
.
BYTES_PER_ELEMENT
;
Array
.
prototype
.
map
.
call
(
lengthTrackingWithOffset
ShrinkMidIteration
)
;
assert
.
compareArray
(
values
[
4
]
)
;
}
reportCompare
(
0
0
)
;
