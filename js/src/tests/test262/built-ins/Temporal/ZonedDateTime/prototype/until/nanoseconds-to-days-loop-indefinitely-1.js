const
calls
=
[
]
;
const
dayLengthNs
=
86400000000000n
;
const
other
=
new
Temporal
.
ZonedDateTime
(
dayLengthNs
"
UTC
"
"
iso8601
"
)
;
function
createRelativeTo
(
count
)
{
const
tz
=
new
Temporal
.
TimeZone
(
"
UTC
"
)
;
TemporalHelpers
.
observeMethod
(
calls
tz
"
getPossibleInstantsFor
"
)
;
const
cal
=
new
Temporal
.
Calendar
(
"
iso8601
"
)
;
TemporalHelpers
.
substituteMethod
(
cal
"
dateUntil
"
[
TemporalHelpers
.
SUBSTITUTE_SKIP
Temporal
.
Duration
.
from
(
{
days
:
count
}
)
]
)
;
return
new
Temporal
.
ZonedDateTime
(
0n
tz
cal
)
;
}
let
zdt
=
createRelativeTo
(
200
)
;
calls
.
splice
(
0
)
;
zdt
.
until
(
other
{
largestUnit
:
"
day
"
}
)
;
assert
.
sameValue
(
calls
.
length
200
+
1
"
Expected
ZonedDateTime
.
until
to
call
getPossibleInstantsFor
correct
number
of
times
"
)
;
zdt
=
createRelativeTo
(
300
)
;
calls
.
splice
(
0
)
;
zdt
.
until
(
other
{
largestUnit
:
"
day
"
}
)
;
assert
.
sameValue
(
calls
.
length
300
+
1
"
Expected
ZonedDateTime
.
until
to
call
getPossibleInstantsFor
correct
number
of
times
"
)
;
reportCompare
(
0
0
)
;
