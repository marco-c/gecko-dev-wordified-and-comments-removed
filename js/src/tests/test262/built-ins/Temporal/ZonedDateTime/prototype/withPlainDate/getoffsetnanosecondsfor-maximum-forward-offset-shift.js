let
calls
=
0
;
class
Shift24Hour
extends
Temporal
.
TimeZone
{
id
=
'
TestTimeZone
'
;
_shiftEpochNs
=
12n
*
3600n
*
1_000_000_000n
;
constructor
(
)
{
super
(
'
UTC
'
)
;
}
getOffsetNanosecondsFor
(
instant
)
{
calls
+
+
;
if
(
instant
.
epochNanoseconds
<
this
.
_shiftEpochNs
)
return
-
12
*
3600e9
;
return
12
*
3600e9
;
}
getPossibleInstantsFor
(
plainDateTime
)
{
const
[
utcInstant
]
=
super
.
getPossibleInstantsFor
(
plainDateTime
)
;
const
{
year
month
day
}
=
plainDateTime
;
if
(
year
<
1970
)
return
[
utcInstant
.
subtract
(
{
hours
:
12
}
)
]
;
if
(
year
=
=
=
1970
&
&
month
=
=
=
1
&
&
day
=
=
=
1
)
return
[
]
;
return
[
utcInstant
.
add
(
{
hours
:
12
}
)
]
;
}
}
const
timeZone
=
new
Shift24Hour
(
)
;
const
instance
=
new
Temporal
.
ZonedDateTime
(
0n
timeZone
)
;
instance
.
withPlainDate
(
new
Temporal
.
PlainDate
(
1970
1
1
)
)
;
assert
(
calls
>
=
2
"
getOffsetNanosecondsFor
should
be
called
at
least
twice
"
)
;
reportCompare
(
0
0
)
;
