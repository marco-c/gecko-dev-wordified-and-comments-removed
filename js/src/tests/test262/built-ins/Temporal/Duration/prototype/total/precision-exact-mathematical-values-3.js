function
nextUp
(
num
)
{
if
(
!
Number
.
isFinite
(
num
)
)
{
return
num
;
}
if
(
num
=
=
=
0
)
{
return
Number
.
MIN_VALUE
;
}
var
f64
=
new
Float64Array
(
[
num
]
)
;
var
u64
=
new
BigUint64Array
(
f64
.
buffer
)
;
u64
[
0
]
+
=
(
num
<
0
?
-
1n
:
1n
)
;
return
f64
[
0
]
;
}
function
nextDown
(
num
)
{
if
(
!
Number
.
isFinite
(
num
)
)
{
return
num
;
}
if
(
num
=
=
=
0
)
{
return
-
Number
.
MIN_VALUE
;
}
var
f64
=
new
Float64Array
(
[
num
]
)
;
var
u64
=
new
BigUint64Array
(
f64
.
buffer
)
;
u64
[
0
]
+
=
(
num
<
0
?
1n
:
-
1n
)
;
return
f64
[
0
]
;
}
function
f64Repr
(
f
)
{
const
buf
=
new
ArrayBuffer
(
8
)
;
new
DataView
(
buf
)
.
setFloat64
(
0
f
)
;
return
new
Uint8Array
(
buf
)
;
}
const
tz
=
new
(
class
extends
Temporal
.
TimeZone
{
getPossibleInstantsFor
(
)
{
return
[
new
Temporal
.
Instant
(
-
86400_0000_0000_000_000_000n
+
2n
*
*
53n
-
1n
)
]
;
}
}
)
(
"
UTC
"
)
;
const
cal
=
new
(
class
extends
Temporal
.
Calendar
{
dateAdd
(
)
{
return
new
Temporal
.
PlainDate
(
275760
9
13
)
;
}
}
)
(
"
iso8601
"
)
;
const
relativeTo
=
new
Temporal
.
ZonedDateTime
(
-
86400_0000_0000_000_000_000n
tz
cal
)
;
const
d
=
new
Temporal
.
Duration
(
0
0
0
0
0
0
0
0
0
1
)
;
const
expected
=
5
.
55111512312578_3318415740544369642963189519987393e
-
25
;
assert
.
sameValue
(
expected
5
.
55111512312578_373662e
-
25
"
the
float
representation
of
the
result
is
5
.
55111512312578373662e
-
25
"
)
;
assert
.
compareArray
(
f64Repr
(
expected
)
[
0x3a
0xe5
0x79
0x8e
0xe2
0x30
0x8c
0x3b
]
"
the
bit
representation
of
the
result
is
0x3ae5798ee2308c3b
"
)
;
assert
.
sameValue
(
nextDown
(
expected
)
5
.
55111512312578_281826e
-
25
"
the
next
Number
in
direction
-
Infinity
is
less
precise
"
)
;
assert
.
sameValue
(
nextUp
(
expected
)
5
.
55111512312578_465497e
-
25
"
the
next
Number
in
direction
+
Infinity
is
less
precise
"
)
;
assert
.
sameValue
(
d
.
total
(
{
unit
:
"
years
"
relativeTo
}
)
expected
"
Correct
division
by
large
number
in
years
total
"
)
;
assert
.
sameValue
(
d
.
total
(
{
unit
:
"
months
"
relativeTo
}
)
expected
"
Correct
division
by
large
number
in
months
total
"
)
;
assert
.
sameValue
(
d
.
total
(
{
unit
:
"
weeks
"
relativeTo
}
)
expected
"
Correct
division
by
large
number
in
weeks
total
"
)
;
reportCompare
(
0
0
)
;
