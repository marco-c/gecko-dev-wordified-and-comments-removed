const
duration
=
Temporal
.
Duration
.
from
(
{
days
:
1
}
)
;
const
dayLengthNs
=
86400000000000n
;
const
dayInstant
=
new
Temporal
.
Instant
(
dayLengthNs
)
;
let
calls
=
0
;
const
timeZone
=
new
class
extends
Temporal
.
TimeZone
{
getPossibleInstantsFor
(
)
{
calls
+
+
;
return
[
dayInstant
]
;
}
}
(
"
UTC
"
)
;
const
relativeTo
=
new
Temporal
.
ZonedDateTime
(
0n
timeZone
)
;
assert
.
throws
(
RangeError
(
)
=
>
duration
.
total
(
{
unit
:
"
days
"
relativeTo
}
)
"
indefinite
loop
is
prevented
"
)
;
assert
.
sameValue
(
calls
4
"
getPossibleInstantsFor
is
not
called
indefinitely
"
)
;
reportCompare
(
0
0
)
;
