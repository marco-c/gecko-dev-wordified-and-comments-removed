assert
.
sameValue
(
typeof
String
.
prototype
.
replaceAll
'
function
'
'
function
must
exist
'
)
;
var
poisoned
=
0
;
var
poison
=
{
toString
(
)
{
poisoned
+
=
1
;
throw
'
Should
not
call
toString
on
this
/
replaceValue
'
;
}
}
;
var
searchValue
=
/
.
/
;
assert
.
throws
(
TypeError
function
(
)
{
'
'
.
replaceAll
.
call
(
poison
searchValue
poison
)
;
}
'
flags
is
the
empty
string
'
)
;
Object
.
defineProperty
(
searchValue
'
flags
'
{
value
:
'
G
'
writable
:
true
configurable
:
true
}
)
;
assert
.
throws
(
TypeError
function
(
)
{
'
'
.
replaceAll
.
call
(
poison
searchValue
poison
)
;
}
'
case
sensitive
G
'
)
;
Object
.
defineProperty
(
searchValue
'
flags
'
{
value
:
'
i
'
writable
:
true
configurable
:
true
}
)
;
assert
.
throws
(
TypeError
function
(
)
{
'
'
.
replaceAll
.
call
(
poison
searchValue
poison
)
;
}
'
i
'
)
;
assert
.
sameValue
(
poisoned
0
)
;
reportCompare
(
0
0
)
;
