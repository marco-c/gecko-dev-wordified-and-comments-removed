assert
.
sameValue
(
typeof
String
.
prototype
.
replaceAll
'
function
'
'
function
must
exist
'
)
;
var
thisValueCalled
=
0
;
var
thisValue
=
{
toString
(
)
{
thisValueCalled
+
=
1
;
return
'
'
;
}
}
;
var
searchValueCalled
=
0
;
var
searchValue
=
{
toString
(
)
{
searchValueCalled
+
=
1
;
return
'
'
;
}
}
;
var
called
=
0
;
var
replaceValue
=
{
toString
(
)
{
called
+
=
1
;
throw
new
Test262Error
(
)
;
}
}
;
assert
.
throws
(
Test262Error
function
(
)
{
'
'
.
replaceAll
.
call
(
thisValue
searchValue
replaceValue
)
;
}
'
custom
'
)
;
assert
.
sameValue
(
called
1
)
;
assert
.
sameValue
(
thisValueCalled
1
)
;
assert
.
sameValue
(
searchValueCalled
1
)
;
searchValueCalled
=
0
;
thisValueCalled
=
0
;
called
=
0
;
replaceValue
=
{
toString
(
)
{
called
+
=
1
;
return
Symbol
(
)
;
}
}
;
assert
.
throws
(
TypeError
function
(
)
{
'
'
.
replaceAll
.
call
(
thisValue
searchValue
replaceValue
)
;
}
'
Symbol
'
)
;
assert
.
sameValue
(
called
1
)
;
assert
.
sameValue
(
thisValueCalled
1
)
;
assert
.
sameValue
(
searchValueCalled
1
)
;
reportCompare
(
0
0
)
;
