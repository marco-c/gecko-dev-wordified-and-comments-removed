function
testIterationCount
(
iterator
expectedLength
)
{
for
(
let
i
=
0
;
i
<
expectedLength
;
i
+
+
)
assertEq
(
iterator
.
next
(
)
.
done
false
)
;
assertEq
(
iterator
.
next
(
)
.
done
true
)
;
}
let
i8Array
=
new
Int8Array
(
4
)
;
Object
.
defineProperty
(
i8Array
"
length
"
{
value
:
0
}
)
;
let
i8Iterator
=
i8Array
[
Symbol
.
iterator
]
(
)
;
testIterationCount
(
i8Iterator
4
)
;
i8Array
=
new
Int8Array
(
)
;
Object
.
defineProperty
(
i8Array
"
length
"
{
get
(
)
{
throw
TypeError
;
}
}
)
;
i8Iterator
=
i8Array
[
Symbol
.
iterator
]
(
)
;
testIterationCount
(
i8Iterator
0
)
;
i8Array
=
new
Uint8Array
(
1
)
;
Object
.
defineProperty
(
i8Array
"
length
"
{
value
:
15
}
)
;
(
new
Uint8Array
(
4
)
)
.
set
(
i8Array
3
)
;
let
g2
=
newGlobal
(
)
;
i8Array
=
new
Int8Array
(
8
)
;
Object
.
defineProperty
(
i8Array
"
length
"
{
value
:
0
}
)
;
let
iterator
=
i8Array
[
Symbol
.
iterator
]
(
)
;
iterator
.
next
=
g2
.
Array
.
prototype
[
Symbol
.
iterator
]
(
)
.
next
;
testIterationCount
(
iterator
8
)
;
if
(
typeof
reportCompare
=
=
=
"
function
"
)
reportCompare
(
true
true
)
;
