function
test
(
)
{
var
returnCalled
=
0
;
var
returnCalledExpected
=
0
;
var
iterable
=
{
}
;
iterable
[
Symbol
.
iterator
]
=
makeIterator
(
{
next
:
function
(
)
{
return
{
done
:
true
}
;
}
ret
:
function
(
)
{
returnCalled
+
+
;
return
{
}
;
}
}
)
;
var
[
]
=
iterable
;
assertEq
(
returnCalled
+
+
returnCalledExpected
)
;
iterable
[
Symbol
.
iterator
]
=
makeIterator
(
{
ret
:
function
(
)
{
returnCalled
+
+
;
return
{
}
;
}
}
)
;
var
[
]
=
iterable
;
assertEq
(
returnCalled
+
+
returnCalledExpected
)
;
var
[
a
b
]
=
iterable
;
assertEq
(
returnCalled
+
+
returnCalledExpected
)
;
var
[
c
]
=
iterable
;
assertEq
(
returnCalled
+
+
returnCalledExpected
)
;
function
throwlhs
(
)
{
throw
"
in
lhs
"
;
}
assertThrowsValue
(
function
(
)
{
0
[
.
.
.
{
}
[
throwlhs
(
)
]
]
=
iterable
;
}
"
in
lhs
"
)
;
assertEq
(
returnCalled
+
+
returnCalledExpected
)
;
iterable
[
Symbol
.
iterator
]
=
makeIterator
(
{
next
:
function
(
)
{
return
{
}
;
}
ret
:
function
(
)
{
returnCalled
+
+
;
return
{
}
;
}
}
)
;
assertThrowsValue
(
function
(
)
{
0
[
.
.
.
{
}
[
throwlhs
(
)
]
]
=
iterable
;
}
"
in
lhs
"
)
;
assertEq
(
returnCalled
+
+
returnCalledExpected
)
;
iterable
[
Symbol
.
iterator
]
=
makeIterator
(
{
next
:
function
(
)
{
throw
"
in
next
"
;
}
ret
:
function
(
)
{
returnCalled
+
+
;
return
{
}
;
}
}
)
;
assertThrowsValue
(
function
(
)
{
var
[
d
]
=
iterable
;
}
"
in
next
"
)
;
assertEq
(
returnCalled
returnCalledExpected
)
;
iterable
[
Symbol
.
iterator
]
=
makeIterator
(
{
ret
:
function
(
)
{
returnCalled
+
+
;
return
42
;
}
}
)
;
assertThrowsInstanceOf
(
function
(
)
{
var
[
]
=
iterable
;
}
TypeError
)
;
assertEq
(
returnCalled
+
+
returnCalledExpected
)
;
}
test
(
)
;
if
(
typeof
reportCompare
=
=
=
"
function
"
)
reportCompare
(
0
0
)
;
