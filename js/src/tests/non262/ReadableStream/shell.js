function
asyncSleep
(
ticks
)
{
let
p
=
Promise
.
resolve
(
)
;
if
(
ticks
>
0
)
{
return
p
.
then
(
(
)
=
>
asyncSleep
(
ticks
-
1
)
)
;
}
return
p
;
}
function
runAsyncTest
(
test
)
{
let
passed
=
false
;
let
problem
=
"
test
did
not
finish
"
;
test
(
)
.
then
(
_
=
>
{
passed
=
true
;
}
)
.
catch
(
exc
=
>
{
problem
=
exc
;
}
)
;
drainJobQueue
(
)
;
if
(
!
passed
)
{
throw
problem
;
}
reportCompare
(
0
0
)
;
}
