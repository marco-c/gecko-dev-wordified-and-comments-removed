function
IsConstructor
(
o
)
{
try
{
new
(
new
Proxy
(
o
{
construct
:
(
)
=
>
(
{
}
)
}
)
)
;
return
true
;
}
catch
(
e
)
{
return
false
;
}
}
function
IsObject
(
o
)
{
return
Object
(
o
)
=
=
=
o
;
}
function
thisValues
(
)
{
const
intlConstructors
=
Object
.
getOwnPropertyNames
(
Intl
)
.
map
(
name
=
>
Intl
[
name
]
)
.
filter
(
IsConstructor
)
;
return
[
.
.
.
[
undefined
null
true
"
abc
"
Symbol
(
)
123
]
.
.
.
[
{
}
[
]
/
(
?
:
)
/
function
(
)
{
}
new
Proxy
(
{
}
{
}
)
]
.
.
.
[
]
.
concat
(
.
.
.
intlConstructors
.
map
(
ctor
=
>
[
new
ctor
(
)
new
class
extends
ctor
{
}
Object
.
create
(
ctor
.
prototype
)
Object
.
setPrototypeOf
(
new
ctor
(
)
Object
.
prototype
)
]
)
)
]
;
}
for
(
let
thisValue
of
thisValues
(
)
)
{
let
obj
=
Intl
.
Collator
.
call
(
thisValue
)
;
assertEq
(
Object
.
is
(
obj
thisValue
)
false
)
;
assertEq
(
obj
instanceof
Intl
.
Collator
true
)
;
if
(
IsObject
(
thisValue
)
)
assertEqArray
(
Object
.
getOwnPropertySymbols
(
thisValue
)
[
]
)
;
}
for
(
let
thisValue
of
thisValues
(
)
)
{
Object
.
defineProperty
(
Intl
.
Collator
Symbol
.
hasInstance
{
get
(
)
{
assertEq
(
false
true
"
hasInstance
operator
called
"
)
;
}
configurable
:
true
}
)
;
let
obj
=
Intl
.
Collator
.
call
(
thisValue
)
;
delete
Intl
.
Collator
[
Symbol
.
hasInstance
]
;
assertEq
(
Object
.
is
(
obj
thisValue
)
false
)
;
assertEq
(
obj
instanceof
Intl
.
Collator
true
)
;
}
if
(
typeof
reportCompare
=
=
=
"
function
"
)
reportCompare
(
true
true
)
;
