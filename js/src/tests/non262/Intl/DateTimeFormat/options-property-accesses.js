if
(
typeof
getBuildConfiguration
=
=
=
"
undefined
"
)
{
var
getBuildConfiguration
=
SpecialPowers
.
Cu
.
getJSTestingFunctions
(
)
.
getBuildConfiguration
;
}
var
isNightly
=
!
getBuildConfiguration
(
)
.
release_or_beta
;
var
log
;
var
proxy
=
new
Proxy
(
{
year
:
"
numeric
"
hour
:
"
numeric
"
}
new
Proxy
(
{
get
(
t
pk
r
)
{
log
.
push
(
pk
)
;
return
Reflect
.
get
(
t
pk
r
)
;
}
}
{
get
(
t
pk
r
)
{
assertEq
(
pk
"
get
"
)
;
return
Reflect
.
get
(
t
pk
r
)
;
}
}
)
)
;
var
dayPeriod
=
isNightly
?
[
"
dayPeriod
"
]
:
[
]
;
var
constructorAccesses
=
[
"
weekday
"
"
year
"
"
month
"
"
day
"
.
.
.
dayPeriod
"
hour
"
"
minute
"
"
second
"
"
fractionalSecondDigits
"
"
dateStyle
"
"
timeStyle
"
"
localeMatcher
"
"
calendar
"
"
numberingSystem
"
"
hour12
"
"
hourCycle
"
"
timeZone
"
"
weekday
"
"
era
"
"
year
"
"
month
"
"
day
"
.
.
.
dayPeriod
"
hour
"
"
minute
"
"
second
"
"
fractionalSecondDigits
"
"
timeZoneName
"
"
formatMatcher
"
"
dateStyle
"
"
timeStyle
"
]
;
log
=
[
]
;
new
Intl
.
DateTimeFormat
(
undefined
proxy
)
;
assertEqArray
(
log
constructorAccesses
)
;
log
=
[
]
;
new
Date
(
)
.
toLocaleString
(
undefined
proxy
)
;
assertEqArray
(
log
[
"
weekday
"
"
year
"
"
month
"
"
day
"
.
.
.
dayPeriod
"
hour
"
"
minute
"
"
second
"
"
fractionalSecondDigits
"
"
dateStyle
"
"
timeStyle
"
.
.
.
constructorAccesses
]
)
;
log
=
[
]
;
new
Date
(
)
.
toLocaleDateString
(
undefined
proxy
)
;
assertEqArray
(
log
[
"
weekday
"
"
year
"
"
month
"
"
day
"
"
dateStyle
"
"
timeStyle
"
.
.
.
constructorAccesses
]
)
;
log
=
[
]
;
new
Date
(
)
.
toLocaleTimeString
(
undefined
proxy
)
;
assertEqArray
(
log
[
.
.
.
dayPeriod
"
hour
"
"
minute
"
"
second
"
"
fractionalSecondDigits
"
"
dateStyle
"
"
timeStyle
"
.
.
.
constructorAccesses
]
)
;
if
(
typeof
reportCompare
=
=
=
"
function
"
)
reportCompare
(
0
0
)
;
