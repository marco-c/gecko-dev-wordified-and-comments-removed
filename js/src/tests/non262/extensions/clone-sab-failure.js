if
(
!
this
.
SharedArrayBuffer
|
|
!
this
.
sharedArrayRawBufferRefcount
)
{
reportCompare
(
true
true
)
;
quit
(
0
)
;
}
let
x
=
new
SharedArrayBuffer
(
1
)
;
assertEq
(
sharedArrayRawBufferRefcount
(
x
)
1
)
;
let
y
=
serialize
(
x
[
]
{
SharedArrayBuffer
:
'
allow
'
}
)
;
assertEq
(
sharedArrayRawBufferRefcount
(
x
)
2
)
;
var
failed
=
false
;
try
{
serialize
(
[
x
function
(
)
{
}
]
)
;
}
catch
(
e
)
{
failed
=
true
;
}
assertEq
(
failed
true
)
;
assertEq
(
sharedArrayRawBufferRefcount
(
x
)
2
)
;
reportCompare
(
true
true
)
;
