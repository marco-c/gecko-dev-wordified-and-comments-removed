var
msPerDay
=
86400000
;
var
msPerHour
=
3600000
;
var
TZ_DIFF
=
getTimeZoneDiff
(
)
;
var
TZ_ADJUST
=
TZ_DIFF
*
msPerHour
;
var
TIME_1970
=
0
;
var
TIME_2000
=
946684800000
;
var
TIME_1900
=
-
2208988800000
;
var
UTC_29_FEB_2000
=
TIME_2000
+
31
*
msPerDay
+
28
*
msPerDay
;
var
UTC_1_JAN_2005
=
TIME_2000
+
TimeInYear
(
2000
)
+
TimeInYear
(
2001
)
+
TimeInYear
(
2002
)
+
TimeInYear
(
2003
)
+
TimeInYear
(
2004
)
;
var
now
=
new
Date
(
)
;
var
TIME_NOW
=
now
.
valueOf
(
)
;
function
getTimeZoneDiff
(
)
{
return
-
(
(
new
Date
(
2000
1
1
)
)
.
getTimezoneOffset
(
)
)
/
60
;
}
function
DaysInYear
(
y
)
{
if
(
y
%
4
!
=
0
)
{
return
365
;
}
if
(
(
y
%
4
=
=
0
)
&
&
(
y
%
100
!
=
0
)
)
{
return
366
;
}
if
(
(
y
%
100
=
=
0
)
&
&
(
y
%
400
!
=
0
)
)
{
return
365
;
}
if
(
(
y
%
400
=
=
0
)
)
{
return
366
;
}
else
{
return
"
ERROR
:
DaysInYear
(
"
+
y
+
"
)
case
not
covered
"
;
}
}
function
TimeInYear
(
y
)
{
return
(
DaysInYear
(
y
)
*
msPerDay
)
;
}
function
TimeWithinDay
(
t
)
{
var
r
=
t
%
msPerDay
;
if
(
r
<
0
)
{
r
+
=
msPerDay
;
}
return
r
;
}
