GeckoProgram
(
"
js
"
linkage
=
None
)
if
CONFIG
[
"
JS_BUNDLED_EDITLINE
"
]
:
DIRS
+
=
[
"
.
.
/
editline
"
]
USE_LIBS
+
=
[
"
editline
"
]
USE_LIBS
+
=
[
"
static
:
js
"
]
include
(
"
.
.
/
js
-
compileflags
.
mozbuild
"
)
include
(
"
.
.
/
js
-
config
.
mozbuild
"
)
include
(
"
.
.
/
js
-
cxxflags
.
mozbuild
"
)
include
(
"
.
.
/
js
-
standalone
.
mozbuild
"
)
UNIFIED_SOURCES
+
=
[
"
js
.
cpp
"
"
jsoptparse
.
cpp
"
"
jsshell
.
cpp
"
"
ModuleLoader
.
cpp
"
"
OSObject
.
cpp
"
"
ShellModuleObjectWrapper
.
cpp
"
"
WasmTesting
.
cpp
"
]
if
CONFIG
[
"
FUZZING_INTERFACES
"
]
:
UNIFIED_SOURCES
+
=
[
"
jsrtfuzzing
/
jsrtfuzzing
.
cpp
"
]
if
CONFIG
[
"
LIBFUZZER
"
]
:
USE_LIBS
+
=
[
"
static
:
fuzzer
"
]
else
:
USE_LIBS
+
=
[
"
static
:
fuzzer
-
interface
"
]
if
CONFIG
[
"
FUZZING_JS_FUZZILLI
"
]
and
CONFIG
[
"
OS_ARCH
"
]
=
=
"
Linux
"
:
OS_LIBS
+
=
[
"
rt
"
]
DEFINES
[
"
EXPORT_JS_API
"
]
=
True
LOCAL_INCLUDES
+
=
[
"
!
.
.
"
"
.
.
"
]
OS_LIBS
+
=
CONFIG
[
"
EDITLINE_LIBS
"
]
FINAL_TARGET_FILES
+
=
[
"
js
-
gdb
.
py
"
]
OBJDIR_FILES
.
js
.
src
.
shell
+
=
[
"
!
/
dist
/
bin
/
js
-
gdb
.
py
"
]
OBJDIR_FILES
.
js
.
src
+
=
[
"
!
/
dist
/
bin
/
js
%
s
"
%
CONFIG
[
"
BIN_SUFFIX
"
]
]
if
CONFIG
[
"
OS_ARCH
"
]
=
=
"
WASI
"
:
LDFLAGS
+
=
[
"
-
Wl
-
z
stack
-
size
=
1048576
"
"
-
Wl
-
-
stack
-
first
"
]
OS_LIBS
+
=
[
"
wasi
-
emulated
-
process
-
clocks
"
"
wasi
-
emulated
-
getpid
"
]
if
CONFIG
[
"
OS_TARGET
"
]
=
=
"
Android
"
:
LDFLAGS
+
=
[
"
-
Wl
-
rpath
=
ORIGIN
"
]
