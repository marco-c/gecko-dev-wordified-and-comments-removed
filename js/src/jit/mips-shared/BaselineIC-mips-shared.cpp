#
include
"
jit
/
BaselineIC
.
h
"
#
include
"
jit
/
SharedICHelpers
.
h
"
using
namespace
js
;
using
namespace
js
:
:
jit
;
namespace
js
{
namespace
jit
{
bool
ICCompare_Double
:
:
Compiler
:
:
generateStubCode
(
MacroAssembler
&
masm
)
{
Label
failure
isNaN
;
masm
.
ensureDouble
(
R0
FloatReg0
&
failure
)
;
masm
.
ensureDouble
(
R1
FloatReg1
&
failure
)
;
Register
dest
=
R0
.
scratchReg
(
)
;
Assembler
:
:
DoubleCondition
doubleCond
=
JSOpToDoubleCondition
(
op
)
;
masm
.
ma_cmp_set_double
(
dest
FloatReg0
FloatReg1
doubleCond
)
;
masm
.
tagValue
(
JSVAL_TYPE_BOOLEAN
dest
R0
)
;
EmitReturnFromIC
(
masm
)
;
masm
.
bind
(
&
failure
)
;
EmitStubGuardFailure
(
masm
)
;
return
true
;
}
}
}
