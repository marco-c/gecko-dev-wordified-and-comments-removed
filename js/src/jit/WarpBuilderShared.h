#
ifndef
jit_WarpBuilderShared_h
#
define
jit_WarpBuilderShared_h
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
js
/
Value
.
h
"
namespace
js
{
class
BytecodeLocation
;
namespace
jit
{
class
CallInfo
;
class
MBasicBlock
;
class
MCall
;
class
MConstant
;
class
MInstruction
;
class
MIRGenerator
;
class
TempAllocator
;
class
WarpSnapshot
;
class
WrappedFunction
;
class
WarpBuilderShared
{
WarpSnapshot
&
snapshot_
;
MIRGenerator
&
mirGen_
;
TempAllocator
&
alloc_
;
protected
:
MBasicBlock
*
current
;
WarpBuilderShared
(
WarpSnapshot
&
snapshot
MIRGenerator
&
mirGen
MBasicBlock
*
current_
)
;
MOZ_MUST_USE
bool
resumeAfter
(
MInstruction
*
ins
BytecodeLocation
loc
)
;
MConstant
*
constant
(
const
JS
:
:
Value
&
v
)
;
void
pushConstant
(
const
JS
:
:
Value
&
v
)
;
MCall
*
makeCall
(
CallInfo
&
callInfo
bool
needsThisCheck
WrappedFunction
*
target
=
nullptr
bool
isDOMCall
=
false
)
;
MInstruction
*
makeSpreadCall
(
CallInfo
&
callInfo
bool
isSameRealm
=
false
WrappedFunction
*
target
=
nullptr
)
;
public
:
MBasicBlock
*
currentBlock
(
)
const
{
return
current
;
}
WarpSnapshot
&
snapshot
(
)
const
{
return
snapshot_
;
}
MIRGenerator
&
mirGen
(
)
{
return
mirGen_
;
}
TempAllocator
&
alloc
(
)
{
return
alloc_
;
}
}
;
}
}
#
endif
