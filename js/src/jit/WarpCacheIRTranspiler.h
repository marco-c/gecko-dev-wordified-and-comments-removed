#
ifndef
jit_WarpCacheIRTranspiler_h
#
define
jit_WarpCacheIRTranspiler_h
#
include
"
js
/
AllocPolicy
.
h
"
#
include
"
js
/
Vector
.
h
"
namespace
js
{
namespace
jit
{
class
MBasicBlock
;
class
MDefinition
;
class
MInstruction
;
class
MIRGenerator
;
class
WarpCacheIR
;
using
MDefinitionStackVector
=
Vector
<
MDefinition
*
8
SystemAllocPolicy
>
;
#
define
WARP_CACHE_IR_OPS
(
_
)
\
_
(
GuardClass
)
\
_
(
GuardShape
)
\
_
(
GuardToObject
)
\
_
(
GuardToString
)
\
_
(
GuardToInt32Index
)
\
_
(
LoadEnclosingEnvironment
)
\
_
(
LoadDynamicSlotResult
)
\
_
(
LoadFixedSlotResult
)
\
_
(
LoadEnvironmentFixedSlotResult
)
\
_
(
LoadEnvironmentDynamicSlotResult
)
\
_
(
LoadInt32ArrayLengthResult
)
\
_
(
LoadStringLengthResult
)
\
_
(
LoadDenseElementResult
)
\
_
(
TypeMonitorResult
)
\
_
(
ReturnFromIC
)
struct
MOZ_STACK_CLASS
TranspilerOutput
{
MDefinition
*
result
=
nullptr
;
TranspilerOutput
(
)
=
default
;
TranspilerOutput
(
const
TranspilerOutput
&
)
=
delete
;
void
operator
=
(
const
TranspilerOutput
&
)
=
delete
;
}
;
MOZ_MUST_USE
bool
TranspileCacheIRToMIR
(
MIRGenerator
&
mirGen
MBasicBlock
*
current
const
WarpCacheIR
*
snapshot
const
MDefinitionStackVector
&
inputs
TranspilerOutput
&
output
)
;
}
}
#
endif
