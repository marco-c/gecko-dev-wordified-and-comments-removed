#
ifndef
jit_CompileWrappers_h
#
define
jit_CompileWrappers_h
#
include
<
stdint
.
h
>
#
include
"
gc
/
Pretenuring
.
h
"
#
include
"
js
/
TypeDecls
.
h
"
#
include
"
vm
/
Realm
.
h
"
#
include
"
vm
/
RealmFuses
.
h
"
struct
JSAtomState
;
namespace
mozilla
:
:
non_crypto
{
class
XorShift128PlusRNG
;
}
namespace
JS
{
enum
class
TraceKind
;
}
namespace
js
{
class
GeckoProfilerRuntime
;
class
GlobalObject
;
struct
JSDOMCallbacks
;
class
PropertyName
;
class
StaticStrings
;
struct
WellKnownSymbols
;
using
DOMCallbacks
=
struct
JSDOMCallbacks
;
namespace
gc
{
enum
class
AllocKind
:
uint8_t
;
class
FreeSpan
;
}
namespace
jit
{
class
JitRuntime
;
class
CompileRuntime
{
JSRuntime
*
runtime
(
)
;
public
:
static
CompileRuntime
*
get
(
JSRuntime
*
rt
)
;
#
ifdef
JS_GC_ZEAL
const
uint32_t
*
addressOfGCZealModeBits
(
)
;
#
endif
const
JitRuntime
*
jitRuntime
(
)
;
GeckoProfilerRuntime
&
geckoProfiler
(
)
;
bool
hadOutOfMemory
(
)
;
bool
profilingScripts
(
)
;
const
JSAtomState
&
names
(
)
;
const
PropertyName
*
emptyString
(
)
;
const
StaticStrings
&
staticStrings
(
)
;
const
WellKnownSymbols
&
wellKnownSymbols
(
)
;
const
JSClass
*
maybeWindowProxyClass
(
)
;
const
void
*
mainContextPtr
(
)
;
const
void
*
addressOfJitStackLimit
(
)
;
const
void
*
addressOfInterruptBits
(
)
;
const
void
*
addressOfZone
(
)
;
const
void
*
addressOfMegamorphicCache
(
)
;
const
void
*
addressOfMegamorphicSetPropCache
(
)
;
const
void
*
addressOfStringToAtomCache
(
)
;
const
void
*
addressOfLastBufferedWholeCell
(
)
;
#
ifdef
DEBUG
const
void
*
addressOfIonBailAfterCounter
(
)
;
#
endif
const
DOMCallbacks
*
DOMcallbacks
(
)
;
bool
runtimeMatches
(
JSRuntime
*
rt
)
;
}
;
class
JitZone
;
class
CompileZone
{
friend
class
MacroAssembler
;
JS
:
:
Zone
*
zone
(
)
;
public
:
static
CompileZone
*
get
(
JS
:
:
Zone
*
zone
)
;
const
JitZone
*
jitZone
(
)
;
CompileRuntime
*
runtime
(
)
;
bool
isAtomsZone
(
)
;
const
uint32_t
*
addressOfNeedsIncrementalBarrier
(
)
;
uint32_t
*
addressOfTenuredAllocCount
(
)
;
gc
:
:
FreeSpan
*
*
addressOfFreeList
(
gc
:
:
AllocKind
allocKind
)
;
bool
allocNurseryObjects
(
)
;
bool
allocNurseryStrings
(
)
;
bool
allocNurseryBigInts
(
)
;
void
*
addressOfNurseryPosition
(
)
;
void
*
addressOfNurseryAllocatedSites
(
)
;
bool
canNurseryAllocateStrings
(
)
;
bool
canNurseryAllocateBigInts
(
)
;
gc
:
:
AllocSite
*
catchAllAllocSite
(
JS
:
:
TraceKind
traceKind
gc
:
:
CatchAllAllocSite
siteKind
)
;
bool
hasRealmWithAllocMetadataBuilder
(
)
;
}
;
class
CompileRealm
{
JS
:
:
Realm
*
realm
(
)
;
public
:
static
CompileRealm
*
get
(
JS
:
:
Realm
*
realm
)
;
CompileZone
*
zone
(
)
;
CompileRuntime
*
runtime
(
)
;
const
void
*
realmPtr
(
)
{
return
realm
(
)
;
}
RealmFuses
&
realmFuses
(
)
{
return
realm
(
)
-
>
realmFuses
;
}
const
mozilla
:
:
non_crypto
:
:
XorShift128PlusRNG
*
addressOfRandomNumberGenerator
(
)
;
const
GlobalObject
*
maybeGlobal
(
)
;
const
uint32_t
*
addressOfGlobalWriteBarriered
(
)
;
}
;
class
JitCompileOptions
{
public
:
JitCompileOptions
(
)
;
explicit
JitCompileOptions
(
JSContext
*
cx
)
;
bool
profilerSlowAssertionsEnabled
(
)
const
{
return
profilerSlowAssertionsEnabled_
;
}
bool
offThreadCompilationAvailable
(
)
const
{
return
offThreadCompilationAvailable_
;
}
#
ifdef
DEBUG
bool
ionBailAfterEnabled
(
)
const
{
return
ionBailAfterEnabled_
;
}
#
endif
private
:
bool
profilerSlowAssertionsEnabled_
;
bool
offThreadCompilationAvailable_
;
#
ifdef
DEBUG
bool
ionBailAfterEnabled_
=
false
;
#
endif
}
;
}
}
#
endif
