#
include
"
js
/
LocaleSensitive
.
h
"
#
include
"
jsapi
-
tests
/
tests
.
h
"
BEGIN_TEST
(
testDateToLocaleString
)
{
JSRuntime
*
rt
=
JS_GetRuntime
(
cx
)
;
JS
:
:
Rooted
<
JS
:
:
Value
>
haveIntl
(
cx
)
;
EVAL
(
"
typeof
Intl
!
=
=
'
undefined
'
"
&
haveIntl
)
;
if
(
!
haveIntl
.
toBoolean
(
)
)
return
true
;
CHECK
(
JS_SetDefaultLocale
(
rt
"
de
"
)
)
;
EXEC
(
"
var
d
=
new
Date
(
Date
.
UTC
(
2015
9
-
1
17
)
)
;
"
)
;
EXEC
(
"
var
deAll
=
d
.
toLocaleString
(
)
;
"
)
;
CHECK
(
JS_SetDefaultLocale
(
rt
"
en
"
)
)
;
EXEC
(
"
if
(
d
.
toLocaleString
(
)
=
=
=
deAll
)
\
n
"
"
throw
'
toLocaleString
results
should
have
changed
with
system
locale
change
'
;
"
)
;
EXEC
(
"
var
enDate
=
d
.
toLocaleDateString
(
)
;
"
)
;
CHECK
(
JS_SetDefaultLocale
(
rt
"
de
"
)
)
;
EXEC
(
"
if
(
d
.
toLocaleDateString
(
)
=
=
=
enDate
)
\
n
"
"
throw
'
toLocaleDateString
results
should
have
changed
with
system
locale
change
'
;
"
)
;
EXEC
(
"
var
deTime
=
d
.
toLocaleTimeString
(
)
;
"
)
;
CHECK
(
JS_SetDefaultLocale
(
rt
"
en
"
)
)
;
EXEC
(
"
if
(
d
.
toLocaleTimeString
(
)
=
=
=
deTime
)
\
n
"
"
throw
'
toLocaleTimeString
results
should
have
changed
with
system
locale
change
'
;
"
)
;
JS_ResetDefaultLocale
(
rt
)
;
return
true
;
}
END_TEST
(
testDateToLocaleString
)
