#
include
<
unistd
.
h
>
#
include
"
threading
/
CpuCount
.
h
"
uint32_t
js
:
:
GetCPUCount
(
)
{
static
uint32_t
ncpus
=
0
;
if
(
ncpus
=
=
0
)
{
#
if
defined
(
_SC_NPROCESSORS_CONF
)
long
n
=
sysconf
(
_SC_NPROCESSORS_CONF
)
;
ncpus
=
(
n
>
0
)
?
uint32_t
(
n
)
:
1
;
#
elif
defined
(
_SC_NPROCESSORS_ONLN
)
long
n
=
sysconf
(
_SC_NPROCESSORS_ONLN
)
;
ncpus
=
(
n
>
0
)
?
uint32_t
(
n
)
:
1
;
#
else
ncpus
=
1
;
#
endif
}
return
ncpus
;
}
