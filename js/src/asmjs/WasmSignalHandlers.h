#
ifndef
wasm_signal_handlers_h
#
define
wasm_signal_handlers_h
#
if
defined
(
XP_DARWIN
)
&
&
defined
(
ASMJS_MAY_USE_SIGNAL_HANDLERS_FOR_OOB
)
#
include
<
mach
/
mach
.
h
>
#
include
"
jslock
.
h
"
#
endif
struct
JSRuntime
;
namespace
js
{
extern
void
InterruptRunningJitCode
(
JSRuntime
*
rt
)
;
namespace
wasm
{
bool
EnsureSignalHandlersInstalled
(
JSRuntime
*
rt
)
;
#
if
defined
(
XP_DARWIN
)
&
&
defined
(
ASMJS_MAY_USE_SIGNAL_HANDLERS_FOR_OOB
)
class
MachExceptionHandler
{
bool
installed_
;
PRThread
*
thread_
;
mach_port_t
port_
;
void
uninstall
(
)
;
public
:
MachExceptionHandler
(
)
;
~
MachExceptionHandler
(
)
{
uninstall
(
)
;
}
mach_port_t
port
(
)
const
{
return
port_
;
}
bool
installed
(
)
const
{
return
installed_
;
}
bool
install
(
JSRuntime
*
rt
)
;
}
;
#
endif
}
}
#
endif
