if
(
!
(
"
startgc
"
in
this
&
&
"
offThreadCompileScript
"
in
this
&
&
"
runOffThreadScript
"
in
this
)
)
{
quit
(
)
;
}
if
(
helperThreadCount
(
)
=
=
0
)
quit
(
)
;
gczeal
(
0
)
;
gc
(
)
;
startgc
(
0
)
;
var
g
=
newGlobal
(
)
;
if
(
"
gcstate
"
in
this
)
assertEq
(
gcstate
(
)
"
Mark
"
)
;
g
.
offThreadCompileScript
(
'
23
;
'
{
}
)
;
assertEq
(
23
g
.
runOffThreadScript
(
)
)
;
if
(
"
gcstate
"
in
this
)
assertEq
(
gcstate
(
)
"
NotActive
"
)
;
print
(
"
done
"
)
;
