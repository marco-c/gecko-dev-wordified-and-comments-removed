function
float32
(
f16
i
index
)
{
i
=
i
|
0
;
let
x
=
Math
.
fround
(
i
+
0
.
1
)
;
let
y
=
Math
.
fround
(
Math
.
sqrt
(
x
)
)
;
f16
[
index
]
=
y
;
}
function
float64
(
f16
i
index
)
{
i
=
i
|
0
;
let
x
=
Math
.
fround
(
i
+
0
.
1
)
;
let
y
=
Math
.
sqrt
(
x
)
;
f16
[
index
]
=
y
;
}
function
toBaseline
(
f
)
{
let
source
=
f
.
toString
(
)
;
assertEq
(
source
.
at
(
-
1
)
"
}
"
)
;
source
=
source
.
slice
(
0
-
1
)
+
"
;
with
(
{
}
)
;
}
"
;
return
Function
(
return
{
source
}
;
)
(
)
;
}
const
LIMIT
=
1550
;
let
float32_baseline
=
toBaseline
(
float32
)
;
let
float64_baseline
=
toBaseline
(
float64
)
;
let
f16
=
new
Float16Array
(
1
)
;
let
u16
=
new
Uint16Array
(
f16
.
buffer
)
;
let
n
=
0
;
for
(
let
i
=
0
;
i
<
LIMIT
;
+
+
i
)
{
float32
(
f16
i
100_000
)
;
float64
(
f16
i
100_000
)
;
float32
(
f16
i
0
)
;
let
x
=
u16
[
0
]
;
float32_baseline
(
f16
i
0
)
;
assertEq
(
x
u16
[
0
]
)
;
float64
(
f16
i
0
)
;
let
y
=
u16
[
0
]
;
float64_baseline
(
f16
i
0
)
;
assertEq
(
y
u16
[
0
]
)
;
if
(
x
!
=
=
y
)
{
n
+
+
;
}
}
assertEq
(
n
1
)
;
