function
testStack
(
)
{
function
deepFunction
(
)
{
function
evenDeeper
(
)
{
throwOutOfMemory
(
)
;
}
return
evenDeeper
(
)
;
}
return
deepFunction
(
)
;
}
var
initialTrace
=
getLastOOMStackTrace
(
)
;
assertEq
(
initialTrace
null
)
;
try
{
testStack
(
)
;
assertEq
(
true
false
"
Expected
an
OOM
exception
"
)
;
}
catch
(
e
)
{
print
(
"
Exception
caught
:
"
+
e
)
;
var
finalTrace
=
getLastOOMStackTrace
(
)
;
assertEq
(
finalTrace
!
=
=
null
true
"
Expected
a
stack
trace
after
OOM
"
)
;
print
(
finalTrace
)
;
var
lines
=
finalTrace
.
split
(
'
\
n
'
)
.
filter
(
line
=
>
line
.
trim
(
)
)
;
assertEq
(
finalTrace
.
includes
(
"
#
"
)
true
)
;
}
