#
ifndef
frontend_TDZCheckCache_h
#
define
frontend_TDZCheckCache_h
#
include
"
mozilla
/
Maybe
.
h
"
#
include
"
ds
/
Nestable
.
h
"
#
include
"
frontend
/
NameCollections
.
h
"
namespace
js
{
namespace
frontend
{
struct
BytecodeEmitter
;
class
TaggedParserAtomIndex
;
enum
MaybeCheckTDZ
{
CheckTDZ
=
true
DontCheckTDZ
=
false
}
;
using
CheckTDZMap
=
RecyclableNameMap
<
MaybeCheckTDZ
>
;
class
TDZCheckCache
:
public
Nestable
<
TDZCheckCache
>
{
PooledMapPtr
<
CheckTDZMap
>
cache_
;
[
[
nodiscard
]
]
bool
ensureCache
(
BytecodeEmitter
*
bce
)
;
public
:
explicit
TDZCheckCache
(
BytecodeEmitter
*
bce
)
;
mozilla
:
:
Maybe
<
MaybeCheckTDZ
>
needsTDZCheck
(
BytecodeEmitter
*
bce
TaggedParserAtomIndex
name
)
;
[
[
nodiscard
]
]
bool
noteTDZCheck
(
BytecodeEmitter
*
bce
TaggedParserAtomIndex
name
MaybeCheckTDZ
check
)
;
}
;
}
}
#
endif
