#
ifndef
gc_Allocator_h
#
define
gc_Allocator_h
#
include
"
gc
/
GCLock
.
h
"
#
include
"
gc
/
Heap
.
h
"
#
include
"
js
/
RootingAPI
.
h
"
class
JSFatInlineString
;
namespace
js
{
struct
Class
;
template
<
typename
T
AllowGC
allowGC
=
CanGC
>
T
*
Allocate
(
JSContext
*
cx
)
;
template
<
AllowGC
allowGC
=
CanGC
>
JSObject
*
AllocateObject
(
JSContext
*
cx
gc
:
:
AllocKind
kind
size_t
nDynamicSlots
gc
:
:
InitialHeap
heap
const
Class
*
clasp
)
;
template
<
typename
StringAllocT
AllowGC
allowGC
=
CanGC
>
StringAllocT
*
AllocateStringImpl
(
JSContext
*
cx
gc
:
:
InitialHeap
heap
)
;
template
<
typename
StringT
AllowGC
allowGC
=
CanGC
>
StringT
*
AllocateString
(
JSContext
*
cx
gc
:
:
InitialHeap
heap
)
{
return
static_cast
<
StringT
*
>
(
AllocateStringImpl
<
JSString
allowGC
>
(
cx
heap
)
)
;
}
template
<
>
inline
JSFatInlineString
*
AllocateString
<
JSFatInlineString
CanGC
>
(
JSContext
*
cx
gc
:
:
InitialHeap
heap
)
{
return
static_cast
<
JSFatInlineString
*
>
(
js
:
:
AllocateStringImpl
<
JSFatInlineString
CanGC
>
(
cx
heap
)
)
;
}
template
<
>
inline
JSFatInlineString
*
AllocateString
<
JSFatInlineString
NoGC
>
(
JSContext
*
cx
gc
:
:
InitialHeap
heap
)
{
return
static_cast
<
JSFatInlineString
*
>
(
js
:
:
AllocateStringImpl
<
JSFatInlineString
NoGC
>
(
cx
heap
)
)
;
}
}
#
endif
