#
ifndef
gc_Verifier_h
#
define
gc_Verifier_h
#
include
<
algorithm
>
#
include
"
gc
/
Cell
.
h
"
namespace
js
{
namespace
gc
{
enum
class
CellColor
:
uint8_t
{
White
=
0
Gray
=
uint8_t
(
MarkColor
:
:
Gray
)
Black
=
uint8_t
(
MarkColor
:
:
Black
)
}
;
static
constexpr
CellColor
AllCellColors
[
]
=
{
CellColor
:
:
White
CellColor
:
:
Gray
CellColor
:
:
Black
}
;
static
constexpr
CellColor
MarkedCellColors
[
]
=
{
CellColor
:
:
Gray
CellColor
:
:
Black
}
;
inline
CellColor
GetCellColor
(
Cell
*
cell
)
{
if
(
cell
-
>
isMarkedBlack
(
)
)
{
return
CellColor
:
:
Black
;
}
if
(
cell
-
>
isMarkedGray
(
)
)
{
return
CellColor
:
:
Gray
;
}
return
CellColor
:
:
White
;
}
inline
CellColor
ExpectedWeakMapValueColor
(
CellColor
keyColor
CellColor
mapColor
)
{
return
std
:
:
min
(
keyColor
mapColor
)
;
}
inline
CellColor
ExpectedWeakMapKeyColor
(
CellColor
mapColor
CellColor
delegateColor
)
{
return
std
:
:
min
(
mapColor
delegateColor
)
;
}
inline
CellColor
ExpectedKeyAndDelegateColor
(
CellColor
keyColor
CellColor
delegateColor
)
{
return
std
:
:
max
(
keyColor
delegateColor
)
;
}
}
}
#
endif
