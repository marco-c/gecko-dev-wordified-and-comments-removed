#
ifndef
__JITPROFILING_H__
#
define
__JITPROFILING_H__
typedef
enum
iJIT_jvm_event
{
iJVM_EVENT_TYPE_SHUTDOWN
=
2
iJVM_EVENT_TYPE_METHOD_LOAD_FINISHED
=
13
iJVM_EVENT_TYPE_METHOD_UNLOAD_START
iJVM_EVENT_TYPE_METHOD_UPDATE
iJVM_EVENT_TYPE_METHOD_INLINE_LOAD_FINISHED
iJVM_EVENT_TYPE_ENTER_NIDS
=
19
iJVM_EVENT_TYPE_LEAVE_NIDS
iJVM_EVENT_TYPE_METHOD_LOAD_FINISHED_V2
}
iJIT_JVM_EVENT
;
typedef
enum
_iJIT_ModeFlags
{
iJIT_NO_NOTIFICATIONS
=
0x0000
iJIT_BE_NOTIFY_ON_LOAD
=
0x0001
iJIT_BE_NOTIFY_ON_UNLOAD
=
0x0002
iJIT_BE_NOTIFY_ON_METHOD_ENTRY
=
0x0004
iJIT_BE_NOTIFY_ON_METHOD_EXIT
=
0x0008
}
iJIT_ModeFlags
;
typedef
enum
_iJIT_IsProfilingActiveFlags
{
iJIT_NOTHING_RUNNING
=
0x0000
iJIT_SAMPLING_ON
=
0x0001
iJIT_CALLGRAPH_ON
=
0x0002
}
iJIT_IsProfilingActiveFlags
;
typedef
enum
_iJDEnvironmentType
{
iJDE_JittingAPI
=
2
}
iJDEnvironmentType
;
typedef
struct
_iJIT_Method_Id
{
unsigned
int
method_id
;
}
*
piJIT_Method_Id
iJIT_Method_Id
;
typedef
struct
_iJIT_Method_NIDS
{
unsigned
int
method_id
;
unsigned
int
stack_id
;
char
*
method_name
;
}
*
piJIT_Method_NIDS
iJIT_Method_NIDS
;
typedef
enum
_iJIT_CodeType
{
iJIT_CT_UNKNOWN
=
0
iJIT_CT_CODE
iJIT_CT_DATA
iJIT_CT_EOF
}
iJIT_CodeType
;
typedef
struct
_iJIT_Method_Update
{
unsigned
int
method_id
;
void
*
load_address
;
unsigned
int
size
;
iJIT_CodeType
type
;
}
*
piJIT_Method_Update
iJIT_Method_Update
;
typedef
struct
_LineNumberInfo
{
unsigned
int
Offset
;
unsigned
int
LineNumber
;
}
*
pLineNumberInfo
LineNumberInfo
;
typedef
struct
_iJIT_Method_Load
{
unsigned
int
method_id
;
char
*
method_name
;
void
*
method_load_address
;
unsigned
int
method_size
;
unsigned
int
line_number_size
;
pLineNumberInfo
line_number_table
;
unsigned
int
class_id
;
char
*
class_file_name
;
char
*
source_file_name
;
void
*
user_data
;
unsigned
int
user_data_size
;
iJDEnvironmentType
env
;
}
*
piJIT_Method_Load
iJIT_Method_Load
;
#
pragma
pack
(
push
8
)
typedef
struct
_iJIT_Method_Load_V2
{
unsigned
int
method_id
;
char
*
method_name
;
void
*
method_load_address
;
unsigned
int
method_size
;
unsigned
int
line_number_size
;
pLineNumberInfo
line_number_table
;
char
*
class_file_name
;
char
*
source_file_name
;
char
*
module_name
;
}
*
piJIT_Method_Load_V2
iJIT_Method_Load_V2
;
#
pragma
pack
(
pop
)
typedef
struct
_iJIT_Method_Inline_Load
{
unsigned
int
method_id
;
unsigned
int
parent_method_id
;
char
*
method_name
;
void
*
method_load_address
;
unsigned
int
method_size
;
unsigned
int
line_number_size
;
pLineNumberInfo
line_number_table
;
char
*
class_file_name
;
char
*
source_file_name
;
}
*
piJIT_Method_Inline_Load
iJIT_Method_Inline_Load
;
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
#
ifndef
CDECL
#
if
defined
WIN32
|
|
defined
_WIN32
#
define
CDECL
__cdecl
#
else
#
if
defined
_M_X64
|
|
defined
_M_AMD64
|
|
defined
__x86_64__
#
define
CDECL
#
else
#
define
CDECL
__attribute__
(
(
cdecl
)
)
#
endif
#
endif
#
endif
#
define
JITAPI
CDECL
unsigned
int
JITAPI
iJIT_GetNewMethodID
(
void
)
;
iJIT_IsProfilingActiveFlags
JITAPI
iJIT_IsProfilingActive
(
void
)
;
int
JITAPI
iJIT_NotifyEvent
(
iJIT_JVM_EVENT
event_type
void
*
EventSpecificData
)
;
typedef
void
(
*
iJIT_ModeChangedEx
)
(
void
*
UserData
iJIT_ModeFlags
Flags
)
;
void
JITAPI
iJIT_RegisterCallbackEx
(
void
*
userdata
iJIT_ModeChangedEx
NewModeCallBackFuncEx
)
;
void
JITAPI
FinalizeThread
(
void
)
;
void
JITAPI
FinalizeProcess
(
void
)
;
#
ifdef
__cplusplus
}
#
endif
#
endif
