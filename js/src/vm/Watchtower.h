#
ifndef
vm_Watchtower_h
#
define
vm_Watchtower_h
#
include
"
js
/
Id
.
h
"
#
include
"
js
/
TypeDecls
.
h
"
#
include
"
vm
/
JSContext
.
h
"
#
include
"
vm
/
NativeObject
.
h
"
namespace
js
{
class
Watchtower
{
static
bool
watchPropertyAddSlow
(
JSContext
*
cx
HandleNativeObject
obj
HandleId
id
)
;
static
bool
watchProtoChangeSlow
(
JSContext
*
cx
HandleObject
obj
)
;
public
:
static
bool
watchesPropertyAdd
(
NativeObject
*
obj
)
{
return
obj
-
>
isUsedAsPrototype
(
)
;
}
static
bool
watchesProtoChange
(
JSObject
*
obj
)
{
return
obj
-
>
isUsedAsPrototype
(
)
;
}
static
bool
watchPropertyAdd
(
JSContext
*
cx
HandleNativeObject
obj
HandleId
id
)
{
if
(
MOZ_LIKELY
(
!
watchesPropertyAdd
(
obj
)
)
)
{
return
true
;
}
return
watchPropertyAddSlow
(
cx
obj
id
)
;
}
static
bool
watchProtoChange
(
JSContext
*
cx
HandleObject
obj
)
{
if
(
MOZ_LIKELY
(
!
watchesProtoChange
(
obj
)
)
)
{
return
true
;
}
return
watchProtoChangeSlow
(
cx
obj
)
;
}
}
;
}
#
endif
