#
include
"
js
/
CallNonGenericMethod
.
h
"
#
include
"
proxy
/
Proxy
.
h
"
#
include
"
vm
/
JSFunction
.
h
"
#
include
"
vm
/
JSObject
.
h
"
#
include
"
vm
/
ProxyObject
.
h
"
#
include
"
vm
/
SelfHosting
.
h
"
using
namespace
js
;
bool
JS
:
:
detail
:
:
CallMethodIfWrapped
(
JSContext
*
cx
IsAcceptableThis
test
NativeImpl
impl
const
CallArgs
&
args
)
{
HandleValue
thisv
=
args
.
thisv
(
)
;
MOZ_ASSERT
(
!
test
(
thisv
)
)
;
if
(
thisv
.
isObject
(
)
)
{
JSObject
&
thisObj
=
args
.
thisv
(
)
.
toObject
(
)
;
if
(
thisObj
.
is
<
ProxyObject
>
(
)
)
{
return
Proxy
:
:
nativeCall
(
cx
test
impl
args
)
;
}
}
if
(
IsCallSelfHostedNonGenericMethod
(
impl
)
)
{
return
ReportIncompatibleSelfHostedMethod
(
cx
thisv
)
;
}
ReportIncompatible
(
cx
args
)
;
return
false
;
}
