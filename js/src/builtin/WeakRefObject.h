#
ifndef
builtin_WeakRefObject_h
#
define
builtin_WeakRefObject_h
#
include
"
gc
/
FinalizationObservers
.
h
"
#
include
"
vm
/
NativeObject
.
h
"
namespace
js
{
class
WeakRefObject
:
public
gc
:
:
ObserverListObject
{
public
:
enum
{
TargetSlot
=
ObserverListObject
:
:
SlotCount
SlotCount
}
;
static
const
JSClass
class_
;
static
const
JSClass
protoClass_
;
JSObject
*
target
(
)
{
return
maybePtrFromReservedSlot
<
JSObject
>
(
TargetSlot
)
;
}
void
setTargetUnbarriered
(
JSObject
*
target
)
;
void
clearTargetAndUnlink
(
)
;
private
:
static
const
JSClassOps
classOps_
;
static
const
ClassSpec
classSpec_
;
static
const
JSPropertySpec
properties
[
]
;
static
const
JSFunctionSpec
methods
[
]
;
[
[
nodiscard
]
]
static
bool
construct
(
JSContext
*
cx
unsigned
argc
Value
*
vp
)
;
static
void
trace
(
JSTracer
*
trc
JSObject
*
obj
)
;
static
void
finalize
(
JS
:
:
GCContext
*
gcx
JSObject
*
obj
)
;
static
bool
preserveDOMWrapper
(
JSContext
*
cx
HandleObject
obj
)
;
static
bool
deref
(
JSContext
*
cx
unsigned
argc
Value
*
vp
)
;
static
void
readBarrier
(
JSContext
*
cx
Handle
<
WeakRefObject
*
>
self
)
;
}
;
}
#
endif
