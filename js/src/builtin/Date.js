#
if
JS_HAS_INTL_API
var
dateTimeFormatCache
=
new_Record
(
)
;
function
GetCachedFormat
(
format
required
defaults
)
{
assert
(
format
=
=
=
"
dateTimeFormat
"
|
|
format
=
=
=
"
dateFormat
"
|
|
format
=
=
=
"
timeFormat
"
"
unexpected
format
key
:
please
update
the
comment
by
"
+
"
dateTimeFormatCache
"
)
;
var
formatters
;
if
(
!
intl_IsRuntimeDefaultLocale
(
dateTimeFormatCache
.
runtimeDefaultLocale
)
|
|
!
intl_isDefaultTimeZone
(
dateTimeFormatCache
.
icuDefaultTimeZone
)
)
{
formatters
=
dateTimeFormatCache
.
formatters
=
new_Record
(
)
;
dateTimeFormatCache
.
runtimeDefaultLocale
=
intl_RuntimeDefaultLocale
(
)
;
dateTimeFormatCache
.
icuDefaultTimeZone
=
intl_defaultTimeZone
(
)
;
}
else
{
formatters
=
dateTimeFormatCache
.
formatters
;
}
var
fmt
=
formatters
[
format
]
;
if
(
fmt
=
=
=
undefined
)
{
var
options
=
ToDateTimeOptions
(
undefined
required
defaults
)
;
fmt
=
formatters
[
format
]
=
intl_DateTimeFormat
(
undefined
options
)
;
}
return
fmt
;
}
function
Date_toLocaleString
(
)
{
var
x
=
callFunction
(
ThisTimeValue
this
DATE_METHOD_LOCALE_STRING
)
;
if
(
Number_isNaN
(
x
)
)
{
return
"
Invalid
Date
"
;
}
var
locales
=
arguments
.
length
>
0
?
arguments
[
0
]
:
undefined
;
var
options
=
arguments
.
length
>
1
?
arguments
[
1
]
:
undefined
;
var
dateTimeFormat
;
if
(
locales
=
=
=
undefined
&
&
options
=
=
=
undefined
)
{
dateTimeFormat
=
GetCachedFormat
(
"
dateTimeFormat
"
"
any
"
"
all
"
)
;
}
else
{
options
=
ToDateTimeOptions
(
options
"
any
"
"
all
"
)
;
dateTimeFormat
=
intl_DateTimeFormat
(
locales
options
)
;
}
return
intl_FormatDateTime
(
dateTimeFormat
x
false
)
;
}
function
Date_toLocaleDateString
(
)
{
var
x
=
callFunction
(
ThisTimeValue
this
DATE_METHOD_LOCALE_DATE_STRING
)
;
if
(
Number_isNaN
(
x
)
)
{
return
"
Invalid
Date
"
;
}
var
locales
=
arguments
.
length
>
0
?
arguments
[
0
]
:
undefined
;
var
options
=
arguments
.
length
>
1
?
arguments
[
1
]
:
undefined
;
var
dateTimeFormat
;
if
(
locales
=
=
=
undefined
&
&
options
=
=
=
undefined
)
{
dateTimeFormat
=
GetCachedFormat
(
"
dateFormat
"
"
date
"
"
date
"
)
;
}
else
{
options
=
ToDateTimeOptions
(
options
"
date
"
"
date
"
)
;
dateTimeFormat
=
intl_DateTimeFormat
(
locales
options
)
;
}
return
intl_FormatDateTime
(
dateTimeFormat
x
false
)
;
}
function
Date_toLocaleTimeString
(
)
{
var
x
=
callFunction
(
ThisTimeValue
this
DATE_METHOD_LOCALE_TIME_STRING
)
;
if
(
Number_isNaN
(
x
)
)
{
return
"
Invalid
Date
"
;
}
var
locales
=
arguments
.
length
>
0
?
arguments
[
0
]
:
undefined
;
var
options
=
arguments
.
length
>
1
?
arguments
[
1
]
:
undefined
;
var
dateTimeFormat
;
if
(
locales
=
=
=
undefined
&
&
options
=
=
=
undefined
)
{
dateTimeFormat
=
GetCachedFormat
(
"
timeFormat
"
"
time
"
"
time
"
)
;
}
else
{
options
=
ToDateTimeOptions
(
options
"
time
"
"
time
"
)
;
dateTimeFormat
=
intl_DateTimeFormat
(
locales
options
)
;
}
return
intl_FormatDateTime
(
dateTimeFormat
x
false
)
;
}
#
endif
/
/
JS_HAS_INTL_API
