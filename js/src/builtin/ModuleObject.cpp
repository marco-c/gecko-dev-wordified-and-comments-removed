#
include
"
builtin
/
ModuleObject
.
h
"
#
include
"
jsobjinlines
.
h
"
using
namespace
js
;
const
Class
ModuleObject
:
:
class_
=
{
"
Module
"
JSCLASS_HAS_RESERVED_SLOTS
(
ModuleObject
:
:
SlotCount
)
|
JSCLASS_IS_ANONYMOUS
|
JSCLASS_IMPLEMENTS_BARRIERS
nullptr
nullptr
nullptr
nullptr
nullptr
nullptr
nullptr
nullptr
nullptr
nullptr
nullptr
nullptr
ModuleObject
:
:
trace
}
;
ModuleObject
*
ModuleObject
:
:
create
(
ExclusiveContext
*
cx
)
{
return
NewBuiltinClassInstance
<
ModuleObject
>
(
cx
TenuredObject
)
;
}
void
ModuleObject
:
:
init
(
HandleScript
script
)
{
initReservedSlot
(
ScriptSlot
PrivateValue
(
script
)
)
;
}
JSScript
*
ModuleObject
:
:
script
(
)
const
{
return
static_cast
<
JSScript
*
>
(
getReservedSlot
(
ScriptSlot
)
.
toPrivate
(
)
)
;
}
void
ModuleObject
:
:
trace
(
JSTracer
*
trc
JSObject
*
obj
)
{
ModuleObject
&
module
=
obj
-
>
as
<
ModuleObject
>
(
)
;
JSScript
*
script
=
module
.
script
(
)
;
TraceManuallyBarrieredEdge
(
trc
&
script
"
Module
script
"
)
;
module
.
setReservedSlot
(
ScriptSlot
PrivateValue
(
script
)
)
;
}
