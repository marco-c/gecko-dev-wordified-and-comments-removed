import
mozilla
.
prettyprinters
from
mozilla
.
CellHeader
import
get_header_ptr
from
mozilla
.
prettyprinters
import
ptr_pretty_printer
mozilla
.
prettyprinters
.
clear_module_printers
(
__name__
)
PrivateNameSymbol
=
0xFFFFFFFD
InSymbolRegistry
=
0xFFFFFFFE
UniqueSymbol
=
0xFFFFFFFF
ptr_pretty_printer
(
"
JS
:
:
Symbol
"
)
class
JSSymbolPtr
(
mozilla
.
prettyprinters
.
Pointer
)
:
    
def
__init__
(
self
value
cache
)
:
        
super
(
)
.
__init__
(
value
cache
)
        
self
.
value
=
value
    
def
to_string
(
self
)
:
        
code
=
int
(
self
.
value
[
"
code_
"
]
)
&
0xFFFFFFFF
        
desc
=
str
(
get_header_ptr
(
self
.
value
self
.
cache
.
JSString_ptr_t
)
)
        
if
code
=
=
InSymbolRegistry
:
            
return
f
"
Symbol
.
for
(
{
desc
}
)
"
        
elif
code
=
=
UniqueSymbol
:
            
return
f
"
Symbol
(
{
desc
}
)
"
        
elif
code
=
=
PrivateNameSymbol
:
            
return
f
"
#
{
desc
}
"
        
else
:
            
assert
desc
[
0
]
=
=
'
"
'
            
assert
desc
[
-
1
]
=
=
'
"
'
            
return
desc
[
1
:
-
1
]
