#
ifndef
js_BigInt_h
#
define
js_BigInt_h
#
include
"
mozilla
/
Span
.
h
"
#
include
<
limits
>
#
include
<
stdint
.
h
>
#
include
<
type_traits
>
#
include
"
jstypes
.
h
"
#
include
"
js
/
TypeDecls
.
h
"
namespace
mozilla
{
template
<
typename
T
>
class
Range
;
}
namespace
JS
{
class
JS_PUBLIC_API
BigInt
;
namespace
detail
{
extern
JS_PUBLIC_API
BigInt
*
BigIntFromInt64
(
JSContext
*
cx
int64_t
num
)
;
extern
JS_PUBLIC_API
BigInt
*
BigIntFromUint64
(
JSContext
*
cx
uint64_t
num
)
;
extern
JS_PUBLIC_API
BigInt
*
BigIntFromBool
(
JSContext
*
cx
bool
b
)
;
template
<
typename
T
typename
=
void
>
struct
NumberToBigIntConverter
;
template
<
typename
SignedIntT
>
struct
NumberToBigIntConverter
<
SignedIntT
std
:
:
enable_if_t
<
std
:
:
is_integral_v
<
SignedIntT
>
&
&
std
:
:
is_signed_v
<
SignedIntT
>
&
&
std
:
:
numeric_limits
<
SignedIntT
>
:
:
digits
<
=
64
>
>
{
static
BigInt
*
convert
(
JSContext
*
cx
SignedIntT
num
)
{
return
BigIntFromInt64
(
cx
num
)
;
}
}
;
template
<
typename
UnsignedIntT
>
struct
NumberToBigIntConverter
<
UnsignedIntT
std
:
:
enable_if_t
<
std
:
:
is_integral_v
<
UnsignedIntT
>
&
&
std
:
:
is_unsigned_v
<
UnsignedIntT
>
&
&
std
:
:
numeric_limits
<
UnsignedIntT
>
:
:
digits
<
=
64
>
>
{
static
BigInt
*
convert
(
JSContext
*
cx
UnsignedIntT
num
)
{
return
BigIntFromUint64
(
cx
num
)
;
}
}
;
template
<
>
struct
NumberToBigIntConverter
<
bool
>
{
static
BigInt
*
convert
(
JSContext
*
cx
bool
b
)
{
return
BigIntFromBool
(
cx
b
)
;
}
}
;
}
template
<
typename
NumericT
>
extern
JS_PUBLIC_API
BigInt
*
NumberToBigInt
(
JSContext
*
cx
NumericT
val
)
{
return
detail
:
:
NumberToBigIntConverter
<
NumericT
>
:
:
convert
(
cx
val
)
;
}
extern
JS_PUBLIC_API
BigInt
*
NumberToBigInt
(
JSContext
*
cx
double
num
)
;
extern
JS_PUBLIC_API
BigInt
*
StringToBigInt
(
JSContext
*
cx
mozilla
:
:
Range
<
const
Latin1Char
>
chars
)
;
extern
JS_PUBLIC_API
BigInt
*
StringToBigInt
(
JSContext
*
cx
mozilla
:
:
Range
<
const
char16_t
>
chars
)
;
extern
JS_PUBLIC_API
BigInt
*
SimpleStringToBigInt
(
JSContext
*
cx
mozilla
:
:
Span
<
const
char
>
chars
unsigned
radix
)
;
extern
JS_PUBLIC_API
BigInt
*
ToBigInt
(
JSContext
*
cx
Handle
<
Value
>
val
)
;
extern
JS_PUBLIC_API
int64_t
ToBigInt64
(
BigInt
*
bi
)
;
extern
JS_PUBLIC_API
uint64_t
ToBigUint64
(
BigInt
*
bi
)
;
}
#
endif
