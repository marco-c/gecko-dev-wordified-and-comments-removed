_
(
"
Misc
tests
for
utils
.
js
"
)
;
add_test
(
function
test_default_device_name
(
)
{
let
def
=
Utils
.
_orig_getDefaultDeviceName
(
)
;
_
(
"
default
value
is
"
+
def
)
;
ok
(
def
.
length
>
0
)
;
let
hostname
=
Cc
[
"
mozilla
.
org
/
system
-
info
;
1
"
]
.
getService
(
Ci
.
nsIPropertyBag2
)
.
get
(
"
device
"
)
|
|
Cc
[
"
mozilla
.
org
/
network
/
dns
-
service
;
1
"
]
.
getService
(
Ci
.
nsIDNSService
)
.
myHostName
;
_
(
"
hostname
is
"
+
hostname
)
;
ok
(
hostname
.
length
>
0
)
;
ok
(
def
.
includes
(
hostname
)
)
;
let
fallback
=
Cc
[
"
mozilla
.
org
/
network
/
protocol
;
1
?
name
=
http
"
]
.
getService
(
Ci
.
nsIHttpProtocolHandler
)
.
oscpu
;
_
(
"
UA
fallback
is
"
+
fallback
)
;
ok
(
fallback
.
length
>
0
)
;
ok
(
!
def
.
includes
(
fallback
)
)
;
run_next_test
(
)
;
}
)
;
