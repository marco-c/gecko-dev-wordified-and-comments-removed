const
EXPORTED_SYMBOLS
=
[
"
BrowserTabs
"
]
;
const
{
classes
:
Cc
interfaces
:
Ci
utils
:
Cu
}
=
Components
;
Cu
.
import
(
"
resource
:
/
/
services
-
sync
/
main
.
js
"
)
;
var
BrowserTabs
=
{
Add
(
uri
fn
)
{
let
wm
=
Cc
[
"
mozilla
.
org
/
appshell
/
window
-
mediator
;
1
"
]
.
getService
(
Ci
.
nsIWindowMediator
)
;
let
mainWindow
=
wm
.
getMostRecentWindow
(
"
navigator
:
browser
"
)
;
let
browser
=
mainWindow
.
getBrowser
(
)
;
browser
.
addEventListener
(
"
load
"
fn
{
once
:
true
}
)
;
let
newtab
=
browser
.
addTab
(
uri
)
;
browser
.
selectedTab
=
newtab
;
}
Find
(
uri
title
profile
)
{
let
engine
=
Weave
.
Service
.
engineManager
.
get
(
"
tabs
"
)
;
for
(
let
[
client
]
of
Object
.
entries
(
engine
.
getAllClients
(
)
)
)
{
if
(
!
client
.
tabs
)
{
continue
;
}
for
(
let
key
in
client
.
tabs
)
{
let
tab
=
client
.
tabs
[
key
]
;
let
weaveTabUrl
=
tab
.
urlHistory
[
0
]
;
if
(
uri
=
=
weaveTabUrl
&
&
profile
=
=
client
.
clientName
)
if
(
title
=
=
undefined
|
|
title
=
=
tab
.
title
)
return
true
;
}
}
return
false
;
}
}
;
