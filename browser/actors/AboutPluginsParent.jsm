"
use
strict
"
;
var
EXPORTED_SYMBOLS
=
[
"
AboutPluginsParent
"
]
;
ChromeUtils
.
defineModuleGetter
(
this
"
AddonManager
"
"
resource
:
/
/
gre
/
modules
/
AddonManager
.
jsm
"
)
;
const
NEEDED_PROPS
=
[
"
name
"
"
pluginLibraries
"
"
pluginFullpath
"
"
version
"
"
isActive
"
"
blocklistState
"
"
description
"
"
pluginMimeTypes
"
]
;
class
AboutPluginsParent
extends
JSWindowActorParent
{
async
receiveMessage
(
message
)
{
switch
(
message
.
name
)
{
case
"
RequestPlugins
"
:
function
filterProperties
(
plugin
)
{
let
filtered
=
{
}
;
for
(
let
prop
of
NEEDED_PROPS
)
{
filtered
[
prop
]
=
plugin
[
prop
]
;
}
return
filtered
;
}
let
plugins
=
await
AddonManager
.
getAddonsByTypes
(
[
"
plugin
"
]
)
;
return
plugins
.
map
(
filterProperties
)
;
}
return
undefined
;
}
}
