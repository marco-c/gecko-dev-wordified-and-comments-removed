"
use
strict
"
;
test_newtab
(
function
topsites_edit
(
)
{
content
.
document
.
querySelector
(
"
.
top
-
sites
.
section
-
top
-
bar
.
context
-
menu
-
button
"
)
.
click
(
)
;
let
contextMenu
=
content
.
document
.
querySelector
(
"
.
top
-
sites
.
section
-
top
-
bar
.
context
-
menu
"
)
;
ok
(
contextMenu
"
Should
find
a
visible
topsite
context
menu
"
)
;
const
topsitesAddBtn
=
content
.
document
.
querySelector
(
"
.
top
-
sites
.
context
-
menu
-
item
a
"
)
;
topsitesAddBtn
.
click
(
)
;
let
found
=
content
.
document
.
querySelector
(
"
.
topsite
-
form
"
)
;
ok
(
found
&
&
!
found
.
hidden
"
Should
find
a
visible
topsite
form
"
)
;
found
=
content
.
document
.
querySelector
(
"
.
modal
-
overlay
"
)
;
ok
(
found
&
&
!
found
.
hidden
"
Should
find
a
visible
overlay
"
)
;
}
)
;
test_newtab
(
{
before
:
setDefaultTopSites
test
:
async
function
topsites_pin_unpin
(
)
{
await
ContentTaskUtils
.
waitForCondition
(
(
)
=
>
content
.
document
.
querySelector
(
"
.
top
-
site
-
icon
"
)
"
Topsite
tippytop
icon
not
found
"
)
;
let
topsiteContextBtn
=
content
.
document
.
querySelector
(
"
.
top
-
sites
-
list
.
context
-
menu
-
button
"
)
;
topsiteContextBtn
.
click
(
)
;
await
ContentTaskUtils
.
waitForCondition
(
(
)
=
>
content
.
document
.
querySelector
(
"
.
top
-
sites
-
list
.
context
-
menu
"
)
"
No
context
menu
found
"
)
;
let
contextMenu
=
content
.
document
.
querySelector
(
"
.
top
-
sites
-
list
.
context
-
menu
"
)
;
ok
(
contextMenu
"
Should
find
a
topsite
context
menu
"
)
;
const
pinUnpinTopsiteBtn
=
contextMenu
.
querySelector
(
"
.
top
-
sites
.
context
-
menu
-
item
a
"
)
;
pinUnpinTopsiteBtn
.
click
(
)
;
await
ContentTaskUtils
.
waitForCondition
(
(
)
=
>
content
.
document
.
querySelector
(
"
.
icon
-
pin
-
small
"
)
"
No
pinned
icon
found
"
)
;
let
pinnedIcon
=
content
.
document
.
querySelectorAll
(
"
.
icon
-
pin
-
small
"
)
.
length
;
is
(
pinnedIcon
1
"
should
find
1
pinned
topsite
"
)
;
topsiteContextBtn
=
content
.
document
.
querySelector
(
"
.
top
-
sites
-
list
.
context
-
menu
-
button
"
)
;
ok
(
topsiteContextBtn
"
Should
find
a
context
menu
button
"
)
;
topsiteContextBtn
.
click
(
)
;
content
.
document
.
querySelector
(
"
.
top
-
sites
-
list
.
context
-
menu
-
item
a
"
)
.
click
(
)
;
await
ContentTaskUtils
.
waitForCondition
(
(
)
=
>
!
content
.
document
.
querySelector
(
"
.
icon
-
pin
-
small
"
)
"
Topsite
should
be
unpinned
"
)
;
}
}
)
;
