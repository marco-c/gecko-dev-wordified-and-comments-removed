"
use
strict
"
;
(
(
)
=
>
{
function
sendMessageToBrowser
(
msgName
data
)
{
let
{
AutoCompleteParent
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
gre
/
actors
/
AutoCompleteParent
.
sys
.
mjs
"
)
;
let
actor
=
AutoCompleteParent
.
getCurrentActor
(
)
;
if
(
!
actor
)
{
return
;
}
actor
.
manager
.
getActor
(
"
FormAutofill
"
)
.
sendAsyncMessage
(
msgName
data
)
;
}
class
MozAutocompleteProfileListitemBase
extends
MozElements
.
MozRichlistitem
{
constructor
(
)
{
super
(
)
;
this
.
selectedByMouseOver
=
true
;
}
get
_stringBundle
(
)
{
if
(
!
this
.
__stringBundle
)
{
this
.
__stringBundle
=
Services
.
strings
.
createBundle
(
"
chrome
:
/
/
formautofill
/
locale
/
formautofill
.
properties
"
)
;
}
return
this
.
__stringBundle
;
}
_cleanup
(
)
{
this
.
removeAttribute
(
"
formautofillattached
"
)
;
if
(
this
.
_itemBox
)
{
this
.
_itemBox
.
removeAttribute
(
"
size
"
)
;
}
}
_onOverflow
(
)
{
}
_onUnderflow
(
)
{
}
handleOverUnderflow
(
)
{
}
_adjustAutofillItemLayout
(
)
{
let
outerBoxRect
=
this
.
parentNode
.
getBoundingClientRect
(
)
;
this
.
_itemBox
.
style
.
width
=
outerBoxRect
.
width
+
"
px
"
;
let
oneLineMinRequiredWidth
=
this
.
getAttribute
(
"
ac
-
image
"
)
?
185
:
150
;
if
(
outerBoxRect
.
width
<
=
oneLineMinRequiredWidth
)
{
this
.
_itemBox
.
setAttribute
(
"
size
"
"
small
"
)
;
}
else
{
this
.
_itemBox
.
removeAttribute
(
"
size
"
)
;
}
}
}
MozElements
.
MozAutocompleteProfileListitem
=
class
MozAutocompleteProfileListitem
extends
(
MozAutocompleteProfileListitemBase
)
{
static
get
markup
(
)
{
return
<
div
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
class
=
"
autofill
-
item
-
box
"
>
<
div
class
=
"
profile
-
label
-
col
profile
-
item
-
col
"
>
<
span
class
=
"
profile
-
label
"
>
<
/
span
>
<
/
div
>
<
div
class
=
"
profile
-
comment
-
col
profile
-
item
-
col
"
>
<
span
class
=
"
profile
-
comment
"
>
<
/
span
>
<
/
div
>
<
/
div
>
;
}
connectedCallback
(
)
{
if
(
this
.
delayConnectedCallback
(
)
)
{
return
;
}
this
.
textContent
=
"
"
;
this
.
appendChild
(
this
.
constructor
.
fragment
)
;
this
.
_itemBox
=
this
.
querySelector
(
"
.
autofill
-
item
-
box
"
)
;
this
.
_label
=
this
.
querySelector
(
"
.
profile
-
label
"
)
;
this
.
_comment
=
this
.
querySelector
(
"
.
profile
-
comment
"
)
;
this
.
initializeAttributeInheritance
(
)
;
this
.
_adjustAcItem
(
)
;
}
static
get
inheritedAttributes
(
)
{
return
{
"
.
autofill
-
item
-
box
"
:
"
ac
-
image
"
}
;
}
set
selected
(
val
)
{
if
(
val
)
{
this
.
setAttribute
(
"
selected
"
"
true
"
)
;
}
else
{
this
.
removeAttribute
(
"
selected
"
)
;
}
sendMessageToBrowser
(
"
FormAutofill
:
PreviewProfile
"
)
;
}
get
selected
(
)
{
return
this
.
getAttribute
(
"
selected
"
)
=
=
"
true
"
;
}
_adjustAcItem
(
)
{
this
.
_adjustAutofillItemLayout
(
)
;
this
.
setAttribute
(
"
formautofillattached
"
"
true
"
)
;
this
.
_itemBox
.
style
.
setProperty
(
"
-
-
primary
-
icon
"
url
(
{
this
.
getAttribute
(
"
ac
-
image
"
)
}
)
)
;
let
{
primary
secondary
ariaLabel
}
=
JSON
.
parse
(
this
.
getAttribute
(
"
ac
-
value
"
)
)
;
this
.
_label
.
textContent
=
primary
.
toString
(
)
.
replaceAll
(
"
*
"
"
"
)
;
this
.
_comment
.
textContent
=
secondary
.
toString
(
)
.
replaceAll
(
"
*
"
"
"
)
;
if
(
ariaLabel
)
{
this
.
setAttribute
(
"
aria
-
label
"
ariaLabel
)
;
}
}
}
;
customElements
.
define
(
"
autocomplete
-
profile
-
listitem
"
MozElements
.
MozAutocompleteProfileListitem
{
extends
:
"
richlistitem
"
}
)
;
}
)
(
)
;
