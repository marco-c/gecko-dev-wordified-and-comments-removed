"
use
strict
"
;
Components
.
utils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Promise
.
jsm
"
this
)
;
Services
.
prefs
.
setIntPref
(
"
loop
.
gettingStarted
.
latestFTUVersion
"
2
)
;
registerCleanupFunction
(
function
*
(
)
{
Services
.
prefs
.
clearUserPref
(
"
loop
.
gettingStarted
.
latestFTUVersion
"
)
;
}
)
;
add_task
(
function
*
test_panelToggle_on_menuitem_click
(
)
{
yield
loadLoopPanel
(
)
;
Assert
.
strictEqual
(
LoopUI
.
panel
.
state
"
open
"
"
Panel
should
be
open
"
)
;
document
.
getElementById
(
"
menu_openLoop
"
)
.
click
(
)
;
Assert
.
strictEqual
(
LoopUI
.
panel
.
state
"
closed
"
"
Panel
should
be
closed
"
)
;
}
)
;
add_task
(
function
*
test_private_browsing_window
(
)
{
let
win
=
OpenBrowserWindow
(
{
private
:
true
}
)
;
yield
new
Promise
(
resolve
=
>
{
win
.
addEventListener
(
"
load
"
function
listener
(
)
{
win
.
removeEventListener
(
"
load
"
listener
)
;
resolve
(
)
;
}
)
;
}
)
;
let
menuItem
=
win
.
document
.
getElementById
(
"
menu_openLoop
"
)
;
Assert
.
ok
(
!
menuItem
"
Loop
menuitem
should
not
be
present
"
)
;
win
.
close
(
)
;
}
)
;
