"
use
strict
"
;
ChromeUtils
.
defineModuleGetter
(
this
"
Services
"
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
ChromeUtils
.
defineModuleGetter
(
this
"
KEYBOARD_CONTROLS
"
"
resource
:
/
/
gre
/
modules
/
PictureInPictureControls
.
jsm
"
)
;
ChromeUtils
.
defineModuleGetter
(
this
"
TOGGLE_POLICIES
"
"
resource
:
/
/
gre
/
modules
/
PictureInPictureControls
.
jsm
"
)
;
ChromeUtils
.
defineModuleGetter
(
this
"
AppConstants
"
"
resource
:
/
/
gre
/
modules
/
AppConstants
.
jsm
"
)
;
const
TOGGLE_ENABLED_PREF
=
"
media
.
videocontrols
.
picture
-
in
-
picture
.
video
-
toggle
.
enabled
"
;
this
.
pictureInPictureParent
=
class
extends
ExtensionAPI
{
getAPI
(
context
)
{
return
{
pictureInPictureParent
:
{
setOverrides
(
overrides
)
{
if
(
AppConstants
.
platform
=
=
"
android
"
)
{
return
;
}
Services
.
ppmm
.
sharedData
.
set
(
"
PictureInPicture
:
SiteOverrides
"
overrides
)
;
}
}
}
;
}
}
;
this
.
pictureInPictureChild
=
class
extends
ExtensionAPI
{
getAPI
(
context
)
{
return
{
pictureInPictureChild
:
{
getKeyboardControls
(
)
{
if
(
AppConstants
.
platform
=
=
"
android
"
)
{
return
Cu
.
cloneInto
(
{
}
context
.
cloneScope
)
;
}
return
Cu
.
cloneInto
(
KEYBOARD_CONTROLS
context
.
cloneScope
)
;
}
getPolicies
(
)
{
if
(
AppConstants
.
platform
=
=
"
android
"
)
{
return
Cu
.
cloneInto
(
{
}
context
.
cloneScope
)
;
}
return
Cu
.
cloneInto
(
TOGGLE_POLICIES
context
.
cloneScope
)
;
}
}
}
;
}
}
;
