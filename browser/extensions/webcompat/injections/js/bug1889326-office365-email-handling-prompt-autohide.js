"
use
strict
"
;
const
warning
=
"
Office
365
Outlook
email
handling
prompt
has
been
hidden
.
See
https
:
/
/
bugzilla
.
mozilla
.
org
/
show_bug
.
cgi
?
id
=
1889326
for
details
.
"
;
const
localStorageKey
=
"
mailProtocolHandlerAlreadyOffered
"
;
const
proto
=
Object
.
getPrototypeOf
(
navigator
)
.
wrappedJSObject
;
const
{
registerProtocolHandler
}
=
proto
;
const
{
localStorage
}
=
window
.
wrappedJSObject
;
proto
.
registerProtocolHandler
=
exportFunction
(
function
(
scheme
url
title
)
{
if
(
localStorage
.
getItem
(
localStorageKey
)
)
{
console
.
info
(
warning
)
;
return
undefined
;
}
registerProtocolHandler
.
call
(
this
scheme
url
title
)
;
localStorage
.
setItem
(
localStorageKey
true
)
;
return
undefined
;
}
window
)
;
