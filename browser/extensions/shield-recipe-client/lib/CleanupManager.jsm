"
use
strict
"
;
const
{
utils
:
Cu
}
=
Components
;
this
.
EXPORTED_SYMBOLS
=
[
"
CleanupManager
"
]
;
const
cleanupHandlers
=
new
Set
(
)
;
this
.
CleanupManager
=
{
addCleanupHandler
(
handler
)
{
cleanupHandlers
.
add
(
handler
)
;
}
removeCleanupHandler
(
handler
)
{
cleanupHandlers
.
delete
(
handler
)
;
}
cleanup
(
)
{
for
(
const
handler
of
cleanupHandlers
)
{
try
{
handler
(
)
;
}
catch
(
ex
)
{
Cu
.
reportError
(
ex
)
;
}
}
}
}
;
