"
use
strict
"
;
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
XPCOMUtils
.
jsm
"
)
;
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
ChromeUtils
.
import
(
"
resource
:
/
/
shield
-
recipe
-
client
-
content
/
AboutPages
.
jsm
"
)
;
class
ShieldChildListener
{
onStartup
(
)
{
Services
.
cpmm
.
addMessageListener
(
"
Shield
:
ShuttingDown
"
this
true
)
;
AboutPages
.
aboutStudies
.
register
(
)
;
}
onShutdown
(
)
{
AboutPages
.
aboutStudies
.
unregister
(
)
;
Services
.
cpmm
.
removeMessageListener
(
"
Shield
:
ShuttingDown
"
this
)
;
Cu
.
unload
(
"
resource
:
/
/
shield
-
recipe
-
client
-
content
/
AboutPages
.
jsm
"
)
;
}
receiveMessage
(
message
)
{
switch
(
message
.
name
)
{
case
"
Shield
:
ShuttingDown
"
:
this
.
onShutdown
(
)
;
break
;
}
}
}
if
(
Services
.
appinfo
.
processType
=
=
=
Services
.
appinfo
.
PROCESS_TYPE_CONTENT
)
{
const
listener
=
new
ShieldChildListener
(
)
;
listener
.
onStartup
(
)
;
}
