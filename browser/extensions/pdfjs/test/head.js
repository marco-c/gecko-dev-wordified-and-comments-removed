async
function
waitForPdfJS
(
browser
url
)
{
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
pdfjs
.
eventBusDispatchToDOM
"
true
]
]
}
)
;
return
ContentTask
.
spawn
(
browser
url
async
function
(
contentUrl
)
{
await
new
Promise
(
(
resolve
)
=
>
{
addEventListener
(
"
documentloaded
"
function
listener
(
)
{
removeEventListener
(
"
documentloaded
"
listener
false
)
;
resolve
(
)
;
}
false
true
)
;
content
.
location
=
contentUrl
;
}
)
;
}
)
;
}
