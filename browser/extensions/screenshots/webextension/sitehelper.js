"
use
strict
"
;
this
.
sitehelper
=
(
function
(
)
{
catcher
.
registerHandler
(
(
errorObj
)
=
>
{
callBackground
(
"
reportError
"
errorObj
)
;
}
)
;
function
sendCustomEvent
(
name
detail
)
{
if
(
typeof
detail
=
=
"
object
"
)
{
detail
=
JSON
.
stringify
(
detail
)
;
}
document
.
dispatchEvent
(
new
CustomEvent
(
name
{
detail
}
)
)
;
}
document
.
addEventListener
(
"
delete
-
everything
"
catcher
.
watchFunction
(
(
event
)
=
>
{
}
false
)
)
;
document
.
addEventListener
(
"
request
-
login
"
catcher
.
watchFunction
(
(
event
)
=
>
{
let
shotId
=
event
.
detail
;
catcher
.
watchPromise
(
callBackground
(
"
getAuthInfo
"
shotId
|
|
null
)
.
then
(
(
info
)
=
>
{
sendCustomEvent
(
"
login
-
successful
"
{
deviceId
:
info
.
deviceId
isOwner
:
info
.
isOwner
}
)
;
}
)
)
;
}
)
)
;
document
.
addEventListener
(
"
request
-
addon
-
present
"
catcher
.
watchFunction
(
(
)
=
>
{
sendCustomEvent
(
"
addon
-
present
"
)
;
}
)
false
)
;
sendCustomEvent
(
"
addon
-
present
"
)
;
}
)
(
)
;
null
;
