"
use
strict
"
;
const
TOPIC
=
"
menuitem
-
screenshot
-
extension
"
;
this
.
screenshots
=
class
extends
ExtensionAPI
{
getAPI
(
context
)
{
let
EventManager
=
ExtensionCommon
.
EventManager
;
return
{
experiments
:
{
screenshots
:
{
getUpdateChannel
(
)
{
return
AppConstants
.
MOZ_UPDATE_CHANNEL
;
}
isHistoryEnabled
(
)
{
return
Services
.
prefs
.
getBoolPref
(
"
places
.
history
.
enabled
"
true
)
;
}
setIcon
:
(
isActive
windowId
)
=
>
{
Services
.
obs
.
notifyObservers
(
Services
.
wm
.
getOuterWindowWithId
(
windowId
)
"
toggle
-
screenshot
-
disable
"
isActive
)
;
}
onScreenshotCommand
:
new
EventManager
(
{
context
name
:
"
experiments
.
screenshots
.
onScreenshotCommand
"
register
:
fire
=
>
{
let
observer
=
(
subject
topic
data
)
=
>
{
let
type
=
data
;
fire
.
sync
(
type
)
;
}
;
Services
.
obs
.
addObserver
(
observer
TOPIC
)
;
return
(
)
=
>
{
Services
.
obs
.
removeObserver
(
observer
TOPIC
)
;
}
;
}
}
)
.
api
(
)
}
}
}
;
}
}
;
