"
use
strict
"
;
const
TOPIC
=
"
contextmenu
-
screenshot
"
;
this
.
screenshots
=
class
extends
ExtensionAPI
{
getAPI
(
context
)
{
const
{
extension
}
=
context
;
const
{
tabManager
}
=
extension
;
let
EventManager
=
ExtensionCommon
.
EventManager
;
return
{
experiments
:
{
screenshots
:
{
getUpdateChannel
(
)
{
return
AppConstants
.
MOZ_UPDATE_CHANNEL
;
}
isHistoryEnabled
(
)
{
return
Services
.
prefs
.
getBoolPref
(
"
places
.
history
.
enabled
"
true
)
;
}
isUploadDisabled
(
)
{
return
Services
.
prefs
.
getBoolPref
(
"
extensions
.
screenshots
.
upload
-
disabled
"
false
)
;
}
onScreenshotCommand
:
new
EventManager
(
{
context
name
:
"
experiments
.
screenshots
.
onScreenshotCommand
"
register
:
fire
=
>
{
let
observer
=
(
)
=
>
{
fire
.
sync
(
)
;
}
;
Services
.
obs
.
addObserver
(
observer
TOPIC
)
;
return
(
)
=
>
{
Services
.
obs
.
removeObserver
(
observer
TOPIC
)
;
}
;
}
}
)
.
api
(
)
}
}
}
;
}
}
;
