"
use
strict
"
;
const
{
StartupTelemetry
}
=
ChromeUtils
.
importESModule
(
"
moz
-
src
:
/
/
/
browser
/
components
/
StartupTelemetry
.
sys
.
mjs
"
)
;
const
ENV_VAR
=
"
FIREFOX_LAUNCHED_BY_DESKTOP_LAUNCHER
"
;
add_setup
(
function
test_setup
(
)
{
do_get_profile
(
)
;
Services
.
fog
.
initializeFOG
(
)
;
}
)
;
add_task
(
async
function
test_not_launched_from_desktop_launcher
(
)
{
await
StartupTelemetry
.
pinningStatus
(
)
;
Assert
.
notEqual
(
"
DesktopLauncher
"
Glean
.
osEnvironment
.
launchMethod
.
testGetValue
(
)
)
;
}
)
;
add_task
(
async
function
test_launched_from_desktop_launcher
(
)
{
Services
.
env
.
set
(
ENV_VAR
"
TRUE
"
)
;
await
StartupTelemetry
.
pinningStatus
(
)
;
Assert
.
equal
(
"
DesktopLauncher
"
Glean
.
osEnvironment
.
launchMethod
.
testGetValue
(
)
)
;
}
)
;
