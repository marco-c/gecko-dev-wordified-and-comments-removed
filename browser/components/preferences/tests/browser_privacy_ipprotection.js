"
use
strict
"
;
const
FEATURE_PREF
=
"
browser
.
ipProtection
.
variant
"
;
const
SECTION_ID
=
"
dataIPProtectionGroup
"
;
add_task
(
async
function
test_section_removed_when_set_to_ineligible_experiment_pref
(
)
{
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
FEATURE_PREF
"
alpha
"
]
]
}
)
;
await
BrowserTestUtils
.
withNewTab
(
{
gBrowser
url
:
"
about
:
preferences
#
privacy
"
}
async
function
(
browser
)
{
let
section
=
browser
.
contentDocument
.
getElementById
(
SECTION_ID
)
;
is_element_hidden
(
section
"
#
dataIPProtectionGroup
is
hidden
"
)
;
}
)
;
await
SpecialPowers
.
popPrefEnv
(
)
;
}
)
;
add_task
(
async
function
test_section_shown_when_set_to_eligible_experiment_pref
(
)
{
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
FEATURE_PREF
"
beta
"
]
]
}
)
;
await
BrowserTestUtils
.
withNewTab
(
{
gBrowser
url
:
"
about
:
preferences
#
privacy
"
}
async
function
(
browser
)
{
let
section
=
browser
.
contentDocument
.
getElementById
(
SECTION_ID
)
;
is_element_visible
(
section
"
#
dataIPProtectionGroup
is
shown
"
)
;
}
)
;
await
SpecialPowers
.
popPrefEnv
(
)
;
}
)
;
