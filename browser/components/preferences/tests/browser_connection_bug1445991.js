"
use
strict
"
;
add_task
(
async
function
testAutoconfigReloadButton
(
)
{
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
network
.
proxy
.
type
"
2
]
[
"
network
.
proxy
.
autoconfig_url
"
"
file
:
/
/
/
nonexistent
.
pac
"
]
]
}
)
;
await
openPreferencesViaOpenPreferencesAPI
(
"
general
"
{
leaveOpen
:
true
}
)
;
const
connectionURL
=
"
chrome
:
/
/
browser
/
content
/
preferences
/
dialogs
/
connection
.
xhtml
"
;
const
promiseDialogLoaded
=
promiseLoadSubDialog
(
connectionURL
)
;
gBrowser
.
contentDocument
.
getElementById
(
"
connectionSettings
"
)
.
click
(
)
;
const
dialog
=
await
promiseDialogLoaded
;
ok
(
!
dialog
.
document
.
getElementById
(
"
autoReload
"
)
.
disabled
"
Reload
button
is
enabled
when
proxy
type
is
autoconfig
"
)
;
dialog
.
close
(
)
;
gBrowser
.
removeCurrentTab
(
)
;
}
)
;
