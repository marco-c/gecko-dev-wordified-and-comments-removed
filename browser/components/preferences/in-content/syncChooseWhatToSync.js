const
{
Services
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
Preferences
.
addAll
(
[
{
id
:
"
services
.
sync
.
engine
.
addons
"
type
:
"
bool
"
}
{
id
:
"
services
.
sync
.
engine
.
bookmarks
"
type
:
"
bool
"
}
{
id
:
"
services
.
sync
.
engine
.
history
"
type
:
"
bool
"
}
{
id
:
"
services
.
sync
.
engine
.
tabs
"
type
:
"
bool
"
}
{
id
:
"
services
.
sync
.
engine
.
prefs
"
type
:
"
bool
"
}
{
id
:
"
services
.
sync
.
engine
.
passwords
"
type
:
"
bool
"
}
{
id
:
"
services
.
sync
.
engine
.
addresses
"
type
:
"
bool
"
}
{
id
:
"
services
.
sync
.
engine
.
creditcards
"
type
:
"
bool
"
}
]
)
;
let
gSyncChooseWhatToSync
=
{
init
(
)
{
this
.
_adjustForPrefs
(
)
;
let
options
=
window
.
arguments
[
0
]
;
if
(
options
.
disconnectFun
)
{
document
.
addEventListener
(
"
dialogextra2
"
function
(
)
{
options
.
disconnectFun
(
)
.
then
(
disconnected
=
>
{
if
(
disconnected
)
{
window
.
close
(
)
;
}
}
)
;
}
)
;
}
else
{
document
.
documentElement
.
getButton
(
"
extra2
"
)
.
hidden
=
true
;
}
}
_adjustForPrefs
(
)
{
let
enginePrefs
=
[
[
"
services
.
sync
.
engine
.
addresses
"
"
.
sync
-
engine
-
addresses
"
]
[
"
services
.
sync
.
engine
.
creditcards
"
"
.
sync
-
engine
-
creditcards
"
]
]
;
for
(
let
[
enabledPref
className
]
of
enginePrefs
)
{
let
availablePref
=
enabledPref
+
"
.
available
"
;
if
(
Services
.
prefs
.
getBoolPref
(
enabledPref
false
)
)
{
Services
.
prefs
.
setBoolPref
(
availablePref
true
)
;
}
if
(
!
Services
.
prefs
.
getBoolPref
(
availablePref
)
)
{
let
elt
=
document
.
querySelector
(
className
)
;
elt
.
hidden
=
true
;
}
}
}
}
;
