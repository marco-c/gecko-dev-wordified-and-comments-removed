const
{
classes
:
Cc
interfaces
:
Ci
results
:
Cr
}
=
Components
;
const
SECURE_CONTAINER_URL
=
"
https
:
/
/
example
.
com
/
browser
/
browser
/
components
/
safebrowsing
/
content
/
test
/
empty_file
.
html
"
;
add_task
(
function
*
testNormalBrowsing
(
)
{
yield
BrowserTestUtils
.
withNewTab
(
SECURE_CONTAINER_URL
function
*
(
browser
)
{
yield
new
Promise
(
resolve
=
>
waitForDBInit
(
resolve
)
)
;
yield
ContentTask
.
spawn
(
browser
PHISH_URL
function
*
(
aPhishUrl
)
{
return
new
Promise
(
resolve
=
>
{
let
listener
=
e
=
>
{
removeEventListener
(
"
AboutBlockedLoaded
"
listener
false
true
)
;
resolve
(
)
;
}
;
addEventListener
(
"
AboutBlockedLoaded
"
listener
false
true
)
;
let
iframe
=
content
.
document
.
createElement
(
"
iframe
"
)
;
iframe
.
src
=
aPhishUrl
;
content
.
document
.
body
.
appendChild
(
iframe
)
;
}
)
;
}
)
;
ok
(
true
"
about
:
blocked
is
successfully
loaded
!
"
)
;
}
)
;
}
)
;
