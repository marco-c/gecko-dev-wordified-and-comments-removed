import
React
from
"
react
"
;
import
ReactDOM
from
"
react
-
dom
"
;
import
PopularTopics
from
"
.
.
/
components
/
PopularTopics
"
;
import
pktPanelMessaging
from
"
.
.
/
messages
.
js
"
;
var
HomeOverlay
=
function
(
options
)
{
this
.
inited
=
false
;
this
.
active
=
false
;
this
.
pockethost
=
"
getpocket
.
com
"
;
this
.
parseHTML
=
function
(
htmlString
)
{
const
parser
=
new
DOMParser
(
)
;
return
parser
.
parseFromString
(
htmlString
text
/
html
)
.
documentElement
;
}
;
this
.
setupClickEvents
=
function
(
)
{
pktPanelMessaging
.
clickHelper
(
document
.
querySelector
(
.
pkt_ext_mylist
)
{
source
:
home_view_list
}
)
;
pktPanelMessaging
.
clickHelper
(
document
.
querySelector
(
.
pkt_ext_discover
)
{
source
:
home_discover
}
)
;
document
.
querySelectorAll
(
.
pkt_ext_topic
)
.
forEach
(
(
el
position
)
=
>
{
pktPanelMessaging
.
clickHelper
(
el
{
source
:
home_topic
position
}
)
;
}
)
;
}
;
}
;
HomeOverlay
.
prototype
=
{
create
(
)
{
var
host
=
window
.
location
.
href
.
match
(
/
pockethost
=
(
[
\
w
|
\
.
]
*
)
&
?
/
)
;
if
(
host
&
&
host
.
length
>
1
)
{
this
.
pockethost
=
host
[
1
]
;
}
var
locale
=
window
.
location
.
href
.
match
(
/
locale
=
(
[
\
w
|
\
.
]
*
)
&
?
/
)
;
if
(
locale
&
&
locale
.
length
>
1
)
{
this
.
locale
=
locale
[
1
]
.
toLowerCase
(
)
;
}
if
(
this
.
active
)
{
return
;
}
this
.
active
=
true
;
const
enableLocalizedExploreMore
=
false
;
const
templateData
=
{
pockethost
:
this
.
pockethost
utmsource
:
"
firefox
-
button
"
}
;
if
(
this
.
locale
)
{
document
.
querySelector
(
body
)
.
classList
.
add
(
pkt_ext_home_
{
this
.
locale
}
)
;
}
document
.
querySelector
(
body
)
.
append
(
this
.
parseHTML
(
Handlebars
.
templates
.
home_shell
(
templateData
)
)
)
;
if
(
this
.
locale
.
startsWith
(
"
en
"
)
)
{
ReactDOM
.
render
(
<
PopularTopics
pockethost
=
{
templateData
.
pockethost
}
utmsource
=
{
templateData
.
utmsource
}
topics
=
{
[
{
title
:
"
Self
Improvement
"
topic
:
"
self
-
improvement
"
}
{
title
:
"
Food
"
topic
:
"
food
"
}
{
title
:
"
Entertainment
"
topic
:
"
entertainment
"
}
{
title
:
"
Science
"
topic
:
"
science
"
}
]
}
/
>
document
.
querySelector
(
.
pkt_ext_more
)
)
;
}
else
if
(
enableLocalizedExploreMore
)
{
document
.
querySelector
(
.
pkt_ext_more
)
.
append
(
this
.
parseHTML
(
Handlebars
.
templates
.
explore_more
(
)
)
)
;
}
this
.
setupClickEvents
(
)
;
pktPanelMessaging
.
sendMessage
(
"
PKT_show_home
"
)
;
}
}
;
export
default
HomeOverlay
;
