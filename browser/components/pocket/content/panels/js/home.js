var
PKT_PANEL_OVERLAY
=
function
(
options
)
{
this
.
inited
=
false
;
this
.
active
=
false
;
this
.
translations
=
{
}
;
this
.
pockethost
=
"
getpocket
.
com
"
;
this
.
dictJSON
=
{
}
;
this
.
parseHTML
=
function
(
htmlString
)
{
const
parser
=
new
DOMParser
(
)
;
return
parser
.
parseFromString
(
htmlString
text
/
html
)
.
documentElement
;
}
;
this
.
initCloseTabEvents
=
function
(
)
{
function
clickHelper
(
e
linkData
)
{
e
.
preventDefault
(
)
;
thePKT_PANEL
.
sendMessage
(
"
PKT_openTabWithUrl
"
{
url
:
linkData
.
url
activate
:
true
source
:
linkData
.
source
|
|
"
"
position
:
linkData
.
position
}
)
;
}
document
.
querySelector
(
.
pkt_ext_mylist
)
.
addEventListener
(
click
e
=
>
{
clickHelper
(
e
{
source
:
"
home_view_list
"
url
:
e
.
target
.
getAttribute
(
href
)
}
)
;
}
)
;
document
.
querySelectorAll
(
.
pkt_ext_topic
)
.
forEach
(
(
el
index
)
=
>
{
el
.
addEventListener
(
click
e
=
>
{
clickHelper
(
e
{
source
:
"
home_topic
"
url
:
e
.
target
.
getAttribute
(
href
)
index
}
)
;
}
)
;
}
)
;
document
.
querySelector
(
.
pkt_ext_discover
)
.
addEventListener
(
click
e
=
>
{
clickHelper
(
e
{
source
:
"
home_discover
"
url
:
e
.
target
.
getAttribute
(
href
)
}
)
;
}
)
;
}
;
this
.
getTranslations
=
function
(
)
{
this
.
dictJSON
=
window
.
pocketStrings
;
}
;
}
;
PKT_PANEL_OVERLAY
.
prototype
=
{
create
(
)
{
var
host
=
window
.
location
.
href
.
match
(
/
pockethost
=
(
[
\
w
|
\
.
]
*
)
&
?
/
)
;
if
(
host
&
&
host
.
length
>
1
)
{
this
.
pockethost
=
host
[
1
]
;
}
var
locale
=
window
.
location
.
href
.
match
(
/
locale
=
(
[
\
w
|
\
.
]
*
)
&
?
/
)
;
if
(
locale
&
&
locale
.
length
>
1
)
{
this
.
locale
=
locale
[
1
]
.
toLowerCase
(
)
;
}
if
(
this
.
active
)
{
return
;
}
this
.
active
=
true
;
const
enableLocalizedExploreMore
=
false
;
this
.
getTranslations
(
)
;
this
.
dictJSON
.
pockethost
=
this
.
pockethost
;
this
.
dictJSON
.
utmsource
=
"
firefox
-
button
"
;
if
(
this
.
locale
)
{
document
.
querySelector
(
body
)
.
classList
.
add
(
pkt_ext_home_
{
this
.
locale
}
)
;
}
document
.
querySelector
(
body
)
.
append
(
this
.
parseHTML
(
Handlebars
.
templates
.
home_shell
(
this
.
dictJSON
)
)
)
;
if
(
this
.
locale
.
startsWith
(
"
en
"
)
)
{
const
data
=
{
explorepopulartopics
:
this
.
dictJSON
.
explorepopulartopics
discovermore
:
this
.
dictJSON
.
discovermore
pockethost
:
this
.
dictJSON
.
pockethost
utmsource
:
this
.
dictJSON
.
utmsource
topics
:
[
{
title
:
"
Self
Improvement
"
topic
:
"
self
-
improvement
"
}
{
title
:
"
Food
"
topic
:
"
food
"
}
{
title
:
"
Entertainment
"
topic
:
"
entertainment
"
}
{
title
:
"
Science
"
topic
:
"
science
"
}
]
}
;
document
.
querySelector
(
.
pkt_ext_more
)
.
append
(
this
.
parseHTML
(
Handlebars
.
templates
.
popular_topics
(
data
)
)
)
;
}
else
if
(
enableLocalizedExploreMore
)
{
document
.
querySelector
(
.
pkt_ext_more
)
.
append
(
this
.
parseHTML
(
Handlebars
.
templates
.
explore_more
(
this
.
dictJSON
)
)
)
;
}
this
.
initCloseTabEvents
(
)
;
thePKT_PANEL
.
sendMessage
(
"
PKT_show_home
"
)
;
}
}
;
