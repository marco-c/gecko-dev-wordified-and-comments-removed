"
use
strict
"
;
function
test_runner
(
test
)
{
let
testTask
=
async
(
)
=
>
{
const
sandbox
=
sinon
.
createSandbox
(
)
;
try
{
await
test
(
{
sandbox
pktPanelMessaging
:
testGlobal
.
window
.
pktPanelMessaging
}
)
;
}
finally
{
sandbox
.
restore
(
)
;
}
}
;
Object
.
defineProperty
(
testTask
"
name
"
{
value
:
test
.
name
}
)
;
add_task
(
testTask
)
;
}
test_runner
(
async
function
test_clickHelper
(
{
sandbox
pktPanelMessaging
}
)
{
const
button
=
document
.
createElement
(
"
button
"
)
;
button
.
setAttribute
(
"
href
"
"
http
:
/
/
example
.
com
"
)
;
sandbox
.
stub
(
pktPanelMessaging
"
sendMessage
"
)
;
pktPanelMessaging
.
clickHelper
(
button
{
source
:
"
test
-
click
"
position
:
2
}
)
;
button
.
click
(
)
;
Assert
.
ok
(
pktPanelMessaging
.
sendMessage
.
calledOnce
"
Should
fire
sendMessage
once
with
clickHelper
click
"
)
;
Assert
.
ok
(
pktPanelMessaging
.
sendMessage
.
calledWith
(
"
PKT_openTabWithUrl
"
{
url
:
"
http
:
/
/
example
.
com
"
source
:
"
test
-
click
"
position
:
2
}
)
"
Should
send
expected
values
to
sendMessage
with
clickHelper
click
"
)
;
}
)
;
