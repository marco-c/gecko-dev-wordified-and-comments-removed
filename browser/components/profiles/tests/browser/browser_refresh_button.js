"
use
strict
"
;
ChromeUtils
.
defineESModuleGetters
(
this
{
UrlbarTestUtils
:
"
resource
:
/
/
testing
-
common
/
UrlbarTestUtils
.
sys
.
mjs
"
}
)
;
add_task
(
async
function
test_RefreshTestPrefFunction
(
)
{
await
initGroupDatabase
(
)
;
window
.
gURLBar
.
value
=
"
"
;
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
browser
.
profiles
.
forceEnableRefresh
"
true
]
]
}
)
;
await
UrlbarTestUtils
.
promiseAutocompleteResultPopup
(
{
window
value
:
"
refresh
"
waitForFocus
:
SimpleTest
.
waitForFocus
}
)
;
let
row
=
UrlbarTestUtils
.
getRowAt
(
window
1
)
;
let
refreshButton
=
row
.
querySelector
(
"
span
[
data
-
action
=
'
refresh
'
]
"
)
;
ok
(
refreshButton
"
Refresh
button
should
be
visible
"
)
;
window
.
gURLBar
.
value
=
"
"
;
await
SpecialPowers
.
popPrefEnv
(
)
;
await
UrlbarTestUtils
.
promiseAutocompleteResultPopup
(
{
window
value
:
"
refresh
"
waitForFocus
:
SimpleTest
.
waitForFocus
}
)
;
row
=
UrlbarTestUtils
.
getRowAt
(
window
1
)
;
ok
(
!
row
"
Refresh
button
should
not
be
visible
"
)
;
}
)
;
