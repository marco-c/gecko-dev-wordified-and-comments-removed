"
use
strict
"
;
const
DEFAULT_PREFS
=
{
"
quicksuggest
.
enabled
"
:
true
"
quicksuggest
.
dataCollection
.
enabled
"
:
false
"
quicksuggest
.
settingsUi
"
:
QuickSuggest
.
SETTINGS_UI
.
OFFLINE_ONLY
"
suggest
.
quicksuggest
.
nonsponsored
"
:
true
"
suggest
.
quicksuggest
.
sponsored
"
:
true
}
;
const
TEST_OVERRIDES
=
{
migrationVersion
:
3
defaultPrefs
:
DEFAULT_PREFS
}
;
add_setup
(
async
(
)
=
>
{
await
UrlbarTestUtils
.
initNimbusFeature
(
)
;
}
)
;
add_task
(
async
function
test_migrate_with_datacollection_enabled
(
)
{
await
doMigrateTest
(
{
testOverrides
:
TEST_OVERRIDES
initialUserBranch
:
{
"
quicksuggest
.
dataCollection
.
enabled
"
:
true
}
expectedPrefs
:
{
defaultBranch
:
DEFAULT_PREFS
userBranch
:
{
"
quicksuggest
.
dataCollection
.
enabled
"
:
true
"
quicksuggest
.
settingsUi
"
:
QuickSuggest
.
SETTINGS_UI
.
FULL
}
}
}
)
;
}
)
;
add_task
(
async
function
test_migrate_with_datacollection_disabled
(
)
{
await
doMigrateTest
(
{
testOverrides
:
TEST_OVERRIDES
expectedPrefs
:
{
defaultBranch
:
DEFAULT_PREFS
}
}
)
;
}
)
;
