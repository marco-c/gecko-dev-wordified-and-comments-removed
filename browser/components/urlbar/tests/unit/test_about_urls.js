"
use
strict
"
;
const
{
AboutPagesUtils
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
gre
/
modules
/
AboutPagesUtils
.
sys
.
mjs
"
)
;
testEngine_setup
(
)
;
add_task
(
async
function
aboutAb
(
)
{
let
context
=
createContext
(
"
about
:
ab
"
{
isPrivate
:
false
}
)
;
await
check_results
(
{
context
autofilled
:
"
about
:
about
"
completed
:
"
about
:
about
"
matches
:
[
makeVisitResult
(
context
{
uri
:
"
about
:
about
"
title
:
"
about
:
about
"
heuristic
:
true
}
)
]
}
)
;
}
)
;
add_task
(
async
function
aboutAb
(
)
{
let
context
=
createContext
(
"
about
:
Ab
"
{
isPrivate
:
false
}
)
;
await
check_results
(
{
context
autofilled
:
"
about
:
About
"
completed
:
"
about
:
about
"
matches
:
[
makeVisitResult
(
context
{
uri
:
"
about
:
about
"
title
:
"
about
:
about
"
heuristic
:
true
}
)
]
}
)
;
}
)
;
add_task
(
async
function
aboutAbout
(
)
{
let
context
=
createContext
(
"
about
:
about
"
{
isPrivate
:
false
}
)
;
await
check_results
(
{
context
autofilled
:
"
about
:
about
"
completed
:
"
about
:
about
"
matches
:
[
makeVisitResult
(
context
{
uri
:
"
about
:
about
"
title
:
"
about
:
about
"
heuristic
:
true
}
)
]
}
)
;
}
)
;
add_task
(
async
function
aboutAboutAndAboutAddons
(
)
{
let
context
=
createContext
(
"
about
:
a
"
{
isPrivate
:
false
}
)
;
await
check_results
(
{
context
search
:
"
about
:
a
"
autofilled
:
"
about
:
about
"
completed
:
"
about
:
about
"
matches
:
[
makeVisitResult
(
context
{
uri
:
"
about
:
about
"
title
:
"
about
:
about
"
heuristic
:
true
}
)
makeVisitResult
(
context
{
source
:
UrlbarUtils
.
RESULT_SOURCE
.
OTHER_LOCAL
uri
:
"
about
:
addons
"
title
:
"
about
:
addons
"
iconUri
:
"
page
-
icon
:
about
:
addons
"
tags
:
null
providerName
:
"
UrlbarProviderAboutPages
"
}
)
]
}
)
;
}
)
;
add_task
(
async
function
aboutColonMatchesOnlyAboutPages
(
)
{
function
getFirst9AboutPages
(
)
{
const
aboutPageNames
=
AboutPagesUtils
.
visibleAboutUrls
.
slice
(
0
9
)
;
const
aboutPageResults
=
aboutPageNames
.
map
(
aboutPageName
=
>
{
return
makeVisitResult
(
context
{
source
:
UrlbarUtils
.
RESULT_SOURCE
.
OTHER_LOCAL
uri
:
aboutPageName
title
:
aboutPageName
iconUri
:
"
page
-
icon
:
"
+
aboutPageName
tags
:
null
providerName
:
"
UrlbarProviderAboutPages
"
}
)
;
}
)
;
return
aboutPageResults
;
}
let
context
=
createContext
(
"
about
:
"
{
isPrivate
:
false
}
)
;
await
check_results
(
{
context
search
:
"
about
:
"
matches
:
[
makeSearchResult
(
context
{
engineName
:
SUGGESTIONS_ENGINE_NAME
providerName
:
"
UrlbarProviderHeuristicFallback
"
heuristic
:
true
}
)
.
.
.
getFirst9AboutPages
(
)
]
}
)
;
}
)
;
add_task
(
async
function
aboutResultsDoNotMatchTitlesInHistory
(
)
{
await
PlacesTestUtils
.
addVisits
(
[
{
uri
:
Services
.
io
.
newURI
(
"
http
:
/
/
example
.
com
/
guide
/
config
/
"
)
title
:
"
Guide
to
config
in
Firefox
"
}
]
)
;
let
context
=
createContext
(
"
about
:
config
"
{
isPrivate
:
false
}
)
;
await
check_results
(
{
context
search
:
"
about
:
config
"
matches
:
[
makeVisitResult
(
context
{
uri
:
"
about
:
config
"
title
:
"
about
:
config
"
heuristic
:
true
providerName
:
"
UrlbarProviderAutofill
"
}
)
]
}
)
;
}
)
;
add_task
(
async
function
after_general
(
)
{
await
PlacesTestUtils
.
addVisits
(
[
{
uri
:
Services
.
io
.
newURI
(
"
http
:
/
/
example
.
com
/
guide
/
aboutaddons
/
"
)
title
:
"
Guide
to
about
:
addons
in
Firefox
"
}
]
)
;
let
context
=
createContext
(
"
about
:
a
"
{
isPrivate
:
false
}
)
;
await
check_results
(
{
context
matches
:
[
makeVisitResult
(
context
{
uri
:
"
about
:
about
"
title
:
"
about
:
about
"
heuristic
:
true
providerName
:
"
UrlbarProviderAutofill
"
}
)
makeVisitResult
(
context
{
uri
:
"
http
:
/
/
example
.
com
/
guide
/
aboutaddons
/
"
title
:
"
Guide
to
about
:
addons
in
Firefox
"
}
)
makeVisitResult
(
context
{
source
:
UrlbarUtils
.
RESULT_SOURCE
.
OTHER_LOCAL
uri
:
"
about
:
addons
"
title
:
"
about
:
addons
"
iconUri
:
"
page
-
icon
:
about
:
addons
"
tags
:
null
providerName
:
"
UrlbarProviderAboutPages
"
}
)
]
}
)
;
await
cleanupPlaces
(
)
;
}
)
;
