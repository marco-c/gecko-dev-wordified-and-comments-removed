"
use
strict
"
;
add_task
(
async
function
(
)
{
await
UrlbarTestUtils
.
promiseAutocompleteResultPopup
(
{
window
waitForFocus
:
SimpleTest
.
waitForFocus
value
:
"
foo
"
}
)
;
Assert
.
ok
(
UrlbarTestUtils
.
getResultCount
(
window
)
>
0
There
should
be
some
results
in
the
view
.
)
;
Assert
.
ok
(
gURLBar
.
view
.
isOpen
The
view
should
be
open
.
)
;
let
provider
=
new
UrlbarTestUtils
.
TestProvider
(
{
results
:
[
]
priority
:
999
}
)
;
UrlbarProvidersManager
.
registerProvider
(
provider
)
;
registerCleanupFunction
(
async
function
(
)
{
UrlbarProvidersManager
.
unregisterProvider
(
provider
)
;
await
PlacesUtils
.
history
.
clear
(
)
;
}
)
;
await
UrlbarTestUtils
.
promiseAutocompleteResultPopup
(
{
window
waitForFocus
:
SimpleTest
.
waitForFocus
value
:
"
foo
"
}
)
;
Assert
.
ok
(
UrlbarTestUtils
.
getResultCount
(
window
)
=
=
0
There
should
be
no
results
in
the
view
.
)
;
Assert
.
ok
(
!
gURLBar
.
view
.
isOpen
The
view
should
have
been
closed
.
)
;
}
)
;
