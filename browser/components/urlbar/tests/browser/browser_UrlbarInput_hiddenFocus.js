add_task
(
async
function
(
)
{
let
tab
=
await
BrowserTestUtils
.
openNewForegroundTab
(
gBrowser
)
;
registerCleanupFunction
(
async
function
(
)
{
BrowserTestUtils
.
removeTab
(
tab
)
;
URLBarSetURI
(
)
;
}
)
;
gURLBar
.
blur
(
)
;
ok
(
!
gURLBar
.
hasAttribute
(
"
focused
"
)
&
&
!
gURLBar
.
textbox
.
classList
.
contains
(
"
hidden
-
focus
"
)
"
url
bar
is
not
focused
or
hidden
"
)
;
gURLBar
.
setHiddenFocus
(
)
;
ok
(
gURLBar
.
hasAttribute
(
"
focused
"
)
&
&
gURLBar
.
textbox
.
classList
.
contains
(
"
hidden
-
focus
"
)
"
url
bar
is
focused
and
hidden
"
)
;
gURLBar
.
removeHiddenFocus
(
)
;
ok
(
gURLBar
.
hasAttribute
(
"
focused
"
)
&
&
!
gURLBar
.
textbox
.
classList
.
contains
(
"
hidden
-
focus
"
)
"
url
bar
is
focused
and
not
hidden
"
)
;
}
)
;
