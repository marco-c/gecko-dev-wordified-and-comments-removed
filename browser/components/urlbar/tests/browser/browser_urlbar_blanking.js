"
use
strict
"
;
const
TEST_URL
=
{
TEST_BASE_URL
}
file_blank_but_not_blank
.
html
;
add_task
(
async
function
(
)
{
for
(
let
page
of
gInitialPages
)
{
if
(
page
=
=
"
about
:
newtab
"
)
{
continue
;
}
let
tab
=
await
BrowserTestUtils
.
openNewForegroundTab
(
gBrowser
page
)
;
ok
(
!
gURLBar
.
value
"
The
URL
bar
should
be
empty
if
we
load
a
plain
"
+
page
+
"
page
.
"
)
;
BrowserTestUtils
.
removeTab
(
tab
)
;
}
}
)
;
add_task
(
async
function
(
)
{
let
tab
=
await
BrowserTestUtils
.
openNewForegroundTab
(
gBrowser
TEST_URL
)
;
is
(
gURLBar
.
value
TEST_URL
"
The
URL
bar
should
match
the
URI
"
)
;
let
browserLoaded
=
BrowserTestUtils
.
browserLoaded
(
tab
.
linkedBrowser
)
;
ContentTask
.
spawn
(
tab
.
linkedBrowser
null
function
(
)
{
content
.
document
.
querySelector
(
"
a
"
)
.
click
(
)
;
}
)
;
await
browserLoaded
;
ok
(
gURLBar
.
value
.
startsWith
(
"
javascript
"
)
"
The
URL
bar
should
have
the
JS
URI
"
)
;
SimpleTest
.
expectUncaughtException
(
true
)
;
await
ContentTask
.
spawn
(
tab
.
linkedBrowser
null
async
function
(
)
{
content
.
location
.
reload
(
)
;
}
)
;
ok
(
!
!
gURLBar
.
value
"
URL
bar
should
not
be
blank
.
"
)
;
BrowserTestUtils
.
removeTab
(
tab
)
;
SimpleTest
.
expectUncaughtException
(
false
)
;
}
)
;
