"
use
strict
"
;
const
{
XPCOMUtils
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
XPCOMUtils
.
jsm
"
)
;
XPCOMUtils
.
defineLazyModuleGetters
(
this
{
AppMenuNotifications
:
"
resource
:
/
/
gre
/
modules
/
AppMenuNotifications
.
jsm
"
BrowserWindowTracker
:
"
resource
:
/
/
/
modules
/
BrowserWindowTracker
.
jsm
"
}
)
;
this
.
experiments_urlbar
=
class
extends
ExtensionAPI
{
getAPI
(
)
{
return
{
experiments
:
{
urlbar
:
{
isBrowserShowingNotification
(
)
{
let
window
=
BrowserWindowTracker
.
getTopWindow
(
)
;
if
(
window
.
gURLBar
.
view
.
isOpen
|
|
window
.
gBrowser
.
getNotificationBox
(
)
.
currentNotification
)
{
return
true
;
}
if
(
AppMenuNotifications
.
activeNotification
&
&
!
AppMenuNotifications
.
activeNotification
.
dismissed
&
&
!
AppMenuNotifications
.
activeNotification
.
options
.
badgeOnly
)
{
return
true
;
}
if
(
[
"
tracking
-
protection
-
icon
-
container
"
"
identity
-
box
"
]
.
some
(
id
=
>
window
.
document
.
getElementById
(
id
)
.
getAttribute
(
"
open
"
)
=
=
"
true
"
)
)
{
return
true
;
}
let
pageActions
=
window
.
document
.
getElementById
(
"
page
-
action
-
buttons
"
)
;
if
(
pageActions
)
{
for
(
let
child
of
pageActions
.
childNodes
)
{
if
(
child
.
getAttribute
(
"
open
"
)
=
=
"
true
"
)
{
return
true
;
}
}
}
let
navbar
=
window
.
document
.
getElementById
(
"
nav
-
bar
-
customization
-
target
"
)
;
for
(
let
node
of
navbar
.
querySelectorAll
(
"
toolbarbutton
"
)
)
{
if
(
node
.
getAttribute
(
"
open
"
)
=
=
"
true
"
)
{
return
true
;
}
}
return
false
;
}
}
}
}
;
}
}
;
