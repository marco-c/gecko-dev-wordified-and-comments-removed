Services
.
scriptloader
.
loadSubScript
(
"
chrome
:
/
/
mochitests
/
content
/
browser
/
browser
/
components
/
tabbrowser
/
test
/
browser
/
tabs
/
common_link_in_tab_title_and_url_prefilled
.
js
"
this
)
;
add_setup
(
async
function
(
)
{
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
test
.
wait300msAfterTabSwitch
"
true
]
]
}
)
;
}
)
;
add_task
(
async
function
normal_page__blank_target
(
)
{
await
doTestWithNewWindow
(
{
link
:
"
wait
-
a
-
bit
-
-
blank
-
target
"
expectedSetURICalled
:
true
}
)
;
}
)
;
add_task
(
async
function
normal_page__other_target
(
)
{
await
doTestWithNewWindow
(
{
link
:
"
wait
-
a
-
bit
-
-
other
-
target
"
expectedSetURICalled
:
false
}
)
;
}
)
;
add_task
(
async
function
normal_page__by_script
(
)
{
await
doTestWithNewWindow
(
{
link
:
"
wait
-
a
-
bit
-
-
by
-
script
"
expectedSetURICalled
:
false
}
)
;
}
)
;
add_task
(
async
function
blank_page__blank_target
(
)
{
await
doTestWithNewWindow
(
{
link
:
"
blank
-
page
-
-
blank
-
target
"
expectedSetURICalled
:
false
}
)
;
}
)
;
add_task
(
async
function
blank_page__other_target
(
)
{
await
doTestWithNewWindow
(
{
link
:
"
blank
-
page
-
-
other
-
target
"
expectedSetURICalled
:
false
}
)
;
}
)
;
add_task
(
async
function
blank_page__by_script
(
)
{
await
doTestWithNewWindow
(
{
link
:
"
blank
-
page
-
-
by
-
script
"
expectedSetURICalled
:
false
async
actionWhileLoading
(
_onTabLoaded
)
{
info
(
"
Skip
waiting
for
link
target
to
load
"
)
;
_onTabLoaded
.
catch
(
(
)
=
>
{
}
)
;
}
}
)
;
}
)
;
