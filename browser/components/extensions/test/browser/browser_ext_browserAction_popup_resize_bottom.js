"
use
strict
"
;
Services
.
scriptloader
.
loadSubScript
(
new
URL
(
"
head_browserAction
.
js
"
gTestPath
)
.
href
this
)
;
add_task
(
async
function
testSetup
(
)
{
Services
.
prefs
.
setBoolPref
(
"
toolkit
.
cosmeticAnimations
.
enabled
"
false
)
;
}
)
;
add_task
(
async
function
testBrowserActionMenuResizeBottomArrow
(
)
{
const
WIDTH
=
800
;
const
HEIGHT
=
80
;
let
left
=
screen
.
availLeft
+
screen
.
availWidth
-
WIDTH
;
let
top
=
screen
.
availTop
+
screen
.
availHeight
-
HEIGHT
;
let
win
=
await
BrowserTestUtils
.
openNewBrowserWindow
(
)
;
win
.
resizeTo
(
WIDTH
HEIGHT
)
;
await
BrowserTestUtils
.
waitForCondition
(
async
(
)
=
>
{
win
.
moveTo
(
left
top
)
;
await
delay
(
100
)
;
return
win
.
screenX
=
=
left
&
&
win
.
screenY
=
=
top
;
}
"
Wait
the
new
browser
window
to
be
positioned
correctly
"
)
;
await
SimpleTest
.
promiseFocus
(
win
)
;
await
testPopupSize
(
true
win
"
bottom
"
)
;
await
BrowserTestUtils
.
closeWindow
(
win
)
;
}
)
;
add_task
(
async
function
testTeardown
(
)
{
Services
.
prefs
.
clearUserPref
(
"
toolkit
.
cosmeticAnimations
.
enabled
"
)
;
}
)
;
