"
use
strict
"
;
let
win
;
add_setup
(
async
(
)
=
>
{
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
sidebar
.
revamp
"
false
]
]
}
)
;
win
=
await
BrowserTestUtils
.
openNewBrowserWindow
(
)
;
}
)
;
registerCleanupFunction
(
async
(
)
=
>
{
await
BrowserTestUtils
.
closeWindow
(
win
)
;
}
)
;
add_task
(
async
function
test_megalist_menu
(
)
{
const
{
document
}
=
win
;
const
item
=
document
.
getElementById
(
"
menu_megalistSidebar
"
)
;
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
browser
.
contextual
-
password
-
manager
.
enabled
"
false
]
]
}
)
;
ok
(
item
.
hidden
"
Megalist
sidebar
menu
item
hidden
"
)
;
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
browser
.
contextual
-
password
-
manager
.
enabled
"
true
]
]
}
)
;
ok
(
!
item
.
hidden
"
Megalist
sidebar
menu
item
shown
"
)
;
}
)
;
add_task
(
async
function
test_megalist_menu
(
)
{
const
{
document
}
=
win
;
const
item
=
document
.
getElementById
(
"
menu_genaiChatSidebar
"
)
;
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
browser
.
ml
.
chat
.
enabled
"
false
]
]
}
)
;
ok
(
item
.
hidden
"
Chat
sidebar
menu
item
hidden
"
)
;
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
browser
.
ml
.
chat
.
enabled
"
true
]
]
}
)
;
ok
(
!
item
.
hidden
"
Chat
sidebar
menu
item
shown
"
)
;
}
)
;
