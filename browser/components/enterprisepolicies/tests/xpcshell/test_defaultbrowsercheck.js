"
use
strict
"
;
const
{
ShellService
}
=
ChromeUtils
.
importESModule
(
"
moz
-
src
:
/
/
/
browser
/
components
/
shell
/
ShellService
.
sys
.
mjs
"
)
;
add_task
(
async
function
test_default_browser_check
(
)
{
ShellService
.
_checkedThisSession
=
false
;
ShellService
.
shouldCheckDefaultBrowser
=
true
;
equal
(
ShellService
.
shouldCheckDefaultBrowser
true
"
Sanity
check
"
)
;
await
setupPolicyEngineWithJson
(
{
policies
:
{
DontCheckDefaultBrowser
:
true
}
}
)
;
equal
(
ShellService
.
shouldCheckDefaultBrowser
false
"
Policy
changed
it
to
not
check
"
)
;
ShellService
.
shouldCheckDefaultBrowser
=
true
;
equal
(
ShellService
.
shouldCheckDefaultBrowser
false
"
Policy
is
enforced
"
)
;
}
)
;
add_task
(
async
function
test_default_browser_check
(
)
{
await
setupPolicyEngineWithJson
(
{
policies
:
{
DontCheckDefaultBrowser
:
false
}
}
)
;
equal
(
ShellService
.
shouldCheckDefaultBrowser
true
"
Policy
changed
it
to
check
"
)
;
ShellService
.
shouldCheckDefaultBrowser
=
false
;
equal
(
ShellService
.
shouldCheckDefaultBrowser
true
"
Policy
is
enforced
"
)
;
}
)
;
