"
use
strict
"
;
add_task
(
async
function
test_get_page_content_basic
(
)
{
const
html
=
<
!
DOCTYPE
html
>
<
html
>
<
head
>
<
meta
charset
=
"
utf
-
8
"
>
<
title
>
Test
Page
<
/
title
>
<
/
head
>
<
body
>
<
article
>
<
h1
>
Sample
Article
Title
<
/
h1
>
<
p
>
This
is
the
first
paragraph
with
some
sample
content
.
<
/
p
>
<
p
>
This
is
the
second
paragraph
with
additional
information
.
<
/
p
>
<
/
article
>
<
/
body
>
<
/
html
>
;
const
{
url
GetPageContent
cleanup
}
=
await
setupGetPageContentTest
(
html
)
;
const
allowedUrls
=
new
Set
(
[
url
]
)
;
const
result
=
await
GetPageContent
.
getPageContent
(
{
url
}
allowedUrls
)
;
info
(
"
Extraction
result
:
"
+
result
)
;
ok
(
result
.
includes
(
"
Sample
Article
Title
"
)
"
Result
should
contain
the
title
"
)
;
ok
(
result
.
includes
(
"
first
paragraph
"
)
"
Result
should
contain
text
from
the
first
paragraph
"
)
;
ok
(
result
.
includes
(
"
second
paragraph
"
)
"
Result
should
contain
text
from
the
second
paragraph
"
)
;
ok
(
result
.
startsWith
(
"
Content
(
"
)
&
&
result
.
includes
(
"
)
from
"
)
"
Result
should
indicate
the
extraction
mode
used
"
)
;
await
cleanup
(
)
;
}
)
;
