"
use
strict
"
;
add_task
(
async
function
feature_callout_is_accessible
(
)
{
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
"
browser
.
firefox
-
view
.
feature
-
tour
"
getPrefValueByScreen
(
1
)
]
]
}
)
;
await
BrowserTestUtils
.
withNewTab
(
{
gBrowser
url
:
"
about
:
firefoxview
"
}
async
browser
=
>
{
const
{
document
}
=
browser
.
contentWindow
;
await
waitForCalloutScreen
(
document
"
FEATURE_CALLOUT_1
"
)
;
await
BrowserTestUtils
.
waitForCondition
(
(
)
=
>
document
.
activeElement
.
value
=
=
=
"
primary_button
"
Feature
Callout
primary
button
is
focused
on
page
load
}
)
;
ok
(
true
"
Feature
Callout
primary
button
was
focused
on
page
load
"
)
;
await
BrowserTestUtils
.
waitForCondition
(
(
)
=
>
document
.
querySelector
(
{
calloutSelector
}
[
aria
-
describedby
=
"
#
{
calloutId
}
.
welcome
-
text
"
]
)
"
The
callout
container
has
an
aria
-
describedby
value
equal
to
the
screen
welcome
text
"
)
;
ok
(
true
"
The
callout
container
has
the
correct
aria
-
describedby
value
"
)
;
clickPrimaryButton
(
document
)
;
await
waitForCalloutScreen
(
document
"
FEATURE_CALLOUT_2
"
)
;
ok
(
true
"
FEATURE_CALLOUT_2
was
successfully
displayed
"
)
;
await
BrowserTestUtils
.
waitForCondition
(
(
)
=
>
document
.
activeElement
.
value
=
=
"
primary_button
"
"
Feature
Callout
primary
button
is
focused
after
advancing
screens
"
)
;
ok
(
true
"
Feature
Callout
primary
button
was
successfully
focused
"
)
;
}
)
;
}
)
;
