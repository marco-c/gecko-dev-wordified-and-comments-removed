"
use
strict
"
;
if
(
gFissionBrowser
)
{
addCoopTask
(
"
browser_485482_sample
.
html
"
test_xpath_exp_for_strange_documents
HTTPSROOT
)
;
}
addNonCoopTask
(
"
browser_485482_sample
.
html
"
test_xpath_exp_for_strange_documents
ROOT
)
;
addNonCoopTask
(
"
browser_485482_sample
.
html
"
test_xpath_exp_for_strange_documents
HTTPSROOT
)
;
addNonCoopTask
(
"
browser_485482_sample
.
html
"
test_xpath_exp_for_strange_documents
HTTPROOT
)
;
async
function
test_xpath_exp_for_strange_documents
(
aURL
)
{
let
tab
=
BrowserTestUtils
.
addTab
(
gBrowser
aURL
)
;
let
browser
=
tab
.
linkedBrowser
;
await
promiseBrowserLoaded
(
browser
)
;
let
uniqueValue
=
Math
.
random
(
)
;
await
setPropertyOfFormField
(
browser
"
input
[
type
=
text
]
"
"
value
"
uniqueValue
)
;
await
setPropertyOfFormField
(
browser
"
input
[
type
=
checkbox
]
"
"
checked
"
true
)
;
let
tab2
=
gBrowser
.
duplicateTab
(
tab
)
;
let
browser2
=
tab2
.
linkedBrowser
;
await
promiseTabRestored
(
tab2
)
;
let
text
=
await
getPropertyOfFormField
(
browser2
"
input
[
type
=
text
]
"
"
value
"
)
;
is
(
"
"
+
text
"
"
+
uniqueValue
"
generated
XPath
expression
was
valid
"
)
;
let
checkbox
=
await
getPropertyOfFormField
(
browser2
"
input
[
type
=
checkbox
]
"
"
checked
"
)
;
ok
(
checkbox
"
generated
XPath
expression
was
valid
"
)
;
gBrowser
.
removeTab
(
tab2
)
;
gBrowser
.
removeTab
(
tab
)
;
}
