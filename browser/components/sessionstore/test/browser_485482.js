"
use
strict
"
;
const
URL
=
ROOT
+
"
browser_485482_sample
.
html
"
;
add_task
(
async
function
test_xpath_exp_for_strange_documents
(
)
{
let
tab
=
BrowserTestUtils
.
addTab
(
gBrowser
URL
)
;
let
browser
=
tab
.
linkedBrowser
;
await
promiseBrowserLoaded
(
browser
)
;
let
uniqueValue
=
Math
.
random
(
)
;
await
setInputValue
(
browser
{
selector
:
"
input
[
type
=
text
]
"
value
:
uniqueValue
}
)
;
await
setInputChecked
(
browser
{
selector
:
"
input
[
type
=
checkbox
]
"
checked
:
true
}
)
;
let
tab2
=
gBrowser
.
duplicateTab
(
tab
)
;
let
browser2
=
tab2
.
linkedBrowser
;
await
promiseTabRestored
(
tab2
)
;
let
text
=
await
getInputValue
(
browser2
{
selector
:
"
input
[
type
=
text
]
"
}
)
;
is
(
text
uniqueValue
"
generated
XPath
expression
was
valid
"
)
;
let
checkbox
=
await
getInputChecked
(
browser2
{
selector
:
"
input
[
type
=
checkbox
]
"
}
)
;
ok
(
checkbox
"
generated
XPath
expression
was
valid
"
)
;
gBrowser
.
removeTab
(
tab2
)
;
gBrowser
.
removeTab
(
tab
)
;
}
)
;
