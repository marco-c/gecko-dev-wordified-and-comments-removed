add_task
(
async
function
test_malformedURI
(
)
{
let
state
=
{
windows
:
[
{
tabs
:
[
{
entries
:
[
{
url
:
"
about
:
mozilla
"
triggeringPrincipal_base64
title
:
"
Mozilla
"
}
{
}
]
}
]
}
]
}
;
var
theWin
=
openDialog
(
location
"
"
"
chrome
all
dialog
=
no
"
)
;
await
promiseWindowLoaded
(
theWin
)
;
var
gotError
=
false
;
try
{
await
setWindowState
(
theWin
state
true
)
;
}
catch
(
e
)
{
if
(
/
NS_ERROR_MALFORMED_URI
/
.
test
(
e
)
)
gotError
=
true
;
}
ok
(
!
gotError
"
Didn
'
t
get
a
malformed
URI
error
.
"
)
;
await
BrowserTestUtils
.
closeWindow
(
theWin
)
;
}
)
;
