const
path
=
require
(
"
path
"
)
;
const
webpack
=
require
(
"
webpack
"
)
;
const
{
ResourceUriPlugin
}
=
require
(
"
.
.
/
newtab
/
tools
/
resourceUriPlugin
"
)
;
const
PATHS
=
{
testEntryFile
:
path
.
resolve
(
__dirname
"
.
/
tests
/
unit
/
unit
-
entry
.
js
"
)
testFilesPattern
:
"
.
/
tests
/
unit
/
unit
-
entry
.
js
"
moduleResolveDirectory
:
__dirname
newtabResolveDirectory
:
"
.
.
/
newtab
"
resourcePathRegEx
:
/
^
resource
:
\
/
\
/
activity
-
stream
\
/
/
coverageReportingPath
:
"
logs
/
coverage
/
"
}
;
const
preprocessors
=
{
}
;
preprocessors
[
PATHS
.
testFilesPattern
]
=
[
"
webpack
"
"
sourcemap
"
]
;
module
.
exports
=
function
(
config
)
{
const
isTDD
=
config
.
tdd
;
const
browsers
=
isTDD
?
[
"
Firefox
"
]
:
[
"
FirefoxHeadless
"
]
;
config
.
set
(
{
singleRun
:
!
isTDD
browsers
customLaunchers
:
{
FirefoxHeadless
:
{
base
:
"
Firefox
"
flags
:
[
"
-
-
headless
"
]
}
}
frameworks
:
[
"
chai
"
"
mocha
"
"
sinon
"
]
reporters
:
[
"
coverage
-
istanbul
"
"
mocha
"
"
json
"
]
jsonReporter
:
{
stdout
:
false
outputFile
:
path
.
join
(
"
logs
"
"
karma
-
run
-
results
.
json
"
)
}
coverageIstanbulReporter
:
{
reports
:
[
"
lcov
"
"
text
-
summary
"
]
"
report
-
config
"
:
{
lcov
:
{
projectRoot
:
"
.
.
/
.
.
/
.
.
"
}
}
dir
:
PATHS
.
coverageReportingPath
thresholds
:
!
isTDD
&
&
{
each
:
{
statements
:
80
lines
:
80
functions
:
80
branches
:
66
overrides
:
{
"
modules
/
*
.
sys
.
mjs
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
lib
/
aboutwelcome
-
utils
.
mjs
"
:
{
statements
:
50
lines
:
50
functions
:
50
branches
:
0
}
"
content
-
src
/
components
/
LanguageSwitcher
.
jsx
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
components
/
EmbeddedMigrationWizard
.
jsx
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
components
/
AddonsPicker
.
jsx
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
components
/
SubmenuButton
.
jsx
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
components
/
MSLocalized
.
jsx
"
:
{
statements
:
77
.
42
lines
:
77
.
42
functions
:
75
}
"
content
-
src
/
components
/
CTAParagraph
.
jsx
"
:
{
functions
:
50
}
"
content
-
src
/
components
/
HeroImage
.
jsx
"
:
{
branches
:
62
.
5
}
"
content
-
src
/
components
/
LinkParagraph
.
jsx
"
:
{
functions
:
75
branches
:
37
.
5
}
"
content
-
src
/
components
/
MRColorways
.
jsx
"
:
{
statements
:
76
.
09
lines
:
75
functions
:
76
.
92
}
"
content
-
src
/
components
/
MobileDownloads
.
jsx
"
:
{
branches
:
56
.
25
}
"
content
-
src
/
components
/
Themes
.
jsx
"
:
{
branches
:
50
}
"
content
-
src
/
components
/
MultiStageAboutWelcome
.
jsx
"
:
{
statements
:
73
.
71
lines
:
75
.
4
functions
:
72
.
5
branches
:
58
.
62
}
}
}
}
}
files
:
[
PATHS
.
testEntryFile
]
preprocessors
webpack
:
{
mode
:
"
none
"
devtool
:
"
inline
-
source
-
map
"
resolveLoader
:
{
alias
:
{
inject
:
path
.
join
(
__dirname
"
.
.
/
newtab
/
loaders
/
inject
-
loader
"
)
}
}
resolve
:
{
extensions
:
[
"
.
js
"
"
.
jsx
"
]
modules
:
[
PATHS
.
moduleResolveDirectory
"
node_modules
"
PATHS
.
newtabResolveDirectory
]
fallback
:
{
stream
:
require
.
resolve
(
"
stream
-
browserify
"
)
buffer
:
require
.
resolve
(
"
buffer
"
)
}
alias
:
{
newtab
:
path
.
join
(
__dirname
"
.
.
/
newtab
"
)
asrouter
:
path
.
join
(
__dirname
"
.
.
/
asrouter
"
)
}
}
plugins
:
[
new
ResourceUriPlugin
(
{
resourcePathRegEx
:
PATHS
.
resourcePathRegEx
}
)
new
webpack
.
DefinePlugin
(
{
"
process
.
env
.
NODE_ENV
"
:
JSON
.
stringify
(
"
development
"
)
}
)
]
externals
:
{
"
react
/
addons
"
:
true
"
react
/
lib
/
ReactContext
"
:
true
"
react
/
lib
/
ExecutionEnvironment
"
:
true
}
module
:
{
rules
:
[
{
test
:
/
\
.
jsm
/
exclude
:
[
/
node_modules
/
]
use
:
[
{
loader
:
"
babel
-
loader
"
options
:
{
plugins
:
[
[
"
.
.
/
newtab
/
tools
/
babel
-
jsm
-
to
-
commonjs
.
js
"
{
basePaths
:
[
[
PATHS
.
resourcePathRegEx
"
"
]
[
/
^
resource
:
\
/
\
/
\
/
modules
\
/
asrouter
\
/
/
"
asrouter
/
modules
/
"
]
]
removeOtherImports
:
true
replace
:
true
}
]
]
}
}
]
}
{
test
:
/
\
.
js
/
exclude
:
[
/
node_modules
\
/
(
?
!
fluent
\
/
)
.
*
/
/
tests
/
]
loader
:
"
babel
-
loader
"
}
{
test
:
/
\
.
jsx
/
exclude
:
/
node_modules
/
loader
:
"
babel
-
loader
"
options
:
{
presets
:
[
"
babel
/
preset
-
react
"
]
}
}
{
test
:
/
\
.
md
/
use
:
"
raw
-
loader
"
}
{
enforce
:
"
post
"
test
:
/
\
.
m
?
js
[
mx
]
?
/
loader
:
"
jsdevtools
/
coverage
-
istanbul
-
loader
"
options
:
{
esModules
:
true
}
include
:
[
path
.
resolve
(
"
content
-
src
"
)
path
.
resolve
(
"
modules
"
)
]
exclude
:
[
path
.
resolve
(
"
tests
"
)
path
.
resolve
(
"
.
.
/
newtab
"
)
]
}
]
}
}
webpackMiddleware
:
{
noInfo
:
true
}
}
)
;
}
;
