"
use
strict
"
;
add_task
(
async
function
test_appMenu_mainView
(
)
{
if
(
AppConstants
.
platform
=
=
"
macosx
"
)
{
ok
(
true
"
The
test
is
ignored
on
Mac
"
)
;
return
;
}
let
mainViewID
=
"
appMenu
-
mainView
"
;
const
mainView
=
document
.
getElementById
(
mainViewID
)
;
let
shownPromise
=
BrowserTestUtils
.
waitForEvent
(
mainView
"
ViewShown
"
)
;
EventUtils
.
synthesizeMouseAtCenter
(
PanelUI
.
menuButton
{
ctrlKey
:
true
}
)
;
await
shownPromise
;
ok
(
true
"
Main
menu
shown
after
button
pressed
"
)
;
let
hiddenPromise
=
BrowserTestUtils
.
waitForEvent
(
document
"
popuphidden
"
)
;
mainView
.
closest
(
"
panel
"
)
.
hidePopup
(
)
;
await
hiddenPromise
;
}
)
;
add_task
(
async
function
test_appMenu_libraryView
(
)
{
if
(
AppConstants
.
platform
=
=
"
macosx
"
)
{
ok
(
true
"
The
test
is
ignored
on
Mac
"
)
;
return
;
}
CustomizableUI
.
addWidgetToArea
(
"
library
-
button
"
"
nav
-
bar
"
)
;
const
button
=
document
.
getElementById
(
"
library
-
button
"
)
;
await
waitForElementShown
(
button
)
;
EventUtils
.
synthesizeMouseAtCenter
(
button
{
ctrlKey
:
true
}
)
;
const
libraryView
=
document
.
getElementById
(
"
appMenu
-
libraryView
"
)
;
let
shownPromise
=
BrowserTestUtils
.
waitForEvent
(
libraryView
"
ViewShown
"
)
;
await
shownPromise
;
ok
(
true
"
Library
menu
shown
after
button
pressed
"
)
;
let
hiddenPromise
=
BrowserTestUtils
.
waitForEvent
(
document
"
popuphidden
"
)
;
libraryView
.
closest
(
"
panel
"
)
.
hidePopup
(
)
;
await
hiddenPromise
;
}
)
;
