"
use
strict
"
;
add_task
(
async
function
test_library_after_appMenu
(
)
{
if
(
PanelUI
.
protonAppMenuEnabled
)
{
Assert
.
ok
(
true
"
Skipping
test
because
the
Library
is
no
longer
in
the
Proton
AppMenu
.
"
)
;
return
;
}
await
gCUITestUtils
.
openMainMenu
(
)
;
document
.
getElementById
(
"
appMenu
-
library
-
button
"
)
.
click
(
)
;
let
libraryView
=
document
.
getElementById
(
"
appMenu
-
libraryView
"
)
;
let
promise
=
BrowserTestUtils
.
waitForEvent
(
libraryView
"
ViewShown
"
)
;
await
promise
;
promise
=
BrowserTestUtils
.
waitForEvent
(
libraryView
"
ViewShown
"
)
;
document
.
getElementById
(
"
library
-
button
"
)
.
click
(
)
;
await
promise
;
document
.
getElementById
(
"
appMenu
-
library
-
history
-
button
"
)
.
click
(
)
;
let
historyView
=
document
.
getElementById
(
"
PanelUI
-
history
"
)
;
promise
=
BrowserTestUtils
.
waitForEvent
(
historyView
"
ViewShown
"
)
;
await
promise
;
Assert
.
ok
(
PanelView
.
forNode
(
historyView
)
.
active
)
;
let
historyPanel
=
historyView
.
closest
(
"
panel
"
)
;
promise
=
BrowserTestUtils
.
waitForEvent
(
historyPanel
"
popuphidden
"
)
;
historyPanel
.
hidePopup
(
)
;
await
promise
;
}
)
;
