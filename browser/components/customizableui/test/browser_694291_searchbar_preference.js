"
use
strict
"
;
const
WIDGET_ID
=
"
search
-
container
"
;
const
PREF_NAME
=
"
browser
.
search
.
widget
.
inNavBar
"
;
function
checkDefaults
(
)
{
ok
(
Services
.
prefs
.
getBoolPref
(
PREF_NAME
)
)
;
let
placement
=
CustomizableUI
.
getPlacementOfWidget
(
WIDGET_ID
)
;
is
(
placement
.
area
CustomizableUI
.
AREA_NAVBAR
)
;
is
(
placement
.
position
CustomizableUI
.
getPlacementOfWidget
(
"
urlbar
-
container
"
)
.
position
+
1
)
;
}
add_task
(
async
function
test_defaults
(
)
{
checkDefaults
(
)
;
}
)
;
add_task
(
async
function
test_syncPreferenceWithWidget
(
)
{
CustomizableUI
.
addWidgetToArea
(
WIDGET_ID
CustomizableUI
.
AREA_FIXED_OVERFLOW_PANEL
)
;
ok
(
!
Services
.
prefs
.
getBoolPref
(
PREF_NAME
)
)
;
CustomizableUI
.
addWidgetToArea
(
WIDGET_ID
CustomizableUI
.
AREA_NAVBAR
)
;
ok
(
Services
.
prefs
.
getBoolPref
(
PREF_NAME
)
)
;
}
)
;
add_task
(
async
function
test_syncWidgetWithPreference
(
)
{
Services
.
prefs
.
setBoolPref
(
PREF_NAME
false
)
;
is
(
CustomizableUI
.
getPlacementOfWidget
(
WIDGET_ID
)
null
)
;
Services
.
prefs
.
setBoolPref
(
PREF_NAME
true
)
;
checkDefaults
(
)
;
}
)
;
