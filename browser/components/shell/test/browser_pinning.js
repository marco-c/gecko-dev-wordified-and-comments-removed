"
use
strict
"
;
add_task
(
async
function
test_getTaskbarTabShortcutPath
(
)
{
ShellService
.
getTaskbarTabShortcutPath
(
"
working
"
)
;
ShellService
.
getTaskbarTabShortcutPath
(
"
workingPath
.
ink
"
)
;
ShellService
.
getTaskbarTabShortcutPath
(
"
working
path
.
ink
"
)
;
const
invalidFilenames
=
[
"
?
"
"
:
"
"
<
"
"
>
"
"
|
"
'
"
'
"
/
"
"
*
"
"
\
t
"
"
\
r
"
"
\
n
"
"
.
.
\
\
something
"
"
.
\
\
something
"
"
.
something
"
"
something
.
"
"
something
"
"
CON
"
"
PRN
"
"
AUX
"
"
NUL
"
"
COM1
"
"
COM2
"
"
COM3
"
"
COM4
"
"
COM5
"
"
COM6
"
"
COM7
"
"
COM8
"
"
COM9
"
"
LPT1
"
"
LPT2
"
"
LPT3
"
"
LPT4
"
"
LPT5
"
"
LPT6
"
"
LPT7
"
"
LPT8
"
"
LPT9
"
]
;
for
(
const
invalidFilename
of
invalidFilenames
)
{
Assert
.
throws
(
(
)
=
>
{
ShellService
.
getTaskbarTabShortcutPath
(
invalidFilename
)
;
}
/
NS_ERROR_FILE_INVALID_PATH
/
invalidFilename
+
"
is
an
invalid
filename
;
getTaskbarTabShortcutPath
should
have
failed
with
it
as
a
parameter
.
"
)
;
}
}
)
;
