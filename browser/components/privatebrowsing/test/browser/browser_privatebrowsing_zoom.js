add_task
(
async
function
test
(
)
{
let
win
=
(
await
BrowserTestUtils
.
openNewBrowserWindow
(
{
private
:
true
}
)
)
;
let
tabAbout
=
(
await
BrowserTestUtils
.
openNewForegroundTab
(
win
.
gBrowser
"
about
:
"
)
)
;
let
tabMozilla
=
(
await
BrowserTestUtils
.
openNewForegroundTab
(
win
.
gBrowser
"
about
:
"
)
)
;
let
mozillaZoom
=
win
.
ZoomManager
.
zoom
;
win
.
FullZoom
.
enlarge
(
)
;
isnot
(
win
.
ZoomManager
.
zoom
mozillaZoom
"
Zoom
level
can
be
changed
"
)
;
mozillaZoom
=
win
.
ZoomManager
.
zoom
;
await
BrowserTestUtils
.
switchTab
(
win
.
gBrowser
tabAbout
)
;
await
BrowserTestUtils
.
switchTab
(
win
.
gBrowser
tabMozilla
)
;
is
(
win
.
ZoomManager
.
zoom
mozillaZoom
"
Entering
private
browsing
should
not
reset
the
zoom
on
a
tab
"
)
;
win
.
FullZoom
.
reset
(
)
;
await
Promise
.
all
(
[
BrowserTestUtils
.
removeTab
(
tabMozilla
)
BrowserTestUtils
.
removeTab
(
tabAbout
)
]
)
;
await
BrowserTestUtils
.
closeWindow
(
win
)
;
}
)
;
