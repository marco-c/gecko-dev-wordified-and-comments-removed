const
path
=
require
(
"
path
"
)
;
const
projectRoot
=
path
.
resolve
(
__dirname
"
.
.
/
.
.
/
.
.
/
.
.
/
"
)
;
function
getDocsStoryTitle
(
filePath
)
{
let
fileName
=
path
.
basename
(
filePath
"
.
stories
.
md
"
)
;
let
pascalCaseName
=
toPascalCase
(
fileName
)
;
return
pascalCaseName
.
match
(
/
[
A
-
Z
]
[
a
-
z
]
+
/
g
)
?
.
join
(
"
"
)
|
|
pascalCaseName
;
}
function
toPascalCase
(
str
)
{
return
str
.
match
(
/
[
a
-
z0
-
9
]
+
/
gi
)
.
map
(
text
=
>
text
[
0
]
.
toUpperCase
(
)
+
text
.
substring
(
1
)
)
.
join
(
"
"
)
;
}
module
.
exports
=
function
markdownStoryLoader
(
source
)
{
let
storyPath
=
"
Docs
"
;
let
relativePath
=
path
.
relative
(
projectRoot
this
.
resourcePath
)
.
replaceAll
(
path
.
sep
"
/
"
)
;
if
(
relativePath
.
includes
(
"
toolkit
/
content
/
widgets
"
)
)
{
let
storyNameRegex
=
/
(
?
<
=
\
/
widgets
\
/
)
(
?
<
name
>
.
*
?
)
(
?
=
\
/
)
/
g
;
let
componentName
=
storyNameRegex
.
exec
(
relativePath
)
?
.
groups
?
.
name
;
if
(
componentName
)
{
storyPath
=
Design
System
/
Experiments
/
{
toPascalCase
(
componentName
)
}
;
}
}
let
storyTitle
=
getDocsStoryTitle
(
relativePath
)
;
let
mdxSource
=
import
{
Meta
Description
}
from
"
storybook
/
addon
-
docs
"
;
<
Meta
title
=
"
{
storyPath
}
/
{
storyTitle
}
"
parameters
=
{
{
previewTabs
:
{
canvas
:
{
hidden
:
true
}
}
viewMode
:
"
docs
"
}
}
/
>
{
source
}
;
return
mdxSource
;
}
;
