#
!
/
usr
/
bin
/
env
node
"
use
strict
"
;
const
process
=
require
(
"
process
"
)
;
require
(
"
shelljs
/
global
"
)
;
const
simpleGit
=
require
(
"
simple
-
git
"
)
(
process
.
cwd
(
)
)
;
const
time
=
new
Date
(
)
;
const
minuteOfDay
=
time
.
getUTCHours
(
)
*
60
+
time
.
getUTCMinutes
(
)
;
function
zeroPadStart
(
s
width
)
{
let
padded
=
String
(
s
)
;
while
(
padded
.
length
<
width
)
{
padded
=
0
{
padded
}
;
}
return
padded
;
}
simpleGit
.
revparse
(
[
"
-
-
short
"
"
HEAD
"
]
(
err
gitHash
)
=
>
{
if
(
err
)
{
console
.
error
(
SimpleGit
.
revparse
failed
:
{
err
}
)
;
throw
new
Error
(
SimpleGit
.
revparse
failed
:
{
err
}
)
;
}
let
versionString
=
String
(
time
.
getUTCFullYear
(
)
)
+
"
.
"
+
zeroPadStart
(
time
.
getUTCMonth
(
)
+
1
2
)
+
"
.
"
+
zeroPadStart
(
time
.
getUTCDate
(
)
2
)
+
"
.
"
+
zeroPadStart
(
minuteOfDay
4
)
+
"
-
"
+
gitHash
.
trim
(
)
;
cd
(
process
.
argv
[
2
]
)
;
sed
(
"
-
i
"
/
(
<
em
:
version
>
)
.
+
(
<
\
/
em
:
version
>
)
/
1
{
versionString
}
2
"
install
.
rdf
.
in
"
)
;
}
)
;
