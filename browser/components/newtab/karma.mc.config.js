const
path
=
require
(
"
path
"
)
;
const
webpack
=
require
(
"
webpack
"
)
;
const
PATHS
=
{
testEntryFile
:
path
.
resolve
(
__dirname
"
test
/
unit
/
unit
-
entry
.
js
"
)
testFilesPattern
:
"
test
/
unit
/
*
*
/
*
.
js
"
moduleResolveDirectory
:
__dirname
resourcePathRegEx
:
/
^
resource
:
\
/
\
/
activity
-
stream
\
/
/
coverageReportingPath
:
"
logs
/
coverage
/
"
}
;
const
preprocessors
=
{
}
;
preprocessors
[
PATHS
.
testFilesPattern
]
=
[
"
webpack
"
"
sourcemap
"
]
;
module
.
exports
=
function
(
config
)
{
const
isTDD
=
config
.
tdd
;
const
browsers
=
isTDD
?
[
"
Firefox
"
]
:
[
"
FirefoxHeadless
"
]
;
config
.
set
(
{
singleRun
:
!
isTDD
browsers
customLaunchers
:
{
FirefoxHeadless
:
{
base
:
"
Firefox
"
flags
:
[
"
-
-
headless
"
]
}
}
frameworks
:
[
"
chai
"
"
mocha
"
"
sinon
"
]
reporters
:
[
"
coverage
-
istanbul
"
"
mocha
"
"
json
"
]
jsonReporter
:
{
stdout
:
false
outputFile
:
path
.
join
(
"
logs
"
"
karma
-
run
-
results
.
json
"
)
}
coverageIstanbulReporter
:
{
reports
:
[
"
lcov
"
"
text
-
summary
"
]
"
report
-
config
"
:
{
lcov
:
{
projectRoot
:
"
.
.
/
.
.
/
.
.
"
}
}
dir
:
PATHS
.
coverageReportingPath
thresholds
:
!
isTDD
&
&
{
each
:
{
statements
:
100
lines
:
100
functions
:
100
branches
:
66
overrides
:
{
"
lib
/
AboutPreferences
.
jsm
"
:
{
statements
:
98
lines
:
98
functions
:
100
branches
:
66
}
"
lib
/
ASRouter
.
jsm
"
:
{
statements
:
75
lines
:
75
functions
:
64
branches
:
66
}
"
lib
/
ASRouterDefaultConfig
.
jsm
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
asrouter
/
asrouter
-
utils
.
js
"
:
{
statements
:
66
lines
:
66
functions
:
100
branches
:
63
}
"
lib
/
TelemetryFeed
.
jsm
"
:
{
statements
:
99
lines
:
99
functions
:
100
branches
:
96
}
"
lib
/
ASRouterParentProcessMessageHandler
.
jsm
"
:
{
statements
:
98
lines
:
98
functions
:
100
branches
:
88
}
"
content
-
src
/
lib
/
init
-
store
.
js
"
:
{
statements
:
98
lines
:
98
functions
:
100
branches
:
100
}
"
lib
/
ActivityStreamStorage
.
jsm
"
:
{
statements
:
100
lines
:
100
functions
:
100
branches
:
83
}
"
lib
/
PlacesFeed
.
jsm
"
:
{
statements
:
98
lines
:
98
functions
:
100
branches
:
84
}
"
lib
/
UTEventReporting
.
jsm
"
:
{
statements
:
100
lines
:
100
functions
:
100
branches
:
75
}
"
lib
/
TopSitesFeed
.
jsm
"
:
{
statements
:
70
lines
:
75
functions
:
80
branches
:
60
}
"
lib
/
Screenshots
.
jsm
"
:
{
statements
:
94
lines
:
94
functions
:
100
branches
:
84
}
"
lib
/
*
.
jsm
"
:
{
statements
:
100
lines
:
100
functions
:
100
branches
:
84
}
"
content
-
src
/
components
/
DiscoveryStreamComponents
/
*
*
/
*
.
jsx
"
:
{
statements
:
90
.
48
lines
:
90
.
48
functions
:
85
.
71
branches
:
68
.
75
}
"
content
-
src
/
asrouter
/
*
*
/
*
.
jsx
"
:
{
statements
:
57
lines
:
58
functions
:
60
branches
:
50
}
"
content
-
src
/
components
/
ASRouterAdmin
/
*
.
jsx
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
components
/
CustomizeMenu
/
*
*
/
*
.
jsx
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
components
/
CustomizeMenu
/
*
.
jsx
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
lib
/
aboutwelcome
-
utils
.
js
"
:
{
statements
:
50
lines
:
50
functions
:
100
branches
:
0
}
"
content
-
src
/
lib
/
link
-
menu
-
options
.
js
"
:
{
statements
:
96
lines
:
96
functions
:
96
branches
:
70
}
"
content
-
src
/
aboutwelcome
/
components
/
LanguageSwitcher
.
jsx
"
:
{
statements
:
0
lines
:
0
functions
:
0
branches
:
0
}
"
content
-
src
/
aboutwelcome
/
*
*
/
*
.
jsx
"
:
{
statements
:
62
lines
:
60
functions
:
50
branches
:
50
}
"
content
-
src
/
components
/
*
*
/
*
.
jsx
"
:
{
statements
:
51
.
1
lines
:
52
.
38
functions
:
31
.
2
branches
:
31
.
2
}
}
}
}
}
files
:
[
PATHS
.
testEntryFile
]
preprocessors
webpack
:
{
mode
:
"
none
"
devtool
:
"
inline
-
source
-
map
"
resolveLoader
:
{
alias
:
{
inject
:
path
.
join
(
__dirname
"
loaders
/
inject
-
loader
"
)
}
}
resolve
:
{
extensions
:
[
"
.
js
"
"
.
jsx
"
]
modules
:
[
PATHS
.
moduleResolveDirectory
"
node_modules
"
]
fallback
:
{
stream
:
require
.
resolve
(
"
stream
-
browserify
"
)
buffer
:
require
.
resolve
(
"
buffer
"
)
}
}
plugins
:
[
new
webpack
.
DefinePlugin
(
{
"
process
.
env
.
NODE_ENV
"
:
JSON
.
stringify
(
"
development
"
)
}
)
]
externals
:
{
"
react
/
addons
"
:
true
"
react
/
lib
/
ReactContext
"
:
true
"
react
/
lib
/
ExecutionEnvironment
"
:
true
}
module
:
{
rules
:
[
{
test
:
/
\
.
jsm
/
exclude
:
[
/
node_modules
/
]
use
:
[
{
loader
:
"
babel
-
loader
"
options
:
{
plugins
:
[
[
"
jsm
-
to
-
commonjs
"
{
basePath
:
PATHS
.
resourcePathRegEx
removeOtherImports
:
true
replace
:
true
}
]
"
babel
/
plugin
-
proposal
-
nullish
-
coalescing
-
operator
"
"
babel
/
plugin
-
proposal
-
optional
-
chaining
"
"
babel
/
plugin
-
proposal
-
class
-
properties
"
]
}
}
]
}
{
test
:
/
\
.
js
/
exclude
:
[
/
node_modules
\
/
(
?
!
(
fluent
|
fluent
-
react
)
\
/
)
.
*
/
/
test
/
]
loader
:
"
babel
-
loader
"
}
{
test
:
/
\
.
jsx
/
exclude
:
/
node_modules
/
loader
:
"
babel
-
loader
"
options
:
{
presets
:
[
"
babel
/
preset
-
react
"
]
plugins
:
[
"
babel
/
plugin
-
proposal
-
nullish
-
coalescing
-
operator
"
"
babel
/
plugin
-
proposal
-
optional
-
chaining
"
]
}
}
{
test
:
/
\
.
md
/
use
:
"
raw
-
loader
"
}
{
enforce
:
"
post
"
test
:
/
\
.
js
[
mx
]
?
/
loader
:
"
istanbul
-
instrumenter
-
loader
"
options
:
{
esModules
:
true
}
include
:
[
path
.
resolve
(
"
content
-
src
"
)
path
.
resolve
(
"
lib
"
)
path
.
resolve
(
"
common
"
)
]
exclude
:
[
path
.
resolve
(
"
test
"
)
path
.
resolve
(
"
vendor
"
)
path
.
resolve
(
"
lib
/
ASRouterTargeting
.
jsm
"
)
path
.
resolve
(
"
lib
/
ASRouterTriggerListeners
.
jsm
"
)
path
.
resolve
(
"
lib
/
OnboardingMessageProvider
.
jsm
"
)
path
.
resolve
(
"
lib
/
CFRMessageProvider
.
jsm
"
)
path
.
resolve
(
"
lib
/
CFRPageActions
.
jsm
"
)
]
}
]
}
}
webpackMiddleware
:
{
noInfo
:
true
}
}
)
;
}
;
