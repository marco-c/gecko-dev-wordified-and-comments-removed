async
function
fetchMenuTree
(
)
{
function
nodeToInfo
(
{
uri
children
}
)
{
return
{
.
.
.
(
uri
?
{
uri
}
:
{
}
)
.
.
.
(
children
?
{
children
:
children
.
map
(
nodeToInfo
)
}
:
{
}
)
}
;
}
return
nodeToInfo
(
await
PlacesUtils
.
promiseBookmarksTree
(
PlacesUtils
.
bookmarks
.
menuGuid
)
)
;
}
add_task
(
async
function
checkDefaultBookmarks
(
)
{
if
(
AppConstants
.
NIGHTLY_BUILD
)
{
Assert
.
deepEqual
(
await
fetchMenuTree
(
)
{
children
:
[
{
children
:
[
{
uri
:
"
https
:
/
/
www
.
mozilla
.
org
/
contribute
/
?
utm_medium
=
firefox
-
desktop
&
utm_source
=
bookmarks
-
toolbar
&
utm_campaign
=
new
-
users
-
nightly
&
utm_content
=
-
global
"
}
{
uri
:
"
https
:
/
/
blog
.
nightly
.
mozilla
.
org
/
"
}
{
uri
:
"
https
:
/
/
bugzilla
.
mozilla
.
org
/
"
}
{
uri
:
"
https
:
/
/
developer
.
mozilla
.
org
/
"
}
{
uri
:
"
https
:
/
/
addons
.
mozilla
.
org
/
firefox
/
addon
/
nightly
-
tester
-
tools
/
"
}
{
uri
:
"
about
:
crashes
"
}
{
uri
:
"
https
:
/
/
planet
.
mozilla
.
org
/
"
}
]
}
]
}
)
;
}
else
if
(
AppConstants
.
EARLY_BETA_OR_EARLIER
)
{
Assert
.
deepEqual
(
await
fetchMenuTree
(
)
{
children
:
[
{
children
:
[
{
uri
:
"
https
:
/
/
support
.
mozilla
.
org
/
products
/
firefox
"
}
{
uri
:
"
https
:
/
/
support
.
mozilla
.
org
/
kb
/
customize
-
firefox
-
controls
-
buttons
-
and
-
toolbars
?
utm_source
=
firefox
-
browser
&
utm_medium
=
default
-
bookmarks
&
utm_campaign
=
customize
"
}
{
uri
:
"
https
:
/
/
www
.
mozilla
.
org
/
contribute
/
?
utm_medium
=
firefox
-
desktop
&
utm_source
=
bookmarks
-
toolbar
&
utm_campaign
=
new
-
users
-
beta
&
utm_content
=
-
global
"
}
{
uri
:
"
https
:
/
/
www
.
mozilla
.
org
/
about
/
"
}
]
}
]
}
)
;
}
else
{
Assert
.
deepEqual
(
await
fetchMenuTree
(
)
{
children
:
[
{
children
:
[
{
uri
:
"
https
:
/
/
support
.
mozilla
.
org
/
products
/
firefox
"
}
{
uri
:
"
https
:
/
/
support
.
mozilla
.
org
/
kb
/
customize
-
firefox
-
controls
-
buttons
-
and
-
toolbars
?
utm_source
=
firefox
-
browser
&
utm_medium
=
default
-
bookmarks
&
utm_campaign
=
customize
"
}
{
uri
:
"
https
:
/
/
www
.
mozilla
.
org
/
contribute
/
"
}
{
uri
:
"
https
:
/
/
www
.
mozilla
.
org
/
about
/
"
}
]
}
]
}
)
;
}
}
)
;
