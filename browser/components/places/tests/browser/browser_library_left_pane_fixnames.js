var
leftPaneQueries
=
[
]
;
function
onLibraryReady
(
organizer
)
{
for
(
var
i
=
0
;
i
<
leftPaneQueries
.
length
;
i
+
+
)
{
var
query
=
leftPaneQueries
[
i
]
;
is
(
PlacesUtils
.
bookmarks
.
getItemTitle
(
query
.
itemId
)
query
.
correctTitle
"
Title
is
correct
for
query
"
+
query
.
name
)
;
if
(
"
concreteId
"
in
query
)
{
is
(
PlacesUtils
.
bookmarks
.
getItemTitle
(
query
.
concreteId
)
query
.
concreteTitle
"
Concrete
title
is
correct
for
query
"
+
query
.
name
)
;
}
}
organizer
.
close
(
)
;
finish
(
)
;
}
function
test
(
)
{
waitForExplicitFinish
(
)
;
ok
(
PlacesUIUtils
.
leftPaneFolderId
>
0
"
left
pane
folder
is
initialized
"
)
;
var
leftPaneItems
=
PlacesUtils
.
annotations
.
getItemsWithAnnotation
(
PlacesUIUtils
.
ORGANIZER_FOLDER_ANNO
)
;
is
(
leftPaneItems
.
length
1
"
We
correctly
have
only
1
left
pane
folder
"
)
;
var
version
=
PlacesUtils
.
annotations
.
getItemAnnotation
(
leftPaneItems
[
0
]
PlacesUIUtils
.
ORGANIZER_FOLDER_ANNO
)
;
is
(
version
PlacesUIUtils
.
ORGANIZER_LEFTPANE_VERSION
"
Left
pane
version
is
actual
"
)
;
var
items
=
PlacesUtils
.
annotations
.
getItemsWithAnnotation
(
PlacesUIUtils
.
ORGANIZER_QUERY_ANNO
)
;
for
(
var
i
=
0
;
i
<
items
.
length
;
i
+
+
)
{
var
itemId
=
items
[
i
]
;
var
queryName
=
PlacesUtils
.
annotations
.
getItemAnnotation
(
items
[
i
]
PlacesUIUtils
.
ORGANIZER_QUERY_ANNO
)
;
var
query
=
{
name
:
queryName
itemId
correctTitle
:
PlacesUtils
.
bookmarks
.
getItemTitle
(
itemId
)
}
;
leftPaneQueries
.
push
(
query
)
;
PlacesUtils
.
bookmarks
.
setItemTitle
(
query
.
itemId
"
badName
"
)
;
}
restoreLeftPaneGetters
(
)
;
openLibrary
(
onLibraryReady
)
;
}
