"
use
strict
"
;
const
{
BrowserUITelemetry
:
BUIT
}
=
Cu
.
import
(
"
resource
:
/
/
/
modules
/
BrowserUITelemetry
.
jsm
"
{
}
)
;
add_task
(
async
function
testSidebarOpenClose
(
)
{
BUIT
.
_countableEvents
=
{
}
;
await
SidebarUI
.
show
(
"
viewTabsSidebar
"
)
;
let
counts
=
BUIT
.
_countableEvents
[
BUIT
.
currentBucket
]
;
Assert
.
deepEqual
(
counts
{
sidebar
:
{
viewTabsSidebar
:
{
show
:
1
}
}
}
)
;
await
SidebarUI
.
hide
(
)
;
Assert
.
deepEqual
(
counts
{
sidebar
:
{
viewTabsSidebar
:
{
show
:
1
hide
:
1
}
}
}
)
;
await
SidebarUI
.
show
(
"
viewBookmarksSidebar
"
)
;
Assert
.
deepEqual
(
counts
{
sidebar
:
{
viewTabsSidebar
:
{
show
:
1
hide
:
1
}
viewBookmarksSidebar
:
{
show
:
1
}
}
}
)
;
await
SidebarUI
.
show
(
"
viewTabsSidebar
"
)
;
Assert
.
deepEqual
(
counts
{
sidebar
:
{
viewTabsSidebar
:
{
show
:
2
hide
:
1
}
viewBookmarksSidebar
:
{
show
:
1
hide
:
1
}
}
}
)
;
await
SidebarUI
.
hide
(
)
;
Assert
.
deepEqual
(
counts
{
sidebar
:
{
viewTabsSidebar
:
{
show
:
2
hide
:
2
}
viewBookmarksSidebar
:
{
show
:
1
hide
:
1
}
}
}
)
;
await
SidebarUI
.
toggle
(
"
viewTabsSidebar
"
)
;
Assert
.
deepEqual
(
counts
{
sidebar
:
{
viewTabsSidebar
:
{
show
:
3
hide
:
2
}
viewBookmarksSidebar
:
{
show
:
1
hide
:
1
}
}
}
)
;
await
SidebarUI
.
toggle
(
"
viewTabsSidebar
"
)
;
Assert
.
deepEqual
(
counts
{
sidebar
:
{
viewTabsSidebar
:
{
show
:
3
hide
:
3
}
viewBookmarksSidebar
:
{
show
:
1
hide
:
1
}
}
}
)
;
}
)
;
