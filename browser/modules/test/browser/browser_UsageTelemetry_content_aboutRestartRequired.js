"
use
strict
"
;
const
SCALAR_BUILDID_MISMATCH
=
"
dom
.
contentprocess
.
buildID_mismatch
"
;
add_task
(
async
function
test_aboutRestartRequired
(
)
{
let
CrashHandlers
=
{
}
;
ChromeUtils
.
import
(
"
resource
:
/
/
/
modules
/
ContentCrashHandlers
.
jsm
"
CrashHandlers
)
;
Services
.
telemetry
.
clearScalars
(
)
;
let
scalars
=
getParentProcessScalars
(
Ci
.
nsITelemetry
.
DATASET_RELEASE_CHANNEL_OPTOUT
)
;
is
(
scalars
[
SCALAR_BUILDID_MISMATCH
]
undefined
"
Build
ID
mismatch
count
should
be
undefined
"
)
;
CrashHandlers
.
TabCrashHandler
.
_crashedTabCount
=
1
;
CrashHandlers
.
TabCrashHandler
.
sendToRestartRequiredPage
(
gBrowser
.
selectedTab
.
linkedBrowser
)
;
scalars
=
getParentProcessScalars
(
Ci
.
nsITelemetry
.
DATASET_RELEASE_CHANNEL_OPTOUT
)
;
is
(
scalars
[
SCALAR_BUILDID_MISMATCH
]
1
"
Build
ID
mismatch
count
should
be
1
.
"
)
;
}
)
;
