var
gSafeBrowsing
=
{
setReportPhishingMenu
(
)
{
var
docURI
=
gBrowser
.
selectedBrowser
.
documentURI
;
var
isPhishingPage
=
docURI
&
&
docURI
.
spec
.
startsWith
(
"
about
:
blocked
?
e
=
deceptiveBlocked
"
)
;
document
.
getElementById
(
"
menu_HelpPopup_reportPhishingtoolmenu
"
)
.
hidden
=
isPhishingPage
;
document
.
getElementById
(
"
menu_HelpPopup_reportPhishingErrortoolmenu
"
)
.
hidden
=
!
isPhishingPage
;
var
broadcasterId
=
isPhishingPage
?
"
reportPhishingErrorBroadcaster
"
:
"
reportPhishingBroadcaster
"
;
var
broadcaster
=
document
.
getElementById
(
broadcasterId
)
;
if
(
!
broadcaster
)
return
;
let
uri
=
gBrowser
.
currentURI
;
if
(
uri
&
&
(
uri
.
schemeIs
(
"
http
"
)
|
|
uri
.
schemeIs
(
"
https
"
)
)
)
broadcaster
.
removeAttribute
(
"
disabled
"
)
;
else
broadcaster
.
setAttribute
(
"
disabled
"
true
)
;
}
getReportURL
(
name
info
)
{
let
reportInfo
=
info
;
if
(
!
reportInfo
)
{
let
pageUri
=
gBrowser
.
currentURI
.
clone
(
)
;
if
(
pageUri
instanceof
Ci
.
nsIURL
)
{
pageUri
.
query
=
"
"
;
}
reportInfo
=
{
uri
:
pageUri
.
asciiSpec
}
;
}
return
SafeBrowsing
.
getReportURL
(
name
reportInfo
)
;
}
}
