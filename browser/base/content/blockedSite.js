function
getErrorCode
(
)
{
var
url
=
document
.
documentURI
;
var
error
=
url
.
search
(
/
e
\
=
/
)
;
var
duffUrl
=
url
.
search
(
/
\
&
u
\
=
/
)
;
return
decodeURIComponent
(
url
.
slice
(
error
+
2
duffUrl
)
)
;
}
function
getURL
(
)
{
var
url
=
document
.
documentURI
;
var
match
=
url
.
match
(
/
&
u
=
(
[
^
&
]
+
)
&
/
)
;
if
(
!
match
)
return
"
"
;
url
=
decodeURIComponent
(
match
[
1
]
)
;
if
(
url
.
startsWith
(
"
view
-
source
:
"
)
)
url
=
url
.
slice
(
12
)
;
return
url
;
}
function
getOverride
(
)
{
var
url
=
document
.
documentURI
;
var
match
=
url
.
match
(
/
&
o
=
1
&
/
)
;
return
!
!
match
;
}
function
getHostString
(
)
{
try
{
return
document
.
location
.
hostname
;
}
catch
(
e
)
{
return
getURL
(
)
;
}
}
function
onClickSeeDetails
(
)
{
let
details
=
document
.
getElementById
(
"
errorDescriptionContainer
"
)
;
if
(
details
.
hidden
)
{
details
.
removeAttribute
(
"
hidden
"
)
;
}
else
{
details
.
setAttribute
(
"
hidden
"
"
true
"
)
;
}
}
function
initPage
(
)
{
var
error
=
"
"
;
switch
(
getErrorCode
(
)
)
{
case
"
malwareBlocked
"
:
error
=
"
malware
"
;
break
;
case
"
deceptiveBlocked
"
:
error
=
"
phishing
"
;
break
;
case
"
unwantedBlocked
"
:
error
=
"
unwanted
"
;
break
;
case
"
harmfulBlocked
"
:
error
=
"
harmful
"
;
break
;
default
:
return
;
}
var
el
;
if
(
error
!
=
=
"
malware
"
)
{
el
=
document
.
getElementById
(
"
errorTitleText_malware
"
)
;
el
.
remove
(
)
;
el
=
document
.
getElementById
(
"
errorShortDescText_malware
"
)
;
el
.
remove
(
)
;
el
=
document
.
getElementById
(
"
errorLongDesc_malware
"
)
;
el
.
remove
(
)
;
}
if
(
error
!
=
=
"
phishing
"
)
{
el
=
document
.
getElementById
(
"
errorTitleText_phishing
"
)
;
el
.
remove
(
)
;
el
=
document
.
getElementById
(
"
errorShortDescText_phishing
"
)
;
el
.
remove
(
)
;
el
=
document
.
getElementById
(
"
errorLongDesc_phishing
"
)
;
el
.
remove
(
)
;
}
if
(
error
!
=
=
"
unwanted
"
)
{
el
=
document
.
getElementById
(
"
errorTitleText_unwanted
"
)
;
el
.
remove
(
)
;
el
=
document
.
getElementById
(
"
errorShortDescText_unwanted
"
)
;
el
.
remove
(
)
;
el
=
document
.
getElementById
(
"
errorLongDesc_unwanted
"
)
;
el
.
remove
(
)
;
}
if
(
error
!
=
=
"
harmful
"
)
{
el
=
document
.
getElementById
(
"
errorTitleText_harmful
"
)
;
el
.
remove
(
)
;
el
=
document
.
getElementById
(
"
errorShortDescText_harmful
"
)
;
el
.
remove
(
)
;
el
=
document
.
getElementById
(
"
errorLongDesc_harmful
"
)
;
el
.
remove
(
)
;
}
if
(
getOverride
(
)
)
{
document
.
getElementById
(
error
+
"
_error_desc_no_override
"
)
.
remove
(
)
;
}
else
{
document
.
getElementById
(
error
+
"
_error_desc_override
"
)
.
remove
(
)
;
}
let
sitenameElem
=
document
.
getElementById
(
error
+
"
_sitename
"
)
;
sitenameElem
.
setAttribute
(
"
class
"
"
sitename
"
)
;
sitenameElem
.
textContent
=
getHostString
(
)
;
document
.
title
=
document
.
getElementById
(
"
errorTitleText_
"
+
error
)
.
textContent
;
var
event
=
new
CustomEvent
(
"
AboutBlockedLoaded
"
{
bubbles
:
true
detail
:
{
url
:
this
.
getURL
(
)
err
:
error
}
}
)
;
document
.
dispatchEvent
(
event
)
;
}
let
seeDetailsButton
=
document
.
getElementById
(
"
seeDetailsButton
"
)
;
seeDetailsButton
.
addEventListener
(
"
click
"
onClickSeeDetails
)
;
initPage
(
)
;
