XPCOMUtils
.
defineLazyModuleGetter
(
this
"
ExtensionParent
"
"
resource
:
/
/
gre
/
modules
/
ExtensionParent
.
jsm
"
)
;
function
loadWebPanel
(
)
{
let
sidebarURI
=
new
URL
(
location
)
;
let
uri
=
sidebarURI
.
searchParams
.
get
(
"
panel
"
)
;
let
remote
=
sidebarURI
.
searchParams
.
get
(
"
remote
"
)
;
let
browser
=
document
.
getElementById
(
"
webext
-
panels
-
browser
"
)
;
if
(
remote
)
{
let
remoteType
=
E10SUtils
.
getRemoteTypeForURI
(
uri
true
E10SUtils
.
EXTENSION_REMOTE_TYPE
)
;
browser
.
setAttribute
(
"
remote
"
"
true
"
)
;
browser
.
setAttribute
(
"
remoteType
"
remoteType
)
;
}
else
{
browser
.
removeAttribute
(
"
remote
"
)
;
browser
.
removeAttribute
(
"
remoteType
"
)
;
}
browser
.
loadURI
(
uri
)
;
}
function
load
(
)
{
let
browser
=
document
.
getElementById
(
"
webext
-
panels
-
browser
"
)
;
browser
.
messageManager
.
loadFrameScript
(
"
chrome
:
/
/
browser
/
content
/
content
.
js
"
true
)
;
ExtensionParent
.
apiManager
.
emit
(
"
extension
-
browser
-
inserted
"
browser
)
;
this
.
loadWebPanel
(
)
;
}
