"
use
strict
"
;
Cu
.
import
(
"
resource
:
/
/
/
modules
/
TabGroupsMigrator
.
jsm
"
)
;
XPCOMUtils
.
defineLazyModuleGetter
(
this
"
PlacesUtils
"
"
resource
:
/
/
gre
/
modules
/
PlacesUtils
.
jsm
"
)
;
const
SUPPORT_URL
=
"
https
:
/
/
support
.
mozilla
.
org
/
kb
/
tab
-
groups
-
removal
"
;
function
createLink
(
)
{
let
link
=
document
.
getElementById
(
"
sumolink
"
)
;
link
.
href
=
SUPPORT_URL
;
link
.
target
=
"
_blank
"
;
}
let
loadPromise
=
new
Promise
(
resolve
=
>
{
let
loadHandler
=
e
=
>
{
window
.
removeEventListener
(
"
DOMContentLoaded
"
loadHandler
)
;
createLink
(
)
;
resolve
(
)
;
}
;
window
.
addEventListener
(
"
DOMContentLoaded
"
loadHandler
false
)
;
}
)
;
let
tabGroupsBookmarkItemId
;
if
(
TabGroupsMigrator
.
bookmarkedGroupsPromise
)
{
let
bookmarkPromise
=
TabGroupsMigrator
.
bookmarkedGroupsPromise
.
then
(
bm
=
>
{
return
PlacesUtils
.
promiseItemId
(
bm
.
guid
)
;
}
)
.
then
(
itemId
=
>
{
tabGroupsBookmarkItemId
=
itemId
}
)
;
Promise
.
all
(
[
bookmarkPromise
loadPromise
]
)
.
then
(
function
(
)
{
document
.
getElementById
(
"
show
-
migrated
-
bookmarks
-
button
"
)
.
style
.
removeProperty
(
"
display
"
)
;
}
)
;
}
function
showMigratedGroups
(
)
{
let
browserWin
=
getBrowserWindow
(
)
;
browserWin
.
PlacesCommandHook
.
showPlacesOrganizer
(
[
"
BookmarksMenu
"
tabGroupsBookmarkItemId
]
)
;
}
