document
.
addEventListener
(
"
DOMContentLoaded
"
(
)
=
>
{
const
navigatorToolbox
=
document
.
getElementById
(
"
navigator
-
toolbox
"
)
;
const
widgetOverflow
=
document
.
getElementById
(
"
widget
-
overflow
"
)
;
function
onPopupShowing
(
event
)
{
switch
(
event
.
target
.
id
)
{
case
"
PlacesChevronPopup
"
:
document
.
getElementById
(
"
PlacesToolbar
"
)
.
_placesView
.
_onChevronPopupShowing
(
event
)
;
break
;
case
"
BMB_bookmarksPopup
"
:
BookmarkingUI
.
onPopupShowing
(
event
)
;
case
"
BMB_bookmarksToolbarPopup
"
:
case
"
BMB_unsortedBookmarksPopup
"
:
case
"
BMB_mobileBookmarksPopup
"
:
if
(
!
event
.
target
.
parentNode
.
_placesView
)
{
let
placeMap
=
{
BMB_bookmarksPopup
:
PlacesUtils
.
bookmarks
.
menuGuid
BMB_bookmarksToolbarPopup
:
PlacesUtils
.
bookmarks
.
toolbarGuid
BMB_unsortedBookmarksPopup
:
PlacesUtils
.
bookmarks
.
unfiledGuid
BMB_mobileBookmarksPopup
:
PlacesUtils
.
bookmarks
.
mobileGuid
}
;
new
PlacesMenu
(
event
place
:
parent
=
{
placeMap
[
event
.
target
.
id
]
}
)
;
}
break
;
}
}
navigatorToolbox
.
addEventListener
(
"
popupshowing
"
onPopupShowing
)
;
widgetOverflow
.
addEventListener
(
"
popupshowing
"
onPopupShowing
)
;
function
onCommand
(
event
)
{
let
element
=
event
.
target
.
closest
(
#
firefox
-
view
-
button
#
content
-
analysis
-
indicator
#
bookmarks
-
toolbar
-
button
#
PlacesToolbar
#
import
-
button
#
bookmarks
-
menu
-
button
#
BMB_bookmarksPopup
#
BMB_viewBookmarksSidebar
#
BMB_searchBookmarks
#
BMB_viewBookmarksToolbar
)
;
if
(
!
element
)
{
return
;
}
switch
(
element
.
id
)
{
case
"
firefox
-
view
-
button
"
:
FirefoxViewHandler
.
openTab
(
)
;
break
;
case
"
content
-
analysis
-
indicator
"
:
ContentAnalysis
.
showPanel
(
element
PanelUI
)
;
break
;
case
"
bookmarks
-
toolbar
-
button
"
:
PlacesToolbarHelper
.
onPlaceholderCommand
(
)
;
break
;
case
"
PlacesToolbar
"
:
BookmarksEventHandler
.
onCommand
(
event
)
;
break
;
case
"
import
-
button
"
:
MigrationUtils
.
showMigrationWizard
(
window
{
entrypoint
:
MigrationUtils
.
MIGRATION_ENTRYPOINTS
.
BOOKMARKS_TOOLBAR
}
)
;
break
;
case
"
bookmarks
-
menu
-
button
"
:
BookmarkingUI
.
onCommand
(
event
)
;
break
;
case
"
BMB_bookmarksPopup
"
:
BookmarksEventHandler
.
onCommand
(
event
)
;
break
;
case
"
BMB_viewBookmarksSidebar
"
:
SidebarController
.
toggle
(
"
viewBookmarksSidebar
"
)
;
break
;
case
"
BMB_searchBookmarks
"
:
PlacesCommandHook
.
searchBookmarks
(
)
;
break
;
case
"
BMB_viewBookmarksToolbar
"
:
BookmarkingUI
.
toggleBookmarksToolbar
(
"
bookmarks
-
widget
"
)
;
break
;
default
:
throw
new
Error
(
Missing
case
for
#
{
element
.
id
}
)
;
}
}
navigatorToolbox
.
addEventListener
(
"
command
"
onCommand
)
;
widgetOverflow
.
addEventListener
(
"
command
"
onCommand
)
;
}
{
once
:
true
}
)
;
