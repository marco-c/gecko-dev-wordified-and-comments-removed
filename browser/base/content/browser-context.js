document
.
addEventListener
(
"
DOMContentLoaded
"
(
)
=
>
{
const
IS_WEBEXT_PANELS
=
document
.
documentElement
.
id
=
=
=
"
webextpanels
-
window
"
;
const
contextMenuPopup
=
document
.
getElementById
(
"
contentAreaContextMenu
"
)
;
contextMenuPopup
.
addEventListener
(
"
popupshowing
"
event
=
>
{
if
(
event
.
target
!
=
contextMenuPopup
)
{
return
;
}
gContextMenu
=
new
nsContextMenu
(
contextMenuPopup
event
.
shiftKey
)
;
if
(
!
gContextMenu
.
shouldDisplay
)
{
event
.
preventDefault
(
)
;
return
;
}
if
(
!
IS_WEBEXT_PANELS
)
{
updateEditUIVisibility
(
)
;
}
}
)
;
contextMenuPopup
.
addEventListener
(
"
popuphiding
"
event
=
>
{
if
(
event
.
target
!
=
contextMenuPopup
)
{
return
;
}
gContextMenu
.
hiding
(
contextMenuPopup
)
;
gContextMenu
=
null
;
if
(
!
IS_WEBEXT_PANELS
)
{
updateEditUIVisibility
(
)
;
}
}
)
;
}
{
once
:
true
}
)
;
