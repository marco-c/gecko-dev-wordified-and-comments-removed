"
use
strict
"
;
requestLongerTimeout
(
5
)
;
SimpleTest
.
expectChildProcessCrash
(
)
;
async
function
execTest
(
)
{
is
(
await
getFalsePositiveTelemetry
(
)
undefined
"
Build
ID
mismatch
false
positive
count
should
be
undefined
"
)
;
is
(
await
getTrueMismatchTelemetry
(
)
undefined
"
Build
ID
true
mismatch
count
should
be
undefined
"
)
;
await
forceCleanProcesses
(
)
;
let
eventPromise
=
getEventPromise
(
"
oop
-
browser
-
crashed
"
"
basic
"
)
;
let
tab
=
await
openNewTab
(
true
)
;
await
eventPromise
;
is
(
await
getTrueMismatchTelemetry
(
)
undefined
"
Build
ID
true
mismatch
count
should
be
undefined
"
)
;
is
(
await
getFalsePositiveTelemetry
(
)
undefined
"
Build
ID
mismatch
false
positive
count
should
be
undefined
"
)
;
await
closeTab
(
tab
)
;
}
add_task
(
async
function
test_telemetry_restartrequired_no_mismatch
(
)
{
info
(
"
Waiting
for
oop
-
browser
-
crashed
event
.
"
)
;
await
execTest
(
)
;
await
execTest
(
)
;
}
)
;
