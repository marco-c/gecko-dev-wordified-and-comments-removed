add_task
(
function
*
(
)
{
yield
pushPrefs
(
[
"
accessibility
.
tabfocus
"
7
]
)
;
let
FOCUS_COUNT
=
30
;
yield
setLinks
(
"
0
1
2
3
4
5
6
7
8
"
)
;
setPinnedLinks
(
"
"
)
;
yield
*
addNewTabPageTab
(
)
;
gURLBar
.
focus
(
)
;
countFocus
(
FOCUS_COUNT
)
;
NewTabUtils
.
allPages
.
enabled
=
false
;
countFocus
(
4
)
;
NewTabUtils
.
allPages
.
enabled
=
true
;
}
)
;
function
countFocus
(
aExpectedCount
)
{
let
focusCount
=
0
;
do
{
EventUtils
.
synthesizeKey
(
"
VK_TAB
"
{
}
)
;
if
(
document
.
activeElement
=
=
gBrowser
.
selectedBrowser
)
{
focusCount
+
+
;
}
}
while
(
document
.
activeElement
!
=
gURLBar
.
inputField
)
;
ok
(
focusCount
=
=
aExpectedCount
|
|
focusCount
=
=
(
aExpectedCount
+
1
)
"
Validate
focus
count
in
the
new
tab
page
.
"
)
;
}
