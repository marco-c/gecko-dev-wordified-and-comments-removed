add_task
(
function
*
(
)
{
yield
setLinks
(
"
0
1
2
3
4
5
6
7
8
"
)
;
setPinnedLinks
(
"
"
)
;
let
firstTab
=
yield
*
addNewTabPageTab
(
)
;
function
isGridDisabled
(
browser
=
gBrowser
.
selectedBrowser
)
{
return
ContentTask
.
spawn
(
browser
{
}
function
*
(
)
{
return
content
.
gGrid
.
node
.
hasAttribute
(
"
page
-
disabled
"
)
;
}
)
;
}
let
isDisabled
=
yield
isGridDisabled
(
)
;
ok
(
!
isDisabled
"
page
is
not
disabled
"
)
;
NewTabUtils
.
allPages
.
enabled
=
false
;
isDisabled
=
yield
isGridDisabled
(
)
;
ok
(
isDisabled
"
page
is
disabled
"
)
;
yield
*
addNewTabPageTab
(
)
;
isDisabled
=
yield
isGridDisabled
(
firstTab
.
linkedBrowser
)
;
ok
(
isDisabled
"
page
is
disabled
"
)
;
let
sitesLength
=
yield
ContentTask
.
spawn
(
gBrowser
.
selectedBrowser
{
}
function
*
(
)
{
return
content
.
document
.
querySelectorAll
(
"
.
site
"
)
.
length
;
}
)
;
is
(
0
sitesLength
"
no
sites
have
been
rendered
"
)
;
NewTabUtils
.
allPages
.
enabled
=
true
;
isDisabled
=
yield
isGridDisabled
(
)
;
ok
(
!
isDisabled
"
page
is
not
disabled
"
)
;
isDisabled
=
yield
isGridDisabled
(
firstTab
.
linkedBrowser
)
;
ok
(
!
isDisabled
"
old
page
is
not
disabled
"
)
;
}
)
;
