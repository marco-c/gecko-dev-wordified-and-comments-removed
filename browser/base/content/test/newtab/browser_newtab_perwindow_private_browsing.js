add_task
(
async
function
(
)
{
await
testOnWindow
(
undefined
)
;
await
setLinks
(
"
0
1
2
3
4
5
6
7
8
9
"
)
;
await
addNewTabPageTab
(
)
;
await
pinCell
(
0
)
;
await
checkGrid
(
"
0p
1
2
3
4
5
6
7
8
"
)
;
await
testOnWindow
(
{
private
:
true
}
)
;
await
addNewTabPageTab
(
)
;
await
checkGrid
(
"
0p
1
2
3
4
5
6
7
8
"
)
;
await
blockCell
(
1
)
;
await
checkGrid
(
"
0p
2
3
4
5
6
7
8
"
)
;
await
unpinCell
(
0
)
;
await
checkGrid
(
"
0
2
3
4
5
6
7
8
"
)
;
await
testOnWindow
(
undefined
)
;
await
addNewTabPageTab
(
)
;
await
checkGrid
(
"
0
2
3
4
5
6
7
8
"
)
;
}
)
;
var
windowsToClose
=
[
]
;
async
function
testOnWindow
(
options
)
{
let
newWindowPromise
=
BrowserTestUtils
.
waitForNewWindow
(
)
;
var
win
=
OpenBrowserWindow
(
options
)
;
windowsToClose
.
push
(
win
)
;
gWindow
=
win
;
await
newWindowPromise
;
}
registerCleanupFunction
(
function
(
)
{
gWindow
=
window
;
windowsToClose
.
forEach
(
function
(
win
)
{
win
.
close
(
)
;
}
)
;
}
)
;
