"
use
strict
"
;
const
EXPECTED_REFLOWS
=
[
[
"
_adjustFocusAfterTabSwitch
chrome
:
/
/
browser
/
content
/
tabbrowser
.
xml
"
]
]
;
if
(
gMultiProcessBrowser
)
{
EXPECTED_REFLOWS
.
push
(
[
"
_adjustFocusAfterTabSwitch
chrome
:
/
/
browser
/
content
/
tabbrowser
.
xml
"
]
)
;
}
add_task
(
async
function
(
)
{
await
ensureNoPreloadedBrowser
(
)
;
let
origTab
=
gBrowser
.
selectedTab
;
let
firstSwitchDone
=
BrowserTestUtils
.
waitForEvent
(
window
"
TabSwitchDone
"
)
;
let
otherTab
=
await
BrowserTestUtils
.
openNewForegroundTab
(
gBrowser
)
;
await
firstSwitchDone
;
await
withReflowObserver
(
async
function
(
)
{
let
switchDone
=
BrowserTestUtils
.
waitForEvent
(
window
"
TabSwitchDone
"
)
;
gBrowser
.
selectedTab
=
origTab
;
await
switchDone
;
}
EXPECTED_REFLOWS
window
origTab
)
;
await
BrowserTestUtils
.
removeTab
(
otherTab
)
;
}
)
;
