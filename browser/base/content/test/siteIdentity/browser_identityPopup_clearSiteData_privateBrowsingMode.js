add_task
(
async
function
clearSiteDataHidden
(
)
{
const
TEST_URL
=
"
https
:
/
/
example
.
com
/
"
;
const
winPrivate
=
await
BrowserTestUtils
.
openNewBrowserWindow
(
{
private
:
true
}
)
;
await
BrowserTestUtils
.
withNewTab
(
{
gBrowser
:
winPrivate
.
gBrowser
url
:
TEST_URL
}
async
_browser
=
>
{
let
doc
=
winPrivate
.
document
;
let
{
gIdentityHandler
}
=
winPrivate
;
let
panelShown
=
BrowserTestUtils
.
waitForEvent
(
doc
"
popupshown
"
)
;
gIdentityHandler
.
_identityIconBox
.
click
(
)
;
await
panelShown
;
let
clearFooter
=
doc
.
getElementById
(
"
identity
-
popup
-
clear
-
sitedata
-
footer
"
)
;
let
clearButton
=
doc
.
getElementById
(
"
identity
-
popup
-
clear
-
sitedata
-
button
"
)
;
Assert
.
ok
(
BrowserTestUtils
.
isHidden
(
clearFooter
)
"
The
clear
data
footer
should
be
hidden
in
private
browsing
.
"
)
;
Assert
.
ok
(
BrowserTestUtils
.
isHidden
(
clearButton
)
"
The
clear
data
button
should
be
hidden
in
private
browsing
.
"
)
;
}
)
;
await
BrowserTestUtils
.
closeWindow
(
winPrivate
)
;
}
)
;
