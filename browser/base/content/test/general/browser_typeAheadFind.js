add_task
(
async
function
(
)
{
let
testWindow
=
await
BrowserTestUtils
.
openNewBrowserWindow
(
)
;
testWindow
.
gBrowser
.
selectedTab
.
focus
(
)
;
BrowserTestUtils
.
loadURIString
(
testWindow
.
gBrowser
"
data
:
text
/
html
<
h1
>
A
Page
<
/
h1
>
"
)
;
await
BrowserTestUtils
.
browserLoaded
(
testWindow
.
gBrowser
.
selectedBrowser
)
;
await
SimpleTest
.
promiseFocus
(
testWindow
.
gBrowser
.
selectedBrowser
)
;
ok
(
!
testWindow
.
gFindBarInitialized
"
find
bar
is
not
initialized
"
)
;
let
findBarOpenPromise
=
BrowserTestUtils
.
waitForEvent
(
testWindow
.
gBrowser
"
findbaropen
"
)
;
EventUtils
.
synthesizeKey
(
"
/
"
{
}
testWindow
)
;
await
findBarOpenPromise
;
ok
(
testWindow
.
gFindBarInitialized
"
find
bar
is
now
initialized
"
)
;
await
BrowserTestUtils
.
closeWindow
(
testWindow
)
;
}
)
;
