const
{
PermissionTestUtils
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
testing
-
common
/
PermissionTestUtils
.
sys
.
mjs
"
)
;
add_task
(
async
function
test
(
)
{
let
uriString
=
"
http
:
/
/
example
.
com
/
"
;
let
cookieBehavior
=
"
network
.
cookie
.
cookieBehavior
"
;
await
SpecialPowers
.
pushPrefEnv
(
{
set
:
[
[
cookieBehavior
2
]
]
}
)
;
PermissionTestUtils
.
add
(
uriString
"
cookie
"
Services
.
perms
.
ALLOW_ACTION
)
;
await
BrowserTestUtils
.
withNewTab
(
{
gBrowser
url
:
uriString
}
async
function
(
browser
)
{
await
SpecialPowers
.
spawn
(
browser
[
]
function
(
)
{
is
(
content
.
navigator
.
cookieEnabled
true
"
navigator
.
cookieEnabled
should
be
true
"
)
;
}
)
;
}
)
;
PermissionTestUtils
.
add
(
uriString
"
cookie
"
Services
.
perms
.
UNKNOWN_ACTION
)
;
}
)
;
