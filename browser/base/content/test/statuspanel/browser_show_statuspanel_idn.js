"
use
strict
"
;
ChromeUtils
.
defineESModuleGetters
(
this
{
UrlbarTestUtils
:
"
resource
:
/
/
testing
-
common
/
UrlbarTestUtils
.
sys
.
mjs
"
}
)
;
const
TEST_PAGE_URL
=
encodeURI
(
data
:
text
/
html
;
charset
=
utf
-
8
<
a
id
=
"
foo
"
href
=
"
http
:
/
/
nic
.
xn
-
-
rhqv96g
/
"
>
abc
<
/
a
>
<
span
id
=
"
bar
"
>
def
<
/
span
>
)
;
const
TEST_STATUS_TEXT
=
UrlbarTestUtils
.
trimURL
(
"
http
:
/
/
nic
.
\
u4E16
\
u754C
"
)
;
add_task
(
async
function
test_show_statuspanel_twice
(
)
{
let
tab
=
await
BrowserTestUtils
.
openNewForegroundTab
(
gBrowser
TEST_PAGE_URL
)
;
let
promise
=
promiseStatusPanelShown
(
window
TEST_STATUS_TEXT
)
;
SpecialPowers
.
spawn
(
tab
.
linkedBrowser
[
]
async
(
)
=
>
{
content
.
document
.
links
[
0
]
.
focus
(
)
;
}
)
;
await
promise
;
await
BrowserTestUtils
.
removeTab
(
tab
)
;
}
)
;
