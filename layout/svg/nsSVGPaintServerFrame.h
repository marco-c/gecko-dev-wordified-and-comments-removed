#
ifndef
__NS_SVGPAINTSERVERFRAME_H__
#
define
__NS_SVGPAINTSERVERFRAME_H__
#
include
"
gfxRect
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsFrame
.
h
"
#
include
"
nsIFrame
.
h
"
#
include
"
nsQueryFrame
.
h
"
#
include
"
nsSVGContainerFrame
.
h
"
#
include
"
nsSVGUtils
.
h
"
namespace
mozilla
{
namespace
gfx
{
class
DrawTarget
;
}
}
class
gfxContext
;
class
gfxPattern
;
class
MOZ_RAII
AutoSetRestorePaintServerState
{
public
:
explicit
AutoSetRestorePaintServerState
(
nsIFrame
*
aFrame
MOZ_GUARD_OBJECT_NOTIFIER_PARAM
)
:
mFrame
(
aFrame
)
{
MOZ_GUARD_OBJECT_NOTIFIER_INIT
;
mFrame
-
>
AddStateBits
(
NS_FRAME_DRAWING_AS_PAINTSERVER
)
;
}
~
AutoSetRestorePaintServerState
(
)
{
mFrame
-
>
RemoveStateBits
(
NS_FRAME_DRAWING_AS_PAINTSERVER
)
;
}
private
:
nsIFrame
*
mFrame
;
MOZ_DECL_USE_GUARD_OBJECT_NOTIFIER
}
;
class
nsSVGPaintServerFrame
:
public
nsSVGContainerFrame
{
protected
:
typedef
mozilla
:
:
gfx
:
:
DrawTarget
DrawTarget
;
nsSVGPaintServerFrame
(
ComputedStyle
*
aStyle
nsPresContext
*
aPresContext
ClassID
aID
)
:
nsSVGContainerFrame
(
aStyle
aPresContext
aID
)
{
AddStateBits
(
NS_FRAME_IS_NONDISPLAY
)
;
}
public
:
typedef
mozilla
:
:
image
:
:
imgDrawingParams
imgDrawingParams
;
NS_DECL_ABSTRACT_FRAME
(
nsSVGPaintServerFrame
)
virtual
already_AddRefed
<
gfxPattern
>
GetPaintServerPattern
(
nsIFrame
*
aSource
const
DrawTarget
*
aDrawTarget
const
gfxMatrix
&
aContextMatrix
nsStyleSVGPaint
nsStyleSVG
:
:
*
aFillOrStroke
float
aOpacity
imgDrawingParams
&
aImgParams
const
gfxRect
*
aOverrideBounds
=
nullptr
)
=
0
;
virtual
void
BuildDisplayList
(
nsDisplayListBuilder
*
aBuilder
const
nsDisplayListSet
&
aLists
)
override
{
}
virtual
bool
IsFrameOfType
(
uint32_t
aFlags
)
const
override
{
return
nsSVGContainerFrame
:
:
IsFrameOfType
(
aFlags
&
~
nsIFrame
:
:
eSVGPaintServer
)
;
}
}
;
#
endif
