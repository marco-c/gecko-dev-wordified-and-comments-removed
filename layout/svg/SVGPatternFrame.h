#
ifndef
LAYOUT_SVG_SVGPATTERNFRAME_H_
#
define
LAYOUT_SVG_SVGPATTERNFRAME_H_
#
include
"
gfxMatrix
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
mozilla
/
SVGPaintServerFrame
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
mozilla
/
gfx
/
2D
.
h
"
class
nsIFrame
;
namespace
mozilla
{
class
PresShell
;
class
SVGAnimatedLength
;
class
SVGAnimatedPreserveAspectRatio
;
class
SVGAnimatedTransformList
;
class
SVGAnimatedViewBox
;
class
SVGGeometryFrame
;
}
nsIFrame
*
NS_NewSVGPatternFrame
(
mozilla
:
:
PresShell
*
aPresShell
mozilla
:
:
ComputedStyle
*
aStyle
)
;
namespace
mozilla
{
class
SVGPatternFrame
final
:
public
SVGPaintServerFrame
{
using
SourceSurface
=
gfx
:
:
SourceSurface
;
public
:
NS_DECL_FRAMEARENA_HELPERS
(
SVGPatternFrame
)
NS_DECL_QUERYFRAME
friend
nsIFrame
*
:
:
NS_NewSVGPatternFrame
(
mozilla
:
:
PresShell
*
aPresShell
ComputedStyle
*
aStyle
)
;
explicit
SVGPatternFrame
(
ComputedStyle
*
aStyle
nsPresContext
*
aPresContext
)
;
already_AddRefed
<
gfxPattern
>
GetPaintServerPattern
(
nsIFrame
*
aSource
const
DrawTarget
*
aDrawTarget
const
gfxMatrix
&
aContextMatrix
StyleSVGPaint
nsStyleSVG
:
:
*
aFillOrStroke
float
aGraphicOpacity
imgDrawingParams
&
aImgParams
const
gfxRect
*
aOverrideBounds
)
override
;
public
:
gfxMatrix
GetCanvasTM
(
)
override
;
nsresult
AttributeChanged
(
int32_t
aNameSpaceID
nsAtom
*
aAttribute
int32_t
aModType
)
override
;
#
ifdef
DEBUG
void
Init
(
nsIContent
*
aContent
nsContainerFrame
*
aParent
nsIFrame
*
aPrevInFlow
)
override
;
#
endif
#
ifdef
DEBUG_FRAME_DUMP
nsresult
GetFrameName
(
nsAString
&
aResult
)
const
override
{
return
MakeFrameName
(
u
"
SVGPattern
"
_ns
aResult
)
;
}
#
endif
protected
:
SVGPatternFrame
*
GetReferencedPattern
(
)
;
uint16_t
GetEnumValue
(
uint32_t
aIndex
nsIContent
*
aDefault
)
;
uint16_t
GetEnumValue
(
uint32_t
aIndex
)
{
return
GetEnumValue
(
aIndex
mContent
)
;
}
SVGPatternFrame
*
GetPatternTransformFrame
(
SVGPatternFrame
*
aDefault
)
;
gfxMatrix
GetPatternTransform
(
)
;
const
SVGAnimatedViewBox
&
GetViewBox
(
nsIContent
*
aDefault
)
;
const
SVGAnimatedViewBox
&
GetViewBox
(
)
{
return
GetViewBox
(
mContent
)
;
}
const
SVGAnimatedPreserveAspectRatio
&
GetPreserveAspectRatio
(
nsIContent
*
aDefault
)
;
const
SVGAnimatedPreserveAspectRatio
&
GetPreserveAspectRatio
(
)
{
return
GetPreserveAspectRatio
(
mContent
)
;
}
const
SVGAnimatedLength
*
GetLengthValue
(
uint32_t
aIndex
nsIContent
*
aDefault
)
;
const
SVGAnimatedLength
*
GetLengthValue
(
uint32_t
aIndex
)
{
return
GetLengthValue
(
aIndex
mContent
)
;
}
void
PaintChildren
(
DrawTarget
*
aDrawTarget
SVGPatternFrame
*
aPatternWithChildren
nsIFrame
*
aSource
float
aGraphicOpacity
imgDrawingParams
&
aImgParams
)
;
already_AddRefed
<
SourceSurface
>
PaintPattern
(
const
DrawTarget
*
aDrawTarget
Matrix
*
patternMatrix
const
Matrix
&
aContextMatrix
nsIFrame
*
aSource
StyleSVGPaint
nsStyleSVG
:
:
*
aFillOrStroke
float
aGraphicOpacity
const
gfxRect
*
aOverrideBounds
imgDrawingParams
&
aImgParams
)
;
SVGPatternFrame
*
GetPatternWithChildren
(
)
;
gfxRect
GetPatternRect
(
uint16_t
aPatternUnits
const
gfxRect
&
bbox
const
Matrix
&
aTargetCTM
nsIFrame
*
aTarget
)
;
gfxMatrix
ConstructCTM
(
const
SVGAnimatedViewBox
&
aViewBox
uint16_t
aPatternContentUnits
uint16_t
aPatternUnits
const
gfxRect
&
callerBBox
const
Matrix
&
callerCTM
nsIFrame
*
aTarget
)
;
private
:
SVGGeometryFrame
*
mSource
;
UniquePtr
<
gfxMatrix
>
mCTM
;
protected
:
bool
mLoopFlag
;
bool
mNoHRefURI
;
}
;
}
#
endif
