#
ifndef
LAYOUT_SVG_SVGPAINTSERVERFRAME_H_
#
define
LAYOUT_SVG_SVGPAINTSERVERFRAME_H_
#
include
"
gfxRect
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
SVGContainerFrame
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIFrame
.
h
"
#
include
"
nsIFrame
.
h
"
#
include
"
nsQueryFrame
.
h
"
class
gfxContext
;
class
gfxPattern
;
namespace
mozilla
{
namespace
gfx
{
class
DrawTarget
;
}
class
MOZ_RAII
AutoSetRestorePaintServerState
{
public
:
explicit
AutoSetRestorePaintServerState
(
nsIFrame
*
aFrame
MOZ_GUARD_OBJECT_NOTIFIER_PARAM
)
:
mFrame
(
aFrame
)
{
MOZ_GUARD_OBJECT_NOTIFIER_INIT
;
mFrame
-
>
AddStateBits
(
NS_FRAME_DRAWING_AS_PAINTSERVER
)
;
}
~
AutoSetRestorePaintServerState
(
)
{
mFrame
-
>
RemoveStateBits
(
NS_FRAME_DRAWING_AS_PAINTSERVER
)
;
}
private
:
nsIFrame
*
mFrame
;
MOZ_DECL_USE_GUARD_OBJECT_NOTIFIER
}
;
class
SVGPaintServerFrame
:
public
SVGContainerFrame
{
protected
:
using
DrawTarget
=
gfx
:
:
DrawTarget
;
SVGPaintServerFrame
(
ComputedStyle
*
aStyle
nsPresContext
*
aPresContext
ClassID
aID
)
:
SVGContainerFrame
(
aStyle
aPresContext
aID
)
{
AddStateBits
(
NS_FRAME_IS_NONDISPLAY
)
;
}
public
:
using
imgDrawingParams
=
image
:
:
imgDrawingParams
;
NS_DECL_ABSTRACT_FRAME
(
SVGPaintServerFrame
)
virtual
already_AddRefed
<
gfxPattern
>
GetPaintServerPattern
(
nsIFrame
*
aSource
const
DrawTarget
*
aDrawTarget
const
gfxMatrix
&
aContextMatrix
StyleSVGPaint
nsStyleSVG
:
:
*
aFillOrStroke
float
aOpacity
imgDrawingParams
&
aImgParams
const
gfxRect
*
aOverrideBounds
=
nullptr
)
=
0
;
virtual
void
BuildDisplayList
(
nsDisplayListBuilder
*
aBuilder
const
nsDisplayListSet
&
aLists
)
override
{
}
virtual
bool
IsFrameOfType
(
uint32_t
aFlags
)
const
override
{
return
SVGContainerFrame
:
:
IsFrameOfType
(
aFlags
&
~
nsIFrame
:
:
eSVGPaintServer
)
;
}
}
;
}
#
endif
