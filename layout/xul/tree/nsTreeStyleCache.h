#
ifndef
nsTreeStyleCache_h__
#
define
nsTreeStyleCache_h__
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
nsAutoPtr
.
h
"
#
include
"
nsAtom
.
h
"
#
include
"
nsCOMArray
.
h
"
#
include
"
nsICSSPseudoComparator
.
h
"
#
include
"
nsRefPtrHashtable
.
h
"
#
include
"
nsStyleContext
.
h
"
typedef
nsTArray
<
RefPtr
<
nsAtom
>
>
AtomArray
;
class
nsTreeStyleCache
{
public
:
nsTreeStyleCache
(
)
:
mNextState
(
0
)
{
}
~
nsTreeStyleCache
(
)
{
Clear
(
)
;
}
void
Clear
(
)
{
mTransitionTable
=
nullptr
;
mCache
=
nullptr
;
mNextState
=
0
;
}
nsStyleContext
*
GetStyleContext
(
nsICSSPseudoComparator
*
aComparator
nsPresContext
*
aPresContext
nsIContent
*
aContent
nsStyleContext
*
aContext
nsICSSAnonBoxPseudo
*
aPseudoElement
const
AtomArray
&
aInputWord
)
;
protected
:
typedef
uint32_t
DFAState
;
class
Transition
final
{
public
:
Transition
(
DFAState
aState
nsAtom
*
aSymbol
)
;
bool
operator
=
=
(
const
Transition
&
aOther
)
const
;
uint32_t
Hash
(
)
const
;
private
:
DFAState
mState
;
RefPtr
<
nsAtom
>
mInputSymbol
;
}
;
typedef
nsDataHashtable
<
nsGenericHashKey
<
Transition
>
DFAState
>
TransitionTable
;
nsAutoPtr
<
TransitionTable
>
mTransitionTable
;
typedef
nsRefPtrHashtable
<
nsUint32HashKey
nsStyleContext
>
StyleContextCache
;
nsAutoPtr
<
StyleContextCache
>
mCache
;
DFAState
mNextState
;
}
;
#
endif
