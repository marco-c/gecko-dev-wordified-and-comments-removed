add_task
(
function
*
test
(
)
{
let
testTab
=
yield
BrowserTestUtils
.
openNewForegroundTab
(
gBrowser
"
about
:
addons
"
)
;
yield
ContentTask
.
spawn
(
gBrowser
.
selectedBrowser
null
function
*
(
)
{
let
doc
=
content
.
document
;
let
e
=
doc
.
createElement
(
"
button
"
)
;
e
.
setAttribute
(
"
label
"
"
hello
"
)
;
e
.
setAttribute
(
"
tooltiptext
"
"
world
"
)
;
e
.
setAttribute
(
"
id
"
"
test
-
button
"
)
;
doc
.
documentElement
.
insertBefore
(
e
doc
.
documentElement
.
firstChild
)
;
}
)
;
let
tab2
=
yield
BrowserTestUtils
.
openNewForegroundTab
(
gBrowser
"
about
:
blank
"
true
)
;
gBrowser
.
selectedTab
=
tab2
;
gBrowser
.
selectedTab
=
testTab
;
let
browser
=
gBrowser
.
selectedBrowser
;
EventUtils
.
disableNonTestMouseEvents
(
true
)
;
try
{
yield
BrowserTestUtils
.
synthesizeMouse
(
"
#
test
-
button
"
1
1
{
type
:
"
mouseover
"
}
browser
)
;
yield
BrowserTestUtils
.
synthesizeMouse
(
"
#
test
-
button
"
2
6
{
type
:
"
mousemove
"
}
browser
)
;
yield
BrowserTestUtils
.
synthesizeMouse
(
"
#
test
-
button
"
2
4
{
type
:
"
mousemove
"
}
browser
)
;
}
finally
{
EventUtils
.
disableNonTestMouseEvents
(
false
)
;
}
yield
BrowserTestUtils
.
removeTab
(
testTab
)
;
yield
BrowserTestUtils
.
removeTab
(
tab2
)
;
ok
(
true
"
pass
if
no
assertions
"
)
;
}
)
;
