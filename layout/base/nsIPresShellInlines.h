#
ifndef
nsIPresShellInlines_h
#
define
nsIPresShellInlines_h
#
include
"
mozilla
/
PresShell
.
h
"
#
include
"
mozilla
/
dom
/
Document
.
h
"
#
include
"
mozilla
/
dom
/
Element
.
h
"
void
nsIPresShell
:
:
SetNeedLayoutFlush
(
)
{
mNeedLayoutFlush
=
true
;
if
(
mozilla
:
:
dom
:
:
Document
*
doc
=
mDocument
-
>
GetDisplayDocument
(
)
)
{
if
(
mozilla
:
:
PresShell
*
shell
=
doc
-
>
GetPresShell
(
)
)
{
shell
-
>
mNeedLayoutFlush
=
true
;
}
}
#
ifdef
MOZ_GECKO_PROFILER
if
(
!
mReflowCause
)
{
mReflowCause
=
profiler_get_backtrace
(
)
;
}
#
endif
}
void
nsIPresShell
:
:
SetNeedStyleFlush
(
)
{
mNeedStyleFlush
=
true
;
if
(
mozilla
:
:
dom
:
:
Document
*
doc
=
mDocument
-
>
GetDisplayDocument
(
)
)
{
if
(
mozilla
:
:
PresShell
*
presShell
=
doc
-
>
GetPresShell
(
)
)
{
presShell
-
>
mNeedStyleFlush
=
true
;
}
}
#
ifdef
MOZ_GECKO_PROFILER
if
(
!
mStyleCause
)
{
mStyleCause
=
profiler_get_backtrace
(
)
;
}
#
endif
}
void
nsIPresShell
:
:
EnsureStyleFlush
(
)
{
SetNeedStyleFlush
(
)
;
ObserveStyleFlushes
(
)
;
}
void
nsIPresShell
:
:
SetNeedThrottledAnimationFlush
(
)
{
mNeedThrottledAnimationFlush
=
true
;
if
(
mozilla
:
:
dom
:
:
Document
*
doc
=
mDocument
-
>
GetDisplayDocument
(
)
)
{
if
(
mozilla
:
:
PresShell
*
presShell
=
doc
-
>
GetPresShell
(
)
)
{
presShell
-
>
mNeedThrottledAnimationFlush
=
true
;
}
}
}
mozilla
:
:
ServoStyleSet
*
nsIPresShell
:
:
StyleSet
(
)
const
{
return
mDocument
-
>
StyleSetForPresShellOrMediaQueryEvaluation
(
)
;
}
namespace
mozilla
{
inline
void
PresShell
:
:
EventHandler
:
:
OnPresShellDestroy
(
Document
*
aDocument
)
{
if
(
sLastKeyDownEventTargetElement
&
&
sLastKeyDownEventTargetElement
-
>
OwnerDoc
(
)
=
=
aDocument
)
{
sLastKeyDownEventTargetElement
=
nullptr
;
}
}
}
#
endif
