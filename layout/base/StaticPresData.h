#
ifndef
mozilla_StaticPresData_h
#
define
mozilla_StaticPresData_h
#
include
"
nsAutoPtr
.
h
"
#
include
"
nsCoord
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsFont
.
h
"
#
include
"
nsIAtom
.
h
"
#
include
"
nsLanguageAtomService
.
h
"
namespace
mozilla
{
struct
LangGroupFontPrefs
{
LangGroupFontPrefs
(
)
:
mLangGroup
(
nullptr
)
mMinimumFontSize
(
0
)
mDefaultVariableFont
(
)
mDefaultFixedFont
(
mozilla
:
:
eFamily_monospace
0
)
mDefaultSerifFont
(
mozilla
:
:
eFamily_serif
0
)
mDefaultSansSerifFont
(
mozilla
:
:
eFamily_sans_serif
0
)
mDefaultMonospaceFont
(
mozilla
:
:
eFamily_monospace
0
)
mDefaultCursiveFont
(
mozilla
:
:
eFamily_cursive
0
)
mDefaultFantasyFont
(
mozilla
:
:
eFamily_fantasy
0
)
{
mDefaultVariableFont
.
fontlist
.
SetDefaultFontType
(
mozilla
:
:
eFamily_serif
)
;
}
void
Reset
(
)
{
mNext
=
nullptr
;
mLangGroup
=
nullptr
;
}
size_t
SizeOfExcludingThis
(
mozilla
:
:
MallocSizeOf
aMallocSizeOf
)
const
{
size_t
n
=
0
;
LangGroupFontPrefs
*
curr
=
mNext
;
while
(
curr
)
{
n
+
=
aMallocSizeOf
(
curr
)
;
curr
=
curr
-
>
mNext
;
}
return
n
;
}
void
Initialize
(
nsIAtom
*
aLangGroupAtom
)
;
nsCOMPtr
<
nsIAtom
>
mLangGroup
;
nscoord
mMinimumFontSize
;
nsFont
mDefaultVariableFont
;
nsFont
mDefaultFixedFont
;
nsFont
mDefaultSerifFont
;
nsFont
mDefaultSansSerifFont
;
nsFont
mDefaultMonospaceFont
;
nsFont
mDefaultCursiveFont
;
nsFont
mDefaultFantasyFont
;
nsAutoPtr
<
LangGroupFontPrefs
>
mNext
;
}
;
class
StaticPresData
{
public
:
static
void
Init
(
)
;
static
void
Shutdown
(
)
;
static
StaticPresData
*
Get
(
)
;
const
nscoord
*
GetBorderWidthTable
(
)
{
return
mBorderWidthTable
;
}
nsIAtom
*
GetLangGroup
(
nsIAtom
*
aLanguage
bool
*
aNeedsToCache
=
nullptr
)
const
;
already_AddRefed
<
nsIAtom
>
GetUncachedLangGroup
(
nsIAtom
*
aLanguage
)
const
;
const
LangGroupFontPrefs
*
GetFontPrefsForLangHelper
(
nsIAtom
*
aLanguage
const
LangGroupFontPrefs
*
aPrefs
bool
*
aNeedsToCache
=
nullptr
)
const
;
const
nsFont
*
GetDefaultFontHelper
(
uint8_t
aFontID
nsIAtom
*
aLanguage
const
LangGroupFontPrefs
*
aPrefs
)
const
;
const
nsFont
*
GetDefaultFont
(
uint8_t
aFontID
nsIAtom
*
aLanguage
)
const
{
MOZ_ASSERT
(
aLanguage
)
;
return
GetDefaultFontHelper
(
aFontID
aLanguage
GetFontPrefsForLang
(
aLanguage
)
)
;
}
const
LangGroupFontPrefs
*
GetFontPrefsForLang
(
nsIAtom
*
aLanguage
bool
*
aNeedsToCache
=
nullptr
)
const
{
MOZ_ASSERT
(
aLanguage
)
;
return
GetFontPrefsForLangHelper
(
aLanguage
&
mStaticLangGroupFontPrefs
aNeedsToCache
)
;
}
void
ResetCachedFontPrefs
(
)
{
mStaticLangGroupFontPrefs
.
Reset
(
)
;
}
private
:
StaticPresData
(
)
;
~
StaticPresData
(
)
{
}
nsLanguageAtomService
*
mLangService
;
nscoord
mBorderWidthTable
[
3
]
;
LangGroupFontPrefs
mStaticLangGroupFontPrefs
;
}
;
}
#
endif
