#
ifndef
mozilla_StaticPresData_h
#
define
mozilla_StaticPresData_h
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
nsCoord
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsFont
.
h
"
#
include
"
nsAtom
.
h
"
#
include
"
nsLanguageAtomService
.
h
"
namespace
mozilla
{
struct
LangGroupFontPrefs
{
LangGroupFontPrefs
(
)
:
mLangGroup
(
nullptr
)
mMinimumFontSize
(
0
)
mDefaultVariableFont
(
)
mDefaultSerifFont
(
StyleGenericFontFamily
:
:
Serif
0
)
mDefaultSansSerifFont
(
StyleGenericFontFamily
:
:
SansSerif
0
)
mDefaultMonospaceFont
(
StyleGenericFontFamily
:
:
Monospace
0
)
mDefaultCursiveFont
(
StyleGenericFontFamily
:
:
Cursive
0
)
mDefaultFantasyFont
(
StyleGenericFontFamily
:
:
Fantasy
0
)
{
mDefaultVariableFont
.
fontlist
.
SetDefaultFontType
(
StyleGenericFontFamily
:
:
Serif
)
;
}
void
Reset
(
)
{
mNext
=
nullptr
;
mLangGroup
=
nullptr
;
}
size_t
SizeOfExcludingThis
(
mozilla
:
:
MallocSizeOf
aMallocSizeOf
)
const
{
size_t
n
=
0
;
LangGroupFontPrefs
*
curr
=
mNext
.
get
(
)
;
while
(
curr
)
{
n
+
=
aMallocSizeOf
(
curr
)
;
curr
=
curr
-
>
mNext
.
get
(
)
;
}
return
n
;
}
void
Initialize
(
nsStaticAtom
*
aLangGroupAtom
)
;
const
nsFont
*
GetDefaultFont
(
StyleGenericFontFamily
aFamily
)
const
{
switch
(
aFamily
)
{
case
StyleGenericFontFamily
:
:
None
:
return
&
mDefaultVariableFont
;
case
StyleGenericFontFamily
:
:
Serif
:
return
&
mDefaultSerifFont
;
case
StyleGenericFontFamily
:
:
SansSerif
:
return
&
mDefaultSansSerifFont
;
case
StyleGenericFontFamily
:
:
Monospace
:
return
&
mDefaultMonospaceFont
;
case
StyleGenericFontFamily
:
:
Cursive
:
return
&
mDefaultCursiveFont
;
case
StyleGenericFontFamily
:
:
Fantasy
:
return
&
mDefaultFantasyFont
;
break
;
default
:
MOZ_ASSERT_UNREACHABLE
(
"
invalid
font
id
"
)
;
return
nullptr
;
}
}
nsStaticAtom
*
mLangGroup
;
nscoord
mMinimumFontSize
;
nsFont
mDefaultVariableFont
;
nsFont
mDefaultSerifFont
;
nsFont
mDefaultSansSerifFont
;
nsFont
mDefaultMonospaceFont
;
nsFont
mDefaultCursiveFont
;
nsFont
mDefaultFantasyFont
;
mozilla
:
:
UniquePtr
<
LangGroupFontPrefs
>
mNext
;
}
;
class
StaticPresData
{
public
:
static
void
Init
(
)
;
static
void
Shutdown
(
)
;
static
StaticPresData
*
Get
(
)
;
nsStaticAtom
*
GetLangGroup
(
nsAtom
*
aLanguage
bool
*
aNeedsToCache
=
nullptr
)
const
;
nsStaticAtom
*
GetUncachedLangGroup
(
nsAtom
*
aLanguage
)
const
;
const
LangGroupFontPrefs
*
GetFontPrefsForLang
(
nsAtom
*
aLanguage
bool
*
aNeedsToCache
=
nullptr
)
;
const
nsFont
*
GetDefaultFont
(
uint8_t
aFontID
nsAtom
*
aLanguage
const
LangGroupFontPrefs
*
aPrefs
)
const
;
void
InvalidateFontPrefs
(
)
{
mLangGroupFontPrefs
.
Reset
(
)
;
}
private
:
StaticPresData
(
)
;
~
StaticPresData
(
)
=
default
;
nsLanguageAtomService
*
mLangService
;
LangGroupFontPrefs
mLangGroupFontPrefs
;
}
;
}
#
endif
