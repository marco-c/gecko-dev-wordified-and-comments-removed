#
ifndef
nsPageFrame_h___
#
define
nsPageFrame_h___
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
nsContainerFrame
.
h
"
#
include
"
nsLeafFrame
.
h
"
class
nsFontMetrics
;
class
nsSharedPageData
;
namespace
mozilla
{
class
PresShell
;
}
class
nsPageFrame
final
:
public
nsContainerFrame
{
public
:
NS_DECL_QUERYFRAME
NS_DECL_FRAMEARENA_HELPERS
(
nsPageFrame
)
friend
nsPageFrame
*
NS_NewPageFrame
(
mozilla
:
:
PresShell
*
aPresShell
ComputedStyle
*
aStyle
)
;
void
Reflow
(
nsPresContext
*
aPresContext
ReflowOutput
&
aReflowOutput
const
ReflowInput
&
aReflowInput
nsReflowStatus
&
aStatus
)
override
;
void
BuildDisplayList
(
nsDisplayListBuilder
*
aBuilder
const
nsDisplayListSet
&
aLists
)
override
;
#
ifdef
DEBUG_FRAME_DUMP
nsresult
GetFrameName
(
nsAString
&
aResult
)
const
override
;
#
endif
void
DeterminePageNum
(
)
;
int32_t
GetPageNum
(
)
const
{
return
mPageNum
;
}
void
SetSharedPageData
(
nsSharedPageData
*
aPD
)
;
nsSharedPageData
*
GetSharedPageData
(
)
const
{
return
mPD
;
}
bool
HonorPrintBackgroundSettings
(
)
const
override
{
return
false
;
}
void
PaintHeaderFooter
(
gfxContext
&
aRenderingContext
nsPoint
aPt
bool
aSubpixelAA
)
;
void
AppendDirectlyOwnedAnonBoxes
(
nsTArray
<
OwnedAnonBox
>
&
aResult
)
override
;
protected
:
explicit
nsPageFrame
(
ComputedStyle
*
aStyle
nsPresContext
*
aPresContext
)
;
virtual
~
nsPageFrame
(
)
;
typedef
enum
{
eHeader
eFooter
}
nsHeaderFooterEnum
;
nscoord
GetXPosition
(
gfxContext
&
aRenderingContext
nsFontMetrics
&
aFontMetrics
const
nsRect
&
aRect
int32_t
aJust
const
nsString
&
aStr
)
;
nsReflowStatus
ReflowPageContent
(
nsPresContext
*
const
ReflowInput
&
aPageReflowInput
)
;
void
DrawHeaderFooter
(
gfxContext
&
aRenderingContext
nsFontMetrics
&
aFontMetrics
nsHeaderFooterEnum
aHeaderFooter
int32_t
aJust
const
nsString
&
sStr
const
nsRect
&
aRect
nscoord
aHeight
nscoord
aAscent
nscoord
aWidth
)
;
void
DrawHeaderFooter
(
gfxContext
&
aRenderingContext
nsFontMetrics
&
aFontMetrics
nsHeaderFooterEnum
aHeaderFooter
const
nsString
&
aStrLeft
const
nsString
&
aStrRight
const
nsString
&
aStrCenter
const
nsRect
&
aRect
nscoord
aAscent
nscoord
aHeight
)
;
void
ProcessSpecialCodes
(
const
nsString
&
aStr
nsString
&
aNewStr
)
;
static
constexpr
int32_t
kPageNumUnset
=
-
1
;
int32_t
mPageNum
=
kPageNumUnset
;
nsSharedPageData
*
mPD
=
nullptr
;
nsMargin
mPageContentMargin
;
}
;
class
nsPageBreakFrame
final
:
public
nsLeafFrame
{
NS_DECL_FRAMEARENA_HELPERS
(
nsPageBreakFrame
)
explicit
nsPageBreakFrame
(
ComputedStyle
*
aStyle
nsPresContext
*
aPresContext
)
;
~
nsPageBreakFrame
(
)
;
void
Reflow
(
nsPresContext
*
aPresContext
ReflowOutput
&
aReflowOutput
const
ReflowInput
&
aReflowInput
nsReflowStatus
&
aStatus
)
override
;
#
ifdef
DEBUG_FRAME_DUMP
nsresult
GetFrameName
(
nsAString
&
aResult
)
const
override
;
#
endif
protected
:
nscoord
GetIntrinsicISize
(
)
override
;
nscoord
GetIntrinsicBSize
(
)
override
;
bool
mHaveReflowed
;
friend
nsIFrame
*
NS_NewPageBreakFrame
(
mozilla
:
:
PresShell
*
aPresShell
ComputedStyle
*
aStyle
)
;
}
;
#
endif
