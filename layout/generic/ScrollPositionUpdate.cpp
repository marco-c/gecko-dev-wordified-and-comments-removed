#
include
"
ScrollPositionUpdate
.
h
"
#
include
"
mozilla
/
Assertions
.
h
"
namespace
mozilla
{
ScrollPositionUpdate
:
:
ScrollPositionUpdate
(
)
:
mScrollGeneration
(
0
)
mType
(
ScrollUpdateType
:
:
Absolute
)
mScrollMode
(
ScrollMode
:
:
Normal
)
mScrollOrigin
(
ScrollOrigin
:
:
None
)
{
}
ScrollPositionUpdate
ScrollPositionUpdate
:
:
NewScrollframe
(
uint32_t
aGeneration
)
{
ScrollPositionUpdate
ret
;
ret
.
mScrollGeneration
=
aGeneration
;
ret
.
mScrollMode
=
ScrollMode
:
:
Instant
;
return
ret
;
}
ScrollPositionUpdate
ScrollPositionUpdate
:
:
NewScroll
(
uint32_t
aGeneration
ScrollOrigin
aOrigin
nsPoint
aDestination
)
{
MOZ_ASSERT
(
aOrigin
!
=
ScrollOrigin
:
:
NotSpecified
)
;
MOZ_ASSERT
(
aOrigin
!
=
ScrollOrigin
:
:
None
)
;
ScrollPositionUpdate
ret
;
ret
.
mScrollGeneration
=
aGeneration
;
ret
.
mType
=
ScrollUpdateType
:
:
Absolute
;
ret
.
mScrollMode
=
ScrollMode
:
:
Instant
;
ret
.
mScrollOrigin
=
aOrigin
;
ret
.
mDestination
=
CSSPoint
:
:
FromAppUnits
(
aDestination
)
;
return
ret
;
}
ScrollPositionUpdate
ScrollPositionUpdate
:
:
NewRelativeScroll
(
uint32_t
aGeneration
nsPoint
aSource
nsPoint
aDestination
)
{
ScrollPositionUpdate
ret
;
ret
.
mScrollGeneration
=
aGeneration
;
ret
.
mType
=
ScrollUpdateType
:
:
Relative
;
ret
.
mScrollMode
=
ScrollMode
:
:
Instant
;
ret
.
mScrollOrigin
=
ScrollOrigin
:
:
Relative
;
ret
.
mDestination
=
CSSPoint
:
:
FromAppUnits
(
aDestination
)
;
ret
.
mSource
=
CSSPoint
:
:
FromAppUnits
(
aSource
)
;
return
ret
;
}
ScrollPositionUpdate
ScrollPositionUpdate
:
:
NewSmoothScroll
(
uint32_t
aGeneration
ScrollOrigin
aOrigin
nsPoint
aDestination
)
{
MOZ_ASSERT
(
aOrigin
!
=
ScrollOrigin
:
:
NotSpecified
)
;
MOZ_ASSERT
(
aOrigin
!
=
ScrollOrigin
:
:
None
)
;
ScrollPositionUpdate
ret
;
ret
.
mScrollGeneration
=
aGeneration
;
ret
.
mType
=
ScrollUpdateType
:
:
Absolute
;
ret
.
mScrollMode
=
ScrollMode
:
:
SmoothMsd
;
ret
.
mScrollOrigin
=
aOrigin
;
ret
.
mDestination
=
CSSPoint
:
:
FromAppUnits
(
aDestination
)
;
return
ret
;
}
ScrollPositionUpdate
ScrollPositionUpdate
:
:
NewPureRelativeScroll
(
uint32_t
aGeneration
ScrollOrigin
aOrigin
ScrollMode
aMode
const
nsPoint
&
aDelta
)
{
MOZ_ASSERT
(
aOrigin
!
=
ScrollOrigin
:
:
NotSpecified
)
;
MOZ_ASSERT
(
aOrigin
!
=
ScrollOrigin
:
:
None
)
;
ScrollPositionUpdate
ret
;
ret
.
mScrollGeneration
=
aGeneration
;
ret
.
mType
=
ScrollUpdateType
:
:
PureRelative
;
ret
.
mScrollMode
=
aMode
;
ret
.
mScrollOrigin
=
aOrigin
;
ret
.
mDelta
=
CSSPoint
:
:
FromAppUnits
(
aDelta
)
;
return
ret
;
}
bool
ScrollPositionUpdate
:
:
operator
=
=
(
const
ScrollPositionUpdate
&
aOther
)
const
{
return
mScrollGeneration
=
=
aOther
.
mScrollGeneration
;
}
uint32_t
ScrollPositionUpdate
:
:
GetGeneration
(
)
const
{
return
mScrollGeneration
;
}
ScrollUpdateType
ScrollPositionUpdate
:
:
GetType
(
)
const
{
return
mType
;
}
ScrollMode
ScrollPositionUpdate
:
:
GetMode
(
)
const
{
return
mScrollMode
;
}
ScrollOrigin
ScrollPositionUpdate
:
:
GetOrigin
(
)
const
{
return
mScrollOrigin
;
}
CSSPoint
ScrollPositionUpdate
:
:
GetDestination
(
)
const
{
MOZ_ASSERT
(
mType
=
=
ScrollUpdateType
:
:
Absolute
|
|
mType
=
=
ScrollUpdateType
:
:
Relative
)
;
return
mDestination
;
}
CSSPoint
ScrollPositionUpdate
:
:
GetSource
(
)
const
{
MOZ_ASSERT
(
mType
=
=
ScrollUpdateType
:
:
Relative
)
;
return
mSource
;
}
CSSPoint
ScrollPositionUpdate
:
:
GetDelta
(
)
const
{
MOZ_ASSERT
(
mType
=
=
ScrollUpdateType
:
:
PureRelative
)
;
return
mDelta
;
}
void
ScrollPositionUpdate
:
:
AppendToString
(
std
:
:
stringstream
&
aStream
)
const
{
aStream
<
<
"
ScrollPositionUpdate
(
gen
=
"
<
<
mScrollGeneration
<
<
"
type
=
"
<
<
(
int
)
mType
<
<
"
mode
=
"
<
<
(
int
)
mScrollMode
<
<
"
origin
=
"
<
<
(
int
)
mScrollOrigin
<
<
"
dst
=
"
<
<
mDestination
.
x
<
<
"
"
<
<
mDestination
.
y
<
<
"
src
=
"
<
<
mSource
.
x
<
<
"
"
<
<
mSource
.
y
<
<
"
delta
=
"
<
<
mDelta
.
x
<
<
"
"
<
<
mDelta
.
y
<
<
"
)
"
;
}
}
