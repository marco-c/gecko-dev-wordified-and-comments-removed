from
__future__
import
absolute_import
print_function
import
mozunit
import
pytest
pytest
.
fixture
def
parse
(
normalize
)
:
    
reftest
=
pytest
.
importorskip
(
"
reftest
"
)
    
def
inner
(
path
)
:
        
mp
=
reftest
.
ReftestManifest
(
)
        
mp
.
load
(
normalize
(
path
)
)
        
return
mp
    
return
inner
def
test_parse_defaults
(
parse
)
:
    
mp
=
parse
(
'
defaults
.
list
'
)
    
assert
len
(
mp
.
tests
)
=
=
4
    
for
test
in
mp
.
tests
:
        
if
test
[
'
name
'
]
.
startswith
(
'
foo
'
)
:
            
assert
test
[
'
pref
'
]
=
=
"
foo
.
bar
true
"
        
else
:
            
assert
'
pref
'
not
in
test
    
with
pytest
.
raises
(
ValueError
)
:
        
parse
(
'
invalid
-
defaults
.
list
'
)
if
__name__
=
=
'
__main__
'
:
    
mozunit
.
main
(
)
