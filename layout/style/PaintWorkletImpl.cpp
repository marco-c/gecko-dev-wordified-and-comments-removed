#
include
"
PaintWorkletImpl
.
h
"
#
include
"
PaintWorkletGlobalScope
.
h
"
#
include
"
mozilla
/
dom
/
Worklet
.
h
"
#
include
"
mozilla
/
dom
/
WorkletThread
.
h
"
namespace
mozilla
{
already_AddRefed
<
dom
:
:
Worklet
>
PaintWorkletImpl
:
:
CreateWorklet
(
nsPIDOMWindowInner
*
aWindow
nsIPrincipal
*
aPrincipal
)
{
MOZ_ASSERT
(
NS_IsMainThread
(
)
)
;
RefPtr
<
PaintWorkletImpl
>
impl
=
new
PaintWorkletImpl
(
aWindow
aPrincipal
)
;
return
MakeAndAddRef
<
dom
:
:
Worklet
>
(
aWindow
std
:
:
move
(
impl
)
)
;
}
PaintWorkletImpl
:
:
PaintWorkletImpl
(
nsPIDOMWindowInner
*
aWindow
nsIPrincipal
*
aPrincipal
)
:
WorkletImpl
(
aWindow
aPrincipal
)
{
#
ifdef
RELEASE_OR_BETA
MOZ_CRASH
(
"
This
code
should
not
go
to
release
/
beta
yet
!
"
)
;
#
endif
}
PaintWorkletImpl
:
:
~
PaintWorkletImpl
(
)
=
default
;
already_AddRefed
<
dom
:
:
WorkletGlobalScope
>
PaintWorkletImpl
:
:
ConstructGlobalScope
(
)
{
dom
:
:
WorkletThread
:
:
AssertIsOnWorkletThread
(
)
;
return
MakeAndAddRef
<
dom
:
:
PaintWorkletGlobalScope
>
(
this
)
;
}
}
