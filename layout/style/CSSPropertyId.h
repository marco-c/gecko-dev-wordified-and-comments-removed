#
ifndef
mozilla_CSSPropertyId_h
#
define
mozilla_CSSPropertyId_h
#
include
"
NonCustomCSSPropertyId
.
h
"
#
include
"
mozilla
/
HashFunctions
.
h
"
#
include
"
mozilla
/
ServoBindings
.
h
"
#
include
"
nsCSSProps
.
h
"
#
include
"
nsString
.
h
"
namespace
mozilla
{
struct
CSSPropertyId
{
explicit
CSSPropertyId
(
NonCustomCSSPropertyId
aProperty
)
:
mId
(
aProperty
)
{
MOZ_ASSERT
(
aProperty
!
=
eCSSPropertyExtra_variable
"
Cannot
create
an
CSSPropertyId
from
only
a
"
"
eCSSPropertyExtra_variable
.
"
)
;
}
explicit
CSSPropertyId
(
RefPtr
<
nsAtom
>
aCustomName
)
:
mId
(
eCSSPropertyExtra_variable
)
mCustomName
(
std
:
:
move
(
aCustomName
)
)
{
MOZ_ASSERT
(
mCustomName
"
Null
custom
property
name
"
)
;
}
NonCustomCSSPropertyId
mId
=
eCSSProperty_UNKNOWN
;
RefPtr
<
nsAtom
>
mCustomName
;
bool
IsCustom
(
)
const
{
return
mId
=
=
eCSSPropertyExtra_variable
;
}
bool
operator
=
=
(
const
CSSPropertyId
&
aOther
)
const
{
return
mId
=
=
aOther
.
mId
&
&
mCustomName
=
=
aOther
.
mCustomName
;
}
bool
operator
!
=
(
const
CSSPropertyId
&
aOther
)
const
{
return
!
(
*
this
=
=
aOther
)
;
}
bool
IsValid
(
)
const
{
if
(
mId
=
=
eCSSProperty_UNKNOWN
)
{
return
false
;
}
return
IsCustom
(
)
=
=
!
!
mCustomName
;
}
void
ToString
(
nsACString
&
aString
)
const
{
if
(
IsCustom
(
)
)
{
MOZ_ASSERT
(
mCustomName
"
Custom
property
should
have
a
name
"
)
;
aString
.
AssignLiteral
(
"
-
-
"
)
;
AppendUTF16toUTF8
(
nsDependentAtomString
(
mCustomName
)
aString
)
;
}
else
{
aString
.
Assign
(
nsCSSProps
:
:
GetStringValue
(
mId
)
)
;
}
}
void
ToString
(
nsAString
&
aString
)
const
{
if
(
IsCustom
(
)
)
{
MOZ_ASSERT
(
mCustomName
"
Custom
property
should
have
a
name
"
)
;
aString
.
AssignLiteral
(
"
-
-
"
)
;
aString
.
Append
(
nsDependentAtomString
(
mCustomName
)
)
;
}
else
{
aString
.
Assign
(
NS_ConvertUTF8toUTF16
(
nsCSSProps
:
:
GetStringValue
(
mId
)
)
)
;
}
}
HashNumber
Hash
(
)
const
{
HashNumber
hash
=
mCustomName
?
mCustomName
-
>
hash
(
)
:
0
;
return
AddToHash
(
hash
mId
)
;
}
CSSPropertyId
ToPhysical
(
const
ComputedStyle
&
aStyle
)
const
{
if
(
IsCustom
(
)
)
{
return
*
this
;
}
return
CSSPropertyId
{
nsCSSProps
:
:
Physicalize
(
mId
aStyle
)
}
;
}
}
;
inline
std
:
:
ostream
&
operator
<
<
(
std
:
:
ostream
&
aOut
const
CSSPropertyId
&
aProperty
)
{
if
(
aProperty
.
IsCustom
(
)
)
{
return
aOut
<
<
nsAtomCString
(
aProperty
.
mCustomName
)
;
}
return
aOut
<
<
nsCSSProps
:
:
GetStringValue
(
aProperty
.
mId
)
;
}
}
#
endif
