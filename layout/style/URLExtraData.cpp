#
include
"
mozilla
/
URLExtraData
.
h
"
#
include
"
mozilla
/
NullPrincipal
.
h
"
#
include
"
nsProxyRelease
.
h
"
#
include
"
ReferrerInfo
.
h
"
namespace
mozilla
{
StaticRefPtr
<
URLExtraData
>
URLExtraData
:
:
sDummy
;
StaticRefPtr
<
URLExtraData
>
URLExtraData
:
:
sDummyChrome
;
void
URLExtraData
:
:
Init
(
)
{
RefPtr
<
nsIURI
>
baseURI
=
NullPrincipal
:
:
CreateURI
(
)
;
nsCOMPtr
<
nsIReferrerInfo
>
referrerInfo
=
new
dom
:
:
ReferrerInfo
(
nullptr
)
;
sDummy
=
new
URLExtraData
(
do_AddRef
(
baseURI
)
do_AddRef
(
referrerInfo
)
NullPrincipal
:
:
CreateWithoutOriginAttributes
(
)
)
;
sDummyChrome
=
new
URLExtraData
(
baseURI
.
forget
(
)
referrerInfo
.
forget
(
)
NullPrincipal
:
:
CreateWithoutOriginAttributes
(
)
)
;
sDummyChrome
-
>
mChromeRulesEnabled
=
true
;
}
void
URLExtraData
:
:
Shutdown
(
)
{
sDummy
=
nullptr
;
sDummyChrome
=
nullptr
;
}
URLExtraData
:
:
~
URLExtraData
(
)
{
if
(
!
NS_IsMainThread
(
)
)
{
NS_ReleaseOnMainThread
(
"
URLExtraData
:
:
mPrincipal
"
mPrincipal
.
forget
(
)
)
;
}
}
StaticRefPtr
<
URLExtraData
>
URLExtraData
:
:
sShared
[
size_t
(
UserAgentStyleSheetID
:
:
Count
)
]
;
}
