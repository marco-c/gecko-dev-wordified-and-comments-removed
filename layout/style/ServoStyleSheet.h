#
ifndef
mozilla_ServoStyleSheet_h
#
define
mozilla_ServoStyleSheet_h
#
include
"
mozilla
/
dom
/
SRIMetadata
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
mozilla
/
ServoBindingTypes
.
h
"
#
include
"
mozilla
/
StyleSheet
.
h
"
#
include
"
mozilla
/
StyleSheetInfo
.
h
"
#
include
"
nsStringFwd
.
h
"
namespace
mozilla
{
class
ServoCSSRuleList
;
namespace
css
{
class
Loader
;
}
class
ServoStyleSheet
:
public
StyleSheet
{
public
:
ServoStyleSheet
(
css
:
:
SheetParsingMode
aParsingMode
CORSMode
aCORSMode
net
:
:
ReferrerPolicy
aReferrerPolicy
const
dom
:
:
SRIMetadata
&
aIntegrity
)
;
NS_DECL_ISUPPORTS_INHERITED
NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED
(
ServoStyleSheet
StyleSheet
)
bool
HasRules
(
)
const
;
void
SetOwningDocument
(
nsIDocument
*
aDocument
)
;
ServoStyleSheet
*
GetParentSheet
(
)
const
;
void
AppendStyleSheet
(
ServoStyleSheet
*
aSheet
)
;
MOZ_MUST_USE
nsresult
ParseSheet
(
css
:
:
Loader
*
aLoader
const
nsAString
&
aInput
nsIURI
*
aSheetURI
nsIURI
*
aBaseURI
nsIPrincipal
*
aSheetPrincipal
uint32_t
aLineNumber
)
;
void
LoadFailed
(
)
;
size_t
SizeOfIncludingThis
(
MallocSizeOf
aMallocSizeOf
)
const
;
#
ifdef
DEBUG
void
List
(
FILE
*
aOut
=
stdout
int32_t
aIndex
=
0
)
const
;
#
endif
RawServoStyleSheet
*
RawSheet
(
)
const
{
return
mSheet
;
}
void
SetSheetForImport
(
RawServoStyleSheet
*
aSheet
)
{
MOZ_ASSERT
(
!
mSheet
)
;
mSheet
=
aSheet
;
}
nsMediaList
*
Media
(
)
final
;
nsIDOMCSSRule
*
GetDOMOwnerRule
(
)
const
final
;
void
WillDirty
(
)
{
}
void
DidDirty
(
)
{
}
protected
:
virtual
~
ServoStyleSheet
(
)
;
dom
:
:
CSSRuleList
*
GetCssRulesInternal
(
ErrorResult
&
aRv
)
;
uint32_t
InsertRuleInternal
(
const
nsAString
&
aRule
uint32_t
aIndex
ErrorResult
&
aRv
)
;
void
DeleteRuleInternal
(
uint32_t
aIndex
ErrorResult
&
aRv
)
;
private
:
void
DropSheet
(
)
;
void
DropRuleList
(
)
;
RefPtr
<
RawServoStyleSheet
>
mSheet
;
RefPtr
<
ServoCSSRuleList
>
mRuleList
;
StyleSheetInfo
mSheetInfo
;
friend
class
StyleSheet
;
}
;
}
#
endif
