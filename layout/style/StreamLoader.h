#
ifndef
mozilla_css_StreamLoader_h
#
define
mozilla_css_StreamLoader_h
#
include
"
nsIStreamListener
.
h
"
#
include
"
nsString
.
h
"
#
include
"
mozilla
/
css
/
SheetLoadData
.
h
"
#
include
"
mozilla
/
Assertions
.
h
"
class
nsIInputStream
;
namespace
mozilla
{
namespace
css
{
class
StreamLoader
:
public
nsIStreamListener
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSIREQUESTOBSERVER
NS_DECL_NSISTREAMLISTENER
explicit
StreamLoader
(
SheetLoadData
&
)
;
void
ChannelOpenFailed
(
)
{
#
ifdef
MOZ_DIAGNOSTIC_ASSERT_ENABLED
mChannelOpenFailed
=
true
;
#
endif
}
private
:
virtual
~
StreamLoader
(
)
;
static
nsresult
WriteSegmentFun
(
nsIInputStream
*
void
*
const
char
*
uint32_t
uint32_t
uint32_t
*
)
;
void
HandleBOM
(
)
;
RefPtr
<
SheetLoadData
>
mSheetLoadData
;
nsresult
mStatus
;
Maybe
<
const
Encoding
*
>
mEncodingFromBOM
;
nsCString
mBytes
;
nsAutoCStringN
<
3
>
mBOMBytes
;
#
ifdef
MOZ_DIAGNOSTIC_ASSERT_ENABLED
bool
mChannelOpenFailed
=
false
;
bool
mOnStopRequestCalled
=
false
;
#
endif
}
;
}
}
#
endif
