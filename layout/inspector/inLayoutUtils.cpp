#
include
"
inLayoutUtils
.
h
"
#
include
"
nsIDocument
.
h
"
#
include
"
nsIDOMDocument
.
h
"
#
include
"
nsIContent
.
h
"
#
include
"
nsIContentViewer
.
h
"
#
include
"
nsPIDOMWindow
.
h
"
#
include
"
nsIDocShell
.
h
"
#
include
"
nsIPresShell
.
h
"
#
include
"
nsPresContext
.
h
"
#
include
"
mozilla
/
EventStateManager
.
h
"
#
include
"
mozilla
/
dom
/
Element
.
h
"
using
namespace
mozilla
;
EventStateManager
*
inLayoutUtils
:
:
GetEventStateManagerFor
(
Element
&
aElement
)
{
nsIDocument
*
doc
=
aElement
.
OwnerDoc
(
)
;
nsIPresShell
*
shell
=
doc
-
>
GetShell
(
)
;
if
(
!
shell
)
return
nullptr
;
return
shell
-
>
GetPresContext
(
)
-
>
EventStateManager
(
)
;
}
nsIDOMDocument
*
inLayoutUtils
:
:
GetSubDocumentFor
(
nsIDOMNode
*
aNode
)
{
nsCOMPtr
<
nsIContent
>
content
=
do_QueryInterface
(
aNode
)
;
if
(
content
)
{
nsCOMPtr
<
nsIDocument
>
doc
=
content
-
>
GetComposedDoc
(
)
;
if
(
doc
)
{
nsCOMPtr
<
nsIDOMDocument
>
domdoc
(
do_QueryInterface
(
doc
-
>
GetSubDocumentFor
(
content
)
)
)
;
return
domdoc
;
}
}
return
nullptr
;
}
nsINode
*
inLayoutUtils
:
:
GetContainerFor
(
const
nsIDocument
&
aDoc
)
{
nsPIDOMWindowOuter
*
pwin
=
aDoc
.
GetWindow
(
)
;
if
(
!
pwin
)
{
return
nullptr
;
}
return
pwin
-
>
GetFrameElementInternal
(
)
;
}
