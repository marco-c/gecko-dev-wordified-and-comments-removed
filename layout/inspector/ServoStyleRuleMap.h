#
ifndef
mozilla_ServoStyleRuleMap_h
#
define
mozilla_ServoStyleRuleMap_h
#
include
"
mozilla
/
ServoStyleRule
.
h
"
#
include
"
mozilla
/
ServoStyleSheet
.
h
"
#
include
"
nsDataHashtable
.
h
"
struct
RawServoStyleRule
;
class
nsXBLPrototypeResources
;
namespace
mozilla
{
class
ServoCSSRuleList
;
class
ServoStyleSet
;
namespace
css
{
class
Rule
;
}
namespace
dom
{
class
ShadowRoot
;
}
class
ServoStyleRuleMap
{
public
:
ServoStyleRuleMap
(
)
=
default
;
void
EnsureTable
(
ServoStyleSet
&
)
;
void
EnsureTable
(
nsXBLPrototypeResources
&
)
;
void
EnsureTable
(
dom
:
:
ShadowRoot
&
)
;
ServoStyleRule
*
Lookup
(
const
RawServoStyleRule
*
aRawRule
)
const
{
return
mTable
.
Get
(
aRawRule
)
;
}
void
SheetAdded
(
ServoStyleSheet
&
)
;
void
SheetRemoved
(
ServoStyleSheet
&
)
;
void
RuleAdded
(
ServoStyleSheet
&
aStyleSheet
css
:
:
Rule
&
)
;
void
RuleRemoved
(
ServoStyleSheet
&
aStyleSheet
css
:
:
Rule
&
)
;
size_t
SizeOfIncludingThis
(
MallocSizeOf
aMallocSizeOf
)
const
;
~
ServoStyleRuleMap
(
)
=
default
;
private
:
bool
IsEmpty
(
)
const
{
return
mTable
.
Count
(
)
=
=
0
;
}
void
FillTableFromRule
(
css
:
:
Rule
&
aRule
)
;
void
FillTableFromRuleList
(
ServoCSSRuleList
&
aRuleList
)
;
void
FillTableFromStyleSheet
(
ServoStyleSheet
&
aSheet
)
;
typedef
nsDataHashtable
<
nsPtrHashKey
<
const
RawServoStyleRule
>
WeakPtr
<
ServoStyleRule
>
>
Hashtable
;
Hashtable
mTable
;
}
;
}
#
endif
