#
include
"
DrawEventRecorder
.
h
"
namespace
mozilla
{
namespace
layout
{
void
DrawEventRecorderPRFileDesc
:
:
RecordEvent
(
const
gfx
:
:
RecordedEvent
&
aEvent
)
{
aEvent
.
RecordToStream
(
mOutputStream
)
;
Flush
(
)
;
}
DrawEventRecorderPRFileDesc
:
:
~
DrawEventRecorderPRFileDesc
(
)
{
if
(
IsOpen
(
)
)
{
Close
(
)
;
}
}
void
DrawEventRecorderPRFileDesc
:
:
Flush
(
)
{
mOutputStream
.
Flush
(
)
;
}
bool
DrawEventRecorderPRFileDesc
:
:
IsOpen
(
)
{
return
mOutputStream
.
IsOpen
(
)
;
}
void
DrawEventRecorderPRFileDesc
:
:
OpenFD
(
PRFileDesc
*
aFd
)
{
MOZ_DIAGNOSTIC_ASSERT
(
!
IsOpen
(
)
)
;
mOutputStream
.
OpenFD
(
aFd
)
;
WriteHeader
(
mOutputStream
)
;
}
void
DrawEventRecorderPRFileDesc
:
:
Close
(
)
{
MOZ_DIAGNOSTIC_ASSERT
(
IsOpen
(
)
)
;
mOutputStream
.
Close
(
)
;
}
void
DrawEventRecorderPRFileDesc
:
:
AddDependentSurface
(
uint64_t
aDependencyId
)
{
mDependentSurfaces
.
AppendElement
(
aDependencyId
)
;
}
nsTArray
<
uint64_t
>
&
&
DrawEventRecorderPRFileDesc
:
:
TakeDependentSurfaces
(
)
{
return
std
:
:
move
(
mDependentSurfaces
)
;
}
}
}
