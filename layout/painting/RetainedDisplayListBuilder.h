#
ifndef
RETAINEDDISPLAYLISTBUILDER_H_
#
define
RETAINEDDISPLAYLISTBUILDER_H_
#
include
"
nsDisplayList
.
h
"
#
include
"
mozilla
/
Maybe
.
h
"
namespace
mozilla
{
class
DisplayListChecker
;
}
struct
RetainedDisplayListBuilder
{
RetainedDisplayListBuilder
(
nsIFrame
*
aReferenceFrame
nsDisplayListBuilderMode
aMode
bool
aBuildCaret
)
:
mBuilder
(
aReferenceFrame
aMode
aBuildCaret
true
)
{
}
~
RetainedDisplayListBuilder
(
)
{
mList
.
DeleteAll
(
&
mBuilder
)
;
}
nsDisplayListBuilder
*
Builder
(
)
{
return
&
mBuilder
;
}
nsDisplayList
*
List
(
)
{
return
&
mList
;
}
bool
AttemptPartialUpdate
(
nscolor
aBackstop
mozilla
:
:
DisplayListChecker
*
aChecker
)
;
void
ClearFramesWithProps
(
)
;
NS_DECLARE_FRAME_PROPERTY_DELETABLE
(
Cached
RetainedDisplayListBuilder
)
private
:
void
PreProcessDisplayList
(
nsDisplayList
*
aList
AnimatedGeometryRoot
*
aAGR
)
;
void
MergeDisplayLists
(
nsDisplayList
*
aNewList
nsDisplayList
*
aOldList
nsDisplayList
*
aOutList
mozilla
:
:
Maybe
<
const
mozilla
:
:
ActiveScrolledRoot
*
>
&
aOutContainerASR
)
;
bool
ComputeRebuildRegion
(
nsTArray
<
nsIFrame
*
>
&
aModifiedFrames
nsRect
*
aOutDirty
AnimatedGeometryRoot
*
*
aOutModifiedAGR
nsTArray
<
nsIFrame
*
>
&
aOutFramesWithProps
)
;
void
IncrementSubDocPresShellPaintCount
(
nsDisplayItem
*
aItem
)
;
nsDisplayListBuilder
mBuilder
;
nsDisplayList
mList
;
WeakFrame
mPreviousCaret
;
}
;
#
endif
