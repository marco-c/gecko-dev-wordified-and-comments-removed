#
ifndef
nsTableColGroupFrame_h__
#
define
nsTableColGroupFrame_h__
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
nscore
.
h
"
#
include
"
nsContainerFrame
.
h
"
#
include
"
nsTableFrame
.
h
"
#
include
"
mozilla
/
WritingModes
.
h
"
class
nsTableColFrame
;
class
nsTableColGroupFrame
final
:
public
nsContainerFrame
{
public
:
NS_DECL_FRAMEARENA_HELPERS
(
nsTableColGroupFrame
)
friend
nsTableColGroupFrame
*
NS_NewTableColGroupFrame
(
nsIPresShell
*
aPresShell
ComputedStyle
*
aStyle
)
;
virtual
void
Init
(
nsIContent
*
aContent
nsContainerFrame
*
aParent
nsIFrame
*
aPrevInFlow
)
override
{
nsContainerFrame
:
:
Init
(
aContent
aParent
aPrevInFlow
)
;
if
(
!
aPrevInFlow
)
{
mWritingMode
=
GetTableFrame
(
)
-
>
GetWritingMode
(
)
;
}
}
nsTableFrame
*
GetTableFrame
(
)
const
{
nsIFrame
*
parent
=
GetParent
(
)
;
MOZ_ASSERT
(
parent
&
&
parent
-
>
IsTableFrame
(
)
)
;
MOZ_ASSERT
(
!
parent
-
>
GetPrevInFlow
(
)
"
Col
group
should
always
be
in
a
first
-
in
-
flow
table
frame
"
)
;
return
static_cast
<
nsTableFrame
*
>
(
parent
)
;
}
virtual
void
BuildDisplayList
(
nsDisplayListBuilder
*
aBuilder
const
nsDisplayListSet
&
aLists
)
override
;
bool
IsSynthetic
(
)
const
;
void
SetIsSynthetic
(
)
;
static
nsTableColGroupFrame
*
GetLastRealColGroup
(
nsTableFrame
*
aTableFrame
)
;
virtual
void
DidSetComputedStyle
(
ComputedStyle
*
aOldComputedStyle
)
override
;
virtual
void
SetInitialChildList
(
ChildListID
aListID
nsFrameList
&
aChildList
)
override
;
virtual
void
AppendFrames
(
ChildListID
aListID
nsFrameList
&
aFrameList
)
override
;
virtual
void
InsertFrames
(
ChildListID
aListID
nsIFrame
*
aPrevFrame
nsFrameList
&
aFrameList
)
override
;
virtual
void
RemoveFrame
(
ChildListID
aListID
nsIFrame
*
aOldFrame
)
override
;
void
RemoveChild
(
nsTableColFrame
&
aChild
bool
aResetSubsequentColIndices
)
;
virtual
void
Reflow
(
nsPresContext
*
aPresContext
ReflowOutput
&
aDesiredSize
const
ReflowInput
&
aReflowInput
nsReflowStatus
&
aStatus
)
override
;
nsresult
AddColsToTable
(
int32_t
aFirstColIndex
bool
aResetSubsequentColIndices
const
nsFrameList
:
:
Slice
&
aCols
)
;
#
ifdef
DEBUG_FRAME_DUMP
virtual
nsresult
GetFrameName
(
nsAString
&
aResult
)
const
override
;
void
Dump
(
int32_t
aIndent
)
;
#
endif
virtual
int32_t
GetColCount
(
)
const
;
nsTableColFrame
*
GetFirstColumn
(
)
;
nsTableColFrame
*
GetNextColumn
(
nsIFrame
*
aChildFrame
)
;
int32_t
GetStartColumnIndex
(
)
;
void
SetStartColumnIndex
(
int32_t
aIndex
)
;
int32_t
GetSpan
(
)
;
nsFrameList
&
GetWritableChildList
(
)
;
static
void
ResetColIndices
(
nsIFrame
*
aFirstColGroup
int32_t
aFirstColIndex
nsIFrame
*
aStartColFrame
=
nullptr
)
;
void
GetContinuousBCBorderWidth
(
mozilla
:
:
WritingMode
aWM
mozilla
:
:
LogicalMargin
&
aBorder
)
;
void
SetContinuousBCBorderWidth
(
mozilla
:
:
LogicalSide
aForSide
BCPixelSize
aPixelValue
)
;
virtual
bool
IsFrameOfType
(
uint32_t
aFlags
)
const
override
{
if
(
aFlags
&
eSupportsContainLayoutAndPaint
)
{
return
false
;
}
return
nsContainerFrame
:
:
IsFrameOfType
(
aFlags
&
~
(
nsIFrame
:
:
eTablePart
)
)
;
}
virtual
void
InvalidateFrame
(
uint32_t
aDisplayItemKey
=
0
bool
aRebuildDisplayItems
=
true
)
override
;
virtual
void
InvalidateFrameWithRect
(
const
nsRect
&
aRect
uint32_t
aDisplayItemKey
=
0
bool
aRebuildDisplayItems
=
true
)
override
;
virtual
void
InvalidateFrameForRemoval
(
)
override
{
InvalidateFrameSubtree
(
)
;
}
protected
:
explicit
nsTableColGroupFrame
(
ComputedStyle
*
aStyle
nsPresContext
*
aPresContext
)
;
void
InsertColsReflow
(
int32_t
aColIndex
const
nsFrameList
:
:
Slice
&
aCols
)
;
virtual
LogicalSides
GetLogicalSkipSides
(
const
ReflowInput
*
aReflowInput
=
nullptr
)
const
override
;
int32_t
mColCount
;
int32_t
mStartColIndex
;
BCPixelSize
mBStartContBorderWidth
;
BCPixelSize
mBEndContBorderWidth
;
}
;
inline
nsTableColGroupFrame
:
:
nsTableColGroupFrame
(
ComputedStyle
*
aStyle
nsPresContext
*
aPresContext
)
:
nsContainerFrame
(
aStyle
aPresContext
kClassID
)
mColCount
(
0
)
mStartColIndex
(
0
)
{
}
inline
int32_t
nsTableColGroupFrame
:
:
GetStartColumnIndex
(
)
{
return
mStartColIndex
;
}
inline
void
nsTableColGroupFrame
:
:
SetStartColumnIndex
(
int32_t
aIndex
)
{
mStartColIndex
=
aIndex
;
}
inline
int32_t
nsTableColGroupFrame
:
:
GetColCount
(
)
const
{
return
mColCount
;
}
inline
nsFrameList
&
nsTableColGroupFrame
:
:
GetWritableChildList
(
)
{
return
mFrames
;
}
#
endif
