#
ifndef
mozilla_a11y_DocAccessibleWrap_h__
#
define
mozilla_a11y_DocAccessibleWrap_h__
#
include
"
DocAccessible
.
h
"
#
include
"
nsITimer
.
h
"
namespace
mozilla
{
class
PresShell
;
namespace
a11y
{
class
DocAccessibleWrap
:
public
DocAccessible
{
public
:
DocAccessibleWrap
(
Document
*
aDocument
PresShell
*
aPresShell
)
;
virtual
~
DocAccessibleWrap
(
)
;
virtual
nsresult
HandleAccEvent
(
AccEvent
*
aEvent
)
override
;
void
AddID
(
uint32_t
aID
AccessibleWrap
*
aAcc
)
{
mIDToAccessibleMap
.
InsertOrUpdate
(
aID
aAcc
)
;
}
void
RemoveID
(
uint32_t
aID
)
{
mIDToAccessibleMap
.
Remove
(
aID
)
;
}
AccessibleWrap
*
GetAccessibleByID
(
int32_t
aID
)
const
;
DocAccessibleWrap
*
GetTopLevelContentDoc
(
AccessibleWrap
*
aAccessible
)
;
void
CacheFocusPath
(
AccessibleWrap
*
aAccessible
)
;
void
CacheViewport
(
bool
aCachePivotBoundaries
)
;
enum
{
eBatch_Viewport
=
0
eBatch_FocusPath
=
1
eBatch_BoundsUpdate
=
2
}
;
protected
:
nsTHashMap
<
nsUint32HashKey
AccessibleWrap
*
>
mIDToAccessibleMap
;
virtual
void
DoInitialUpdate
(
)
override
;
private
:
void
UpdateFocusPathBounds
(
)
;
static
void
CacheViewportCallback
(
nsITimer
*
aTimer
void
*
aDocAccParam
)
;
nsCOMPtr
<
nsITimer
>
mCacheRefreshTimer
;
bool
mCachePivotBoundaries
;
AccessibleHashtable
mFocusPath
;
}
;
}
}
#
endif
