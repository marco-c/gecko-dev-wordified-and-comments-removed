#
include
"
DocAccessibleWrap
.
h
"
#
include
"
nsIDocShell
.
h
"
using
namespace
mozilla
:
:
a11y
;
DocAccessibleWrap
:
:
DocAccessibleWrap
(
nsIDocument
*
aDocument
nsIPresShell
*
aPresShell
)
:
DocAccessible
(
aDocument
aPresShell
)
{
nsCOMPtr
<
nsIDocShellTreeItem
>
treeItem
(
aDocument
-
>
GetDocShell
(
)
)
;
nsCOMPtr
<
nsIDocShellTreeItem
>
parentTreeItem
;
treeItem
-
>
GetParent
(
getter_AddRefs
(
parentTreeItem
)
)
;
if
(
treeItem
-
>
ItemType
(
)
=
=
nsIDocShellTreeItem
:
:
typeContent
&
&
(
!
parentTreeItem
|
|
parentTreeItem
-
>
ItemType
(
)
=
=
nsIDocShellTreeItem
:
:
typeChrome
)
)
{
mID
=
kNoID
;
}
else
{
mID
=
AcquireID
(
)
;
}
}
DocAccessibleWrap
:
:
~
DocAccessibleWrap
(
)
{
}
AccessibleWrap
*
DocAccessibleWrap
:
:
GetAccessibleByID
(
int32_t
aID
)
const
{
if
(
AccessibleWrap
*
acc
=
mIDToAccessibleMap
.
Get
(
aID
)
)
{
return
acc
;
}
for
(
uint32_t
i
=
0
;
i
<
ChildDocumentCount
(
)
;
i
+
+
)
{
auto
childDoc
=
reinterpret_cast
<
AccessibleWrap
*
>
(
GetChildDocumentAt
(
i
)
)
;
if
(
childDoc
-
>
VirtualViewID
(
)
=
=
aID
)
{
return
childDoc
;
}
}
return
nullptr
;
}
