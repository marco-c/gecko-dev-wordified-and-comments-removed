#
import
"
mozHTMLAccessible
.
h
"
#
import
"
Accessible
-
inl
.
h
"
#
import
"
HyperTextAccessible
.
h
"
#
import
"
nsCocoaUtils
.
h
"
implementation
mozHeadingAccessible
-
(
NSString
*
)
title
{
nsAutoString
title
;
if
(
Accessible
*
acc
=
mGeckoAccessible
.
AsAccessible
(
)
)
{
mozilla
:
:
ErrorResult
rv
;
acc
-
>
GetContent
(
)
-
>
GetTextContent
(
title
rv
)
;
}
else
if
(
ProxyAccessible
*
proxy
=
mGeckoAccessible
.
AsProxy
(
)
)
{
proxy
-
>
Title
(
title
)
;
}
return
nsCocoaUtils
:
:
ToNSString
(
title
)
;
}
-
(
id
)
value
{
GroupPos
groupPos
;
if
(
Accessible
*
acc
=
mGeckoAccessible
.
AsAccessible
(
)
)
{
groupPos
=
acc
-
>
GroupPosition
(
)
;
}
else
if
(
ProxyAccessible
*
proxy
=
mGeckoAccessible
.
AsProxy
(
)
)
{
groupPos
=
proxy
-
>
GroupPosition
(
)
;
}
return
[
NSNumber
numberWithInt
:
groupPos
.
level
]
;
}
end
interface
mozLinkAccessible
(
)
-
(
NSURL
*
)
url
;
end
implementation
mozLinkAccessible
-
(
NSArray
*
)
accessibilityAttributeNames
{
if
(
[
self
isExpired
]
)
{
return
[
]
;
}
if
(
!
[
self
stateWithMask
:
states
:
:
LINKED
]
)
{
return
[
super
accessibilityAttributeNames
]
;
}
static
NSMutableArray
*
attributes
=
nil
;
if
(
!
attributes
)
{
attributes
=
[
[
super
accessibilityAttributeNames
]
mutableCopy
]
;
[
attributes
addObject
:
NSAccessibilityURLAttribute
]
;
[
attributes
addObject
:
"
AXVisited
"
]
;
}
return
attributes
;
}
-
(
id
)
accessibilityAttributeValue
:
(
NSString
*
)
attribute
{
if
(
[
self
stateWithMask
:
states
:
:
LINKED
]
)
{
if
(
[
attribute
isEqualToString
:
NSAccessibilityURLAttribute
]
)
return
[
self
url
]
;
if
(
[
attribute
isEqualToString
:
"
AXVisited
"
]
)
{
return
[
NSNumber
numberWithBool
:
[
self
stateWithMask
:
states
:
:
TRAVERSED
]
!
=
0
]
;
}
}
return
[
super
accessibilityAttributeValue
:
attribute
]
;
}
-
(
NSString
*
)
customDescription
{
return
"
"
;
}
-
(
NSString
*
)
value
{
return
"
"
;
}
-
(
NSURL
*
)
url
{
nsAutoString
value
;
if
(
Accessible
*
acc
=
mGeckoAccessible
.
AsAccessible
(
)
)
{
acc
-
>
Value
(
value
)
;
}
else
if
(
ProxyAccessible
*
proxy
=
mGeckoAccessible
.
AsProxy
(
)
)
{
proxy
-
>
Value
(
value
)
;
}
NSString
*
urlString
=
value
.
IsEmpty
(
)
?
nil
:
nsCocoaUtils
:
:
ToNSString
(
value
)
;
if
(
!
urlString
)
return
nil
;
return
[
NSURL
URLWithString
:
urlString
]
;
}
-
(
NSString
*
)
role
{
if
(
!
[
self
stateWithMask
:
states
:
:
LINKED
]
)
{
return
NSAccessibilityGroupRole
;
}
return
[
super
role
]
;
}
end
