"
use
strict
"
;
loadScripts
(
{
name
:
"
role
.
js
"
dir
:
MOCHITESTS_DIR
}
{
name
:
"
states
.
js
"
dir
:
MOCHITESTS_DIR
}
)
;
addAccessibleTask
(
<
div
id
=
"
section
"
role
=
"
group
"
>
Hello
<
/
div
>
async
(
browser
accDoc
)
=
>
{
let
section
=
getNativeInterface
(
accDoc
"
section
"
)
;
ok
(
!
section
.
getAttributeValue
(
"
AXElementBusy
"
)
"
section
is
not
busy
"
)
;
let
busyChanged
=
waitForMacEvent
(
"
AXElementBusyChanged
"
"
section
"
)
;
await
SpecialPowers
.
spawn
(
browser
[
]
(
)
=
>
{
content
.
document
.
getElementById
(
"
section
"
)
.
setAttribute
(
"
aria
-
busy
"
"
true
"
)
;
}
)
;
await
busyChanged
;
ok
(
section
.
getAttributeValue
(
"
AXElementBusy
"
)
"
section
is
busy
"
)
;
busyChanged
=
waitForMacEvent
(
"
AXElementBusyChanged
"
"
section
"
)
;
await
SpecialPowers
.
spawn
(
browser
[
]
(
)
=
>
{
content
.
document
.
getElementById
(
"
section
"
)
.
setAttribute
(
"
aria
-
busy
"
"
false
"
)
;
}
)
;
await
busyChanged
;
ok
(
!
section
.
getAttributeValue
(
"
AXElementBusy
"
)
"
section
is
not
busy
"
)
;
}
)
;
