#
ifndef
mozilla_a11y_DocAccessibleChildBase_h
#
define
mozilla_a11y_DocAccessibleChildBase_h
#
include
"
mozilla
/
a11y
/
DocAccessible
.
h
"
#
include
"
mozilla
/
a11y
/
PDocAccessibleChild
.
h
"
#
include
"
nsISupportsImpl
.
h
"
namespace
mozilla
{
namespace
a11y
{
class
Accessible
;
class
AccShowEvent
;
class
DocAccessibleChildBase
:
public
PDocAccessibleChild
{
public
:
explicit
DocAccessibleChildBase
(
DocAccessible
*
aDoc
)
:
mDoc
(
aDoc
)
{
MOZ_COUNT_CTOR
(
DocAccessibleChildBase
)
;
}
~
DocAccessibleChildBase
(
)
{
MOZ_ASSERT
(
!
mDoc
)
;
if
(
mDoc
)
{
mDoc
-
>
SetIPCDoc
(
nullptr
)
;
}
MOZ_COUNT_DTOR
(
DocAccessibleChildBase
)
;
}
void
Shutdown
(
)
{
mDoc
-
>
SetIPCDoc
(
nullptr
)
;
mDoc
=
nullptr
;
SendShutdown
(
)
;
}
void
ShowEvent
(
AccShowEvent
*
aShowEvent
)
;
virtual
void
ActorDestroy
(
ActorDestroyReason
)
override
{
if
(
!
mDoc
)
{
return
;
}
mDoc
-
>
SetIPCDoc
(
nullptr
)
;
mDoc
=
nullptr
;
}
protected
:
static
uint32_t
InterfacesFor
(
Accessible
*
aAcc
)
;
static
void
SerializeTree
(
Accessible
*
aRoot
nsTArray
<
AccessibleData
>
&
aTree
)
;
#
if
defined
(
XP_WIN
)
static
void
SetMsaaIds
(
Accessible
*
aRoot
uint32_t
&
aMsaaIdIndex
const
nsTArray
<
MsaaMapping
>
&
aNewMsaaIds
)
;
#
endif
DocAccessible
*
mDoc
;
}
;
}
}
#
endif
