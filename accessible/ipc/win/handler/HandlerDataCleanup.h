#
ifndef
mozilla_a11y_HandlerDataCleanup_h
#
define
mozilla_a11y_HandlerDataCleanup_h
#
include
<
OleAuto
.
h
>
#
include
"
HandlerData
.
h
"
namespace
mozilla
{
namespace
a11y
{
inline
void
ReleaseStaticIA2DataInterfaces
(
StaticIA2Data
&
aData
)
{
if
(
aData
.
mIA2
)
{
aData
.
mIA2
-
>
Release
(
)
;
}
if
(
aData
.
mIEnumVARIANT
)
{
aData
.
mIEnumVARIANT
-
>
Release
(
)
;
}
if
(
aData
.
mIAHypertext
)
{
aData
.
mIAHypertext
-
>
Release
(
)
;
}
if
(
aData
.
mIAHyperlink
)
{
aData
.
mIAHyperlink
-
>
Release
(
)
;
}
if
(
aData
.
mIATable
)
{
aData
.
mIATable
-
>
Release
(
)
;
}
if
(
aData
.
mIATable2
)
{
aData
.
mIATable2
-
>
Release
(
)
;
}
if
(
aData
.
mIATableCell
)
{
aData
.
mIATableCell
-
>
Release
(
)
;
}
}
inline
void
CleanupDynamicIA2Data
(
DynamicIA2Data
&
aData
bool
aZero
=
true
)
{
:
:
VariantClear
(
&
aData
.
mRole
)
;
if
(
aData
.
mKeyboardShortcut
)
{
:
:
SysFreeString
(
aData
.
mKeyboardShortcut
)
;
}
if
(
aData
.
mName
)
{
:
:
SysFreeString
(
aData
.
mName
)
;
}
if
(
aData
.
mDescription
)
{
:
:
SysFreeString
(
aData
.
mDescription
)
;
}
if
(
aData
.
mDefaultAction
)
{
:
:
SysFreeString
(
aData
.
mDefaultAction
)
;
}
if
(
aData
.
mValue
)
{
:
:
SysFreeString
(
aData
.
mValue
)
;
}
if
(
aData
.
mAttributes
)
{
:
:
SysFreeString
(
aData
.
mAttributes
)
;
}
if
(
aData
.
mIA2Locale
.
language
)
{
:
:
SysFreeString
(
aData
.
mIA2Locale
.
language
)
;
}
if
(
aData
.
mIA2Locale
.
country
)
{
:
:
SysFreeString
(
aData
.
mIA2Locale
.
country
)
;
}
if
(
aData
.
mIA2Locale
.
variant
)
{
:
:
SysFreeString
(
aData
.
mIA2Locale
.
variant
)
;
}
if
(
aZero
)
{
ZeroMemory
(
&
aData
sizeof
(
DynamicIA2Data
)
)
;
}
}
}
}
#
endif
