#
if
defined
(
MOZILLA_INTERNAL_API
)
#
error
This
code
is
NOT
for
internal
Gecko
use
!
#
endif
#
ifndef
mozilla_a11y_AccessibleHandlerControl_h
#
define
mozilla_a11y_AccessibleHandlerControl_h
#
include
"
Factory
.
h
"
#
include
"
HandlerData
.
h
"
#
include
"
mozilla
/
mscom
/
Registration
.
h
"
namespace
mozilla
{
namespace
a11y
{
class
AccessibleHandlerControl
final
:
public
IHandlerControl
{
public
:
static
HRESULT
Create
(
AccessibleHandlerControl
*
*
aOutObject
)
;
STDMETHODIMP
QueryInterface
(
REFIID
riid
void
*
*
ppv
)
override
;
STDMETHODIMP_
(
ULONG
)
AddRef
(
)
override
;
STDMETHODIMP_
(
ULONG
)
Release
(
)
override
;
STDMETHODIMP
Invalidate
(
)
override
;
uint32_t
GetCacheGen
(
)
const
{
return
mCacheGen
;
}
HRESULT
GetHandlerTypeInfo
(
ITypeInfo
*
*
aOutTypeInfo
)
;
private
:
AccessibleHandlerControl
(
)
;
~
AccessibleHandlerControl
(
)
=
default
;
ULONG
mRefCnt
;
uint32_t
mCacheGen
;
UniquePtr
<
mscom
:
:
RegisteredProxy
>
mIA2Proxy
;
UniquePtr
<
mscom
:
:
RegisteredProxy
>
mHandlerProxy
;
}
;
extern
mscom
:
:
SingletonFactory
<
AccessibleHandlerControl
>
gControlFactory
;
}
}
#
endif
