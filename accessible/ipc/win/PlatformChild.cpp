#
include
"
mozilla
/
a11y
/
PlatformChild
.
h
"
#
include
"
mozilla
/
mscom
/
EnsureMTA
.
h
"
#
include
"
mozilla
/
mscom
/
InterceptorLog
.
h
"
#
include
"
Accessible2
.
h
"
namespace
mozilla
{
namespace
a11y
{
static
const
mozilla
:
:
mscom
:
:
ArrayData
sPlatformChildArrayData
[
]
=
{
{
IID_IEnumVARIANT
3
1
VT_DISPATCH
IID_IDispatch
2
}
{
IID_IAccessible2
30
1
VT_UNKNOWN
|
VT_BYREF
IID_IAccessibleRelation
2
}
{
IID_IAccessibleRelation
7
1
VT_UNKNOWN
|
VT_BYREF
IID_IUnknown
2
}
}
;
PlatformChild
:
:
PlatformChild
(
)
:
mAccTypelib
(
mozilla
:
:
mscom
:
:
RegisterTypelib
(
L
"
oleacc
.
dll
"
mozilla
:
:
mscom
:
:
RegistrationFlags
:
:
eUseSystemDirectory
)
)
mMiscTypelib
(
mozilla
:
:
mscom
:
:
RegisterTypelib
(
L
"
Accessible
.
tlb
"
)
)
{
mozilla
:
:
mscom
:
:
InterceptorLog
:
:
Init
(
)
;
mozilla
:
:
mscom
:
:
RegisterArrayData
(
sPlatformChildArrayData
)
;
UniquePtr
<
mozilla
:
:
mscom
:
:
RegisteredProxy
>
ia2Proxy
;
mozilla
:
:
mscom
:
:
EnsureMTA
(
[
&
ia2Proxy
]
(
)
-
>
void
{
ia2Proxy
=
Move
(
mozilla
:
:
mscom
:
:
RegisterProxy
(
L
"
ia2marshal
.
dll
"
)
)
;
}
)
;
mIA2Proxy
=
Move
(
ia2Proxy
)
;
}
}
}
