#
ifndef
mozilla_a11y_ChildIDThunk_h
#
define
mozilla_a11y_ChildIDThunk_h
#
include
"
mozilla
/
mscom
/
Interceptor
.
h
"
#
include
"
mozilla
/
Maybe
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
<
oleacc
.
h
>
#
include
<
callobj
.
h
>
namespace
mozilla
{
namespace
a11y
{
class
ChildIDThunk
:
public
mozilla
:
:
mscom
:
:
IInterceptorSink
{
public
:
ChildIDThunk
(
)
;
STDMETHODIMP
QueryInterface
(
REFIID
riid
void
*
*
ppv
)
override
;
STDMETHODIMP_
(
ULONG
)
AddRef
(
)
override
;
STDMETHODIMP_
(
ULONG
)
Release
(
)
override
;
STDMETHODIMP
OnCall
(
ICallFrame
*
aFrame
)
override
;
STDMETHODIMP
SetInterceptor
(
mozilla
:
:
mscom
:
:
IWeakReference
*
aInterceptor
)
override
;
private
:
HRESULT
ResolveTargetInterface
(
REFIID
aIid
IUnknown
*
*
aOut
)
;
static
mozilla
:
:
Maybe
<
ULONG
>
IsMethodInteresting
(
const
ULONG
aMethodIdx
)
;
static
bool
IsChildIDSelf
(
ICallFrame
*
aFrame
const
ULONG
aChildIdIdx
LONG
&
aOutChildID
)
;
static
HRESULT
SetChildIDParam
(
ICallFrame
*
aFrame
const
ULONG
aParamIdx
const
LONG
aChildID
)
;
private
:
ULONG
mRefCnt
;
RefPtr
<
mozilla
:
:
mscom
:
:
IWeakReference
>
mInterceptor
;
}
;
}
}
#
endif
