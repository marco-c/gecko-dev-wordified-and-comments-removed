#
include
"
MsaaXULMenuAccessible
.
h
"
using
namespace
mozilla
:
:
a11y
;
STDMETHODIMP
MsaaXULMenuitemAccessible
:
:
get_accKeyboardShortcut
(
VARIANT
varChild
BSTR
__RPC_FAR
*
pszKeyboardShortcut
)
{
if
(
!
pszKeyboardShortcut
)
return
E_INVALIDARG
;
*
pszKeyboardShortcut
=
nullptr
;
if
(
varChild
.
vt
!
=
VT_I4
|
|
varChild
.
lVal
!
=
CHILDID_SELF
)
{
return
MsaaAccessible
:
:
get_accKeyboardShortcut
(
varChild
pszKeyboardShortcut
)
;
}
LocalAccessible
*
acc
=
LocalAcc
(
)
;
if
(
!
acc
)
{
return
CO_E_OBJNOTCONNECTED
;
}
KeyBinding
keyBinding
=
acc
-
>
AccessKey
(
)
;
if
(
keyBinding
.
IsEmpty
(
)
)
{
return
S_FALSE
;
}
nsAutoString
shortcut
;
keyBinding
.
ToString
(
shortcut
)
;
*
pszKeyboardShortcut
=
:
:
SysAllocStringLen
(
shortcut
.
get
(
)
shortcut
.
Length
(
)
)
;
return
*
pszKeyboardShortcut
?
S_OK
:
E_OUTOFMEMORY
;
}
