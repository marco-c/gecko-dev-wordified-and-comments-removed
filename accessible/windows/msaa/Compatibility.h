#
ifndef
COMPATIBILITY_MANAGER_H
#
define
COMPATIBILITY_MANAGER_H
#
include
<
windows
.
h
>
#
include
"
nsTArray
.
h
"
#
include
"
nsString
.
h
"
#
include
<
stdint
.
h
>
namespace
mozilla
:
:
a11y
{
enum
class
SuppressionReasons
:
uint8_t
{
None
=
0
Clipboard
=
1
<
<
0
SnapLayouts
=
1
<
<
1
}
;
MOZ_MAKE_ENUM_CLASS_BITWISE_OPERATORS
(
SuppressionReasons
)
;
class
Compatibility
{
public
:
static
bool
IsJAWS
(
)
{
return
!
!
(
sConsumers
&
(
JAWS
|
OLDJAWS
)
)
;
}
static
bool
IsOldJAWS
(
)
{
return
!
!
(
sConsumers
&
OLDJAWS
)
;
}
static
bool
IsWE
(
)
{
return
!
!
(
sConsumers
&
WE
)
;
}
static
bool
IsDolphin
(
)
{
return
!
!
(
sConsumers
&
DOLPHIN
)
;
}
static
bool
IsVisperoShared
(
)
{
return
!
!
(
sConsumers
&
VISPEROSHARED
)
;
}
static
bool
IsKnownScreenReader
(
)
{
return
IsJAWS
(
)
|
|
IsDolphin
(
)
|
|
IsVisperoShared
(
)
|
|
!
!
(
sConsumers
&
NVDA
)
;
}
static
void
GetHumanReadableConsumersStr
(
nsAString
&
aResult
)
;
static
void
Init
(
)
;
static
void
GetUiaClientPids
(
nsTArray
<
DWORD
>
&
aPids
)
;
static
bool
HasKnownNonUiaConsumer
(
)
;
static
bool
IsModuleVersionLessThan
(
HMODULE
aModuleHandle
unsigned
long
long
aVersion
)
;
static
void
SuppressA11yForClipboardCopy
(
)
;
static
void
SuppressA11yForSnapLayouts
(
)
;
static
bool
IsA11ySuppressed
(
)
{
return
A11ySuppressionReasons
(
)
!
=
SuppressionReasons
:
:
None
;
}
static
SuppressionReasons
A11ySuppressionReasons
(
)
;
private
:
Compatibility
(
)
;
Compatibility
(
const
Compatibility
&
)
;
Compatibility
&
operator
=
(
const
Compatibility
&
)
;
static
void
InitConsumers
(
)
;
enum
{
NVDA
=
1
<
<
0
JAWS
=
1
<
<
1
OLDJAWS
=
1
<
<
2
WE
=
1
<
<
3
DOLPHIN
=
1
<
<
4
SEROTEK
=
1
<
<
5
COBRA
=
1
<
<
6
ZOOMTEXT
=
1
<
<
7
KAZAGURU
=
1
<
<
8
YOUDAO
=
1
<
<
9
UNKNOWN
=
1
<
<
10
UIAUTOMATION
=
1
<
<
11
VISPEROSHARED
=
1
<
<
12
}
;
#
define
CONSUMERS_ENUM_LEN
13
private
:
static
uint32_t
sConsumers
;
}
;
}
#
define
MAKE_FILE_VERSION
(
a
b
c
d
)
\
(
(
a
#
#
ULL
<
<
48
)
+
(
b
#
#
ULL
<
<
32
)
+
(
c
#
#
ULL
<
<
16
)
+
d
#
#
ULL
)
#
endif
