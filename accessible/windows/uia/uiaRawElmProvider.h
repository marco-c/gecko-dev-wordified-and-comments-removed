#
ifndef
mozilla_a11y_uiaRawElmProvider_h__
#
define
mozilla_a11y_uiaRawElmProvider_h__
#
include
<
objbase
.
h
>
#
include
<
stdint
.
h
>
#
include
<
uiautomation
.
h
>
#
include
<
initializer_list
>
#
include
"
nsString
.
h
"
template
<
class
T
>
class
nsTArray
;
template
<
class
T
>
class
RefPtr
;
namespace
mozilla
{
namespace
a11y
{
class
Accessible
;
enum
class
RelationType
;
struct
UiaRegistrations
{
PROPERTYID
mAccessibleActions
=
0
;
}
;
class
uiaRawElmProvider
:
public
IAccessibleEx
public
IRawElementProviderSimple
public
IRawElementProviderFragment
public
IInvokeProvider
public
IToggleProvider
public
IExpandCollapseProvider
public
IScrollItemProvider
public
IValueProvider
public
IRangeValueProvider
public
ISelectionProvider
public
ISelectionItemProvider
public
ITextChildProvider
{
public
:
static
constexpr
enum
ProviderOptions
kProviderOptions
=
static_cast
<
enum
ProviderOptions
>
(
ProviderOptions_ServerSideProvider
|
ProviderOptions_UseComThreading
|
ProviderOptions_HasNativeIAccessible
)
;
static
void
RaiseUiaEventForGeckoEvent
(
Accessible
*
aAcc
uint32_t
aGeckoEvent
)
;
static
void
RaiseUiaEventForStateChange
(
Accessible
*
aAcc
uint64_t
aState
bool
aEnabled
)
;
STDMETHODIMP
QueryInterface
(
REFIID
aIid
void
*
*
aInterface
)
;
virtual
HRESULT
STDMETHODCALLTYPE
GetObjectForChild
(
long
aIdChild
__RPC__deref_out_opt
IAccessibleEx
*
*
aAccEx
)
;
virtual
HRESULT
STDMETHODCALLTYPE
GetIAccessiblePair
(
__RPC__deref_out_opt
IAccessible
*
*
aAcc
__RPC__out
long
*
aIdChild
)
;
virtual
HRESULT
STDMETHODCALLTYPE
GetRuntimeId
(
__RPC__deref_out_opt
SAFEARRAY
*
*
aRuntimeIds
)
;
virtual
HRESULT
STDMETHODCALLTYPE
ConvertReturnedElement
(
__RPC__in_opt
IRawElementProviderSimple
*
aRawElmProvider
__RPC__deref_out_opt
IAccessibleEx
*
*
aAccEx
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_ProviderOptions
(
__RPC__out
enum
ProviderOptions
*
aProviderOptions
)
;
virtual
HRESULT
STDMETHODCALLTYPE
GetPatternProvider
(
PATTERNID
aPatternId
__RPC__deref_out_opt
IUnknown
*
*
aPatternProvider
)
;
virtual
HRESULT
STDMETHODCALLTYPE
GetPropertyValue
(
PROPERTYID
aPropertyId
__RPC__out
VARIANT
*
aPropertyValue
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_HostRawElementProvider
(
__RPC__deref_out_opt
IRawElementProviderSimple
*
*
aRawElmProvider
)
;
virtual
HRESULT
STDMETHODCALLTYPE
Navigate
(
enum
NavigateDirection
aDirection
__RPC__deref_out_opt
IRawElementProviderFragment
*
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_BoundingRectangle
(
__RPC__out
struct
UiaRect
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
GetEmbeddedFragmentRoots
(
__RPC__deref_out_opt
SAFEARRAY
*
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
SetFocus
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_FragmentRoot
(
__RPC__deref_out_opt
IRawElementProviderFragmentRoot
*
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
Invoke
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
Toggle
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_ToggleState
(
__RPC__out
enum
ToggleState
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
Expand
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
Collapse
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_ExpandCollapseState
(
__RPC__out
enum
ExpandCollapseState
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
ScrollIntoView
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
SetValue
(
__RPC__in
LPCWSTR
val
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_Value
(
__RPC__deref_out_opt
BSTR
*
pRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_IsReadOnly
(
__RPC__out
BOOL
*
pRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
SetValue
(
double
aVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_Value
(
__RPC__out
double
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_Maximum
(
__RPC__out
double
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_Minimum
(
__RPC__out
double
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_LargeChange
(
__RPC__out
double
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_SmallChange
(
__RPC__out
double
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
GetSelection
(
__RPC__deref_out_opt
SAFEARRAY
*
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_CanSelectMultiple
(
__RPC__out
BOOL
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_IsSelectionRequired
(
__RPC__out
BOOL
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
Select
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
AddToSelection
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
RemoveFromSelection
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_IsSelected
(
__RPC__out
BOOL
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_SelectionContainer
(
__RPC__deref_out_opt
IRawElementProviderSimple
*
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_TextContainer
(
__RPC__deref_out_opt
IRawElementProviderSimple
*
*
aRetVal
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_TextRange
(
__RPC__deref_out_opt
ITextRangeProvider
*
*
aRetVal
)
;
private
:
Accessible
*
Acc
(
)
const
;
bool
IsControl
(
)
;
long
GetControlType
(
)
const
;
bool
HasTogglePattern
(
)
;
bool
HasExpandCollapsePattern
(
)
;
bool
HasValuePattern
(
)
const
;
template
<
class
Derived
class
Interface
>
RefPtr
<
Interface
>
GetPatternFromDerived
(
)
;
bool
HasSelectionItemPattern
(
)
;
SAFEARRAY
*
AccRelationsToUiaArray
(
std
:
:
initializer_list
<
RelationType
>
aTypes
)
const
;
Accessible
*
GetLabeledBy
(
)
const
;
long
GetLandmarkType
(
)
const
;
void
GetLocalizedLandmarkType
(
nsAString
&
aLocalized
)
const
;
long
GetLiveSetting
(
)
const
;
}
;
SAFEARRAY
*
AccessibleArrayToUiaArray
(
const
nsTArray
<
Accessible
*
>
&
aAccs
)
;
const
UiaRegistrations
&
GetUiaRegistrations
(
)
;
}
}
#
endif
