#
include
"
Accessible
.
h
"
#
include
"
ARIAMap
.
h
"
#
include
"
mozilla
/
a11y
/
HyperTextAccessibleBase
.
h
"
using
namespace
mozilla
;
using
namespace
mozilla
:
:
a11y
;
Accessible
:
:
Accessible
(
)
:
mType
(
static_cast
<
uint32_t
>
(
0
)
)
mGenericTypes
(
static_cast
<
uint32_t
>
(
0
)
)
mRoleMapEntryIndex
(
aria
:
:
NO_ROLE_MAP_ENTRY_INDEX
)
{
}
Accessible
:
:
Accessible
(
AccType
aType
AccGenericType
aGenericTypes
uint8_t
aRoleMapEntryIndex
)
:
mType
(
static_cast
<
uint32_t
>
(
aType
)
)
mGenericTypes
(
static_cast
<
uint32_t
>
(
aGenericTypes
)
)
mRoleMapEntryIndex
(
aRoleMapEntryIndex
)
{
}
void
Accessible
:
:
StaticAsserts
(
)
const
{
static_assert
(
eLastAccType
<
=
(
1
<
<
kTypeBits
)
-
1
"
Accessible
:
:
mType
was
oversized
by
eLastAccType
!
"
)
;
static_assert
(
eLastAccGenericType
<
=
(
1
<
<
kGenericTypesBits
)
-
1
"
Accessible
:
:
mGenericType
was
oversized
by
eLastAccGenericType
!
"
)
;
}
const
nsRoleMapEntry
*
Accessible
:
:
ARIARoleMap
(
)
const
{
return
aria
:
:
GetRoleMapFromIndex
(
mRoleMapEntryIndex
)
;
}
bool
Accessible
:
:
HasARIARole
(
)
const
{
return
mRoleMapEntryIndex
!
=
aria
:
:
NO_ROLE_MAP_ENTRY_INDEX
;
}
bool
Accessible
:
:
IsARIARole
(
nsAtom
*
aARIARole
)
const
{
const
nsRoleMapEntry
*
roleMapEntry
=
ARIARoleMap
(
)
;
return
roleMapEntry
&
&
roleMapEntry
-
>
Is
(
aARIARole
)
;
}
bool
Accessible
:
:
HasStrongARIARole
(
)
const
{
const
nsRoleMapEntry
*
roleMapEntry
=
ARIARoleMap
(
)
;
return
roleMapEntry
&
&
roleMapEntry
-
>
roleRule
=
=
kUseMapRole
;
}
bool
Accessible
:
:
HasGenericType
(
AccGenericType
aType
)
const
{
const
nsRoleMapEntry
*
roleMapEntry
=
ARIARoleMap
(
)
;
return
(
mGenericTypes
&
aType
)
|
|
(
roleMapEntry
&
&
roleMapEntry
-
>
IsOfType
(
aType
)
)
;
}
bool
Accessible
:
:
IsTextRole
(
)
{
if
(
!
IsHyperText
(
)
)
{
return
false
;
}
const
nsRoleMapEntry
*
roleMapEntry
=
ARIARoleMap
(
)
;
if
(
roleMapEntry
&
&
(
roleMapEntry
-
>
role
=
=
roles
:
:
GRAPHIC
|
|
roleMapEntry
-
>
role
=
=
roles
:
:
IMAGE_MAP
|
|
roleMapEntry
-
>
role
=
=
roles
:
:
SLIDER
|
|
roleMapEntry
-
>
role
=
=
roles
:
:
PROGRESSBAR
|
|
roleMapEntry
-
>
role
=
=
roles
:
:
SEPARATOR
)
)
{
return
false
;
}
return
true
;
}
uint32_t
Accessible
:
:
StartOffset
(
)
{
MOZ_ASSERT
(
IsLink
(
)
"
StartOffset
is
called
not
on
hyper
link
!
"
)
;
Accessible
*
parent
=
Parent
(
)
;
HyperTextAccessibleBase
*
hyperText
=
parent
?
parent
-
>
AsHyperTextBase
(
)
:
nullptr
;
return
hyperText
?
hyperText
-
>
GetChildOffset
(
this
)
:
0
;
}
