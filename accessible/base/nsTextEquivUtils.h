#
ifndef
_nsTextEquivUtils_H_
#
define
_nsTextEquivUtils_H_
#
include
"
mozilla
/
a11y
/
Accessible
.
h
"
#
include
"
mozilla
/
a11y
/
Role
.
h
"
class
nsIContent
;
namespace
mozilla
{
namespace
a11y
{
class
LocalAccessible
;
}
}
enum
ETextEquivRule
{
eNoNameRule
=
0x00
eNameFromSubtreeIfReqRule
=
0x01
eNameFromSubtreeRule
=
0x03
eNameFromValueRule
=
0x04
}
;
class
nsTextEquivUtils
{
public
:
typedef
mozilla
:
:
a11y
:
:
LocalAccessible
LocalAccessible
;
typedef
mozilla
:
:
a11y
:
:
Accessible
Accessible
;
static
inline
bool
HasNameRule
(
Accessible
*
aAccessible
ETextEquivRule
aRule
)
{
return
(
GetRoleRule
(
aAccessible
-
>
Role
(
)
)
&
aRule
)
=
=
aRule
;
}
static
nsresult
GetNameFromSubtree
(
const
LocalAccessible
*
aAccessible
nsAString
&
aName
)
;
static
void
GetTextEquivFromSubtree
(
const
Accessible
*
aAccessible
nsString
&
aTextEquiv
)
{
aTextEquiv
.
Truncate
(
)
;
AppendFromAccessibleChildren
(
aAccessible
&
aTextEquiv
)
;
aTextEquiv
.
CompressWhitespace
(
)
;
}
static
nsresult
GetTextEquivFromIDRefs
(
const
LocalAccessible
*
aAccessible
nsAtom
*
aIDRefsAttr
nsAString
&
aTextEquiv
)
;
static
nsresult
AppendTextEquivFromContent
(
const
LocalAccessible
*
aInitiatorAcc
nsIContent
*
aContent
nsAString
*
aString
)
;
static
nsresult
AppendTextEquivFromTextContent
(
nsIContent
*
aContent
nsAString
*
aString
)
;
static
nsresult
AppendFromDOMChildren
(
nsIContent
*
aContent
nsAString
*
aString
)
;
private
:
static
nsresult
AppendFromAccessibleChildren
(
const
Accessible
*
aAccessible
nsAString
*
aString
)
;
static
nsresult
AppendFromAccessible
(
Accessible
*
aAccessible
nsAString
*
aString
)
;
static
nsresult
AppendFromValue
(
Accessible
*
aAccessible
nsAString
*
aString
)
;
static
nsresult
AppendFromDOMNode
(
nsIContent
*
aContent
nsAString
*
aString
)
;
static
bool
AppendString
(
nsAString
*
aString
const
nsAString
&
aTextEquivalent
)
;
static
uint32_t
GetRoleRule
(
mozilla
:
:
a11y
:
:
roles
:
:
Role
aRole
)
;
static
bool
ShouldIncludeInSubtreeCalculation
(
Accessible
*
aAccessible
)
;
static
bool
IsWhitespaceLeaf
(
Accessible
*
aAccessible
)
;
}
;
#
endif
