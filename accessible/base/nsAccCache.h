#
ifndef
_nsAccCache_H_
#
define
_nsAccCache_H_
#
include
"
xpcAccessibleDocument
.
h
"
template
<
class
T
>
void
UnbindCacheEntriesFromDocument
(
nsRefPtrHashtable
<
nsPtrHashKey
<
const
void
>
T
>
&
aCache
)
{
for
(
auto
iter
=
aCache
.
Iter
(
)
;
!
iter
.
Done
(
)
;
iter
.
Next
(
)
)
{
T
*
accessible
=
iter
.
Data
(
)
;
MOZ_ASSERT
(
accessible
&
&
!
accessible
-
>
IsDefunct
(
)
)
;
accessible
-
>
Document
(
)
-
>
UnbindFromDocument
(
accessible
)
;
iter
.
Remove
(
)
;
}
}
template
<
class
T
>
static
void
ClearCache
(
nsRefPtrHashtable
<
nsPtrHashKey
<
const
void
>
T
>
&
aCache
)
{
for
(
auto
iter
=
aCache
.
Iter
(
)
;
!
iter
.
Done
(
)
;
iter
.
Next
(
)
)
{
T
*
accessible
=
iter
.
Data
(
)
;
MOZ_ASSERT
(
accessible
)
;
if
(
accessible
&
&
!
accessible
-
>
IsDefunct
(
)
)
{
accessible
-
>
Shutdown
(
)
;
}
iter
.
Remove
(
)
;
}
}
#
endif
