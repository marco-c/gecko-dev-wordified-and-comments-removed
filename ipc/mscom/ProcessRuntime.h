#
ifndef
mozilla_mscom_ProcessRuntime_h
#
define
mozilla_mscom_ProcessRuntime_h
#
include
"
mozilla
/
Attributes
.
h
"
#
if
defined
(
ACCESSIBILITY
)
&
&
defined
(
MOZILLA_INTERNAL_API
)
#
include
"
mozilla
/
mscom
/
ActivationContext
.
h
"
#
endif
#
include
"
mozilla
/
mscom
/
ApartmentRegion
.
h
"
#
include
"
mozilla
/
WindowsProcessMitigations
.
h
"
#
include
"
nsXULAppAPI
.
h
"
namespace
mozilla
{
namespace
mscom
{
class
MOZ_NON_TEMPORARY_CLASS
ProcessRuntime
final
{
#
if
!
defined
(
MOZILLA_INTERNAL_API
)
public
:
#
endif
enum
class
ProcessCategory
{
GeckoBrowserParent
Launcher
=
GeckoBrowserParent
GeckoChild
Service
}
;
explicit
ProcessRuntime
(
ProcessCategory
aProcessCategory
)
;
public
:
#
if
defined
(
MOZILLA_INTERNAL_API
)
ProcessRuntime
(
)
:
ProcessRuntime
(
XRE_GetProcessType
(
)
)
{
}
#
endif
explicit
ProcessRuntime
(
GeckoProcessType
aProcessType
)
;
~
ProcessRuntime
(
)
=
default
;
explicit
operator
bool
(
)
const
{
return
SUCCEEDED
(
mInitResult
)
;
}
HRESULT
GetHResult
(
)
const
{
return
mInitResult
;
}
ProcessRuntime
(
ProcessRuntime
&
)
=
delete
;
ProcessRuntime
(
ProcessRuntime
&
&
)
=
delete
;
ProcessRuntime
&
operator
=
(
ProcessRuntime
&
)
=
delete
;
ProcessRuntime
&
operator
=
(
ProcessRuntime
&
&
)
=
delete
;
static
DWORD
GetClientThreadId
(
)
;
private
:
void
InitInsideApartment
(
)
;
HRESULT
InitializeSecurity
(
)
;
static
COINIT
GetDesiredApartmentType
(
ProcessCategory
aProcessCategory
)
;
HRESULT
mInitResult
;
const
ProcessCategory
mProcessCategory
;
#
if
defined
(
ACCESSIBILITY
)
&
&
defined
(
MOZILLA_INTERNAL_API
)
ActivationContextRegion
mActCtxRgn
;
#
endif
ApartmentRegion
mAptRegion
;
}
;
}
}
#
endif
