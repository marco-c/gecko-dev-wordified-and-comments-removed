#
ifndef
mozilla_mscom_MainThreadInvoker_h
#
define
mozilla_mscom_MainThreadInvoker_h
#
include
"
mozilla
/
AlreadyAddRefed
.
h
"
#
include
"
mozilla
/
StaticPtr
.
h
"
#
include
<
windows
.
h
>
class
nsIRunnable
;
namespace
mozilla
{
namespace
mscom
{
class
MainThreadInvoker
{
public
:
MainThreadInvoker
(
)
;
~
MainThreadInvoker
(
)
;
bool
WaitForCompletion
(
DWORD
aTimeout
=
INFINITE
)
;
bool
Invoke
(
already_AddRefed
<
nsIRunnable
>
&
&
aRunnable
DWORD
aTimeout
=
INFINITE
)
;
HANDLE
GetTargetThread
(
)
const
{
return
sMainThread
;
}
private
:
static
bool
InitStatics
(
)
;
static
VOID
CALLBACK
MainThreadAPC
(
ULONG_PTR
aParam
)
;
HANDLE
mDoneEvent
;
static
HANDLE
sMainThread
;
static
StaticRefPtr
<
nsIRunnable
>
sAlertRunnable
;
}
;
}
}
#
endif
