#
ifndef
mozilla_mscom_Utils_h
#
define
mozilla_mscom_Utils_h
#
if
defined
(
MOZILLA_INTERNAL_API
)
#
include
"
nsString
.
h
"
#
endif
#
include
"
mozilla
/
Attributes
.
h
"
#
include
<
guiddef
.
h
>
struct
IStream
;
struct
IUnknown
;
namespace
mozilla
{
namespace
mscom
{
bool
IsCurrentThreadMTA
(
)
;
bool
IsProxy
(
IUnknown
*
aUnknown
)
;
bool
IsValidGUID
(
REFGUID
aCheckGuid
)
;
uintptr_t
GetContainingModuleHandle
(
)
;
uint32_t
CreateStream
(
const
uint8_t
*
aBuf
const
uint32_t
aBufLen
IStream
*
*
aOutStream
)
;
uint32_t
CopySerializedProxy
(
IStream
*
aInStream
IStream
*
*
aOutStream
)
;
#
if
defined
(
MOZILLA_INTERNAL_API
)
void
GUIDToString
(
REFGUID
aGuid
nsAString
&
aOutString
)
;
#
endif
#
if
defined
(
ACCESSIBILITY
)
bool
IsVtableIndexFromParentInterface
(
REFIID
aInterface
unsigned
long
aVtableIndex
)
;
#
if
defined
(
MOZILLA_INTERNAL_API
)
bool
IsCallerExternalProcess
(
)
;
bool
IsInterfaceEqualToOrInheritedFrom
(
REFIID
aInterface
REFIID
aFrom
unsigned
long
aVtableIndexHint
)
;
#
endif
#
endif
template
<
typename
CondFnT
typename
ExeFnT
>
class
MOZ_RAII
ExecuteWhen
final
{
public
:
ExecuteWhen
(
CondFnT
&
aCondFn
ExeFnT
&
aExeFn
)
:
mCondFn
(
aCondFn
)
mExeFn
(
aExeFn
)
{
}
~
ExecuteWhen
(
)
{
if
(
mCondFn
(
)
)
{
mExeFn
(
)
;
}
}
ExecuteWhen
(
const
ExecuteWhen
&
)
=
delete
;
ExecuteWhen
(
ExecuteWhen
&
&
)
=
delete
;
ExecuteWhen
&
operator
=
(
const
ExecuteWhen
&
)
=
delete
;
ExecuteWhen
&
operator
=
(
ExecuteWhen
&
&
)
=
delete
;
private
:
CondFnT
&
mCondFn
;
ExeFnT
&
mExeFn
;
}
;
}
}
#
endif
