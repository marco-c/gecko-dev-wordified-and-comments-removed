#
ifndef
mozilla_mscom_MainThreadClientInfo
#
define
mozilla_mscom_MainThreadClientInfo
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
nsString
.
h
"
#
include
<
objidl
.
h
>
namespace
mozilla
{
namespace
mscom
{
class
MainThreadClientInfo
final
:
public
IMessageFilter
{
public
:
static
HRESULT
Create
(
MainThreadClientInfo
*
*
aOutObj
)
;
DWORD
GetLastRemoteCallThreadId
(
)
const
;
void
Detach
(
)
;
STDMETHODIMP
QueryInterface
(
REFIID
aIid
void
*
*
aOutInterface
)
override
;
STDMETHODIMP_
(
ULONG
)
AddRef
(
)
override
;
STDMETHODIMP_
(
ULONG
)
Release
(
)
override
;
STDMETHODIMP_
(
DWORD
)
HandleInComingCall
(
DWORD
aCallType
HTASK
aCallerTid
DWORD
aTickCount
LPINTERFACEINFO
aInterfaceInfo
)
override
;
STDMETHODIMP_
(
DWORD
)
RetryRejectedCall
(
HTASK
aCalleeTid
DWORD
aTickCount
DWORD
aRejectType
)
override
;
STDMETHODIMP_
(
DWORD
)
MessagePending
(
HTASK
aCalleeTid
DWORD
aTickCount
DWORD
aPendingType
)
override
;
private
:
MainThreadClientInfo
(
)
;
~
MainThreadClientInfo
(
)
=
default
;
private
:
ULONG
mRefCnt
;
RefPtr
<
IMessageFilter
>
mPrevFilter
;
DWORD
mLastRemoteCallTid
;
}
;
}
}
#
endif
