#
ifndef
mozilla_ipc_SharedMemoryBasic_android_h
#
define
mozilla_ipc_SharedMemoryBasic_android_h
#
include
"
base
/
file_descriptor_posix
.
h
"
#
include
"
SharedMemory
.
h
"
namespace
mozilla
{
namespace
ipc
{
class
SharedMemoryBasic
final
:
public
SharedMemoryCommon
<
base
:
:
FileDescriptor
>
{
public
:
SharedMemoryBasic
(
)
;
virtual
bool
SetHandle
(
const
Handle
&
aHandle
)
override
;
virtual
bool
Create
(
size_t
aNbytes
)
override
;
virtual
bool
Map
(
size_t
nBytes
)
override
;
virtual
void
CloseHandle
(
)
override
;
virtual
void
*
memory
(
)
const
override
{
return
mMemory
;
}
virtual
SharedMemoryType
Type
(
)
const
override
{
return
TYPE_BASIC
;
}
static
Handle
NULLHandle
(
)
{
return
Handle
(
)
;
}
virtual
bool
IsHandleValid
(
const
Handle
&
aHandle
)
const
override
{
return
aHandle
.
fd
>
=
0
;
}
virtual
bool
ShareToProcess
(
base
:
:
ProcessId
aProcessId
Handle
*
aNewHandle
)
override
;
private
:
~
SharedMemoryBasic
(
)
;
void
Unmap
(
)
;
int
mShmFd
;
void
*
mMemory
;
}
;
}
}
#
endif
