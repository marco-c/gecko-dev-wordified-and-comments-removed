#
ifndef
mozilla_ipc_backgroundutils_h__
#
define
mozilla_ipc_backgroundutils_h__
#
include
"
ipc
/
IPCMessageUtils
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
BasePrincipal
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nscore
.
h
"
class
nsILoadInfo
;
class
nsIPrincipal
;
namespace
IPC
{
namespace
detail
{
template
<
class
ParamType
>
struct
OriginAttributesParamTraits
{
typedef
ParamType
paramType
;
static
void
Write
(
Message
*
aMsg
const
paramType
&
aParam
)
{
nsAutoCString
suffix
;
aParam
.
CreateSuffix
(
suffix
)
;
WriteParam
(
aMsg
suffix
)
;
}
static
bool
Read
(
const
Message
*
aMsg
void
*
*
aIter
paramType
*
aResult
)
{
nsAutoCString
suffix
;
return
ReadParam
(
aMsg
aIter
&
suffix
)
&
&
aResult
-
>
PopulateFromSuffix
(
suffix
)
;
}
}
;
}
template
<
>
struct
ParamTraits
<
mozilla
:
:
PrincipalOriginAttributes
>
:
public
detail
:
:
OriginAttributesParamTraits
<
mozilla
:
:
PrincipalOriginAttributes
>
{
}
;
template
<
>
struct
ParamTraits
<
mozilla
:
:
DocShellOriginAttributes
>
:
public
detail
:
:
OriginAttributesParamTraits
<
mozilla
:
:
DocShellOriginAttributes
>
{
}
;
template
<
>
struct
ParamTraits
<
mozilla
:
:
NeckoOriginAttributes
>
:
public
detail
:
:
OriginAttributesParamTraits
<
mozilla
:
:
NeckoOriginAttributes
>
{
}
;
template
<
>
struct
ParamTraits
<
mozilla
:
:
GenericOriginAttributes
>
:
public
detail
:
:
OriginAttributesParamTraits
<
mozilla
:
:
GenericOriginAttributes
>
{
}
;
}
namespace
mozilla
{
namespace
net
{
class
OptionalLoadInfoArgs
;
}
using
namespace
mozilla
:
:
net
;
namespace
ipc
{
class
PrincipalInfo
;
already_AddRefed
<
nsIPrincipal
>
PrincipalInfoToPrincipal
(
const
PrincipalInfo
&
aPrincipalInfo
nsresult
*
aOptionalResult
=
nullptr
)
;
nsresult
PrincipalToPrincipalInfo
(
nsIPrincipal
*
aPrincipal
PrincipalInfo
*
aPrincipalInfo
)
;
nsresult
LoadInfoToLoadInfoArgs
(
nsILoadInfo
*
aLoadInfo
OptionalLoadInfoArgs
*
outOptionalLoadInfoArgs
)
;
nsresult
LoadInfoArgsToLoadInfo
(
const
OptionalLoadInfoArgs
&
aOptionalLoadInfoArgs
nsILoadInfo
*
*
outLoadInfo
)
;
}
}
#
endif
