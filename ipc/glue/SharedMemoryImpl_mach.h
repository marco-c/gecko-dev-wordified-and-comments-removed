#
ifndef
mozilla_ipc_SharedMemoryImpl_mach_h
#
define
mozilla_ipc_SharedMemoryImpl_mach_h
#
include
"
mozilla
/
UniquePtrExtensions
.
h
"
#
include
<
mach
/
port
.
h
>
namespace
{
enum
Rights
{
RightsNone
=
0
RightsRead
=
1
<
<
0
RightsWrite
=
1
<
<
1
}
;
}
namespace
mozilla
:
:
ipc
{
class
SharedMemoryImpl
{
public
:
using
Handle
=
mozilla
:
:
UniqueMachSendRight
;
enum
OpenRights
{
RightsReadOnly
=
RightsRead
RightsReadWrite
=
RightsRead
|
RightsWrite
}
;
Handle
CloneHandle
(
)
;
Handle
TakeHandle
(
)
;
bool
IsHandleValid
(
const
Handle
&
aHandle
)
const
;
bool
SetHandle
(
Handle
aHandle
OpenRights
aRights
)
;
static
Handle
NULLHandle
(
)
;
static
void
*
FindFreeAddressSpace
(
size_t
size
)
;
protected
:
SharedMemoryImpl
(
)
;
~
SharedMemoryImpl
(
)
{
}
bool
CreateImpl
(
size_t
size
)
;
bool
MapImpl
(
size_t
nBytes
void
*
fixedAddress
)
;
void
UnmapImpl
(
size_t
mappedSize
)
;
void
*
MemoryImpl
(
)
const
;
private
:
mozilla
:
:
UniqueMachSendRight
mPort
;
void
*
mMemory
;
OpenRights
mOpenRights
;
}
;
}
#
endif
