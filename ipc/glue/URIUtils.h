#
ifndef
mozilla_ipc_URIUtils_h
#
define
mozilla_ipc_URIUtils_h
#
include
"
mozilla
/
ipc
/
URIParams
.
h
"
#
include
"
mozilla
/
ipc
/
IPDLParamTraits
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIURI
.
h
"
namespace
mozilla
{
namespace
ipc
{
void
SerializeURI
(
nsIURI
*
aURI
URIParams
&
aParams
)
;
void
SerializeURI
(
nsIURI
*
aURI
OptionalURIParams
&
aParams
)
;
already_AddRefed
<
nsIURI
>
DeserializeURI
(
const
URIParams
&
aParams
)
;
already_AddRefed
<
nsIURI
>
DeserializeURI
(
const
OptionalURIParams
&
aParams
)
;
template
<
>
struct
IPDLParamTraits
<
nsIURI
>
{
static
void
Write
(
IPC
:
:
Message
*
aMsg
IProtocol
*
aActor
nsIURI
*
aParam
)
{
OptionalURIParams
params
;
SerializeURI
(
aParam
params
)
;
WriteIPDLParam
(
aMsg
aActor
params
)
;
}
static
bool
Read
(
IPC
:
:
Message
*
aMsg
PickleIterator
*
aIter
IProtocol
*
aActor
RefPtr
<
nsIURI
>
*
aResult
)
{
OptionalURIParams
params
;
if
(
!
ReadIPDLParam
(
aMsg
aIter
aActor
&
params
)
)
{
return
false
;
}
*
aResult
=
DeserializeURI
(
params
)
;
return
true
;
}
}
;
}
}
#
endif
