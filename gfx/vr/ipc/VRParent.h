#
ifndef
GFX_VR_PARENT_H
#
define
GFX_VR_PARENT_H
#
include
"
mozilla
/
gfx
/
PVRParent
.
h
"
#
include
"
VRGPUParent
.
h
"
namespace
mozilla
{
namespace
gfx
{
class
VRService
;
class
VRSystemManagerExternal
;
class
VRParent
final
:
public
PVRParent
{
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
VRParent
)
;
friend
class
PVRParent
;
public
:
explicit
VRParent
(
)
;
bool
Init
(
base
:
:
ProcessId
aParentPid
const
char
*
aParentBuildID
MessageLoop
*
aIOLoop
UniquePtr
<
IPC
:
:
Channel
>
aChannel
)
;
virtual
void
ActorDestroy
(
ActorDestroyReason
aWhy
)
override
;
bool
GetOpenVRControllerActionPath
(
nsCString
*
aPath
)
;
bool
GetOpenVRControllerManifestPath
(
VRControllerType
aType
nsCString
*
aPath
)
;
protected
:
~
VRParent
(
)
=
default
;
mozilla
:
:
ipc
:
:
IPCResult
RecvNewGPUVRManager
(
Endpoint
<
PVRGPUParent
>
&
&
aEndpoint
)
;
mozilla
:
:
ipc
:
:
IPCResult
RecvInit
(
nsTArray
<
GfxVarUpdate
>
&
&
vars
const
DevicePrefs
&
devicePrefs
)
;
mozilla
:
:
ipc
:
:
IPCResult
RecvNotifyVsync
(
const
TimeStamp
&
vsyncTimestamp
)
;
mozilla
:
:
ipc
:
:
IPCResult
RecvUpdateVar
(
const
GfxVarUpdate
&
pref
)
;
mozilla
:
:
ipc
:
:
IPCResult
RecvPreferenceUpdate
(
const
Pref
&
pref
)
;
mozilla
:
:
ipc
:
:
IPCResult
RecvOpenVRControllerActionPathToVR
(
const
nsCString
&
aPath
)
;
mozilla
:
:
ipc
:
:
IPCResult
RecvOpenVRControllerManifestPathToVR
(
const
VRControllerType
&
aType
const
nsCString
&
aPath
)
;
mozilla
:
:
ipc
:
:
IPCResult
RecvRequestMemoryReport
(
const
uint32_t
&
generation
const
bool
&
anonymize
const
bool
&
minimizeMemoryUsage
const
Maybe
<
ipc
:
:
FileDescriptor
>
&
DMDFile
const
RequestMemoryReportResolver
&
aResolver
)
;
private
:
nsCString
mOpenVRControllerAction
;
nsTHashMap
<
nsUint32HashKey
nsCString
>
mOpenVRControllerManifest
;
RefPtr
<
VRGPUParent
>
mVRGPUParent
;
DISALLOW_COPY_AND_ASSIGN
(
VRParent
)
;
}
;
}
}
#
endif
