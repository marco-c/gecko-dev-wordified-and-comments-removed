#
include
"
compiler
/
translator
/
tree_ops
/
RemoveInvariantDeclaration
.
h
"
#
include
"
compiler
/
translator
/
tree_util
/
IntermTraverse
.
h
"
namespace
sh
{
namespace
{
class
RemoveInvariantDeclarationTraverser
:
public
TIntermTraverser
{
public
:
RemoveInvariantDeclarationTraverser
(
)
:
TIntermTraverser
(
true
false
false
)
{
}
private
:
bool
visitGlobalQualifierDeclaration
(
Visit
visit
TIntermGlobalQualifierDeclaration
*
node
)
override
{
if
(
node
-
>
isInvariant
(
)
)
{
TIntermSequence
emptyReplacement
;
mMultiReplacements
.
emplace_back
(
getParentNode
(
)
-
>
getAsBlock
(
)
node
std
:
:
move
(
emptyReplacement
)
)
;
}
return
false
;
}
}
;
}
bool
RemoveInvariantDeclaration
(
TCompiler
*
compiler
TIntermNode
*
root
)
{
RemoveInvariantDeclarationTraverser
traverser
;
root
-
>
traverse
(
&
traverser
)
;
return
traverser
.
updateTree
(
compiler
root
)
;
}
}
