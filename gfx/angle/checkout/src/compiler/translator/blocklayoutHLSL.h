#
ifndef
COMMON_BLOCKLAYOUTHLSL_H_
#
define
COMMON_BLOCKLAYOUTHLSL_H_
#
include
<
cstddef
>
#
include
<
vector
>
#
include
<
GLSLANG
/
ShaderLang
.
h
>
#
include
"
angle_gl
.
h
"
#
include
"
blocklayout
.
h
"
namespace
sh
{
class
HLSLBlockEncoder
:
public
BlockLayoutEncoder
{
public
:
enum
HLSLBlockEncoderStrategy
{
ENCODE_PACKED
ENCODE_LOOSE
}
;
HLSLBlockEncoder
(
HLSLBlockEncoderStrategy
strategy
bool
transposeMatrices
)
;
void
enterAggregateType
(
const
ShaderVariable
&
structVar
)
override
;
void
exitAggregateType
(
const
ShaderVariable
&
structVar
)
override
;
void
skipRegisters
(
unsigned
int
numRegisters
)
;
bool
isPacked
(
)
const
{
return
mEncoderStrategy
=
=
ENCODE_PACKED
;
}
static
HLSLBlockEncoderStrategy
GetStrategyFor
(
ShShaderOutput
outputType
)
;
protected
:
void
getBlockLayoutInfo
(
GLenum
type
const
std
:
:
vector
<
unsigned
int
>
&
arraySizes
bool
isRowMajorMatrix
int
*
arrayStrideOut
int
*
matrixStrideOut
)
override
;
void
advanceOffset
(
GLenum
type
const
std
:
:
vector
<
unsigned
int
>
&
arraySizes
bool
isRowMajorMatrix
int
arrayStride
int
matrixStride
)
override
;
HLSLBlockEncoderStrategy
mEncoderStrategy
;
bool
mTransposeMatrices
;
}
;
unsigned
int
HLSLVariableRegisterCount
(
const
Uniform
&
variable
ShShaderOutput
outputType
)
;
}
#
endif
