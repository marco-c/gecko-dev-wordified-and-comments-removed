#
include
"
compiler
/
translator
/
FindSymbolNode
.
h
"
#
include
"
compiler
/
translator
/
IntermTraverse
.
h
"
namespace
sh
{
namespace
{
class
SymbolFinder
:
public
TIntermTraverser
{
public
:
SymbolFinder
(
const
TString
&
symbolName
TBasicType
basicType
)
:
TIntermTraverser
(
true
false
false
)
mSymbolName
(
symbolName
)
mNodeFound
(
nullptr
)
mBasicType
(
basicType
)
{
}
void
visitSymbol
(
TIntermSymbol
*
node
)
{
if
(
node
-
>
getBasicType
(
)
=
=
mBasicType
&
&
node
-
>
getSymbol
(
)
=
=
mSymbolName
)
{
mNodeFound
=
node
;
}
}
bool
isFound
(
)
const
{
return
mNodeFound
!
=
nullptr
;
}
const
TIntermSymbol
*
getNode
(
)
const
{
return
mNodeFound
;
}
private
:
TString
mSymbolName
;
TIntermSymbol
*
mNodeFound
;
TBasicType
mBasicType
;
}
;
}
const
TIntermSymbol
*
FindSymbolNode
(
TIntermNode
*
root
const
TString
&
symbolName
TBasicType
basicType
)
{
SymbolFinder
finder
(
symbolName
basicType
)
;
root
-
>
traverse
(
&
finder
)
;
return
finder
.
getNode
(
)
;
}
}
