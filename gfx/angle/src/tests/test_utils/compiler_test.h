#
ifndef
TESTS_TEST_UTILS_COMPILER_TEST_H_
#
define
TESTS_TEST_UTILS_COMPILER_TEST_H_
#
include
<
map
>
#
include
"
gtest
/
gtest
.
h
"
#
include
"
angle_gl
.
h
"
#
include
"
compiler
/
translator
/
TranslatorESSL
.
h
"
#
include
"
GLSLANG
/
ShaderLang
.
h
"
bool
compileTestShader
(
GLenum
type
ShShaderSpec
spec
ShShaderOutput
output
const
std
:
:
string
&
shaderString
ShBuiltInResources
*
resources
ShCompileOptions
compileOptions
std
:
:
string
*
translatedCode
std
:
:
string
*
infoLog
)
;
bool
compileTestShader
(
GLenum
type
ShShaderSpec
spec
ShShaderOutput
output
const
std
:
:
string
&
shaderString
ShCompileOptions
compileOptions
std
:
:
string
*
translatedCode
std
:
:
string
*
infoLog
)
;
class
MatchOutputCodeTest
:
public
testing
:
:
Test
{
protected
:
MatchOutputCodeTest
(
GLenum
shaderType
ShCompileOptions
defaultCompileOptions
ShShaderOutput
outputType
)
;
void
addOutputType
(
const
ShShaderOutput
outputType
)
;
ShBuiltInResources
*
getResources
(
)
;
void
compile
(
const
std
:
:
string
&
shaderString
)
;
void
compile
(
const
std
:
:
string
&
shaderString
const
ShCompileOptions
compileOptions
)
;
bool
foundInESSLCode
(
const
char
*
stringToFind
)
const
{
return
foundInCode
(
SH_ESSL_OUTPUT
stringToFind
)
;
}
bool
foundInGLSLCode
(
const
char
*
stringToFind
)
const
{
return
foundInCode
(
SH_GLSL_COMPATIBILITY_OUTPUT
stringToFind
)
;
}
bool
foundInCode
(
ShShaderOutput
output
const
char
*
stringToFind
)
const
;
bool
foundInCode
(
ShShaderOutput
output
const
char
*
stringToFind
const
int
expectedOccurrences
)
const
;
bool
foundInCode
(
const
char
*
stringToFind
)
const
;
bool
foundInCode
(
const
char
*
stringToFind
const
int
expectedOccurrences
)
const
;
bool
notFoundInCode
(
const
char
*
stringToFind
)
const
;
private
:
bool
compileWithSettings
(
ShShaderOutput
output
const
std
:
:
string
&
shaderString
ShCompileOptions
compileOptions
std
:
:
string
*
translatedCode
std
:
:
string
*
infoLog
)
;
GLenum
mShaderType
;
ShCompileOptions
mDefaultCompileOptions
;
ShBuiltInResources
mResources
;
std
:
:
map
<
ShShaderOutput
std
:
:
string
>
mOutputCode
;
}
;
const
TIntermSymbol
*
FindSymbolNode
(
TIntermNode
*
root
const
TString
&
symbolName
TBasicType
basicType
)
;
#
endif
