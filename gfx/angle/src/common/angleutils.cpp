#
include
"
common
/
angleutils
.
h
"
#
include
"
common
/
debug
.
h
"
#
include
<
stdio
.
h
>
#
include
<
limits
>
#
include
<
vector
>
namespace
angle
{
const
uintptr_t
DirtyPointer
=
std
:
:
numeric_limits
<
uintptr_t
>
:
:
max
(
)
;
}
size_t
FormatStringIntoVector
(
const
char
*
fmt
va_list
vararg
std
:
:
vector
<
char
>
&
outBuffer
)
{
va_list
varargCopy
;
va_copy
(
varargCopy
vararg
)
;
int
len
=
vsnprintf
(
&
(
outBuffer
.
front
(
)
)
outBuffer
.
size
(
)
fmt
varargCopy
)
;
va_end
(
varargCopy
)
;
if
(
len
<
0
|
|
static_cast
<
size_t
>
(
len
)
>
=
outBuffer
.
size
(
)
)
{
len
=
vsnprintf
(
nullptr
0
fmt
vararg
)
;
outBuffer
.
resize
(
len
+
1
)
;
va_copy
(
varargCopy
vararg
)
;
len
=
vsnprintf
(
&
(
outBuffer
.
front
(
)
)
outBuffer
.
size
(
)
fmt
varargCopy
)
;
va_end
(
varargCopy
)
;
}
ASSERT
(
len
>
=
0
)
;
return
static_cast
<
size_t
>
(
len
)
;
}
