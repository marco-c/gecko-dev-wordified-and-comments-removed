#
ifndef
LIBANGLE_RENDERER_CONTEXTIMPL_H_
#
define
LIBANGLE_RENDERER_CONTEXTIMPL_H_
#
include
<
vector
>
#
include
"
common
/
angleutils
.
h
"
#
include
"
libANGLE
/
ContextState
.
h
"
#
include
"
libANGLE
/
renderer
/
GLImplFactory
.
h
"
namespace
gl
{
class
MemoryProgramCache
;
class
Path
;
struct
Workarounds
;
}
namespace
rx
{
class
ContextImpl
:
public
GLImplFactory
{
public
:
ContextImpl
(
const
gl
:
:
ContextState
&
state
)
;
virtual
~
ContextImpl
(
)
;
virtual
gl
:
:
Error
initialize
(
)
=
0
;
virtual
gl
:
:
Error
flush
(
)
=
0
;
virtual
gl
:
:
Error
finish
(
)
=
0
;
virtual
gl
:
:
Error
drawArrays
(
const
gl
:
:
Context
*
context
GLenum
mode
GLint
first
GLsizei
count
)
=
0
;
virtual
gl
:
:
Error
drawArraysInstanced
(
const
gl
:
:
Context
*
context
GLenum
mode
GLint
first
GLsizei
count
GLsizei
instanceCount
)
=
0
;
virtual
gl
:
:
Error
drawElements
(
const
gl
:
:
Context
*
context
GLenum
mode
GLsizei
count
GLenum
type
const
void
*
indices
)
=
0
;
virtual
gl
:
:
Error
drawElementsInstanced
(
const
gl
:
:
Context
*
context
GLenum
mode
GLsizei
count
GLenum
type
const
void
*
indices
GLsizei
instances
)
=
0
;
virtual
gl
:
:
Error
drawRangeElements
(
const
gl
:
:
Context
*
context
GLenum
mode
GLuint
start
GLuint
end
GLsizei
count
GLenum
type
const
void
*
indices
)
=
0
;
virtual
gl
:
:
Error
drawArraysIndirect
(
const
gl
:
:
Context
*
context
GLenum
mode
const
void
*
indirect
)
=
0
;
virtual
gl
:
:
Error
drawElementsIndirect
(
const
gl
:
:
Context
*
context
GLenum
mode
GLenum
type
const
void
*
indirect
)
=
0
;
virtual
void
stencilFillPath
(
const
gl
:
:
Path
*
path
GLenum
fillMode
GLuint
mask
)
;
virtual
void
stencilStrokePath
(
const
gl
:
:
Path
*
path
GLint
reference
GLuint
mask
)
;
virtual
void
coverFillPath
(
const
gl
:
:
Path
*
path
GLenum
coverMode
)
;
virtual
void
coverStrokePath
(
const
gl
:
:
Path
*
path
GLenum
coverMode
)
;
virtual
void
stencilThenCoverFillPath
(
const
gl
:
:
Path
*
path
GLenum
fillMode
GLuint
mask
GLenum
coverMode
)
;
virtual
void
stencilThenCoverStrokePath
(
const
gl
:
:
Path
*
path
GLint
reference
GLuint
mask
GLenum
coverMode
)
;
virtual
void
coverFillPathInstanced
(
const
std
:
:
vector
<
gl
:
:
Path
*
>
&
paths
GLenum
coverMode
GLenum
transformType
const
GLfloat
*
transformValues
)
;
virtual
void
coverStrokePathInstanced
(
const
std
:
:
vector
<
gl
:
:
Path
*
>
&
paths
GLenum
coverMode
GLenum
transformType
const
GLfloat
*
transformValues
)
;
virtual
void
stencilFillPathInstanced
(
const
std
:
:
vector
<
gl
:
:
Path
*
>
&
paths
GLenum
fillMode
GLuint
mask
GLenum
transformType
const
GLfloat
*
transformValues
)
;
virtual
void
stencilStrokePathInstanced
(
const
std
:
:
vector
<
gl
:
:
Path
*
>
&
paths
GLint
reference
GLuint
mask
GLenum
transformType
const
GLfloat
*
transformValues
)
;
virtual
void
stencilThenCoverFillPathInstanced
(
const
std
:
:
vector
<
gl
:
:
Path
*
>
&
paths
GLenum
coverMode
GLenum
fillMode
GLuint
mask
GLenum
transformType
const
GLfloat
*
transformValues
)
;
virtual
void
stencilThenCoverStrokePathInstanced
(
const
std
:
:
vector
<
gl
:
:
Path
*
>
&
paths
GLenum
coverMode
GLint
reference
GLuint
mask
GLenum
transformType
const
GLfloat
*
transformValues
)
;
virtual
GLenum
getResetStatus
(
)
=
0
;
virtual
std
:
:
string
getVendorString
(
)
const
=
0
;
virtual
std
:
:
string
getRendererDescription
(
)
const
=
0
;
virtual
void
insertEventMarker
(
GLsizei
length
const
char
*
marker
)
=
0
;
virtual
void
pushGroupMarker
(
GLsizei
length
const
char
*
marker
)
=
0
;
virtual
void
popGroupMarker
(
)
=
0
;
virtual
void
syncState
(
const
gl
:
:
Context
*
context
const
gl
:
:
State
:
:
DirtyBits
&
dirtyBits
)
=
0
;
virtual
GLint
getGPUDisjoint
(
)
=
0
;
virtual
GLint64
getTimestamp
(
)
=
0
;
virtual
void
onMakeCurrent
(
const
gl
:
:
Context
*
context
)
=
0
;
virtual
const
gl
:
:
Caps
&
getNativeCaps
(
)
const
=
0
;
virtual
const
gl
:
:
TextureCapsMap
&
getNativeTextureCaps
(
)
const
=
0
;
virtual
const
gl
:
:
Extensions
&
getNativeExtensions
(
)
const
=
0
;
virtual
const
gl
:
:
Limitations
&
getNativeLimitations
(
)
const
=
0
;
virtual
void
applyNativeWorkarounds
(
gl
:
:
Workarounds
*
workarounds
)
const
{
}
virtual
gl
:
:
Error
dispatchCompute
(
const
gl
:
:
Context
*
context
GLuint
numGroupsX
GLuint
numGroupsY
GLuint
numGroupsZ
)
=
0
;
const
gl
:
:
ContextState
&
getContextState
(
)
{
return
mState
;
}
int
getClientMajorVersion
(
)
const
{
return
mState
.
getClientMajorVersion
(
)
;
}
int
getClientMinorVersion
(
)
const
{
return
mState
.
getClientMinorVersion
(
)
;
}
const
gl
:
:
State
&
getGLState
(
)
const
{
return
mState
.
getState
(
)
;
}
const
gl
:
:
Caps
&
getCaps
(
)
const
{
return
mState
.
getCaps
(
)
;
}
const
gl
:
:
TextureCapsMap
&
getTextureCaps
(
)
const
{
return
mState
.
getTextureCaps
(
)
;
}
const
gl
:
:
Extensions
&
getExtensions
(
)
const
{
return
mState
.
getExtensions
(
)
;
}
const
gl
:
:
Limitations
&
getLimitations
(
)
const
{
return
mState
.
getLimitations
(
)
;
}
void
setMemoryProgramCache
(
gl
:
:
MemoryProgramCache
*
memoryProgramCache
)
;
protected
:
const
gl
:
:
ContextState
&
mState
;
gl
:
:
MemoryProgramCache
*
mMemoryProgramCache
;
}
;
}
#
endif
