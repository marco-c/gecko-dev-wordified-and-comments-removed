#
ifndef
GLCONTEXTCGL_H_
#
define
GLCONTEXTCGL_H_
#
include
"
GLContext
.
h
"
#
include
"
OpenGL
/
OpenGL
.
h
"
#
ifdef
__OBJC__
#
include
<
AppKit
/
NSOpenGL
.
h
>
#
else
typedef
void
NSOpenGLContext
;
#
endif
#
include
<
CoreGraphics
/
CGDisplayConfiguration
.
h
>
#
include
"
mozilla
/
Atomics
.
h
"
class
nsIWidget
;
namespace
mozilla
{
namespace
gl
{
class
GLContextCGL
:
public
GLContext
{
friend
class
GLContextProviderCGL
;
NSOpenGLContext
*
mContext
;
mozilla
:
:
Atomic
<
bool
>
mActiveGPUSwitchMayHaveOccurred
;
public
:
MOZ_DECLARE_REFCOUNTED_VIRTUAL_TYPENAME
(
GLContextCGL
override
)
GLContextCGL
(
const
GLContextDesc
&
NSOpenGLContext
*
context
)
;
~
GLContextCGL
(
)
;
virtual
GLContextType
GetContextType
(
)
const
override
{
return
GLContextType
:
:
CGL
;
}
static
GLContextCGL
*
Cast
(
GLContext
*
gl
)
{
MOZ_ASSERT
(
gl
-
>
GetContextType
(
)
=
=
GLContextType
:
:
CGL
)
;
return
static_cast
<
GLContextCGL
*
>
(
gl
)
;
}
NSOpenGLContext
*
GetNSOpenGLContext
(
)
const
{
return
mContext
;
}
CGLContextObj
GetCGLContext
(
)
const
;
static
void
DisplayReconfigurationCallback
(
CGDirectDisplayID
aDisplay
CGDisplayChangeSummaryFlags
aFlags
void
*
aUserInfo
)
;
void
MigrateToActiveGPU
(
)
;
virtual
bool
MakeCurrentImpl
(
)
const
override
;
virtual
bool
IsCurrentImpl
(
)
const
override
;
virtual
GLenum
GetPreferredARGB32Format
(
)
const
override
;
virtual
bool
SwapBuffers
(
)
override
;
virtual
void
GetWSIInfo
(
nsCString
*
const
out
)
const
override
;
Maybe
<
SymbolLoader
>
GetSymbolLoader
(
)
const
override
;
}
;
}
}
#
endif
