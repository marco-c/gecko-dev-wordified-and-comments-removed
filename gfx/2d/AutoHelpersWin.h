#
ifndef
mozilla_gfx_AutoHelpersWin_h
#
define
mozilla_gfx_AutoHelpersWin_h
#
include
<
windows
.
h
>
namespace
mozilla
{
namespace
gfx
{
class
AutoDC
{
public
:
AutoDC
(
)
{
mDC
=
:
:
GetDC
(
nullptr
)
;
}
~
AutoDC
(
)
{
:
:
ReleaseDC
(
nullptr
mDC
)
;
}
HDC
GetDC
(
)
{
return
mDC
;
}
private
:
HDC
mDC
;
}
;
class
AutoSelectFont
{
public
:
AutoSelectFont
(
HDC
aDC
LOGFONTW
*
aLogFont
)
:
mOwnsFont
(
false
)
{
mFont
=
:
:
CreateFontIndirectW
(
aLogFont
)
;
if
(
mFont
)
{
mOwnsFont
=
true
;
mDC
=
aDC
;
mOldFont
=
(
HFONT
)
:
:
SelectObject
(
aDC
mFont
)
;
}
else
{
mOldFont
=
nullptr
;
}
}
AutoSelectFont
(
HDC
aDC
HFONT
aFont
)
:
mOwnsFont
(
false
)
{
mDC
=
aDC
;
mFont
=
aFont
;
mOldFont
=
(
HFONT
)
:
:
SelectObject
(
aDC
aFont
)
;
}
~
AutoSelectFont
(
)
{
if
(
mOldFont
)
{
:
:
SelectObject
(
mDC
mOldFont
)
;
if
(
mOwnsFont
)
{
:
:
DeleteObject
(
mFont
)
;
}
}
}
bool
IsValid
(
)
const
{
return
mFont
!
=
nullptr
;
}
HFONT
GetFont
(
)
const
{
return
mFont
;
}
private
:
HDC
mDC
;
HFONT
mFont
;
HFONT
mOldFont
;
bool
mOwnsFont
;
}
;
}
}
#
endif
