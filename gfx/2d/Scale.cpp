#
include
"
Scale
.
h
"
#
ifdef
USE_SKIA
#
include
"
HelpersSkia
.
h
"
#
include
"
skia
/
include
/
core
/
SkBitmap
.
h
"
#
include
"
image_operations
.
h
"
#
endif
namespace
mozilla
{
namespace
gfx
{
bool
Scale
(
uint8_t
*
srcData
int32_t
srcWidth
int32_t
srcHeight
int32_t
srcStride
uint8_t
*
dstData
int32_t
dstWidth
int32_t
dstHeight
int32_t
dstStride
SurfaceFormat
format
)
{
#
ifdef
USE_SKIA
SkBitmap
imgSrc
;
imgSrc
.
installPixels
(
MakeSkiaImageInfo
(
IntSize
(
srcWidth
srcHeight
)
format
)
srcData
srcStride
)
;
if
(
imgSrc
.
colorType
(
)
!
=
kBGRA_8888_SkColorType
)
{
imgSrc
.
copyTo
(
&
imgSrc
kBGRA_8888_SkColorType
)
;
}
SkBitmap
result
=
skia
:
:
ImageOperations
:
:
Resize
(
imgSrc
skia
:
:
ImageOperations
:
:
RESIZE_BEST
dstWidth
dstHeight
dstData
)
;
return
!
result
.
isNull
(
)
;
#
else
return
false
;
#
endif
}
}
}
