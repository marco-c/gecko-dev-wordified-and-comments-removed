#
ifndef
MOZILLA_GFX_RENDERCOMPOSITOR_SWGL_H
#
define
MOZILLA_GFX_RENDERCOMPOSITOR_SWGL_H
#
include
"
mozilla
/
webrender
/
RenderCompositor
.
h
"
namespace
mozilla
{
namespace
wr
{
class
RenderCompositorSWGL
:
public
RenderCompositor
{
public
:
static
UniquePtr
<
RenderCompositor
>
Create
(
RefPtr
<
widget
:
:
CompositorWidget
>
&
&
aWidget
)
;
RenderCompositorSWGL
(
RefPtr
<
widget
:
:
CompositorWidget
>
&
&
aWidget
)
;
virtual
~
RenderCompositorSWGL
(
)
;
bool
BeginFrame
(
)
override
;
void
CancelFrame
(
)
override
;
RenderedFrameId
EndFrame
(
const
nsTArray
<
DeviceIntRect
>
&
aDirtyRects
)
final
;
bool
GetMappedBuffer
(
uint8_t
*
*
aData
int32_t
*
aStride
)
override
{
if
(
mMappedData
)
{
*
aData
=
mMappedData
;
*
aStride
=
mMappedStride
;
return
true
;
}
return
false
;
}
void
Pause
(
)
override
;
bool
Resume
(
)
override
;
LayoutDeviceIntSize
GetBufferSize
(
)
override
;
CompositorCapabilities
GetCompositorCapabilities
(
)
override
;
private
:
RefPtr
<
DrawTarget
>
mDT
;
LayoutDeviceIntRegion
mRegion
;
RefPtr
<
DataSourceSurface
>
mSurface
;
uint8_t
*
mMappedData
=
nullptr
;
int32_t
mMappedStride
=
0
;
void
ClearMappedBuffer
(
)
;
void
CommitMappedBuffer
(
const
nsTArray
<
DeviceIntRect
>
*
aDirtyRects
=
nullptr
)
;
}
;
}
}
#
endif
