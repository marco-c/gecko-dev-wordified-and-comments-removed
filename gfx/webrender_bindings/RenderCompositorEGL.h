#
ifndef
MOZILLA_GFX_RENDERCOMPOSITOR_EGL_H
#
define
MOZILLA_GFX_RENDERCOMPOSITOR_EGL_H
#
include
"
GLTypes
.
h
"
#
include
"
mozilla
/
webrender
/
RenderCompositor
.
h
"
namespace
mozilla
{
namespace
wr
{
class
RenderCompositorEGL
:
public
RenderCompositor
{
public
:
static
UniquePtr
<
RenderCompositor
>
Create
(
RefPtr
<
widget
:
:
CompositorWidget
>
aWidget
nsACString
&
aError
)
;
explicit
RenderCompositorEGL
(
RefPtr
<
widget
:
:
CompositorWidget
>
aWidget
)
;
virtual
~
RenderCompositorEGL
(
)
;
bool
BeginFrame
(
)
override
;
RenderedFrameId
EndFrame
(
const
nsTArray
<
DeviceIntRect
>
&
aDirtyRects
)
final
;
void
Pause
(
)
override
;
bool
Resume
(
)
override
;
gl
:
:
GLContext
*
gl
(
)
const
override
;
bool
MakeCurrent
(
)
override
;
bool
UseANGLE
(
)
const
override
{
return
false
;
}
LayoutDeviceIntSize
GetBufferSize
(
)
override
;
CompositorCapabilities
GetCompositorCapabilities
(
)
override
;
bool
UsePartialPresent
(
)
override
;
bool
RequestFullRender
(
)
override
;
uint32_t
GetMaxPartialPresentRects
(
)
override
;
bool
ShouldDrawPreviousPartialPresentRegions
(
)
override
;
size_t
GetBufferAge
(
)
const
override
;
void
SetBufferDamageRegion
(
const
wr
:
:
DeviceIntRect
*
aRects
size_t
aNumRects
)
override
;
ipc
:
:
FileDescriptor
GetAndResetReleaseFence
(
)
override
;
protected
:
EGLSurface
CreateEGLSurface
(
)
;
void
DestroyEGLSurface
(
)
;
EGLSurface
mEGLSurface
;
#
ifdef
MOZ_WIDGET_ANDROID
LayoutDeviceIntSize
mEGLSurfaceSize
;
#
endif
EGLint
mBufferAge
;
ipc
:
:
FileDescriptor
mReleaseFenceFd
;
}
;
}
}
#
endif
