#
ifndef
mozilla_layers_RendererScreenshotGrabber_h
#
define
mozilla_layers_RendererScreenshotGrabber_h
#
include
"
mozilla
/
TimeStamp
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
mozilla
/
gfx
/
Point
.
h
"
#
include
"
mozilla
/
layers
/
ProfilerScreenshots
.
h
"
#
include
"
mozilla
/
webrender
/
webrender_ffi
.
h
"
#
include
"
nsTArray
.
h
"
namespace
mozilla
{
namespace
wr
{
struct
Renderer
;
class
RendererOGL
;
class
RendererScreenshotGrabber
final
{
public
:
RendererScreenshotGrabber
(
)
;
void
MaybeGrabScreenshot
(
RendererOGL
*
aRendererOGL
const
gfx
:
:
IntSize
&
aWindowSize
)
;
void
MaybeProcessQueue
(
RendererOGL
*
aRenderer
)
;
bool
HaveScreenshotsToFlush
(
)
;
private
:
void
Destroy
(
Renderer
*
aRenderer
)
;
void
GrabScreenshot
(
Renderer
*
aRenderer
const
gfx
:
:
IntSize
&
aWindowSize
)
;
void
ProcessQueue
(
Renderer
*
aRenderer
)
;
struct
QueueItem
{
mozilla
:
:
TimeStamp
mTimeStamp
;
AsyncScreenshotHandle
mHandle
;
gfx
:
:
IntSize
mScreenshotSize
;
gfx
:
:
IntSize
mWindowSize
;
}
;
gfx
:
:
IntSize
mMaxScreenshotSize
;
nsTArray
<
QueueItem
>
mQueue
;
Maybe
<
QueueItem
>
mCurrentFrameQueueItem
;
RefPtr
<
mozilla
:
:
layers
:
:
ProfilerScreenshots
>
mProfilerScreenshots
;
}
;
}
}
#
endif
