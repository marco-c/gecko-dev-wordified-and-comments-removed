#
include
"
RenderMacIOSurfaceTextureHostSWGL
.
h
"
#
include
"
MacIOSurfaceHelpers
.
h
"
namespace
mozilla
{
namespace
wr
{
RenderMacIOSurfaceTextureHostSWGL
:
:
RenderMacIOSurfaceTextureHostSWGL
(
MacIOSurface
*
aSurface
)
:
mSurface
(
aSurface
)
{
MOZ_COUNT_CTOR_INHERITED
(
RenderMacIOSurfaceTextureHostSWGL
RenderTextureHostSWGL
)
;
MOZ_RELEASE_ASSERT
(
mSurface
)
;
}
RenderMacIOSurfaceTextureHostSWGL
:
:
~
RenderMacIOSurfaceTextureHostSWGL
(
)
{
MOZ_COUNT_DTOR_INHERITED
(
RenderMacIOSurfaceTextureHostSWGL
RenderTextureHostSWGL
)
;
}
size_t
RenderMacIOSurfaceTextureHostSWGL
:
:
GetPlaneCount
(
)
{
size_t
planeCount
=
mSurface
-
>
GetPlaneCount
(
)
;
return
planeCount
>
0
?
planeCount
:
1
;
}
gfx
:
:
YUVColorSpace
RenderMacIOSurfaceTextureHostSWGL
:
:
GetYUVColorSpace
(
)
const
{
return
mSurface
-
>
GetYUVColorSpace
(
)
;
}
bool
RenderMacIOSurfaceTextureHostSWGL
:
:
MapPlane
(
uint8_t
aChannelIndex
PlaneInfo
&
aPlaneInfo
)
{
if
(
!
aChannelIndex
)
{
mSurface
-
>
Lock
(
)
;
}
aPlaneInfo
.
mFormat
=
mSurface
-
>
GetFormat
(
)
;
aPlaneInfo
.
mData
=
mSurface
-
>
GetBaseAddressOfPlane
(
aChannelIndex
)
;
aPlaneInfo
.
mStride
=
mSurface
-
>
GetBytesPerRow
(
aChannelIndex
)
;
aPlaneInfo
.
mSize
=
gfx
:
:
IntSize
(
mSurface
-
>
GetDevicePixelWidth
(
aChannelIndex
)
mSurface
-
>
GetDevicePixelHeight
(
aChannelIndex
)
)
;
return
true
;
}
void
RenderMacIOSurfaceTextureHostSWGL
:
:
UnmapPlanes
(
)
{
mSurface
-
>
Unlock
(
)
;
}
}
}
