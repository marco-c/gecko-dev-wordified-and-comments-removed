#
include
"
VsyncIOThreadHolder
.
h
"
#
include
"
mozilla
/
SchedulerGroup
.
h
"
namespace
mozilla
{
namespace
gfx
{
VsyncIOThreadHolder
:
:
VsyncIOThreadHolder
(
)
{
MOZ_COUNT_CTOR
(
VsyncIOThreadHolder
)
;
}
VsyncIOThreadHolder
:
:
~
VsyncIOThreadHolder
(
)
{
MOZ_COUNT_DTOR
(
VsyncIOThreadHolder
)
;
if
(
!
mThread
)
{
return
;
}
if
(
NS_IsMainThread
(
)
)
{
mThread
-
>
AsyncShutdown
(
)
;
}
else
{
SchedulerGroup
:
:
Dispatch
(
NewRunnableMethod
(
"
nsIThread
:
:
AsyncShutdown
"
mThread
&
nsIThread
:
:
AsyncShutdown
)
)
;
}
}
bool
VsyncIOThreadHolder
:
:
Start
(
)
{
nsresult
rv
=
NS_NewNamedThread
(
"
VsyncIOThread
"
getter_AddRefs
(
mThread
)
)
;
return
NS_SUCCEEDED
(
rv
)
;
}
RefPtr
<
nsIThread
>
VsyncIOThreadHolder
:
:
GetThread
(
)
const
{
return
mThread
;
}
}
}
