#
ifndef
_include_mozilla_gfx_ipc_GPUChild_h_
#
define
_include_mozilla_gfx_ipc_GPUChild_h_
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
mozilla
/
gfx
/
PGPUChild
.
h
"
#
include
"
mozilla
/
gfx
/
gfxVarReceiver
.
h
"
namespace
mozilla
{
namespace
ipc
{
class
CrashReporterHost
;
}
namespace
gfx
{
class
GPUProcessHost
;
class
GPUChild
final
:
public
PGPUChild
public
gfxVarReceiver
{
public
:
explicit
GPUChild
(
GPUProcessHost
*
aHost
)
;
~
GPUChild
(
)
;
void
Init
(
)
;
void
EnsureGPUReady
(
)
;
void
OnVarChanged
(
const
GfxVarUpdate
&
aVar
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvInitComplete
(
const
GPUDeviceData
&
aData
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvReportCheckerboard
(
const
uint32_t
&
aSeverity
const
nsCString
&
aLog
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvInitCrashReporter
(
Shmem
&
&
shmem
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvAccumulateChildHistogram
(
InfallibleTArray
<
Accumulation
>
&
&
aAccumulations
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvAccumulateChildKeyedHistogram
(
InfallibleTArray
<
KeyedAccumulation
>
&
&
aAccumulations
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvUpdateChildScalars
(
InfallibleTArray
<
ScalarAction
>
&
&
aScalarActions
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvUpdateChildKeyedScalars
(
InfallibleTArray
<
KeyedScalarAction
>
&
&
aScalarActions
)
override
;
void
ActorDestroy
(
ActorDestroyReason
aWhy
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvGraphicsError
(
const
nsCString
&
aError
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvNotifyUiObservers
(
const
nsCString
&
aTopic
)
override
;
mozilla
:
:
ipc
:
:
IPCResult
RecvNotifyDeviceReset
(
)
override
;
static
void
Destroy
(
UniquePtr
<
GPUChild
>
&
&
aChild
)
;
private
:
GPUProcessHost
*
mHost
;
UniquePtr
<
ipc
:
:
CrashReporterHost
>
mCrashReporter
;
bool
mGPUReady
;
}
;
}
}
#
endif
