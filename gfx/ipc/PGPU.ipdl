include
CrashReporterInitArgs
;
include
GraphicsMessages
;
include
MemoryReportTypes
;
include
HangTypes
;
include
PrefsTypes
;
include
protocol
PAPZInputBridge
;
include
protocol
PCompositorManager
;
include
protocol
PImageBridge
;
include
protocol
PProfiler
;
include
protocol
PVRGPU
;
include
protocol
PVRManager
;
include
protocol
PVideoBridge
;
include
protocol
PVsyncBridge
;
include
protocol
PUiCompositorController
;
include
protocol
PRemoteMediaManager
;
#
if
defined
(
MOZ_SANDBOX
)
&
&
defined
(
MOZ_DEBUG
)
&
&
defined
(
ENABLE_TESTS
)
include
protocol
PSandboxTesting
;
#
endif
include
"
mozilla
/
ipc
/
ByteBufUtils
.
h
"
;
include
"
mozilla
/
layers
/
LayersMessageUtils
.
h
"
;
using
base
:
:
ProcessId
from
"
base
/
process
.
h
"
;
using
mozilla
:
:
dom
:
:
ContentParentId
from
"
mozilla
/
dom
/
ipc
/
IdType
.
h
"
;
using
mozilla
:
:
dom
:
:
NativeThreadId
from
"
mozilla
/
dom
/
NativeThreadId
.
h
"
;
using
mozilla
:
:
Telemetry
:
:
HistogramAccumulation
from
"
mozilla
/
TelemetryComms
.
h
"
;
using
mozilla
:
:
Telemetry
:
:
KeyedHistogramAccumulation
from
"
mozilla
/
TelemetryComms
.
h
"
;
using
mozilla
:
:
Telemetry
:
:
ScalarAction
from
"
mozilla
/
TelemetryComms
.
h
"
;
using
mozilla
:
:
Telemetry
:
:
KeyedScalarAction
from
"
mozilla
/
TelemetryComms
.
h
"
;
using
mozilla
:
:
Telemetry
:
:
ChildEventData
from
"
mozilla
/
TelemetryComms
.
h
"
;
using
mozilla
:
:
Telemetry
:
:
DiscardedData
from
"
mozilla
/
TelemetryComms
.
h
"
;
using
mozilla
:
:
gfx
:
:
Feature
from
"
gfxFeature
.
h
"
;
using
mozilla
:
:
gfx
:
:
Fallback
from
"
gfxFallback
.
h
"
;
using
mozilla
:
:
layers
:
:
LayersId
from
"
mozilla
/
layers
/
LayersTypes
.
h
"
;
using
mozilla
:
:
layers
:
:
OverlayInfo
from
"
mozilla
/
layers
/
OverlayInfo
.
h
"
;
using
mozilla
:
:
layers
:
:
SwapChainInfo
from
"
mozilla
/
layers
/
OverlayInfo
.
h
"
;
using
mozilla
:
:
media
:
:
MediaCodecsSupported
from
"
MediaCodecsSupport
.
h
"
;
using
mozilla
:
:
layers
:
:
VideoBridgeSource
from
"
mozilla
/
layers
/
VideoBridgeUtils
.
h
"
;
using
mozilla
:
:
hal
:
:
BatteryInformation
from
"
mozilla
/
hal_sandbox
/
PHal
.
h
"
;
using
mozilla
:
:
gfx
:
:
DeviceResetReason
from
"
mozilla
/
gfx
/
Types
.
h
"
;
using
mozilla
:
:
gfx
:
:
DeviceResetDetectPlace
from
"
mozilla
/
gfx
/
Types
.
h
"
;
namespace
mozilla
{
namespace
gfx
{
struct
LayerTreeIdMapping
{
LayersId
layersId
;
ProcessId
ownerId
;
}
;
[
NeedsOtherPid
ParentProc
=
GPU
ChildProc
=
Parent
]
sync
protocol
PGPU
{
parent
:
async
Init
(
GfxVarUpdate
[
]
vars
DevicePrefs
devicePrefs
LayerTreeIdMapping
[
]
mapping
GfxInfoFeatureStatus
[
]
features
uint32_t
wrNamespace
)
;
async
InitCompositorManager
(
Endpoint
<
PCompositorManagerParent
>
endpoint
uint32_t
aNamespace
)
;
async
InitVsyncBridge
(
Endpoint
<
PVsyncBridgeParent
>
endpoint
)
;
async
InitImageBridge
(
Endpoint
<
PImageBridgeParent
>
endpoint
)
;
async
InitVideoBridge
(
Endpoint
<
PVideoBridgeParent
>
endpoint
VideoBridgeSource
aSource
)
;
async
InitVRManager
(
Endpoint
<
PVRManagerParent
>
endpoint
)
;
async
InitUiCompositorController
(
LayersId
rootLayerTreeId
Endpoint
<
PUiCompositorControllerParent
>
endpoint
)
;
async
InitAPZInputBridge
(
LayersId
layersId
Endpoint
<
PAPZInputBridgeParent
>
endpoint
)
;
async
InitProfiler
(
Endpoint
<
PProfilerChild
>
endpoint
)
;
async
InitVR
(
Endpoint
<
PVRGPUChild
>
endpoint
)
;
async
UpdateVar
(
GfxVarUpdate
[
]
var
)
;
async
PreferenceUpdate
(
Pref
pref
)
;
async
ScreenInformationChanged
(
)
;
async
NotifyBatteryInfo
(
BatteryInformation
aBatteryInfo
)
;
async
NewContentCompositorManager
(
Endpoint
<
PCompositorManagerParent
>
endpoint
ContentParentId
childId
uint32_t
aNamespace
)
;
async
NewContentImageBridge
(
Endpoint
<
PImageBridgeParent
>
endpoint
ContentParentId
childId
)
;
async
NewContentVRManager
(
Endpoint
<
PVRManagerParent
>
endpoint
ContentParentId
childId
)
;
async
NewContentRemoteMediaManager
(
Endpoint
<
PRemoteMediaManagerParent
>
endpoint
ContentParentId
childId
)
;
sync
AddLayerTreeIdMapping
(
LayerTreeIdMapping
mapping
)
;
async
RemoveLayerTreeIdMapping
(
LayerTreeIdMapping
mapping
)
;
sync
GetDeviceStatus
(
)
returns
(
GPUDeviceData
status
)
;
async
SimulateDeviceReset
(
)
;
async
NotifyGpuObservers
(
nsCString
aTopic
)
;
async
RequestMemoryReport
(
uint32_t
generation
bool
anonymize
bool
minimizeMemoryUsage
FileDescriptor
?
DMDFile
)
returns
(
uint32_t
aGeneration
)
;
async
ShutdownVR
(
)
;
async
UpdatePerfStatsCollectionMask
(
uint64_t
aMask
)
;
async
CollectPerfStatsJSON
(
)
returns
(
nsCString
aStats
)
;
#
if
defined
(
MOZ_SANDBOX
)
&
&
defined
(
MOZ_DEBUG
)
&
&
defined
(
ENABLE_TESTS
)
async
InitSandboxTesting
(
Endpoint
<
PSandboxTestingChild
>
aEndpoint
)
;
#
endif
async
FlushFOGData
(
)
returns
(
ByteBuf
buf
)
;
async
TestTriggerMetrics
(
)
returns
(
bool
unused
)
;
async
CrashProcess
(
)
;
child
:
async
InitComplete
(
GPUDeviceData
data
)
;
async
ReportCheckerboard
(
uint32_t
severity
nsCString
log
)
;
async
GraphicsError
(
nsCString
aError
)
;
async
InitCrashReporter
(
CrashReporterInitArgs
aInitArgs
)
;
async
CreateVRProcess
(
)
;
async
ShutdownVRProcess
(
)
;
async
NotifyUiObservers
(
nsCString
aTopic
)
;
async
AccumulateChildHistograms
(
HistogramAccumulation
[
]
accumulations
)
;
async
AccumulateChildKeyedHistograms
(
KeyedHistogramAccumulation
[
]
accumulations
)
;
async
UpdateChildScalars
(
ScalarAction
[
]
actions
)
;
async
UpdateChildKeyedScalars
(
KeyedScalarAction
[
]
actions
)
;
async
RecordChildEvents
(
ChildEventData
[
]
events
)
;
async
RecordDiscardedData
(
DiscardedData
data
)
;
async
DeclareStable
(
)
;
async
NotifyDeviceReset
(
GPUDeviceData
status
DeviceResetReason
reason
DeviceResetDetectPlace
place
)
;
async
NotifyOverlayInfo
(
OverlayInfo
info
)
;
async
NotifySwapChainInfo
(
SwapChainInfo
info
)
;
async
NotifyDisableRemoteCanvas
(
)
;
async
FlushMemory
(
nsString
reason
)
;
async
AddMemoryReport
(
MemoryReport
aReport
)
;
async
UpdateFeature
(
Feature
aFeature
FeatureFailure
aChange
)
;
async
UsedFallback
(
Fallback
aFallback
nsCString
message
)
;
async
BHRThreadHang
(
HangDetails
aDetails
)
;
async
UpdateMediaCodecsSupported
(
MediaCodecsSupported
aSupported
)
;
async
FOGData
(
ByteBuf
buf
)
;
}
;
}
}
