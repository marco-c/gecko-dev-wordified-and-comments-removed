#
!
[
cfg_attr
(
feature
=
"
nightly
"
feature
(
nonzero
)
)
]
#
!
[
allow
(
clippy
:
:
float_cmp
clippy
:
:
too_many_arguments
)
]
#
!
[
allow
(
clippy
:
:
unreadable_literal
clippy
:
:
new_without_default
)
]
pub
extern
crate
crossbeam_channel
;
pub
extern
crate
euclid
;
extern
crate
app_units
;
#
[
macro_use
]
extern
crate
bitflags
;
extern
crate
byteorder
;
#
[
cfg
(
feature
=
"
nightly
"
)
]
extern
crate
core
;
#
[
macro_use
]
extern
crate
malloc_size_of_derive
;
extern
crate
serde
;
#
[
macro_use
]
extern
crate
serde_derive
;
extern
crate
time
;
extern
crate
malloc_size_of
;
extern
crate
peek_poke
;
pub
mod
channel
;
mod
color
;
mod
display_item
;
mod
display_item_cache
;
mod
display_list
;
mod
font
;
mod
gradient_builder
;
mod
image
;
mod
tile_pool
;
pub
mod
units
;
pub
use
crate
:
:
color
:
:
*
;
pub
use
crate
:
:
display_item
:
:
*
;
pub
use
crate
:
:
display_item_cache
:
:
DisplayItemCache
;
pub
use
crate
:
:
display_list
:
:
*
;
pub
use
crate
:
:
font
:
:
*
;
pub
use
crate
:
:
gradient_builder
:
:
*
;
pub
use
crate
:
:
image
:
:
*
;
pub
use
crate
:
:
tile_pool
:
:
*
;
use
crate
:
:
units
:
:
*
;
use
crate
:
:
channel
:
:
Receiver
;
use
std
:
:
marker
:
:
PhantomData
;
use
std
:
:
sync
:
:
Arc
;
use
std
:
:
os
:
:
raw
:
:
c_void
;
use
peek_poke
:
:
PeekPoke
;
pub
const
MAX_RENDER_TASK_SIZE
:
i32
=
16384
;
pub
type
TileSize
=
u16
;
#
[
derive
(
Copy
Clone
Deserialize
Serialize
)
]
pub
struct
QualitySettings
{
pub
force_subpixel_aa_where_possible
:
bool
}
impl
Default
for
QualitySettings
{
fn
default
(
)
-
>
Self
{
QualitySettings
{
force_subpixel_aa_where_possible
:
false
}
}
}
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
Deserialize
Eq
Hash
Ord
PartialEq
PartialOrd
Serialize
)
]
pub
struct
Epoch
(
pub
u32
)
;
impl
Epoch
{
pub
fn
invalid
(
)
-
>
Epoch
{
Epoch
(
u32
:
:
MAX
)
}
}
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
Default
Eq
MallocSizeOf
PartialEq
Hash
Ord
PartialOrd
PeekPoke
)
]
#
[
derive
(
Deserialize
Serialize
)
]
pub
struct
IdNamespace
(
pub
u32
)
;
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
Deserialize
Eq
Hash
MallocSizeOf
PartialEq
Serialize
PeekPoke
)
]
pub
struct
DocumentId
{
pub
namespace_id
:
IdNamespace
pub
id
:
u32
}
impl
DocumentId
{
pub
fn
new
(
namespace_id
:
IdNamespace
id
:
u32
)
-
>
Self
{
DocumentId
{
namespace_id
id
}
}
pub
const
INVALID
:
DocumentId
=
DocumentId
{
namespace_id
:
IdNamespace
(
0
)
id
:
0
}
;
}
pub
type
PipelineSourceId
=
u32
;
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
Deserialize
Eq
Hash
MallocSizeOf
PartialEq
Serialize
PeekPoke
)
]
pub
struct
PipelineId
(
pub
PipelineSourceId
pub
u32
)
;
impl
Default
for
PipelineId
{
fn
default
(
)
-
>
Self
{
PipelineId
:
:
dummy
(
)
}
}
impl
PipelineId
{
pub
fn
dummy
(
)
-
>
Self
{
PipelineId
(
!
0
!
0
)
}
pub
const
INVALID
:
Self
=
PipelineId
(
!
0
!
0
)
;
}
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
PartialEq
PartialOrd
)
]
pub
struct
FramePublishId
(
pub
u64
)
;
impl
FramePublishId
{
pub
fn
first
(
)
-
>
Self
{
FramePublishId
(
0
)
}
pub
fn
advance
(
&
mut
self
)
{
self
.
0
+
=
1
;
}
pub
const
INVALID
:
Self
=
FramePublishId
(
0
)
;
}
impl
Default
for
FramePublishId
{
fn
default
(
)
-
>
Self
{
FramePublishId
:
:
INVALID
}
}
#
[
repr
(
C
)
]
#
[
derive
(
Clone
)
]
pub
struct
ExternalEvent
{
raw
:
usize
}
unsafe
impl
Send
for
ExternalEvent
{
}
impl
ExternalEvent
{
pub
fn
from_raw
(
raw
:
usize
)
-
>
Self
{
ExternalEvent
{
raw
}
}
pub
fn
unwrap
(
self
)
-
>
usize
{
self
.
raw
}
}
pub
type
APZScrollGeneration
=
u64
;
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
Deserialize
PartialEq
Serialize
Default
)
]
pub
struct
SampledScrollOffset
{
pub
offset
:
LayoutVector2D
pub
generation
:
APZScrollGeneration
}
#
[
repr
(
u8
)
]
#
[
derive
(
Clone
Copy
Debug
Deserialize
PartialEq
Serialize
PeekPoke
)
]
pub
enum
HasScrollLinkedEffect
{
Yes
No
}
impl
Default
for
HasScrollLinkedEffect
{
fn
default
(
)
-
>
Self
{
HasScrollLinkedEffect
:
:
No
}
}
#
[
repr
(
C
)
]
pub
struct
MinimapData
{
pub
is_root_content
:
bool
pub
visual_viewport
:
LayoutRect
pub
layout_viewport
:
LayoutRect
pub
scrollable_rect
:
LayoutRect
pub
displayport
:
LayoutRect
pub
zoom_transform
:
LayoutTransform
pub
root_content_pipeline_id
:
PipelineId
pub
root_content_scroll_id
:
u64
}
pub
trait
RenderNotifier
:
Send
{
fn
clone
(
&
self
)
-
>
Box
<
dyn
RenderNotifier
>
;
fn
wake_up
(
&
self
composite_needed
:
bool
)
;
fn
new_frame_ready
(
&
self
_
:
DocumentId
scrolled
:
bool
composite_needed
:
bool
frame_publish_id
:
FramePublishId
)
;
fn
external_event
(
&
self
_evt
:
ExternalEvent
)
{
unimplemented
!
(
)
}
fn
shut_down
(
&
self
)
{
}
}
#
[
repr
(
u32
)
]
#
[
derive
(
Copy
Clone
Debug
PartialEq
Eq
)
]
pub
enum
Checkpoint
{
SceneBuilt
FrameBuilt
FrameTexturesUpdated
FrameRendered
TransactionDropped
}
pub
trait
NotificationHandler
:
Send
+
Sync
{
fn
notify
(
&
self
when
:
Checkpoint
)
;
}
pub
struct
NotificationRequest
{
handler
:
Option
<
Box
<
dyn
NotificationHandler
>
>
when
:
Checkpoint
}
impl
NotificationRequest
{
pub
fn
new
(
when
:
Checkpoint
handler
:
Box
<
dyn
NotificationHandler
>
)
-
>
Self
{
NotificationRequest
{
handler
:
Some
(
handler
)
when
}
}
pub
fn
when
(
&
self
)
-
>
Checkpoint
{
self
.
when
}
pub
fn
notify
(
mut
self
)
{
if
let
Some
(
handler
)
=
self
.
handler
.
take
(
)
{
handler
.
notify
(
self
.
when
)
;
}
}
}
pub
trait
ApiHitTester
:
Send
+
Sync
{
fn
hit_test
(
&
self
point
:
WorldPoint
)
-
>
HitTestResult
;
}
pub
struct
HitTesterRequest
{
#
[
doc
(
hidden
)
]
pub
rx
:
Receiver
<
Arc
<
dyn
ApiHitTester
>
>
}
impl
HitTesterRequest
{
pub
fn
resolve
(
self
)
-
>
Arc
<
dyn
ApiHitTester
>
{
self
.
rx
.
recv
(
)
.
unwrap
(
)
}
}
#
[
derive
(
Clone
Debug
Deserialize
PartialEq
Serialize
)
]
pub
struct
HitTestResultItem
{
pub
pipeline
:
PipelineId
pub
tag
:
ItemTag
pub
animation_id
:
u64
}
#
[
derive
(
Clone
Debug
Default
Deserialize
Serialize
)
]
pub
struct
HitTestResult
{
pub
items
:
Vec
<
HitTestResultItem
>
}
impl
Drop
for
NotificationRequest
{
fn
drop
(
&
mut
self
)
{
if
let
Some
(
ref
mut
handler
)
=
self
.
handler
{
handler
.
notify
(
Checkpoint
:
:
TransactionDropped
)
;
}
}
}
impl
Clone
for
NotificationRequest
{
fn
clone
(
&
self
)
-
>
Self
{
NotificationRequest
{
when
:
self
.
when
handler
:
None
}
}
}
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
Default
Deserialize
MallocSizeOf
PartialEq
Serialize
Eq
Hash
PeekPoke
)
]
pub
struct
PropertyBindingId
{
pub
namespace
:
IdNamespace
pub
uid
:
u32
}
impl
PropertyBindingId
{
pub
fn
new
(
value
:
u64
)
-
>
Self
{
PropertyBindingId
{
namespace
:
IdNamespace
(
(
value
>
>
32
)
as
u32
)
uid
:
value
as
u32
}
}
pub
fn
to_u64
(
&
self
)
-
>
u64
{
(
(
self
.
namespace
.
0
as
u64
)
<
<
32
)
|
self
.
uid
as
u64
}
}
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
Default
Deserialize
Eq
Hash
MallocSizeOf
PartialEq
Serialize
PeekPoke
)
]
pub
struct
PropertyBindingKey
<
T
>
{
pub
id
:
PropertyBindingId
#
[
doc
(
hidden
)
]
pub
_phantom
:
PhantomData
<
T
>
}
impl
<
T
:
Copy
>
PropertyBindingKey
<
T
>
{
pub
fn
with
(
self
value
:
T
)
-
>
PropertyValue
<
T
>
{
PropertyValue
{
key
:
self
value
}
}
}
impl
<
T
>
Into
<
u64
>
for
PropertyBindingKey
<
T
>
{
fn
into
(
self
)
-
>
u64
{
self
.
id
.
to_u64
(
)
}
}
impl
<
T
>
PropertyBindingKey
<
T
>
{
pub
fn
new
(
value
:
u64
)
-
>
Self
{
PropertyBindingKey
{
id
:
PropertyBindingId
:
:
new
(
value
)
_phantom
:
PhantomData
}
}
}
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
Debug
Deserialize
Eq
Hash
MallocSizeOf
PartialEq
Serialize
PeekPoke
)
]
pub
enum
PropertyBinding
<
T
>
{
Value
(
T
)
Binding
(
PropertyBindingKey
<
T
>
T
)
}
impl
<
T
:
Default
>
Default
for
PropertyBinding
<
T
>
{
fn
default
(
)
-
>
Self
{
PropertyBinding
:
:
Value
(
Default
:
:
default
(
)
)
}
}
impl
<
T
>
From
<
T
>
for
PropertyBinding
<
T
>
{
fn
from
(
value
:
T
)
-
>
PropertyBinding
<
T
>
{
PropertyBinding
:
:
Value
(
value
)
}
}
impl
From
<
PropertyBindingKey
<
ColorF
>
>
for
PropertyBindingKey
<
ColorU
>
{
fn
from
(
key
:
PropertyBindingKey
<
ColorF
>
)
-
>
PropertyBindingKey
<
ColorU
>
{
PropertyBindingKey
{
id
:
key
.
id
.
clone
(
)
_phantom
:
PhantomData
}
}
}
impl
From
<
PropertyBindingKey
<
ColorU
>
>
for
PropertyBindingKey
<
ColorF
>
{
fn
from
(
key
:
PropertyBindingKey
<
ColorU
>
)
-
>
PropertyBindingKey
<
ColorF
>
{
PropertyBindingKey
{
id
:
key
.
id
.
clone
(
)
_phantom
:
PhantomData
}
}
}
impl
From
<
PropertyBinding
<
ColorF
>
>
for
PropertyBinding
<
ColorU
>
{
fn
from
(
value
:
PropertyBinding
<
ColorF
>
)
-
>
PropertyBinding
<
ColorU
>
{
match
value
{
PropertyBinding
:
:
Value
(
value
)
=
>
PropertyBinding
:
:
Value
(
value
.
into
(
)
)
PropertyBinding
:
:
Binding
(
k
v
)
=
>
{
PropertyBinding
:
:
Binding
(
k
.
into
(
)
v
.
into
(
)
)
}
}
}
}
impl
From
<
PropertyBinding
<
ColorU
>
>
for
PropertyBinding
<
ColorF
>
{
fn
from
(
value
:
PropertyBinding
<
ColorU
>
)
-
>
PropertyBinding
<
ColorF
>
{
match
value
{
PropertyBinding
:
:
Value
(
value
)
=
>
PropertyBinding
:
:
Value
(
value
.
into
(
)
)
PropertyBinding
:
:
Binding
(
k
v
)
=
>
{
PropertyBinding
:
:
Binding
(
k
.
into
(
)
v
.
into
(
)
)
}
}
}
}
#
[
derive
(
Clone
Copy
Debug
Deserialize
Serialize
PartialEq
)
]
pub
struct
PropertyValue
<
T
>
{
pub
key
:
PropertyBindingKey
<
T
>
pub
value
:
T
}
#
[
derive
(
Clone
Deserialize
Serialize
Debug
PartialEq
Default
)
]
pub
struct
DynamicProperties
{
pub
transforms
:
Vec
<
PropertyValue
<
LayoutTransform
>
>
pub
floats
:
Vec
<
PropertyValue
<
f32
>
>
pub
colors
:
Vec
<
PropertyValue
<
ColorF
>
>
}
impl
DynamicProperties
{
pub
fn
extend
(
&
mut
self
other
:
Self
)
{
self
.
transforms
.
extend
(
other
.
transforms
)
;
self
.
floats
.
extend
(
other
.
floats
)
;
self
.
colors
.
extend
(
other
.
colors
)
;
}
}
pub
type
VoidPtrToSizeFn
=
unsafe
extern
"
C
"
fn
(
ptr
:
*
const
c_void
)
-
>
usize
;
#
[
derive
(
Copy
Clone
Debug
PartialEq
)
]
pub
enum
Parameter
{
Bool
(
BoolParameter
bool
)
Int
(
IntParameter
i32
)
Float
(
FloatParameter
f32
)
}
#
[
derive
(
Copy
Clone
Debug
PartialEq
Eq
)
]
#
[
repr
(
u32
)
]
pub
enum
BoolParameter
{
PboUploads
=
0
Multithreading
=
1
BatchedUploads
=
2
DrawCallsForTextureCopy
=
3
}
#
[
derive
(
Copy
Clone
Debug
PartialEq
Eq
)
]
#
[
repr
(
u32
)
]
pub
enum
IntParameter
{
BatchedUploadThreshold
=
0
}
#
[
derive
(
Copy
Clone
Debug
PartialEq
Eq
)
]
#
[
repr
(
u32
)
]
pub
enum
FloatParameter
{
SlowCpuFrameThreshold
=
0
}
#
[
repr
(
C
)
]
#
[
derive
(
Copy
PartialEq
Eq
Clone
PartialOrd
Ord
Hash
Default
Deserialize
MallocSizeOf
Serialize
)
]
pub
struct
RenderReasons
(
u32
)
;
bitflags
!
{
impl
RenderReasons
:
u32
{
/
/
/
Equivalent
of
empty
(
)
for
the
C
+
+
side
.
const
NONE
=
0
;
const
SCENE
=
1
<
<
0
;
const
ANIMATED_PROPERTY
=
1
<
<
1
;
const
RESOURCE_UPDATE
=
1
<
<
2
;
const
ASYNC_IMAGE
=
1
<
<
3
;
const
CLEAR_RESOURCES
=
1
<
<
4
;
const
APZ
=
1
<
<
5
;
/
/
/
Window
resize
const
RESIZE
=
1
<
<
6
;
/
/
/
Various
widget
-
related
reasons
const
WIDGET
=
1
<
<
7
;
/
/
/
See
Frame
:
:
must_be_drawn
const
TEXTURE_CACHE_FLUSH
=
1
<
<
8
;
const
SNAPSHOT
=
1
<
<
9
;
const
POST_RESOURCE_UPDATES_HOOK
=
1
<
<
10
;
const
CONFIG_CHANGE
=
1
<
<
11
;
const
CONTENT_SYNC
=
1
<
<
12
;
const
FLUSH
=
1
<
<
13
;
const
TESTING
=
1
<
<
14
;
const
OTHER
=
1
<
<
15
;
/
/
/
Vsync
isn
'
t
actually
"
why
"
we
render
but
it
can
be
useful
/
/
/
to
see
which
frames
were
driven
by
the
vsync
scheduler
so
/
/
/
we
store
a
bit
for
it
.
const
VSYNC
=
1
<
<
16
;
const
SKIPPED_COMPOSITE
=
1
<
<
17
;
/
/
/
Gecko
does
some
special
things
when
it
starts
observing
vsync
/
/
/
so
it
can
be
useful
to
know
what
frames
are
associated
with
it
.
const
START_OBSERVING_VSYNC
=
1
<
<
18
;
const
ASYNC_IMAGE_COMPOSITE_UNTIL
=
1
<
<
19
;
}
}
impl
core
:
:
fmt
:
:
Debug
for
RenderReasons
{
fn
fmt
(
&
self
f
:
&
mut
core
:
:
fmt
:
:
Formatter
)
-
>
core
:
:
fmt
:
:
Result
{
if
self
.
is_empty
(
)
{
write
!
(
f
"
{
:
#
x
}
"
Self
:
:
empty
(
)
.
bits
(
)
)
}
else
{
bitflags
:
:
parser
:
:
to_writer
(
self
f
)
}
}
}
impl
RenderReasons
{
pub
const
NUM_BITS
:
u32
=
17
;
}
#
[
repr
(
C
)
]
#
[
derive
(
Copy
PartialEq
Eq
Clone
PartialOrd
Ord
Hash
Default
Deserialize
MallocSizeOf
Serialize
)
]
pub
struct
DebugFlags
(
u32
)
;
bitflags
!
{
impl
DebugFlags
:
u32
{
/
/
/
Display
the
frame
profiler
on
screen
.
const
PROFILER_DBG
=
1
<
<
0
;
/
/
/
Display
intermediate
render
targets
on
screen
.
const
RENDER_TARGET_DBG
=
1
<
<
1
;
/
/
/
Display
all
texture
cache
pages
on
screen
.
const
TEXTURE_CACHE_DBG
=
1
<
<
2
;
/
/
/
Display
GPU
timing
results
.
const
GPU_TIME_QUERIES
=
1
<
<
3
;
/
/
/
Query
the
number
of
pixels
that
pass
the
depth
test
divided
and
show
it
/
/
/
in
the
profiler
as
a
percentage
of
the
number
of
pixels
in
the
screen
/
/
/
(
window
width
times
height
)
.
const
GPU_SAMPLE_QUERIES
=
1
<
<
4
;
/
/
/
Render
each
quad
with
their
own
draw
call
.
/
/
/
/
/
/
Terrible
for
performance
but
can
help
with
understanding
the
drawing
/
/
/
order
when
inspecting
renderdoc
or
apitrace
recordings
.
const
DISABLE_BATCHING
=
1
<
<
5
;
/
/
/
Display
the
pipeline
epochs
.
const
EPOCHS
=
1
<
<
6
;
/
/
/
Print
driver
messages
to
stdout
.
const
ECHO_DRIVER_MESSAGES
=
1
<
<
7
;
/
/
/
Show
an
overlay
displaying
overdraw
amount
.
const
SHOW_OVERDRAW
=
1
<
<
8
;
/
/
/
Display
the
contents
of
GPU
cache
.
const
GPU_CACHE_DBG
=
1
<
<
9
;
/
/
/
Clear
evicted
parts
of
the
texture
cache
for
debugging
purposes
.
const
TEXTURE_CACHE_DBG_CLEAR_EVICTED
=
1
<
<
10
;
/
/
/
Show
picture
caching
debug
overlay
const
PICTURE_CACHING_DBG
=
1
<
<
11
;
/
/
/
Highlight
all
primitives
with
colors
based
on
kind
.
const
PRIMITIVE_DBG
=
1
<
<
12
;
/
/
/
Draw
a
zoom
widget
showing
part
of
the
framebuffer
zoomed
in
.
const
ZOOM_DBG
=
1
<
<
13
;
/
/
/
Scale
the
debug
renderer
down
for
a
smaller
screen
.
This
will
disrupt
/
/
/
any
mapping
between
debug
display
items
and
page
content
so
shouldn
'
t
/
/
/
be
used
with
overlays
like
the
picture
caching
or
primitive
display
.
const
SMALL_SCREEN
=
1
<
<
14
;
/
/
/
Disable
various
bits
of
the
WebRender
pipeline
to
help
narrow
/
/
/
down
where
slowness
might
be
coming
from
.
const
DISABLE_OPAQUE_PASS
=
1
<
<
15
;
/
/
/
const
DISABLE_ALPHA_PASS
=
1
<
<
16
;
/
/
/
const
DISABLE_CLIP_MASKS
=
1
<
<
17
;
/
/
/
const
DISABLE_TEXT_PRIMS
=
1
<
<
18
;
/
/
/
const
DISABLE_GRADIENT_PRIMS
=
1
<
<
19
;
/
/
/
const
OBSCURE_IMAGES
=
1
<
<
20
;
/
/
/
Taint
the
transparent
area
of
the
glyphs
with
a
random
opacity
to
easily
/
/
/
see
when
glyphs
are
re
-
rasterized
.
const
GLYPH_FLASHING
=
1
<
<
21
;
/
/
/
The
profiler
only
displays
information
that
is
out
of
the
ordinary
.
const
SMART_PROFILER
=
1
<
<
22
;
/
/
/
If
set
dump
picture
cache
invalidation
debug
to
console
.
const
INVALIDATION_DBG
=
1
<
<
23
;
/
/
/
Collect
and
dump
profiler
statistics
to
captures
.
const
PROFILER_CAPTURE
=
(
1
as
u32
)
<
<
25
;
/
/
need
"
as
u32
"
until
we
have
cbindgen
#
556
/
/
/
Invalidate
picture
tiles
every
frames
(
useful
when
inspecting
GPU
work
in
external
tools
)
.
const
FORCE_PICTURE_INVALIDATION
=
(
1
as
u32
)
<
<
26
;
/
/
/
Display
window
visibility
on
screen
.
const
WINDOW_VISIBILITY_DBG
=
1
<
<
27
;
/
/
/
Render
large
blobs
with
at
a
smaller
size
(
incorrectly
)
.
This
is
a
temporary
workaround
for
/
/
/
fuzzing
.
const
RESTRICT_BLOB_SIZE
=
1
<
<
28
;
/
/
/
Enable
surface
promotion
logging
.
const
SURFACE_PROMOTION_LOGGING
=
1
<
<
29
;
/
/
/
Show
picture
caching
debug
overlay
const
PICTURE_BORDERS
=
1
<
<
30
;
}
}
impl
core
:
:
fmt
:
:
Debug
for
DebugFlags
{
fn
fmt
(
&
self
f
:
&
mut
core
:
:
fmt
:
:
Formatter
)
-
>
core
:
:
fmt
:
:
Result
{
if
self
.
is_empty
(
)
{
write
!
(
f
"
{
:
#
x
}
"
Self
:
:
empty
(
)
.
bits
(
)
)
}
else
{
bitflags
:
:
parser
:
:
to_writer
(
self
f
)
}
}
}
#
[
derive
(
Debug
Clone
Eq
MallocSizeOf
PartialEq
Hash
Serialize
Deserialize
)
]
pub
enum
PrimitiveKeyKind
{
Clear
Rectangle
{
color
:
PropertyBinding
<
ColorU
>
}
}
#
[
derive
(
Clone
Copy
Debug
)
]
pub
enum
ScrollLocation
{
Delta
(
LayoutVector2D
)
Start
End
}
#
[
repr
(
C
)
]
#
[
derive
(
Clone
Copy
)
]
pub
enum
CrashAnnotation
{
CompileShader
=
0
DrawShader
=
1
}
pub
trait
CrashAnnotator
:
Send
{
fn
set
(
&
self
annotation
:
CrashAnnotation
value
:
&
std
:
:
ffi
:
:
CStr
)
;
fn
clear
(
&
self
annotation
:
CrashAnnotation
)
;
fn
box_clone
(
&
self
)
-
>
Box
<
dyn
CrashAnnotator
>
;
}
impl
Clone
for
Box
<
dyn
CrashAnnotator
>
{
fn
clone
(
&
self
)
-
>
Box
<
dyn
CrashAnnotator
>
{
self
.
box_clone
(
)
}
}
pub
struct
CrashAnnotatorGuard
<
'
a
>
{
annotator
:
&
'
a
Option
<
Box
<
dyn
CrashAnnotator
>
>
annotation
:
CrashAnnotation
}
impl
<
'
a
>
CrashAnnotatorGuard
<
'
a
>
{
pub
fn
new
(
annotator
:
&
'
a
Option
<
Box
<
dyn
CrashAnnotator
>
>
annotation
:
CrashAnnotation
value
:
&
std
:
:
ffi
:
:
CStr
)
-
>
Self
{
if
let
Some
(
ref
annotator
)
=
annotator
{
annotator
.
set
(
annotation
value
)
;
}
Self
{
annotator
annotation
}
}
}
impl
<
'
a
>
Drop
for
CrashAnnotatorGuard
<
'
a
>
{
fn
drop
(
&
mut
self
)
{
if
let
Some
(
ref
annotator
)
=
self
.
annotator
{
annotator
.
clear
(
self
.
annotation
)
;
}
}
}
