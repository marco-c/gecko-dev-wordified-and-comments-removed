#
ifndef
SkCodec_wbmp_DEFINED
#
define
SkCodec_wbmp_DEFINED
#
include
"
SkCodec
.
h
"
#
include
"
SkColorSpace
.
h
"
#
include
"
SkSwizzler
.
h
"
class
SkWbmpCodec
final
:
public
SkCodec
{
public
:
static
bool
IsWbmp
(
const
void
*
size_t
)
;
static
std
:
:
unique_ptr
<
SkCodec
>
MakeFromStream
(
std
:
:
unique_ptr
<
SkStream
>
Result
*
)
;
protected
:
SkEncodedImageFormat
onGetEncodedFormat
(
)
const
override
;
Result
onGetPixels
(
const
SkImageInfo
&
void
*
size_t
const
Options
&
int
*
)
override
;
bool
onRewind
(
)
override
;
bool
conversionSupported
(
const
SkImageInfo
&
dst
SkColorType
srcColor
bool
srcIsOpaque
const
SkColorSpace
*
srcCS
)
const
override
;
bool
usesColorXform
(
)
const
override
{
return
false
;
}
private
:
SkSwizzler
*
initializeSwizzler
(
const
SkImageInfo
&
info
const
Options
&
opts
)
;
SkSampler
*
getSampler
(
bool
createIfNecessary
)
override
{
SkASSERT
(
fSwizzler
|
|
!
createIfNecessary
)
;
return
fSwizzler
.
get
(
)
;
}
bool
readRow
(
uint8_t
*
row
)
;
SkWbmpCodec
(
int
width
int
height
const
SkEncodedInfo
&
std
:
:
unique_ptr
<
SkStream
>
)
;
const
size_t
fSrcRowBytes
;
std
:
:
unique_ptr
<
SkSwizzler
>
fSwizzler
;
SkAutoTMalloc
<
uint8_t
>
fSrcBuffer
;
int
onGetScanlines
(
void
*
dst
int
count
size_t
dstRowBytes
)
override
;
bool
onSkipScanlines
(
int
count
)
override
;
Result
onStartScanlineDecode
(
const
SkImageInfo
&
dstInfo
const
Options
&
options
)
override
;
typedef
SkCodec
INHERITED
;
}
;
#
endif
