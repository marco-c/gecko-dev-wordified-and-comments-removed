#
ifndef
SkScalingCodec_DEFINED
#
define
SkScalingCodec_DEFINED
#
include
"
include
/
codec
/
SkCodec
.
h
"
#
include
"
include
/
codec
/
SkEncodedOrigin
.
h
"
#
include
"
include
/
core
/
SkScalar
.
h
"
#
include
"
include
/
core
/
SkSize
.
h
"
#
include
"
include
/
core
/
SkStream
.
h
"
#
include
"
include
/
private
/
SkEncodedInfo
.
h
"
#
include
<
algorithm
>
#
include
<
memory
>
#
include
<
utility
>
class
SkScalingCodec
:
public
SkCodec
{
protected
:
SkScalingCodec
(
SkEncodedInfo
&
&
info
XformFormat
srcFormat
std
:
:
unique_ptr
<
SkStream
>
stream
SkEncodedOrigin
origin
=
kTopLeft_SkEncodedOrigin
)
:
SkCodec
(
std
:
:
move
(
info
)
srcFormat
std
:
:
move
(
stream
)
origin
)
{
}
SkISize
onGetScaledDimensions
(
float
desiredScale
)
const
override
{
SkISize
dim
=
this
-
>
dimensions
(
)
;
dim
.
fWidth
=
std
:
:
max
(
1
SkScalarRoundToInt
(
desiredScale
*
dim
.
fWidth
)
)
;
dim
.
fHeight
=
std
:
:
max
(
1
SkScalarRoundToInt
(
desiredScale
*
dim
.
fHeight
)
)
;
return
dim
;
}
bool
onDimensionsSupported
(
const
SkISize
&
requested
)
override
{
SkISize
dim
=
this
-
>
dimensions
(
)
;
int
w
=
requested
.
width
(
)
;
int
h
=
requested
.
height
(
)
;
return
1
<
=
w
&
&
w
<
=
dim
.
width
(
)
&
&
1
<
=
h
&
&
h
<
=
dim
.
height
(
)
;
}
}
;
#
endif
