#
ifndef
SkBmpStandardCodec_DEFINED
#
define
SkBmpStandardCodec_DEFINED
#
include
"
SkBmpCodec
.
h
"
#
include
"
SkColorTable
.
h
"
#
include
"
SkImageInfo
.
h
"
#
include
"
SkSwizzler
.
h
"
#
include
"
SkTypes
.
h
"
class
SkBmpStandardCodec
:
public
SkBmpCodec
{
public
:
SkBmpStandardCodec
(
int
width
int
height
const
SkEncodedInfo
&
info
SkStream
*
stream
uint16_t
bitsPerPixel
uint32_t
numColors
uint32_t
bytesPerColor
uint32_t
offset
SkCodec
:
:
SkScanlineOrder
rowOrder
bool
isOpaque
bool
inIco
)
;
protected
:
Result
onGetPixels
(
const
SkImageInfo
&
dstInfo
void
*
dst
size_t
dstRowBytes
const
Options
&
SkPMColor
*
int
*
int
*
)
override
;
bool
onInIco
(
)
const
override
{
return
fInIco
;
}
SkCodec
:
:
Result
onPrepareToDecode
(
const
SkImageInfo
&
dstInfo
const
SkCodec
:
:
Options
&
options
SkPMColor
inputColorPtr
[
]
int
*
inputColorCount
)
override
;
uint64_t
onGetFillValue
(
const
SkImageInfo
&
)
const
override
;
SkSampler
*
getSampler
(
bool
createIfNecessary
)
override
{
SkASSERT
(
fSwizzler
)
;
return
fSwizzler
.
get
(
)
;
}
private
:
bool
createColorTable
(
SkColorType
colorType
SkAlphaType
alphaType
int
*
colorCount
)
;
void
initializeSwizzler
(
const
SkImageInfo
&
dstInfo
const
Options
&
opts
)
;
int
decodeRows
(
const
SkImageInfo
&
dstInfo
void
*
dst
size_t
dstRowBytes
const
Options
&
opts
)
override
;
void
decodeIcoMask
(
SkStream
*
stream
const
SkImageInfo
&
dstInfo
void
*
dst
size_t
dstRowBytes
)
;
sk_sp
<
SkColorTable
>
fColorTable
;
const
uint32_t
fNumColors
;
const
uint32_t
fBytesPerColor
;
const
uint32_t
fOffset
;
std
:
:
unique_ptr
<
SkSwizzler
>
fSwizzler
;
std
:
:
unique_ptr
<
uint8_t
[
]
>
fSrcBuffer
;
const
bool
fIsOpaque
;
const
bool
fInIco
;
const
size_t
fAndMaskRowBytes
;
bool
fXformOnDecode
;
typedef
SkBmpCodec
INHERITED
;
}
;
#
endif
