#
include
"
src
/
pdf
/
SkPDFFormXObject
.
h
"
#
include
"
src
/
pdf
/
SkPDFUtils
.
h
"
SkPDFIndirectReference
SkPDFMakeFormXObject
(
SkPDFDocument
*
doc
std
:
:
unique_ptr
<
SkStreamAsset
>
content
std
:
:
unique_ptr
<
SkPDFArray
>
mediaBox
std
:
:
unique_ptr
<
SkPDFDict
>
resourceDict
const
SkMatrix
&
inverseTransform
const
char
*
colorSpace
)
{
std
:
:
unique_ptr
<
SkPDFDict
>
dict
=
SkPDFMakeDict
(
)
;
dict
-
>
insertName
(
"
Type
"
"
XObject
"
)
;
dict
-
>
insertName
(
"
Subtype
"
"
Form
"
)
;
if
(
!
inverseTransform
.
isIdentity
(
)
)
{
dict
-
>
insertObject
(
"
Matrix
"
SkPDFUtils
:
:
MatrixToArray
(
inverseTransform
)
)
;
}
dict
-
>
insertObject
(
"
Resources
"
std
:
:
move
(
resourceDict
)
)
;
dict
-
>
insertObject
(
"
BBox
"
std
:
:
move
(
mediaBox
)
)
;
auto
group
=
SkPDFMakeDict
(
"
Group
"
)
;
group
-
>
insertName
(
"
S
"
"
Transparency
"
)
;
if
(
colorSpace
!
=
nullptr
)
{
group
-
>
insertName
(
"
CS
"
colorSpace
)
;
}
group
-
>
insertBool
(
"
I
"
true
)
;
dict
-
>
insertObject
(
"
Group
"
std
:
:
move
(
group
)
)
;
return
SkPDFStreamOut
(
std
:
:
move
(
dict
)
std
:
:
move
(
content
)
doc
)
;
}
