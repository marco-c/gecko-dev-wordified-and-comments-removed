#
include
"
include
/
core
/
SkTypes
.
h
"
#
if
defined
(
SK_BUILD_FOR_WIN
)
#
include
"
src
/
utils
/
win
/
SkAutoCoInitialize
.
h
"
#
include
<
objbase
.
h
>
#
include
<
winerror
.
h
>
SkAutoCoInitialize
:
:
SkAutoCoInitialize
(
)
:
fHR
(
CoInitializeEx
(
nullptr
COINIT_APARTMENTTHREADED
|
COINIT_DISABLE_OLE1DDE
)
)
{
}
SkAutoCoInitialize
:
:
~
SkAutoCoInitialize
(
)
{
if
(
SUCCEEDED
(
this
-
>
fHR
)
)
{
CoUninitialize
(
)
;
}
}
bool
SkAutoCoInitialize
:
:
succeeded
(
)
{
return
SUCCEEDED
(
this
-
>
fHR
)
|
|
RPC_E_CHANGED_MODE
=
=
this
-
>
fHR
;
}
#
endif
