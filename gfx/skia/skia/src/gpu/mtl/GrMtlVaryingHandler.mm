#
include
"
src
/
gpu
/
mtl
/
GrMtlVaryingHandler
.
h
"
#
if
!
__has_feature
(
objc_arc
)
#
error
This
file
must
be
compiled
with
Arc
.
Use
-
fobjc
-
arc
flag
#
endif
static
void
finalize_helper
(
GrMtlVaryingHandler
:
:
VarArray
&
vars
)
{
int
locationIndex
;
int
componentCount
=
0
;
for
(
locationIndex
=
0
;
locationIndex
<
vars
.
count
(
)
;
locationIndex
+
+
)
{
GrShaderVar
&
var
=
vars
[
locationIndex
]
;
SkASSERT
(
GrSLTypeVecLength
(
var
.
getType
(
)
)
!
=
-
1
)
;
componentCount
+
=
GrSLTypeVecLength
(
var
.
getType
(
)
)
;
SkString
location
;
location
.
appendf
(
"
location
=
%
d
"
locationIndex
)
;
var
.
addLayoutQualifier
(
location
.
c_str
(
)
)
;
}
SkASSERT
(
locationIndex
<
=
32
)
;
SkASSERT
(
componentCount
<
=
60
)
;
}
void
GrMtlVaryingHandler
:
:
onFinalize
(
)
{
finalize_helper
(
fVertexInputs
)
;
finalize_helper
(
fVertexOutputs
)
;
finalize_helper
(
fGeomInputs
)
;
finalize_helper
(
fGeomOutputs
)
;
finalize_helper
(
fFragInputs
)
;
finalize_helper
(
fFragOutputs
)
;
}
