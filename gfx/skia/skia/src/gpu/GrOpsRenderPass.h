#
ifndef
GrOpsRenderPass_DEFINED
#
define
GrOpsRenderPass_DEFINED
#
include
"
include
/
core
/
SkDrawable
.
h
"
#
include
"
src
/
gpu
/
GrPipeline
.
h
"
#
include
"
src
/
gpu
/
ops
/
GrDrawOp
.
h
"
class
GrOpFlushState
;
class
GrFixedClip
;
class
GrGpu
;
class
GrMesh
;
class
GrPipeline
;
class
GrPrimitiveProcessor
;
class
GrProgramInfo
;
class
GrRenderTarget
;
class
GrSemaphore
;
struct
SkIRect
;
struct
SkRect
;
class
GrOpsRenderPass
{
public
:
virtual
~
GrOpsRenderPass
(
)
{
}
virtual
void
insertEventMarker
(
const
char
*
)
=
0
;
struct
LoadAndStoreInfo
{
GrLoadOp
fLoadOp
;
GrStoreOp
fStoreOp
;
SkPMColor4f
fClearColor
;
}
;
struct
StencilLoadAndStoreInfo
{
GrLoadOp
fLoadOp
;
GrStoreOp
fStoreOp
;
}
;
virtual
void
begin
(
)
=
0
;
virtual
void
end
(
)
=
0
;
bool
draw
(
const
GrProgramInfo
&
const
GrMesh
[
]
int
meshCount
const
SkRect
&
bounds
)
;
virtual
void
inlineUpload
(
GrOpFlushState
*
GrDeferredTextureUploadFn
&
)
=
0
;
void
clear
(
const
GrFixedClip
&
const
SkPMColor4f
&
)
;
void
clearStencilClip
(
const
GrFixedClip
&
bool
insideStencilMask
)
;
virtual
void
executeDrawable
(
std
:
:
unique_ptr
<
SkDrawable
:
:
GpuDrawHandler
>
)
{
}
protected
:
GrOpsRenderPass
(
)
:
fOrigin
(
kTopLeft_GrSurfaceOrigin
)
fRenderTarget
(
nullptr
)
{
}
GrOpsRenderPass
(
GrRenderTarget
*
rt
GrSurfaceOrigin
origin
)
:
fOrigin
(
origin
)
fRenderTarget
(
rt
)
{
}
void
set
(
GrRenderTarget
*
rt
GrSurfaceOrigin
origin
)
{
SkASSERT
(
!
fRenderTarget
)
;
fRenderTarget
=
rt
;
fOrigin
=
origin
;
}
GrSurfaceOrigin
fOrigin
;
GrRenderTarget
*
fRenderTarget
;
private
:
virtual
GrGpu
*
gpu
(
)
=
0
;
virtual
void
onDraw
(
const
GrProgramInfo
&
const
GrMesh
[
]
int
meshCount
const
SkRect
&
bounds
)
=
0
;
virtual
void
onClear
(
const
GrFixedClip
&
const
SkPMColor4f
&
)
=
0
;
virtual
void
onClearStencilClip
(
const
GrFixedClip
&
bool
insideStencilMask
)
=
0
;
typedef
GrOpsRenderPass
INHERITED
;
}
;
#
endif
