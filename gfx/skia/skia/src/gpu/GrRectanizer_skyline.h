#
ifndef
GrRectanizer_skyline_DEFINED
#
define
GrRectanizer_skyline_DEFINED
#
include
"
include
/
private
/
SkTDArray
.
h
"
#
include
"
src
/
gpu
/
GrRectanizer
.
h
"
class
GrRectanizerSkyline
:
public
GrRectanizer
{
public
:
GrRectanizerSkyline
(
int
w
int
h
)
:
INHERITED
(
w
h
)
{
this
-
>
reset
(
)
;
}
~
GrRectanizerSkyline
(
)
override
{
}
void
reset
(
)
override
{
fAreaSoFar
=
0
;
fSkyline
.
reset
(
)
;
SkylineSegment
*
seg
=
fSkyline
.
append
(
1
)
;
seg
-
>
fX
=
0
;
seg
-
>
fY
=
0
;
seg
-
>
fWidth
=
this
-
>
width
(
)
;
}
bool
addRect
(
int
w
int
h
SkIPoint16
*
loc
)
override
;
float
percentFull
(
)
const
override
{
return
fAreaSoFar
/
(
(
float
)
this
-
>
width
(
)
*
this
-
>
height
(
)
)
;
}
private
:
struct
SkylineSegment
{
int
fX
;
int
fY
;
int
fWidth
;
}
;
SkTDArray
<
SkylineSegment
>
fSkyline
;
int32_t
fAreaSoFar
;
bool
rectangleFits
(
int
skylineIndex
int
width
int
height
int
*
y
)
const
;
void
addSkylineLevel
(
int
skylineIndex
int
x
int
y
int
width
int
height
)
;
typedef
GrRectanizer
INHERITED
;
}
;
#
endif
