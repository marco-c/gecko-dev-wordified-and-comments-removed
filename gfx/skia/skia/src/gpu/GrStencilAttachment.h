#
ifndef
GrStencilAttachment_DEFINED
#
define
GrStencilAttachment_DEFINED
#
include
"
GrClip
.
h
"
#
include
"
GrGpuResource
.
h
"
class
GrRenderTarget
;
class
GrResourceKey
;
class
GrStencilAttachment
:
public
GrGpuResource
{
public
:
virtual
~
GrStencilAttachment
(
)
{
}
int
width
(
)
const
{
return
fWidth
;
}
int
height
(
)
const
{
return
fHeight
;
}
int
bits
(
)
const
{
return
fBits
;
}
int
numSamples
(
)
const
{
return
fSampleCnt
;
}
void
setLastClip
(
int32_t
clipStackGenID
const
SkIRect
&
clipSpaceRect
const
SkIPoint
clipSpaceToStencilOffset
)
{
fLastClipStackGenID
=
clipStackGenID
;
fLastClipStackRect
=
clipSpaceRect
;
fLastClipSpaceOffset
=
clipSpaceToStencilOffset
;
}
bool
mustRenderClip
(
int32_t
clipStackGenID
const
SkIRect
&
clipSpaceRect
const
SkIPoint
clipSpaceToStencilOffset
)
const
{
return
fLastClipStackGenID
!
=
clipStackGenID
|
|
fLastClipSpaceOffset
!
=
clipSpaceToStencilOffset
|
|
!
fLastClipStackRect
.
contains
(
clipSpaceRect
)
;
}
static
void
ComputeSharedStencilAttachmentKey
(
int
width
int
height
int
sampleCnt
GrUniqueKey
*
key
)
;
protected
:
GrStencilAttachment
(
GrGpu
*
gpu
LifeCycle
lifeCycle
int
width
int
height
int
bits
int
sampleCnt
)
:
GrGpuResource
(
gpu
lifeCycle
)
fWidth
(
width
)
fHeight
(
height
)
fBits
(
bits
)
fSampleCnt
(
sampleCnt
)
fLastClipStackGenID
(
SkClipStack
:
:
kInvalidGenID
)
{
fLastClipStackRect
.
setEmpty
(
)
;
}
private
:
int
fWidth
;
int
fHeight
;
int
fBits
;
int
fSampleCnt
;
int32_t
fLastClipStackGenID
;
SkIRect
fLastClipStackRect
;
SkIPoint
fLastClipSpaceOffset
;
typedef
GrGpuResource
INHERITED
;
}
;
#
endif
