#
include
"
src
/
gpu
/
GrPipeline
.
h
"
#
include
"
src
/
gpu
/
GrProcessor
.
h
"
#
include
"
src
/
gpu
/
GrShaderCaps
.
h
"
#
include
"
src
/
gpu
/
effects
/
GrDisableColorXP
.
h
"
#
include
"
src
/
gpu
/
glsl
/
GrGLSLFragmentShaderBuilder
.
h
"
#
include
"
src
/
gpu
/
glsl
/
GrGLSLProgramDataManager
.
h
"
#
include
"
src
/
gpu
/
glsl
/
GrGLSLXferProcessor
.
h
"
class
DisableColorXP
:
public
GrXferProcessor
{
public
:
DisableColorXP
(
)
:
INHERITED
(
kDisableColorXP_ClassID
)
{
}
private
:
const
char
*
name
(
)
const
override
{
return
"
Disable
Color
"
;
}
bool
onIsEqual
(
const
GrXferProcessor
&
xpBase
)
const
override
{
return
true
;
}
void
onGetGLSLProcessorKey
(
const
GrShaderCaps
&
caps
GrProcessorKeyBuilder
*
b
)
const
override
{
return
;
}
void
onGetBlendInfo
(
GrXferProcessor
:
:
BlendInfo
*
blendInfo
)
const
override
{
blendInfo
-
>
fWriteColor
=
false
;
}
GrGLSLXferProcessor
*
createGLSLInstance
(
)
const
override
;
typedef
GrXferProcessor
INHERITED
;
}
;
class
GLDisableColorXP
:
public
GrGLSLXferProcessor
{
private
:
void
emitOutputsForBlendState
(
const
EmitArgs
&
args
)
override
{
if
(
args
.
fShaderCaps
-
>
mustWriteToFragColor
(
)
)
{
GrGLSLXPFragmentBuilder
*
fragBuilder
=
args
.
fXPFragBuilder
;
fragBuilder
-
>
codeAppendf
(
"
%
s
=
half4
(
0
)
;
"
args
.
fOutputPrimary
)
;
}
}
void
emitOutputSwizzle
(
GrGLSLXPFragmentBuilder
*
const
GrSwizzle
&
const
char
*
const
char
*
)
const
override
{
return
;
}
void
onSetData
(
const
GrGLSLProgramDataManager
&
const
GrXferProcessor
&
)
override
{
}
typedef
GrGLSLXferProcessor
INHERITED
;
}
;
GrGLSLXferProcessor
*
DisableColorXP
:
:
createGLSLInstance
(
)
const
{
return
new
GLDisableColorXP
(
)
;
}
sk_sp
<
const
GrXferProcessor
>
GrDisableColorXPFactory
:
:
MakeXferProcessor
(
)
{
return
sk_make_sp
<
DisableColorXP
>
(
)
;
}
GR_DEFINE_XP_FACTORY_TEST
(
GrDisableColorXPFactory
)
;
#
if
GR_TEST_UTILS
const
GrXPFactory
*
GrDisableColorXPFactory
:
:
TestGet
(
GrProcessorTestData
*
)
{
return
GrDisableColorXPFactory
:
:
Get
(
)
;
}
#
endif
