#
ifndef
GrAHardwareBufferImageGenerator_DEFINED
#
define
GrAHardwareBufferImageGenerator_DEFINED
#
include
"
SkImageGenerator
.
h
"
#
include
"
GrTypesPriv
.
h
"
class
GrGpuResource
;
extern
"
C
"
{
typedef
struct
AHardwareBuffer
AHardwareBuffer
;
}
class
GrAHardwareBufferImageGenerator
:
public
SkImageGenerator
{
public
:
static
std
:
:
unique_ptr
<
SkImageGenerator
>
Make
(
AHardwareBuffer
*
SkAlphaType
sk_sp
<
SkColorSpace
>
GrSurfaceOrigin
)
;
~
GrAHardwareBufferImageGenerator
(
)
override
;
typedef
void
*
DeleteImageCtx
;
typedef
void
(
*
DeleteImageProc
)
(
DeleteImageCtx
)
;
static
void
DeleteGLTexture
(
void
*
ctx
)
;
#
ifdef
SK_VULKAN
static
void
DeleteVkImage
(
void
*
ctx
)
;
#
endif
protected
:
bool
onIsValid
(
GrContext
*
)
const
override
;
TexGenType
onCanGenerateTexture
(
)
const
override
{
return
TexGenType
:
:
kCheap
;
}
sk_sp
<
GrTextureProxy
>
onGenerateTexture
(
GrContext
*
const
SkImageInfo
&
const
SkIPoint
&
bool
willNeedMipMaps
)
override
;
private
:
GrAHardwareBufferImageGenerator
(
const
SkImageInfo
&
AHardwareBuffer
*
SkAlphaType
bool
isProtectedContent
uint32_t
bufferFormat
GrSurfaceOrigin
surfaceOrigin
)
;
sk_sp
<
GrTextureProxy
>
makeProxy
(
GrContext
*
context
)
;
void
releaseTextureRef
(
)
;
static
void
ReleaseRefHelper_TextureReleaseProc
(
void
*
ctx
)
;
AHardwareBuffer
*
fHardwareBuffer
;
uint32_t
fBufferFormat
;
const
bool
fIsProtectedContent
;
GrSurfaceOrigin
fSurfaceOrigin
;
typedef
SkImageGenerator
INHERITED
;
}
;
#
endif
