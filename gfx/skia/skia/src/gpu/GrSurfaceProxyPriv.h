#
ifndef
GrSurfaceProxyPriv_DEFINED
#
define
GrSurfaceProxyPriv_DEFINED
#
include
"
GrSurfaceProxy
.
h
"
#
include
"
GrResourceProvider
.
h
"
class
GrSurfaceProxyPriv
{
public
:
bool
isInstantiated
(
)
const
{
return
SkToBool
(
fProxy
-
>
fTarget
)
;
}
GrSurface
*
peekSurface
(
)
const
{
SkASSERT
(
fProxy
-
>
fTarget
)
;
return
fProxy
-
>
fTarget
;
}
GrTexture
*
peekTexture
(
)
const
{
return
fProxy
-
>
fTarget
?
fProxy
-
>
fTarget
-
>
asTexture
(
)
:
nullptr
;
}
GrRenderTarget
*
peekRenderTarget
(
)
const
{
SkASSERT
(
fProxy
-
>
fTarget
&
&
fProxy
-
>
fTarget
-
>
asRenderTarget
(
)
)
;
return
fProxy
-
>
fTarget
?
fProxy
-
>
fTarget
-
>
asRenderTarget
(
)
:
nullptr
;
}
bool
hasPendingIO
(
)
const
{
return
fProxy
-
>
hasPendingIO
(
)
;
}
bool
hasPendingWrite
(
)
const
{
return
fProxy
-
>
hasPendingWrite
(
)
;
}
void
computeScratchKey
(
GrScratchKey
*
key
)
const
{
return
fProxy
-
>
computeScratchKey
(
key
)
;
}
sk_sp
<
GrSurface
>
createSurface
(
GrResourceProvider
*
resourceProvider
)
const
{
return
fProxy
-
>
createSurface
(
resourceProvider
)
;
}
void
assign
(
sk_sp
<
GrSurface
>
surface
)
{
fProxy
-
>
assign
(
std
:
:
move
(
surface
)
)
;
}
bool
requiresNoPendingIO
(
)
const
{
return
fProxy
-
>
fFlags
&
GrResourceProvider
:
:
kNoPendingIO_Flag
;
}
bool
isExact
(
)
const
{
return
SkBackingFit
:
:
kExact
=
=
fProxy
-
>
fFit
;
}
void
exactify
(
)
;
bool
doLazyInstantiation
(
GrResourceProvider
*
)
;
GrSurfaceProxy
:
:
LazyInstantiationType
lazyInstantiationType
(
)
const
{
return
fProxy
-
>
fLazyInstantiationType
;
}
void
testingOnly_setLazyInstantiationType
(
GrSurfaceProxy
:
:
LazyInstantiationType
lazyType
)
{
fProxy
-
>
fLazyInstantiationType
=
lazyType
;
}
static
bool
AttachStencilIfNeeded
(
GrResourceProvider
*
GrSurface
*
bool
needsStencil
)
;
private
:
explicit
GrSurfaceProxyPriv
(
GrSurfaceProxy
*
proxy
)
:
fProxy
(
proxy
)
{
}
GrSurfaceProxyPriv
(
const
GrSurfaceProxyPriv
&
)
{
}
GrSurfaceProxyPriv
&
operator
=
(
const
GrSurfaceProxyPriv
&
)
;
const
GrSurfaceProxyPriv
*
operator
&
(
)
const
;
GrSurfaceProxyPriv
*
operator
&
(
)
;
GrSurfaceProxy
*
fProxy
;
friend
class
GrSurfaceProxy
;
}
;
inline
GrSurfaceProxyPriv
GrSurfaceProxy
:
:
priv
(
)
{
return
GrSurfaceProxyPriv
(
this
)
;
}
inline
const
GrSurfaceProxyPriv
GrSurfaceProxy
:
:
priv
(
)
const
{
return
GrSurfaceProxyPriv
(
const_cast
<
GrSurfaceProxy
*
>
(
this
)
)
;
}
#
endif
