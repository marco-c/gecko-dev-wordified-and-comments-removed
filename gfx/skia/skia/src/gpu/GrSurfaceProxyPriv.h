#
ifndef
GrSurfaceProxyPriv_DEFINED
#
define
GrSurfaceProxyPriv_DEFINED
#
include
"
GrSurfaceProxy
.
h
"
#
include
"
GrResourceProvider
.
h
"
class
GrSurfaceProxyPriv
{
public
:
int32_t
getProxyRefCnt
(
)
const
{
return
fProxy
-
>
getProxyRefCnt
(
)
;
}
bool
hasPendingIO
(
)
const
{
return
fProxy
-
>
hasPendingIO
(
)
;
}
bool
hasPendingWrite
(
)
const
{
return
fProxy
-
>
hasPendingWrite
(
)
;
}
void
computeScratchKey
(
GrScratchKey
*
key
)
const
{
return
fProxy
-
>
computeScratchKey
(
key
)
;
}
sk_sp
<
GrSurface
>
createSurface
(
GrResourceProvider
*
resourceProvider
)
const
{
return
fProxy
-
>
createSurface
(
resourceProvider
)
;
}
void
assign
(
sk_sp
<
GrSurface
>
surface
)
{
fProxy
-
>
assign
(
std
:
:
move
(
surface
)
)
;
}
bool
requiresNoPendingIO
(
)
const
{
return
fProxy
-
>
fSurfaceFlags
&
GrInternalSurfaceFlags
:
:
kNoPendingIO
;
}
bool
isExact
(
)
const
{
return
SkBackingFit
:
:
kExact
=
=
fProxy
-
>
fFit
;
}
void
exactify
(
)
;
bool
doLazyInstantiation
(
GrResourceProvider
*
)
;
GrSurfaceProxy
:
:
LazyInstantiationType
lazyInstantiationType
(
)
const
{
return
fProxy
-
>
fLazyInstantiationType
;
}
bool
isSafeToUninstantiate
(
)
const
{
return
SkToBool
(
fProxy
-
>
fTarget
)
&
&
SkToBool
(
fProxy
-
>
fLazyInstantiateCallback
)
&
&
GrSurfaceProxy
:
:
LazyInstantiationType
:
:
kUninstantiate
=
=
lazyInstantiationType
(
)
;
}
static
bool
SK_WARN_UNUSED_RESULT
AttachStencilIfNeeded
(
GrResourceProvider
*
GrSurface
*
bool
needsStencil
)
;
private
:
explicit
GrSurfaceProxyPriv
(
GrSurfaceProxy
*
proxy
)
:
fProxy
(
proxy
)
{
}
GrSurfaceProxyPriv
(
const
GrSurfaceProxyPriv
&
)
{
}
GrSurfaceProxyPriv
&
operator
=
(
const
GrSurfaceProxyPriv
&
)
;
const
GrSurfaceProxyPriv
*
operator
&
(
)
const
;
GrSurfaceProxyPriv
*
operator
&
(
)
;
GrSurfaceProxy
*
fProxy
;
friend
class
GrSurfaceProxy
;
}
;
inline
GrSurfaceProxyPriv
GrSurfaceProxy
:
:
priv
(
)
{
return
GrSurfaceProxyPriv
(
this
)
;
}
inline
const
GrSurfaceProxyPriv
GrSurfaceProxy
:
:
priv
(
)
const
{
return
GrSurfaceProxyPriv
(
const_cast
<
GrSurfaceProxy
*
>
(
this
)
)
;
}
#
endif
