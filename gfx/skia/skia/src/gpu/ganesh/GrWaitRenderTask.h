#
ifndef
GrWaitRenderTask_DEFINED
#
define
GrWaitRenderTask_DEFINED
#
include
"
src
/
gpu
/
ganesh
/
GrRenderTask
.
h
"
#
include
"
src
/
gpu
/
ganesh
/
GrSemaphore
.
h
"
class
GrWaitRenderTask
final
:
public
GrRenderTask
{
public
:
GrWaitRenderTask
(
GrSurfaceProxyView
surfaceView
std
:
:
unique_ptr
<
std
:
:
unique_ptr
<
GrSemaphore
>
[
]
>
semaphores
int
numSemaphores
)
:
GrRenderTask
(
)
fSemaphores
(
std
:
:
move
(
semaphores
)
)
fNumSemaphores
(
numSemaphores
)
fWaitedOn
(
std
:
:
move
(
surfaceView
)
)
{
}
private
:
bool
onIsUsed
(
GrSurfaceProxy
*
proxy
)
const
override
{
return
proxy
=
=
fWaitedOn
.
proxy
(
)
;
}
void
gatherProxyIntervals
(
GrResourceAllocator
*
)
const
override
;
ExpectedOutcome
onMakeClosed
(
GrRecordingContext
*
SkIRect
*
)
override
{
return
ExpectedOutcome
:
:
kTargetUnchanged
;
}
bool
onExecute
(
GrOpFlushState
*
)
override
;
#
if
GR_TEST_UTILS
const
char
*
name
(
)
const
final
{
return
"
Wait
"
;
}
#
endif
#
ifdef
SK_DEBUG
void
visitProxies_debugOnly
(
const
GrVisitProxyFunc
&
)
const
override
{
}
#
endif
std
:
:
unique_ptr
<
std
:
:
unique_ptr
<
GrSemaphore
>
[
]
>
fSemaphores
;
int
fNumSemaphores
;
GrSurfaceProxyView
fWaitedOn
;
}
;
#
endif
