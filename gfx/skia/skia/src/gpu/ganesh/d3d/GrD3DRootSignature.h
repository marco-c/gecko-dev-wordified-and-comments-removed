#
ifndef
GrD3DRootSignature_DEFINED
#
define
GrD3DRootSignature_DEFINED
#
include
"
include
/
gpu
/
d3d
/
GrD3DTypes
.
h
"
#
include
"
src
/
gpu
/
ganesh
/
GrManagedResource
.
h
"
class
GrD3DGpu
;
class
GrD3DRootSignature
:
public
GrManagedResource
{
public
:
static
sk_sp
<
GrD3DRootSignature
>
Make
(
GrD3DGpu
*
gpu
int
numTextureSamplers
int
numUAVs
)
;
enum
class
ParamIndex
{
kConstantBufferView
=
0
kShaderViewDescriptorTable
=
1
kSamplerDescriptorTable
=
2
kLast
=
kSamplerDescriptorTable
}
;
inline
static
constexpr
unsigned
int
kParamIndexCount
=
(
unsigned
int
)
(
ParamIndex
:
:
kLast
)
+
1
;
bool
isCompatible
(
int
numTextureSamplers
int
numUAVs
)
const
;
ID3D12RootSignature
*
rootSignature
(
)
const
{
return
fRootSignature
.
get
(
)
;
}
#
ifdef
SK_TRACE_MANAGED_RESOURCES
void
dumpInfo
(
)
const
override
{
SkDebugf
(
"
GrD3DRootSignature
:
%
p
numTextures
:
%
d
(
%
d
refs
)
\
n
"
fRootSignature
.
get
(
)
fNumTextureSamplers
this
-
>
getRefCnt
(
)
)
;
}
#
endif
private
:
GrD3DRootSignature
(
gr_cp
<
ID3D12RootSignature
>
rootSig
int
numTextureSamplers
int
numUAVs
)
;
void
freeGPUData
(
)
const
override
{
}
gr_cp
<
ID3D12RootSignature
>
fRootSignature
;
int
fNumTextureSamplers
;
int
fNumUAVs
;
}
;
#
endif
