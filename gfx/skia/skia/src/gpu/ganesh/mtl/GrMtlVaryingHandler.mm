#
include
"
src
/
gpu
/
ganesh
/
mtl
/
GrMtlVaryingHandler
.
h
"
#
include
"
include
/
private
/
gpu
/
ganesh
/
GrMtlTypesPriv
.
h
"
#
if
!
__has_feature
(
objc_arc
)
#
error
This
file
must
be
compiled
with
Arc
.
Use
-
fobjc
-
arc
flag
#
endif
GR_NORETAIN_BEGIN
static
void
finalize_helper
(
GrMtlVaryingHandler
:
:
VarArray
&
vars
)
{
int
locationIndex
=
0
;
SkDEBUGCODE
(
int
componentCount
=
0
)
;
for
(
GrShaderVar
&
var
:
vars
.
items
(
)
)
{
SkASSERT
(
SkSLTypeVecLength
(
var
.
getType
(
)
)
!
=
-
1
)
;
SkDEBUGCODE
(
componentCount
+
=
SkSLTypeVecLength
(
var
.
getType
(
)
)
)
;
SkString
location
;
location
.
appendf
(
"
location
=
%
d
"
locationIndex
)
;
var
.
addLayoutQualifier
(
location
.
c_str
(
)
)
;
+
+
locationIndex
;
}
SkASSERT
(
locationIndex
<
=
32
)
;
SkASSERT
(
componentCount
<
=
60
)
;
}
void
GrMtlVaryingHandler
:
:
onFinalize
(
)
{
finalize_helper
(
fVertexInputs
)
;
finalize_helper
(
fVertexOutputs
)
;
finalize_helper
(
fFragInputs
)
;
finalize_helper
(
fFragOutputs
)
;
}
GR_NORETAIN_END
