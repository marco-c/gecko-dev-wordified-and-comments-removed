#
ifndef
GrGLSLXferProcessor_DEFINED
#
define
GrGLSLXferProcessor_DEFINED
#
include
"
glsl
/
GrGLSLProgramDataManager
.
h
"
#
include
"
glsl
/
GrGLSLTextureSampler
.
h
"
class
GrXferProcessor
;
class
GrGLSLXPBuilder
;
class
GrGLSLXPFragmentBuilder
;
class
GrGLSLCaps
;
class
GrGLSLXferProcessor
{
public
:
GrGLSLXferProcessor
(
)
{
}
virtual
~
GrGLSLXferProcessor
(
)
{
}
typedef
GrGLSLTextureSampler
:
:
TextureSamplerArray
TextureSamplerArray
;
struct
EmitArgs
{
EmitArgs
(
GrGLSLXPBuilder
*
pb
GrGLSLXPFragmentBuilder
*
fragBuilder
const
GrGLSLCaps
*
caps
const
GrXferProcessor
&
xp
const
char
*
inputColor
const
char
*
inputCoverage
const
char
*
outputPrimary
const
char
*
outputSecondary
const
TextureSamplerArray
&
samplers
)
:
fPB
(
pb
)
fXPFragBuilder
(
fragBuilder
)
fGLSLCaps
(
caps
)
fXP
(
xp
)
fInputColor
(
inputColor
)
fInputCoverage
(
inputCoverage
)
fOutputPrimary
(
outputPrimary
)
fOutputSecondary
(
outputSecondary
)
fSamplers
(
samplers
)
{
}
GrGLSLXPBuilder
*
fPB
;
GrGLSLXPFragmentBuilder
*
fXPFragBuilder
;
const
GrGLSLCaps
*
fGLSLCaps
;
const
GrXferProcessor
&
fXP
;
const
char
*
fInputColor
;
const
char
*
fInputCoverage
;
const
char
*
fOutputPrimary
;
const
char
*
fOutputSecondary
;
const
TextureSamplerArray
&
fSamplers
;
}
;
void
emitCode
(
const
EmitArgs
&
)
;
void
setData
(
const
GrGLSLProgramDataManager
&
pdm
const
GrXferProcessor
&
xp
)
;
private
:
virtual
void
emitOutputsForBlendState
(
const
EmitArgs
&
)
{
SkFAIL
(
"
emitOutputsForBlendState
not
implemented
.
"
)
;
}
virtual
void
emitBlendCodeForDstRead
(
GrGLSLXPBuilder
*
GrGLSLXPFragmentBuilder
*
const
char
*
srcColor
const
char
*
srcCoverage
const
char
*
dstColor
const
char
*
outColor
const
char
*
outColorSecondary
const
GrXferProcessor
&
)
{
SkFAIL
(
"
emitBlendCodeForDstRead
not
implemented
.
"
)
;
}
virtual
void
onSetData
(
const
GrGLSLProgramDataManager
&
const
GrXferProcessor
&
)
=
0
;
GrGLSLProgramDataManager
:
:
UniformHandle
fDstTopLeftUni
;
GrGLSLProgramDataManager
:
:
UniformHandle
fDstScaleUni
;
}
;
#
endif
