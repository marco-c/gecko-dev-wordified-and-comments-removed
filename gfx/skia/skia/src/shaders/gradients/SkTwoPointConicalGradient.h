#
ifndef
SkTwoPointConicalGradient_DEFINED
#
define
SkTwoPointConicalGradient_DEFINED
#
include
"
SkColorSpaceXformer
.
h
"
#
include
"
SkGradientShaderPriv
.
h
"
class
SkTwoPointConicalGradient
final
:
public
SkGradientShaderBase
{
public
:
struct
FocalData
{
SkScalar
fR1
;
SkScalar
fFocalX
;
bool
fIsSwapped
;
void
set
(
SkScalar
r0
SkScalar
r1
SkMatrix
&
matrix
)
;
bool
isFocalOnCircle
(
)
const
{
return
SkScalarNearlyZero
(
1
-
fR1
)
;
}
bool
isSwapped
(
)
const
{
return
fIsSwapped
;
}
bool
isWellBehaved
(
)
const
{
return
!
this
-
>
isFocalOnCircle
(
)
&
&
fR1
>
1
;
}
bool
isNativelyFocal
(
)
const
{
return
SkScalarNearlyZero
(
fFocalX
)
;
}
}
;
enum
class
Type
{
kRadial
kStrip
kFocal
}
;
static
sk_sp
<
SkShader
>
Create
(
const
SkPoint
&
start
SkScalar
startRadius
const
SkPoint
&
end
SkScalar
endRadius
const
Descriptor
&
)
;
SkShader
:
:
GradientType
asAGradient
(
GradientInfo
*
info
)
const
override
;
#
if
SK_SUPPORT_GPU
std
:
:
unique_ptr
<
GrFragmentProcessor
>
asFragmentProcessor
(
const
GrFPArgs
&
)
const
override
;
#
endif
bool
isOpaque
(
)
const
override
;
SkScalar
getCenterX1
(
)
const
{
return
SkPoint
:
:
Distance
(
fCenter1
fCenter2
)
;
}
SkScalar
getStartRadius
(
)
const
{
return
fRadius1
;
}
SkScalar
getDiffRadius
(
)
const
{
return
fRadius2
-
fRadius1
;
}
const
SkPoint
&
getStartCenter
(
)
const
{
return
fCenter1
;
}
const
SkPoint
&
getEndCenter
(
)
const
{
return
fCenter2
;
}
SkScalar
getEndRadius
(
)
const
{
return
fRadius2
;
}
Type
getType
(
)
const
{
return
fType
;
}
const
SkMatrix
&
getGradientMatrix
(
)
const
{
return
fPtsToUnit
;
}
const
FocalData
&
getFocalData
(
)
const
{
return
fFocalData
;
}
SK_TO_STRING_OVERRIDE
(
)
SK_DECLARE_PUBLIC_FLATTENABLE_DESERIALIZATION_PROCS
(
SkTwoPointConicalGradient
)
protected
:
void
flatten
(
SkWriteBuffer
&
buffer
)
const
override
;
sk_sp
<
SkShader
>
onMakeColorSpace
(
SkColorSpaceXformer
*
xformer
)
const
override
;
void
appendGradientStages
(
SkArenaAlloc
*
alloc
SkRasterPipeline
*
tPipeline
SkRasterPipeline
*
postPipeline
)
const
override
;
bool
onIsRasterPipelineOnly
(
const
SkMatrix
&
)
const
override
{
return
true
;
}
private
:
SkTwoPointConicalGradient
(
const
SkPoint
&
c0
SkScalar
r0
const
SkPoint
&
c1
SkScalar
r1
const
Descriptor
&
Type
const
SkMatrix
&
const
FocalData
&
)
;
SkPoint
fCenter1
;
SkPoint
fCenter2
;
SkScalar
fRadius1
;
SkScalar
fRadius2
;
Type
fType
;
FocalData
fFocalData
;
friend
class
SkGradientShader
;
typedef
SkGradientShaderBase
INHERITED
;
}
;
#
endif
