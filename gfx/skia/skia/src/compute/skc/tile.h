#
ifndef
SKC_ONCE_TILE
#
define
SKC_ONCE_TILE
#
include
"
macros
.
h
"
#
define
SKC_SUBPIXEL_RESL_X_LOG2
5
#
define
SKC_SUBPIXEL_RESL_Y_LOG2
5
#
define
SKC_TILE_WIDTH
(
1
<
<
SKC_TILE_WIDTH_LOG2
)
#
define
SKC_TILE_HEIGHT
(
1
<
<
SKC_TILE_HEIGHT_LOG2
)
#
define
SKC_SUBPIXEL_RESL_X
(
1
<
<
SKC_SUBPIXEL_RESL_X_LOG2
)
#
define
SKC_SUBPIXEL_RESL_Y
(
1
<
<
SKC_SUBPIXEL_RESL_Y_LOG2
)
#
define
SKC_TILE_WIDTH_MASK
SKC_BITS_TO_MASK
(
SKC_TILE_WIDTH_LOG2
)
#
define
SKC_TILE_HEIGHT_MASK
SKC_BITS_TO_MASK
(
SKC_TILE_HEIGHT_LOG2
)
#
define
SKC_SUBPIXEL_RESL_X
(
1
<
<
SKC_SUBPIXEL_RESL_X_LOG2
)
#
define
SKC_SUBPIXEL_RESL_Y
(
1
<
<
SKC_SUBPIXEL_RESL_Y_LOG2
)
#
define
SKC_SUBPIXEL_MASK_X
SKC_BITS_TO_MASK
(
SKC_SUBPIXEL_RESL_X_LOG2
)
#
define
SKC_SUBPIXEL_MASK_Y
SKC_BITS_TO_MASK
(
SKC_SUBPIXEL_RESL_Y_LOG2
)
#
define
SKC_SUBPIXEL_RESL_X_F32
(
(
float
)
(
SKC_SUBPIXEL_RESL_X
)
)
#
define
SKC_SUBPIXEL_RESL_Y_F32
(
(
float
)
(
SKC_SUBPIXEL_RESL_Y
)
)
#
define
SKC_SUBPIXEL_X_SCALE_UP
SKC_SUBPIXEL_RESL_X_F32
#
define
SKC_SUBPIXEL_Y_SCALE_UP
SKC_SUBPIXEL_RESL_Y_F32
#
define
SKC_SUBPIXEL_X_SCALE_DOWN
(
1
.
0f
/
SKC_SUBPIXEL_RESL_X_F32
)
#
define
SKC_SUBPIXEL_Y_SCALE_DOWN
(
1
.
0f
/
SKC_SUBPIXEL_RESL_Y_F32
)
#
define
SKC_SUBTILE_RESL_X_LOG2
(
SKC_TILE_WIDTH_LOG2
+
SKC_SUBPIXEL_RESL_X_LOG2
)
#
define
SKC_SUBTILE_RESL_Y_LOG2
(
SKC_TILE_HEIGHT_LOG2
+
SKC_SUBPIXEL_RESL_Y_LOG2
)
#
define
SKC_SUBTILE_RESL_X
(
1
<
<
SKC_SUBTILE_RESL_X_LOG2
)
#
define
SKC_SUBTILE_RESL_Y
(
1
<
<
SKC_SUBTILE_RESL_Y_LOG2
)
#
define
SKC_SUBTILE_MASK_X
SKC_BITS_TO_MASK
(
SKC_SUBTILE_RESL_X_LOG2
)
#
define
SKC_SUBTILE_MASK_Y
SKC_BITS_TO_MASK
(
SKC_SUBTILE_RESL_Y_LOG2
)
#
define
SKC_SUBTILE_RESL_X_F32
(
(
float
)
(
SKC_SUBTILE_RESL_X
)
)
#
define
SKC_SUBTILE_RESL_Y_F32
(
(
float
)
(
SKC_SUBTILE_RESL_Y
)
)
#
define
SKC_SUBTILE_X_SCALE_DOWN
(
1
.
0f
/
SKC_SUBTILE_RESL_X_F32
)
#
define
SKC_SUBTILE_Y_SCALE_DOWN
(
1
.
0f
/
SKC_SUBTILE_RESL_Y_F32
)
#
define
SKC_TILE_X_OFFSET_U32
(
1
<
<
(
SKC_TTSK_BITS_X
-
1
)
)
#
define
SKC_TILE_X_SPAN_U32
(
1
<
<
(
SKC_TTSK_BITS_X
)
)
/
/
exclusive
#
define
SKC_TILE_Y_OFFSET_U32
(
1
<
<
(
SKC_TTSK_BITS_Y
-
1
)
)
#
define
SKC_TILE_Y_SPAN_U32
(
1
<
<
(
SKC_TTSK_BITS_Y
)
)
/
/
exclusive
#
define
SKC_TILE_X_OFFSET_F32
0
/
/
(
(
float
)
SKC_TILE_X_OFFSET_U32
)
#
define
SKC_TILE_X_SPAN_F32
(
(
float
)
SKC_TILE_X_SPAN_U32
)
#
define
SKC_TILE_Y_OFFSET_F32
0
/
/
(
(
float
)
SKC_TILE_Y_OFFSET_U32
)
#
define
SKC_TILE_Y_SPAN_F32
(
(
float
)
SKC_TILE_Y_SPAN_U32
)
#
define
SKC_TTS_BITS_TX
10
#
define
SKC_TTS_BITS_SX
6
#
define
SKC_TTS_BITS_TY
10
#
define
SKC_TTS_BITS_SY
6
#
define
SKC_TTS_INVALID
(
SKC_UINT_MAX
)
/
/
relies
on
limited
range
of
dx
#
define
SKC_TTS_OFFSET_SX
(
SKC_TTS_BITS_TX
)
#
define
SKC_TTS_OFFSET_TY
(
SKC_TTS_BITS_TX
+
SKC_TTS_BITS_SX
)
#
define
SKC_TTS_OFFSET_DY
(
SKC_TTS_BITS_TX
+
SKC_TTS_BITS_SX
+
SKC_TTS_BITS_TY
)
#
define
SKC_TTS_MASK_TX
SKC_BITS_TO_MASK
(
SKC_TTS_BITS_TX
)
#
define
SKC_TTS_MASK_SX
SKC_BITS_TO_MASK_AT
(
SKC_TTS_BITS_SX
SKC_TTS_OFFSET_SX
)
#
define
SKC_TTS_MASK_TY
SKC_BITS_TO_MASK_AT
(
SKC_TTS_BITS_TY
SKC_TTS_OFFSET_TY
)
#
define
SKC_TTS_MASK_TX_PIXEL
SKC_BITS_TO_MASK_AT
(
SKC_TTS_BITS_TX
-
SKC_SUBPIXEL_RESL_X_LOG2
\
SKC_SUBPIXEL_RESL_X_LOG2
)
#
define
SKC_TTS_MASK_TY_PIXEL
SKC_BITS_TO_MASK_AT
(
SKC_TTS_BITS_TY
-
SKC_SUBPIXEL_RESL_Y_LOG2
\
SKC_TTS_OFFSET_TY
+
SKC_SUBPIXEL_RESL_Y_LOG2
)
#
define
SKC_TTXK_LO_BITS_ID
27
#
define
SKC_TTXK_LO_BITS_PREFIX
1
#
define
SKC_TTXK_HI_BITS_Y
12
#
define
SKC_TTXK_HI_BITS_X
12
#
define
SKC_TTXK_BITS_SPAN
12
#
define
SKC_TTXK_HI_BITS_YX
(
SKC_TTXK_HI_BITS_Y
+
SKC_TTXK_HI_BITS_X
)
#
define
SKC_TTRK_HI_MASK_X
SKC_BITS_TO_MASK
(
SKC_TTXK_HI_BITS_X
)
#
define
SKC_TTRK_HI_MASK_YX
SKC_BITS_TO_MASK
(
SKC_TTXK_HI_BITS_YX
)
#
define
SKC_TTRK_HI_BITS_COHORT
8
#
define
SKC_TTRK_LO_BITS_NA
(
32
-
SKC_TTXK_LO_BITS_ID
)
#
define
SKC_TTRK_HI_BITS_COHORT_Y
(
SKC_TTRK_HI_BITS_COHORT
+
SKC_TTXK_HI_BITS_Y
)
#
define
SKC_TTRK_HI_OFFSET_COHORT
(
32
-
SKC_TTRK_HI_BITS_COHORT
)
#
define
SKC_TTRK_HI_MASK_COHORT
SKC_BITS_TO_MASK_AT
(
SKC_TTRK_HI_BITS_COHORT
SKC_TTRK_HI_OFFSET_COHORT
)
#
define
SKC_TTRK_HI_BITS_COHORT_YX
(
SKC_TTRK_HI_BITS_COHORT
+
SKC_TTXK_HI_BITS_Y
+
SKC_TTXK_HI_BITS_X
)
#
define
SKC_TTXK_LO_BITS_ID_PREFIX
(
SKC_TTXK_LO_BITS_ID
+
SKC_TTXK_LO_BITS_PREFIX
)
#
define
SKC_TTXK_LO_OFFSET_PREFIX
SKC_TTXK_LO_BITS_ID
#
define
SKC_TTXK_LO_OFFSET_SPAN
SKC_TTXK_LO_BITS_ID_PREFIX
#
define
SKC_TTXK_LO_BITS_SPAN
(
32
-
SKC_TTXK_LO_BITS_ID_PREFIX
)
#
define
SKC_TTXK_HI_BITS_SPAN
(
SKC_TTXK_BITS_SPAN
-
SKC_TTXK_LO_BITS_SPAN
)
#
define
SKC_TTXK_LO_OFFSET_PREFIX
SKC_TTXK_LO_BITS_ID
#
define
SKC_TTXK_LO_MASK_ID
SKC_BITS_TO_MASK
(
SKC_TTXK_LO_BITS_ID
)
#
define
SKC_TTXK_LO_MASK_PREFIX
SKC_BITS_TO_MASK_AT
(
SKC_TTXK_LO_BITS_PREFIX
SKC_TTXK_LO_OFFSET_PREFIX
)
#
define
SKC_TTXK_LO_MASK_ID_PREFIX
SKC_BITS_TO_MASK
(
SKC_TTXK_LO_BITS_ID_PREFIX
)
#
define
SKC_TTXK_HI_OFFSET_Y
(
32
-
SKC_TTXK_HI_BITS_Y
)
#
define
SKC_TTXK_HI_OFFSET_X
(
SKC_TTXK_HI_OFFSET_Y
-
SKC_TTXK_HI_BITS_X
)
#
define
SKC_TTXK_HI_ONE_X
(
1u
<
<
SKC_TTXK_HI_OFFSET_X
)
#
define
SKC_TTXK_HI_MASK_YX
SKC_BITS_TO_MASK_AT
(
SKC_TTXK_HI_BITS_YX
SKC_TTXK_HI_OFFSET_X
)
#
define
SKC_TTXK_HI_MASK_Y
SKC_BITS_TO_MASK_AT
(
SKC_TTXK_HI_BITS_Y
SKC_TTXK_HI_OFFSET_Y
)
#
define
SKC_TTPK_LO_SHL_YX_SPAN
(
SKC_TTXK_LO_OFFSET_SPAN
-
SKC_TTXK_HI_OFFSET_X
)
#
define
SKC_TTPK_HI_SHR_YX_SPAN
(
SKC_TTXK_HI_OFFSET_X
+
SKC_TTXK_LO_BITS_SPAN
)
#
define
SKC_TTCK_BITS_LAYER
18
#
define
SKC_TTCK_LO_BITS_ID
SKC_TTXK_LO_BITS_ID
#
define
SKC_TTCK_LO_OFFSET_ID
0
#
define
SKC_TTCK_LO_MASK_ID
SKC_BITS_TO_MASK
(
SKC_TTCK_LO_BITS_ID
)
#
define
SKC_TTCK_LO_BITS_PREFIX
1
#
define
SKC_TTCK_LO_OFFSET_PREFIX
SKC_TTCK_LO_BITS_ID
#
define
SKC_TTCK_LO_MASK_PREFIX
SKC_BITS_TO_MASK_AT
(
SKC_TTCK_LO_BITS_PREFIX
SKC_TTCK_LO_OFFSET_PREFIX
)
#
define
SKC_TTCK_LO_BITS_ID_PREFIX
(
SKC_TTCK_LO_BITS_ID
+
SKC_TTCK_LO_BITS_PREFIX
)
#
define
SKC_TTCK_LO_MASK_ID_PREFIX
SKC_BITS_TO_MASK
(
SKC_TTCK_LO_BITS_ID_PREFIX
)
#
define
SKC_TTCK_LO_BITS_ESCAPE
1
#
define
SKC_TTCK_LO_OFFSET_ESCAPE
SKC_TTCK_LO_BITS_ID_PREFIX
#
define
SKC_TTCK_LO_MASK_ESCAPE
SKC_BITS_TO_MASK_AT
(
SKC_TTCK_LO_BITS_ESCAPE
SKC_TTCK_LO_OFFSET_ESCAPE
)
#
define
SKC_TTCK_LO_BITS_ID_PREFIX_ESCAPE
(
SKC_TTCK_LO_BITS_ID_PREFIX
+
SKC_TTCK_LO_BITS_ESCAPE
)
#
define
SKC_TTCK_HI_OFFSET_Y
24
#
define
SKC_TTCK_HI_OFFSET_X
15
#
define
SKC_TTCK_HI_BITS_Y
8
#
define
SKC_TTCK_HI_BITS_X
9
#
define
SKC_TTCK_HI_BITS_YX
(
SKC_TTCK_HI_BITS_X
+
SKC_TTCK_HI_BITS_Y
)
#
define
SKC_TTCK_HI_MASK_YX
SKC_BITS_TO_MASK_AT
(
SKC_TTCK_HI_BITS_YX
SKC_TTCK_HI_OFFSET_X
)
#
define
SKC_TTCK_HI_BITS_LAYER
(
32
-
SKC_TTCK_HI_BITS_YX
)
#
define
SKC_TTCK_HI_MASK_LAYER
SKC_BITS_TO_MASK
(
SKC_TTCK_HI_BITS_LAYER
)
#
define
SKC_TTCK_HI_SHR_LAYER
(
SKC_TTCK_HI_BITS_Y
+
SKC_TTCK_HI_BITS_X
+
SKC_TTCK_BITS_LAYER
-
32
)
#
define
SKC_TTCK_LO_BITS_LAYER
(
SKC_TTCK_BITS_LAYER
-
SKC_TTCK_HI_BITS_LAYER
)
union
skc_tile_coord
{
skc_uint
u32
;
struct
{
#
if
defined
(
__OPENCL_C_VERSION__
)
skc_uint
xy
;
#
else
skc_uint
na0
:
32
-
SKC_TTXK_HI_BITS_YX
;
skc_uint
x
:
SKC_TTXK_HI_BITS_X
;
skc_uint
y
:
SKC_TTXK_HI_BITS_Y
;
#
endif
}
;
}
;
SKC_STATIC_ASSERT
(
sizeof
(
union
skc_tile_coord
)
=
=
sizeof
(
skc_uint
)
)
;
union
skc_tile_clip
{
skc_uint
u32a2
[
2
]
;
skc_uint2
u32v2
;
struct
{
union
skc_tile_coord
xy0
;
union
skc_tile_coord
xy1
;
}
;
}
;
SKC_STATIC_ASSERT
(
sizeof
(
union
skc_tile_clip
)
=
=
sizeof
(
skc_uint2
)
)
;
#
endif
