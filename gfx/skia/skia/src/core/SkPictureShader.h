#
ifndef
SkPictureShader_DEFINED
#
define
SkPictureShader_DEFINED
#
include
"
SkShader
.
h
"
class
SkBitmap
;
class
SkPicture
;
class
SkPictureShader
:
public
SkShader
{
public
:
static
sk_sp
<
SkShader
>
Make
(
sk_sp
<
SkPicture
>
TileMode
TileMode
const
SkMatrix
*
const
SkRect
*
)
;
SK_TO_STRING_OVERRIDE
(
)
SK_DECLARE_PUBLIC_FLATTENABLE_DESERIALIZATION_PROCS
(
SkPictureShader
)
#
if
SK_SUPPORT_GPU
const
GrFragmentProcessor
*
asFragmentProcessor
(
GrContext
*
const
SkMatrix
&
viewM
const
SkMatrix
*
SkFilterQuality
)
const
override
;
#
endif
protected
:
SkPictureShader
(
SkReadBuffer
&
)
;
void
flatten
(
SkWriteBuffer
&
)
const
override
;
size_t
onContextSize
(
const
ContextRec
&
)
const
override
;
Context
*
onCreateContext
(
const
ContextRec
&
void
*
storage
)
const
override
;
private
:
SkPictureShader
(
sk_sp
<
SkPicture
>
TileMode
TileMode
const
SkMatrix
*
const
SkRect
*
)
;
sk_sp
<
SkShader
>
refBitmapShader
(
const
SkMatrix
&
const
SkMatrix
*
localMatrix
const
int
maxTextureSize
=
0
)
const
;
sk_sp
<
SkPicture
>
fPicture
;
SkRect
fTile
;
TileMode
fTmx
fTmy
;
class
PictureShaderContext
:
public
SkShader
:
:
Context
{
public
:
static
Context
*
Create
(
void
*
storage
const
SkPictureShader
&
const
ContextRec
&
sk_sp
<
SkShader
>
bitmapShader
)
;
virtual
~
PictureShaderContext
(
)
;
uint32_t
getFlags
(
)
const
override
;
ShadeProc
asAShadeProc
(
void
*
*
ctx
)
override
;
void
shadeSpan
(
int
x
int
y
SkPMColor
dstC
[
]
int
count
)
override
;
private
:
PictureShaderContext
(
const
SkPictureShader
&
const
ContextRec
&
sk_sp
<
SkShader
>
bitmapShader
)
;
sk_sp
<
SkShader
>
fBitmapShader
;
SkShader
:
:
Context
*
fBitmapShaderContext
;
void
*
fBitmapShaderContextStorage
;
typedef
SkShader
:
:
Context
INHERITED
;
}
;
typedef
SkShader
INHERITED
;
}
;
#
endif
