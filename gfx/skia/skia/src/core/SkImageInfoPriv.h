#
ifndef
SkImageInfoPriv_DEFINED
#
define
SkImageInfoPriv_DEFINED
#
include
"
SkImageInfo
.
h
"
static
inline
bool
SkImageInfoIsValid
(
const
SkImageInfo
&
info
)
{
if
(
info
.
width
(
)
<
=
0
|
|
info
.
height
(
)
<
=
0
)
{
return
false
;
}
const
int
kMaxDimension
=
SK_MaxS32
>
>
2
;
if
(
info
.
width
(
)
>
kMaxDimension
|
|
info
.
height
(
)
>
kMaxDimension
)
{
return
false
;
}
if
(
kUnknown_SkColorType
=
=
info
.
colorType
(
)
|
|
kUnknown_SkAlphaType
=
=
info
.
alphaType
(
)
)
{
return
false
;
}
if
(
kOpaque_SkAlphaType
!
=
info
.
alphaType
(
)
&
&
(
kRGB_565_SkColorType
=
=
info
.
colorType
(
)
|
|
kGray_8_SkColorType
=
=
info
.
colorType
(
)
)
)
{
return
false
;
}
if
(
kRGBA_F16_SkColorType
=
=
info
.
colorType
(
)
&
&
(
!
info
.
colorSpace
(
)
|
|
!
info
.
colorSpace
(
)
-
>
gammaIsLinear
(
)
)
)
{
return
false
;
}
if
(
info
.
colorSpace
(
)
&
&
(
!
info
.
colorSpace
(
)
-
>
gammaCloseToSRGB
(
)
&
&
!
info
.
colorSpace
(
)
-
>
gammaIsLinear
(
)
)
)
{
return
false
;
}
return
true
;
}
static
inline
bool
SkImageInfoValidConversion
(
const
SkImageInfo
&
dst
const
SkImageInfo
&
src
)
{
if
(
!
SkImageInfoIsValid
(
dst
)
|
|
!
SkImageInfoIsValid
(
src
)
)
{
return
false
;
}
if
(
kIndex_8_SkColorType
=
=
dst
.
colorType
(
)
)
{
if
(
kIndex_8_SkColorType
!
=
src
.
colorType
(
)
)
{
return
false
;
}
if
(
(
kPremul_SkAlphaType
=
=
dst
.
alphaType
(
)
&
&
kUnpremul_SkAlphaType
=
=
src
.
alphaType
(
)
)
|
|
(
kUnpremul_SkAlphaType
=
=
dst
.
alphaType
(
)
&
&
kPremul_SkAlphaType
=
=
src
.
alphaType
(
)
)
)
{
return
false
;
}
if
(
dst
.
colorSpace
(
)
&
&
!
SkColorSpace
:
:
Equals
(
dst
.
colorSpace
(
)
src
.
colorSpace
(
)
)
)
{
return
false
;
}
}
if
(
kGray_8_SkColorType
=
=
dst
.
colorType
(
)
)
{
if
(
kGray_8_SkColorType
!
=
src
.
colorType
(
)
)
{
return
false
;
}
if
(
dst
.
colorSpace
(
)
&
&
!
SkColorSpace
:
:
Equals
(
dst
.
colorSpace
(
)
src
.
colorSpace
(
)
)
)
{
return
false
;
}
}
if
(
kAlpha_8_SkColorType
!
=
dst
.
colorType
(
)
&
&
kAlpha_8_SkColorType
=
=
src
.
colorType
(
)
)
{
return
false
;
}
if
(
kOpaque_SkAlphaType
=
=
dst
.
alphaType
(
)
&
&
kOpaque_SkAlphaType
!
=
src
.
alphaType
(
)
)
{
return
false
;
}
if
(
dst
.
colorSpace
(
)
&
&
!
src
.
colorSpace
(
)
)
{
return
false
;
}
return
true
;
}
#
endif
