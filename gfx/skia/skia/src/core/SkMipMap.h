#
ifndef
SkMipMap_DEFINED
#
define
SkMipMap_DEFINED
#
include
"
include
/
core
/
SkPixmap
.
h
"
#
include
"
include
/
core
/
SkScalar
.
h
"
#
include
"
include
/
core
/
SkSize
.
h
"
#
include
"
include
/
private
/
SkImageInfoPriv
.
h
"
#
include
"
src
/
core
/
SkCachedData
.
h
"
#
include
"
src
/
shaders
/
SkShaderBase
.
h
"
class
SkBitmap
;
class
SkDiscardableMemory
;
typedef
SkDiscardableMemory
*
(
*
SkDiscardableFactoryProc
)
(
size_t
bytes
)
;
class
SkMipMap
:
public
SkCachedData
{
public
:
static
SkMipMap
*
Build
(
const
SkPixmap
&
src
SkDiscardableFactoryProc
)
;
static
SkMipMap
*
Build
(
const
SkBitmap
&
src
SkDiscardableFactoryProc
)
;
static
int
ComputeLevelCount
(
int
baseWidth
int
baseHeight
)
;
static
SkISize
ComputeLevelSize
(
int
baseWidth
int
baseHeight
int
level
)
;
struct
alignas
(
8
)
Level
{
SkPixmap
fPixmap
;
SkSize
fScale
;
}
;
bool
extractLevel
(
const
SkSize
&
scale
Level
*
)
const
;
int
countLevels
(
)
const
;
bool
getLevel
(
int
index
Level
*
)
const
;
protected
:
void
onDataChange
(
void
*
oldData
void
*
newData
)
override
{
fLevels
=
(
Level
*
)
newData
;
}
private
:
sk_sp
<
SkColorSpace
>
fCS
;
Level
*
fLevels
;
int
fCount
;
SkMipMap
(
void
*
malloc
size_t
size
)
:
INHERITED
(
malloc
size
)
{
}
SkMipMap
(
size_t
size
SkDiscardableMemory
*
dm
)
:
INHERITED
(
size
dm
)
{
}
static
size_t
AllocLevelsSize
(
int
levelCount
size_t
pixelSize
)
;
typedef
SkCachedData
INHERITED
;
}
;
#
endif
