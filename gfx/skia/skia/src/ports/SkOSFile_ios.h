#
ifndef
SkOSFile_ios_DEFINED
#
define
SkOSFile_ios_DEFINED
#
include
"
include
/
core
/
SkString
.
h
"
#
ifdef
SK_BUILD_FOR_IOS
#
import
<
CoreFoundation
/
CoreFoundation
.
h
>
#
include
"
include
/
ports
/
SkCFObject
.
h
"
static
bool
ios_get_path_in_bundle
(
const
char
path
[
]
SkString
*
result
)
{
CFBundleRef
mainBundle
=
CFBundleGetMainBundle
(
)
;
sk_cfp
<
CFURLRef
>
pathURL
(
CFURLCreateFromFileSystemRepresentation
(
nullptr
(
const
UInt8
*
)
path
strlen
(
path
)
false
)
)
;
sk_cfp
<
CFStringRef
>
pathRef
(
CFURLCopyFileSystemPath
(
pathURL
.
get
(
)
kCFURLPOSIXPathStyle
)
)
;
sk_cfp
<
CFURLRef
>
fileURL
(
CFBundleCopyResourceURL
(
mainBundle
pathRef
.
get
(
)
nullptr
CFSTR
(
"
data
"
)
)
)
;
if
(
!
fileURL
)
{
return
false
;
}
if
(
!
result
)
{
return
true
;
}
sk_cfp
<
CFStringRef
>
filePath
(
CFURLCopyFileSystemPath
(
fileURL
.
get
(
)
kCFURLPOSIXPathStyle
)
)
;
CFStringEncoding
encodingMethod
=
CFStringGetSystemEncoding
(
)
;
result
-
>
set
(
CFStringGetCStringPtr
(
filePath
.
get
(
)
encodingMethod
)
)
;
return
true
;
}
#
endif
#
endif
