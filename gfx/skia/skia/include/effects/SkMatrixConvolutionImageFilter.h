#
ifndef
SkMatrixConvolutionImageFilter_DEFINED
#
define
SkMatrixConvolutionImageFilter_DEFINED
#
include
"
SkFlattenable
.
h
"
#
include
"
SkImageFilter
.
h
"
#
include
"
SkScalar
.
h
"
#
include
"
SkSize
.
h
"
#
include
"
SkPoint
.
h
"
class
SkBitmap
;
class
SK_API
SkMatrixConvolutionImageFilter
:
public
SkImageFilter
{
public
:
enum
TileMode
{
kClamp_TileMode
=
0
kRepeat_TileMode
kClampToBlack_TileMode
kLast_TileMode
=
kClampToBlack_TileMode
kMax_TileMode
=
kClampToBlack_TileMode
}
;
~
SkMatrixConvolutionImageFilter
(
)
override
;
static
sk_sp
<
SkImageFilter
>
Make
(
const
SkISize
&
kernelSize
const
SkScalar
*
kernel
SkScalar
gain
SkScalar
bias
const
SkIPoint
&
kernelOffset
TileMode
tileMode
bool
convolveAlpha
sk_sp
<
SkImageFilter
>
input
const
CropRect
*
cropRect
=
nullptr
)
;
Factory
getFactory
(
)
const
override
{
return
CreateProc
;
}
protected
:
SkMatrixConvolutionImageFilter
(
const
SkISize
&
kernelSize
const
SkScalar
*
kernel
SkScalar
gain
SkScalar
bias
const
SkIPoint
&
kernelOffset
TileMode
tileMode
bool
convolveAlpha
sk_sp
<
SkImageFilter
>
input
const
CropRect
*
cropRect
)
;
void
flatten
(
SkWriteBuffer
&
)
const
override
;
sk_sp
<
SkSpecialImage
>
onFilterImage
(
SkSpecialImage
*
source
const
Context
&
SkIPoint
*
offset
)
const
override
;
sk_sp
<
SkImageFilter
>
onMakeColorSpace
(
SkColorSpaceXformer
*
)
const
override
;
SkIRect
onFilterNodeBounds
(
const
SkIRect
&
const
SkMatrix
&
ctm
MapDirection
const
SkIRect
*
inputRect
)
const
override
;
bool
affectsTransparentBlack
(
)
const
override
;
private
:
static
sk_sp
<
SkFlattenable
>
CreateProc
(
SkReadBuffer
&
)
;
friend
class
SkFlattenable
:
:
PrivateInitializer
;
SkISize
fKernelSize
;
SkScalar
*
fKernel
;
SkScalar
fGain
;
SkScalar
fBias
;
SkIPoint
fKernelOffset
;
TileMode
fTileMode
;
bool
fConvolveAlpha
;
template
<
class
PixelFetcher
bool
convolveAlpha
>
void
filterPixels
(
const
SkBitmap
&
src
SkBitmap
*
result
SkIVector
&
offset
const
SkIRect
&
rect
const
SkIRect
&
bounds
)
const
;
template
<
class
PixelFetcher
>
void
filterPixels
(
const
SkBitmap
&
src
SkBitmap
*
result
SkIVector
&
offset
const
SkIRect
&
rect
const
SkIRect
&
bounds
)
const
;
void
filterInteriorPixels
(
const
SkBitmap
&
src
SkBitmap
*
result
SkIVector
&
offset
const
SkIRect
&
rect
const
SkIRect
&
bounds
)
const
;
void
filterBorderPixels
(
const
SkBitmap
&
src
SkBitmap
*
result
SkIVector
&
offset
const
SkIRect
&
rect
const
SkIRect
&
bounds
)
const
;
typedef
SkImageFilter
INHERITED
;
}
;
#
endif
