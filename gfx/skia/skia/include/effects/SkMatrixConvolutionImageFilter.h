#
ifndef
SkMatrixConvolutionImageFilter_DEFINED
#
define
SkMatrixConvolutionImageFilter_DEFINED
#
include
"
SkImageFilter
.
h
"
#
include
"
SkScalar
.
h
"
#
include
"
SkSize
.
h
"
#
include
"
SkPoint
.
h
"
class
SK_API
SkMatrixConvolutionImageFilter
:
public
SkImageFilter
{
public
:
enum
TileMode
{
kClamp_TileMode
=
0
kRepeat_TileMode
kClampToBlack_TileMode
kMax_TileMode
=
kClampToBlack_TileMode
}
;
virtual
~
SkMatrixConvolutionImageFilter
(
)
;
static
SkImageFilter
*
Create
(
const
SkISize
&
kernelSize
const
SkScalar
*
kernel
SkScalar
gain
SkScalar
bias
const
SkIPoint
&
kernelOffset
TileMode
tileMode
bool
convolveAlpha
SkImageFilter
*
input
=
NULL
const
CropRect
*
cropRect
=
NULL
)
;
SK_TO_STRING_OVERRIDE
(
)
SK_DECLARE_PUBLIC_FLATTENABLE_DESERIALIZATION_PROCS
(
SkMatrixConvolutionImageFilter
)
protected
:
SkMatrixConvolutionImageFilter
(
const
SkISize
&
kernelSize
const
SkScalar
*
kernel
SkScalar
gain
SkScalar
bias
const
SkIPoint
&
kernelOffset
TileMode
tileMode
bool
convolveAlpha
SkImageFilter
*
input
const
CropRect
*
cropRect
)
;
void
flatten
(
SkWriteBuffer
&
)
const
override
;
bool
onFilterImage
(
Proxy
*
const
SkBitmap
&
src
const
Context
&
SkBitmap
*
result
SkIPoint
*
loc
)
const
override
;
void
onFilterNodeBounds
(
const
SkIRect
&
const
SkMatrix
&
SkIRect
*
MapDirection
)
const
override
;
bool
canComputeFastBounds
(
)
const
override
;
#
if
SK_SUPPORT_GPU
bool
asFragmentProcessor
(
GrFragmentProcessor
*
*
GrTexture
*
const
SkMatrix
&
const
SkIRect
&
bounds
)
const
override
;
#
endif
private
:
SkISize
fKernelSize
;
SkScalar
*
fKernel
;
SkScalar
fGain
;
SkScalar
fBias
;
SkIPoint
fKernelOffset
;
TileMode
fTileMode
;
bool
fConvolveAlpha
;
typedef
SkImageFilter
INHERITED
;
template
<
class
PixelFetcher
bool
convolveAlpha
>
void
filterPixels
(
const
SkBitmap
&
src
SkBitmap
*
result
const
SkIRect
&
rect
const
SkIRect
&
bounds
)
const
;
template
<
class
PixelFetcher
>
void
filterPixels
(
const
SkBitmap
&
src
SkBitmap
*
result
const
SkIRect
&
rect
const
SkIRect
&
bounds
)
const
;
void
filterInteriorPixels
(
const
SkBitmap
&
src
SkBitmap
*
result
const
SkIRect
&
rect
const
SkIRect
&
bounds
)
const
;
void
filterBorderPixels
(
const
SkBitmap
&
src
SkBitmap
*
result
const
SkIRect
&
rect
const
SkIRect
&
bounds
)
const
;
}
;
#
endif
