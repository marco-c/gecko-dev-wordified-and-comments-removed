#
ifndef
SkAndroidCodec_DEFINED
#
define
SkAndroidCodec_DEFINED
#
include
"
SkCodec
.
h
"
#
include
"
SkEncodedFormat
.
h
"
#
include
"
SkStream
.
h
"
#
include
"
SkTypes
.
h
"
class
SkAndroidCodec
:
SkNoncopyable
{
public
:
static
SkAndroidCodec
*
NewFromStream
(
SkStream
*
SkPngChunkReader
*
=
NULL
)
;
static
SkAndroidCodec
*
NewFromData
(
SkData
*
SkPngChunkReader
*
=
NULL
)
;
virtual
~
SkAndroidCodec
(
)
{
}
const
SkImageInfo
&
getInfo
(
)
const
{
return
fInfo
;
}
SkEncodedFormat
getEncodedFormat
(
)
const
{
return
fCodec
-
>
getEncodedFormat
(
)
;
}
SkColorType
computeOutputColorType
(
SkColorType
requestedColorType
)
;
SkAlphaType
computeOutputAlphaType
(
bool
requestedUnpremul
)
;
SkISize
getSampledDimensions
(
int
sampleSize
)
const
;
bool
getSupportedSubset
(
SkIRect
*
desiredSubset
)
const
;
SkISize
getSampledSubsetDimensions
(
int
sampleSize
const
SkIRect
&
subset
)
const
;
struct
AndroidOptions
{
AndroidOptions
(
)
:
fZeroInitialized
(
SkCodec
:
:
kNo_ZeroInitialized
)
fSubset
(
nullptr
)
fColorPtr
(
nullptr
)
fColorCount
(
nullptr
)
fSampleSize
(
1
)
{
}
SkCodec
:
:
ZeroInitialized
fZeroInitialized
;
SkIRect
*
fSubset
;
SkPMColor
*
fColorPtr
;
int
*
fColorCount
;
int
fSampleSize
;
}
;
SkCodec
:
:
Result
getAndroidPixels
(
const
SkImageInfo
&
info
void
*
pixels
size_t
rowBytes
const
AndroidOptions
*
options
)
;
SkCodec
:
:
Result
getAndroidPixels
(
const
SkImageInfo
&
info
void
*
pixels
size_t
rowBytes
)
;
protected
:
SkAndroidCodec
(
SkCodec
*
)
;
SkCodec
*
codec
(
)
const
{
return
fCodec
.
get
(
)
;
}
virtual
SkISize
onGetSampledDimensions
(
int
sampleSize
)
const
=
0
;
virtual
bool
onGetSupportedSubset
(
SkIRect
*
desiredSubset
)
const
=
0
;
virtual
SkCodec
:
:
Result
onGetAndroidPixels
(
const
SkImageInfo
&
info
void
*
pixels
size_t
rowBytes
const
AndroidOptions
&
options
)
=
0
;
private
:
const
SkImageInfo
&
fInfo
;
SkAutoTDelete
<
SkCodec
>
fCodec
;
}
;
#
endif
