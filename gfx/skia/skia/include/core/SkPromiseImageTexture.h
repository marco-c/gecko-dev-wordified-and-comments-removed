#
ifndef
SkPromiseImageTexture_DEFINED
#
define
SkPromiseImageTexture_DEFINED
#
include
"
.
.
/
private
/
GrResourceKey
.
h
"
#
include
"
GrBackendSurface
.
h
"
#
include
"
SkRefCnt
.
h
"
#
if
SK_SUPPORT_GPU
class
SK_API
SkPromiseImageTexture
:
public
SkNVRefCnt
<
SkPromiseImageTexture
>
{
public
:
SkPromiseImageTexture
(
)
=
delete
;
SkPromiseImageTexture
(
const
SkPromiseImageTexture
&
)
=
delete
;
SkPromiseImageTexture
(
SkPromiseImageTexture
&
&
)
=
delete
;
~
SkPromiseImageTexture
(
)
;
SkPromiseImageTexture
&
operator
=
(
const
SkPromiseImageTexture
&
)
=
delete
;
SkPromiseImageTexture
&
operator
=
(
SkPromiseImageTexture
&
&
)
=
delete
;
static
sk_sp
<
SkPromiseImageTexture
>
Make
(
const
GrBackendTexture
&
backendTexture
)
{
if
(
!
backendTexture
.
isValid
(
)
)
{
return
nullptr
;
}
return
sk_sp
<
SkPromiseImageTexture
>
(
new
SkPromiseImageTexture
(
backendTexture
)
)
;
}
const
GrBackendTexture
&
backendTexture
(
)
const
{
return
fBackendTexture
;
}
void
addKeyToInvalidate
(
uint32_t
contextID
const
GrUniqueKey
&
key
)
;
uint32_t
uniqueID
(
)
const
{
return
fUniqueID
;
}
#
if
GR_TEST_UTILS
SkTArray
<
GrUniqueKey
>
testingOnly_uniqueKeysToInvalidate
(
)
const
;
#
endif
private
:
explicit
SkPromiseImageTexture
(
const
GrBackendTexture
&
backendTexture
)
;
SkSTArray
<
1
GrUniqueKeyInvalidatedMessage
>
fMessages
;
GrBackendTexture
fBackendTexture
;
uint32_t
fUniqueID
=
SK_InvalidUniqueID
;
static
std
:
:
atomic
<
uint32_t
>
gUniqueID
;
}
;
#
endif
#
endif
