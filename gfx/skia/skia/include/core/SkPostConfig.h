#
ifndef
SkPostConfig_DEFINED
#
define
SkPostConfig_DEFINED
#
if
!
defined
(
SK_DEBUG
)
&
&
!
defined
(
SK_RELEASE
)
#
ifdef
NDEBUG
#
define
SK_RELEASE
#
else
#
define
SK_DEBUG
#
endif
#
endif
#
if
defined
(
SK_DEBUG
)
&
&
defined
(
SK_RELEASE
)
#
error
"
cannot
define
both
SK_DEBUG
and
SK_RELEASE
"
#
elif
!
defined
(
SK_DEBUG
)
&
&
!
defined
(
SK_RELEASE
)
#
error
"
must
define
either
SK_DEBUG
or
SK_RELEASE
"
#
endif
#
if
defined
(
SK_MSCALAR_IS_DOUBLE
)
&
&
defined
(
SK_MSCALAR_IS_FLOAT
)
#
error
"
cannot
define
both
SK_MSCALAR_IS_DOUBLE
and
SK_MSCALAR_IS_FLOAT
"
#
elif
!
defined
(
SK_MSCALAR_IS_DOUBLE
)
&
&
!
defined
(
SK_MSCALAR_IS_FLOAT
)
#
define
SK_MSCALAR_IS_FLOAT
#
endif
#
if
defined
(
SK_CPU_LENDIAN
)
&
&
defined
(
SK_CPU_BENDIAN
)
#
error
"
cannot
define
both
SK_CPU_LENDIAN
and
SK_CPU_BENDIAN
"
#
elif
!
defined
(
SK_CPU_LENDIAN
)
&
&
!
defined
(
SK_CPU_BENDIAN
)
#
error
"
must
define
either
SK_CPU_LENDIAN
or
SK_CPU_BENDIAN
"
#
endif
#
ifdef
SK_A32_SHIFT
#
if
!
defined
(
SK_R32_SHIFT
)
|
|
!
defined
(
SK_G32_SHIFT
)
|
|
!
defined
(
SK_B32_SHIFT
)
#
error
"
all
or
none
of
the
32bit
SHIFT
amounts
must
be
defined
"
#
endif
#
else
#
if
defined
(
SK_R32_SHIFT
)
|
|
defined
(
SK_G32_SHIFT
)
|
|
defined
(
SK_B32_SHIFT
)
#
error
"
all
or
none
of
the
32bit
SHIFT
amounts
must
be
defined
"
#
endif
#
endif
#
if
!
defined
(
SK_HAS_COMPILER_FEATURE
)
#
if
defined
(
__has_feature
)
#
define
SK_HAS_COMPILER_FEATURE
(
x
)
__has_feature
(
x
)
#
else
#
define
SK_HAS_COMPILER_FEATURE
(
x
)
0
#
endif
#
endif
#
if
!
defined
(
SK_ATTRIBUTE
)
#
if
defined
(
__clang__
)
|
|
defined
(
__GNUC__
)
#
define
SK_ATTRIBUTE
(
attr
)
__attribute__
(
(
attr
)
)
#
else
#
define
SK_ATTRIBUTE
(
attr
)
#
endif
#
endif
#
if
!
defined
(
SK_SUPPORT_GPU
)
#
define
SK_SUPPORT_GPU
1
#
endif
#
if
!
defined
(
SK_SUPPORT_ATLAS_TEXT
)
#
define
SK_SUPPORT_ATLAS_TEXT
0
#
elif
SK_SUPPORT_ATLAS_TEXT
&
&
!
SK_SUPPORT_GPU
#
error
"
SK_SUPPORT_ATLAS_TEXT
requires
SK_SUPPORT_GPU
"
#
endif
#
if
!
defined
(
SkNO_RETURN_HINT
)
#
if
SK_HAS_COMPILER_FEATURE
(
attribute_analyzer_noreturn
)
static
inline
void
SkNO_RETURN_HINT
(
)
__attribute__
(
(
analyzer_noreturn
)
)
;
static
inline
void
SkNO_RETURN_HINT
(
)
{
}
#
else
#
define
SkNO_RETURN_HINT
(
)
do
{
}
while
(
false
)
#
endif
#
endif
#
ifdef
SK_BUILD_FOR_WIN
#
ifndef
SK_A32_SHIFT
#
define
SK_A32_SHIFT
24
#
define
SK_R32_SHIFT
16
#
define
SK_G32_SHIFT
8
#
define
SK_B32_SHIFT
0
#
endif
#
#
endif
#
if
defined
(
SK_BUILD_FOR_GOOGLE3
)
void
SkDebugfForDumpStackTrace
(
const
char
*
data
void
*
unused
)
;
void
DumpStackTrace
(
int
skip_count
void
w
(
const
char
*
void
*
)
void
*
arg
)
;
#
define
SK_DUMP_GOOGLE3_STACK
(
)
DumpStackTrace
(
0
SkDebugfForDumpStackTrace
nullptr
)
#
else
#
define
SK_DUMP_GOOGLE3_STACK
(
)
#
endif
#
ifdef
SK_BUILD_FOR_WIN
#
define
SK_DUMP_LINE_FORMAT
(
message
)
\
SkDebugf
(
"
%
s
(
%
d
)
:
fatal
error
:
\
"
%
s
\
"
\
n
"
__FILE__
__LINE__
message
)
#
else
#
define
SK_DUMP_LINE_FORMAT
(
message
)
\
SkDebugf
(
"
%
s
:
%
d
:
fatal
error
:
\
"
%
s
\
"
\
n
"
__FILE__
__LINE__
message
)
#
endif
#
ifndef
SK_ABORT
#
define
SK_ABORT
(
message
)
\
do
{
\
SkNO_RETURN_HINT
(
)
;
\
SK_DUMP_LINE_FORMAT
(
message
)
;
\
SK_DUMP_GOOGLE3_STACK
(
)
;
\
sk_abort_no_print
(
)
;
\
}
while
(
false
)
#
endif
#
ifndef
SK_A32_SHIFT
#
ifdef
SK_CPU_BENDIAN
#
define
SK_R32_SHIFT
24
#
define
SK_G32_SHIFT
16
#
define
SK_B32_SHIFT
8
#
define
SK_A32_SHIFT
0
#
else
#
define
SK_R32_SHIFT
0
#
define
SK_G32_SHIFT
8
#
define
SK_B32_SHIFT
16
#
define
SK_A32_SHIFT
24
#
endif
#
endif
#
define
SK_COLOR_MATCHES_PMCOLOR_BYTE_ORDER
\
(
SK_A32_SHIFT
=
=
24
&
&
SK_R32_SHIFT
=
=
16
&
&
SK_G32_SHIFT
=
=
8
&
&
SK_B32_SHIFT
=
=
0
)
#
ifdef
SK_CPU_BENDIAN
#
define
SK_PMCOLOR_BYTE_ORDER
(
C0
C1
C2
C3
)
\
(
SK_
#
#
C3
#
#
32_SHIFT
=
=
0
&
&
\
SK_
#
#
C2
#
#
32_SHIFT
=
=
8
&
&
\
SK_
#
#
C1
#
#
32_SHIFT
=
=
16
&
&
\
SK_
#
#
C0
#
#
32_SHIFT
=
=
24
)
#
else
#
define
SK_PMCOLOR_BYTE_ORDER
(
C0
C1
C2
C3
)
\
(
SK_
#
#
C0
#
#
32_SHIFT
=
=
0
&
&
\
SK_
#
#
C1
#
#
32_SHIFT
=
=
8
&
&
\
SK_
#
#
C2
#
#
32_SHIFT
=
=
16
&
&
\
SK_
#
#
C3
#
#
32_SHIFT
=
=
24
)
#
endif
#
if
defined
SK_DEBUG
&
&
defined
SK_BUILD_FOR_WIN
#
ifdef
free
#
undef
free
#
endif
#
include
<
crtdbg
.
h
>
#
undef
free
#
endif
#
if
!
defined
(
SK_UNUSED
)
#
if
!
defined
(
__clang__
)
&
&
defined
(
_MSC_VER
)
#
define
SK_UNUSED
__pragma
(
warning
(
suppress
:
4189
)
)
#
else
#
define
SK_UNUSED
SK_ATTRIBUTE
(
unused
)
#
endif
#
endif
#
if
!
defined
(
SK_ALWAYS_INLINE
)
#
if
defined
(
SK_BUILD_FOR_WIN
)
#
define
SK_ALWAYS_INLINE
__forceinline
#
else
#
define
SK_ALWAYS_INLINE
SK_ATTRIBUTE
(
always_inline
)
inline
#
endif
#
endif
#
if
!
defined
(
SK_NEVER_INLINE
)
#
if
defined
(
SK_BUILD_FOR_WIN
)
#
define
SK_NEVER_INLINE
__declspec
(
noinline
)
#
else
#
define
SK_NEVER_INLINE
SK_ATTRIBUTE
(
noinline
)
#
endif
#
endif
#
if
SK_CPU_SSE_LEVEL
>
=
SK_CPU_SSE_LEVEL_SSE1
#
define
SK_PREFETCH
(
ptr
)
_mm_prefetch
(
reinterpret_cast
<
const
char
*
>
(
ptr
)
_MM_HINT_T0
)
#
define
SK_WRITE_PREFETCH
(
ptr
)
_mm_prefetch
(
reinterpret_cast
<
const
char
*
>
(
ptr
)
_MM_HINT_T0
)
#
elif
defined
(
__GNUC__
)
#
define
SK_PREFETCH
(
ptr
)
__builtin_prefetch
(
ptr
)
#
define
SK_WRITE_PREFETCH
(
ptr
)
__builtin_prefetch
(
ptr
1
)
#
else
#
define
SK_PREFETCH
(
ptr
)
#
define
SK_WRITE_PREFETCH
(
ptr
)
#
endif
#
ifndef
SK_PRINTF_LIKE
#
if
defined
(
__clang__
)
|
|
defined
(
__GNUC__
)
#
define
SK_PRINTF_LIKE
(
A
B
)
__attribute__
(
(
format
(
printf
(
A
)
(
B
)
)
)
)
#
else
#
define
SK_PRINTF_LIKE
(
A
B
)
#
endif
#
endif
#
ifndef
SK_SIZE_T_SPECIFIER
#
if
defined
(
_MSC_VER
)
&
&
!
defined
(
__clang__
)
#
define
SK_SIZE_T_SPECIFIER
"
%
Iu
"
#
else
#
define
SK_SIZE_T_SPECIFIER
"
%
zu
"
#
endif
#
endif
#
ifndef
SK_ALLOW_STATIC_GLOBAL_INITIALIZERS
#
define
SK_ALLOW_STATIC_GLOBAL_INITIALIZERS
1
#
endif
#
if
!
defined
(
SK_GAMMA_EXPONENT
)
#
define
SK_GAMMA_EXPONENT
(
0
.
0f
)
/
/
SRGB
#
endif
#
ifndef
GR_TEST_UTILS
#
define
GR_TEST_UTILS
0
#
endif
#
if
defined
(
SK_HISTOGRAM_ENUMERATION
)
&
&
defined
(
SK_HISTOGRAM_BOOLEAN
)
#
define
SK_HISTOGRAMS_ENABLED
1
#
else
#
define
SK_HISTOGRAMS_ENABLED
0
#
endif
#
ifndef
SK_HISTOGRAM_BOOLEAN
#
define
SK_HISTOGRAM_BOOLEAN
(
name
value
)
#
endif
#
ifndef
SK_HISTOGRAM_ENUMERATION
#
define
SK_HISTOGRAM_ENUMERATION
(
name
value
boundary_value
)
#
endif
#
endif
