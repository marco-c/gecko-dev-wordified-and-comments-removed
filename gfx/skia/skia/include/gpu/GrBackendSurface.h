#
ifndef
GrBackendSurface_DEFINED
#
define
GrBackendSurface_DEFINED
#
include
"
GrTypes
.
h
"
#
include
"
gl
/
GrGLTypes
.
h
"
#
include
"
mock
/
GrMockTypes
.
h
"
#
ifdef
SK_VULKAN
#
include
"
vk
/
GrVkTypes
.
h
"
#
endif
class
SK_API
GrBackendFormat
{
public
:
GrBackendFormat
(
)
:
fValid
(
false
)
{
}
static
GrBackendFormat
MakeGL
(
GrGLenum
format
GrGLenum
target
)
{
return
GrBackendFormat
(
format
target
)
;
}
#
ifdef
SK_VULKAN
static
GrBackendFormat
MakeVK
(
VkFormat
format
)
{
return
GrBackendFormat
(
format
)
;
}
#
endif
static
GrBackendFormat
MakeMock
(
GrPixelConfig
config
)
{
return
GrBackendFormat
(
config
)
;
}
GrBackend
backend
(
)
const
{
return
fBackend
;
}
const
GrGLenum
*
getGLFormat
(
)
const
;
const
GrGLenum
*
getGLTarget
(
)
const
;
#
ifdef
SK_VULKAN
const
VkFormat
*
getVkFormat
(
)
const
;
#
endif
const
GrPixelConfig
*
getMockFormat
(
)
const
;
bool
isValid
(
)
const
{
return
fValid
;
}
private
:
GrBackendFormat
(
GrGLenum
format
GrGLenum
target
)
;
#
ifdef
SK_VULKAN
GrBackendFormat
(
const
VkFormat
vkFormat
)
;
#
endif
GrBackendFormat
(
const
GrPixelConfig
config
)
;
GrBackend
fBackend
;
bool
fValid
;
union
{
struct
{
GrGLenum
fTarget
;
GrGLenum
fFormat
;
}
fGL
;
#
ifdef
SK_VULKAN
VkFormat
fVkFormat
;
#
endif
GrPixelConfig
fMockFormat
;
}
;
}
;
class
SK_API
GrBackendTexture
{
public
:
GrBackendTexture
(
)
:
fConfig
(
kUnknown_GrPixelConfig
)
{
}
GrBackendTexture
(
int
width
int
height
GrPixelConfig
config
const
GrGLTextureInfo
&
glInfo
)
;
GrBackendTexture
(
int
width
int
height
GrPixelConfig
config
GrMipMapped
const
GrGLTextureInfo
&
glInfo
)
;
GrBackendTexture
(
int
width
int
height
GrMipMapped
const
GrGLTextureInfo
&
glInfo
)
;
#
ifdef
SK_VULKAN
GrBackendTexture
(
int
width
int
height
const
GrVkImageInfo
&
vkInfo
)
;
#
endif
GrBackendTexture
(
int
width
int
height
GrPixelConfig
config
const
GrMockTextureInfo
&
mockInfo
)
;
GrBackendTexture
(
int
width
int
height
GrPixelConfig
config
GrMipMapped
const
GrMockTextureInfo
&
mockInfo
)
;
int
width
(
)
const
{
return
fWidth
;
}
int
height
(
)
const
{
return
fHeight
;
}
bool
hasMipMaps
(
)
const
{
return
GrMipMapped
:
:
kYes
=
=
fMipMapped
;
}
GrBackend
backend
(
)
const
{
return
fBackend
;
}
const
GrGLTextureInfo
*
getGLTextureInfo
(
)
const
;
#
ifdef
SK_VULKAN
const
GrVkImageInfo
*
getVkImageInfo
(
)
const
;
#
endif
const
GrMockTextureInfo
*
getMockTextureInfo
(
)
const
;
bool
isValid
(
)
const
{
return
fConfig
!
=
kUnknown_GrPixelConfig
;
}
GrPixelConfig
testingOnly_getPixelConfig
(
)
const
;
private
:
friend
class
SkImage
;
friend
class
SkSurface
;
friend
class
GrBackendTextureImageGenerator
;
friend
class
GrProxyProvider
;
friend
class
GrGpu
;
friend
class
GrGLGpu
;
friend
class
GrVkGpu
;
GrPixelConfig
config
(
)
const
{
return
fConfig
;
}
int
fWidth
;
int
fHeight
;
GrPixelConfig
fConfig
;
GrMipMapped
fMipMapped
;
GrBackend
fBackend
;
union
{
GrGLTextureInfo
fGLInfo
;
#
ifdef
SK_VULKAN
GrVkImageInfo
fVkInfo
;
#
endif
GrMockTextureInfo
fMockInfo
;
}
;
}
;
class
SK_API
GrBackendRenderTarget
{
public
:
GrBackendRenderTarget
(
)
:
fConfig
(
kUnknown_GrPixelConfig
)
{
}
GrBackendRenderTarget
(
int
width
int
height
int
sampleCnt
int
stencilBits
GrPixelConfig
config
const
GrGLFramebufferInfo
&
glInfo
)
;
GrBackendRenderTarget
(
int
width
int
height
int
sampleCnt
int
stencilBits
const
GrGLFramebufferInfo
&
glInfo
)
;
#
ifdef
SK_VULKAN
GrBackendRenderTarget
(
int
width
int
height
int
sampleCnt
int
stencilBits
const
GrVkImageInfo
&
vkInfo
)
;
#
endif
int
width
(
)
const
{
return
fWidth
;
}
int
height
(
)
const
{
return
fHeight
;
}
int
sampleCnt
(
)
const
{
return
fSampleCnt
;
}
int
stencilBits
(
)
const
{
return
fStencilBits
;
}
GrBackend
backend
(
)
const
{
return
fBackend
;
}
const
GrGLFramebufferInfo
*
getGLFramebufferInfo
(
)
const
;
#
ifdef
SK_VULKAN
const
GrVkImageInfo
*
getVkImageInfo
(
)
const
;
#
endif
bool
isValid
(
)
const
{
return
fConfig
!
=
kUnknown_GrPixelConfig
;
}
GrPixelConfig
testingOnly_getPixelConfig
(
)
const
;
private
:
friend
class
SkSurface
;
friend
class
SkSurface_Gpu
;
friend
class
SkImage_Gpu
;
friend
class
GrGpu
;
friend
class
GrGLGpu
;
friend
class
GrProxyProvider
;
friend
class
GrVkGpu
;
GrPixelConfig
config
(
)
const
{
return
fConfig
;
}
int
fWidth
;
int
fHeight
;
int
fSampleCnt
;
int
fStencilBits
;
GrPixelConfig
fConfig
;
GrBackend
fBackend
;
union
{
GrGLFramebufferInfo
fGLInfo
;
#
ifdef
SK_VULKAN
GrVkImageInfo
fVkInfo
;
#
endif
}
;
}
;
#
endif
