#
ifndef
skgpu_graphite_BackendTexture_DEFINED
#
define
skgpu_graphite_BackendTexture_DEFINED
#
include
"
include
/
core
/
SkRefCnt
.
h
"
#
include
"
include
/
core
/
SkSize
.
h
"
#
include
"
include
/
gpu
/
graphite
/
GraphiteTypes
.
h
"
#
include
"
include
/
gpu
/
graphite
/
TextureInfo
.
h
"
#
ifdef
SK_DAWN
#
include
"
include
/
gpu
/
graphite
/
dawn
/
DawnTypes
.
h
"
#
endif
#
ifdef
SK_METAL
#
include
"
include
/
gpu
/
graphite
/
mtl
/
MtlGraphiteTypes
.
h
"
#
endif
#
ifdef
SK_VULKAN
#
include
"
include
/
gpu
/
vk
/
VulkanTypes
.
h
"
#
include
"
include
/
private
/
gpu
/
vk
/
SkiaVulkan
.
h
"
#
endif
namespace
skgpu
{
class
MutableTextureState
;
}
namespace
skgpu
:
:
graphite
{
class
SK_API
BackendTexture
{
public
:
BackendTexture
(
)
;
#
ifdef
SK_DAWN
BackendTexture
(
WGPUTexture
texture
)
;
BackendTexture
(
SkISize
planeDimensions
const
DawnTextureInfo
&
info
WGPUTexture
texture
)
;
BackendTexture
(
SkISize
dimensions
const
DawnTextureInfo
&
info
WGPUTextureView
textureView
)
;
#
endif
#
ifdef
SK_METAL
BackendTexture
(
SkISize
dimensions
CFTypeRef
mtlTexture
)
;
#
endif
#
ifdef
SK_VULKAN
BackendTexture
(
SkISize
dimensions
const
VulkanTextureInfo
&
VkImageLayout
uint32_t
queueFamilyIndex
VkImage
VulkanAlloc
)
;
#
endif
BackendTexture
(
const
BackendTexture
&
)
;
~
BackendTexture
(
)
;
BackendTexture
&
operator
=
(
const
BackendTexture
&
)
;
bool
operator
=
=
(
const
BackendTexture
&
)
const
;
bool
operator
!
=
(
const
BackendTexture
&
that
)
const
{
return
!
(
*
this
=
=
that
)
;
}
bool
isValid
(
)
const
{
return
fInfo
.
isValid
(
)
;
}
BackendApi
backend
(
)
const
{
return
fInfo
.
backend
(
)
;
}
SkISize
dimensions
(
)
const
{
return
fDimensions
;
}
const
TextureInfo
&
info
(
)
const
{
return
fInfo
;
}
void
setMutableState
(
const
skgpu
:
:
MutableTextureState
&
)
;
#
ifdef
SK_DAWN
WGPUTexture
getDawnTexturePtr
(
)
const
;
WGPUTextureView
getDawnTextureViewPtr
(
)
const
;
#
endif
#
ifdef
SK_METAL
CFTypeRef
getMtlTexture
(
)
const
;
#
endif
#
ifdef
SK_VULKAN
VkImage
getVkImage
(
)
const
;
VkImageLayout
getVkImageLayout
(
)
const
;
uint32_t
getVkQueueFamilyIndex
(
)
const
;
const
VulkanAlloc
*
getMemoryAlloc
(
)
const
;
#
endif
private
:
friend
class
VulkanResourceProvider
;
sk_sp
<
MutableTextureState
>
getMutableState
(
)
const
;
SkISize
fDimensions
;
TextureInfo
fInfo
;
sk_sp
<
MutableTextureState
>
fMutableState
;
#
ifdef
SK_VULKAN
VulkanAlloc
fMemoryAlloc
=
VulkanAlloc
(
)
;
#
endif
union
{
#
ifdef
SK_DAWN
struct
{
WGPUTexture
fDawnTexture
;
WGPUTextureView
fDawnTextureView
;
}
;
#
endif
#
ifdef
SK_METAL
CFTypeRef
fMtlTexture
;
#
endif
#
ifdef
SK_VULKAN
VkImage
fVkImage
=
VK_NULL_HANDLE
;
#
endif
void
*
fEnsureUnionNonEmpty
;
}
;
}
;
}
#
endif
