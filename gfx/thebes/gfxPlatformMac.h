#
ifndef
GFX_PLATFORM_MAC_H
#
define
GFX_PLATFORM_MAC_H
#
include
"
nsTArrayForwardDeclare
.
h
"
#
include
"
gfxPlatform
.
h
"
#
include
"
mozilla
/
LookAndFeel
.
h
"
namespace
mozilla
{
namespace
gfx
{
class
DrawTarget
;
class
VsyncSource
;
}
}
class
gfxPlatformMac
:
public
gfxPlatform
{
public
:
gfxPlatformMac
(
)
;
virtual
~
gfxPlatformMac
(
)
;
static
void
RegisterSupplementalFonts
(
)
;
static
void
WaitForFontRegistration
(
)
;
static
gfxPlatformMac
*
GetPlatform
(
)
{
return
(
gfxPlatformMac
*
)
gfxPlatform
:
:
GetPlatform
(
)
;
}
already_AddRefed
<
gfxASurface
>
CreateOffscreenSurface
(
const
IntSize
&
aSize
gfxImageFormat
aFormat
)
override
;
bool
CreatePlatformFontList
(
)
override
;
void
ReadSystemFontList
(
mozilla
:
:
dom
:
:
SystemFontList
*
aFontList
)
override
;
void
GetCommonFallbackFonts
(
uint32_t
aCh
Script
aRunScript
eFontPresentation
aPresentation
nsTArray
<
const
char
*
>
&
aFontList
)
override
;
static
void
LookupSystemFont
(
mozilla
:
:
LookAndFeel
:
:
FontID
aSystemFontID
nsACString
&
aSystemFontName
gfxFontStyle
&
aFontStyle
)
;
bool
SupportsApzWheelInput
(
)
const
override
{
return
true
;
}
bool
RespectsFontStyleSmoothing
(
)
const
override
{
return
true
;
}
bool
RequiresAcceleratedGLContextForCompositorOGL
(
)
const
override
{
return
true
;
}
already_AddRefed
<
mozilla
:
:
gfx
:
:
VsyncSource
>
CreateGlobalHardwareVsyncSource
(
)
override
;
uint32_t
GetAntiAliasingThreshold
(
)
{
return
mFontAntiAliasingThreshold
;
}
static
bool
CheckVariationFontSupport
(
)
;
protected
:
bool
AccelerateLayersByDefault
(
)
override
;
BackendPrefsData
GetBackendPrefs
(
)
const
override
;
void
InitPlatformGPUProcessPrefs
(
)
override
;
private
:
nsTArray
<
uint8_t
>
GetPlatformCMSOutputProfileData
(
)
override
;
static
uint32_t
ReadAntiAliasingThreshold
(
)
;
static
void
FontRegistrationCallback
(
void
*
aUnused
)
;
uint32_t
mFontAntiAliasingThreshold
;
static
PRThread
*
sFontRegistrationThread
;
}
;
#
endif
