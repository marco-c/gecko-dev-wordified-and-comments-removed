#
include
"
XlibDisplay
.
h
"
#
include
"
mozilla
/
Assertions
.
h
"
namespace
mozilla
:
:
gfx
{
XlibDisplay
:
:
XlibDisplay
(
Display
*
aDisplay
bool
aOwned
)
:
mDisplay
(
aDisplay
)
mOwned
(
aOwned
)
{
MOZ_ASSERT
(
mDisplay
)
;
}
XlibDisplay
:
:
~
XlibDisplay
(
)
{
if
(
mOwned
)
{
XCloseDisplay
(
mDisplay
)
;
}
}
std
:
:
shared_ptr
<
XlibDisplay
>
XlibDisplay
:
:
Borrow
(
Display
*
aDisplay
)
{
if
(
!
aDisplay
)
{
return
nullptr
;
}
return
std
:
:
shared_ptr
<
XlibDisplay
>
(
new
XlibDisplay
(
aDisplay
false
)
)
;
}
std
:
:
shared_ptr
<
XlibDisplay
>
XlibDisplay
:
:
Open
(
const
char
*
aDisplayName
)
{
Display
*
disp
=
XOpenDisplay
(
aDisplayName
)
;
if
(
!
disp
)
{
return
nullptr
;
}
return
std
:
:
shared_ptr
<
XlibDisplay
>
(
new
XlibDisplay
(
disp
true
)
)
;
}
}
