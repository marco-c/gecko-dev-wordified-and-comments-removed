#
include
<
stdint
.
h
>
#
include
"
ImageContainer
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
mozilla
/
ipc
/
Shmem
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsDebug
.
h
"
#
include
"
nsISupportsImpl
.
h
"
#
ifndef
MOZILLA_LAYERS_SHAREDPLANARYCBCRIMAGE_H
#
define
MOZILLA_LAYERS_SHAREDPLANARYCBCRIMAGE_H
namespace
mozilla
{
namespace
layers
{
class
ImageClient
;
class
TextureClient
;
class
TextureClientRecycleAllocator
;
class
SharedPlanarYCbCrImage
:
public
PlanarYCbCrImage
{
public
:
explicit
SharedPlanarYCbCrImage
(
ImageClient
*
aCompositable
)
;
explicit
SharedPlanarYCbCrImage
(
TextureClientRecycleAllocator
*
aRecycleAllocator
)
;
protected
:
virtual
~
SharedPlanarYCbCrImage
(
)
;
public
:
TextureClient
*
GetTextureClient
(
KnowsCompositor
*
aKnowsCompositor
)
override
;
already_AddRefed
<
gfx
:
:
SourceSurface
>
GetAsSourceSurface
(
)
override
;
bool
CopyData
(
const
PlanarYCbCrData
&
aData
)
override
;
bool
AdoptData
(
const
Data
&
aData
)
override
;
bool
CreateEmptyBuffer
(
const
Data
&
aData
)
override
;
bool
IsValid
(
)
const
override
;
size_t
SizeOfIncludingThis
(
MallocSizeOf
aMallocSizeOf
)
const
override
{
return
aMallocSizeOf
(
this
)
+
SizeOfExcludingThis
(
aMallocSizeOf
)
;
}
size_t
SizeOfExcludingThis
(
MallocSizeOf
aMallocSizeOf
)
const
override
;
TextureClientRecycleAllocator
*
RecycleAllocator
(
)
;
private
:
bool
Allocate
(
PlanarYCbCrData
&
aData
)
;
RefPtr
<
TextureClient
>
mTextureClient
;
RefPtr
<
ImageClient
>
mCompositable
;
RefPtr
<
TextureClientRecycleAllocator
>
mRecycleAllocator
;
}
;
}
}
#
endif
