#
ifndef
MOZILLA_LAYERS_KNOWSCOMPOSITOR
#
define
MOZILLA_LAYERS_KNOWSCOMPOSITOR
#
include
"
mozilla
/
layers
/
LayersTypes
.
h
"
#
include
"
mozilla
/
layers
/
CompositorTypes
.
h
"
namespace
mozilla
{
namespace
layers
{
class
SyncObject
;
class
TextureForwarder
;
class
LayersIPCActor
;
class
KnowsCompositor
{
public
:
NS_INLINE_DECL_PURE_VIRTUAL_REFCOUNTING
KnowsCompositor
(
)
;
~
KnowsCompositor
(
)
;
void
IdentifyTextureHost
(
const
TextureFactoryIdentifier
&
aIdentifier
)
;
SyncObject
*
GetSyncObject
(
)
{
return
mSyncObject
;
}
int32_t
GetMaxTextureSize
(
)
const
{
return
mTextureFactoryIdentifier
.
mMaxTextureSize
;
}
LayersBackend
GetCompositorBackendType
(
)
const
{
return
mTextureFactoryIdentifier
.
mParentBackend
;
}
bool
SupportsTextureBlitting
(
)
const
{
return
mTextureFactoryIdentifier
.
mSupportsTextureBlitting
;
}
bool
SupportsPartialUploads
(
)
const
{
return
mTextureFactoryIdentifier
.
mSupportsPartialUploads
;
}
bool
SupportsComponentAlpha
(
)
const
{
return
mTextureFactoryIdentifier
.
mSupportsComponentAlpha
;
}
bool
GetCompositorUseANGLE
(
)
const
{
return
mTextureFactoryIdentifier
.
mCompositorUseANGLE
;
}
const
TextureFactoryIdentifier
&
GetTextureFactoryIdentifier
(
)
const
{
return
mTextureFactoryIdentifier
;
}
bool
DeviceCanReset
(
)
const
{
return
GetCompositorBackendType
(
)
!
=
LayersBackend
:
:
LAYERS_BASIC
;
}
int32_t
GetSerial
(
)
{
return
mSerial
;
}
virtual
TextureForwarder
*
GetTextureForwarder
(
)
=
0
;
virtual
LayersIPCActor
*
GetLayersIPCActor
(
)
=
0
;
protected
:
TextureFactoryIdentifier
mTextureFactoryIdentifier
;
RefPtr
<
SyncObject
>
mSyncObject
;
const
int32_t
mSerial
;
static
mozilla
:
:
Atomic
<
int32_t
>
sSerialCounter
;
}
;
}
}
#
endif
