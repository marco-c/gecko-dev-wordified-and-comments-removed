#
ifndef
mozilla_layers_CompositorThread_h
#
define
mozilla_layers_CompositorThread_h
#
include
"
base
/
basictypes
.
h
"
#
include
"
base
/
platform_thread
.
h
"
#
include
"
base
/
thread
.
h
"
#
include
"
base
/
message_loop
.
h
"
#
include
"
nsISupportsImpl
.
h
"
#
include
"
ThreadSafeRefcountingWithMainThreadDestruction
.
h
"
namespace
mozilla
{
namespace
layers
{
class
CompositorThreadHolder
final
{
NS_INLINE_DECL_THREADSAFE_REFCOUNTING_WITH_MAIN_THREAD_DESTRUCTION
(
CompositorThreadHolder
)
public
:
CompositorThreadHolder
(
)
;
base
:
:
Thread
*
GetCompositorThread
(
)
const
{
return
mCompositorThread
;
}
static
CompositorThreadHolder
*
GetSingleton
(
)
;
static
bool
IsActive
(
)
{
return
!
!
GetSingleton
(
)
;
}
static
void
Start
(
)
;
static
void
Shutdown
(
)
;
static
MessageLoop
*
Loop
(
)
;
static
bool
IsInCompositorThread
(
)
;
private
:
~
CompositorThreadHolder
(
)
;
base
:
:
Thread
*
const
mCompositorThread
;
static
base
:
:
Thread
*
CreateCompositorThread
(
)
;
static
void
DestroyCompositorThread
(
base
:
:
Thread
*
aCompositorThread
)
;
friend
class
CompositorBridgeParent
;
}
;
class
CompositorThreadHolderDebug
final
{
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
CompositorThreadHolderDebug
)
public
:
CompositorThreadHolderDebug
(
const
char
*
aName
)
;
private
:
~
CompositorThreadHolderDebug
(
)
;
RefPtr
<
CompositorThreadHolder
>
mHolder
;
#
ifdef
MOZ_CRASHREPORTER
nsAutoCString
mId
;
#
endif
}
;
base
:
:
Thread
*
CompositorThread
(
)
;
}
}
#
endif
