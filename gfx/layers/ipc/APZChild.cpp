#
include
"
mozilla
/
layers
/
APZChild
.
h
"
#
include
"
mozilla
/
layers
/
GeckoContentController
.
h
"
#
include
"
mozilla
/
dom
/
BrowserChild
.
h
"
#
include
"
mozilla
/
layers
/
APZCCallbackHelper
.
h
"
#
include
"
InputData
.
h
"
namespace
mozilla
{
namespace
layers
{
APZChild
:
:
APZChild
(
RefPtr
<
GeckoContentController
>
aController
)
:
mController
(
aController
)
{
MOZ_ASSERT
(
mController
)
;
}
APZChild
:
:
~
APZChild
(
)
{
if
(
mAPZTaskRunnable
)
{
mAPZTaskRunnable
-
>
Revoke
(
)
;
mAPZTaskRunnable
=
nullptr
;
}
if
(
mController
)
{
mController
-
>
Destroy
(
)
;
mController
=
nullptr
;
}
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvLayerTransforms
(
nsTArray
<
MatrixMessage
>
&
&
aTransforms
)
{
mController
-
>
NotifyLayerTransforms
(
std
:
:
move
(
aTransforms
)
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvRequestContentRepaint
(
const
RepaintRequest
&
aRequest
)
{
MOZ_ASSERT
(
mController
-
>
IsRepaintThread
(
)
)
;
EnsureAPZTaskRunnable
(
)
;
mAPZTaskRunnable
-
>
QueueRequest
(
aRequest
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvUpdateOverscrollVelocity
(
const
ScrollableLayerGuid
&
aGuid
const
float
&
aX
const
float
&
aY
const
bool
&
aIsRootContent
)
{
mController
-
>
UpdateOverscrollVelocity
(
aGuid
aX
aY
aIsRootContent
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvUpdateOverscrollOffset
(
const
ScrollableLayerGuid
&
aGuid
const
float
&
aX
const
float
&
aY
const
bool
&
aIsRootContent
)
{
mController
-
>
UpdateOverscrollOffset
(
aGuid
aX
aY
aIsRootContent
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvNotifyMozMouseScrollEvent
(
const
ViewID
&
aScrollId
const
nsString
&
aEvent
)
{
mController
-
>
NotifyMozMouseScrollEvent
(
aScrollId
aEvent
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvNotifyAPZStateChange
(
const
ScrollableLayerGuid
&
aGuid
const
APZStateChange
&
aChange
const
int
&
aArg
Maybe
<
uint64_t
>
aInputBlockId
)
{
mController
-
>
NotifyAPZStateChange
(
aGuid
aChange
aArg
aInputBlockId
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvNotifyFlushComplete
(
)
{
MOZ_ASSERT
(
mController
-
>
IsRepaintThread
(
)
)
;
EnsureAPZTaskRunnable
(
)
;
mAPZTaskRunnable
-
>
QueueFlushCompleteNotification
(
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvNotifyAsyncScrollbarDragInitiated
(
const
uint64_t
&
aDragBlockId
const
ViewID
&
aScrollId
const
ScrollDirection
&
aDirection
)
{
mController
-
>
NotifyAsyncScrollbarDragInitiated
(
aDragBlockId
aScrollId
aDirection
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvNotifyAsyncScrollbarDragRejected
(
const
ViewID
&
aScrollId
)
{
mController
-
>
NotifyAsyncScrollbarDragRejected
(
aScrollId
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvNotifyAsyncAutoscrollRejected
(
const
ViewID
&
aScrollId
)
{
mController
-
>
NotifyAsyncAutoscrollRejected
(
aScrollId
)
;
return
IPC_OK
(
)
;
}
mozilla
:
:
ipc
:
:
IPCResult
APZChild
:
:
RecvDestroy
(
)
{
PAPZChild
:
:
Send__delete__
(
this
)
;
return
IPC_OK
(
)
;
}
}
}
