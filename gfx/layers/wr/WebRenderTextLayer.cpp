#
include
"
WebRenderTextLayer
.
h
"
#
include
"
gfxPrefs
.
h
"
#
include
"
LayersLogging
.
h
"
#
include
"
mozilla
/
webrender
/
WebRenderTypes
.
h
"
#
include
"
mozilla
/
layers
/
WebRenderBridgeChild
.
h
"
#
include
"
mozilla
/
gfx
/
2D
.
h
"
namespace
mozilla
{
namespace
layers
{
using
namespace
mozilla
:
:
gfx
;
void
WebRenderTextLayer
:
:
RenderLayer
(
wr
:
:
DisplayListBuilder
&
aBuilder
const
StackingContextHelper
&
aSc
)
{
if
(
mBounds
.
IsEmpty
(
)
)
{
return
;
}
gfx
:
:
Rect
rect
=
GetTransform
(
)
.
TransformBounds
(
IntRectToRect
(
mBounds
)
)
-
ParentBounds
(
)
.
ToUnknownRect
(
)
.
TopLeft
(
)
;
gfx
:
:
Rect
clip
;
if
(
GetClipRect
(
)
.
isSome
(
)
)
{
clip
=
IntRectToRect
(
GetClipRect
(
)
.
ref
(
)
.
ToUnknownRect
(
)
)
-
ParentBounds
(
)
.
ToUnknownRect
(
)
.
TopLeft
(
)
;
}
else
{
clip
=
rect
;
}
if
(
gfxPrefs
:
:
LayersDump
(
)
)
{
printf_stderr
(
"
TextLayer
%
p
using
rect
=
%
s
clip
=
%
s
\
n
"
this
-
>
GetLayer
(
)
Stringify
(
rect
)
.
c_str
(
)
Stringify
(
clip
)
.
c_str
(
)
)
;
}
WrBridge
(
)
-
>
PushGlyphs
(
aBuilder
mGlyphs
mFont
GetOffsetToParent
(
)
rect
clip
)
;
}
}
}
