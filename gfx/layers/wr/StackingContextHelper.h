#
ifndef
GFX_STACKINGCONTEXTHELPER_H
#
define
GFX_STACKINGCONTEXTHELPER_H
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
gfx
/
MatrixFwd
.
h
"
#
include
"
mozilla
/
webrender
/
WebRenderAPI
.
h
"
#
include
"
mozilla
/
webrender
/
WebRenderTypes
.
h
"
#
include
"
Units
.
h
"
class
nsDisplayListBuilder
;
class
nsDisplayItem
;
class
nsDisplayList
;
namespace
mozilla
{
namespace
layers
{
class
WebRenderLayer
;
class
MOZ_RAII
StackingContextHelper
{
public
:
StackingContextHelper
(
const
StackingContextHelper
&
aParentSC
wr
:
:
DisplayListBuilder
&
aBuilder
WebRenderLayer
*
aLayer
const
Maybe
<
gfx
:
:
Matrix4x4
>
&
aTransform
=
Nothing
(
)
const
nsTArray
<
wr
:
:
WrFilterOp
>
&
aFilters
=
nsTArray
<
wr
:
:
WrFilterOp
>
(
)
)
;
StackingContextHelper
(
const
StackingContextHelper
&
aParentSC
wr
:
:
DisplayListBuilder
&
aBuilder
WebRenderLayer
*
aLayer
uint64_t
aAnimationsId
float
*
aOpacityPtr
gfx
:
:
Matrix4x4
*
aTransformPtr
const
nsTArray
<
wr
:
:
WrFilterOp
>
&
aFilters
=
nsTArray
<
wr
:
:
WrFilterOp
>
(
)
)
;
StackingContextHelper
(
const
StackingContextHelper
&
aParentSC
wr
:
:
DisplayListBuilder
&
aBuilder
nsDisplayListBuilder
*
aDisplayListBuilder
nsDisplayItem
*
aItem
nsDisplayList
*
aDisplayList
gfx
:
:
Matrix4x4Typed
<
LayerPixel
LayerPixel
>
*
aBoundTransform
uint64_t
aAnimationsId
float
*
aOpacityPtr
gfx
:
:
Matrix4x4
*
aTransformPtr
gfx
:
:
Matrix4x4
*
aPerspectivePtr
=
nullptr
const
nsTArray
<
wr
:
:
WrFilterOp
>
&
aFilters
=
nsTArray
<
wr
:
:
WrFilterOp
>
(
)
const
gfx
:
:
CompositionOp
&
aMixBlendMode
=
gfx
:
:
CompositionOp
:
:
OP_OVER
)
;
StackingContextHelper
(
)
;
~
StackingContextHelper
(
)
;
wr
:
:
LayoutRect
ToRelativeLayoutRect
(
const
LayerRect
&
aRect
)
const
;
wr
:
:
LayoutRect
ToRelativeLayoutRect
(
const
LayoutDeviceRect
&
aRect
)
const
;
wr
:
:
LayoutPoint
ToRelativeLayoutPoint
(
const
LayerPoint
&
aPoint
)
const
;
gfx
:
:
Size
GetInheritedScale
(
)
const
{
return
gfx
:
:
Size
(
mXScale
mYScale
)
;
}
void
SetInheritedScale
(
const
gfx
:
:
Size
&
aScale
)
{
mXScale
=
aScale
.
width
;
mYScale
=
aScale
.
height
;
}
bool
IsBackfaceVisible
(
)
const
{
return
mTransform
.
IsBackfaceVisible
(
)
;
}
bool
HasPerspectiveTransform
(
)
const
{
return
mHasPerspectiveTransform
;
}
private
:
wr
:
:
DisplayListBuilder
*
mBuilder
;
LayerPoint
mOrigin
;
gfx
:
:
Matrix4x4
mTransform
;
bool
mHasPerspectiveTransform
;
float
mXScale
;
float
mYScale
;
}
;
}
}
#
endif
