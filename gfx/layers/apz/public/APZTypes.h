#
ifndef
mozilla_layers_APZTypes_h
#
define
mozilla_layers_APZTypes_h
#
include
"
LayersTypes
.
h
"
#
include
"
mozilla
/
layers
/
ScrollableLayerGuid
.
h
"
#
include
"
mozilla
/
webrender
/
WebRenderTypes
.
h
"
namespace
mozilla
{
namespace
layers
{
struct
WRRootId
{
LayersId
mLayersId
;
wr
:
:
RenderRoot
mRenderRoot
;
WRRootId
(
)
=
default
;
static
WRRootId
NonWebRender
(
LayersId
aLayersId
)
{
return
WRRootId
(
aLayersId
wr
:
:
RenderRoot
:
:
Default
)
;
}
WRRootId
(
LayersId
aLayersId
wr
:
:
RenderRoot
aRenderRoot
)
:
mLayersId
(
aLayersId
)
mRenderRoot
(
aRenderRoot
)
{
}
WRRootId
(
wr
:
:
PipelineId
aLayersId
wr
:
:
DocumentId
aRenderRootId
)
:
mLayersId
(
AsLayersId
(
aLayersId
)
)
mRenderRoot
(
RenderRootFromId
(
aRenderRootId
)
)
{
}
bool
operator
=
=
(
const
WRRootId
&
aOther
)
const
{
return
mRenderRoot
=
=
aOther
.
mRenderRoot
&
&
mLayersId
=
=
aOther
.
mLayersId
;
}
bool
operator
!
=
(
const
WRRootId
&
aOther
)
const
{
return
!
(
*
this
=
=
aOther
)
;
}
bool
IsValid
(
)
const
{
return
mLayersId
.
IsValid
(
)
;
}
struct
HashFn
{
std
:
:
size_t
operator
(
)
(
const
WRRootId
&
aKey
)
const
{
return
HashGeneric
(
(
uint64_t
)
aKey
.
mLayersId
(
uint8_t
)
aKey
.
mRenderRoot
)
;
}
}
;
}
;
struct
SLGuidAndRenderRoot
{
ScrollableLayerGuid
mScrollableLayerGuid
;
wr
:
:
RenderRoot
mRenderRoot
;
SLGuidAndRenderRoot
(
)
:
mRenderRoot
(
wr
:
:
RenderRoot
:
:
Default
)
{
}
SLGuidAndRenderRoot
(
LayersId
aLayersId
uint32_t
aPresShellId
ScrollableLayerGuid
:
:
ViewID
aScrollId
wr
:
:
RenderRoot
aRenderRoot
)
:
mScrollableLayerGuid
(
aLayersId
aPresShellId
aScrollId
)
mRenderRoot
(
aRenderRoot
)
{
}
SLGuidAndRenderRoot
(
const
ScrollableLayerGuid
&
other
wr
:
:
RenderRoot
aRenderRoot
)
:
mScrollableLayerGuid
(
other
)
mRenderRoot
(
aRenderRoot
)
{
}
WRRootId
GetWRRootId
(
)
const
{
return
WRRootId
(
mScrollableLayerGuid
.
mLayersId
mRenderRoot
)
;
}
}
;
template
<
int
LogLevel
>
gfx
:
:
Log
<
LogLevel
>
&
operator
<
<
(
gfx
:
:
Log
<
LogLevel
>
&
log
const
SLGuidAndRenderRoot
&
aGuid
)
{
return
log
<
<
'
(
'
<
<
aGuid
.
mScrollableLayerGuid
<
<
'
'
<
<
(
int
)
aGuid
.
mRenderRoot
<
<
'
)
'
;
}
}
}
#
endif
