#
include
"
MockHitTester
.
h
"
#
include
"
apz
/
src
/
AsyncPanZoomController
.
h
"
#
include
"
mozilla
/
layers
/
ScrollableLayerGuid
.
h
"
namespace
mozilla
:
:
layers
{
IAPZHitTester
:
:
HitTestResult
MockHitTester
:
:
GetAPZCAtPoint
(
const
ScreenPoint
&
aHitTestPoint
const
RecursiveMutexAutoLock
&
aProofOfTreeLock
)
{
MOZ_ASSERT
(
!
mQueuedResults
.
empty
(
)
)
;
HitTestResult
result
=
std
:
:
move
(
mQueuedResults
.
front
(
)
)
;
mQueuedResults
.
pop
(
)
;
return
result
;
}
void
MockHitTester
:
:
QueueHitResult
(
ScrollableLayerGuid
:
:
ViewID
aScrollId
gfx
:
:
CompositorHitTestInfo
aHitInfo
)
{
LayersId
layersId
=
GetRootLayersId
(
)
;
RefPtr
<
HitTestingTreeNode
>
node
=
GetTargetNode
(
ScrollableLayerGuid
(
layersId
0
aScrollId
)
ScrollableLayerGuid
:
:
EqualsIgnoringPresShell
)
;
MOZ_ASSERT
(
node
)
;
AsyncPanZoomController
*
apzc
=
node
-
>
GetApzc
(
)
;
MOZ_ASSERT
(
apzc
)
;
HitTestResult
result
;
result
.
mTargetApzc
=
apzc
;
result
.
mHitResult
=
aHitInfo
;
result
.
mLayersId
=
layersId
;
mQueuedResults
.
push
(
std
:
:
move
(
result
)
)
;
}
}
