#
include
"
mozilla
/
layers
/
APZSampler
.
h
"
#
include
"
mozilla
/
layers
/
APZCTreeManager
.
h
"
#
include
"
mozilla
/
layers
/
CompositorThread
.
h
"
namespace
mozilla
{
namespace
layers
{
APZSampler
:
:
APZSampler
(
const
RefPtr
<
APZCTreeManager
>
&
aApz
)
:
mApz
(
aApz
)
{
}
APZSampler
:
:
~
APZSampler
(
)
{
}
void
APZSampler
:
:
ClearTree
(
)
{
MOZ_ASSERT
(
CompositorThreadHolder
:
:
IsInCompositorThread
(
)
)
;
mApz
-
>
ClearTree
(
)
;
}
void
APZSampler
:
:
UpdateFocusState
(
uint64_t
aRootLayerTreeId
uint64_t
aOriginatingLayersId
const
FocusTarget
&
aFocusTarget
)
{
MOZ_ASSERT
(
CompositorThreadHolder
:
:
IsInCompositorThread
(
)
)
;
mApz
-
>
UpdateFocusState
(
aRootLayerTreeId
aOriginatingLayersId
aFocusTarget
)
;
}
void
APZSampler
:
:
UpdateHitTestingTree
(
uint64_t
aRootLayerTreeId
Layer
*
aRoot
bool
aIsFirstPaint
uint64_t
aOriginatingLayersId
uint32_t
aPaintSequenceNumber
)
{
MOZ_ASSERT
(
CompositorThreadHolder
:
:
IsInCompositorThread
(
)
)
;
mApz
-
>
UpdateHitTestingTree
(
aRootLayerTreeId
aRoot
aIsFirstPaint
aOriginatingLayersId
aPaintSequenceNumber
)
;
}
void
APZSampler
:
:
UpdateHitTestingTree
(
uint64_t
aRootLayerTreeId
const
WebRenderScrollData
&
aScrollData
bool
aIsFirstPaint
uint64_t
aOriginatingLayersId
uint32_t
aPaintSequenceNumber
)
{
MOZ_ASSERT
(
CompositorThreadHolder
:
:
IsInCompositorThread
(
)
)
;
mApz
-
>
UpdateHitTestingTree
(
aRootLayerTreeId
aScrollData
aIsFirstPaint
aOriginatingLayersId
aPaintSequenceNumber
)
;
}
void
APZSampler
:
:
NotifyLayerTreeAdopted
(
uint64_t
aLayersId
const
RefPtr
<
APZSampler
>
&
aOldSampler
)
{
MOZ_ASSERT
(
CompositorThreadHolder
:
:
IsInCompositorThread
(
)
)
;
MOZ_ASSERT
(
aOldSampler
)
;
mApz
-
>
NotifyLayerTreeAdopted
(
aLayersId
aOldSampler
-
>
mApz
)
;
}
void
APZSampler
:
:
NotifyLayerTreeRemoved
(
uint64_t
aLayersId
)
{
MOZ_ASSERT
(
CompositorThreadHolder
:
:
IsInCompositorThread
(
)
)
;
mApz
-
>
NotifyLayerTreeRemoved
(
aLayersId
)
;
}
bool
APZSampler
:
:
GetAPZTestData
(
uint64_t
aLayersId
APZTestData
*
aOutData
)
{
MOZ_ASSERT
(
CompositorThreadHolder
:
:
IsInCompositorThread
(
)
)
;
return
mApz
-
>
GetAPZTestData
(
aLayersId
aOutData
)
;
}
}
}
