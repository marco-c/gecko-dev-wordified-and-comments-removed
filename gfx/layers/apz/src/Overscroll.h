#
ifndef
mozilla_layers_Overscroll_h
#
define
mozilla_layers_Overscroll_h
#
include
"
AsyncPanZoomAnimation
.
h
"
#
include
"
AsyncPanZoomController
.
h
"
#
include
"
FrameMetrics
.
h
"
#
include
"
mozilla
/
TimeStamp
.
h
"
#
include
"
nsThreadUtils
.
h
"
namespace
mozilla
{
namespace
layers
{
class
OverscrollAnimation
:
public
AsyncPanZoomAnimation
{
public
:
explicit
OverscrollAnimation
(
AsyncPanZoomController
&
aApzc
const
ParentLayerPoint
&
aVelocity
)
:
mApzc
(
aApzc
)
{
mApzc
.
mX
.
StartOverscrollAnimation
(
aVelocity
.
x
)
;
mApzc
.
mY
.
StartOverscrollAnimation
(
aVelocity
.
y
)
;
}
~
OverscrollAnimation
(
)
{
mApzc
.
mX
.
EndOverscrollAnimation
(
)
;
mApzc
.
mY
.
EndOverscrollAnimation
(
)
;
}
virtual
bool
DoSample
(
FrameMetrics
&
aFrameMetrics
const
TimeDuration
&
aDelta
)
override
{
bool
continueX
=
mApzc
.
mX
.
SampleOverscrollAnimation
(
aDelta
)
;
bool
continueY
=
mApzc
.
mY
.
SampleOverscrollAnimation
(
aDelta
)
;
if
(
!
continueX
&
&
!
continueY
)
{
mDeferredTasks
.
AppendElement
(
NewRunnableMethod
(
&
mApzc
&
AsyncPanZoomController
:
:
ScrollSnap
)
)
;
return
false
;
}
return
true
;
}
virtual
bool
WantsRepaints
(
)
override
{
return
false
;
}
private
:
AsyncPanZoomController
&
mApzc
;
}
;
}
}
#
endif
