#
ifndef
mozilla_layers_CompositionRecorder_h
#
define
mozilla_layers_CompositionRecorder_h
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
mozilla
/
TimeStamp
.
h
"
#
include
"
nsISupportsImpl
.
h
"
#
include
"
nsTArray
.
h
"
namespace
mozilla
{
namespace
gfx
{
class
DataSourceSurface
;
}
namespace
layers
{
class
RecordedFrame
{
public
:
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
RecordedFrame
)
virtual
already_AddRefed
<
gfx
:
:
DataSourceSurface
>
GetSourceSurface
(
)
=
0
;
TimeStamp
GetTimeStamp
(
)
{
return
mTimeStamp
;
}
protected
:
virtual
~
RecordedFrame
(
)
=
default
;
RecordedFrame
(
const
TimeStamp
&
aTimeStamp
)
:
mTimeStamp
(
aTimeStamp
)
{
}
private
:
TimeStamp
mTimeStamp
;
}
;
class
CompositionRecorder
{
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
CompositionRecorder
)
public
:
explicit
CompositionRecorder
(
TimeStamp
aRecordingStart
)
;
virtual
void
RecordFrame
(
RecordedFrame
*
aFrame
)
;
virtual
void
WriteCollectedFrames
(
)
;
protected
:
virtual
~
CompositionRecorder
(
)
=
default
;
void
ClearCollectedFrames
(
)
;
private
:
nsTArray
<
RefPtr
<
RecordedFrame
>
>
mCollectedFrames
;
TimeStamp
mRecordingStart
;
}
;
}
}
#
endif
