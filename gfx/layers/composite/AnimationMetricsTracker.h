#
ifndef
mozilla_layers_AnimationMetricsTracker_h
#
define
mozilla_layers_AnimationMetricsTracker_h
#
include
"
mozilla
/
Telemetry
.
h
"
#
include
"
mozilla
/
TimeStamp
.
h
"
#
include
"
mozilla
/
TypedEnumBits
.
h
"
namespace
mozilla
{
namespace
layers
{
enum
class
AnimationProcessTypes
{
eNone
=
0x0
eContent
=
0x1
eChrome
=
0x2
}
;
MOZ_MAKE_ENUM_CLASS_BITWISE_OPERATORS
(
AnimationProcessTypes
)
class
AnimationMetricsTracker
{
public
:
AnimationMetricsTracker
(
)
;
~
AnimationMetricsTracker
(
)
;
void
UpdateAnimationInProgress
(
AnimationProcessTypes
aActive
uint64_t
aLayerArea
TimeDuration
aVsyncInterval
)
;
void
UpdateApzAnimationInProgress
(
bool
aInProgress
TimeDuration
aVsyncInterval
)
;
private
:
struct
AnimationData
{
TimeStamp
mStart
;
TimeStamp
mLastFrameTime
;
TimeDuration
mLongestFrame
;
uint32_t
mFrameCount
;
AnimationData
(
)
:
mFrameCount
(
0
)
{
}
}
;
void
AnimationStarted
(
)
;
void
AnimationEnded
(
)
;
void
UpdateAnimationThroughput
(
const
char
*
aLabel
bool
aInProgress
AnimationData
&
aAnimationData
TimeDuration
aVsyncInterval
Telemetry
:
:
HistogramID
aThroughputHistogram
Telemetry
:
:
HistogramID
aMaxDropsHistogram
)
;
TimeStamp
mCurrentAnimationStart
;
uint64_t
mMaxLayerAreaAnimated
;
AnimationData
mChromeAnimation
;
AnimationData
mContentAnimation
;
AnimationData
mApzAnimation
;
}
;
}
}
#
endif
