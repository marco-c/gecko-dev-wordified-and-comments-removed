#
ifndef
mozilla_layers_AnimationHelper_h
#
define
mozilla_layers_AnimationHelper_h
#
include
"
mozilla
/
dom
/
Nullable
.
h
"
#
include
"
mozilla
/
ComputedTimingFunction
.
h
"
#
include
"
mozilla
/
layers
/
AnimationStorageData
.
h
"
#
include
"
mozilla
/
layers
/
LayersMessages
.
h
"
#
include
"
mozilla
/
webrender
/
WebRenderTypes
.
h
"
#
include
"
mozilla
/
TimeStamp
.
h
"
#
include
"
mozilla
/
TimingParams
.
h
"
#
include
"
mozilla
/
Types
.
h
"
#
include
"
mozilla
/
Variant
.
h
"
#
include
"
X11UndefineNone
.
h
"
#
include
<
unordered_map
>
namespace
mozilla
{
namespace
layers
{
class
Animation
;
class
CompositorAnimationStorage
;
struct
AnimatedValue
;
typedef
nsTArray
<
layers
:
:
Animation
>
AnimationArray
;
class
AnimationHelper
{
public
:
enum
class
SampleResult
{
None
Skipped
Sampled
}
;
static
SampleResult
SampleAnimationForEachNode
(
TimeStamp
aPreviousFrameTime
TimeStamp
aCurrentFrameTime
const
AnimatedValue
*
aPreviousValue
nsTArray
<
PropertyAnimationGroup
>
&
aPropertyAnimationGroups
nsTArray
<
RefPtr
<
RawServoAnimationValue
>
>
&
aAnimationValues
)
;
static
AnimationStorageData
ExtractAnimations
(
const
LayersId
&
aLayersId
const
AnimationArray
&
aAnimations
)
;
static
uint64_t
GetNextCompositorAnimationsId
(
)
;
static
gfx
:
:
Matrix4x4
ServoAnimationValueToMatrix4x4
(
const
nsTArray
<
RefPtr
<
RawServoAnimationValue
>
>
&
aValue
const
TransformData
&
aTransformData
gfx
:
:
Path
*
aCachedMotionPath
)
;
static
bool
ShouldBeJank
(
const
LayoutDeviceRect
&
aPrerenderedRect
SideBits
aOverflowedSides
const
gfx
:
:
Matrix4x4
&
aTransform
const
ParentLayerRect
&
aClipRect
)
;
}
;
}
}
#
endif
