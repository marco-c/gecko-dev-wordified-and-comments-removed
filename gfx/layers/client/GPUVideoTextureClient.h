#
ifndef
MOZILLA_GFX_GPUVIDEOTEXTURECLIENT_H
#
define
MOZILLA_GFX_GPUVIDEOTEXTURECLIENT_H
#
include
"
mozilla
/
layers
/
TextureClient
.
h
"
namespace
mozilla
{
namespace
gfx
{
class
SourceSurface
;
}
class
VideoDecoderManagerChild
;
namespace
layers
{
class
GPUVideoTextureData
:
public
TextureData
{
public
:
GPUVideoTextureData
(
VideoDecoderManagerChild
*
aManager
const
SurfaceDescriptorGPUVideo
&
aSD
const
gfx
:
:
IntSize
&
aSize
)
;
~
GPUVideoTextureData
(
)
;
virtual
void
FillInfo
(
TextureData
:
:
Info
&
aInfo
)
const
override
;
virtual
bool
Lock
(
OpenMode
)
override
{
return
true
;
}
;
virtual
void
Unlock
(
)
override
{
}
;
virtual
bool
Serialize
(
SurfaceDescriptor
&
aOutDescriptor
)
override
;
virtual
void
Deallocate
(
LayersIPCChannel
*
aAllocator
)
override
;
virtual
void
Forget
(
LayersIPCChannel
*
aAllocator
)
override
;
already_AddRefed
<
gfx
:
:
SourceSurface
>
GetAsSourceSurface
(
)
;
virtual
GPUVideoTextureData
*
AsGPUVideoTextureData
(
)
override
{
return
this
;
}
protected
:
RefPtr
<
VideoDecoderManagerChild
>
mManager
;
SurfaceDescriptorGPUVideo
mSD
;
gfx
:
:
IntSize
mSize
;
public
:
const
decltype
(
mSD
)
&
SD
(
)
const
{
return
mSD
;
}
}
;
}
}
#
endif
