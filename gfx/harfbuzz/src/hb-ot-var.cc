#
include
"
hb
.
hh
"
#
ifndef
HB_NO_VAR
#
include
"
hb
-
ot
-
var
.
h
"
#
include
"
hb
-
ot
-
var
-
avar
-
table
.
hh
"
#
include
"
hb
-
ot
-
var
-
fvar
-
table
.
hh
"
#
include
"
hb
-
ot
-
var
-
mvar
-
table
.
hh
"
hb_bool_t
hb_ot_var_has_data
(
hb_face_t
*
face
)
{
return
face
-
>
table
.
fvar
-
>
has_data
(
)
;
}
unsigned
int
hb_ot_var_get_axis_count
(
hb_face_t
*
face
)
{
return
face
-
>
table
.
fvar
-
>
get_axis_count
(
)
;
}
#
ifndef
HB_DISABLE_DEPRECATED
unsigned
int
hb_ot_var_get_axes
(
hb_face_t
*
face
unsigned
int
start_offset
unsigned
int
*
axes_count
hb_ot_var_axis_t
*
axes_array
)
{
return
face
-
>
table
.
fvar
-
>
get_axes_deprecated
(
start_offset
axes_count
axes_array
)
;
}
hb_bool_t
hb_ot_var_find_axis
(
hb_face_t
*
face
hb_tag_t
axis_tag
unsigned
int
*
axis_index
hb_ot_var_axis_t
*
axis_info
)
{
return
face
-
>
table
.
fvar
-
>
find_axis_deprecated
(
axis_tag
axis_index
axis_info
)
;
}
#
endif
HB_EXTERN
unsigned
int
hb_ot_var_get_axis_infos
(
hb_face_t
*
face
unsigned
int
start_offset
unsigned
int
*
axes_count
hb_ot_var_axis_info_t
*
axes_array
)
{
return
face
-
>
table
.
fvar
-
>
get_axis_infos
(
start_offset
axes_count
axes_array
)
;
}
HB_EXTERN
hb_bool_t
hb_ot_var_find_axis_info
(
hb_face_t
*
face
hb_tag_t
axis_tag
hb_ot_var_axis_info_t
*
axis_info
)
{
return
face
-
>
table
.
fvar
-
>
find_axis_info
(
axis_tag
axis_info
)
;
}
unsigned
int
hb_ot_var_get_named_instance_count
(
hb_face_t
*
face
)
{
return
face
-
>
table
.
fvar
-
>
get_instance_count
(
)
;
}
hb_ot_name_id_t
hb_ot_var_named_instance_get_subfamily_name_id
(
hb_face_t
*
face
unsigned
int
instance_index
)
{
return
face
-
>
table
.
fvar
-
>
get_instance_subfamily_name_id
(
instance_index
)
;
}
hb_ot_name_id_t
hb_ot_var_named_instance_get_postscript_name_id
(
hb_face_t
*
face
unsigned
int
instance_index
)
{
return
face
-
>
table
.
fvar
-
>
get_instance_postscript_name_id
(
instance_index
)
;
}
unsigned
int
hb_ot_var_named_instance_get_design_coords
(
hb_face_t
*
face
unsigned
int
instance_index
unsigned
int
*
coords_length
float
*
coords
)
{
return
face
-
>
table
.
fvar
-
>
get_instance_coords
(
instance_index
coords_length
coords
)
;
}
void
hb_ot_var_normalize_variations
(
hb_face_t
*
face
const
hb_variation_t
*
variations
unsigned
int
variations_length
int
*
coords
unsigned
int
coords_length
)
{
for
(
unsigned
int
i
=
0
;
i
<
coords_length
;
i
+
+
)
coords
[
i
]
=
0
;
const
OT
:
:
fvar
&
fvar
=
*
face
-
>
table
.
fvar
;
for
(
unsigned
int
i
=
0
;
i
<
variations_length
;
i
+
+
)
{
hb_ot_var_axis_info_t
info
;
if
(
hb_ot_var_find_axis_info
(
face
variations
[
i
]
.
tag
&
info
)
&
&
info
.
axis_index
<
coords_length
)
coords
[
info
.
axis_index
]
=
fvar
.
normalize_axis_value
(
info
.
axis_index
variations
[
i
]
.
value
)
;
}
face
-
>
table
.
avar
-
>
map_coords
(
coords
coords_length
)
;
}
void
hb_ot_var_normalize_coords
(
hb_face_t
*
face
unsigned
int
coords_length
const
float
*
design_coords
int
*
normalized_coords
)
{
const
OT
:
:
fvar
&
fvar
=
*
face
-
>
table
.
fvar
;
for
(
unsigned
int
i
=
0
;
i
<
coords_length
;
i
+
+
)
normalized_coords
[
i
]
=
fvar
.
normalize_axis_value
(
i
design_coords
[
i
]
)
;
face
-
>
table
.
avar
-
>
map_coords
(
normalized_coords
coords_length
)
;
}
#
endif
