#
include
"
gtest
/
gtest
.
h
"
#
include
"
sfntly
/
font
.
h
"
#
include
"
sfntly
/
table
/
truetype
/
loca_table
.
h
"
#
include
"
test
/
serialization_test
.
h
"
namespace
sfntly
{
const
int32_t
LOCA_NUM_LOCAS
=
1503
;
const
int32_t
LOCAS
[
]
=
{
0x00000
0x00058
0x00058
0x00058
0x00058
0x000B8
0x00138
0x001A4
0x0025C
0x00328
0x003B8
}
;
const
int32_t
NUM_TEST_LOCAS
=
11
;
static
bool
VerifyLOCA
(
Table
*
table
)
{
LocaTablePtr
loca
=
down_cast
<
LocaTable
*
>
(
table
)
;
if
(
loca
=
=
NULL
)
{
return
false
;
}
EXPECT_EQ
(
loca
-
>
NumLocas
(
)
LOCA_NUM_LOCAS
)
;
EXPECT_EQ
(
loca
-
>
num_glyphs
(
)
LOCA_NUM_LOCAS
-
1
)
;
for
(
int32_t
i
=
0
;
i
<
NUM_TEST_LOCAS
-
1
;
+
+
i
)
{
EXPECT_EQ
(
loca
-
>
GlyphOffset
(
i
)
LOCAS
[
i
]
)
;
EXPECT_EQ
(
loca
-
>
GlyphLength
(
i
)
LOCAS
[
i
+
1
]
-
LOCAS
[
i
]
)
;
}
return
true
;
}
bool
VerifyLOCA
(
Table
*
original
Table
*
target
)
{
EXPECT_TRUE
(
VerifyLOCA
(
original
)
)
;
EXPECT_TRUE
(
VerifyLOCA
(
target
)
)
;
return
true
;
}
}
