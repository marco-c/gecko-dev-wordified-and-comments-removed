#
include
<
jni
.
h
>
#
include
<
errno
.
h
>
#
include
<
dlfcn
.
h
>
#
include
<
stdlib
.
h
>
#
include
<
android
/
log
.
h
>
#
include
<
android_native_app_glue
.
h
>
#
define
LOGI
(
.
.
.
)
(
(
void
)
__android_log_print
(
ANDROID_LOG_INFO
"
servo
-
wrapper
"
__VA_ARGS__
)
)
#
define
LOGW
(
.
.
.
)
(
(
void
)
__android_log_print
(
ANDROID_LOG_WARN
"
servo
-
wrapper
"
__VA_ARGS__
)
)
void
android_main
(
struct
android_app
*
state
)
{
LOGI
(
"
in
android_main
"
)
;
void
*
libservo
=
dlopen
(
"
libservo
.
so
"
RTLD_NOW
)
;
if
(
libservo
=
=
NULL
)
{
LOGI
(
"
failed
to
load
servo
lib
:
%
s
"
dlerror
(
)
)
;
return
;
}
LOGI
(
"
loaded
libservo
.
so
"
)
;
void
(
*
android_main
)
(
struct
android_app
*
)
;
*
(
void
*
*
)
(
&
android_main
)
=
dlsym
(
libservo
"
android_main
"
)
;
if
(
android_main
)
{
LOGI
(
"
go
into
android_main
(
)
"
)
;
(
*
android_main
)
(
state
)
;
return
;
}
}
int
main
(
int
argc
char
*
argv
[
]
)
{
LOGI
(
"
WAT
"
)
;
return
0
;
}
