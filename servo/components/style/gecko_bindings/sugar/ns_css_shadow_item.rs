use
app_units
:
:
Au
;
use
gecko
:
:
values
:
:
{
convert_rgba_to_nscolor
convert_nscolor_to_rgba
}
;
use
gecko_bindings
:
:
structs
:
:
nsCSSShadowItem
;
use
values
:
:
computed
:
:
Color
;
use
values
:
:
computed
:
:
effects
:
:
{
BoxShadow
SimpleShadow
}
;
impl
nsCSSShadowItem
{
#
[
inline
]
pub
fn
set_from_box_shadow
(
&
mut
self
shadow
:
BoxShadow
)
{
self
.
set_from_simple_shadow
(
shadow
.
base
)
;
self
.
mSpread
=
shadow
.
spread
.
0
;
self
.
mInset
=
shadow
.
inset
;
}
#
[
inline
]
pub
fn
to_box_shadow
(
&
self
)
-
>
BoxShadow
{
BoxShadow
{
base
:
self
.
extract_simple_shadow
(
)
spread
:
Au
(
self
.
mSpread
)
inset
:
self
.
mInset
}
}
#
[
inline
]
pub
fn
set_from_simple_shadow
(
&
mut
self
shadow
:
SimpleShadow
)
{
self
.
mXOffset
=
shadow
.
horizontal
.
0
;
self
.
mYOffset
=
shadow
.
vertical
.
0
;
self
.
mRadius
=
shadow
.
blur
.
value
(
)
;
self
.
mSpread
=
0
;
self
.
mInset
=
false
;
if
shadow
.
color
.
is_currentcolor
(
)
{
self
.
mHasColor
=
false
;
self
.
mColor
=
0
;
}
else
{
self
.
mHasColor
=
true
;
self
.
mColor
=
convert_rgba_to_nscolor
(
&
shadow
.
color
.
color
)
;
}
}
#
[
inline
]
fn
extract_color
(
&
self
)
-
>
Color
{
if
self
.
mHasColor
{
Color
:
:
rgba
(
convert_nscolor_to_rgba
(
self
.
mColor
)
)
}
else
{
Color
:
:
currentcolor
(
)
}
}
#
[
inline
]
fn
extract_simple_shadow
(
&
self
)
-
>
SimpleShadow
{
SimpleShadow
{
color
:
self
.
extract_color
(
)
horizontal
:
Au
(
self
.
mXOffset
)
vertical
:
Au
(
self
.
mYOffset
)
blur
:
Au
(
self
.
mRadius
)
.
into
(
)
}
}
#
[
inline
]
pub
fn
to_simple_shadow
(
&
self
)
-
>
SimpleShadow
{
debug_assert_eq
!
(
self
.
mSpread
0
)
;
debug_assert_eq
!
(
self
.
mInset
false
)
;
self
.
extract_simple_shadow
(
)
}
}
