use
super
:
:
{
Component
ComponentName
Multiplier
}
;
use
std
:
:
fmt
:
:
{
self
Debug
Write
}
;
use
style_traits
:
:
{
CssWriter
ToCss
}
;
#
[
derive
(
Clone
Copy
Debug
Default
PartialEq
Eq
MallocSizeOf
ToShmem
)
]
pub
struct
DependentDataTypes
(
u8
)
;
bitflags
!
{
impl
DependentDataTypes
:
u8
{
/
/
/
<
length
>
values
depend
on
font
-
size
/
line
-
height
/
zoom
.
.
.
const
LENGTH
=
1
<
<
0
;
/
/
/
<
color
>
values
depend
on
color
-
scheme
etc
.
.
const
COLOR
=
1
<
<
1
;
}
}
#
[
derive
(
Clone
Copy
Debug
MallocSizeOf
PartialEq
)
]
pub
enum
DataType
{
Length
Number
Percentage
LengthPercentage
Color
Image
Url
Integer
Angle
Time
Resolution
TransformFunction
CustomIdent
TransformList
String
}
impl
DataType
{
pub
fn
unpremultiply
(
&
self
)
-
>
Option
<
Component
>
{
match
*
self
{
DataType
:
:
TransformList
=
>
Some
(
Component
{
name
:
ComponentName
:
:
DataType
(
DataType
:
:
TransformFunction
)
multiplier
:
Some
(
Multiplier
:
:
Space
)
}
)
_
=
>
None
}
}
pub
fn
from_str
(
ty
:
&
str
)
-
>
Option
<
Self
>
{
Some
(
match
ty
.
as_bytes
(
)
{
b
"
length
"
=
>
DataType
:
:
Length
b
"
number
"
=
>
DataType
:
:
Number
b
"
percentage
"
=
>
DataType
:
:
Percentage
b
"
length
-
percentage
"
=
>
DataType
:
:
LengthPercentage
b
"
color
"
=
>
DataType
:
:
Color
b
"
image
"
=
>
DataType
:
:
Image
b
"
url
"
=
>
DataType
:
:
Url
b
"
integer
"
=
>
DataType
:
:
Integer
b
"
angle
"
=
>
DataType
:
:
Angle
b
"
time
"
=
>
DataType
:
:
Time
b
"
resolution
"
=
>
DataType
:
:
Resolution
b
"
transform
-
function
"
=
>
DataType
:
:
TransformFunction
b
"
custom
-
ident
"
=
>
DataType
:
:
CustomIdent
b
"
transform
-
list
"
=
>
DataType
:
:
TransformList
b
"
string
"
=
>
DataType
:
:
String
_
=
>
return
None
}
)
}
pub
fn
dependent_types
(
&
self
)
-
>
DependentDataTypes
{
match
self
{
DataType
:
:
Length
|
DataType
:
:
LengthPercentage
|
DataType
:
:
TransformFunction
|
DataType
:
:
TransformList
=
>
DependentDataTypes
:
:
LENGTH
DataType
:
:
Color
=
>
DependentDataTypes
:
:
COLOR
DataType
:
:
Number
|
DataType
:
:
Percentage
|
DataType
:
:
Image
|
DataType
:
:
Url
|
DataType
:
:
Integer
|
DataType
:
:
Angle
|
DataType
:
:
Time
|
DataType
:
:
Resolution
|
DataType
:
:
CustomIdent
|
DataType
:
:
String
=
>
DependentDataTypes
:
:
empty
(
)
}
}
}
impl
ToCss
for
DataType
{
fn
to_css
<
W
>
(
&
self
dest
:
&
mut
CssWriter
<
W
>
)
-
>
fmt
:
:
Result
where
W
:
Write
{
dest
.
write_char
(
'
<
'
)
?
;
dest
.
write_str
(
match
*
self
{
DataType
:
:
Length
=
>
"
length
"
DataType
:
:
Number
=
>
"
number
"
DataType
:
:
Percentage
=
>
"
percentage
"
DataType
:
:
LengthPercentage
=
>
"
length
-
percentage
"
DataType
:
:
Color
=
>
"
color
"
DataType
:
:
Image
=
>
"
image
"
DataType
:
:
Url
=
>
"
url
"
DataType
:
:
Integer
=
>
"
integer
"
DataType
:
:
Angle
=
>
"
angle
"
DataType
:
:
Time
=
>
"
time
"
DataType
:
:
Resolution
=
>
"
resolution
"
DataType
:
:
TransformFunction
=
>
"
transform
-
function
"
DataType
:
:
CustomIdent
=
>
"
custom
-
ident
"
DataType
:
:
TransformList
=
>
"
transform
-
list
"
DataType
:
:
String
=
>
"
string
"
}
)
?
;
dest
.
write_char
(
'
>
'
)
}
}
