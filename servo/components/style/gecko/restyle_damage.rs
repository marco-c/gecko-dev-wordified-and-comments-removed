use
crate
:
:
gecko_bindings
:
:
bindings
;
use
crate
:
:
gecko_bindings
:
:
structs
;
use
crate
:
:
gecko_bindings
:
:
structs
:
:
nsChangeHint
;
use
crate
:
:
matching
:
:
{
StyleChange
StyleDifference
}
;
use
crate
:
:
properties
:
:
ComputedValues
;
use
std
:
:
ops
:
:
{
BitAnd
BitOr
BitOrAssign
Not
}
;
#
[
derive
(
Clone
Copy
Debug
PartialEq
)
]
pub
struct
GeckoRestyleDamage
(
nsChangeHint
)
;
impl
GeckoRestyleDamage
{
#
[
inline
]
pub
fn
new
(
raw
:
nsChangeHint
)
-
>
Self
{
GeckoRestyleDamage
(
raw
)
}
#
[
inline
]
pub
fn
as_change_hint
(
&
self
)
-
>
nsChangeHint
{
self
.
0
}
#
[
inline
]
pub
fn
empty
(
)
-
>
Self
{
GeckoRestyleDamage
(
nsChangeHint
(
0
)
)
}
#
[
inline
]
pub
fn
is_empty
(
&
self
)
-
>
bool
{
self
.
0
=
=
nsChangeHint
(
0
)
}
pub
fn
compute_style_difference
(
old_style
:
&
ComputedValues
new_style
:
&
ComputedValues
)
-
>
StyleDifference
{
let
mut
any_style_changed
=
false
;
let
mut
reset_only
=
false
;
let
hint
=
unsafe
{
bindings
:
:
Gecko_CalcStyleDifference
(
old_style
.
as_gecko_computed_style
(
)
new_style
.
as_gecko_computed_style
(
)
&
mut
any_style_changed
&
mut
reset_only
)
}
;
if
reset_only
&
&
!
old_style
.
custom_properties_equal
(
new_style
)
{
any_style_changed
=
true
;
reset_only
=
false
;
}
let
change
=
if
any_style_changed
{
StyleChange
:
:
Changed
{
reset_only
}
}
else
{
StyleChange
:
:
Unchanged
}
;
let
damage
=
GeckoRestyleDamage
(
nsChangeHint
(
hint
)
)
;
StyleDifference
{
damage
change
}
}
pub
fn
contains
(
self
other
:
Self
)
-
>
bool
{
self
&
other
=
=
other
}
pub
fn
reconstruct
(
)
-
>
Self
{
GeckoRestyleDamage
(
structs
:
:
nsChangeHint
:
:
nsChangeHint_ReconstructFrame
)
}
}
impl
Default
for
GeckoRestyleDamage
{
fn
default
(
)
-
>
Self
{
Self
:
:
empty
(
)
}
}
impl
BitOr
for
GeckoRestyleDamage
{
type
Output
=
Self
;
fn
bitor
(
self
other
:
Self
)
-
>
Self
{
GeckoRestyleDamage
(
self
.
0
|
other
.
0
)
}
}
impl
BitOrAssign
for
GeckoRestyleDamage
{
fn
bitor_assign
(
&
mut
self
other
:
Self
)
{
*
self
=
*
self
|
other
;
}
}
impl
BitAnd
for
GeckoRestyleDamage
{
type
Output
=
Self
;
fn
bitand
(
self
other
:
Self
)
-
>
Self
{
GeckoRestyleDamage
(
nsChangeHint
(
(
self
.
0
)
.
0
&
(
other
.
0
)
.
0
)
)
}
}
impl
Not
for
GeckoRestyleDamage
{
type
Output
=
Self
;
fn
not
(
self
)
-
>
Self
{
GeckoRestyleDamage
(
nsChangeHint
(
!
(
self
.
0
)
.
0
)
)
}
}
