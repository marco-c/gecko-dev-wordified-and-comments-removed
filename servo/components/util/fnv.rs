use
std
:
:
default
:
:
Default
;
use
std
:
:
hash
:
:
{
Hasher
Writer
}
;
#
[
allow
(
missing_copy_implementations
)
]
pub
struct
FnvHasher
(
u64
)
;
impl
Default
for
FnvHasher
{
fn
default
(
)
-
>
FnvHasher
{
FnvHasher
(
0xcbf29ce484222325
)
}
}
impl
Hasher
for
FnvHasher
{
type
Output
=
u64
;
fn
reset
(
&
mut
self
)
{
*
self
=
Default
:
:
default
(
)
;
}
fn
finish
(
&
self
)
-
>
u64
{
self
.
0
}
}
impl
Writer
for
FnvHasher
{
fn
write
(
&
mut
self
bytes
:
&
[
u8
]
)
{
let
FnvHasher
(
mut
hash
)
=
*
self
;
for
byte
in
bytes
.
iter
(
)
{
hash
=
hash
^
(
*
byte
as
u64
)
;
hash
=
hash
*
0x100000001b3
;
}
*
self
=
FnvHasher
(
hash
)
;
}
}
