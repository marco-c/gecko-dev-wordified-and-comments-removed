use
hyper
:
:
header
:
:
Headers
;
use
hyper
:
:
status
:
:
StatusCode
;
use
std
:
:
cell
:
:
RefCell
;
use
std
:
:
rc
:
:
Rc
;
use
url
:
:
Url
;
#
[
derive
(
Clone
PartialEq
Copy
Debug
)
]
pub
enum
ResponseType
{
Basic
CORS
Default
Error
Opaque
OpaqueRedirect
}
#
[
derive
(
Clone
Copy
)
]
pub
enum
TerminationReason
{
EndUserAbort
Fatal
Timeout
}
#
[
derive
(
Clone
Debug
)
]
pub
enum
ResponseBody
{
Empty
Receiving
(
Vec
<
u8
>
)
Done
(
Vec
<
u8
>
)
}
#
[
derive
(
Clone
Debug
)
]
pub
enum
CacheState
{
None
Local
Validated
Partial
}
#
[
derive
(
Clone
Copy
HeapSizeOf
Deserialize
Serialize
)
]
pub
enum
HttpsState
{
None
Deprecated
Modern
}
pub
enum
ResponseMsg
{
Chunk
(
Vec
<
u8
>
)
Finished
Errored
}
#
[
derive
(
Clone
)
]
pub
struct
Response
{
pub
response_type
:
ResponseType
pub
termination_reason
:
Option
<
TerminationReason
>
pub
url
:
Option
<
Url
>
pub
url_list
:
RefCell
<
Vec
<
Url
>
>
pub
status
:
Option
<
StatusCode
>
pub
headers
:
Headers
pub
body
:
RefCell
<
ResponseBody
>
pub
cache_state
:
CacheState
pub
https_state
:
HttpsState
pub
internal_response
:
Option
<
Rc
<
Response
>
>
}
impl
Response
{
pub
fn
network_error
(
)
-
>
Response
{
Response
{
response_type
:
ResponseType
:
:
Error
termination_reason
:
None
url
:
None
url_list
:
RefCell
:
:
new
(
vec
!
[
]
)
status
:
None
headers
:
Headers
:
:
new
(
)
body
:
RefCell
:
:
new
(
ResponseBody
:
:
Empty
)
cache_state
:
CacheState
:
:
None
https_state
:
HttpsState
:
:
None
internal_response
:
None
}
}
pub
fn
is_network_error
(
&
self
)
-
>
bool
{
match
self
.
response_type
{
ResponseType
:
:
Error
=
>
true
_
=
>
false
}
}
}
