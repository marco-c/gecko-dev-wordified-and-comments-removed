use
dom
:
:
bindings
:
:
codegen
:
:
Bindings
:
:
EventBinding
:
:
EventMethods
;
use
dom
:
:
bindings
:
:
conversions
:
:
Castable
;
use
dom
:
:
element
:
:
Element
;
use
dom
:
:
event
:
:
{
Event
EventBubbles
EventCancelable
}
;
use
dom
:
:
eventtarget
:
:
EventTarget
;
use
dom
:
:
mouseevent
:
:
MouseEvent
;
use
dom
:
:
node
:
:
window_from_node
;
use
std
:
:
borrow
:
:
ToOwned
;
pub
trait
Activatable
{
fn
as_element
(
&
self
)
-
>
&
Element
;
fn
is_instance_activatable
(
&
self
)
-
>
bool
;
fn
pre_click_activation
(
&
self
)
;
fn
canceled_activation
(
&
self
)
;
fn
activation_behavior
(
&
self
event
:
&
Event
target
:
&
EventTarget
)
;
fn
implicit_submission
(
&
self
ctrlKey
:
bool
shiftKey
:
bool
altKey
:
bool
metaKey
:
bool
)
;
fn
synthetic_click_activation
(
&
self
ctrlKey
:
bool
shiftKey
:
bool
altKey
:
bool
metaKey
:
bool
)
{
let
element
=
self
.
as_element
(
)
;
if
element
.
click_in_progress
(
)
{
return
;
}
element
.
set_click_in_progress
(
true
)
;
self
.
pre_click_activation
(
)
;
let
win
=
window_from_node
(
element
)
;
let
target
=
element
.
upcast
(
)
;
let
mouse
=
MouseEvent
:
:
new
(
win
.
r
(
)
"
click
"
.
to_owned
(
)
EventBubbles
:
:
DoesNotBubble
EventCancelable
:
:
NotCancelable
Some
(
win
.
r
(
)
)
1
0
0
0
0
ctrlKey
shiftKey
altKey
metaKey
0
None
)
;
let
event
=
mouse
.
upcast
:
:
<
Event
>
(
)
;
event
.
fire
(
target
)
;
if
event
.
DefaultPrevented
(
)
{
self
.
canceled_activation
(
)
;
}
else
{
self
.
activation_behavior
(
event
target
)
;
}
element
.
set_click_in_progress
(
false
)
;
}
}
