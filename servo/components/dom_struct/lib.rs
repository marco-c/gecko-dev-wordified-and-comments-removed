#
!
[
feature
(
proc_macro
)
]
extern
crate
proc_macro
;
use
proc_macro
:
:
{
TokenStream
quote
}
;
#
[
proc_macro_attribute
]
pub
fn
dom_struct
(
args
:
TokenStream
input
:
TokenStream
)
-
>
TokenStream
{
if
!
args
.
is_empty
(
)
{
panic
!
(
"
#
[
dom_struct
]
takes
no
arguments
"
)
;
}
let
attributes
=
quote
!
{
#
[
derive
(
DenyPublicFields
DomObject
JSTraceable
MallocSizeOf
)
]
#
[
must_root
]
#
[
repr
(
C
)
]
}
;
let
attributes
:
TokenStream
=
attributes
.
to_string
(
)
.
parse
(
)
.
unwrap
(
)
;
attributes
.
into_iter
(
)
.
chain
(
input
.
into_iter
(
)
)
.
collect
(
)
}
