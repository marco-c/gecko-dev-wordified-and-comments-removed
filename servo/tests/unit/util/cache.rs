use
std
:
:
cell
:
:
Cell
;
use
util
:
:
cache
:
:
{
HashCache
LRUCache
}
;
#
[
test
]
fn
test_hashcache
(
)
{
let
mut
cache
:
HashCache
<
usize
Cell
<
&
str
>
>
=
HashCache
:
:
new
(
)
;
cache
.
insert
(
1
Cell
:
:
new
(
"
one
"
)
)
;
assert
!
(
cache
.
find
(
&
1
)
.
is_some
(
)
)
;
assert
!
(
cache
.
find
(
&
2
)
.
is_none
(
)
)
;
cache
.
find_or_create
(
&
2
|
_v
|
{
Cell
:
:
new
(
"
two
"
)
}
)
;
assert
!
(
cache
.
find
(
&
1
)
.
is_some
(
)
)
;
assert
!
(
cache
.
find
(
&
2
)
.
is_some
(
)
)
;
}
#
[
test
]
fn
test_lru_cache
(
)
{
let
one
=
Cell
:
:
new
(
"
one
"
)
;
let
two
=
Cell
:
:
new
(
"
two
"
)
;
let
three
=
Cell
:
:
new
(
"
three
"
)
;
let
four
=
Cell
:
:
new
(
"
four
"
)
;
let
mut
cache
:
LRUCache
<
usize
Cell
<
&
str
>
>
=
LRUCache
:
:
new
(
2
)
;
cache
.
insert
(
1
one
)
;
cache
.
insert
(
2
two
)
;
cache
.
insert
(
3
three
)
;
assert
!
(
cache
.
find
(
&
1
)
.
is_none
(
)
)
;
assert
!
(
cache
.
find
(
&
3
)
.
is_some
(
)
)
;
assert
!
(
cache
.
find
(
&
2
)
.
is_some
(
)
)
;
cache
.
insert
(
4
four
)
;
assert
!
(
cache
.
find
(
&
1
)
.
is_none
(
)
)
;
assert
!
(
cache
.
find
(
&
2
)
.
is_some
(
)
)
;
assert
!
(
cache
.
find
(
&
3
)
.
is_none
(
)
)
;
assert
!
(
cache
.
find
(
&
4
)
.
is_some
(
)
)
;
cache
.
find_or_create
(
&
1
|
_
|
{
Cell
:
:
new
(
"
one
"
)
}
)
;
assert
!
(
cache
.
find
(
&
1
)
.
is_some
(
)
)
;
assert
!
(
cache
.
find
(
&
2
)
.
is_none
(
)
)
;
assert
!
(
cache
.
find
(
&
3
)
.
is_none
(
)
)
;
assert
!
(
cache
.
find
(
&
4
)
.
is_some
(
)
)
;
}
