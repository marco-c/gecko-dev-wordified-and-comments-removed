"
"
"
Add
dependencies
to
dummy
macosx64
tasks
.
"
"
"
from
taskgraph
.
transforms
.
base
import
TransformSequence
transforms
=
TransformSequence
(
)
transforms
.
add
def
add_dependencies
(
config
jobs
)
:
    
for
job
in
jobs
:
        
dependencies
=
{
}
        
platform
=
job
.
get
(
"
attributes
"
{
}
)
.
get
(
"
build_platform
"
)
        
if
not
platform
:
            
continue
        
arm
=
platform
.
replace
(
"
macosx64
"
"
macosx64
-
aarch64
"
)
        
intel
=
platform
.
replace
(
"
macosx64
"
"
macosx64
-
x64
"
)
        
for
dep_task
in
config
.
kind_dependencies_tasks
.
values
(
)
:
            
if
dep_task
.
attributes
.
get
(
"
build_platform
"
)
:
                
if
dep_task
.
attributes
[
"
build_platform
"
]
not
in
(
platform
arm
intel
)
:
                    
continue
            
dependencies
[
dep_task
.
label
]
=
dep_task
.
label
            
if
(
                
dep_task
.
kind
=
=
"
build
"
                
and
dep_task
.
attributes
[
"
build_platform
"
]
=
=
platform
            
)
:
                
job
[
"
run
-
on
-
projects
"
]
=
dep_task
.
attributes
.
get
(
"
run_on_projects
"
)
        
job
.
setdefault
(
"
dependencies
"
{
}
)
.
update
(
dependencies
)
        
job
[
"
if
-
dependencies
"
]
=
list
(
dependencies
)
        
yield
job
