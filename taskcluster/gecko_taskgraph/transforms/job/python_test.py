"
"
"
Support
for
running
mach
python
-
test
tasks
(
via
run
-
task
)
"
"
"
from
taskgraph
.
util
.
schema
import
Schema
from
voluptuous
import
Required
Optional
from
gecko_taskgraph
.
transforms
.
job
import
run_job_using
configure_taskdesc_for_run
python_test_schema
=
Schema
(
    
{
        
Required
(
"
using
"
)
:
"
python
-
test
"
        
Required
(
"
python
-
version
"
)
:
int
        
Required
(
"
subsuite
"
)
:
str
        
Optional
(
"
workdir
"
)
:
str
    
}
)
defaults
=
{
    
"
python
-
version
"
:
3
    
"
subsuite
"
:
"
default
"
}
run_job_using
(
    
"
docker
-
worker
"
"
python
-
test
"
schema
=
python_test_schema
defaults
=
defaults
)
run_job_using
(
    
"
generic
-
worker
"
"
python
-
test
"
schema
=
python_test_schema
defaults
=
defaults
)
def
configure_python_test
(
config
job
taskdesc
)
:
    
run
=
job
[
"
run
"
]
    
worker
=
job
[
"
worker
"
]
    
run
[
"
mach
"
]
=
(
"
python
-
test
-
-
subsuite
{
subsuite
}
-
-
run
-
slow
"
)
.
format
(
*
*
run
)
    
run
[
"
using
"
]
=
"
mach
"
    
del
run
[
"
subsuite
"
]
    
configure_taskdesc_for_run
(
config
job
taskdesc
worker
[
"
implementation
"
]
)
