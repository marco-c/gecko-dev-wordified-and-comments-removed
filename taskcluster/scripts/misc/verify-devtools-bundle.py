"
"
"
Check
that
the
current
sourcemap
and
worker
bundles
built
for
DevTools
are
up
to
date
.
This
job
should
fail
if
any
file
impacting
the
bundle
creation
was
modified
without
regenerating
the
bundles
.
This
check
should
be
run
after
building
the
bundles
via
:
cd
devtools
/
client
/
debugger
yarn
&
&
node
bin
/
bundle
.
js
Those
steps
are
done
in
the
devtools
-
verify
-
bundle
job
prior
to
calling
this
script
.
The
script
will
only
run
hg
status
devtools
/
and
check
that
no
change
is
detected
by
mercurial
.
"
"
"
import
subprocess
import
sys
overall_failure
=
False
print
(
"
Run
hg
status
devtools
/
"
)
status
=
(
    
subprocess
.
check_output
(
[
"
hg
"
"
status
"
"
devtools
/
"
]
)
.
decode
(
"
utf
-
8
"
)
.
split
(
"
\
n
"
)
)
print
(
"
status
:
"
)
print
(
"
-
"
*
80
)
failures
=
[
]
for
l
in
status
:
    
if
not
l
:
        
continue
    
if
"
module
-
manifest
.
json
"
in
l
:
        
continue
    
failures
.
append
(
l
)
    
overall_failure
=
True
subprocess
.
check_output
(
[
"
hg
"
"
revert
"
"
-
C
"
"
.
"
]
)
if
overall_failure
:
    
doc
=
"
https
:
/
/
firefox
-
source
-
docs
.
mozilla
.
org
/
devtools
/
tests
/
node
-
tests
.
html
#
devtools
-
bundle
"
    
print
(
        
"
TEST
-
UNEXPECTED
-
FAIL
|
devtools
-
bundle
|
DevTools
bundles
need
to
be
regenerated
"
        
+
f
"
instructions
at
:
{
doc
}
"
    
)
    
print
(
"
The
following
devtools
bundles
were
detected
as
outdated
:
"
)
    
for
failure
in
failures
:
        
print
(
failure
)
    
sys
.
exit
(
1
)
