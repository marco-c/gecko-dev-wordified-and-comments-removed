from
__future__
import
absolute_import
print_function
unicode_literals
import
attr
from
.
.
parameters
import
Parameters
from
.
.
config
import
GraphConfig
attr
.
s
(
frozen
=
True
)
class
TransformConfig
(
object
)
:
    
"
"
"
    
A
container
for
configuration
affecting
transforms
.
The
config
argument
    
to
transforms
is
an
instance
of
this
class
.
    
"
"
"
    
kind
=
attr
.
ib
(
)
    
path
=
attr
.
ib
(
type
=
basestring
)
    
config
=
attr
.
ib
(
type
=
dict
)
    
params
=
attr
.
ib
(
type
=
Parameters
)
    
kind_dependencies_tasks
=
attr
.
ib
(
)
    
graph_config
=
attr
.
ib
(
type
=
GraphConfig
)
attr
.
s
(
)
class
TransformSequence
(
object
)
:
    
"
"
"
    
Container
for
a
sequence
of
transforms
.
Each
transform
is
represented
as
a
    
callable
taking
(
config
items
)
and
returning
a
generator
which
will
yield
    
transformed
items
.
The
resulting
sequence
has
the
same
interface
.
    
This
is
convenient
to
use
in
a
file
full
of
transforms
as
it
provides
a
    
decorator
transforms
.
add
that
will
add
the
decorated
function
to
the
    
sequence
.
    
"
"
"
    
_transforms
=
attr
.
ib
(
factory
=
list
)
    
def
__call__
(
self
config
items
)
:
        
for
xform
in
self
.
_transforms
:
            
items
=
xform
(
config
items
)
            
if
items
is
None
:
                
raise
Exception
(
"
Transform
{
}
is
not
a
generator
"
.
format
(
xform
)
)
        
return
items
    
def
add
(
self
func
)
:
        
self
.
_transforms
.
append
(
func
)
        
return
func
