"
"
"
Transform
the
beetmover
-
source
task
to
also
append
build
as
dependency
"
"
"
from
__future__
import
absolute_import
from
taskgraph
.
transforms
.
base
import
TransformSequence
transforms
=
TransformSequence
(
)
transforms
.
add
def
tweak_beetmover_source_dependencies_and_upstream_artifacts
(
config
jobs
)
:
    
for
job
in
jobs
:
        
if
job
[
'
attributes
'
]
[
'
shipping_product
'
]
=
=
'
firefox
'
:
            
job
[
'
dependencies
'
]
[
'
build
'
]
=
u
'
build
-
linux64
-
nightly
/
opt
'
        
elif
job
[
'
attributes
'
]
[
'
shipping_product
'
]
=
=
'
fennec
'
:
            
job
[
'
dependencies
'
]
[
'
build
'
]
=
u
'
build
-
android
-
api
-
16
-
nightly
/
opt
'
        
elif
job
[
'
attributes
'
]
[
'
shipping_product
'
]
=
=
'
devedition
'
:
            
job
[
'
dependencies
'
]
[
'
build
'
]
=
u
'
build
-
linux64
-
devedition
-
nightly
/
opt
'
        
else
:
            
raise
NotImplemented
(
                
"
Unknown
shipping_product
{
}
for
beetmover_source
!
"
.
format
(
                    
job
[
'
attributes
'
]
[
'
shipping_product
'
]
                
)
            
)
        
upstream_artifacts
=
job
[
'
worker
'
]
[
'
upstream
-
artifacts
'
]
        
for
artifact
in
upstream_artifacts
:
            
if
artifact
[
'
taskType
'
]
=
=
'
build
'
:
                
artifact
[
'
paths
'
]
.
append
(
u
'
public
/
build
/
balrog_props
.
json
'
)
                
break
        
yield
job
