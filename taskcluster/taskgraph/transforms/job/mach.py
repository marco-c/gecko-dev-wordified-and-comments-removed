"
"
"
Support
for
running
mach
tasks
(
via
run
-
task
)
"
"
"
from
__future__
import
absolute_import
print_function
unicode_literals
from
taskgraph
.
transforms
.
job
import
run_job_using
from
taskgraph
.
transforms
.
job
.
run_task
import
docker_worker_run_task
from
voluptuous
import
Schema
Required
mach_schema
=
Schema
(
{
    
Required
(
'
using
'
)
:
'
mach
'
    
Required
(
'
mach
'
)
:
basestring
    
Required
(
'
requires
-
build
'
default
=
False
)
:
bool
}
)
run_job_using
(
"
docker
-
worker
"
"
mach
"
schema
=
mach_schema
)
def
docker_worker_mach
(
config
job
taskdesc
)
:
    
run
=
job
[
'
run
'
]
    
run
[
'
command
'
]
=
'
cd
/
home
/
worker
/
checkouts
/
gecko
&
&
.
/
mach
'
+
run
[
'
mach
'
]
    
run
[
'
checkout
'
]
=
True
    
del
run
[
'
mach
'
]
    
docker_worker_run_task
(
config
job
taskdesc
)
