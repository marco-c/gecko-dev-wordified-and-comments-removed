#
ifndef
nsViewManager_h___
#
define
nsViewManager_h___
#
include
"
nscore
.
h
"
#
include
"
nsView
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsCRT
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
EventForwards
.
h
"
class
nsIWidget
;
struct
nsRect
;
class
nsRegion
;
namespace
mozilla
{
class
PresShell
;
}
class
nsViewManager
final
{
~
nsViewManager
(
)
;
public
:
friend
class
nsView
;
typedef
mozilla
:
:
LayoutDeviceIntRect
LayoutDeviceIntRect
;
typedef
mozilla
:
:
LayoutDeviceIntRegion
LayoutDeviceIntRegion
;
NS_INLINE_DECL_REFCOUNTING
(
nsViewManager
)
nsViewManager
(
)
;
nsresult
Init
(
)
;
nsView
*
CreateView
(
const
nsSize
&
aSize
)
;
nsView
*
GetRootView
(
)
{
return
mRootView
;
}
void
SetRootView
(
nsView
*
aView
)
;
nsSize
GetWindowDimensions
(
)
const
;
void
SetWindowDimensions
(
const
nsSize
&
aSize
bool
aDelayResize
=
false
)
;
void
FlushDelayedResize
(
)
;
void
ResizeView
(
nsView
*
aView
const
nsSize
&
aSize
)
;
void
SetPresShell
(
mozilla
:
:
PresShell
*
aPresShell
)
{
mPresShell
=
aPresShell
;
}
mozilla
:
:
PresShell
*
GetPresShell
(
)
const
{
return
mPresShell
;
}
public
:
static
uint32_t
GetLastUserEventTime
(
)
{
return
gLastUserEventTime
;
}
static
void
MaybeUpdateLastUserEventTime
(
mozilla
:
:
WidgetGUIEvent
*
)
;
MOZ_CAN_RUN_SCRIPT
void
ProcessPendingUpdates
(
)
;
private
:
static
uint32_t
gLastUserEventTime
;
MOZ_CAN_RUN_SCRIPT_BOUNDARY
void
CallWillPaintOnObservers
(
)
;
static
void
CollectVMsForWillPaint
(
nsView
*
aView
nsViewManager
*
aParentVM
nsTArray
<
RefPtr
<
nsViewManager
>
>
&
aVMs
)
;
MOZ_CAN_RUN_SCRIPT_BOUNDARY
void
DoSetWindowDimensions
(
const
nsSize
&
)
;
bool
ShouldDelayResize
(
)
const
;
nsViewManager
*
RootViewManager
(
)
const
;
nsViewManager
*
GetParentViewManager
(
)
const
;
bool
IsRootVM
(
)
const
{
return
!
GetParentViewManager
(
)
;
}
MOZ_CAN_RUN_SCRIPT
void
WillPaintWindow
(
nsIWidget
*
aWidget
)
;
MOZ_CAN_RUN_SCRIPT
void
PaintWindow
(
nsIWidget
*
aWidget
)
;
MOZ_CAN_RUN_SCRIPT
void
DidPaintWindow
(
)
;
mozilla
:
:
PresShell
*
mPresShell
;
nsSize
mDelayedResize
;
nsView
*
mRootView
;
}
;
#
endif
