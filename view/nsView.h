#
ifndef
nsView_h__
#
define
nsView_h__
#
include
"
nsCoord
.
h
"
#
include
"
nsRect
.
h
"
#
include
"
nsPoint
.
h
"
#
include
"
nsRegion
.
h
"
#
include
"
nsCRT
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIWidgetListener
.
h
"
#
include
"
Units
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
CallState
.
h
"
#
include
"
mozilla
/
EventForwards
.
h
"
class
nsViewManager
;
class
nsIWidget
;
class
nsIFrame
;
namespace
mozilla
{
class
PresShell
;
namespace
dom
{
class
BrowserParent
;
}
namespace
widget
{
struct
InitData
;
enum
class
TransparencyMode
:
uint8_t
;
enum
class
WindowType
:
uint8_t
;
}
}
class
nsView
final
:
public
nsIWidgetListener
{
public
:
friend
class
nsViewManager
;
typedef
mozilla
:
:
LayoutDeviceIntRect
LayoutDeviceIntRect
;
typedef
mozilla
:
:
LayoutDeviceIntRegion
LayoutDeviceIntRegion
;
void
operator
delete
(
void
*
ptr
)
{
:
:
operator
delete
(
ptr
)
;
}
nsViewManager
*
GetViewManager
(
)
const
{
return
mViewManager
;
}
void
Destroy
(
)
;
void
DetachWidget
(
)
;
void
AttachToTopLevelWidget
(
nsIWidget
*
aWidget
)
;
void
DetachFromTopLevelWidget
(
)
;
nsIWidget
*
GetWidget
(
)
const
{
return
mWindow
;
}
bool
HasWidget
(
)
const
{
return
mWindow
!
=
nullptr
;
}
#
ifdef
DEBUG
virtual
void
List
(
FILE
*
out
int32_t
aIndent
=
0
)
const
;
#
endif
mozilla
:
:
PresShell
*
GetPresShell
(
)
override
;
nsView
*
GetView
(
)
override
{
return
this
;
}
bool
IsPaintSuppressed
(
)
const
override
{
return
IsPrimaryFramePaintSuppressed
(
)
;
}
bool
WindowResized
(
nsIWidget
*
aWidget
int32_t
aWidth
int32_t
aHeight
)
override
;
#
ifdef
MOZ_WIDGET_ANDROID
void
DynamicToolbarMaxHeightChanged
(
mozilla
:
:
ScreenIntCoord
aHeight
)
override
;
void
DynamicToolbarOffsetChanged
(
mozilla
:
:
ScreenIntCoord
aOffset
)
override
;
void
KeyboardHeightChanged
(
mozilla
:
:
ScreenIntCoord
aHeight
)
override
;
void
AndroidPipModeChanged
(
bool
)
override
;
#
endif
MOZ_CAN_RUN_SCRIPT_BOUNDARY
void
PaintWindow
(
nsIWidget
*
aWidget
)
override
;
void
DidCompositeWindow
(
mozilla
:
:
layers
:
:
TransactionId
aTransactionId
const
mozilla
:
:
TimeStamp
&
aCompositeStart
const
mozilla
:
:
TimeStamp
&
aCompositeEnd
)
override
;
MOZ_CAN_RUN_SCRIPT_BOUNDARY
nsEventStatus
HandleEvent
(
mozilla
:
:
WidgetGUIEvent
*
)
override
;
void
SafeAreaInsetsChanged
(
const
mozilla
:
:
LayoutDeviceIntMargin
&
)
override
;
virtual
~
nsView
(
)
;
bool
IsPrimaryFramePaintSuppressed
(
)
const
;
private
:
explicit
nsView
(
nsViewManager
*
=
nullptr
)
;
void
CallOnAllRemoteChildren
(
const
std
:
:
function
<
mozilla
:
:
CallState
(
mozilla
:
:
dom
:
:
BrowserParent
*
)
>
&
aCallback
)
;
nsViewManager
*
mViewManager
;
nsCOMPtr
<
nsIWidget
>
mWindow
;
nsCOMPtr
<
nsIWidget
>
mPreviousWindow
;
}
;
#
endif
