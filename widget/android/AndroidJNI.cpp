#
include
"
mozilla
/
Hal
.
h
"
#
include
"
nsIFile
.
h
"
#
include
"
nsString
.
h
"
#
include
"
AndroidBridge
.
h
"
#
include
"
AndroidContentController
.
h
"
#
include
"
AndroidGraphicBuffer
.
h
"
#
include
<
jni
.
h
>
#
include
<
pthread
.
h
>
#
include
<
dlfcn
.
h
>
#
include
<
stdio
.
h
>
#
include
<
unistd
.
h
>
#
include
"
nsAppShell
.
h
"
#
include
"
nsWindow
.
h
"
#
include
<
android
/
log
.
h
>
#
include
"
nsIObserverService
.
h
"
#
include
"
mozilla
/
Services
.
h
"
#
include
"
nsThreadUtils
.
h
"
#
include
"
mozilla
/
unused
.
h
"
#
include
"
mozilla
/
MathAlgorithms
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
mozilla
/
layers
/
APZCTreeManager
.
h
"
#
include
"
nsPluginInstanceOwner
.
h
"
#
include
"
AndroidSurfaceTexture
.
h
"
using
namespace
mozilla
;
using
namespace
mozilla
:
:
dom
;
using
namespace
mozilla
:
:
layers
;
using
namespace
mozilla
:
:
widget
;
extern
"
C
"
{
NS_EXPORT
void
JNICALL
Java_org_mozilla_gecko_GeckoAppShell_onSurfaceTextureFrameAvailable
(
JNIEnv
*
jenv
jclass
jobject
surfaceTexture
jint
id
)
{
mozilla
:
:
gl
:
:
AndroidSurfaceTexture
*
st
=
mozilla
:
:
gl
:
:
AndroidSurfaceTexture
:
:
Find
(
id
)
;
if
(
!
st
)
{
__android_log_print
(
ANDROID_LOG_ERROR
"
GeckoJNI
"
"
Failed
to
find
AndroidSurfaceTexture
with
id
%
d
"
id
)
;
return
;
}
st
-
>
NotifyFrameAvailable
(
)
;
}
}
