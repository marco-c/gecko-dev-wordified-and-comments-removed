#
ifndef
mozilla_widget_AsyncDBus_h
#
define
mozilla_widget_AsyncDBus_h
#
include
"
mozilla
/
GRefPtr
.
h
"
#
include
"
mozilla
/
GUniquePtr
.
h
"
#
include
"
mozilla
/
MozPromise
.
h
"
namespace
mozilla
:
:
widget
{
using
DBusProxyPromise
=
MozPromise
<
RefPtr
<
GDBusProxy
>
GUniquePtr
<
GError
>
true
>
;
using
DBusCallPromise
=
MozPromise
<
RefPtr
<
GVariant
>
GUniquePtr
<
GError
>
true
>
;
RefPtr
<
DBusProxyPromise
>
CreateDBusProxyForBus
(
GBusType
aBusType
GDBusProxyFlags
aFlags
GDBusInterfaceInfo
*
aInterfaceInfo
const
char
*
aName
const
char
*
aObjectPath
const
char
*
aInterfaceName
GCancellable
*
aCancellable
=
nullptr
)
;
RefPtr
<
DBusCallPromise
>
DBusProxyCall
(
GDBusProxy
*
const
char
*
aMethod
GVariant
*
aArgs
GDBusCallFlags
gint
aTimeout
=
-
1
GCancellable
*
=
nullptr
)
;
RefPtr
<
DBusCallPromise
>
DBusProxyCallWithUnixFDList
(
GDBusProxy
*
const
char
*
aMethod
GVariant
*
aArgs
GDBusCallFlags
gint
aTimeout
=
-
1
GUnixFDList
*
=
nullptr
GCancellable
*
=
nullptr
)
;
void
MakePortalRequestToken
(
const
nsCString
&
aType
nsACString
&
aOutToken
)
;
void
GetPortalRequestPath
(
GDBusProxy
*
const
nsCString
&
aRequestToken
nsACString
&
aOutPath
)
;
using
PortalResponseListener
=
std
:
:
function
<
void
(
GVariant
*
)
>
;
guint
OnDBusPortalResponse
(
GDBusProxy
*
aProxy
const
nsCString
&
aRequestToken
PortalResponseListener
)
;
}
#
endif
