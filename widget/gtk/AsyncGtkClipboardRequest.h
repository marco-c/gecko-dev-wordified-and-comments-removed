#
ifndef
mozilla_AsyncGtkClipboardRequest_h
#
define
mozilla_AsyncGtkClipboardRequest_h
#
include
"
nsClipboard
.
h
"
namespace
mozilla
{
class
MOZ_STACK_CLASS
AsyncGtkClipboardRequest
{
struct
Request
{
explicit
Request
(
ClipboardDataType
aDataType
)
:
mDataType
(
aDataType
)
{
}
void
Complete
(
const
void
*
)
;
const
ClipboardDataType
mDataType
;
Maybe
<
ClipboardData
>
mData
;
bool
mTimedOut
=
false
;
}
;
UniquePtr
<
Request
>
mRequest
;
static
void
OnDataReceived
(
GtkClipboard
*
GtkSelectionData
*
gpointer
)
;
static
void
OnTextReceived
(
GtkClipboard
*
const
gchar
*
gpointer
)
;
public
:
AsyncGtkClipboardRequest
(
ClipboardDataType
int32_t
aWhichClipboard
const
char
*
aMimeType
=
nullptr
)
;
bool
HasCompleted
(
)
const
{
return
mRequest
-
>
mData
.
isSome
(
)
;
}
ClipboardData
TakeResult
(
)
{
if
(
!
HasCompleted
(
)
)
{
return
{
}
;
}
auto
request
=
std
:
:
move
(
mRequest
)
;
return
request
-
>
mData
.
extract
(
)
;
}
~
AsyncGtkClipboardRequest
(
)
;
}
;
}
;
#
endif
