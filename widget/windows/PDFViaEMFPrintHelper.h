#
ifndef
PDFVIAEMFPRINTHELPER_H_
#
define
PDFVIAEMFPRINTHELPER_H_
#
include
"
nsCOMPtr
.
h
"
#
include
"
PDFiumEngineShim
.
h
"
#
include
"
mozilla
/
Vector
.
h
"
#
include
"
mozilla
/
ipc
/
FileDescriptor
.
h
"
#
include
"
mozilla
/
ipc
/
Shmem
.
h
"
#
include
<
windows
.
h
>
class
nsIFile
;
class
nsFileInputStream
;
namespace
mozilla
{
namespace
ipc
{
class
IShmemAllocator
;
}
namespace
widget
{
class
PDFViaEMFPrintHelper
{
public
:
typedef
mozilla
:
:
ipc
:
:
FileDescriptor
FileDescriptor
;
PDFViaEMFPrintHelper
(
)
;
virtual
~
PDFViaEMFPrintHelper
(
)
;
NS_IMETHOD
OpenDocument
(
nsIFile
*
aFile
)
;
NS_IMETHOD
OpenDocument
(
const
FileDescriptor
&
aFD
)
;
void
CloseDocument
(
)
;
int
GetPageCount
(
)
const
{
return
mPDFiumEngine
-
>
GetPageCount
(
mPDFDoc
)
;
}
bool
DrawPage
(
HDC
aPrinterDC
unsigned
int
aPageIndex
int
aPageWidth
int
aPageHeight
)
;
bool
SavePageToFile
(
const
wchar_t
*
aFilePath
unsigned
int
aPageIndex
int
aPageWidth
int
aPageHeight
)
;
bool
SavePageToBuffer
(
unsigned
int
aPageIndex
int
aPageWidth
int
aPageHeight
ipc
:
:
Shmem
&
aMem
mozilla
:
:
ipc
:
:
IShmemAllocator
*
aAllocator
)
;
protected
:
virtual
bool
CreatePDFiumEngineIfNeed
(
)
;
bool
RenderPageToDC
(
HDC
aDC
unsigned
int
aPageIndex
int
aPageWidth
int
aPageHeight
)
;
RefPtr
<
PDFiumEngineShim
>
mPDFiumEngine
;
FPDF_DOCUMENT
mPDFDoc
;
PRFileDesc
*
mPrfile
;
}
;
}
}
#
endif
