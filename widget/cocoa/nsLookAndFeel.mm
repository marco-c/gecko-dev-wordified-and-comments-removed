#
include
"
AppearanceOverride
.
h
"
#
include
"
nsLookAndFeel
.
h
"
#
include
"
nsCocoaFeatures
.
h
"
#
include
"
nsNativeThemeColors
.
h
"
#
include
"
nsStyleConsts
.
h
"
#
include
"
nsCocoaFeatures
.
h
"
#
include
"
nsIContent
.
h
"
#
include
"
gfxFont
.
h
"
#
include
"
gfxFontConstants
.
h
"
#
include
"
gfxPlatformMac
.
h
"
#
include
"
nsCSSColorUtils
.
h
"
#
include
"
mozilla
/
FontPropertyTypes
.
h
"
#
include
"
mozilla
/
gfx
/
2D
.
h
"
#
include
"
mozilla
/
StaticPrefs_widget
.
h
"
#
include
"
mozilla
/
widget
/
WidgetMessageUtils
.
h
"
#
include
"
SDKDeclarations
.
h
"
#
import
<
Cocoa
/
Cocoa
.
h
>
#
include
"
nsObjCExceptions
.
h
"
using
namespace
mozilla
;
nsLookAndFeel
:
:
nsLookAndFeel
(
)
=
default
;
nsLookAndFeel
:
:
~
nsLookAndFeel
(
)
=
default
;
static
nscolor
GetColorFromNSColor
(
NSColor
*
aColor
)
{
NSColor
*
deviceColor
=
[
aColor
colorUsingColorSpaceName
:
NSDeviceRGBColorSpace
]
;
return
NS_RGB
(
(
unsigned
int
)
(
[
deviceColor
redComponent
]
*
255
.
0
)
(
unsigned
int
)
(
[
deviceColor
greenComponent
]
*
255
.
0
)
(
unsigned
int
)
(
[
deviceColor
blueComponent
]
*
255
.
0
)
)
;
}
static
nscolor
GetColorFromNSColorWithAlpha
(
NSColor
*
aColor
float
alpha
)
{
NSColor
*
deviceColor
=
[
aColor
colorUsingColorSpaceName
:
NSDeviceRGBColorSpace
]
;
return
NS_RGBA
(
(
unsigned
int
)
(
[
deviceColor
redComponent
]
*
255
.
0
)
(
unsigned
int
)
(
[
deviceColor
greenComponent
]
*
255
.
0
)
(
unsigned
int
)
(
[
deviceColor
blueComponent
]
*
255
.
0
)
(
unsigned
int
)
(
alpha
*
255
.
0
)
)
;
}
void
nsLookAndFeel
:
:
NativeInit
(
)
{
EnsureInit
(
)
;
}
void
nsLookAndFeel
:
:
RefreshImpl
(
)
{
nsXPLookAndFeel
:
:
RefreshImpl
(
)
;
mInitialized
=
false
;
}
nscolor
nsLookAndFeel
:
:
ProcessSelectionBackground
(
nscolor
aColor
)
{
uint16_t
hue
sat
value
;
uint8_t
alpha
;
nscolor
resultColor
=
aColor
;
NS_RGB2HSV
(
resultColor
hue
sat
value
alpha
)
;
int
factor
=
2
;
alpha
=
alpha
/
factor
;
if
(
sat
>
0
)
{
sat
=
mozilla
:
:
clamped
(
sat
*
factor
0
255
)
;
}
else
{
value
=
mozilla
:
:
clamped
(
255
-
(
255
-
value
)
*
factor
0
255
)
;
}
NS_HSV2RGB
(
resultColor
hue
sat
value
alpha
)
;
return
resultColor
;
}
nsresult
nsLookAndFeel
:
:
NativeGetColor
(
ColorID
aID
ColorScheme
aScheme
nscolor
&
aColor
)
{
EnsureInit
(
)
;
auto
&
colorSet
=
aScheme
=
=
ColorScheme
:
:
Light
?
mLightColorSet
:
mDarkColorSet
;
auto
color
=
colorSet
.
Get
(
aID
)
;
aColor
=
color
.
valueOr
(
NS_RGB
(
0xff
0xff
0xff
)
)
;
return
color
?
NS_OK
:
NS_ERROR_FAILURE
;
}
Maybe
<
nscolor
>
nsLookAndFeel
:
:
ColorSet
:
:
Get
(
ColorID
aID
)
const
{
nscolor
color
=
0
;
switch
(
aID
)
{
case
ColorID
:
:
WindowBackground
:
color
=
NS_RGB
(
0xff
0xff
0xff
)
;
break
;
case
ColorID
:
:
WindowForeground
:
color
=
NS_RGB
(
0x00
0x00
0x00
)
;
break
;
case
ColorID
:
:
WidgetBackground
:
case
ColorID
:
:
Infobackground
:
color
=
NS_RGB
(
0xdd
0xdd
0xdd
)
;
break
;
case
ColorID
:
:
WidgetForeground
:
color
=
NS_RGB
(
0x00
0x00
0x00
)
;
break
;
case
ColorID
:
:
WidgetSelectBackground
:
color
=
NS_RGB
(
0x80
0x80
0x80
)
;
break
;
case
ColorID
:
:
WidgetSelectForeground
:
color
=
NS_RGB
(
0x00
0x00
0x80
)
;
break
;
case
ColorID
:
:
Widget3DHighlight
:
color
=
NS_RGB
(
0xa0
0xa0
0xa0
)
;
break
;
case
ColorID
:
:
Widget3DShadow
:
color
=
NS_RGB
(
0x40
0x40
0x40
)
;
break
;
case
ColorID
:
:
TextBackground
:
color
=
NS_RGB
(
0xff
0xff
0xff
)
;
break
;
case
ColorID
:
:
TextForeground
:
color
=
NS_RGB
(
0x00
0x00
0x00
)
;
break
;
case
ColorID
:
:
TextSelectBackground
:
color
=
ProcessSelectionBackground
(
mColorTextSelectBackground
)
;
break
;
case
ColorID
:
:
TextSelectBackgroundDisabled
:
color
=
ProcessSelectionBackground
(
mColorTextSelectBackgroundDisabled
)
;
break
;
case
ColorID
:
:
Highlight
:
case
ColorID
:
:
MozAccentColor
:
case
ColorID
:
:
MozMenuhover
:
color
=
mColorHighlight
;
break
;
case
ColorID
:
:
TextSelectForeground
:
color
=
NS_DONT_CHANGE_COLOR
;
break
;
case
ColorID
:
:
Highlighttext
:
case
ColorID
:
:
MozAccentColorForeground
:
case
ColorID
:
:
MozMenuhovertext
:
color
=
mColorAlternateSelectedControlText
;
break
;
case
ColorID
:
:
IMESelectedRawTextBackground
:
case
ColorID
:
:
IMESelectedConvertedTextBackground
:
case
ColorID
:
:
IMERawInputBackground
:
case
ColorID
:
:
IMEConvertedTextBackground
:
color
=
NS_TRANSPARENT
;
break
;
case
ColorID
:
:
IMESelectedRawTextForeground
:
case
ColorID
:
:
IMESelectedConvertedTextForeground
:
case
ColorID
:
:
IMERawInputForeground
:
case
ColorID
:
:
IMEConvertedTextForeground
:
color
=
NS_SAME_AS_FOREGROUND_COLOR
;
break
;
case
ColorID
:
:
IMERawInputUnderline
:
case
ColorID
:
:
IMEConvertedTextUnderline
:
color
=
NS_40PERCENT_FOREGROUND_COLOR
;
break
;
case
ColorID
:
:
IMESelectedRawTextUnderline
:
case
ColorID
:
:
IMESelectedConvertedTextUnderline
:
color
=
NS_SAME_AS_FOREGROUND_COLOR
;
break
;
case
ColorID
:
:
SpellCheckerUnderline
:
color
=
NS_RGB
(
0xff
0
0
)
;
break
;
case
ColorID
:
:
MozMacButtonactivetext
:
case
ColorID
:
:
MozMacDefaultbuttontext
:
color
=
NS_RGB
(
0xFF
0xFF
0xFF
)
;
break
;
case
ColorID
:
:
Buttontext
:
case
ColorID
:
:
MozButtonhovertext
:
color
=
mColorControlText
;
break
;
case
ColorID
:
:
Captiontext
:
case
ColorID
:
:
Menutext
:
case
ColorID
:
:
Infotext
:
case
ColorID
:
:
MozMenubartext
:
color
=
mColorText
;
break
;
case
ColorID
:
:
Windowtext
:
color
=
mColorWindowText
;
break
;
case
ColorID
:
:
Activecaption
:
color
=
mColorGrid
;
break
;
case
ColorID
:
:
Activeborder
:
color
=
mColorActiveBorder
;
break
;
case
ColorID
:
:
Appworkspace
:
color
=
NS_RGB
(
0xFF
0xFF
0xFF
)
;
break
;
case
ColorID
:
:
Background
:
color
=
NS_RGB
(
0x63
0x63
0xCE
)
;
break
;
case
ColorID
:
:
Buttonface
:
case
ColorID
:
:
MozButtonhoverface
:
color
=
NS_RGB
(
0xF0
0xF0
0xF0
)
;
break
;
case
ColorID
:
:
Buttonhighlight
:
color
=
NS_RGB
(
0xFF
0xFF
0xFF
)
;
break
;
case
ColorID
:
:
Buttonshadow
:
color
=
NS_RGB
(
0xDC
0xDC
0xDC
)
;
break
;
case
ColorID
:
:
Graytext
:
color
=
mColorGrayText
;
break
;
case
ColorID
:
:
Inactiveborder
:
case
ColorID
:
:
Inactivecaption
:
color
=
mColorControlBackground
;
break
;
case
ColorID
:
:
Inactivecaptiontext
:
color
=
NS_RGB
(
0x45
0x45
0x45
)
;
break
;
case
ColorID
:
:
Scrollbar
:
color
=
mColorScrollbar
;
break
;
case
ColorID
:
:
Threeddarkshadow
:
color
=
NS_RGB
(
0xDC
0xDC
0xDC
)
;
break
;
case
ColorID
:
:
Threedshadow
:
color
=
NS_RGB
(
0xE0
0xE0
0xE0
)
;
break
;
case
ColorID
:
:
Threedface
:
color
=
NS_RGB
(
0xF0
0xF0
0xF0
)
;
break
;
case
ColorID
:
:
Threedhighlight
:
color
=
mColorThreeDHighlight
;
break
;
case
ColorID
:
:
Threedlightshadow
:
color
=
NS_RGB
(
0xDA
0xDA
0xDA
)
;
break
;
case
ColorID
:
:
Menu
:
color
=
mColorAlternateSelectedControlText
;
break
;
case
ColorID
:
:
Windowframe
:
color
=
mColorGrid
;
break
;
case
ColorID
:
:
Window
:
color
=
NS_RGB
(
0xff
0xff
0xff
)
;
break
;
case
ColorID
:
:
Field
:
case
ColorID
:
:
MozCombobox
:
color
=
mColorControlBackground
;
break
;
case
ColorID
:
:
Fieldtext
:
case
ColorID
:
:
MozComboboxtext
:
color
=
mColorControlText
;
break
;
case
ColorID
:
:
MozDialog
:
color
=
mColorDialog
;
break
;
case
ColorID
:
:
MozDialogtext
:
case
ColorID
:
:
MozCellhighlighttext
:
case
ColorID
:
:
MozHtmlCellhighlighttext
:
case
ColorID
:
:
MozColheadertext
:
case
ColorID
:
:
MozColheaderhovertext
:
color
=
mColorControlText
;
break
;
case
ColorID
:
:
MozDragtargetzone
:
color
=
mColorDragTargetZone
;
break
;
case
ColorID
:
:
MozMacChromeActive
:
color
=
mColorChromeActive
;
break
;
case
ColorID
:
:
MozMacChromeInactive
:
color
=
mColorChromeInactive
;
break
;
case
ColorID
:
:
MozMacFocusring
:
color
=
mColorFocusRing
;
break
;
case
ColorID
:
:
MozMacMenushadow
:
color
=
NS_RGB
(
0xA3
0xA3
0xA3
)
;
break
;
case
ColorID
:
:
MozMacMenutextdisable
:
color
=
NS_RGB
(
0x98
0x98
0x98
)
;
break
;
case
ColorID
:
:
MozMacMenutextselect
:
color
=
mColorTextSelect
;
break
;
case
ColorID
:
:
MozMacDisabledtoolbartext
:
color
=
mColorDisabledToolbarText
;
break
;
case
ColorID
:
:
MozMacMenuselect
:
color
=
mColorMenuSelect
;
break
;
case
ColorID
:
:
MozButtondefault
:
color
=
NS_RGB
(
0xDC
0xDC
0xDC
)
;
break
;
case
ColorID
:
:
MozCellhighlight
:
case
ColorID
:
:
MozHtmlCellhighlight
:
case
ColorID
:
:
MozMacSecondaryhighlight
:
color
=
mColorCellHighlight
;
break
;
case
ColorID
:
:
MozEventreerow
:
color
=
mColorEvenTreeRow
;
break
;
case
ColorID
:
:
MozOddtreerow
:
color
=
mColorOddTreeRow
;
break
;
case
ColorID
:
:
MozNativehyperlinktext
:
color
=
NS_RGB
(
0x14
0x4F
0xAE
)
;
break
;
case
ColorID
:
:
MozMacVibrantTitlebarLight
:
color
=
NS_RGB
(
0xe6
0xe6
0xe6
)
;
break
;
case
ColorID
:
:
MozMacVibrantTitlebarDark
:
color
=
NS_RGB
(
0x28
0x28
0x28
)
;
break
;
case
ColorID
:
:
MozMacTooltip
:
case
ColorID
:
:
MozMacMenupopup
:
case
ColorID
:
:
MozMacMenuitem
:
color
=
mColorMenuFontSmoothingBg
;
break
;
case
ColorID
:
:
MozMacSourceList
:
color
=
mColorSourceListFontSmoothingBg
;
break
;
case
ColorID
:
:
MozMacSourceListSelection
:
color
=
mColorSourceListSelectionFontSmoothingBg
;
break
;
case
ColorID
:
:
MozMacActiveMenuitem
:
case
ColorID
:
:
MozMacActiveSourceListSelection
:
color
=
mColorActiveSourceListSelectionFontSmoothingBg
;
break
;
default
:
NS_WARNING
(
"
Someone
asked
nsILookAndFeel
for
a
color
I
don
'
t
know
about
"
)
;
return
Nothing
(
)
;
}
return
Some
(
color
)
;
}
nsresult
nsLookAndFeel
:
:
NativeGetInt
(
IntID
aID
int32_t
&
aResult
)
{
NS_OBJC_BEGIN_TRY_BLOCK_RETURN
;
nsresult
res
=
NS_OK
;
switch
(
aID
)
{
case
IntID
:
:
ScrollButtonLeftMouseButtonAction
:
aResult
=
0
;
break
;
case
IntID
:
:
ScrollButtonMiddleMouseButtonAction
:
case
IntID
:
:
ScrollButtonRightMouseButtonAction
:
aResult
=
3
;
break
;
case
IntID
:
:
CaretBlinkTime
:
aResult
=
567
;
break
;
case
IntID
:
:
CaretWidth
:
aResult
=
1
;
break
;
case
IntID
:
:
ShowCaretDuringSelection
:
aResult
=
0
;
break
;
case
IntID
:
:
SelectTextfieldsOnKeyFocus
:
aResult
=
1
;
break
;
case
IntID
:
:
SubmenuDelay
:
aResult
=
200
;
break
;
case
IntID
:
:
TooltipDelay
:
aResult
=
500
;
break
;
case
IntID
:
:
MenusCanOverlapOSBar
:
aResult
=
0
;
break
;
case
IntID
:
:
SkipNavigatingDisabledMenuItem
:
aResult
=
1
;
break
;
case
IntID
:
:
DragThresholdX
:
case
IntID
:
:
DragThresholdY
:
aResult
=
4
;
break
;
case
IntID
:
:
ScrollArrowStyle
:
aResult
=
eScrollArrow_None
;
break
;
case
IntID
:
:
ScrollSliderStyle
:
aResult
=
eScrollThumbStyle_Proportional
;
break
;
case
IntID
:
:
UseOverlayScrollbars
:
case
IntID
:
:
AllowOverlayScrollbarsOverlap
:
aResult
=
NSScroller
.
preferredScrollerStyle
=
=
NSScrollerStyleOverlay
;
break
;
case
IntID
:
:
ScrollbarDisplayOnMouseMove
:
aResult
=
0
;
break
;
case
IntID
:
:
ScrollbarFadeBeginDelay
:
aResult
=
450
;
break
;
case
IntID
:
:
ScrollbarFadeDuration
:
aResult
=
200
;
break
;
case
IntID
:
:
TreeOpenDelay
:
aResult
=
1000
;
break
;
case
IntID
:
:
TreeCloseDelay
:
aResult
=
1000
;
break
;
case
IntID
:
:
TreeLazyScrollDelay
:
aResult
=
150
;
break
;
case
IntID
:
:
TreeScrollDelay
:
aResult
=
100
;
break
;
case
IntID
:
:
TreeScrollLinesMax
:
aResult
=
3
;
break
;
case
IntID
:
:
DWMCompositor
:
case
IntID
:
:
WindowsClassic
:
case
IntID
:
:
WindowsDefaultTheme
:
case
IntID
:
:
WindowsThemeIdentifier
:
case
IntID
:
:
OperatingSystemVersionIdentifier
:
aResult
=
0
;
res
=
NS_ERROR_NOT_IMPLEMENTED
;
break
;
case
IntID
:
:
MacGraphiteTheme
:
aResult
=
[
NSColor
currentControlTint
]
=
=
NSGraphiteControlTint
;
break
;
case
IntID
:
:
MacBigSurTheme
:
aResult
=
nsCocoaFeatures
:
:
OnBigSurOrLater
(
)
;
break
;
case
IntID
:
:
AlertNotificationOrigin
:
aResult
=
NS_ALERT_TOP
;
break
;
case
IntID
:
:
TabFocusModel
:
aResult
=
[
NSApp
isFullKeyboardAccessEnabled
]
?
nsIContent
:
:
eTabFocus_any
:
nsIContent
:
:
eTabFocus_textControlsMask
;
break
;
case
IntID
:
:
ScrollToClick
:
{
aResult
=
[
[
NSUserDefaults
standardUserDefaults
]
boolForKey
:
"
AppleScrollerPagingBehavior
"
]
;
}
break
;
case
IntID
:
:
ChosenMenuItemsShouldBlink
:
aResult
=
1
;
break
;
case
IntID
:
:
IMERawInputUnderlineStyle
:
case
IntID
:
:
IMEConvertedTextUnderlineStyle
:
case
IntID
:
:
IMESelectedRawTextUnderlineStyle
:
case
IntID
:
:
IMESelectedConvertedTextUnderline
:
aResult
=
NS_STYLE_TEXT_DECORATION_STYLE_SOLID
;
break
;
case
IntID
:
:
SpellCheckerUnderlineStyle
:
aResult
=
NS_STYLE_TEXT_DECORATION_STYLE_DOTTED
;
break
;
case
IntID
:
:
ScrollbarButtonAutoRepeatBehavior
:
aResult
=
0
;
break
;
case
IntID
:
:
SwipeAnimationEnabled
:
aResult
=
0
;
if
(
[
NSEvent
respondsToSelector
:
selector
(
isSwipeTrackingFromScrollEventsEnabled
)
]
)
{
aResult
=
[
NSEvent
isSwipeTrackingFromScrollEventsEnabled
]
;
}
break
;
case
IntID
:
:
ContextMenuOffsetVertical
:
aResult
=
-
6
;
break
;
case
IntID
:
:
ContextMenuOffsetHorizontal
:
aResult
=
1
;
break
;
case
IntID
:
:
SystemUsesDarkTheme
:
aResult
=
SystemWantsDarkTheme
(
)
;
break
;
case
IntID
:
:
PrefersReducedMotion
:
aResult
=
NSWorkspace
.
sharedWorkspace
.
accessibilityDisplayShouldReduceMotion
;
break
;
case
IntID
:
:
UseAccessibilityTheme
:
aResult
=
NSWorkspace
.
sharedWorkspace
.
accessibilityDisplayShouldIncreaseContrast
;
break
;
break
;
default
:
aResult
=
0
;
res
=
NS_ERROR_FAILURE
;
}
return
res
;
NS_OBJC_END_TRY_BLOCK_RETURN
(
NS_ERROR_FAILURE
)
;
}
nsresult
nsLookAndFeel
:
:
NativeGetFloat
(
FloatID
aID
float
&
aResult
)
{
nsresult
res
=
NS_OK
;
switch
(
aID
)
{
case
FloatID
:
:
IMEUnderlineRelativeSize
:
aResult
=
2
.
0f
;
break
;
case
FloatID
:
:
SpellCheckerUnderlineRelativeSize
:
aResult
=
2
.
0f
;
break
;
default
:
aResult
=
-
1
.
0
;
res
=
NS_ERROR_FAILURE
;
}
return
res
;
}
bool
nsLookAndFeel
:
:
SystemWantsDarkTheme
(
)
{
if
(
available
(
macOS
10
.
14
*
)
)
{
NSAppearanceName
aquaOrDarkAqua
=
[
NSApp
.
effectiveAppearance
bestMatchFromAppearancesWithNames
:
[
NSAppearanceNameAqua
NSAppearanceNameDarkAqua
]
]
;
return
[
aquaOrDarkAqua
isEqualToString
:
NSAppearanceNameDarkAqua
]
;
}
return
false
;
}
bool
nsLookAndFeel
:
:
NativeGetFont
(
FontID
aID
nsString
&
aFontName
gfxFontStyle
&
aFontStyle
)
{
NS_OBJC_BEGIN_TRY_BLOCK_RETURN
;
if
(
aID
=
=
FontID
:
:
MozWindow
|
|
aID
=
=
FontID
:
:
MozDocument
)
{
aFontStyle
.
style
=
mozilla
:
:
FontSlantStyle
:
:
Normal
(
)
;
aFontStyle
.
weight
=
mozilla
:
:
FontWeight
:
:
Normal
(
)
;
aFontStyle
.
stretch
=
mozilla
:
:
FontStretch
:
:
Normal
(
)
;
aFontStyle
.
size
=
14
;
aFontStyle
.
systemFont
=
true
;
aFontName
.
AssignLiteral
(
"
sans
-
serif
"
)
;
return
true
;
}
nsAutoCString
name
;
gfxPlatformMac
:
:
LookupSystemFont
(
aID
name
aFontStyle
)
;
aFontName
.
Append
(
NS_ConvertUTF8toUTF16
(
name
)
)
;
return
true
;
NS_OBJC_END_TRY_BLOCK_RETURN
(
false
)
;
}
void
nsLookAndFeel
:
:
EnsureInit
(
)
{
if
(
mInitialized
)
{
return
;
}
mInitialized
=
true
;
NS_OBJC_BEGIN_TRY_IGNORE_BLOCK
if
(
available
(
macOS
10
.
14
*
)
)
{
NSAppearance
.
currentAppearance
=
[
NSAppearance
appearanceNamed
:
NSAppearanceNameAqua
]
;
}
mLightColorSet
.
Refresh
(
ColorScheme
:
:
Light
)
;
if
(
available
(
macOS
10
.
14
*
)
)
{
NSAppearance
.
currentAppearance
=
[
NSAppearance
appearanceNamed
:
NSAppearanceNameDarkAqua
]
;
mDarkColorSet
.
Refresh
(
ColorScheme
:
:
Dark
)
;
}
else
{
mDarkColorSet
=
mLightColorSet
;
}
RecordTelemetry
(
)
;
NS_OBJC_END_TRY_IGNORE_BLOCK
}
void
nsLookAndFeel
:
:
ColorSet
:
:
Refresh
(
ColorScheme
aScheme
)
{
mColorTextSelectBackground
=
GetColorFromNSColor
(
[
NSColor
selectedTextBackgroundColor
]
)
;
mColorTextSelectBackgroundDisabled
=
GetColorFromNSColor
(
[
NSColor
secondarySelectedControlColor
]
)
;
mColorHighlight
=
GetColorFromNSColor
(
[
NSColor
alternateSelectedControlColor
]
)
;
mColorAlternateSelectedControlText
=
GetColorFromNSColor
(
[
NSColor
alternateSelectedControlTextColor
]
)
;
mColorControlText
=
GetColorFromNSColor
(
[
NSColor
controlTextColor
]
)
;
mColorText
=
GetColorFromNSColor
(
[
NSColor
textColor
]
)
;
mColorWindowText
=
GetColorFromNSColor
(
[
NSColor
windowFrameTextColor
]
)
;
mColorGrid
=
GetColorFromNSColor
(
[
NSColor
gridColor
]
)
;
mColorActiveBorder
=
GetColorFromNSColor
(
[
NSColor
keyboardFocusIndicatorColor
]
)
;
NSColor
*
disabledColor
=
[
NSColor
disabledControlTextColor
]
;
mColorGrayText
=
GetColorFromNSColorWithAlpha
(
disabledColor
[
disabledColor
alphaComponent
]
)
;
mColorControlBackground
=
GetColorFromNSColor
(
[
NSColor
controlBackgroundColor
]
)
;
mColorScrollbar
=
GetColorFromNSColor
(
[
NSColor
scrollBarColor
]
)
;
mColorThreeDHighlight
=
GetColorFromNSColor
(
[
NSColor
highlightColor
]
)
;
mColorDialog
=
GetColorFromNSColor
(
[
NSColor
controlHighlightColor
]
)
;
mColorDragTargetZone
=
GetColorFromNSColor
(
[
NSColor
selectedControlColor
]
)
;
int
grey
=
NativeGreyColorAsInt
(
toolbarFillGrey
true
)
;
mColorChromeActive
=
NS_RGB
(
grey
grey
grey
)
;
grey
=
NativeGreyColorAsInt
(
toolbarFillGrey
false
)
;
mColorChromeInactive
=
NS_RGB
(
grey
grey
grey
)
;
mColorFocusRing
=
GetColorFromNSColorWithAlpha
(
[
NSColor
keyboardFocusIndicatorColor
]
0
.
48
)
;
mColorTextSelect
=
GetColorFromNSColor
(
[
NSColor
selectedMenuItemTextColor
]
)
;
mColorDisabledToolbarText
=
GetColorFromNSColor
(
[
NSColor
disabledControlTextColor
]
)
;
mColorMenuSelect
=
GetColorFromNSColor
(
[
NSColor
alternateSelectedControlColor
]
)
;
mColorCellHighlight
=
GetColorFromNSColor
(
[
NSColor
secondarySelectedControlColor
]
)
;
mColorEvenTreeRow
=
GetColorFromNSColor
(
[
[
NSColor
controlAlternatingRowBackgroundColors
]
objectAtIndex
:
0
]
)
;
mColorOddTreeRow
=
GetColorFromNSColor
(
[
[
NSColor
controlAlternatingRowBackgroundColors
]
objectAtIndex
:
1
]
)
;
bool
isLight
=
aScheme
=
=
ColorScheme
:
:
Light
;
mColorMenuFontSmoothingBg
=
isLight
?
NS_RGB
(
0xf6
0xf6
0xf6
)
:
NS_RGB
(
0x28
0x28
0x28
)
;
mColorSourceListFontSmoothingBg
=
isLight
?
NS_RGB
(
0xf6
0xf6
0xf6
)
:
NS_RGB
(
0x2d
0x2d
0x2d
)
;
mColorSourceListSelectionFontSmoothingBg
=
isLight
?
NS_RGB
(
0xd3
0xd3
0xd3
)
:
NS_RGB
(
0x2d
0x2d
0x2d
)
;
mColorActiveSourceListSelectionFontSmoothingBg
=
GetColorFromNSColor
(
ControlAccentColor
(
)
)
;
}
