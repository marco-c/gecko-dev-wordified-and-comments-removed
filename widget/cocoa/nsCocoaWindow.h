#
ifndef
nsCocoaWindow_h_
#
define
nsCocoaWindow_h_
#
undef
DARWIN
#
import
<
Cocoa
/
Cocoa
.
h
>
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
nsBaseWidget
.
h
"
#
include
"
nsCocoaUtils
.
h
"
#
include
"
nsTouchBar
.
h
"
#
include
"
ViewRegion
.
h
"
#
include
"
mozView
.
h
"
#
include
<
dlfcn
.
h
>
#
include
<
queue
>
class
nsCocoaWindow
;
class
nsChildView
;
class
nsMenuBarX
;
class
ChildView
;
namespace
mozilla
{
enum
class
NativeKeyBindingsType
:
uint8_t
;
class
VibrancyManager
;
namespace
widget
{
class
PlatformCompositorWidgetDelegate
;
class
TextInputHandler
;
}
}
interface
BaseWindow
:
NSWindow
{
NSMutableDictionary
*
mState
;
BOOL
mDrawsIntoWindowFrame
;
BOOL
mDisabledNeedsDisplay
;
NSTrackingArea
*
mTrackingArea
;
NSView
*
mViewWithTrackingArea
;
NSRect
mDirtyRect
;
BOOL
mBeingShown
;
BOOL
mDrawTitle
;
BOOL
mIsAnimationSuppressed
;
nsTouchBar
*
mTouchBar
;
}
-
(
void
)
importState
:
(
NSDictionary
*
)
aState
;
-
(
NSMutableDictionary
*
)
exportState
;
-
(
void
)
setDrawsContentsIntoWindowFrame
:
(
BOOL
)
aState
;
-
(
BOOL
)
drawsContentsIntoWindowFrame
;
-
(
NSRect
)
childViewFrameRectForCurrentBounds
;
-
(
void
)
updateChildViewFrameRect
;
-
(
NSRect
)
childViewRectForFrameRect
:
(
NSRect
)
aFrameRect
;
-
(
NSRect
)
frameRectForChildViewRect
:
(
NSRect
)
aChildViewRect
;
-
(
void
)
mouseEntered
:
(
NSEvent
*
)
aEvent
;
-
(
void
)
mouseExited
:
(
NSEvent
*
)
aEvent
;
-
(
void
)
mouseMoved
:
(
NSEvent
*
)
aEvent
;
-
(
NSView
*
)
trackingAreaView
;
-
(
void
)
createTrackingArea
;
-
(
void
)
removeTrackingArea
;
-
(
void
)
setBeingShown
:
(
BOOL
)
aValue
;
-
(
BOOL
)
isBeingShown
;
-
(
BOOL
)
isVisibleOrBeingShown
;
-
(
void
)
setIsAnimationSuppressed
:
(
BOOL
)
aValue
;
-
(
BOOL
)
isAnimationSuppressed
;
-
(
NSArray
<
NSView
*
>
*
)
contentViewContents
;
-
(
ChildView
*
)
mainChildView
;
-
(
void
)
setWantsTitleDrawn
:
(
BOOL
)
aDrawTitle
;
-
(
BOOL
)
wantsTitleDrawn
;
-
(
void
)
disableSetNeedsDisplay
;
-
(
void
)
enableSetNeedsDisplay
;
-
(
NSRect
)
getAndResetNativeDirtyRect
;
-
(
void
)
setEffectViewWrapperForStyle
:
(
mozilla
:
:
WindowShadow
)
aStyle
;
property
(
nonatomic
)
mozilla
:
:
WindowShadow
shadowStyle
;
-
(
void
)
releaseJSObjects
;
end
interface
NSWindow
(
Undocumented
)
-
(
NSDictionary
*
)
shadowParameters
;
-
(
NSRect
)
contentRectForFrameRect
:
(
NSRect
)
windowFrame
styleMask
:
(
NSUInteger
)
windowStyle
;
-
(
NSRect
)
frameRectForContentRect
:
(
NSRect
)
windowContentRect
styleMask
:
(
NSUInteger
)
windowStyle
;
+
(
Class
)
frameViewClassForStyleMask
:
(
NSUInteger
)
styleMask
;
end
interface
PopupWindow
:
BaseWindow
{
private
BOOL
mIsContextMenu
;
}
-
(
id
)
initWithContentRect
:
(
NSRect
)
contentRect
styleMask
:
(
NSUInteger
)
styleMask
backing
:
(
NSBackingStoreType
)
bufferingType
defer
:
(
BOOL
)
deferCreation
;
-
(
BOOL
)
isContextMenu
;
-
(
void
)
setIsContextMenu
:
(
BOOL
)
flag
;
-
(
BOOL
)
canBecomeMainWindow
;
end
interface
BorderlessWindow
:
BaseWindow
{
}
-
(
BOOL
)
canBecomeKeyWindow
;
-
(
BOOL
)
canBecomeMainWindow
;
end
interface
WindowDelegate
:
NSObject
<
NSWindowDelegate
>
{
nsCocoaWindow
*
mGeckoWindow
;
bool
mToplevelActiveState
;
BOOL
mHasEverBeenZoomed
;
}
+
(
void
)
paintMenubarForWindow
:
(
NSWindow
*
)
aWindow
;
-
(
id
)
initWithGeckoWindow
:
(
nsCocoaWindow
*
)
geckoWind
;
-
(
void
)
windowDidResize
:
(
NSNotification
*
)
aNotification
;
-
(
nsCocoaWindow
*
)
geckoWidget
;
-
(
bool
)
toplevelActiveState
;
-
(
void
)
sendToplevelActivateEvents
;
-
(
void
)
sendToplevelDeactivateEvents
;
end
interface
FullscreenTitlebarTracker
:
NSTitlebarAccessoryViewController
-
(
FullscreenTitlebarTracker
*
)
init
;
end
interface
ToolbarWindow
:
BaseWindow
{
FullscreenTitlebarTracker
*
mFullscreenTitlebarTracker
;
CGFloat
mMenuBarHeight
;
NSRect
mWindowButtonsRect
;
}
-
(
void
)
setDrawsContentsIntoWindowFrame
:
(
BOOL
)
aState
;
-
(
void
)
placeWindowButtons
:
(
NSRect
)
aRect
;
-
(
NSRect
)
windowButtonsRect
;
-
(
void
)
windowMainStateChanged
;
end
class
nsCocoaWindow
final
:
public
nsBaseWidget
{
private
:
friend
class
nsChildView
;
typedef
nsBaseWidget
Inherited
;
public
:
nsCocoaWindow
(
)
;
[
[
nodiscard
]
]
nsresult
Create
(
nsIWidget
*
aParent
const
DesktopIntRect
&
aRect
InitData
*
=
nullptr
)
override
;
[
[
nodiscard
]
]
nsresult
Create
(
nsIWidget
*
aParent
const
LayoutDeviceIntRect
&
aRect
InitData
*
=
nullptr
)
override
;
void
Destroy
(
)
override
;
void
Show
(
bool
aState
)
override
;
bool
NeedsRecreateToReshow
(
)
override
;
void
Enable
(
bool
aState
)
override
;
bool
IsEnabled
(
)
const
override
;
void
SetModal
(
bool
aState
)
override
;
bool
IsRunningAppModal
(
)
override
;
bool
IsVisible
(
)
const
override
;
void
SetFocus
(
Raise
mozilla
:
:
dom
:
:
CallerType
aCallerType
)
override
;
LayoutDeviceIntPoint
WidgetToScreenOffset
(
)
override
;
LayoutDeviceIntPoint
GetClientOffset
(
)
override
;
LayoutDeviceIntMargin
NormalSizeModeClientToWindowMargin
(
)
override
;
bool
ShowsResizeIndicator
(
LayoutDeviceIntRect
*
aResizerRect
)
override
{
return
false
;
}
void
*
GetNativeData
(
uint32_t
aDataType
)
override
;
void
ConstrainPosition
(
DesktopIntPoint
&
)
override
;
void
SetSizeConstraints
(
const
SizeConstraints
&
aConstraints
)
override
;
void
Move
(
double
aX
double
aY
)
override
;
nsSizeMode
SizeMode
(
)
override
{
return
mSizeMode
;
}
void
SetSizeMode
(
nsSizeMode
aMode
)
override
;
void
GetWorkspaceID
(
nsAString
&
workspaceID
)
override
;
void
MoveToWorkspace
(
const
nsAString
&
workspaceID
)
override
;
void
SuppressAnimation
(
bool
aSuppress
)
override
;
void
HideWindowChrome
(
bool
aShouldHide
)
override
;
NSView
<
mozView
>
*
GetEditorView
(
)
;
nsresult
SynthesizeNativeKeyEvent
(
int32_t
aNativeKeyboardLayout
int32_t
aNativeKeyCode
uint32_t
aModifierFlags
const
nsAString
&
aCharacters
const
nsAString
&
aUnmodifiedCharacters
nsISynthesizedEventCallback
*
aCallback
)
override
;
nsresult
SynthesizeNativeMouseEvent
(
LayoutDeviceIntPoint
aPoint
NativeMouseMessage
aNativeMessage
mozilla
:
:
MouseButton
aButton
nsIWidget
:
:
Modifiers
aModifierFlags
nsISynthesizedEventCallback
*
aCallback
)
override
;
nsresult
SynthesizeNativeMouseMove
(
LayoutDeviceIntPoint
aPoint
nsISynthesizedEventCallback
*
aCallback
)
override
{
return
SynthesizeNativeMouseEvent
(
aPoint
NativeMouseMessage
:
:
Move
mozilla
:
:
MouseButton
:
:
eNotPressed
nsIWidget
:
:
Modifiers
:
:
NO_MODIFIERS
aCallback
)
;
}
nsresult
SynthesizeNativeMouseScrollEvent
(
LayoutDeviceIntPoint
aPoint
uint32_t
aNativeMessage
double
aDeltaX
double
aDeltaY
double
aDeltaZ
uint32_t
aModifierFlags
uint32_t
aAdditionalFlags
nsISynthesizedEventCallback
*
aCallback
)
override
;
nsresult
SynthesizeNativeTouchPoint
(
uint32_t
aPointerId
TouchPointerState
aPointerState
LayoutDeviceIntPoint
aPoint
double
aPointerPressure
uint32_t
aPointerOrientation
nsISynthesizedEventCallback
*
aCallback
)
override
;
nsresult
SynthesizeNativeTouchpadDoubleTap
(
LayoutDeviceIntPoint
aPoint
uint32_t
aModifierFlags
)
override
;
static
bool
DoHasPendingInputEvent
(
)
;
static
uint32_t
GetCurrentInputEventCount
(
)
;
static
void
UpdateCurrentInputEventCount
(
)
;
int32_t
CocoaPointsToDevPixels
(
CGFloat
aPts
)
const
{
return
nsCocoaUtils
:
:
CocoaPointsToDevPixels
(
aPts
BackingScaleFactor
(
)
)
;
}
LayoutDeviceIntPoint
CocoaPointsToDevPixels
(
const
NSPoint
&
aPt
)
const
{
return
nsCocoaUtils
:
:
CocoaPointsToDevPixels
(
aPt
BackingScaleFactor
(
)
)
;
}
LayoutDeviceIntPoint
CocoaPointsToDevPixelsRoundDown
(
const
NSPoint
&
aPt
)
const
{
return
nsCocoaUtils
:
:
CocoaPointsToDevPixelsRoundDown
(
aPt
BackingScaleFactor
(
)
)
;
}
LayoutDeviceIntRect
CocoaPointsToDevPixels
(
const
NSRect
&
aRect
)
const
{
return
nsCocoaUtils
:
:
CocoaPointsToDevPixels
(
aRect
BackingScaleFactor
(
)
)
;
}
CGFloat
DevPixelsToCocoaPoints
(
int32_t
aPixels
)
const
{
return
nsCocoaUtils
:
:
DevPixelsToCocoaPoints
(
aPixels
BackingScaleFactor
(
)
)
;
}
NSRect
DevPixelsToCocoaPoints
(
const
LayoutDeviceIntRect
&
aRect
)
const
{
return
nsCocoaUtils
:
:
DevPixelsToCocoaPoints
(
aRect
BackingScaleFactor
(
)
)
;
}
void
UpdateFullscreen
(
bool
aFullscreen
)
;
void
DispatchAPZWheelInputEvent
(
mozilla
:
:
InputData
&
aEvent
)
;
nsEventStatus
DispatchAPZInputEvent
(
mozilla
:
:
InputData
&
aEvent
)
;
void
DispatchDoubleTapGesture
(
mozilla
:
:
TimeStamp
aEventTimeStamp
LayoutDeviceIntPoint
aScreenPosition
mozilla
:
:
Modifiers
aModifiers
)
;
void
SuspendAsyncCATransactions
(
)
;
void
MaybeScheduleUnsuspendAsyncCATransactions
(
)
;
void
UnsuspendAsyncCATransactions
(
)
;
#
ifdef
DEBUG
nsresult
SetHiDPIMode
(
bool
aHiDPI
)
override
;
nsresult
RestoreHiDPIMode
(
)
override
;
#
endif
void
UpdateVibrancy
(
const
nsTArray
<
ThemeGeometry
>
&
aThemeGeometries
)
;
mozilla
:
:
VibrancyManager
&
EnsureVibrancyManager
(
)
;
void
TearDownView
(
)
;
bool
PrepareForFullscreenTransition
(
nsISupports
*
*
aData
)
override
;
void
PerformFullscreenTransition
(
FullscreenTransitionStage
aStage
uint16_t
aDuration
nsISupports
*
aData
nsIRunnable
*
aCallback
)
override
;
void
CleanupFullscreenTransition
(
)
override
;
nsresult
MakeFullScreen
(
bool
aFullScreen
)
final
;
nsresult
MakeFullScreenWithNativeTransition
(
bool
aFullScreen
)
final
;
NSAnimation
*
FullscreenTransitionAnimation
(
)
const
{
return
mFullscreenTransitionAnimation
;
}
void
ReleaseFullscreenTransitionAnimation
(
)
{
MOZ_ASSERT
(
mFullscreenTransitionAnimation
"
Should
only
be
called
when
there
is
animation
"
)
;
[
mFullscreenTransitionAnimation
release
]
;
mFullscreenTransitionAnimation
=
nil
;
}
void
Resize
(
double
aWidth
double
aHeight
bool
aRepaint
)
override
;
void
Resize
(
double
aX
double
aY
double
aWidth
double
aHeight
bool
aRepaint
)
override
;
NSRect
GetClientCocoaRect
(
)
;
LayoutDeviceIntRect
GetClientBounds
(
)
override
;
LayoutDeviceIntRect
GetScreenBounds
(
)
override
;
void
ReportMoveEvent
(
)
;
void
ReportSizeEvent
(
)
;
bool
WidgetTypeSupportsAcceleration
(
)
override
{
return
true
;
}
bool
ShouldUseOffMainThreadCompositing
(
)
override
;
void
SetCursor
(
const
Cursor
&
)
override
;
void
UpdateBoundsFromView
(
)
;
void
EnsureContentLayerForMainThreadPainting
(
)
;
CGFloat
BackingScaleFactor
(
)
const
;
void
BackingScaleFactorChanged
(
)
;
double
GetDefaultScaleInternal
(
)
override
;
int32_t
RoundsWidgetCoordinatesTo
(
)
override
;
void
WillPaintWindow
(
)
;
bool
PaintWindow
(
LayoutDeviceIntRegion
aRegion
)
;
bool
PaintWindowInDrawTarget
(
mozilla
:
:
gfx
:
:
DrawTarget
*
aDT
const
LayoutDeviceIntRegion
&
aRegion
const
mozilla
:
:
gfx
:
:
IntSize
&
aSurfaceSize
)
;
void
PaintWindowInContentLayer
(
)
;
void
HandleMainThreadCATransaction
(
)
;
#
ifdef
ACCESSIBILITY
already_AddRefed
<
mozilla
:
:
a11y
:
:
LocalAccessible
>
GetDocumentAccessible
(
)
;
#
endif
bool
WidgetPaintsBackground
(
)
override
{
return
true
;
}
void
SetCompositorWidgetDelegate
(
mozilla
:
:
widget
:
:
CompositorWidgetDelegate
*
)
override
;
void
GetCompositorWidgetInitData
(
mozilla
:
:
widget
:
:
CompositorWidgetInitData
*
aInitData
)
override
;
mozilla
:
:
layers
:
:
CompositorBridgeChild
*
GetCompositorBridgeChild
(
)
const
;
bool
PreRender
(
mozilla
:
:
widget
:
:
WidgetRenderingContext
*
aContext
)
override
;
void
PostRender
(
mozilla
:
:
widget
:
:
WidgetRenderingContext
*
aContext
)
override
;
RefPtr
<
mozilla
:
:
layers
:
:
NativeLayerRoot
>
GetNativeLayerRoot
(
)
override
;
void
UpdateWindowDraggingRegion
(
const
LayoutDeviceIntRegion
&
aRegion
)
override
;
LayoutDeviceIntRegion
GetNonDraggableRegion
(
)
{
return
mNonDraggableRegion
.
Region
(
)
;
}
void
LookUpDictionary
(
const
nsAString
&
aText
const
nsTArray
<
mozilla
:
:
FontRange
>
&
aFontRangeArray
const
bool
aIsVertical
const
LayoutDeviceIntPoint
&
aPoint
)
override
;
mozilla
:
:
DesktopToLayoutDeviceScale
GetDesktopToDeviceScale
(
)
final
{
return
mozilla
:
:
DesktopToLayoutDeviceScale
(
BackingScaleFactor
(
)
)
;
}
nsresult
SetTitle
(
const
nsAString
&
aTitle
)
override
;
void
Invalidate
(
const
LayoutDeviceIntRect
&
aRect
)
override
;
nsresult
DispatchEvent
(
mozilla
:
:
WidgetGUIEvent
*
aEvent
nsEventStatus
&
aStatus
)
override
;
void
CaptureRollupEvents
(
bool
aDoCapture
)
override
;
[
[
nodiscard
]
]
nsresult
GetAttention
(
int32_t
aCycleCount
)
override
;
bool
HasPendingInputEvent
(
)
override
;
bool
SendEventToNativeMenuSystem
(
NSEvent
*
aEvent
)
;
void
PostHandleKeyEvent
(
mozilla
:
:
WidgetKeyboardEvent
*
aEvent
)
override
;
nsresult
ActivateNativeMenuItemAt
(
const
nsAString
&
indexString
)
override
;
nsresult
ForceUpdateNativeMenuAt
(
const
nsAString
&
indexString
)
override
;
[
[
nodiscard
]
]
nsresult
GetSelectionAsPlaintext
(
nsAString
&
aResult
)
override
;
TextEventDispatcherListener
*
GetNativeTextEventDispatcherListener
(
)
override
;
[
[
nodiscard
]
]
nsresult
AttachNativeKeyEvent
(
mozilla
:
:
WidgetKeyboardEvent
&
aEvent
)
override
;
TransparencyMode
GetTransparencyMode
(
)
override
;
void
SetTransparencyMode
(
TransparencyMode
aMode
)
override
;
void
SetWindowShadowStyle
(
mozilla
:
:
WindowShadow
aStyle
)
override
;
void
SetWindowOpacity
(
float
aOpacity
)
override
;
void
SetWindowTransform
(
const
mozilla
:
:
gfx
:
:
Matrix
&
aTransform
)
override
;
void
SetInputRegion
(
const
InputRegion
&
)
override
;
void
SetColorScheme
(
const
mozilla
:
:
Maybe
<
mozilla
:
:
ColorScheme
>
&
)
override
;
void
SetShowsToolbarButton
(
bool
aShow
)
override
;
bool
GetSupportsNativeFullscreen
(
)
;
void
SetSupportsNativeFullscreen
(
bool
aShow
)
override
;
void
SetWindowAnimationType
(
WindowAnimationType
aType
)
override
;
void
SetDrawsTitle
(
bool
aDrawTitle
)
override
;
void
SetCustomTitlebar
(
bool
)
override
;
void
UpdateThemeGeometries
(
const
nsTArray
<
ThemeGeometry
>
&
aThemeGeometries
)
override
;
void
LockAspectRatio
(
bool
aShouldLock
)
override
;
void
DispatchSizeModeEvent
(
)
;
void
DispatchOcclusionEvent
(
)
;
bool
DragEvent
(
unsigned
int
aMessage
mozilla
:
:
gfx
:
:
Point
aMouseGlobal
UInt16
aKeyModifiers
)
;
bool
HasModalDescendants
(
)
const
{
return
mNumModalDescendants
>
0
;
}
bool
IsModal
(
)
const
{
return
mModal
;
}
NSWindow
*
GetCocoaWindow
(
)
{
return
mWindow
;
}
void
SetMenuBar
(
RefPtr
<
nsMenuBarX
>
&
&
aMenuBar
)
;
nsMenuBarX
*
GetMenuBar
(
)
;
void
SetInputContext
(
const
InputContext
&
aContext
const
InputContextAction
&
aAction
)
override
;
InputContext
GetInputContext
(
)
override
;
MOZ_CAN_RUN_SCRIPT
bool
GetEditCommands
(
mozilla
:
:
NativeKeyBindingsType
aType
const
mozilla
:
:
WidgetKeyboardEvent
&
aEvent
nsTArray
<
mozilla
:
:
CommandInt
>
&
aCommands
)
override
;
void
SetPopupWindowLevel
(
)
;
bool
InFullScreenMode
(
)
const
{
return
mInFullScreenMode
;
}
void
CocoaWindowWillEnterFullscreen
(
bool
aFullscreen
)
;
void
CocoaWindowDidEnterFullscreen
(
bool
aFullscreen
)
;
void
CocoaWindowDidResize
(
)
;
void
CocoaSendToplevelActivateEvents
(
)
;
void
CocoaSendToplevelDeactivateEvents
(
)
;
nsIWidgetListener
*
GetPaintListener
(
)
const
{
return
mAttachedWidgetListener
?
mAttachedWidgetListener
:
mWidgetListener
;
}
enum
class
TransitionType
{
Windowed
Fullscreen
EmulatedFullscreen
Miniaturize
Deminiaturize
Zoom
}
;
void
FinishCurrentTransitionIfMatching
(
const
TransitionType
&
aTransition
)
;
bool
HandleUpdateFullscreenOnResize
(
)
;
protected
:
virtual
~
nsCocoaWindow
(
)
;
nsresult
CreateNativeWindow
(
const
NSRect
&
aRect
BorderStyle
aBorderStyle
bool
aRectIsFrameRect
bool
aIsPrivateBrowsing
)
;
void
DestroyNativeWindow
(
)
;
void
UpdateBounds
(
)
;
int32_t
GetWorkspaceID
(
)
;
void
MoveVisibleWindowToWorkspace
(
int32_t
workspaceID
)
;
void
DoResize
(
double
aX
double
aY
double
aWidth
double
aHeight
bool
aRepaint
bool
aConstrainToCurrentScreen
)
;
void
UpdateFullscreenState
(
bool
aFullScreen
bool
aNativeMode
)
;
nsresult
DoMakeFullScreen
(
bool
aFullScreen
bool
aUseSystemTransition
)
;
already_AddRefed
<
nsIWidget
>
AllocateChildPopupWidget
(
)
override
{
return
nsIWidget
:
:
CreateTopLevelWindow
(
)
;
}
BaseWindow
*
mWindow
;
BaseWindow
*
mClosedRetainedWindow
;
WindowDelegate
*
mDelegate
=
nullptr
;
RefPtr
<
nsMenuBarX
>
mMenuBar
;
ChildView
*
mChildView
=
nullptr
;
#
ifdef
ACCESSIBILITY
nsWeakPtr
mAccessible
;
#
endif
mozilla
:
:
Mutex
mCompositingLock
MOZ_UNANNOTATED
{
"
ChildViewCompositing
"
}
;
mozilla
:
:
ViewRegion
mNonDraggableRegion
;
mutable
CGFloat
mBackingScaleFactor
;
RefPtr
<
mozilla
:
:
layers
:
:
NativeLayerRootCA
>
mNativeLayerRoot
;
RefPtr
<
mozilla
:
:
layers
:
:
NativeLayerCA
>
mContentLayer
;
RefPtr
<
mozilla
:
:
layers
:
:
SurfacePoolHandle
>
mPoolHandle
;
LayoutDeviceIntRegion
mContentLayerInvalidRegion
;
mozilla
:
:
UniquePtr
<
mozilla
:
:
VibrancyManager
>
mVibrancyManager
;
RefPtr
<
mozilla
:
:
CancelableRunnable
>
mUnsuspendAsyncCATransactionsRunnable
;
NSAnimation
*
mFullscreenTransitionAnimation
;
mozilla
:
:
WindowShadow
mShadowStyle
;
CGFloat
mAspectRatio
;
WindowAnimationType
mAnimationType
;
bool
mWindowMadeHere
;
nsSizeMode
mSizeMode
;
bool
mInFullScreenMode
;
bool
mInNativeFullScreenMode
;
mozilla
:
:
Maybe
<
TransitionType
>
mTransitionCurrent
;
std
:
:
queue
<
TransitionType
>
mTransitionsPending
;
static
uint32_t
sLastInputEventCount
;
mozilla
:
:
UniquePtr
<
mozilla
:
:
MultiTouchInput
>
mSynthesizedTouchInput
;
RefPtr
<
mozilla
:
:
CancelableRunnable
>
mProcessTransitionsPending
;
bool
mIsTransitionCurrentAdded
=
false
;
mozilla
:
:
Maybe
<
TransitionType
>
mUpdateFullscreenOnResize
;
bool
IsInTransition
(
)
{
return
mTransitionCurrent
.
isSome
(
)
;
}
void
QueueTransition
(
const
TransitionType
&
aTransition
)
;
void
ProcessTransitions
(
)
;
void
CancelAllTransitions
(
)
;
bool
mInProcessTransitions
=
false
;
bool
mSuppressSizeModeEvents
=
false
;
int
mIgnoreOcclusionCount
;
bool
mHasStartedNativeFullscreen
;
bool
mModal
=
false
;
bool
mIsAnimationSuppressed
=
false
;
bool
mInReportMoveEvent
=
false
;
bool
mInResize
=
false
;
bool
mWindowTransformIsIdentity
=
true
;
bool
mAlwaysOnTop
=
false
;
bool
mAspectRatioLocked
=
false
;
bool
mIsAlert
=
false
;
bool
mWasShown
=
false
;
int32_t
mNumModalDescendants
=
0
;
int32_t
mDeferredWorkspaceID
=
0
;
RefPtr
<
mozilla
:
:
widget
:
:
TextInputHandler
>
mTextInputHandler
;
InputContext
mInputContext
;
NSWindowAnimationBehavior
mWindowAnimationBehavior
;
mozilla
:
:
widget
:
:
PlatformCompositorWidgetDelegate
*
mCompositorWidgetDelegate
=
nullptr
;
private
:
static
nsCocoaWindow
*
sWindowInNativeTransition
;
bool
CanStartNativeTransition
(
)
;
void
EndOurNativeTransition
(
)
;
}
;
#
endif
