#
ifndef
nsIconLoaderService_h_
#
define
nsIconLoaderService_h_
#
include
"
imgINotificationObserver
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIconLoaderObserver
.
h
"
#
include
"
nsIContentPolicy
.
h
"
class
nsIURI
;
class
nsINode
;
class
nsIPrincipal
;
class
imgRequestProxy
;
class
nsIconLoaderService
:
public
imgINotificationObserver
{
public
:
nsIconLoaderService
(
nsINode
*
aContent
nsIntRect
*
aImageRegionRect
RefPtr
<
nsIconLoaderObserver
>
aObserver
uint32_t
aIconHeight
uint32_t
aIconWidth
)
;
public
:
NS_DECL_ISUPPORTS
NS_DECL_IMGINOTIFICATIONOBSERVER
nsresult
LoadIcon
(
nsIURI
*
aIconURI
)
;
NSImage
*
GetNativeIconImage
(
)
;
void
Destroy
(
)
;
protected
:
virtual
~
nsIconLoaderService
(
)
;
private
:
nsresult
OnFrameComplete
(
imgIRequest
*
aRequest
)
;
nsCOMPtr
<
nsINode
>
mContent
;
nsContentPolicyType
mContentType
;
RefPtr
<
imgRequestProxy
>
mIconRequest
;
nsIntRect
*
mImageRegionRect
;
bool
mLoadedIcon
;
NSImage
*
mNativeIconImage
;
uint32_t
mIconHeight
;
uint32_t
mIconWidth
;
RefPtr
<
nsIconLoaderObserver
>
mCompletionHandler
;
}
;
#
endif
