#
ifndef
IEHTMLTXTRANGE_H
#
define
IEHTMLTXTRANGE_H
#
include
"
nsIDOMRange
.
h
"
class
CRange
:
public
CComObjectRootEx
<
CComMultiThreadModel
>
{
public
:
CRange
(
)
;
protected
:
virtual
~
CRange
(
)
;
public
:
void
SetRange
(
nsIDOMRange
*
pRange
)
;
virtual
HRESULT
GetParentElement
(
IHTMLElement
*
*
ppParent
)
;
protected
:
nsCOMPtr
<
nsIDOMRange
>
mRange
;
}
;
class
CIEHtmlTxtRange
:
public
CRange
public
IDispatchImpl
<
IHTMLTxtRange
&
IID_IHTMLTxtRange
&
LIBID_MSHTML
>
{
public
:
CIEHtmlTxtRange
(
)
;
protected
:
virtual
~
CIEHtmlTxtRange
(
)
;
public
:
BEGIN_COM_MAP
(
CIEHtmlTxtRange
)
COM_INTERFACE_ENTRY
(
IDispatch
)
COM_INTERFACE_ENTRY
(
IHTMLTxtRange
)
END_COM_MAP
(
)
virtual
HRESULT
STDMETHODCALLTYPE
pasteHTML
(
BSTR
html
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_text
(
BSTR
__RPC_FAR
*
p
)
;
virtual
HRESULT
STDMETHODCALLTYPE
parentElement
(
IHTMLElement
__RPC_FAR
*
__RPC_FAR
*
Parent
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_htmlText
(
BSTR
__RPC_FAR
*
p
)
;
virtual
HRESULT
STDMETHODCALLTYPE
put_text
(
BSTR
v
)
;
virtual
HRESULT
STDMETHODCALLTYPE
duplicate
(
IHTMLTxtRange
__RPC_FAR
*
__RPC_FAR
*
Duplicate
)
;
virtual
HRESULT
STDMETHODCALLTYPE
inRange
(
IHTMLTxtRange
__RPC_FAR
*
Range
VARIANT_BOOL
__RPC_FAR
*
InRange
)
;
virtual
HRESULT
STDMETHODCALLTYPE
isEqual
(
IHTMLTxtRange
__RPC_FAR
*
Range
VARIANT_BOOL
__RPC_FAR
*
IsEqual
)
;
virtual
HRESULT
STDMETHODCALLTYPE
scrollIntoView
(
VARIANT_BOOL
fStart
=
-
1
)
;
virtual
HRESULT
STDMETHODCALLTYPE
collapse
(
VARIANT_BOOL
Start
=
-
1
)
;
virtual
HRESULT
STDMETHODCALLTYPE
expand
(
BSTR
Unit
VARIANT_BOOL
__RPC_FAR
*
Success
)
;
virtual
HRESULT
STDMETHODCALLTYPE
move
(
BSTR
Unit
long
Count
long
__RPC_FAR
*
ActualCount
)
;
virtual
HRESULT
STDMETHODCALLTYPE
moveStart
(
BSTR
Unit
long
Count
long
__RPC_FAR
*
ActualCount
)
;
virtual
HRESULT
STDMETHODCALLTYPE
moveEnd
(
BSTR
Unit
long
Count
long
__RPC_FAR
*
ActualCount
)
;
virtual
HRESULT
STDMETHODCALLTYPE
select
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
moveToElementText
(
IHTMLElement
__RPC_FAR
*
element
)
;
virtual
HRESULT
STDMETHODCALLTYPE
setEndPoint
(
BSTR
how
IHTMLTxtRange
__RPC_FAR
*
SourceRange
)
;
virtual
HRESULT
STDMETHODCALLTYPE
compareEndPoints
(
BSTR
how
IHTMLTxtRange
__RPC_FAR
*
SourceRange
long
__RPC_FAR
*
ret
)
;
virtual
HRESULT
STDMETHODCALLTYPE
findText
(
BSTR
String
long
count
long
Flags
VARIANT_BOOL
__RPC_FAR
*
Success
)
;
virtual
HRESULT
STDMETHODCALLTYPE
moveToPoint
(
long
x
long
y
)
;
virtual
HRESULT
STDMETHODCALLTYPE
getBookmark
(
BSTR
__RPC_FAR
*
Boolmark
)
;
virtual
HRESULT
STDMETHODCALLTYPE
moveToBookmark
(
BSTR
Bookmark
VARIANT_BOOL
__RPC_FAR
*
Success
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandSupported
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandEnabled
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandState
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandIndeterm
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandText
(
BSTR
cmdID
BSTR
__RPC_FAR
*
pcmdText
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandValue
(
BSTR
cmdID
VARIANT
__RPC_FAR
*
pcmdValue
)
;
virtual
HRESULT
STDMETHODCALLTYPE
execCommand
(
BSTR
cmdID
VARIANT_BOOL
showUI
VARIANT
value
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
execCommandShowHelp
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
}
;
#
define
CIEHTMLTXTRANGE_INTERFACES
\
COM_INTERFACE_ENTRY_IID
(
IID_IDispatch
IHTMLTxtRange
\
COM_INTERFACE_ENTRY_IID
(
IID_IHTMLTxtRange
IHTMLTxtRange
)
typedef
CComObject
<
CIEHtmlTxtRange
>
CIEHtmlTxtRangeInstance
;
class
CIEHtmlControlRange
:
public
CRange
public
IDispatchImpl
<
IHTMLControlRange
&
IID_IHTMLControlRange
&
LIBID_MSHTML
>
{
public
:
CIEHtmlControlRange
(
)
;
protected
:
virtual
~
CIEHtmlControlRange
(
)
;
public
:
BEGIN_COM_MAP
(
CIEHtmlControlRange
)
COM_INTERFACE_ENTRY
(
IDispatch
)
COM_INTERFACE_ENTRY
(
IHTMLControlRange
)
END_COM_MAP
(
)
virtual
HRESULT
STDMETHODCALLTYPE
commonParentElement
(
IHTMLElement
__RPC_FAR
*
__RPC_FAR
*
parent
)
;
virtual
HRESULT
STDMETHODCALLTYPE
select
(
void
)
;
virtual
HRESULT
STDMETHODCALLTYPE
add
(
IHTMLControlElement
__RPC_FAR
*
item
)
;
virtual
HRESULT
STDMETHODCALLTYPE
remove
(
long
index
)
;
virtual
HRESULT
STDMETHODCALLTYPE
item
(
long
index
IHTMLElement
__RPC_FAR
*
__RPC_FAR
*
pdisp
)
;
virtual
HRESULT
STDMETHODCALLTYPE
scrollIntoView
(
VARIANT
varargStart
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandSupported
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandEnabled
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandState
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandIndeterm
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandText
(
BSTR
cmdID
BSTR
__RPC_FAR
*
pcmdText
)
;
virtual
HRESULT
STDMETHODCALLTYPE
queryCommandValue
(
BSTR
cmdID
VARIANT
__RPC_FAR
*
pcmdValue
)
;
virtual
HRESULT
STDMETHODCALLTYPE
execCommand
(
BSTR
cmdID
VARIANT_BOOL
showUI
VARIANT
value
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
execCommandShowHelp
(
BSTR
cmdID
VARIANT_BOOL
__RPC_FAR
*
pfRet
)
;
virtual
HRESULT
STDMETHODCALLTYPE
get_length
(
long
__RPC_FAR
*
p
)
;
}
;
typedef
CComObject
<
CIEHtmlControlRange
>
CIEHtmlControlRangeInstance
;
#
endif
