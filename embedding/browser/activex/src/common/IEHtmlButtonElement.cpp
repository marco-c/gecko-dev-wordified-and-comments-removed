#
include
"
stdafx
.
h
"
#
include
"
IEHTMLButtonElement
.
h
"
#
include
"
IEHtmlElement
.
h
"
#
include
"
nsIDOMHTMLButtonElement
.
h
"
HRESULT
CIEHtmlButtonElement
:
:
FinalConstruct
(
)
{
return
CComCreator
<
CComAggObject
<
CIEHtmlElement
>
>
:
:
CreateInstance
(
GetControllingUnknown
(
)
IID_IUnknown
reinterpret_cast
<
void
*
*
>
(
&
m_pHtmlElementAgg
)
)
;
}
HRESULT
CIEHtmlButtonElement
:
:
GetHtmlElement
(
CIEHtmlElement
*
*
ppHtmlElement
)
{
if
(
ppHtmlElement
=
=
NULL
)
return
E_FAIL
;
*
ppHtmlElement
=
NULL
;
IHTMLElement
*
pHtmlElement
=
NULL
;
HRESULT
hr
=
m_pHtmlElementAgg
-
>
QueryInterface
(
IID_IHTMLElement
(
void
*
*
)
&
pHtmlElement
)
;
*
ppHtmlElement
=
(
CIEHtmlElement
*
)
pHtmlElement
;
return
hr
;
}
HRESULT
CIEHtmlButtonElement
:
:
SetDOMNode
(
nsIDOMNode
*
pDomNode
)
{
mDOMNode
=
pDomNode
;
CIEHtmlElement
*
pHtmlElement
;
GetHtmlElement
(
&
pHtmlElement
)
;
HRESULT
hr
=
pHtmlElement
-
>
SetDOMNode
(
pDomNode
)
;
GetControllingUnknown
(
)
-
>
Release
(
)
;
return
hr
;
}
HRESULT
CIEHtmlButtonElement
:
:
SetParent
(
CNode
*
pParent
)
{
CNode
:
:
SetParent
(
pParent
)
;
CIEHtmlElement
*
pHtmlElement
;
GetHtmlElement
(
&
pHtmlElement
)
;
HRESULT
hr
=
pHtmlElement
-
>
SetParent
(
pParent
)
;
GetControllingUnknown
(
)
-
>
Release
(
)
;
return
hr
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
get_type
(
BSTR
__RPC_FAR
*
p
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
put_value
(
BSTR
v
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
get_value
(
BSTR
__RPC_FAR
*
p
)
{
if
(
p
=
=
NULL
)
return
E_INVALIDARG
;
*
p
=
NULL
;
nsCOMPtr
<
nsIDOMHTMLButtonElement
>
domHtmlButtonElement
=
do_QueryInterface
(
mDOMNode
)
;
if
(
!
domHtmlButtonElement
)
return
E_UNEXPECTED
;
nsAutoString
strValue
;
domHtmlButtonElement
-
>
GetValue
(
strValue
)
;
*
p
=
SysAllocString
(
strValue
.
get
(
)
)
;
if
(
!
*
p
)
return
E_OUTOFMEMORY
;
return
S_OK
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
put_name
(
BSTR
v
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
get_name
(
BSTR
__RPC_FAR
*
p
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
put_status
(
VARIANT
v
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
get_status
(
VARIANT
__RPC_FAR
*
p
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
put_disabled
(
VARIANT_BOOL
v
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
get_disabled
(
VARIANT_BOOL
__RPC_FAR
*
p
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
get_form
(
IHTMLFormElement
__RPC_FAR
*
__RPC_FAR
*
p
)
{
return
E_NOTIMPL
;
}
HRESULT
STDMETHODCALLTYPE
CIEHtmlButtonElement
:
:
createTextRange
(
IHTMLTxtRange
__RPC_FAR
*
__RPC_FAR
*
range
)
{
return
E_NOTIMPL
;
}
