typedef
u_long
tcp_seq
;
struct
tcphdr
{
u_short
th_sport
;
u_short
th_dport
;
tcp_seq
th_seq
;
tcp_seq
th_ack
;
u_char
th_off
:
4
th_x2
:
4
;
u_char
th_flags
;
#
define
TH_FIN
0x01
#
define
TH_SYN
0x02
#
define
TH_RST
0x04
#
define
TH_PUSH
0x08
#
define
TH_ACK
0x10
#
define
TH_URG
0x20
u_short
th_win
;
u_short
th_sum
;
u_short
th_urp
;
}
;
#
define
TCPOPT_EOL
0
#
define
TCPOPT_NOP
1
#
define
TCPOPT_MAXSEG
2
#
define
TCPOLEN_MAXSEG
4
#
define
TCPOPT_WINDOW
3
#
define
TCPOLEN_WINDOW
3
#
define
TCPOPT_SACK_PERMITTED
4
/
*
Experimental
*
/
#
define
TCPOLEN_SACK_PERMITTED
2
#
define
TCPOPT_SACK
5
/
*
Experimental
*
/
#
define
TCPOPT_TIMESTAMP
8
#
define
TCPOLEN_TIMESTAMP
10
#
define
TCPOLEN_TSTAMP_APPA
(
TCPOLEN_TIMESTAMP
+
2
)
/
*
appendix
A
*
/
#
define
TCPOPT_TSTAMP_HDR
\
(
TCPOPT_NOP
<
<
24
|
TCPOPT_NOP
<
<
16
|
TCPOPT_TIMESTAMP
<
<
8
|
TCPOLEN_TIMESTAMP
)
#
define
TCP_MSS
512
#
define
TCP_MAXWIN
65535
/
*
largest
value
for
(
unscaled
)
window
*
/
#
define
TCP_MAX_WINSHIFT
14
/
*
maximum
window
shift
*
/
#
define
TCP_NODELAY
0x01
/
*
don
'
t
delay
send
to
coalesce
packets
*
/
#
define
TCP_MAXSEG
0x02
/
*
set
maximum
segment
size
*
/
#
define
TCP_KEEPALIVE
0x08
/
*
seconds
between
keepalive
packets
*
/
