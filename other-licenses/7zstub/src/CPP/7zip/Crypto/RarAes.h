#
ifndef
__CRYPTO_RAR_AES_H
#
define
__CRYPTO_RAR_AES_H
#
include
"
.
.
/
.
.
/
.
.
/
C
/
Aes
.
h
"
#
include
"
.
.
/
.
.
/
Common
/
MyBuffer
.
h
"
#
include
"
.
.
/
IPassword
.
h
"
#
include
"
MyAes
.
h
"
namespace
NCrypto
{
namespace
NRar3
{
const
unsigned
kAesKeySize
=
16
;
class
CDecoder
:
public
CAesCbcDecoder
{
Byte
_salt
[
8
]
;
bool
_thereIsSalt
;
bool
_needCalc
;
CByteBuffer
_password
;
Byte
_key
[
kAesKeySize
]
;
Byte
_iv
[
AES_BLOCK_SIZE
]
;
void
CalcKey
(
)
;
public
:
STDMETHOD
(
Init
)
(
)
;
void
SetPassword
(
const
Byte
*
data
unsigned
size
)
;
HRESULT
SetDecoderProperties2
(
const
Byte
*
data
UInt32
size
)
;
CDecoder
(
)
;
}
;
}
}
#
endif
