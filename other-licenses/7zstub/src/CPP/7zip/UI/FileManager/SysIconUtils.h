#
ifndef
__SYS_ICON_UTILS_H
#
define
__SYS_ICON_UTILS_H
#
include
"
.
.
/
.
.
/
.
.
/
Common
/
MyWindows
.
h
"
#
include
<
commctrl
.
h
>
#
include
"
.
.
/
.
.
/
.
.
/
Common
/
MyString
.
h
"
struct
CExtIconPair
{
UString
Ext
;
int
IconIndex
;
}
;
struct
CAttribIconPair
{
DWORD
Attrib
;
int
IconIndex
;
}
;
class
CExtToIconMap
{
public
:
CRecordVector
<
CAttribIconPair
>
_attribMap
;
CObjectVector
<
CExtIconPair
>
_extMap
;
int
SplitIconIndex
;
int
SplitIconIndex_Defined
;
CExtToIconMap
(
)
:
SplitIconIndex_Defined
(
false
)
{
}
void
Clear
(
)
{
SplitIconIndex_Defined
=
false
;
_extMap
.
Clear
(
)
;
_attribMap
.
Clear
(
)
;
}
int
GetIconIndex
(
DWORD
attrib
const
wchar_t
*
fileName
)
;
}
;
DWORD_PTR
GetRealIconIndex
(
CFSTR
path
DWORD
attrib
int
&
iconIndex
)
;
int
GetIconIndexForCSIDL
(
int
csidl
)
;
inline
HIMAGELIST
GetSysImageList
(
bool
smallIcons
)
{
SHFILEINFO
shellInfo
;
return
(
HIMAGELIST
)
SHGetFileInfo
(
TEXT
(
"
"
)
FILE_ATTRIBUTE_NORMAL
|
FILE_ATTRIBUTE_DIRECTORY
&
shellInfo
sizeof
(
shellInfo
)
SHGFI_USEFILEATTRIBUTES
|
SHGFI_SYSICONINDEX
|
(
smallIcons
?
SHGFI_SMALLICON
:
SHGFI_ICON
)
)
;
}
#
endif
