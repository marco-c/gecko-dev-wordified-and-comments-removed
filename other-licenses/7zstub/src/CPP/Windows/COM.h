#
ifndef
__WINDOWS_COM_H
#
define
__WINDOWS_COM_H
#
include
"
.
.
/
Common
/
MyString
.
h
"
namespace
NWindows
{
namespace
NCOM
{
#
ifdef
_WIN32
class
CComInitializer
{
public
:
CComInitializer
(
)
{
#
ifdef
UNDER_CE
CoInitializeEx
(
NULL
COINIT_MULTITHREADED
)
;
#
else
CoInitialize
(
NULL
)
;
#
endif
}
;
~
CComInitializer
(
)
{
CoUninitialize
(
)
;
}
}
;
class
CStgMedium
{
STGMEDIUM
_object
;
public
:
bool
_mustBeReleased
;
CStgMedium
(
)
:
_mustBeReleased
(
false
)
{
}
~
CStgMedium
(
)
{
Free
(
)
;
}
void
Free
(
)
{
if
(
_mustBeReleased
)
ReleaseStgMedium
(
&
_object
)
;
_mustBeReleased
=
false
;
}
const
STGMEDIUM
*
operator
-
>
(
)
const
{
return
&
_object
;
}
STGMEDIUM
*
operator
-
>
(
)
{
return
&
_object
;
}
STGMEDIUM
*
operator
&
(
)
{
return
&
_object
;
}
}
;
#
endif
}
}
#
endif
