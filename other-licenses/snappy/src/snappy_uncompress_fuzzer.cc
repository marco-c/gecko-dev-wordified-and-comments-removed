#
include
<
stddef
.
h
>
#
include
<
stdint
.
h
>
#
include
<
cassert
>
#
include
<
string
>
#
include
"
snappy
.
h
"
extern
"
C
"
int
LLVMFuzzerTestOneInput
(
const
uint8_t
*
data
size_t
size
)
{
std
:
:
string
input
(
reinterpret_cast
<
const
char
*
>
(
data
)
size
)
;
size_t
uncompressed_size
;
constexpr
size_t
kMaxUncompressedSize
=
1
<
<
20
;
bool
get_uncompressed_length_succeeded
=
snappy
:
:
GetUncompressedLength
(
input
.
data
(
)
input
.
size
(
)
&
uncompressed_size
)
;
if
(
!
get_uncompressed_length_succeeded
|
|
(
uncompressed_size
>
kMaxUncompressedSize
)
)
{
return
0
;
}
std
:
:
string
uncompressed
;
snappy
:
:
Uncompress
(
input
.
data
(
)
input
.
size
(
)
&
uncompressed
)
;
return
0
;
}
