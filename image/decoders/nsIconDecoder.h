#
ifndef
mozilla_image_decoders_nsIconDecoder_h
#
define
mozilla_image_decoders_nsIconDecoder_h
#
include
"
Decoder
.
h
"
#
include
"
StreamingLexer
.
h
"
#
include
"
nsCOMPtr
.
h
"
namespace
mozilla
{
namespace
image
{
class
RasterImage
;
class
nsIconDecoder
:
public
Decoder
{
public
:
virtual
~
nsIconDecoder
(
)
;
virtual
void
WriteInternal
(
const
char
*
aBuffer
uint32_t
aCount
)
override
;
private
:
friend
class
DecoderFactory
;
explicit
nsIconDecoder
(
RasterImage
*
aImage
)
;
enum
class
State
{
HEADER
ROW_OF_PIXELS
FINISH
}
;
LexerTransition
<
State
>
ReadHeader
(
const
char
*
aData
)
;
LexerTransition
<
State
>
ReadRowOfPixels
(
const
char
*
aData
size_t
aLength
)
;
LexerTransition
<
State
>
Finish
(
)
;
StreamingLexer
<
State
>
mLexer
;
uint8_t
mWidth
;
uint8_t
mHeight
;
uint32_t
mBytesPerRow
;
uint32_t
mBytesTotal
;
uint32_t
mCurrentRow
;
}
;
}
}
#
endif
