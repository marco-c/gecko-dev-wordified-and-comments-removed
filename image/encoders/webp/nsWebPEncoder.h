#
ifndef
mozilla_image_encoders_webp_nsWebPEncoder_h
#
define
mozilla_image_encoders_webp_nsWebPEncoder_h
#
include
"
webp
/
encode
.
h
"
#
include
"
imgIEncoder
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
ReentrantMonitor
.
h
"
#
define
NS_WEBPENCODER_CID
\
{
/
*
a8e5a8e5
-
bebf
-
4512
-
9f50
-
e41e4748ce28
*
/
\
0xa8e5a8e5
0xbebf
0x4512
{
\
0x9f
0x50
0xe4
0x1e
0x47
0x48
0xce
0x28
\
}
\
}
class
nsWebPEncoder
final
:
public
imgIEncoder
{
typedef
mozilla
:
:
ReentrantMonitor
ReentrantMonitor
;
public
:
NS_DECL_THREADSAFE_ISUPPORTS
NS_DECL_IMGIENCODER
NS_DECL_NSIINPUTSTREAM
NS_DECL_NSIASYNCINPUTSTREAM
nsWebPEncoder
(
)
;
protected
:
~
nsWebPEncoder
(
)
;
void
NotifyListener
(
)
;
bool
mFinished
;
uint8_t
*
mImageBuffer
;
uint32_t
mImageBufferSize
;
uint32_t
mImageBufferUsed
;
uint32_t
mImageBufferReadPoint
;
nsCOMPtr
<
nsIInputStreamCallback
>
mCallback
;
nsCOMPtr
<
nsIEventTarget
>
mCallbackTarget
;
uint32_t
mNotifyThreshold
;
ReentrantMonitor
mReentrantMonitor
MOZ_UNANNOTATED
;
}
;
#
endif
