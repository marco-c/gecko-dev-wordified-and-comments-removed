#
ifndef
mozilla_image_src_ImageCacheKey_h
#
define
mozilla_image_src_ImageCacheKey_h
#
include
"
mozilla
/
BasePrincipal
.
h
"
#
include
"
mozilla
/
Maybe
.
h
"
#
include
"
mozilla
/
RefPtr
.
h
"
class
nsIDocument
;
class
nsIURI
;
namespace
mozilla
{
namespace
image
{
class
ImageURL
;
class
ImageCacheKey
final
{
public
:
ImageCacheKey
(
nsIURI
*
aURI
const
PrincipalOriginAttributes
&
aAttrs
nsIDocument
*
aDocument
)
;
ImageCacheKey
(
ImageURL
*
aURI
const
PrincipalOriginAttributes
&
aAttrs
nsIDocument
*
aDocument
)
;
ImageCacheKey
(
const
ImageCacheKey
&
aOther
)
;
ImageCacheKey
(
ImageCacheKey
&
&
aOther
)
;
bool
operator
=
=
(
const
ImageCacheKey
&
aOther
)
const
;
uint32_t
Hash
(
)
const
{
return
mHash
;
}
const
char
*
Spec
(
)
const
;
bool
IsChrome
(
)
const
{
return
mIsChrome
;
}
void
*
ControlledDocument
(
)
const
{
return
mControlledDocument
;
}
private
:
static
uint32_t
ComputeHash
(
ImageURL
*
aURI
const
Maybe
<
uint64_t
>
&
aBlobSerial
const
PrincipalOriginAttributes
&
aAttrs
void
*
aControlledDocument
)
;
static
void
*
GetControlledDocumentToken
(
nsIDocument
*
aDocument
)
;
RefPtr
<
ImageURL
>
mURI
;
Maybe
<
uint64_t
>
mBlobSerial
;
PrincipalOriginAttributes
mOriginAttributes
;
void
*
mControlledDocument
;
uint32_t
mHash
;
bool
mIsChrome
;
}
;
}
}
#
endif
