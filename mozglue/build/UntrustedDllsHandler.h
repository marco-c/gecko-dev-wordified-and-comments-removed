#
ifndef
mozilla_glue_UntrustedDllsHandler_h
#
define
mozilla_glue_UntrustedDllsHandler_h
#
include
<
windows
.
h
>
#
include
<
winternl
.
h
>
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
glue
/
WindowsDllServices
.
h
"
#
include
"
mozilla
/
Vector
.
h
"
namespace
mozilla
{
namespace
glue
{
class
UntrustedDllsHandler
{
public
:
static
void
Init
(
)
;
#
ifdef
DEBUG
static
void
Shutdown
(
)
;
#
endif
static
void
EnterLoaderCall
(
)
;
static
void
ExitLoaderCall
(
)
;
static
void
OnAfterModuleLoad
(
uintptr_t
aBaseAddr
PUNICODE_STRING
aLdrModuleName
double
aLoadDurationMS
)
;
static
bool
TakePendingEvents
(
Vector
<
ModuleLoadEvent
0
InfallibleAllocPolicy
>
&
aOut
)
;
}
;
}
}
#
endif
