#
ifndef
mozilla_AssemblyPayloads_h
#
define
mozilla_AssemblyPayloads_h
extern
"
C
"
{
#
if
defined
(
__clang__
)
#
if
defined
(
_M_X64
)
constexpr
uintptr_t
JumpDestination
=
0x7fff00000000
;
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
MovPushRet
(
)
{
asm
volatile
(
"
mov
%
0
%
%
rax
;
"
"
push
%
%
rax
;
"
"
ret
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
MovRaxJump
(
)
{
asm
volatile
(
"
mov
%
0
%
%
rax
;
"
"
jmpq
*
%
%
rax
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
#
elif
defined
(
_M_IX86
)
constexpr
uintptr_t
JumpDestination
=
0x7fff0000
;
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
PushRet
(
)
{
asm
volatile
(
"
push
%
0
;
"
"
ret
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
MovEaxJump
(
)
{
asm
volatile
(
"
mov
%
0
%
%
eax
;
"
"
jmp
*
%
%
eax
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
#
endif
#
endif
}
#
endif
