#
ifndef
mozilla_AssemblyPayloads_h
#
define
mozilla_AssemblyPayloads_h
extern
"
C
"
{
#
if
defined
(
__clang__
)
#
if
defined
(
_M_X64
)
constexpr
uintptr_t
JumpDestination
=
0x7fff00000000
;
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
MovPushRet
(
)
{
asm
volatile
(
"
mov
%
0
%
%
rax
;
"
"
push
%
%
rax
;
"
"
ret
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
MovRaxJump
(
)
{
asm
volatile
(
"
mov
%
0
%
%
rax
;
"
"
jmpq
*
%
%
rax
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
DoubleJump
(
)
{
asm
volatile
(
"
jmp
label1
;
"
"
label2
:
"
"
mov
%
0
%
%
rax
;
"
"
jmpq
*
%
%
rax
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
label1
:
"
"
jmp
label2
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
#
elif
defined
(
_M_IX86
)
constexpr
uintptr_t
JumpDestination
=
0x7fff0000
;
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
PushRet
(
)
{
asm
volatile
(
"
push
%
0
;
"
"
ret
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
MovEaxJump
(
)
{
asm
volatile
(
"
mov
%
0
%
%
eax
;
"
"
jmp
*
%
%
eax
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
Opcode83
(
)
{
asm
volatile
(
"
xor
0x42
%
eax
;
"
"
cmpl
1
0xc
(
%
ebp
)
;
"
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
LockPrefix
(
)
{
asm
volatile
(
"
push
0x7c
;
"
"
lock
push
0x7c
;
"
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
LooksLikeLockPrefix
(
)
{
asm
volatile
(
"
push
0x7c
;
"
"
push
0x0000f0cc
;
"
)
;
}
__declspec
(
dllexport
)
__attribute__
(
(
naked
)
)
void
DoubleJump
(
)
{
asm
volatile
(
"
jmp
label1
;
"
"
label2
:
"
"
mov
%
0
%
%
eax
;
"
"
jmp
*
%
%
eax
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
nop
;
"
"
label1
:
"
"
jmp
label2
;
"
:
:
"
i
"
(
JumpDestination
)
)
;
}
#
endif
#
endif
}
#
endif
