#
include
"
mozilla
/
AutoProfilerLabel
.
h
"
namespace
mozilla
{
static
ProfilerLabelEnter
sEnter
=
nullptr
;
static
ProfilerLabelExit
sExit
=
nullptr
;
void
RegisterProfilerLabelEnterExit
(
ProfilerLabelEnter
aEnter
ProfilerLabelExit
aExit
)
{
sEnter
=
aEnter
;
sExit
=
aExit
;
}
AutoProfilerLabel
:
:
AutoProfilerLabel
(
const
char
*
aLabel
const
char
*
aDynamicString
uint32_t
aLine
MOZ_GUARD_OBJECT_NOTIFIER_PARAM_IN_IMPL
)
{
MOZ_GUARD_OBJECT_NOTIFIER_INIT
;
mProfilingStack
=
sEnter
?
sEnter
(
aLabel
aDynamicString
this
aLine
)
:
nullptr
;
}
AutoProfilerLabel
:
:
~
AutoProfilerLabel
(
)
{
if
(
sExit
&
&
mProfilingStack
)
{
sExit
(
mProfilingStack
)
;
}
}
}
