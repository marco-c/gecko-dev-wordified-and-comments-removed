#
include
"
GetKnownFolderPath
.
h
"
namespace
mozilla
{
UniquePtr
<
wchar_t
LoadedCoTaskMemFreeDeleter
>
GetKnownFolderPath
(
REFKNOWNFOLDERID
folderId
)
{
static
decltype
(
SHGetKnownFolderPath
)
*
shGetKnownFolderPath
=
nullptr
;
if
(
!
shGetKnownFolderPath
)
{
HMODULE
shell32Dll
=
:
:
LoadLibraryW
(
L
"
shell32
"
)
;
if
(
!
shell32Dll
)
{
return
nullptr
;
}
shGetKnownFolderPath
=
reinterpret_cast
<
decltype
(
shGetKnownFolderPath
)
>
(
:
:
GetProcAddress
(
shell32Dll
"
SHGetKnownFolderPath
"
)
)
;
if
(
!
shGetKnownFolderPath
)
{
return
nullptr
;
}
}
PWSTR
path
=
nullptr
;
shGetKnownFolderPath
(
folderId
0
nullptr
&
path
)
;
return
UniquePtr
<
wchar_t
LoadedCoTaskMemFreeDeleter
>
(
path
)
;
}
}
