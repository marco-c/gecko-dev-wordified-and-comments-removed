#
ifndef
mozilla_glue_Debug_h
#
define
mozilla_glue_Debug_h
#
include
<
io
.
h
>
#
if
defined
(
XP_WIN
)
#
include
<
windows
.
h
>
#
endif
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
Sprintf
.
h
"
#
if
defined
(
MOZILLA_INTERNAL_API
)
#
error
Do
not
include
this
file
from
XUL
sources
.
#
endif
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
inline
void
printf_stderr
(
const
char
*
fmt
.
.
.
)
MOZ_FORMAT_PRINTF
(
1
2
)
{
#
if
defined
(
XP_WIN
)
if
(
IsDebuggerPresent
(
)
)
{
char
buf
[
2048
]
;
va_list
args
;
va_start
(
args
fmt
)
;
VsprintfLiteral
(
buf
fmt
args
)
;
va_end
(
args
)
;
OutputDebugStringA
(
buf
)
;
}
#
endif
int
fd
=
_fileno
(
stderr
)
;
if
(
fd
=
=
-
2
)
return
;
FILE
*
fp
=
_fdopen
(
_dup
(
fd
)
"
a
"
)
;
if
(
!
fp
)
return
;
va_list
args
;
va_start
(
args
fmt
)
;
vfprintf
(
fp
fmt
args
)
;
va_end
(
args
)
;
fclose
(
fp
)
;
}
#
ifdef
__cplusplus
}
#
endif
#
endif
