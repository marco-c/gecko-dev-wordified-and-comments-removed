Library
(
'
dav1d
'
)
LOCAL_INCLUDES
+
=
[
'
/
third_party
/
dav1d
'
'
/
third_party
/
dav1d
/
include
'
'
/
third_party
/
dav1d
/
include
/
dav1d
'
'
/
third_party
/
dav1d
/
src
'
]
EXPORTS
.
dav1d
+
=
[
'
config
.
h
'
'
version
.
h
'
]
entrypoint_source_files
=
[
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
lib
.
c
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
thread_task
.
c
'
]
SOURCES
+
=
[
f
for
f
in
entrypoint_source_files
]
DEFINES
[
'
DAV1D_API
'
]
=
'
'
if
CONFIG
[
'
MOZ_DAV1D_ASM
'
]
:
DIRS
+
=
[
'
asm
'
]
stack_alignment
=
0
if
CONFIG
[
'
CPU_ARCH
'
]
=
=
'
x86
'
:
if
CONFIG
[
'
OS_TARGET
'
]
=
=
'
WINNT
'
:
stack_alignment
=
4
else
:
stack_alignment
=
16
if
CONFIG
[
'
CC_TYPE
'
]
=
=
'
clang
'
:
CFLAGS
+
=
[
'
-
mstack
-
alignment
=
16
'
]
for
ep
in
entrypoint_source_files
:
SOURCES
[
ep
]
.
flags
+
=
[
'
-
mstackrealign
'
]
elif
CONFIG
[
'
CC_TYPE
'
]
=
=
'
gcc
'
:
CFLAGS
+
=
[
'
-
mpreferred
-
stack
-
boundary
=
4
'
]
for
ep
in
entrypoint_source_files
:
SOURCES
[
ep
]
.
flags
+
=
[
'
-
mincoming
-
stack
-
boundary
=
2
'
]
elif
CONFIG
[
'
CPU_ARCH
'
]
in
(
'
x86_64
'
'
aarch64
'
)
:
stack_alignment
=
16
else
:
error
(
'
Cpu
arch
%
s
is
not
expected
'
%
CONFIG
[
'
CPU_ARCH
'
]
)
if
stack_alignment
=
=
0
:
error
(
'
Stack
alignment
cannot
be
zero
.
'
)
DEFINES
[
'
STACK_ALIGNMENT
'
]
=
stack_alignment
if
CONFIG
[
'
OS_TARGET
'
]
=
=
'
Linux
'
:
include
(
'
/
tools
/
fuzzing
/
libfuzzer
-
config
.
mozbuild
'
)
if
CONFIG
[
'
FUZZING_INTERFACES
'
]
:
TEST_DIRS
+
=
[
'
test
/
fuzztest
'
]
include
(
'
autovendored_sources
.
mozbuild
'
)
SOURCES
+
=
sources
EXPORTS
.
dav1d
.
src
+
=
[
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
cdf
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
cpu
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
ctx
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
data
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
decode
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
dequant_tables
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
film_grain
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
getbits
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
intra_edge
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
lf_mask
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
log
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
msac
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
obu
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
picture
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
qm
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
ref
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
refmvs
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
scan
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
tables
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
thread
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
warpmv
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
wedge
.
h
'
]
relative_path
=
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
'
bitdepth_basenames
=
[
'
cdef_apply_tmpl
.
c
'
'
cdef_tmpl
.
c
'
'
fg_apply_tmpl
.
c
'
'
film_grain_tmpl
.
c
'
'
ipred_prepare_tmpl
.
c
'
'
ipred_tmpl
.
c
'
'
itx_tmpl
.
c
'
'
lf_apply_tmpl
.
c
'
'
loopfilter_tmpl
.
c
'
'
looprestoration_tmpl
.
c
'
'
lr_apply_tmpl
.
c
'
'
mc_tmpl
.
c
'
'
recon_tmpl
.
c
'
]
generated_files
=
[
]
for
f
in
bitdepth_basenames
:
file_bd16
=
'
16bd_
%
s
'
%
f
file_bd8
=
'
8bd_
%
s
'
%
f
GeneratedFile
(
file_bd16
script
=
'
generate_source
.
py
'
entry_point
=
'
add_define
'
inputs
=
[
relative_path
+
f
]
flags
=
[
'
BITDEPTH
'
'
16
'
]
)
GeneratedFile
(
file_bd8
script
=
'
generate_source
.
py
'
entry_point
=
'
add_define
'
inputs
=
[
relative_path
+
f
]
flags
=
[
'
BITDEPTH
'
'
8
'
]
)
generated_files
+
=
[
file_bd16
file_bd8
]
for
p
in
generated_files
:
if
p
.
endswith
(
'
.
c
'
)
:
SOURCES
+
=
[
'
!
%
s
'
%
p
]
EXPORTS
.
dav1d
.
src
+
=
[
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
cdef
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
cdef_apply
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
fg_apply
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
ipred
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
ipred_prepare
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
itx
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
itx_1d
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
lf_apply
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
loopfilter
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
looprestoration
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
lr_apply
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
mc
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
recon
.
h
'
]
EXPORTS
.
dav1d
+
=
[
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
common
/
attributes
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
common
/
bitdepth
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
common
/
dump
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
common
/
intops
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
common
/
mem
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
common
/
validate
.
h
'
]
EXPORTS
.
dav1d
+
=
[
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
dav1d
/
common
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
dav1d
/
data
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
dav1d
/
dav1d
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
dav1d
/
headers
.
h
'
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
dav1d
/
picture
.
h
'
]
if
CONFIG
[
'
OS_TARGET
'
]
=
=
'
WINNT
'
:
SOURCES
+
=
[
'
.
.
/
.
.
/
third_party
/
dav1d
/
src
/
win32
/
thread
.
c
'
]
if
CONFIG
[
'
CC_TYPE
'
]
=
=
'
gcc
'
:
LOCAL_INCLUDES
+
=
[
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
compat
/
gcc
/
'
]
EXPORTS
.
dav1d
+
=
[
'
.
.
/
.
.
/
third_party
/
dav1d
/
include
/
compat
/
gcc
/
stdatomic
.
h
'
]
FINAL_LIBRARY
=
'
gkmedias
'
AllowCompilerWarnings
(
)
