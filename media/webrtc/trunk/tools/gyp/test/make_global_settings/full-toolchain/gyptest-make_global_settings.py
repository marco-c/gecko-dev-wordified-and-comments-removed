"
"
"
Verifies
make_global_settings
works
with
the
full
toolchain
.
"
"
"
import
os
import
sys
import
TestGyp
if
sys
.
platform
=
=
'
win32
'
:
  
sys
.
exit
(
0
)
test
=
TestGyp
.
TestGyp
(
formats
=
[
'
ninja
'
]
)
test
.
formats
=
[
'
ninja
-
my_flavor
'
if
f
=
=
'
ninja
'
else
f
for
f
in
test
.
formats
]
gyp_file
=
'
make_global_settings
.
gyp
'
test
.
run_gyp
(
gyp_file
             
'
-
Dworkdir
=
%
s
'
%
test
.
workdir
             
'
-
Dpython
=
%
s
'
%
sys
.
executable
)
test
.
build
(
gyp_file
           
arguments
=
[
'
-
v
'
]
if
test
.
format
=
=
'
ninja
-
my_flavor
'
else
[
]
)
expected
=
[
'
MY_CC
'
'
MY_CXX
'
]
test
.
must_contain_all_lines
(
test
.
stdout
(
)
expected
)
test
.
must_contain
(
test
.
built_file_path
(
'
RAN_MY_NM
'
)
'
RAN_MY_NM
'
)
test
.
must_contain
(
test
.
built_file_path
(
'
RAN_MY_READELF
'
)
'
RAN_MY_READELF
'
)
test
.
pass_test
(
)
