"
"
"
Verify
that
.
s
files
don
'
t
always
trigger
a
rebuild
as
would
happen
if
depfiles
were
used
for
them
(
since
clang
&
gcc
ignore
-
MMD
when
building
.
s
-
>
.
o
on
linux
)
.
"
"
"
import
os
import
sys
import
TestCommon
import
TestGyp
test
=
TestGyp
.
TestGyp
(
formats
=
[
'
ninja
'
]
)
if
sys
.
platform
=
=
'
win32
'
or
sys
.
platform
=
=
'
win64
'
:
  
test
.
pass_test
(
)
  
sys
.
exit
(
0
)
test
.
run_gyp
(
'
s
-
needs
-
no
-
depfiles
.
gyp
'
)
test
.
build
(
'
s
-
needs
-
no
-
depfiles
.
gyp
'
'
empty
'
)
empty_dll
=
test
.
built_file_path
(
'
empty
'
test
.
SHARED_LIB
)
test
.
built_file_must_exist
(
empty_dll
)
pre_stat
=
os
.
stat
(
test
.
built_file_path
(
empty_dll
)
)
test
.
sleep
(
)
test
.
build
(
'
s
-
needs
-
no
-
depfiles
.
gyp
'
'
empty
'
)
post_stat
=
os
.
stat
(
test
.
built_file_path
(
empty_dll
)
)
if
pre_stat
.
st_mtime
!
=
post_stat
.
st_mtime
:
  
test
.
fail_test
(
)
else
:
  
test
.
pass_test
(
)
