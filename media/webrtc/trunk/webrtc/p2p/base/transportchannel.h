#
ifndef
WEBRTC_P2P_BASE_TRANSPORTCHANNEL_H_
#
define
WEBRTC_P2P_BASE_TRANSPORTCHANNEL_H_
#
include
<
string
>
#
include
<
vector
>
#
include
"
webrtc
/
p2p
/
base
/
candidate
.
h
"
#
include
"
webrtc
/
p2p
/
base
/
transport
.
h
"
#
include
"
webrtc
/
p2p
/
base
/
transportdescription
.
h
"
#
include
"
webrtc
/
base
/
asyncpacketsocket
.
h
"
#
include
"
webrtc
/
base
/
basictypes
.
h
"
#
include
"
webrtc
/
base
/
dscp
.
h
"
#
include
"
webrtc
/
base
/
sigslot
.
h
"
#
include
"
webrtc
/
base
/
socket
.
h
"
#
include
"
webrtc
/
base
/
sslidentity
.
h
"
#
include
"
webrtc
/
base
/
sslstreamadapter
.
h
"
namespace
cricket
{
class
Candidate
;
enum
PacketFlags
{
PF_NORMAL
=
0x00
PF_SRTP_BYPASS
=
0x01
}
;
enum
TransportChannelState
{
STATE_CONNECTING
STATE_COMPLETED
STATE_FAILED
}
;
class
TransportChannel
:
public
sigslot
:
:
has_slots
<
>
{
public
:
explicit
TransportChannel
(
const
std
:
:
string
&
content_name
int
component
)
:
content_name_
(
content_name
)
component_
(
component
)
readable_
(
false
)
writable_
(
false
)
{
}
virtual
~
TransportChannel
(
)
{
}
virtual
TransportChannelState
GetState
(
)
const
{
return
TransportChannelState
:
:
STATE_CONNECTING
;
}
virtual
const
std
:
:
string
SessionId
(
)
const
{
return
std
:
:
string
(
)
;
}
const
std
:
:
string
&
content_name
(
)
const
{
return
content_name_
;
}
int
component
(
)
const
{
return
component_
;
}
bool
readable
(
)
const
{
return
readable_
;
}
bool
writable
(
)
const
{
return
writable_
;
}
sigslot
:
:
signal1
<
TransportChannel
*
>
SignalReadableState
;
sigslot
:
:
signal1
<
TransportChannel
*
>
SignalWritableState
;
sigslot
:
:
signal1
<
TransportChannel
*
>
SignalReadyToSend
;
virtual
int
SendPacket
(
const
char
*
data
size_t
len
const
rtc
:
:
PacketOptions
&
options
int
flags
=
0
)
=
0
;
virtual
int
SetOption
(
rtc
:
:
Socket
:
:
Option
opt
int
value
)
=
0
;
virtual
bool
GetOption
(
rtc
:
:
Socket
:
:
Option
opt
int
*
value
)
{
return
false
;
}
virtual
int
GetError
(
)
=
0
;
virtual
bool
GetStats
(
ConnectionInfos
*
infos
)
=
0
;
virtual
bool
IsDtlsActive
(
)
const
=
0
;
virtual
bool
GetSslRole
(
rtc
:
:
SSLRole
*
role
)
const
=
0
;
virtual
bool
SetSrtpCiphers
(
const
std
:
:
vector
<
std
:
:
string
>
&
ciphers
)
=
0
;
virtual
bool
GetSrtpCipher
(
std
:
:
string
*
cipher
)
=
0
;
virtual
bool
GetSslCipher
(
std
:
:
string
*
cipher
)
=
0
;
virtual
bool
GetLocalIdentity
(
rtc
:
:
SSLIdentity
*
*
identity
)
const
=
0
;
virtual
bool
GetRemoteCertificate
(
rtc
:
:
SSLCertificate
*
*
cert
)
const
=
0
;
virtual
bool
ExportKeyingMaterial
(
const
std
:
:
string
&
label
const
uint8
*
context
size_t
context_len
bool
use_context
uint8
*
result
size_t
result_len
)
=
0
;
sigslot
:
:
signal5
<
TransportChannel
*
const
char
*
size_t
const
rtc
:
:
PacketTime
&
int
>
SignalReadPacket
;
sigslot
:
:
signal2
<
TransportChannel
*
const
Candidate
&
>
SignalRouteChange
;
sigslot
:
:
signal1
<
TransportChannel
*
>
SignalDestroyed
;
std
:
:
string
ToString
(
)
const
;
protected
:
void
set_readable
(
bool
readable
)
;
void
set_writable
(
bool
writable
)
;
private
:
std
:
:
string
content_name_
;
int
component_
;
bool
readable_
;
bool
writable_
;
DISALLOW_EVIL_CONSTRUCTORS
(
TransportChannel
)
;
}
;
}
#
endif
