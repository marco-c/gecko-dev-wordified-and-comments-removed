#
ifndef
WEBRTC_P2P_BASE_STUNSERVER_H_
#
define
WEBRTC_P2P_BASE_STUNSERVER_H_
#
include
"
webrtc
/
p2p
/
base
/
stun
.
h
"
#
include
"
webrtc
/
base
/
asyncudpsocket
.
h
"
#
include
"
webrtc
/
base
/
scoped_ptr
.
h
"
namespace
cricket
{
const
int
STUN_SERVER_PORT
=
3478
;
class
StunServer
:
public
sigslot
:
:
has_slots
<
>
{
public
:
explicit
StunServer
(
rtc
:
:
AsyncUDPSocket
*
socket
)
;
~
StunServer
(
)
;
protected
:
void
OnPacket
(
rtc
:
:
AsyncPacketSocket
*
socket
const
char
*
buf
size_t
size
const
rtc
:
:
SocketAddress
&
remote_addr
const
rtc
:
:
PacketTime
&
packet_time
)
;
virtual
void
OnBindingRequest
(
StunMessage
*
msg
const
rtc
:
:
SocketAddress
&
addr
)
;
void
OnAllocateRequest
(
StunMessage
*
msg
const
rtc
:
:
SocketAddress
&
addr
)
;
void
OnSharedSecretRequest
(
StunMessage
*
msg
const
rtc
:
:
SocketAddress
&
addr
)
;
void
OnSendRequest
(
StunMessage
*
msg
const
rtc
:
:
SocketAddress
&
addr
)
;
void
SendErrorResponse
(
const
StunMessage
&
msg
const
rtc
:
:
SocketAddress
&
addr
int
error_code
const
char
*
error_desc
)
;
void
SendResponse
(
const
StunMessage
&
msg
const
rtc
:
:
SocketAddress
&
addr
)
;
void
GetStunBindReqponse
(
StunMessage
*
request
const
rtc
:
:
SocketAddress
&
remote_addr
StunMessage
*
response
)
const
;
private
:
rtc
:
:
scoped_ptr
<
rtc
:
:
AsyncUDPSocket
>
socket_
;
}
;
}
#
endif
