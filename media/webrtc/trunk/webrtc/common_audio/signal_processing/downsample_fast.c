#
include
"
webrtc
/
common_audio
/
signal_processing
/
include
/
signal_processing_library
.
h
"
int
WebRtcSpl_DownsampleFastC
(
const
int16_t
*
data_in
size_t
data_in_length
int16_t
*
data_out
size_t
data_out_length
const
int16_t
*
__restrict
coefficients
size_t
coefficients_length
int
factor
size_t
delay
)
{
size_t
i
=
0
;
size_t
j
=
0
;
int32_t
out_s32
=
0
;
size_t
endpos
=
delay
+
factor
*
(
data_out_length
-
1
)
+
1
;
if
(
data_out_length
=
=
0
|
|
coefficients_length
=
=
0
|
|
data_in_length
<
endpos
)
{
return
-
1
;
}
for
(
i
=
delay
;
i
<
endpos
;
i
+
=
factor
)
{
out_s32
=
2048
;
for
(
j
=
0
;
j
<
coefficients_length
;
j
+
+
)
{
out_s32
+
=
coefficients
[
j
]
*
data_in
[
i
-
j
]
;
}
out_s32
>
>
=
12
;
*
data_out
+
+
=
WebRtcSpl_SatW32ToW16
(
out_s32
)
;
}
return
0
;
}
