#
ifndef
WEBRTC_MODULES_VIDEO_CODING_UTILITY_FRAME_DROPPER_H_
#
define
WEBRTC_MODULES_VIDEO_CODING_UTILITY_FRAME_DROPPER_H_
#
include
<
cstddef
>
#
include
"
webrtc
/
base
/
numerics
/
exp_filter
.
h
"
#
include
"
webrtc
/
typedefs
.
h
"
namespace
webrtc
{
class
FrameDropper
{
public
:
FrameDropper
(
)
;
explicit
FrameDropper
(
float
max_time_drops
)
;
virtual
~
FrameDropper
(
)
{
}
virtual
void
Reset
(
)
;
virtual
void
Enable
(
bool
enable
)
;
virtual
bool
DropFrame
(
)
;
virtual
void
Fill
(
size_t
frameSizeBytes
bool
deltaFrame
)
;
virtual
void
Leak
(
uint32_t
inputFrameRate
)
;
virtual
void
SetRates
(
float
bitRate
float
incoming_frame_rate
)
;
private
:
void
UpdateRatio
(
)
;
void
CapAccumulator
(
)
;
rtc
:
:
ExpFilter
key_frame_ratio_
;
rtc
:
:
ExpFilter
delta_frame_size_avg_kbits_
;
float
large_frame_accumulation_spread_
;
int
large_frame_accumulation_count_
;
float
large_frame_accumulation_chunk_size_
;
float
accumulator_
;
float
accumulator_max_
;
float
target_bitrate_
;
bool
drop_next_
;
rtc
:
:
ExpFilter
drop_ratio_
;
int
drop_count_
;
float
incoming_frame_rate_
;
bool
was_below_max_
;
bool
enabled_
;
const
float
max_drop_duration_secs_
;
}
;
}
#
endif
