#
ifndef
MODULES_REMOTE_BITRATE_ESTIMATOR_AIMD_RATE_CONTROL_H_
#
define
MODULES_REMOTE_BITRATE_ESTIMATOR_AIMD_RATE_CONTROL_H_
#
include
"
modules
/
remote_bitrate_estimator
/
include
/
bwe_defines
.
h
"
#
include
"
rtc_base
/
constructormagic
.
h
"
namespace
webrtc
{
class
AimdRateControl
{
public
:
AimdRateControl
(
)
;
~
AimdRateControl
(
)
;
bool
ValidEstimate
(
)
const
;
void
SetStartBitrate
(
int
start_bitrate_bps
)
;
void
SetMinBitrate
(
int
min_bitrate_bps
)
;
int64_t
GetFeedbackInterval
(
)
const
;
bool
TimeToReduceFurther
(
int64_t
time_now
uint32_t
incoming_bitrate_bps
)
const
;
uint32_t
LatestEstimate
(
)
const
;
void
SetRtt
(
int64_t
rtt
)
;
uint32_t
Update
(
const
RateControlInput
*
input
int64_t
now_ms
)
;
void
SetEstimate
(
int
bitrate_bps
int64_t
now_ms
)
;
int
GetNearMaxIncreaseRateBps
(
)
const
;
int
GetExpectedBandwidthPeriodMs
(
)
const
;
private
:
uint32_t
ChangeBitrate
(
uint32_t
current_bitrate
const
RateControlInput
&
input
int64_t
now_ms
)
;
uint32_t
ClampBitrate
(
uint32_t
new_bitrate_bps
uint32_t
incoming_bitrate_bps
)
const
;
uint32_t
MultiplicativeRateIncrease
(
int64_t
now_ms
int64_t
last_ms
uint32_t
current_bitrate_bps
)
const
;
uint32_t
AdditiveRateIncrease
(
int64_t
now_ms
int64_t
last_ms
)
const
;
void
UpdateChangePeriod
(
int64_t
now_ms
)
;
void
UpdateMaxBitRateEstimate
(
float
incoming_bit_rate_kbps
)
;
void
ChangeState
(
const
RateControlInput
&
input
int64_t
now_ms
)
;
void
ChangeRegion
(
RateControlRegion
region
)
;
uint32_t
min_configured_bitrate_bps_
;
uint32_t
max_configured_bitrate_bps_
;
uint32_t
current_bitrate_bps_
;
float
avg_max_bitrate_kbps_
;
float
var_max_bitrate_kbps_
;
RateControlState
rate_control_state_
;
RateControlRegion
rate_control_region_
;
int64_t
time_last_bitrate_change_
;
int64_t
time_first_incoming_estimate_
;
bool
bitrate_is_initialized_
;
float
beta_
;
int64_t
rtt_
;
bool
in_experiment_
;
bool
smoothing_experiment_
;
rtc
:
:
Optional
<
int
>
last_decrease_
;
}
;
}
#
endif
