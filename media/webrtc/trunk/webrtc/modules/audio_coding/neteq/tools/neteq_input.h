#
ifndef
WEBRTC_MODULES_AUDIO_CODING_NETEQ_TOOLS_NETEQ_INPUT_H_
#
define
WEBRTC_MODULES_AUDIO_CODING_NETEQ_TOOLS_NETEQ_INPUT_H_
#
include
<
algorithm
>
#
include
<
memory
>
#
include
"
webrtc
/
base
/
buffer
.
h
"
#
include
"
webrtc
/
base
/
optional
.
h
"
#
include
"
webrtc
/
modules
/
audio_coding
/
neteq
/
tools
/
packet
.
h
"
#
include
"
webrtc
/
modules
/
audio_coding
/
neteq
/
tools
/
packet_source
.
h
"
#
include
"
webrtc
/
modules
/
include
/
module_common_types
.
h
"
namespace
webrtc
{
namespace
test
{
class
NetEqInput
{
public
:
struct
PacketData
{
WebRtcRTPHeader
header
;
rtc
:
:
Buffer
payload
;
double
time_ms
;
}
;
virtual
~
NetEqInput
(
)
=
default
;
virtual
rtc
:
:
Optional
<
int64_t
>
NextPacketTime
(
)
const
=
0
;
virtual
rtc
:
:
Optional
<
int64_t
>
NextOutputEventTime
(
)
const
=
0
;
rtc
:
:
Optional
<
int64_t
>
NextEventTime
(
)
const
{
const
auto
a
=
NextPacketTime
(
)
;
const
auto
b
=
NextOutputEventTime
(
)
;
if
(
a
)
{
return
b
?
rtc
:
:
Optional
<
int64_t
>
(
std
:
:
min
(
*
a
*
b
)
)
:
a
;
}
return
b
?
b
:
rtc
:
:
Optional
<
int64_t
>
(
)
;
}
virtual
std
:
:
unique_ptr
<
PacketData
>
PopPacket
(
)
=
0
;
virtual
void
AdvanceOutputEvent
(
)
=
0
;
virtual
bool
ended
(
)
const
=
0
;
virtual
rtc
:
:
Optional
<
RTPHeader
>
NextHeader
(
)
const
=
0
;
}
;
}
}
#
endif
