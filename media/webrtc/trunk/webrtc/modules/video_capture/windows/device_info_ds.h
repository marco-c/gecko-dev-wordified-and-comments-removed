#
ifndef
MODULES_VIDEO_CAPTURE_MAIN_SOURCE_WINDOWS_DEVICE_INFO_DS_H_
#
define
MODULES_VIDEO_CAPTURE_MAIN_SOURCE_WINDOWS_DEVICE_INFO_DS_H_
#
include
"
modules
/
video_capture
/
device_info_impl
.
h
"
#
include
"
modules
/
video_capture
/
video_capture_impl
.
h
"
#
include
<
dshow
.
h
>
namespace
webrtc
{
namespace
videocapturemodule
{
struct
VideoCaptureCapabilityWindows
:
public
VideoCaptureCapability
{
uint32_t
directShowCapabilityIndex
;
bool
supportFrameRateControl
;
VideoCaptureCapabilityWindows
(
)
{
directShowCapabilityIndex
=
0
;
supportFrameRateControl
=
false
;
}
}
;
class
DeviceInfoDS
:
public
DeviceInfoImpl
{
public
:
static
DeviceInfoDS
*
Create
(
)
;
DeviceInfoDS
(
)
;
~
DeviceInfoDS
(
)
override
;
int32_t
Init
(
)
override
;
uint32_t
NumberOfDevices
(
)
override
;
int32_t
GetDeviceName
(
uint32_t
deviceNumber
char
*
deviceNameUTF8
uint32_t
deviceNameLength
char
*
deviceUniqueIdUTF8
uint32_t
deviceUniqueIdUTF8Length
char
*
productUniqueIdUTF8
uint32_t
productUniqueIdUTF8Length
pid_t
*
pid
)
override
;
int32_t
DisplayCaptureSettingsDialogBox
(
const
char
*
deviceUniqueIdUTF8
const
char
*
dialogTitleUTF8
void
*
parentWindow
uint32_t
positionX
uint32_t
positionY
)
override
;
IBaseFilter
*
GetDeviceFilter
(
const
char
*
deviceUniqueIdUTF8
char
*
productUniqueIdUTF8
=
NULL
uint32_t
productUniqueIdUTF8Length
=
0
)
;
int32_t
GetWindowsCapability
(
const
int32_t
capabilityIndex
VideoCaptureCapabilityWindows
&
windowsCapability
)
;
static
void
GetProductId
(
const
char
*
devicePath
char
*
productUniqueIdUTF8
uint32_t
productUniqueIdUTF8Length
)
;
protected
:
int32_t
GetDeviceInfo
(
uint32_t
deviceNumber
char
*
deviceNameUTF8
uint32_t
deviceNameLength
char
*
deviceUniqueIdUTF8
uint32_t
deviceUniqueIdUTF8Length
char
*
productUniqueIdUTF8
uint32_t
productUniqueIdUTF8Length
)
;
int32_t
CreateCapabilityMap
(
const
char
*
deviceUniqueIdUTF8
)
override
;
private
:
ICreateDevEnum
*
_dsDevEnum
;
IEnumMoniker
*
_dsMonikerDevEnum
;
bool
_CoUninitializeIsRequired
;
std
:
:
vector
<
VideoCaptureCapabilityWindows
>
_captureCapabilitiesWindows
;
HWND
_hwnd
;
WNDCLASS
_wndClass
;
HINSTANCE
_hInstance
;
HDEVNOTIFY
_hdevnotify
;
}
;
}
}
#
endif
