#
ifndef
WEBRTC_MODULES_DESKTOP_CAPTURE_WIN_DXGI_TEXTURE_STAGING_H_
#
define
WEBRTC_MODULES_DESKTOP_CAPTURE_WIN_DXGI_TEXTURE_STAGING_H_
#
include
<
wrl
/
client
.
h
>
#
include
<
D3D11
.
h
>
#
include
<
DXGI1_2
.
h
>
#
include
"
webrtc
/
modules
/
desktop_capture
/
desktop_geometry
.
h
"
#
include
"
webrtc
/
modules
/
desktop_capture
/
desktop_region
.
h
"
#
include
"
webrtc
/
modules
/
desktop_capture
/
win
/
d3d_device
.
h
"
#
include
"
webrtc
/
modules
/
desktop_capture
/
win
/
dxgi_texture
.
h
"
namespace
webrtc
{
class
DxgiTextureStaging
:
public
DxgiTexture
{
public
:
DxgiTextureStaging
(
const
DesktopSize
&
desktop_size
const
D3dDevice
&
device
)
;
~
DxgiTextureStaging
(
)
override
;
bool
CopyFrom
(
const
DXGI_OUTDUPL_FRAME_INFO
&
frame_info
IDXGIResource
*
resource
)
override
;
bool
DoRelease
(
)
override
;
private
:
bool
InitializeStage
(
ID3D11Texture2D
*
texture
)
;
void
AssertStageAndSurfaceAreSameObject
(
)
;
const
DesktopRect
desktop_rect_
;
const
D3dDevice
device_
;
Microsoft
:
:
WRL
:
:
ComPtr
<
ID3D11Texture2D
>
stage_
;
Microsoft
:
:
WRL
:
:
ComPtr
<
IDXGISurface
>
surface_
;
}
;
}
#
endif
