#
ifndef
WEBRTC_MODULES_AUDIO_DEVICE_ANDROID_AUDIO_RECORD_JNI_H_
#
define
WEBRTC_MODULES_AUDIO_DEVICE_ANDROID_AUDIO_RECORD_JNI_H_
#
include
<
jni
.
h
>
#
include
"
webrtc
/
base
/
thread_checker
.
h
"
#
include
"
webrtc
/
modules
/
audio_device
/
android
/
audio_manager
.
h
"
#
include
"
webrtc
/
modules
/
audio_device
/
include
/
audio_device_defines
.
h
"
#
include
"
webrtc
/
modules
/
audio_device
/
audio_device_generic
.
h
"
#
include
"
webrtc
/
modules
/
utility
/
interface
/
helpers_android
.
h
"
namespace
webrtc
{
class
PlayoutDelayProvider
;
class
AudioRecordJni
{
public
:
static
void
SetAndroidAudioDeviceObjects
(
void
*
jvm
void
*
context
)
;
static
void
ClearAndroidAudioDeviceObjects
(
)
;
AudioRecordJni
(
PlayoutDelayProvider
*
delay_provider
AudioManager
*
audio_manager
)
;
~
AudioRecordJni
(
)
;
int32_t
Init
(
)
;
int32_t
Terminate
(
)
;
int32_t
InitRecording
(
)
;
bool
RecordingIsInitialized
(
)
const
{
return
initialized_
;
}
int32_t
StartRecording
(
)
;
int32_t
StopRecording
(
)
;
bool
Recording
(
)
const
{
return
recording_
;
}
int32_t
RecordingDelay
(
uint16_t
&
delayMS
)
const
;
void
AttachAudioBuffer
(
AudioDeviceBuffer
*
audioBuffer
)
;
bool
BuiltInAECIsAvailable
(
)
const
;
int32_t
EnableBuiltInAEC
(
bool
enable
)
;
int32_t
RecordingDeviceName
(
uint16_t
index
char
name
[
kAdmMaxDeviceNameSize
]
char
guid
[
kAdmMaxGuidSize
]
)
;
private
:
static
void
JNICALL
CacheDirectBufferAddress
(
JNIEnv
*
env
jobject
obj
jobject
byte_buffer
jlong
nativeAudioRecord
)
;
void
OnCacheDirectBufferAddress
(
JNIEnv
*
env
jobject
byte_buffer
)
;
static
void
JNICALL
DataIsRecorded
(
JNIEnv
*
env
jobject
obj
jint
length
jlong
nativeAudioRecord
)
;
void
OnDataIsRecorded
(
int
length
)
;
bool
HasDeviceObjects
(
)
;
void
CreateJavaInstance
(
)
;
rtc
:
:
ThreadChecker
thread_checker_
;
rtc
:
:
ThreadChecker
thread_checker_java_
;
PlayoutDelayProvider
*
delay_provider_
;
const
AudioParameters
audio_parameters_
;
jobject
j_audio_record_
;
void
*
direct_buffer_address_
;
int
direct_buffer_capacity_in_bytes_
;
int
frames_per_buffer_
;
bool
initialized_
;
bool
recording_
;
AudioDeviceBuffer
*
audio_device_buffer_
;
int
playout_delay_in_milliseconds_
;
}
;
}
#
endif
