#
ifndef
WEBRTC_MODULES_AUDIO_DEVICE_ANDROID_AUDIO_MANAGER_H_
#
define
WEBRTC_MODULES_AUDIO_DEVICE_ANDROID_AUDIO_MANAGER_H_
#
include
<
jni
.
h
>
#
include
"
webrtc
/
base
/
scoped_ptr
.
h
"
#
include
"
webrtc
/
base
/
thread_checker
.
h
"
#
include
"
webrtc
/
modules
/
audio_device
/
android
/
audio_common
.
h
"
#
include
"
webrtc
/
modules
/
audio_device
/
audio_device_config
.
h
"
#
include
"
webrtc
/
modules
/
audio_device
/
include
/
audio_device_defines
.
h
"
#
include
"
webrtc
/
modules
/
audio_device
/
audio_device_generic
.
h
"
#
include
"
webrtc
/
modules
/
utility
/
include
/
helpers_android
.
h
"
#
include
"
webrtc
/
modules
/
utility
/
include
/
jvm_android
.
h
"
namespace
webrtc
{
class
AudioManager
{
public
:
class
JavaAudioManager
{
public
:
JavaAudioManager
(
NativeRegistration
*
native_registration
rtc
:
:
scoped_ptr
<
GlobalRef
>
audio_manager
)
;
~
JavaAudioManager
(
)
;
bool
Init
(
)
;
void
Close
(
)
;
bool
IsCommunicationModeEnabled
(
)
;
bool
IsDeviceBlacklistedForOpenSLESUsage
(
)
;
private
:
rtc
:
:
scoped_ptr
<
GlobalRef
>
audio_manager_
;
jmethodID
init_
;
jmethodID
dispose_
;
jmethodID
is_communication_mode_enabled_
;
jmethodID
is_device_blacklisted_for_open_sles_usage_
;
}
;
AudioManager
(
)
;
~
AudioManager
(
)
;
void
SetActiveAudioLayer
(
AudioDeviceModule
:
:
AudioLayer
audio_layer
)
;
bool
Init
(
)
;
bool
Close
(
)
;
bool
IsCommunicationModeEnabled
(
)
const
;
const
AudioParameters
&
GetPlayoutAudioParameters
(
)
;
const
AudioParameters
&
GetRecordAudioParameters
(
)
;
bool
IsAcousticEchoCancelerSupported
(
)
const
;
bool
IsAutomaticGainControlSupported
(
)
const
;
bool
IsNoiseSuppressorSupported
(
)
const
;
bool
IsLowLatencyPlayoutSupported
(
)
const
;
int
GetDelayEstimateInMilliseconds
(
)
const
;
private
:
static
void
JNICALL
CacheAudioParameters
(
JNIEnv
*
env
jobject
obj
jint
sample_rate
jint
channels
jboolean
hardware_aec
jboolean
hardware_agc
jboolean
hardware_ns
jboolean
low_latency_output
jint
output_buffer_size
jint
input_buffer_size
jlong
native_audio_manager
)
;
void
OnCacheAudioParameters
(
JNIEnv
*
env
jint
sample_rate
jint
channels
jboolean
hardware_aec
jboolean
hardware_agc
jboolean
hardware_ns
jboolean
low_latency_output
jint
output_buffer_size
jint
input_buffer_size
)
;
rtc
:
:
ThreadChecker
thread_checker_
;
AttachCurrentThreadIfNeeded
attach_thread_if_needed_
;
rtc
:
:
scoped_ptr
<
JNIEnvironment
>
j_environment_
;
rtc
:
:
scoped_ptr
<
NativeRegistration
>
j_native_registration_
;
rtc
:
:
scoped_ptr
<
AudioManager
:
:
JavaAudioManager
>
j_audio_manager_
;
AudioDeviceModule
:
:
AudioLayer
audio_layer_
;
bool
initialized_
;
bool
hardware_aec_
;
bool
hardware_agc_
;
bool
hardware_ns_
;
bool
low_latency_playout_
;
int
delay_estimate_in_milliseconds_
;
AudioParameters
playout_parameters_
;
AudioParameters
record_parameters_
;
}
;
}
#
endif
