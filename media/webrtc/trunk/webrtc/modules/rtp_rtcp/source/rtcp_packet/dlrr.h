#
ifndef
MODULES_RTP_RTCP_SOURCE_RTCP_PACKET_DLRR_H_
#
define
MODULES_RTP_RTCP_SOURCE_RTCP_PACKET_DLRR_H_
#
include
<
vector
>
#
include
"
rtc_base
/
basictypes
.
h
"
namespace
webrtc
{
namespace
rtcp
{
struct
ReceiveTimeInfo
{
ReceiveTimeInfo
(
)
:
ssrc
(
0
)
last_rr
(
0
)
delay_since_last_rr
(
0
)
{
}
ReceiveTimeInfo
(
uint32_t
ssrc
uint32_t
last_rr
uint32_t
delay
)
:
ssrc
(
ssrc
)
last_rr
(
last_rr
)
delay_since_last_rr
(
delay
)
{
}
uint32_t
ssrc
;
uint32_t
last_rr
;
uint32_t
delay_since_last_rr
;
}
;
class
Dlrr
{
public
:
static
const
uint8_t
kBlockType
=
5
;
Dlrr
(
)
;
Dlrr
(
const
Dlrr
&
other
)
;
~
Dlrr
(
)
;
Dlrr
&
operator
=
(
const
Dlrr
&
other
)
=
default
;
explicit
operator
bool
(
)
const
{
return
!
sub_blocks_
.
empty
(
)
;
}
bool
Parse
(
const
uint8_t
*
buffer
uint16_t
block_length_32bits
)
;
size_t
BlockLength
(
)
const
;
void
Create
(
uint8_t
*
buffer
)
const
;
void
ClearItems
(
)
{
sub_blocks_
.
clear
(
)
;
}
void
AddDlrrItem
(
const
ReceiveTimeInfo
&
time_info
)
{
sub_blocks_
.
push_back
(
time_info
)
;
}
const
std
:
:
vector
<
ReceiveTimeInfo
>
&
sub_blocks
(
)
const
{
return
sub_blocks_
;
}
private
:
static
const
size_t
kBlockHeaderLength
=
4
;
static
const
size_t
kSubBlockLength
=
12
;
std
:
:
vector
<
ReceiveTimeInfo
>
sub_blocks_
;
}
;
}
}
#
endif
