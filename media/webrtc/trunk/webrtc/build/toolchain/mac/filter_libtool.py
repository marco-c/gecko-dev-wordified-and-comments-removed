import
os
import
re
import
subprocess
import
sys
def
Main
(
cmd_list
)
:
  
libtool_re
=
re
.
compile
(
r
'
^
.
*
libtool
:
(
?
:
for
architecture
:
\
S
*
)
?
'
                          
r
'
file
:
.
*
has
no
symbols
'
)
  
libtool_re5
=
re
.
compile
(
      
r
'
^
.
*
libtool
:
warning
for
library
:
'
+
      
r
'
.
*
the
table
of
contents
is
empty
'
+
      
r
'
\
(
no
object
file
members
in
the
library
define
global
symbols
\
)
'
)
  
env
=
os
.
environ
.
copy
(
)
  
env
[
'
ZERO_AR_DATE
'
]
=
'
1
'
  
libtoolout
=
subprocess
.
Popen
(
cmd_list
stderr
=
subprocess
.
PIPE
env
=
env
)
  
_
err
=
libtoolout
.
communicate
(
)
  
for
line
in
err
.
splitlines
(
)
:
    
if
not
libtool_re
.
match
(
line
)
and
not
libtool_re5
.
match
(
line
)
:
      
print
>
>
sys
.
stderr
line
  
if
not
libtoolout
.
returncode
:
    
for
i
in
range
(
len
(
cmd_list
)
-
1
)
:
      
if
cmd_list
[
i
]
=
=
'
-
o
'
and
cmd_list
[
i
+
1
]
.
endswith
(
'
.
a
'
)
:
        
os
.
utime
(
cmd_list
[
i
+
1
]
None
)
        
break
  
return
libtoolout
.
returncode
if
__name__
=
=
'
__main__
'
:
  
sys
.
exit
(
Main
(
sys
.
argv
[
1
:
]
)
)
