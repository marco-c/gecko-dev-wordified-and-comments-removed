#
include
"
rtc_base
/
fakeclock
.
h
"
#
include
"
rtc_base
/
checks
.
h
"
#
include
"
rtc_base
/
messagequeue
.
h
"
namespace
rtc
{
int64_t
FakeClock
:
:
TimeNanos
(
)
const
{
CritScope
cs
(
&
lock_
)
;
return
time_
;
}
void
FakeClock
:
:
SetTimeNanos
(
int64_t
nanos
)
{
{
CritScope
cs
(
&
lock_
)
;
RTC_DCHECK
(
nanos
>
=
time_
)
;
time_
=
nanos
;
}
MessageQueueManager
:
:
ProcessAllMessageQueues
(
)
;
}
void
FakeClock
:
:
AdvanceTime
(
TimeDelta
delta
)
{
{
CritScope
cs
(
&
lock_
)
;
time_
+
=
delta
.
ToNanoseconds
(
)
;
}
MessageQueueManager
:
:
ProcessAllMessageQueues
(
)
;
}
ScopedFakeClock
:
:
ScopedFakeClock
(
)
{
prev_clock_
=
SetClockForTesting
(
this
)
;
}
ScopedFakeClock
:
:
~
ScopedFakeClock
(
)
{
SetClockForTesting
(
prev_clock_
)
;
}
}
