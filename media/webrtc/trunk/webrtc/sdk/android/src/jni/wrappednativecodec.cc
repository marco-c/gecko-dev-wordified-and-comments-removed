#
include
"
sdk
/
android
/
src
/
jni
/
wrappednativecodec
.
h
"
#
include
"
sdk
/
android
/
generated_video_jni
/
jni
/
WrappedNativeVideoDecoder_jni
.
h
"
#
include
"
sdk
/
android
/
generated_video_jni
/
jni
/
WrappedNativeVideoEncoder_jni
.
h
"
#
include
"
sdk
/
android
/
src
/
jni
/
class_loader
.
h
"
#
include
"
sdk
/
android
/
src
/
jni
/
jni_helpers
.
h
"
#
include
"
sdk
/
android
/
src
/
jni
/
videodecoderwrapper
.
h
"
#
include
"
sdk
/
android
/
src
/
jni
/
videoencoderwrapper
.
h
"
namespace
webrtc
{
namespace
jni
{
std
:
:
unique_ptr
<
VideoDecoder
>
JavaToNativeVideoDecoder
(
JNIEnv
*
jni
jobject
j_decoder
)
{
jclass
wrapped_native_decoder_class
=
GetClass
(
jni
"
org
/
webrtc
/
WrappedNativeVideoDecoder
"
)
;
VideoDecoder
*
decoder
;
if
(
jni
-
>
IsInstanceOf
(
j_decoder
wrapped_native_decoder_class
)
)
{
jlong
native_decoder
=
Java_WrappedNativeVideoDecoder_createNativeDecoder
(
jni
j_decoder
)
;
decoder
=
reinterpret_cast
<
VideoDecoder
*
>
(
native_decoder
)
;
}
else
{
decoder
=
new
VideoDecoderWrapper
(
jni
j_decoder
)
;
}
return
std
:
:
unique_ptr
<
VideoDecoder
>
(
decoder
)
;
}
std
:
:
unique_ptr
<
VideoEncoder
>
JavaToNativeVideoEncoder
(
JNIEnv
*
jni
jobject
j_encoder
)
{
VideoEncoder
*
encoder
;
if
(
Java_WrappedNativeVideoEncoder_isInstanceOf
(
jni
j_encoder
)
)
{
jlong
native_encoder
=
Java_WrappedNativeVideoEncoder_createNativeEncoder
(
jni
j_encoder
)
;
encoder
=
reinterpret_cast
<
VideoEncoder
*
>
(
native_encoder
)
;
}
else
{
encoder
=
new
VideoEncoderWrapper
(
jni
j_encoder
)
;
}
return
std
:
:
unique_ptr
<
VideoEncoder
>
(
encoder
)
;
}
bool
IsWrappedSoftwareEncoder
(
JNIEnv
*
jni
jobject
j_encoder
)
{
return
Java_WrappedNativeVideoEncoder_isWrappedSoftwareEncoder
(
jni
j_encoder
)
;
}
}
}
