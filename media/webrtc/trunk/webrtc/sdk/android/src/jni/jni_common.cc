#
include
"
rtc_base
/
refcount
.
h
"
#
include
"
sdk
/
android
/
src
/
jni
/
jni_helpers
.
h
"
namespace
webrtc
{
namespace
jni
{
JNI_FUNCTION_DECLARATION
(
void
JniCommon_nativeAddRef
JNIEnv
*
jni
jclass
jlong
j_native_ref_counted_pointer
)
{
reinterpret_cast
<
rtc
:
:
RefCountInterface
*
>
(
j_native_ref_counted_pointer
)
-
>
AddRef
(
)
;
}
JNI_FUNCTION_DECLARATION
(
void
JniCommon_nativeReleaseRef
JNIEnv
*
jni
jclass
jlong
j_native_ref_counted_pointer
)
{
reinterpret_cast
<
rtc
:
:
RefCountInterface
*
>
(
j_native_ref_counted_pointer
)
-
>
Release
(
)
;
}
JNI_FUNCTION_DECLARATION
(
jobject
JniCommon_allocateNativeByteBuffer
JNIEnv
*
jni
jclass
jint
size
)
{
void
*
new_data
=
:
:
operator
new
(
size
)
;
jobject
byte_buffer
=
jni
-
>
NewDirectByteBuffer
(
new_data
size
)
;
return
byte_buffer
;
}
JNI_FUNCTION_DECLARATION
(
void
JniCommon_freeNativeByteBuffer
JNIEnv
*
jni
jclass
jobject
byte_buffer
)
{
void
*
data
=
jni
-
>
GetDirectBufferAddress
(
byte_buffer
)
;
:
:
operator
delete
(
data
)
;
}
}
}
