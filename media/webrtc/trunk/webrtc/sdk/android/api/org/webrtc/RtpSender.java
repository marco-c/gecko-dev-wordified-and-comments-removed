package
org
.
webrtc
;
public
class
RtpSender
{
final
long
nativeRtpSender
;
private
MediaStreamTrack
cachedTrack
;
private
boolean
ownsTrack
=
true
;
private
final
DtmfSender
dtmfSender
;
public
RtpSender
(
long
nativeRtpSender
)
{
this
.
nativeRtpSender
=
nativeRtpSender
;
long
track
=
nativeGetTrack
(
nativeRtpSender
)
;
cachedTrack
=
(
track
!
=
0
)
?
new
MediaStreamTrack
(
track
)
:
null
;
long
nativeDtmfSender
=
nativeGetDtmfSender
(
nativeRtpSender
)
;
dtmfSender
=
(
nativeDtmfSender
!
=
0
)
?
new
DtmfSender
(
nativeDtmfSender
)
:
null
;
}
public
boolean
setTrack
(
MediaStreamTrack
track
boolean
takeOwnership
)
{
if
(
!
nativeSetTrack
(
nativeRtpSender
(
track
=
=
null
)
?
0
:
track
.
nativeTrack
)
)
{
return
false
;
}
if
(
cachedTrack
!
=
null
&
&
ownsTrack
)
{
cachedTrack
.
dispose
(
)
;
}
cachedTrack
=
track
;
ownsTrack
=
takeOwnership
;
return
true
;
}
public
MediaStreamTrack
track
(
)
{
return
cachedTrack
;
}
public
boolean
setParameters
(
RtpParameters
parameters
)
{
return
nativeSetParameters
(
nativeRtpSender
parameters
)
;
}
public
RtpParameters
getParameters
(
)
{
return
nativeGetParameters
(
nativeRtpSender
)
;
}
public
String
id
(
)
{
return
nativeId
(
nativeRtpSender
)
;
}
public
DtmfSender
dtmf
(
)
{
return
dtmfSender
;
}
public
void
dispose
(
)
{
if
(
dtmfSender
!
=
null
)
{
dtmfSender
.
dispose
(
)
;
}
if
(
cachedTrack
!
=
null
&
&
ownsTrack
)
{
cachedTrack
.
dispose
(
)
;
}
JniCommon
.
nativeReleaseRef
(
nativeRtpSender
)
;
}
private
static
native
boolean
nativeSetTrack
(
long
nativeRtpSender
long
nativeTrack
)
;
private
static
native
long
nativeGetTrack
(
long
nativeRtpSender
)
;
private
static
native
long
nativeGetDtmfSender
(
long
nativeRtpSender
)
;
private
static
native
boolean
nativeSetParameters
(
long
nativeRtpSender
RtpParameters
parameters
)
;
private
static
native
RtpParameters
nativeGetParameters
(
long
nativeRtpSender
)
;
private
static
native
String
nativeId
(
long
nativeRtpSender
)
;
}
;
