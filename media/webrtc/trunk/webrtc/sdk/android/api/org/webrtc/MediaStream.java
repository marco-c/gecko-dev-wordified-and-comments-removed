package
org
.
webrtc
;
import
java
.
util
.
LinkedList
;
public
class
MediaStream
{
public
final
LinkedList
<
AudioTrack
>
audioTracks
;
public
final
LinkedList
<
VideoTrack
>
videoTracks
;
public
final
LinkedList
<
VideoTrack
>
preservedVideoTracks
;
final
long
nativeStream
;
public
MediaStream
(
long
nativeStream
)
{
audioTracks
=
new
LinkedList
<
AudioTrack
>
(
)
;
videoTracks
=
new
LinkedList
<
VideoTrack
>
(
)
;
preservedVideoTracks
=
new
LinkedList
<
VideoTrack
>
(
)
;
this
.
nativeStream
=
nativeStream
;
}
public
boolean
addTrack
(
AudioTrack
track
)
{
if
(
nativeAddAudioTrack
(
nativeStream
track
.
nativeTrack
)
)
{
audioTracks
.
add
(
track
)
;
return
true
;
}
return
false
;
}
public
boolean
addTrack
(
VideoTrack
track
)
{
if
(
nativeAddVideoTrack
(
nativeStream
track
.
nativeTrack
)
)
{
videoTracks
.
add
(
track
)
;
return
true
;
}
return
false
;
}
public
boolean
addPreservedTrack
(
VideoTrack
track
)
{
if
(
nativeAddVideoTrack
(
nativeStream
track
.
nativeTrack
)
)
{
preservedVideoTracks
.
add
(
track
)
;
return
true
;
}
return
false
;
}
public
boolean
removeTrack
(
AudioTrack
track
)
{
audioTracks
.
remove
(
track
)
;
return
nativeRemoveAudioTrack
(
nativeStream
track
.
nativeTrack
)
;
}
public
boolean
removeTrack
(
VideoTrack
track
)
{
videoTracks
.
remove
(
track
)
;
preservedVideoTracks
.
remove
(
track
)
;
return
nativeRemoveVideoTrack
(
nativeStream
track
.
nativeTrack
)
;
}
public
void
dispose
(
)
{
while
(
!
audioTracks
.
isEmpty
(
)
)
{
AudioTrack
track
=
audioTracks
.
getFirst
(
)
;
removeTrack
(
track
)
;
track
.
dispose
(
)
;
}
while
(
!
videoTracks
.
isEmpty
(
)
)
{
VideoTrack
track
=
videoTracks
.
getFirst
(
)
;
removeTrack
(
track
)
;
track
.
dispose
(
)
;
}
while
(
!
preservedVideoTracks
.
isEmpty
(
)
)
{
removeTrack
(
preservedVideoTracks
.
getFirst
(
)
)
;
}
free
(
nativeStream
)
;
}
public
String
label
(
)
{
return
nativeLabel
(
nativeStream
)
;
}
public
String
toString
(
)
{
return
"
[
"
+
label
(
)
+
"
:
A
=
"
+
audioTracks
.
size
(
)
+
"
:
V
=
"
+
videoTracks
.
size
(
)
+
"
]
"
;
}
private
static
native
boolean
nativeAddAudioTrack
(
long
nativeStream
long
nativeAudioTrack
)
;
private
static
native
boolean
nativeAddVideoTrack
(
long
nativeStream
long
nativeVideoTrack
)
;
private
static
native
boolean
nativeRemoveAudioTrack
(
long
nativeStream
long
nativeAudioTrack
)
;
private
static
native
boolean
nativeRemoveVideoTrack
(
long
nativeStream
long
nativeVideoTrack
)
;
private
static
native
String
nativeLabel
(
long
nativeStream
)
;
private
static
native
void
free
(
long
nativeStream
)
;
}
