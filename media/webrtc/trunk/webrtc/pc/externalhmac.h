#
ifndef
WEBRTC_PC_EXTERNALHMAC_H_
#
define
WEBRTC_PC_EXTERNALHMAC_H_
#
include
<
stdint
.
h
>
#
ifdef
HAVE_SRTP
#
include
"
third_party
/
libsrtp
/
crypto
/
include
/
auth
.
h
"
#
endif
#
if
defined
(
HAVE_SRTP
)
&
&
defined
(
ENABLE_EXTERNAL_AUTH
)
#
define
EXTERNAL_HMAC_SHA1
SRTP_HMAC_SHA1
+
1
#
define
HMAC_KEY_LENGTH
20
typedef
struct
{
uint8_t
key
[
HMAC_KEY_LENGTH
]
;
int
key_length
;
}
ExternalHmacContext
;
srtp_err_status_t
external_hmac_alloc
(
srtp_auth_t
*
*
a
int
key_len
int
out_len
)
;
srtp_err_status_t
external_hmac_dealloc
(
srtp_auth_t
*
a
)
;
srtp_err_status_t
external_hmac_init
(
ExternalHmacContext
*
state
const
uint8_t
*
key
int
key_len
)
;
srtp_err_status_t
external_hmac_start
(
ExternalHmacContext
*
state
)
;
srtp_err_status_t
external_hmac_update
(
ExternalHmacContext
*
state
const
uint8_t
*
message
int
msg_octets
)
;
srtp_err_status_t
external_hmac_compute
(
ExternalHmacContext
*
state
const
void
*
message
int
msg_octets
int
tag_len
uint8_t
*
result
)
;
srtp_err_status_t
external_crypto_init
(
)
;
#
endif
#
endif
