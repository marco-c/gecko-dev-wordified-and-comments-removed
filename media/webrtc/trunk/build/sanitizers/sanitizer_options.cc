#
include
"
build
/
build_config
.
h
"
#
if
defined
(
ADDRESS_SANITIZER
)
&
&
defined
(
OS_MACOSX
)
#
include
<
crt_externs
.
h
>
#
include
<
string
.
h
>
#
endif
#
if
defined
(
ADDRESS_SANITIZER
)
|
|
defined
(
LEAK_SANITIZER
)
|
|
\
defined
(
MEMORY_SANITIZER
)
|
|
defined
(
THREAD_SANITIZER
)
|
|
\
defined
(
UNDEFINED_SANITIZER
)
extern
"
C
"
void
_sanitizer_options_link_helper
(
)
{
}
#
define
SANITIZER_HOOK_ATTRIBUTE
\
extern
"
C
"
\
__attribute__
(
(
no_sanitize
(
"
address
"
"
memory
"
"
thread
"
"
undefined
"
)
)
)
\
__attribute__
(
(
visibility
(
"
default
"
)
)
)
\
__attribute__
(
(
used
)
)
#
endif
#
if
defined
(
ADDRESS_SANITIZER
)
#
if
defined
(
OS_LINUX
)
#
if
defined
(
GOOGLE_CHROME_BUILD
)
const
char
kAsanDefaultOptions
[
]
=
"
legacy_pthread_cond
=
1
malloc_context_size
=
5
"
"
symbolize
=
1
check_printf
=
1
use_sigaltstack
=
1
detect_leaks
=
0
"
"
strip_path_prefix
=
/
.
.
/
.
.
/
fast_unwind_on_fatal
=
1
"
"
allow_user_segv_handler
=
1
"
;
#
else
const
char
*
kAsanDefaultOptions
=
"
symbolize
=
1
check_printf
=
1
use_sigaltstack
=
1
"
"
detect_leaks
=
0
strip_path_prefix
=
/
.
.
/
.
.
/
fast_unwind_on_fatal
=
1
"
"
detect_stack_use_after_return
=
1
"
"
allow_user_segv_handler
=
1
"
;
#
endif
#
elif
defined
(
OS_MACOSX
)
const
char
*
kAsanDefaultOptions
=
"
check_printf
=
1
use_sigaltstack
=
1
"
"
strip_path_prefix
=
/
.
.
/
.
.
/
fast_unwind_on_fatal
=
1
"
"
detect_stack_use_after_return
=
1
detect_odr_violation
=
0
"
;
#
endif
#
if
defined
(
OS_LINUX
)
|
|
defined
(
OS_MACOSX
)
extern
const
char
*
kAsanDefaultOptionsNaCl
;
__attribute__
(
(
weak
)
)
const
char
*
kAsanDefaultOptionsNaCl
=
nullptr
;
SANITIZER_HOOK_ATTRIBUTE
const
char
*
__asan_default_options
(
)
{
if
(
kAsanDefaultOptionsNaCl
)
return
kAsanDefaultOptionsNaCl
;
return
kAsanDefaultOptions
;
}
extern
char
kASanDefaultSuppressions
[
]
;
SANITIZER_HOOK_ATTRIBUTE
const
char
*
__asan_default_suppressions
(
)
{
return
kASanDefaultSuppressions
;
}
#
endif
#
endif
#
if
defined
(
THREAD_SANITIZER
)
&
&
defined
(
OS_LINUX
)
const
char
kTsanDefaultOptions
[
]
=
"
detect_deadlocks
=
1
second_deadlock_stack
=
1
report_signal_unsafe
=
0
"
"
report_thread_leaks
=
0
print_suppressions
=
1
history_size
=
7
"
"
strict_memcmp
=
0
strip_path_prefix
=
/
.
.
/
.
.
/
"
;
SANITIZER_HOOK_ATTRIBUTE
const
char
*
__tsan_default_options
(
)
{
return
kTsanDefaultOptions
;
}
extern
char
kTSanDefaultSuppressions
[
]
;
SANITIZER_HOOK_ATTRIBUTE
const
char
*
__tsan_default_suppressions
(
)
{
return
kTSanDefaultSuppressions
;
}
#
endif
#
if
defined
(
MEMORY_SANITIZER
)
const
char
kMsanDefaultOptions
[
]
=
"
intercept_memcmp
=
0
strip_path_prefix
=
/
.
.
/
.
.
/
"
;
SANITIZER_HOOK_ATTRIBUTE
const
char
*
__msan_default_options
(
)
{
return
kMsanDefaultOptions
;
}
#
endif
#
if
defined
(
LEAK_SANITIZER
)
const
char
kLsanDefaultOptions
[
]
=
"
print_suppressions
=
1
strip_path_prefix
=
/
.
.
/
.
.
/
"
;
SANITIZER_HOOK_ATTRIBUTE
const
char
*
__lsan_default_options
(
)
{
return
kLsanDefaultOptions
;
}
extern
char
kLSanDefaultSuppressions
[
]
;
SANITIZER_HOOK_ATTRIBUTE
const
char
*
__lsan_default_suppressions
(
)
{
return
kLSanDefaultSuppressions
;
}
#
endif
#
if
defined
(
UNDEFINED_SANITIZER
)
const
char
kUbsanDefaultOptions
[
]
=
"
print_stacktrace
=
1
strip_path_prefix
=
/
.
.
/
.
.
/
"
;
SANITIZER_HOOK_ATTRIBUTE
const
char
*
__ubsan_default_options
(
)
{
return
kUbsanDefaultOptions
;
}
#
endif
