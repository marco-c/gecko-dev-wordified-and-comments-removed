#
ifndef
mtransport_test_utils_h__
#
define
mtransport_test_utils_h__
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsNetCID
.
h
"
#
include
"
nsIEventTarget
.
h
"
#
include
"
nsPISocketTransportService
.
h
"
#
include
"
nsServiceManagerUtils
.
h
"
class
MtransportTestUtils
{
public
:
MtransportTestUtils
(
)
{
InitServices
(
)
;
}
~
MtransportTestUtils
(
)
{
}
void
InitServices
(
)
{
nsresult
rv
;
sts_target_
=
do_GetService
(
NS_SOCKETTRANSPORTSERVICE_CONTRACTID
&
rv
)
;
MOZ_ASSERT
(
NS_SUCCEEDED
(
rv
)
)
;
sts_
=
do_GetService
(
NS_SOCKETTRANSPORTSERVICE_CONTRACTID
&
rv
)
;
MOZ_ASSERT
(
NS_SUCCEEDED
(
rv
)
)
;
}
nsCOMPtr
<
nsIEventTarget
>
sts_target
(
)
{
return
sts_target_
;
}
private
:
nsCOMPtr
<
nsIEventTarget
>
sts_target_
;
nsCOMPtr
<
nsPISocketTransportService
>
sts_
;
}
;
#
define
CHECK_ENVIRONMENT_FLAG
(
envname
)
\
char
*
test_flag
=
getenv
(
envname
)
;
\
if
(
!
test_flag
|
|
strcmp
(
test_flag
"
1
"
)
)
{
\
printf
(
"
To
run
this
test
set
%
s
=
1
in
your
environment
\
n
"
envname
)
;
\
exit
(
0
)
;
\
}
\
#
endif
