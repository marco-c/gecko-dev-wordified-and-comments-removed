#
include
<
nr_api
.
h
>
#
include
<
string
.
h
>
#
include
"
local_addr
.
h
"
int
nr_local_addr_copy
(
nr_local_addr
*
to
nr_local_addr
*
from
)
{
int
r
_status
;
if
(
r
=
nr_transport_addr_copy
(
&
(
to
-
>
addr
)
&
(
from
-
>
addr
)
)
)
{
ABORT
(
r
)
;
}
to
-
>
interface
=
from
-
>
interface
;
to
-
>
flags
=
from
-
>
flags
;
_status
=
0
;
abort
:
return
(
_status
)
;
}
int
nr_local_addr_fmt_info_string
(
nr_local_addr
*
addr
char
*
buf
int
len
)
{
int
addr_type
=
addr
-
>
interface
.
type
;
const
char
*
vpn
=
(
addr_type
&
NR_INTERFACE_TYPE_VPN
)
?
"
VPN
on
"
:
"
"
;
const
char
*
type
=
(
addr_type
&
NR_INTERFACE_TYPE_WIRED
)
?
"
wired
"
:
(
addr_type
&
NR_INTERFACE_TYPE_WIFI
)
?
"
wifi
"
:
(
addr_type
&
NR_INTERFACE_TYPE_MOBILE
)
?
"
mobile
"
:
"
unknown
"
;
snprintf
(
buf
len
"
%
s
%
s
estimated
speed
:
%
d
kbps
%
s
"
vpn
type
addr
-
>
interface
.
estimated_speed
(
addr
-
>
flags
&
NR_ADDR_FLAG_TEMPORARY
?
"
temporary
"
:
"
"
)
)
;
buf
[
len
-
1
]
=
'
\
0
'
;
return
(
0
)
;
}
