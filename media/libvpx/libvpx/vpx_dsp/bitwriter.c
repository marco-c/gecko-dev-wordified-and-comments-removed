#
include
<
assert
.
h
>
#
include
"
.
/
bitwriter
.
h
"
#
if
CONFIG_BITSTREAM_DEBUG
#
include
"
vpx_util
/
vpx_debug_util
.
h
"
#
endif
void
vpx_start_encode
(
vpx_writer
*
br
uint8_t
*
source
)
{
br
-
>
lowvalue
=
0
;
br
-
>
range
=
255
;
br
-
>
count
=
-
24
;
br
-
>
buffer
=
source
;
br
-
>
pos
=
0
;
vpx_write_bit
(
br
0
)
;
}
void
vpx_stop_encode
(
vpx_writer
*
br
)
{
int
i
;
#
if
CONFIG_BITSTREAM_DEBUG
bitstream_queue_set_skip_write
(
1
)
;
#
endif
for
(
i
=
0
;
i
<
32
;
i
+
+
)
vpx_write_bit
(
br
0
)
;
if
(
(
br
-
>
buffer
[
br
-
>
pos
-
1
]
&
0xe0
)
=
=
0xc0
)
br
-
>
buffer
[
br
-
>
pos
+
+
]
=
0
;
#
if
CONFIG_BITSTREAM_DEBUG
bitstream_queue_set_skip_write
(
0
)
;
#
endif
}
