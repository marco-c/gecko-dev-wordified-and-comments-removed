#
include
<
stdlib
.
h
>
#
include
"
.
/
vpx_config
.
h
"
#
include
"
.
/
vpx_dsp_rtcd
.
h
"
#
include
"
vpx
/
vpx_integer
.
h
"
#
include
"
vpx_ports
/
mem
.
h
"
void
vpx_plane_add_noise_c
(
uint8_t
*
start
char
*
noise
char
blackclamp
[
16
]
char
whiteclamp
[
16
]
char
bothclamp
[
16
]
unsigned
int
width
unsigned
int
height
int
pitch
)
{
unsigned
int
i
j
;
for
(
i
=
0
;
i
<
height
;
i
+
+
)
{
uint8_t
*
pos
=
start
+
i
*
pitch
;
char
*
ref
=
(
char
*
)
(
noise
+
(
rand
(
)
&
0xff
)
)
;
for
(
j
=
0
;
j
<
width
;
j
+
+
)
{
int
v
=
pos
[
j
]
;
v
=
clamp
(
v
-
blackclamp
[
0
]
0
255
)
;
v
=
clamp
(
v
+
bothclamp
[
0
]
0
255
)
;
v
=
clamp
(
v
-
whiteclamp
[
0
]
0
255
)
;
pos
[
j
]
=
v
+
ref
[
j
]
;
}
}
}
