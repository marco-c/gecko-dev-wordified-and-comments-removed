import
os
def
_RunPythonTests
(
input_api
output_api
)
:
  
def
join
(
*
args
)
:
    
return
input_api
.
os_path
.
join
(
input_api
.
PresubmitLocalPath
(
)
*
args
)
  
test_directories
=
[
      
root
for
root
_
files
in
os
.
walk
(
join
(
'
tools_libyuv
'
)
)
      
if
any
(
f
.
endswith
(
'
_test
.
py
'
)
for
f
in
files
)
  
]
  
tests
=
[
]
  
for
directory
in
test_directories
:
    
tests
.
extend
(
      
input_api
.
canned_checks
.
GetUnitTestsInDirectory
(
          
input_api
          
output_api
          
directory
          
whitelist
=
[
r
'
.
+
_test
\
.
py
'
]
)
)
  
return
input_api
.
RunTests
(
tests
parallel
=
True
)
def
_CommonChecks
(
input_api
output_api
)
:
  
"
"
"
Checks
common
to
both
upload
and
commit
.
"
"
"
  
results
=
[
]
  
results
.
extend
(
input_api
.
canned_checks
.
RunPylint
(
input_api
output_api
      
black_list
=
(
r
'
^
base
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
build
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
buildtools
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
ios
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
out
.
*
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
testing
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
third_party
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
tools
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
tools_libyuv
[
\
\
\
/
]
valgrind
[
\
\
\
/
]
.
*
\
.
py
'
                  
r
'
^
xcodebuild
.
*
[
\
\
\
/
]
.
*
\
.
py
'
)
      
disabled_warnings
=
[
'
F0401
'
                         
'
E0611
'
                         
'
W0232
'
                        
]
      
pylintrc
=
'
pylintrc
'
)
)
  
results
.
extend
(
_RunPythonTests
(
input_api
output_api
)
)
  
return
results
def
CheckChangeOnUpload
(
input_api
output_api
)
:
  
results
=
[
]
  
results
.
extend
(
_CommonChecks
(
input_api
output_api
)
)
  
results
.
extend
(
      
input_api
.
canned_checks
.
CheckGNFormatted
(
input_api
output_api
)
)
  
return
results
def
CheckChangeOnCommit
(
input_api
output_api
)
:
  
results
=
[
]
  
results
.
extend
(
_CommonChecks
(
input_api
output_api
)
)
  
results
.
extend
(
input_api
.
canned_checks
.
CheckOwners
(
input_api
output_api
)
)
  
results
.
extend
(
input_api
.
canned_checks
.
CheckChangeWasUploaded
(
      
input_api
output_api
)
)
  
results
.
extend
(
input_api
.
canned_checks
.
CheckChangeHasDescription
(
      
input_api
output_api
)
)
  
return
results
