#
ifndef
WEBP_DSP_DSP_H_
#
define
WEBP_DSP_DSP_H_
#
ifdef
HAVE_CONFIG_H
#
include
"
src
/
webp
/
config
.
h
"
#
endif
#
include
"
src
/
webp
/
types
.
h
"
#
ifdef
__cplusplus
extern
"
C
"
{
#
endif
#
define
BPS
32
/
/
this
is
the
common
stride
for
enc
/
dec
#
if
defined
(
__GNUC__
)
#
define
WEBP_RESTRICT
__restrict__
#
elif
defined
(
_MSC_VER
)
#
define
WEBP_RESTRICT
__restrict
#
else
#
define
WEBP_RESTRICT
#
endif
#
if
defined
(
__GNUC__
)
#
define
LOCAL_GCC_VERSION
(
(
__GNUC__
<
<
8
)
|
__GNUC_MINOR__
)
#
define
LOCAL_GCC_PREREQ
(
maj
min
)
\
(
LOCAL_GCC_VERSION
>
=
(
(
(
maj
)
<
<
8
)
|
(
min
)
)
)
#
else
#
define
LOCAL_GCC_VERSION
0
#
define
LOCAL_GCC_PREREQ
(
maj
min
)
0
#
endif
#
if
defined
(
__clang__
)
#
define
LOCAL_CLANG_VERSION
(
(
__clang_major__
<
<
8
)
|
__clang_minor__
)
#
define
LOCAL_CLANG_PREREQ
(
maj
min
)
\
(
LOCAL_CLANG_VERSION
>
=
(
(
(
maj
)
<
<
8
)
|
(
min
)
)
)
#
else
#
define
LOCAL_CLANG_VERSION
0
#
define
LOCAL_CLANG_PREREQ
(
maj
min
)
0
#
endif
#
ifndef
__has_builtin
#
define
__has_builtin
(
x
)
0
#
endif
#
if
!
defined
(
HAVE_CONFIG_H
)
#
if
defined
(
_MSC_VER
)
&
&
_MSC_VER
>
1310
&
&
\
(
defined
(
_M_X64
)
|
|
defined
(
_M_IX86
)
)
#
define
WEBP_MSC_SSE2
#
endif
#
if
defined
(
_MSC_VER
)
&
&
_MSC_VER
>
=
1500
&
&
\
(
defined
(
_M_X64
)
|
|
defined
(
_M_IX86
)
)
#
define
WEBP_MSC_SSE41
#
endif
#
endif
#
if
(
defined
(
__SSE2__
)
|
|
defined
(
WEBP_MSC_SSE2
)
)
&
&
\
(
!
defined
(
HAVE_CONFIG_H
)
|
|
defined
(
WEBP_HAVE_SSE2
)
)
#
define
WEBP_USE_SSE2
#
endif
#
if
defined
(
WEBP_USE_SSE2
)
&
&
!
defined
(
WEBP_HAVE_SSE2
)
#
define
WEBP_HAVE_SSE2
#
endif
#
if
(
defined
(
__SSE4_1__
)
|
|
defined
(
WEBP_MSC_SSE41
)
)
&
&
\
(
!
defined
(
HAVE_CONFIG_H
)
|
|
defined
(
WEBP_HAVE_SSE41
)
)
#
define
WEBP_USE_SSE41
#
endif
#
if
defined
(
WEBP_USE_SSE41
)
&
&
!
defined
(
WEBP_HAVE_SSE41
)
#
define
WEBP_HAVE_SSE41
#
endif
#
undef
WEBP_MSC_SSE41
#
undef
WEBP_MSC_SSE2
#
if
(
(
defined
(
__ARM_NEON__
)
|
|
defined
(
__aarch64__
)
)
&
&
\
(
!
defined
(
HAVE_CONFIG_H
)
|
|
defined
(
WEBP_HAVE_NEON
)
)
)
&
&
\
!
defined
(
__native_client__
)
#
define
WEBP_USE_NEON
#
endif
#
if
!
defined
(
WEBP_USE_NEON
)
&
&
defined
(
__ANDROID__
)
&
&
\
defined
(
__ARM_ARCH_7A__
)
&
&
defined
(
HAVE_CPU_FEATURES_H
)
#
define
WEBP_ANDROID_NEON
#
define
WEBP_USE_NEON
#
endif
#
if
defined
(
_MSC_VER
)
&
&
\
(
(
_MSC_VER
>
=
1700
&
&
defined
(
_M_ARM
)
)
|
|
\
(
_MSC_VER
>
=
1920
&
&
defined
(
_M_ARM64
)
)
)
#
define
WEBP_USE_NEON
#
define
WEBP_USE_INTRINSICS
#
endif
#
if
defined
(
WEBP_USE_NEON
)
&
&
!
defined
(
WEBP_HAVE_NEON
)
#
define
WEBP_HAVE_NEON
#
endif
#
if
defined
(
__mips__
)
&
&
!
defined
(
__mips64
)
&
&
\
defined
(
__mips_isa_rev
)
&
&
(
__mips_isa_rev
>
=
1
)
&
&
(
__mips_isa_rev
<
6
)
#
define
WEBP_USE_MIPS32
#
if
(
__mips_isa_rev
>
=
2
)
#
define
WEBP_USE_MIPS32_R2
#
if
defined
(
__mips_dspr2
)
|
|
(
defined
(
__mips_dsp_rev
)
&
&
__mips_dsp_rev
>
=
2
)
#
define
WEBP_USE_MIPS_DSP_R2
#
endif
#
endif
#
endif
#
if
defined
(
__mips_msa
)
&
&
defined
(
__mips_isa_rev
)
&
&
(
__mips_isa_rev
>
=
5
)
#
define
WEBP_USE_MSA
#
endif
#
ifndef
WEBP_DSP_OMIT_C_CODE
#
define
WEBP_DSP_OMIT_C_CODE
1
#
endif
#
if
defined
(
WEBP_USE_NEON
)
&
&
WEBP_DSP_OMIT_C_CODE
#
define
WEBP_NEON_OMIT_C_CODE
1
#
else
#
define
WEBP_NEON_OMIT_C_CODE
0
#
endif
#
if
!
(
LOCAL_CLANG_PREREQ
(
3
8
)
|
|
LOCAL_GCC_PREREQ
(
4
8
)
|
|
defined
(
__aarch64__
)
)
#
define
WEBP_NEON_WORK_AROUND_GCC
1
#
else
#
define
WEBP_NEON_WORK_AROUND_GCC
0
#
endif
#
define
WEBP_TSAN_IGNORE_FUNCTION
#
if
defined
(
__has_feature
)
#
if
__has_feature
(
thread_sanitizer
)
#
undef
WEBP_TSAN_IGNORE_FUNCTION
#
define
WEBP_TSAN_IGNORE_FUNCTION
__attribute__
(
(
no_sanitize_thread
)
)
#
endif
#
endif
#
if
defined
(
WEBP_USE_THREAD
)
&
&
!
defined
(
_WIN32
)
#
include
<
pthread
.
h
>
#
define
WEBP_DSP_INIT
(
func
)
do
{
\
static
volatile
VP8CPUInfo
func
#
#
_last_cpuinfo_used
=
\
(
VP8CPUInfo
)
&
func
#
#
_last_cpuinfo_used
;
\
static
pthread_mutex_t
func
#
#
_lock
=
PTHREAD_MUTEX_INITIALIZER
;
\
if
(
pthread_mutex_lock
(
&
func
#
#
_lock
)
)
break
;
\
if
(
func
#
#
_last_cpuinfo_used
!
=
VP8GetCPUInfo
)
func
(
)
;
\
func
#
#
_last_cpuinfo_used
=
VP8GetCPUInfo
;
\
(
void
)
pthread_mutex_unlock
(
&
func
#
#
_lock
)
;
\
}
while
(
0
)
#
else
#
define
WEBP_DSP_INIT
(
func
)
do
{
\
static
volatile
VP8CPUInfo
func
#
#
_last_cpuinfo_used
=
\
(
VP8CPUInfo
)
&
func
#
#
_last_cpuinfo_used
;
\
if
(
func
#
#
_last_cpuinfo_used
=
=
VP8GetCPUInfo
)
break
;
\
func
(
)
;
\
func
#
#
_last_cpuinfo_used
=
VP8GetCPUInfo
;
\
}
while
(
0
)
#
endif
#
define
WEBP_DSP_INIT_FUNC
(
name
)
\
static
WEBP_TSAN_IGNORE_FUNCTION
void
name
#
#
_body
(
void
)
;
\
WEBP_TSAN_IGNORE_FUNCTION
void
name
(
void
)
{
\
WEBP_DSP_INIT
(
name
#
#
_body
)
;
\
}
\
static
WEBP_TSAN_IGNORE_FUNCTION
void
name
#
#
_body
(
void
)
#
define
WEBP_UBSAN_IGNORE_UNDEF
#
define
WEBP_UBSAN_IGNORE_UNSIGNED_OVERFLOW
#
if
defined
(
__clang__
)
&
&
defined
(
__has_attribute
)
#
if
__has_attribute
(
no_sanitize
)
#
undef
WEBP_UBSAN_IGNORE_UNDEF
#
define
WEBP_UBSAN_IGNORE_UNDEF
\
__attribute__
(
(
no_sanitize
(
"
undefined
"
)
)
)
#
undef
WEBP_UBSAN_IGNORE_UNSIGNED_OVERFLOW
#
define
WEBP_UBSAN_IGNORE_UNSIGNED_OVERFLOW
\
__attribute__
(
(
no_sanitize
(
"
unsigned
-
integer
-
overflow
"
)
)
)
#
endif
#
endif
#
if
!
defined
(
WEBP_OFFSET_PTR
)
#
define
WEBP_OFFSET_PTR
(
ptr
off
)
(
(
(
ptr
)
=
=
NULL
)
?
NULL
:
(
(
ptr
)
+
(
off
)
)
)
#
endif
#
if
!
defined
(
WEBP_SWAP_16BIT_CSP
)
#
define
WEBP_SWAP_16BIT_CSP
0
#
endif
#
if
!
defined
(
WORDS_BIGENDIAN
)
&
&
\
(
defined
(
__BIG_ENDIAN__
)
|
|
defined
(
_M_PPC
)
|
|
\
(
defined
(
__BYTE_ORDER__
)
&
&
(
__BYTE_ORDER__
=
=
__ORDER_BIG_ENDIAN__
)
)
)
#
define
WORDS_BIGENDIAN
#
endif
typedef
enum
{
kSSE2
kSSE3
kSlowSSSE3
kSSE4_1
kAVX
kAVX2
kNEON
kMIPS32
kMIPSdspR2
kMSA
}
CPUFeature
;
typedef
int
(
*
VP8CPUInfo
)
(
CPUFeature
feature
)
;
WEBP_EXTERN
VP8CPUInfo
VP8GetCPUInfo
;
#
define
WEBP_DSP_INIT_STUB
(
func
)
\
extern
void
func
(
void
)
;
\
void
func
(
void
)
{
}
typedef
void
(
*
VP8Idct
)
(
const
uint8_t
*
ref
const
int16_t
*
in
uint8_t
*
dst
int
do_two
)
;
typedef
void
(
*
VP8Fdct
)
(
const
uint8_t
*
src
const
uint8_t
*
ref
int16_t
*
out
)
;
typedef
void
(
*
VP8WHT
)
(
const
int16_t
*
in
int16_t
*
out
)
;
extern
VP8Idct
VP8ITransform
;
extern
VP8Fdct
VP8FTransform
;
extern
VP8Fdct
VP8FTransform2
;
extern
VP8WHT
VP8FTransformWHT
;
typedef
void
(
*
VP8IntraPreds
)
(
uint8_t
*
dst
const
uint8_t
*
left
const
uint8_t
*
top
)
;
typedef
void
(
*
VP8Intra4Preds
)
(
uint8_t
*
dst
const
uint8_t
*
top
)
;
extern
VP8Intra4Preds
VP8EncPredLuma4
;
extern
VP8IntraPreds
VP8EncPredLuma16
;
extern
VP8IntraPreds
VP8EncPredChroma8
;
typedef
int
(
*
VP8Metric
)
(
const
uint8_t
*
pix
const
uint8_t
*
ref
)
;
extern
VP8Metric
VP8SSE16x16
VP8SSE16x8
VP8SSE8x8
VP8SSE4x4
;
typedef
int
(
*
VP8WMetric
)
(
const
uint8_t
*
pix
const
uint8_t
*
ref
const
uint16_t
*
const
weights
)
;
extern
VP8WMetric
VP8TDisto4x4
VP8TDisto16x16
;
typedef
void
(
*
VP8MeanMetric
)
(
const
uint8_t
*
ref
uint32_t
dc
[
4
]
)
;
extern
VP8MeanMetric
VP8Mean16x4
;
typedef
void
(
*
VP8BlockCopy
)
(
const
uint8_t
*
src
uint8_t
*
dst
)
;
extern
VP8BlockCopy
VP8Copy4x4
;
extern
VP8BlockCopy
VP8Copy16x8
;
struct
VP8Matrix
;
typedef
int
(
*
VP8QuantizeBlock
)
(
int16_t
in
[
16
]
int16_t
out
[
16
]
const
struct
VP8Matrix
*
const
mtx
)
;
typedef
int
(
*
VP8Quantize2Blocks
)
(
int16_t
in
[
32
]
int16_t
out
[
32
]
const
struct
VP8Matrix
*
const
mtx
)
;
extern
VP8QuantizeBlock
VP8EncQuantizeBlock
;
extern
VP8Quantize2Blocks
VP8EncQuantize2Blocks
;
typedef
int
(
*
VP8QuantizeBlockWHT
)
(
int16_t
in
[
16
]
int16_t
out
[
16
]
const
struct
VP8Matrix
*
const
mtx
)
;
extern
VP8QuantizeBlockWHT
VP8EncQuantizeBlockWHT
;
extern
const
int
VP8DspScan
[
16
+
4
+
4
]
;
#
define
MAX_COEFF_THRESH
31
/
/
size
of
histogram
used
by
CollectHistogram
.
typedef
struct
{
int
max_value
;
int
last_non_zero
;
}
VP8Histogram
;
typedef
void
(
*
VP8CHisto
)
(
const
uint8_t
*
ref
const
uint8_t
*
pred
int
start_block
int
end_block
VP8Histogram
*
const
histo
)
;
extern
VP8CHisto
VP8CollectHistogram
;
void
VP8SetHistogramData
(
const
int
distribution
[
MAX_COEFF_THRESH
+
1
]
VP8Histogram
*
const
histo
)
;
void
VP8EncDspInit
(
void
)
;
extern
const
uint16_t
VP8EntropyCost
[
256
]
;
extern
const
uint16_t
VP8LevelFixedCosts
[
2047
+
1
]
;
extern
const
uint8_t
VP8EncBands
[
16
+
1
]
;
struct
VP8Residual
;
typedef
void
(
*
VP8SetResidualCoeffsFunc
)
(
const
int16_t
*
const
coeffs
struct
VP8Residual
*
const
res
)
;
extern
VP8SetResidualCoeffsFunc
VP8SetResidualCoeffs
;
typedef
int
(
*
VP8GetResidualCostFunc
)
(
int
ctx0
const
struct
VP8Residual
*
const
res
)
;
extern
VP8GetResidualCostFunc
VP8GetResidualCost
;
void
VP8EncDspCostInit
(
void
)
;
typedef
struct
{
uint32_t
w
;
uint32_t
xm
ym
;
uint32_t
xxm
xym
yym
;
}
VP8DistoStats
;
double
VP8SSIMFromStats
(
const
VP8DistoStats
*
const
stats
)
;
double
VP8SSIMFromStatsClipped
(
const
VP8DistoStats
*
const
stats
)
;
#
define
VP8_SSIM_KERNEL
3
/
/
total
size
of
the
kernel
:
2
*
VP8_SSIM_KERNEL
+
1
typedef
double
(
*
VP8SSIMGetClippedFunc
)
(
const
uint8_t
*
src1
int
stride1
const
uint8_t
*
src2
int
stride2
int
xo
int
yo
int
W
int
H
)
;
#
if
!
defined
(
WEBP_REDUCE_SIZE
)
typedef
double
(
*
VP8SSIMGetFunc
)
(
const
uint8_t
*
src1
int
stride1
const
uint8_t
*
src2
int
stride2
)
;
extern
VP8SSIMGetFunc
VP8SSIMGet
;
extern
VP8SSIMGetClippedFunc
VP8SSIMGetClipped
;
#
endif
#
if
!
defined
(
WEBP_DISABLE_STATS
)
typedef
uint32_t
(
*
VP8AccumulateSSEFunc
)
(
const
uint8_t
*
src1
const
uint8_t
*
src2
int
len
)
;
extern
VP8AccumulateSSEFunc
VP8AccumulateSSE
;
#
endif
void
VP8SSIMDspInit
(
void
)
;
typedef
void
(
*
VP8DecIdct
)
(
const
int16_t
*
coeffs
uint8_t
*
dst
)
;
typedef
void
(
*
VP8DecIdct2
)
(
const
int16_t
*
coeffs
uint8_t
*
dst
int
do_two
)
;
extern
VP8DecIdct2
VP8Transform
;
extern
VP8DecIdct
VP8TransformAC3
;
extern
VP8DecIdct
VP8TransformUV
;
extern
VP8DecIdct
VP8TransformDC
;
extern
VP8DecIdct
VP8TransformDCUV
;
extern
VP8WHT
VP8TransformWHT
;
typedef
void
(
*
VP8PredFunc
)
(
uint8_t
*
dst
)
;
extern
VP8PredFunc
VP8PredLuma16
[
]
;
extern
VP8PredFunc
VP8PredChroma8
[
]
;
extern
VP8PredFunc
VP8PredLuma4
[
]
;
extern
const
int8_t
*
const
VP8ksclip1
;
extern
const
int8_t
*
const
VP8ksclip2
;
extern
const
uint8_t
*
const
VP8kclip1
;
extern
const
uint8_t
*
const
VP8kabs0
;
void
VP8InitClipTables
(
void
)
;
typedef
void
(
*
VP8SimpleFilterFunc
)
(
uint8_t
*
p
int
stride
int
thresh
)
;
extern
VP8SimpleFilterFunc
VP8SimpleVFilter16
;
extern
VP8SimpleFilterFunc
VP8SimpleHFilter16
;
extern
VP8SimpleFilterFunc
VP8SimpleVFilter16i
;
extern
VP8SimpleFilterFunc
VP8SimpleHFilter16i
;
typedef
void
(
*
VP8LumaFilterFunc
)
(
uint8_t
*
luma
int
stride
int
thresh
int
ithresh
int
hev_t
)
;
typedef
void
(
*
VP8ChromaFilterFunc
)
(
uint8_t
*
u
uint8_t
*
v
int
stride
int
thresh
int
ithresh
int
hev_t
)
;
extern
VP8LumaFilterFunc
VP8VFilter16
;
extern
VP8LumaFilterFunc
VP8HFilter16
;
extern
VP8ChromaFilterFunc
VP8VFilter8
;
extern
VP8ChromaFilterFunc
VP8HFilter8
;
extern
VP8LumaFilterFunc
VP8VFilter16i
;
extern
VP8LumaFilterFunc
VP8HFilter16i
;
extern
VP8ChromaFilterFunc
VP8VFilter8i
;
extern
VP8ChromaFilterFunc
VP8HFilter8i
;
#
define
VP8_DITHER_DESCALE
4
#
define
VP8_DITHER_DESCALE_ROUNDER
(
1
<
<
(
VP8_DITHER_DESCALE
-
1
)
)
#
define
VP8_DITHER_AMP_BITS
7
#
define
VP8_DITHER_AMP_CENTER
(
1
<
<
VP8_DITHER_AMP_BITS
)
extern
void
(
*
VP8DitherCombine8x8
)
(
const
uint8_t
*
dither
uint8_t
*
dst
int
dst_stride
)
;
void
VP8DspInit
(
void
)
;
#
define
FANCY_UPSAMPLING
typedef
void
(
*
WebPUpsampleLinePairFunc
)
(
const
uint8_t
*
top_y
const
uint8_t
*
bottom_y
const
uint8_t
*
top_u
const
uint8_t
*
top_v
const
uint8_t
*
cur_u
const
uint8_t
*
cur_v
uint8_t
*
top_dst
uint8_t
*
bottom_dst
int
len
)
;
#
ifdef
FANCY_UPSAMPLING
extern
WebPUpsampleLinePairFunc
WebPUpsamplers
[
]
;
#
endif
typedef
void
(
*
WebPSamplerRowFunc
)
(
const
uint8_t
*
y
const
uint8_t
*
u
const
uint8_t
*
v
uint8_t
*
dst
int
len
)
;
void
WebPSamplerProcessPlane
(
const
uint8_t
*
y
int
y_stride
const
uint8_t
*
u
const
uint8_t
*
v
int
uv_stride
uint8_t
*
dst
int
dst_stride
int
width
int
height
WebPSamplerRowFunc
func
)
;
extern
WebPSamplerRowFunc
WebPSamplers
[
]
;
WebPUpsampleLinePairFunc
WebPGetLinePairConverter
(
int
alpha_is_last
)
;
typedef
void
(
*
WebPYUV444Converter
)
(
const
uint8_t
*
y
const
uint8_t
*
u
const
uint8_t
*
v
uint8_t
*
dst
int
len
)
;
extern
WebPYUV444Converter
WebPYUV444Converters
[
]
;
void
WebPInitUpsamplers
(
void
)
;
void
WebPInitSamplers
(
void
)
;
void
WebPInitYUV444Converters
(
void
)
;
extern
void
(
*
WebPConvertARGBToY
)
(
const
uint32_t
*
argb
uint8_t
*
y
int
width
)
;
extern
void
(
*
WebPConvertARGBToUV
)
(
const
uint32_t
*
argb
uint8_t
*
u
uint8_t
*
v
int
src_width
int
do_store
)
;
extern
void
(
*
WebPConvertRGBA32ToUV
)
(
const
uint16_t
*
rgb
uint8_t
*
u
uint8_t
*
v
int
width
)
;
extern
void
(
*
WebPConvertRGB24ToY
)
(
const
uint8_t
*
rgb
uint8_t
*
y
int
width
)
;
extern
void
(
*
WebPConvertBGR24ToY
)
(
const
uint8_t
*
bgr
uint8_t
*
y
int
width
)
;
extern
void
WebPConvertARGBToUV_C
(
const
uint32_t
*
argb
uint8_t
*
u
uint8_t
*
v
int
src_width
int
do_store
)
;
extern
void
WebPConvertRGBA32ToUV_C
(
const
uint16_t
*
rgb
uint8_t
*
u
uint8_t
*
v
int
width
)
;
extern
uint64_t
(
*
WebPSharpYUVUpdateY
)
(
const
uint16_t
*
src
const
uint16_t
*
ref
uint16_t
*
dst
int
len
)
;
extern
void
(
*
WebPSharpYUVUpdateRGB
)
(
const
int16_t
*
src
const
int16_t
*
ref
int16_t
*
dst
int
len
)
;
extern
void
(
*
WebPSharpYUVFilterRow
)
(
const
int16_t
*
A
const
int16_t
*
B
int
len
const
uint16_t
*
best_y
uint16_t
*
out
)
;
void
WebPInitConvertARGBToYUV
(
void
)
;
struct
WebPRescaler
;
typedef
void
(
*
WebPRescalerImportRowFunc
)
(
struct
WebPRescaler
*
const
wrk
const
uint8_t
*
src
)
;
extern
WebPRescalerImportRowFunc
WebPRescalerImportRowExpand
;
extern
WebPRescalerImportRowFunc
WebPRescalerImportRowShrink
;
typedef
void
(
*
WebPRescalerExportRowFunc
)
(
struct
WebPRescaler
*
const
wrk
)
;
extern
WebPRescalerExportRowFunc
WebPRescalerExportRowExpand
;
extern
WebPRescalerExportRowFunc
WebPRescalerExportRowShrink
;
extern
void
WebPRescalerImportRowExpand_C
(
struct
WebPRescaler
*
const
wrk
const
uint8_t
*
src
)
;
extern
void
WebPRescalerImportRowShrink_C
(
struct
WebPRescaler
*
const
wrk
const
uint8_t
*
src
)
;
extern
void
WebPRescalerExportRowExpand_C
(
struct
WebPRescaler
*
const
wrk
)
;
extern
void
WebPRescalerExportRowShrink_C
(
struct
WebPRescaler
*
const
wrk
)
;
extern
void
WebPRescalerImportRow
(
struct
WebPRescaler
*
const
wrk
const
uint8_t
*
src
)
;
extern
void
WebPRescalerExportRow
(
struct
WebPRescaler
*
const
wrk
)
;
void
WebPRescalerDspInit
(
void
)
;
extern
void
(
*
WebPApplyAlphaMultiply
)
(
uint8_t
*
rgba
int
alpha_first
int
w
int
h
int
stride
)
;
extern
void
(
*
WebPApplyAlphaMultiply4444
)
(
uint8_t
*
rgba4444
int
w
int
h
int
stride
)
;
extern
int
(
*
WebPDispatchAlpha
)
(
const
uint8_t
*
WEBP_RESTRICT
alpha
int
alpha_stride
int
width
int
height
uint8_t
*
WEBP_RESTRICT
dst
int
dst_stride
)
;
extern
void
(
*
WebPDispatchAlphaToGreen
)
(
const
uint8_t
*
WEBP_RESTRICT
alpha
int
alpha_stride
int
width
int
height
uint32_t
*
WEBP_RESTRICT
dst
int
dst_stride
)
;
extern
int
(
*
WebPExtractAlpha
)
(
const
uint8_t
*
WEBP_RESTRICT
argb
int
argb_stride
int
width
int
height
uint8_t
*
WEBP_RESTRICT
alpha
int
alpha_stride
)
;
extern
void
(
*
WebPExtractGreen
)
(
const
uint32_t
*
WEBP_RESTRICT
argb
uint8_t
*
WEBP_RESTRICT
alpha
int
size
)
;
extern
void
(
*
WebPMultARGBRow
)
(
uint32_t
*
const
ptr
int
width
int
inverse
)
;
void
WebPMultARGBRows
(
uint8_t
*
ptr
int
stride
int
width
int
num_rows
int
inverse
)
;
extern
void
(
*
WebPMultRow
)
(
uint8_t
*
WEBP_RESTRICT
const
ptr
const
uint8_t
*
WEBP_RESTRICT
const
alpha
int
width
int
inverse
)
;
void
WebPMultRows
(
uint8_t
*
WEBP_RESTRICT
ptr
int
stride
const
uint8_t
*
WEBP_RESTRICT
alpha
int
alpha_stride
int
width
int
num_rows
int
inverse
)
;
void
WebPMultRow_C
(
uint8_t
*
WEBP_RESTRICT
const
ptr
const
uint8_t
*
WEBP_RESTRICT
const
alpha
int
width
int
inverse
)
;
void
WebPMultARGBRow_C
(
uint32_t
*
const
ptr
int
width
int
inverse
)
;
#
ifdef
WORDS_BIGENDIAN
extern
void
(
*
WebPPackARGB
)
(
const
uint8_t
*
WEBP_RESTRICT
a
const
uint8_t
*
WEBP_RESTRICT
r
const
uint8_t
*
WEBP_RESTRICT
g
const
uint8_t
*
WEBP_RESTRICT
b
int
len
uint32_t
*
WEBP_RESTRICT
out
)
;
#
endif
extern
void
(
*
WebPPackRGB
)
(
const
uint8_t
*
WEBP_RESTRICT
r
const
uint8_t
*
WEBP_RESTRICT
g
const
uint8_t
*
WEBP_RESTRICT
b
int
len
int
step
uint32_t
*
WEBP_RESTRICT
out
)
;
extern
int
(
*
WebPHasAlpha8b
)
(
const
uint8_t
*
src
int
length
)
;
extern
int
(
*
WebPHasAlpha32b
)
(
const
uint8_t
*
src
int
length
)
;
extern
void
(
*
WebPAlphaReplace
)
(
uint32_t
*
src
int
length
uint32_t
color
)
;
void
WebPInitAlphaProcessing
(
void
)
;
typedef
enum
{
WEBP_FILTER_NONE
=
0
WEBP_FILTER_HORIZONTAL
WEBP_FILTER_VERTICAL
WEBP_FILTER_GRADIENT
WEBP_FILTER_LAST
=
WEBP_FILTER_GRADIENT
+
1
WEBP_FILTER_BEST
WEBP_FILTER_FAST
}
WEBP_FILTER_TYPE
;
typedef
void
(
*
WebPFilterFunc
)
(
const
uint8_t
*
in
int
width
int
height
int
stride
uint8_t
*
out
)
;
typedef
void
(
*
WebPUnfilterFunc
)
(
const
uint8_t
*
prev_line
const
uint8_t
*
preds
uint8_t
*
cur_line
int
width
)
;
extern
WebPFilterFunc
WebPFilters
[
WEBP_FILTER_LAST
]
;
extern
WebPUnfilterFunc
WebPUnfilters
[
WEBP_FILTER_LAST
]
;
void
VP8FiltersInit
(
void
)
;
#
ifdef
__cplusplus
}
#
endif
#
endif
