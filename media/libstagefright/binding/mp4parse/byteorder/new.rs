use
std
:
:
io
:
:
{
self
Result
}
;
use
byteorder
:
:
ByteOrder
;
pub
trait
ReadBytesExt
:
io
:
:
Read
{
#
[
inline
]
fn
read_u8
(
&
mut
self
)
-
>
Result
<
u8
>
{
let
mut
buf
=
[
0
;
1
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
buf
[
0
]
)
}
#
[
inline
]
fn
read_i8
(
&
mut
self
)
-
>
Result
<
i8
>
{
let
mut
buf
=
[
0
;
1
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
buf
[
0
]
as
i8
)
}
#
[
inline
]
fn
read_u16
<
T
:
ByteOrder
>
(
&
mut
self
)
-
>
Result
<
u16
>
{
let
mut
buf
=
[
0
;
2
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
T
:
:
read_u16
(
&
buf
)
)
}
#
[
inline
]
fn
read_i16
<
T
:
ByteOrder
>
(
&
mut
self
)
-
>
Result
<
i16
>
{
let
mut
buf
=
[
0
;
2
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
T
:
:
read_i16
(
&
buf
)
)
}
#
[
inline
]
fn
read_u32
<
T
:
ByteOrder
>
(
&
mut
self
)
-
>
Result
<
u32
>
{
let
mut
buf
=
[
0
;
4
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
T
:
:
read_u32
(
&
buf
)
)
}
#
[
inline
]
fn
read_i32
<
T
:
ByteOrder
>
(
&
mut
self
)
-
>
Result
<
i32
>
{
let
mut
buf
=
[
0
;
4
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
T
:
:
read_i32
(
&
buf
)
)
}
#
[
inline
]
fn
read_u64
<
T
:
ByteOrder
>
(
&
mut
self
)
-
>
Result
<
u64
>
{
let
mut
buf
=
[
0
;
8
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
T
:
:
read_u64
(
&
buf
)
)
}
#
[
inline
]
fn
read_i64
<
T
:
ByteOrder
>
(
&
mut
self
)
-
>
Result
<
i64
>
{
let
mut
buf
=
[
0
;
8
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
T
:
:
read_i64
(
&
buf
)
)
}
#
[
inline
]
fn
read_uint
<
T
:
ByteOrder
>
(
&
mut
self
nbytes
:
usize
)
-
>
Result
<
u64
>
{
let
mut
buf
=
[
0
;
8
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
[
.
.
nbytes
]
)
)
;
Ok
(
T
:
:
read_uint
(
&
buf
[
.
.
nbytes
]
nbytes
)
)
}
#
[
inline
]
fn
read_int
<
T
:
ByteOrder
>
(
&
mut
self
nbytes
:
usize
)
-
>
Result
<
i64
>
{
let
mut
buf
=
[
0
;
8
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
[
.
.
nbytes
]
)
)
;
Ok
(
T
:
:
read_int
(
&
buf
[
.
.
nbytes
]
nbytes
)
)
}
#
[
inline
]
fn
read_f32
<
T
:
ByteOrder
>
(
&
mut
self
)
-
>
Result
<
f32
>
{
let
mut
buf
=
[
0
;
4
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
T
:
:
read_f32
(
&
buf
)
)
}
#
[
inline
]
fn
read_f64
<
T
:
ByteOrder
>
(
&
mut
self
)
-
>
Result
<
f64
>
{
let
mut
buf
=
[
0
;
8
]
;
try
!
(
self
.
read_exact
(
&
mut
buf
)
)
;
Ok
(
T
:
:
read_f64
(
&
buf
)
)
}
}
impl
<
R
:
io
:
:
Read
+
?
Sized
>
ReadBytesExt
for
R
{
}
pub
trait
WriteBytesExt
:
io
:
:
Write
{
#
[
inline
]
fn
write_u8
(
&
mut
self
n
:
u8
)
-
>
Result
<
(
)
>
{
self
.
write_all
(
&
[
n
]
)
}
#
[
inline
]
fn
write_i8
(
&
mut
self
n
:
i8
)
-
>
Result
<
(
)
>
{
self
.
write_all
(
&
[
n
as
u8
]
)
}
#
[
inline
]
fn
write_u16
<
T
:
ByteOrder
>
(
&
mut
self
n
:
u16
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
2
]
;
T
:
:
write_u16
(
&
mut
buf
n
)
;
self
.
write_all
(
&
buf
)
}
#
[
inline
]
fn
write_i16
<
T
:
ByteOrder
>
(
&
mut
self
n
:
i16
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
2
]
;
T
:
:
write_i16
(
&
mut
buf
n
)
;
self
.
write_all
(
&
buf
)
}
#
[
inline
]
fn
write_u32
<
T
:
ByteOrder
>
(
&
mut
self
n
:
u32
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
4
]
;
T
:
:
write_u32
(
&
mut
buf
n
)
;
self
.
write_all
(
&
buf
)
}
#
[
inline
]
fn
write_i32
<
T
:
ByteOrder
>
(
&
mut
self
n
:
i32
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
4
]
;
T
:
:
write_i32
(
&
mut
buf
n
)
;
self
.
write_all
(
&
buf
)
}
#
[
inline
]
fn
write_u64
<
T
:
ByteOrder
>
(
&
mut
self
n
:
u64
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
8
]
;
T
:
:
write_u64
(
&
mut
buf
n
)
;
self
.
write_all
(
&
buf
)
}
#
[
inline
]
fn
write_i64
<
T
:
ByteOrder
>
(
&
mut
self
n
:
i64
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
8
]
;
T
:
:
write_i64
(
&
mut
buf
n
)
;
self
.
write_all
(
&
buf
)
}
#
[
inline
]
fn
write_uint
<
T
:
ByteOrder
>
(
&
mut
self
n
:
u64
nbytes
:
usize
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
8
]
;
T
:
:
write_uint
(
&
mut
buf
n
nbytes
)
;
self
.
write_all
(
&
buf
[
0
.
.
nbytes
]
)
}
#
[
inline
]
fn
write_int
<
T
:
ByteOrder
>
(
&
mut
self
n
:
i64
nbytes
:
usize
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
8
]
;
T
:
:
write_int
(
&
mut
buf
n
nbytes
)
;
self
.
write_all
(
&
buf
[
0
.
.
nbytes
]
)
}
#
[
inline
]
fn
write_f32
<
T
:
ByteOrder
>
(
&
mut
self
n
:
f32
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
4
]
;
T
:
:
write_f32
(
&
mut
buf
n
)
;
self
.
write_all
(
&
buf
)
}
#
[
inline
]
fn
write_f64
<
T
:
ByteOrder
>
(
&
mut
self
n
:
f64
)
-
>
Result
<
(
)
>
{
let
mut
buf
=
[
0
;
8
]
;
T
:
:
write_f64
(
&
mut
buf
n
)
;
self
.
write_all
(
&
buf
)
}
}
impl
<
W
:
io
:
:
Write
+
?
Sized
>
WriteBytesExt
for
W
{
}
