#
ifndef
AVUTIL_EMMS_H
#
define
AVUTIL_EMMS_H
#
include
"
config
.
h
"
#
include
"
libavutil
/
attributes
.
h
"
#
if
ARCH_X86
void
avpriv_emms_asm
(
void
)
;
#
if
HAVE_MMX_INLINE
#
ifndef
__MMX__
#
include
"
libavutil
/
cpu
.
h
"
#
endif
#
define
emms_c
emms_c
static
av_always_inline
void
emms_c
(
void
)
{
#
if
!
defined
(
__MMX__
)
if
(
av_get_cpu_flags
(
)
&
AV_CPU_FLAG_MMX
)
#
endif
__asm__
volatile
(
"
emms
"
:
:
:
"
memory
"
)
;
}
#
elif
HAVE_MMX
&
&
HAVE_MM_EMPTY
#
include
<
mmintrin
.
h
>
#
define
emms_c
_mm_empty
#
elif
HAVE_MMX_EXTERNAL
#
define
emms_c
avpriv_emms_asm
#
endif
#
endif
#
ifndef
emms_c
#
define
emms_c
(
)
do
{
}
while
(
0
)
#
endif
#
endif
