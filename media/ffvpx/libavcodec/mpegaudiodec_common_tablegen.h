#
ifndef
AVCODEC_MPEGAUDIODEC_COMMON_TABLEGEN_H
#
define
AVCODEC_MPEGAUDIODEC_COMMON_TABLEGEN_H
#
include
<
stdint
.
h
>
#
define
TABLE_4_3_SIZE
(
(
8191
+
16
)
*
4
)
#
if
CONFIG_HARDCODED_TABLES
#
define
mpegaudiodec_common_tableinit
(
)
#
include
"
libavcodec
/
mpegaudiodec_common_tables
.
h
"
#
else
#
include
<
math
.
h
>
#
include
"
libavutil
/
attributes
.
h
"
int8_t
ff_table_4_3_exp
[
TABLE_4_3_SIZE
]
;
uint32_t
ff_table_4_3_value
[
TABLE_4_3_SIZE
]
;
#
define
FRAC_BITS
23
#
define
IMDCT_SCALAR
1
.
759
static
av_cold
void
mpegaudiodec_common_tableinit
(
void
)
{
static
const
double
exp2_lut
[
4
]
=
{
1
.
00000000000000000000
1
.
18920711500272106672
M_SQRT2
1
.
68179283050742908606
}
;
double
pow43_val
=
0
;
for
(
int
i
=
1
;
i
<
TABLE_4_3_SIZE
;
i
+
+
)
{
double
f
fm
;
int
e
m
;
double
value
=
i
/
4
;
if
(
(
i
&
3
)
=
=
0
)
pow43_val
=
value
/
IMDCT_SCALAR
*
cbrt
(
value
)
;
f
=
pow43_val
*
exp2_lut
[
i
&
3
]
;
fm
=
frexp
(
f
&
e
)
;
m
=
llrint
(
fm
*
(
1LL
<
<
31
)
)
;
e
+
=
FRAC_BITS
-
31
+
5
-
100
;
ff_table_4_3_value
[
i
]
=
m
;
ff_table_4_3_exp
[
i
]
=
-
e
;
}
}
#
endif
#
endif
