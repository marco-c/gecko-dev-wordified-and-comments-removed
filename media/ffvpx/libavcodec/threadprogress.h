#
ifndef
AVCODEC_THREADPROGRESS_H
#
define
AVCODEC_THREADPROGRESS_H
#
include
<
limits
.
h
>
#
include
<
stdatomic
.
h
>
#
include
"
libavutil
/
thread
.
h
"
typedef
struct
ThreadProgress
{
atomic_int
progress
;
unsigned
init
;
AVMutex
progress_mutex
;
AVCond
progress_cond
;
}
ThreadProgress
;
int
ff_thread_progress_init
(
ThreadProgress
*
pro
int
init_mode
)
;
void
ff_thread_progress_destroy
(
ThreadProgress
*
pro
)
;
static
inline
void
ff_thread_progress_reset
(
ThreadProgress
*
pro
)
{
atomic_init
(
&
pro
-
>
progress
pro
-
>
init
?
-
1
:
INT_MAX
)
;
}
void
ff_thread_progress_report
(
ThreadProgress
*
pro
int
progress
)
;
void
ff_thread_progress_await
(
const
ThreadProgress
*
pro
int
progress
)
;
#
endif
