#
include
"
libavutil
/
pixdesc
.
h
"
#
include
"
libaom
.
h
"
void
ff_aom_image_copy_16_to_8
(
AVFrame
*
pic
struct
aom_image
*
img
)
{
const
AVPixFmtDescriptor
*
desc
=
av_pix_fmt_desc_get
(
pic
-
>
format
)
;
int
i
;
for
(
i
=
0
;
i
<
desc
-
>
nb_components
;
i
+
+
)
{
int
w
=
img
-
>
d_w
;
int
h
=
img
-
>
d_h
;
int
x
y
;
if
(
i
)
{
w
=
(
w
+
img
-
>
x_chroma_shift
)
>
>
img
-
>
x_chroma_shift
;
h
=
(
h
+
img
-
>
y_chroma_shift
)
>
>
img
-
>
y_chroma_shift
;
}
for
(
y
=
0
;
y
<
h
;
y
+
+
)
{
uint16_t
*
src
=
(
uint16_t
*
)
(
img
-
>
planes
[
i
]
+
y
*
img
-
>
stride
[
i
]
)
;
uint8_t
*
dst
=
pic
-
>
data
[
i
]
+
y
*
pic
-
>
linesize
[
i
]
;
for
(
x
=
0
;
x
<
w
;
x
+
+
)
*
dst
+
+
=
*
src
+
+
;
}
}
}
