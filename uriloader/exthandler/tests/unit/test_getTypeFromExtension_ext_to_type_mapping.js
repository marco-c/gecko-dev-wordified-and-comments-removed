function
run_test
(
)
{
const
mimeService
=
Cc
[
"
mozilla
.
org
/
mime
;
1
"
]
.
getService
(
Ci
.
nsIMIMEService
)
;
const
categoryManager
=
Services
.
catMan
;
const
kTestExtension
=
"
testextension
"
;
const
kTestExtensionMixedCase
=
"
testExtensIon
"
;
const
kTestMimeType
=
"
application
/
x
-
testextension
"
;
try
{
mimeService
.
getTypeFromExtension
(
kTestExtension
)
;
do_throw
(
"
nsIMIMEService
.
getTypeFromExtension
succeeded
unexpectedly
"
)
;
}
catch
(
e
)
{
if
(
!
(
e
instanceof
Ci
.
nsIException
)
|
|
e
.
result
!
=
Cr
.
NS_ERROR_NOT_AVAILABLE
)
{
throw
e
;
}
}
categoryManager
.
addCategoryEntry
(
"
ext
-
to
-
type
-
mapping
"
kTestExtension
kTestMimeType
false
true
)
;
var
type
=
mimeService
.
getTypeFromExtension
(
kTestExtension
)
;
Assert
.
equal
(
type
kTestMimeType
)
;
type
=
mimeService
.
getTypeFromExtension
(
kTestExtensionMixedCase
)
;
Assert
.
equal
(
type
kTestMimeType
)
;
categoryManager
.
deleteCategoryEntry
(
"
ext
-
to
-
type
-
mapping
"
kTestExtension
false
)
;
}
