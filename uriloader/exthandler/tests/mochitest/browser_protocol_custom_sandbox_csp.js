"
use
strict
"
;
add_setup
(
async
function
(
)
{
await
setupMailHandler
(
)
;
}
)
;
add_task
(
async
function
test_sandbox_csp
(
)
{
for
(
let
triggerMethod
of
[
"
trustedClick
"
"
untrustedClick
"
"
trustedLocationAPI
"
"
untrustedLocationAPI
"
]
)
{
await
runExtProtocolSandboxTest
(
{
blocked
:
false
sandbox
:
"
allow
-
scripts
"
useCSPSandbox
:
true
triggerMethod
}
)
;
}
await
runExtProtocolSandboxTest
(
{
blocked
:
false
sandbox
:
"
allow
-
scripts
allow
-
top
-
navigation
-
to
-
custom
-
protocols
"
useCSPSandbox
:
true
}
)
;
}
)
;
