#
include
"
nsHtml5SVGLoadDispatcher
.
h
"
#
include
"
mozilla
/
BasicEvents
.
h
"
#
include
"
mozilla
/
EventDispatcher
.
h
"
#
include
"
mozilla
/
dom
/
Document
.
h
"
#
include
"
mozilla
/
dom
/
DocumentInlines
.
h
"
#
include
"
nsPresContext
.
h
"
using
namespace
mozilla
;
nsHtml5SVGLoadDispatcher
:
:
nsHtml5SVGLoadDispatcher
(
nsIContent
*
aElement
)
:
Runnable
(
"
nsHtml5SVGLoadDispatcher
"
)
mElement
(
aElement
)
mDocument
(
mElement
-
>
OwnerDoc
(
)
)
{
mDocument
-
>
BlockOnload
(
)
;
}
MOZ_CAN_RUN_SCRIPT_BOUNDARY
NS_IMETHODIMP
nsHtml5SVGLoadDispatcher
:
:
Run
(
)
{
WidgetEvent
event
(
true
eSVGLoad
)
;
event
.
mFlags
.
mBubbles
=
false
;
RefPtr
<
nsPresContext
>
ctx
=
mElement
-
>
OwnerDoc
(
)
-
>
GetPresContext
(
)
;
EventDispatcher
:
:
Dispatch
(
mElement
ctx
&
event
)
;
mDocument
-
>
UnblockOnload
(
false
)
;
return
NS_OK
;
}
