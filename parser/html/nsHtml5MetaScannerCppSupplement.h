#
include
"
nsISupportsImpl
.
h
"
#
include
"
mozilla
/
Encoding
.
h
"
const
Encoding
*
nsHtml5MetaScanner
:
:
sniff
(
nsHtml5ByteReadable
*
bytes
)
{
readable
=
bytes
;
stateLoop
(
stateSave
)
;
readable
=
nullptr
;
return
mEncoding
;
}
bool
nsHtml5MetaScanner
:
:
tryCharset
(
nsHtml5String
charset
)
{
nsAutoCString
label
;
nsString
charset16
;
charset
.
ToString
(
charset16
)
;
CopyUTF16toUTF8
(
charset16
label
)
;
const
Encoding
*
encoding
=
Encoding
:
:
ForLabel
(
label
)
;
if
(
!
encoding
)
{
return
false
;
}
if
(
encoding
=
=
UTF_16BE_ENCODING
|
|
encoding
=
=
UTF_16LE_ENCODING
)
{
mEncoding
=
UTF_8_ENCODING
;
return
true
;
}
if
(
encoding
=
=
X_USER_DEFINED_ENCODING
)
{
mEncoding
=
WINDOWS_1252_ENCODING
;
return
true
;
}
mEncoding
=
encoding
;
return
true
;
}
