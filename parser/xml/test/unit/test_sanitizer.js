function
run_test
(
)
{
load
(
"
results
.
js
"
)
;
var
ParserUtils
=
Cc
[
"
mozilla
.
org
/
parserutils
;
1
"
]
.
getService
(
Ci
.
nsIParserUtils
)
;
var
sanitizeFlags
=
ParserUtils
.
SanitizerCidEmbedsOnly
|
ParserUtils
.
SanitizerDropForms
|
ParserUtils
.
SanitizerDropNonCSSPresentation
;
for
(
var
item
in
vectors
)
{
var
evil
=
vectors
[
item
]
.
data
;
var
sanitized
=
vectors
[
item
]
.
sanitized
;
var
out
=
ParserUtils
.
sanitize
(
evil
sanitizeFlags
)
;
Assert
.
equal
(
sanitized
out
)
;
}
}
