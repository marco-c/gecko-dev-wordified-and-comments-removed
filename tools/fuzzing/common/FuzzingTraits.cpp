#
include
"
FuzzingTraits
.
h
"
namespace
mozilla
{
namespace
fuzzing
{
unsigned
int
FuzzingTraits
:
:
Random
(
unsigned
int
aMax
)
{
MOZ_ASSERT
(
aMax
>
0
"
aMax
needs
to
be
bigger
than
0
"
)
;
return
static_cast
<
unsigned
int
>
(
random
(
)
%
aMax
)
;
}
bool
FuzzingTraits
:
:
Sometimes
(
unsigned
int
aProbability
)
{
return
FuzzingTraits
:
:
Random
(
aProbability
)
=
=
0
;
}
size_t
FuzzingTraits
:
:
Frequency
(
const
size_t
aSize
const
uint64_t
aFactor
)
{
return
RandomIntegerRange
<
size_t
>
(
0
ceil
(
float
(
aSize
)
/
aFactor
)
)
+
1
;
}
}
}
