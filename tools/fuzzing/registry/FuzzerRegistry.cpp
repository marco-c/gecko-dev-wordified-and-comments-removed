#
include
"
FuzzerRegistry
.
h
"
namespace
mozilla
{
FuzzerRegistry
&
FuzzerRegistry
:
:
getInstance
(
)
{
static
FuzzerRegistry
instance
;
return
instance
;
}
void
FuzzerRegistry
:
:
registerModule
(
std
:
:
string
moduleName
FuzzerInitFunc
initFunc
FuzzerTestingFunc
testingFunc
)
{
moduleMap
.
insert
(
std
:
:
pair
<
std
:
:
string
FuzzerFunctions
>
(
moduleName
FuzzerFunctions
(
initFunc
testingFunc
)
)
)
;
}
FuzzerFunctions
FuzzerRegistry
:
:
getModuleFunctions
(
std
:
:
string
&
moduleName
)
{
return
moduleMap
[
moduleName
]
;
}
void
FuzzerRegistry
:
:
printModuleNames
(
)
{
for
(
const
auto
&
entry
:
moduleMap
)
{
printf
(
"
%
s
\
n
"
entry
.
first
.
c_str
(
)
)
;
}
}
}
