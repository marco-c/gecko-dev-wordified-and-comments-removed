#
include
"
FuzzerPlatform
.
h
"
#
include
<
cstdint
>
#
if
LIBFUZZER_WINDOWS
#
include
<
windows
.
h
>
namespace
fuzzer
{
#
pragma
section
(
"
.
data
__libfuzzer_extra_countaaa
"
)
ATTRIBUTE_ALIGNED
(
16
)
__declspec
(
allocate
(
"
.
data
__libfuzzer_extra_countaaa
"
)
)
uint8_t
__start___libfuzzer_extra_counters
[
16
]
=
{
0
}
;
#
pragma
section
(
"
.
data
__libfuzzer_extra_countzzz
"
)
ATTRIBUTE_ALIGNED
(
1
)
__declspec
(
allocate
(
"
.
data
__libfuzzer_extra_countzzz
"
)
)
uint8_t
__stop___libfuzzer_extra_counters
=
0
;
uint8_t
*
ExtraCountersBegin
(
)
{
return
__start___libfuzzer_extra_counters
+
sizeof
(
__start___libfuzzer_extra_counters
)
;
}
uint8_t
*
ExtraCountersEnd
(
)
{
return
&
__stop___libfuzzer_extra_counters
;
}
ATTRIBUTE_NO_SANITIZE_ALL
void
ClearExtraCounters
(
)
{
uint8_t
*
Beg
=
ExtraCountersBegin
(
)
;
SecureZeroMemory
(
Beg
ExtraCountersEnd
(
)
-
Beg
)
;
}
}
#
endif
