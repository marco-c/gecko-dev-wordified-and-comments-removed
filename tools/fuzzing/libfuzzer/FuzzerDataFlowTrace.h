#
ifndef
LLVM_FUZZER_DATA_FLOW_TRACE
#
define
LLVM_FUZZER_DATA_FLOW_TRACE
#
include
"
FuzzerDefs
.
h
"
#
include
<
unordered_map
>
#
include
<
vector
>
#
include
<
string
>
namespace
fuzzer
{
class
DataFlowTrace
{
public
:
void
Init
(
const
std
:
:
string
&
DirPath
const
std
:
:
string
&
FocusFunction
)
;
void
Clear
(
)
{
Traces
.
clear
(
)
;
}
const
Vector
<
uint8_t
>
*
Get
(
const
std
:
:
string
&
InputSha1
)
const
{
auto
It
=
Traces
.
find
(
InputSha1
)
;
if
(
It
!
=
Traces
.
end
(
)
)
return
&
It
-
>
second
;
return
nullptr
;
}
private
:
std
:
:
unordered_map
<
std
:
:
string
Vector
<
uint8_t
>
>
Traces
;
}
;
}
#
endif
