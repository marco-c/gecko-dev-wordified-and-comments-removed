#
include
<
cstdlib
>
#
include
"
FuzzerInterface
.
h
"
#
include
"
FuzzerInternal
.
h
"
#
include
"
harness
/
LibFuzzerRegistry
.
h
"
int
libfuzzer_main
(
int
argc
char
*
*
argv
LibFuzzerInitFunc
initFunc
LibFuzzerTestingFunc
testingFunc
)
{
if
(
initFunc
)
{
int
ret
=
initFunc
(
&
argc
&
argv
)
;
if
(
ret
)
{
fprintf
(
stderr
"
LibFuzzer
:
Error
:
Initialize
callback
failed
\
n
"
)
;
return
ret
;
}
}
if
(
!
testingFunc
)
{
fprintf
(
stderr
"
LibFuzzer
:
Error
:
No
testing
callback
found
\
n
"
)
;
return
1
;
}
return
fuzzer
:
:
FuzzerDriver
(
&
argc
&
argv
testingFunc
)
;
}
