#
include
"
LibFuzzerRunner
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
testing
/
TestHarness
.
h
"
#
include
"
prenv
.
h
"
namespace
mozilla
{
class
_InitLibFuzzer
{
public
:
_InitLibFuzzer
(
)
{
libFuzzerRunner
=
new
LibFuzzerRunner
(
)
;
}
}
InitLibFuzzer
;
int
LibFuzzerRunner
:
:
Run
(
)
{
ScopedXPCOM
xpcom
(
"
LibFuzzer
"
)
;
return
mFuzzerMain
(
mArgc
mArgv
)
;
}
typedef
int
(
*
LibFuzzerMain
)
(
int
char
*
*
)
;
void
LibFuzzerRunner
:
:
setParams
(
int
argc
char
*
*
argv
LibFuzzerMain
main
)
{
mArgc
=
argc
;
mArgv
=
argv
;
mFuzzerMain
=
main
;
}
}
