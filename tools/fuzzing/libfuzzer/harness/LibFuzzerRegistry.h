#
ifndef
_LibFuzzerRegistry_h__
#
define
_LibFuzzerRegistry_h__
#
include
<
cstdint
>
#
include
<
map
>
#
include
<
string
>
#
include
<
utility
>
#
include
"
mozilla
/
Attributes
.
h
"
#
include
"
mozilla
/
Types
.
h
"
typedef
int
(
*
LibFuzzerInitFunc
)
(
int
*
char
*
*
*
)
;
typedef
int
(
*
LibFuzzerTestingFunc
)
(
const
uint8_t
*
size_t
)
;
typedef
int
(
*
LibFuzzerDriver
)
(
int
*
char
*
*
*
LibFuzzerTestingFunc
)
;
namespace
mozilla
{
typedef
std
:
:
pair
<
LibFuzzerInitFunc
LibFuzzerTestingFunc
>
LibFuzzerFunctions
;
class
LibFuzzerRegistry
{
public
:
MOZ_EXPORT
static
LibFuzzerRegistry
&
getInstance
(
)
;
MOZ_EXPORT
void
registerModule
(
std
:
:
string
moduleName
LibFuzzerInitFunc
initFunc
LibFuzzerTestingFunc
testingFunc
)
;
MOZ_EXPORT
LibFuzzerFunctions
getModuleFunctions
(
std
:
:
string
&
moduleName
)
;
LibFuzzerRegistry
(
LibFuzzerRegistry
const
&
)
=
delete
;
void
operator
=
(
LibFuzzerRegistry
const
&
)
=
delete
;
private
:
LibFuzzerRegistry
(
)
{
}
;
std
:
:
map
<
std
:
:
string
LibFuzzerFunctions
>
moduleMap
;
}
;
}
#
endif
