#
include
"
LibFuzzerRegistry
.
h
"
namespace
mozilla
{
LibFuzzerRegistry
&
LibFuzzerRegistry
:
:
getInstance
(
)
{
static
LibFuzzerRegistry
instance
;
return
instance
;
}
void
LibFuzzerRegistry
:
:
registerModule
(
std
:
:
string
moduleName
LibFuzzerInitFunc
initFunc
LibFuzzerTestingFunc
testingFunc
)
{
moduleMap
.
insert
(
std
:
:
pair
<
std
:
:
string
LibFuzzerFunctions
>
(
moduleName
LibFuzzerFunctions
(
initFunc
testingFunc
)
)
)
;
}
LibFuzzerFunctions
LibFuzzerRegistry
:
:
getModuleFunctions
(
std
:
:
string
&
moduleName
)
{
return
moduleMap
[
moduleName
]
;
}
}
