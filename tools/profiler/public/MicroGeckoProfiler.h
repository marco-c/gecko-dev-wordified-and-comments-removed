#
ifndef
MICRO_GECKO_PROFILER
#
define
MICRO_GECKO_PROFILER
void
uprofiler_register_thread
(
const
char
*
aName
void
*
aGuessStackTop
)
;
void
uprofiler_unregister_thread
(
)
;
#
ifdef
__cplusplus
struct
AutoRegisterProfiler
{
AutoRegisterProfiler
(
const
char
*
name
char
*
stacktop
)
{
if
(
getenv
(
"
MOZ_UPROFILER_LOG_THREAD_CREATION
"
)
)
{
printf
(
"
#
#
#
UProfiler
:
new
thread
:
'
%
s
'
\
n
"
name
)
;
}
uprofiler_register_thread
(
name
stacktop
)
;
}
~
AutoRegisterProfiler
(
)
{
uprofiler_unregister_thread
(
)
;
}
}
;
#
endif
void
uprofiler_simple_event_marker
(
const
char
*
name
const
char
*
category
char
phase
)
;
#
ifdef
__cplusplus
class
AutoTrace
{
public
:
AutoTrace
(
const
char
*
name
const
char
*
category
)
:
name
(
name
)
category
(
category
)
{
uprofiler_simple_event_marker
(
name
category
'
B
'
)
;
}
~
AutoTrace
(
)
{
uprofiler_simple_event_marker
(
name
category
'
E
'
)
;
}
private
:
const
char
*
name
;
const
char
*
category
;
}
;
#
endif
#
endif
