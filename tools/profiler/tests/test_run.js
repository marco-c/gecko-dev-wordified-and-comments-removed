function
run_test
(
)
{
if
(
!
AppConstants
.
MOZ_GECKO_PROFILER
)
{
return
;
}
Assert
.
ok
(
!
Services
.
profiler
.
IsActive
(
)
)
;
Services
.
profiler
.
StartProfiler
(
1000
10
[
]
0
)
;
Assert
.
ok
(
Services
.
profiler
.
IsActive
(
)
)
;
do_test_pending
(
)
;
do_timeout
(
1000
function
wait
(
)
{
var
profileStr
=
Services
.
profiler
.
GetProfile
(
)
;
Assert
.
ok
(
profileStr
.
length
>
10
)
;
var
profileObj
=
Services
.
profiler
.
getProfileData
(
)
;
Assert
.
notEqual
(
profileObj
null
)
;
Assert
.
notEqual
(
profileObj
.
threads
null
)
;
Assert
.
notEqual
(
profileObj
.
counters
null
)
;
Assert
.
notEqual
(
profileObj
.
memory
null
)
;
Assert
.
ok
(
profileObj
.
threads
.
length
>
=
1
)
;
Assert
.
notEqual
(
profileObj
.
threads
[
0
]
.
samples
null
)
;
Services
.
profiler
.
StopProfiler
(
)
;
Assert
.
ok
(
!
Services
.
profiler
.
IsActive
(
)
)
;
do_test_finished
(
)
;
}
)
;
}
