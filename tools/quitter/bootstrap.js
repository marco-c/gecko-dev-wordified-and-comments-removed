ChromeUtils
.
import
(
"
resource
:
/
/
gre
/
modules
/
Services
.
jsm
"
)
;
const
CHILD_SCRIPT
=
"
chrome
:
/
/
quitter
/
content
/
contentscript
.
js
"
;
const
quitterObserver
=
{
init
(
)
{
Services
.
mm
.
addMessageListener
(
"
Quitter
.
Quit
"
this
)
;
Services
.
mm
.
loadFrameScript
(
CHILD_SCRIPT
true
)
;
}
uninit
(
)
{
Services
.
mm
.
removeMessageListener
(
"
Quitter
.
Quit
"
this
)
;
Services
.
mm
.
removeDelayedFrameScript
(
CHILD_SCRIPT
true
)
;
}
receiveMessage
(
aMessage
)
{
switch
(
aMessage
.
name
)
{
case
"
Quitter
.
Quit
"
:
Services
.
startup
.
quit
(
Ci
.
nsIAppStartup
.
eForceQuit
)
;
break
;
}
}
}
;
function
startup
(
data
reason
)
{
quitterObserver
.
init
(
)
;
}
function
shutdown
(
data
reason
)
{
quitterObserver
.
uninit
(
)
;
}
function
install
(
data
reason
)
{
}
function
uninstall
(
data
reason
)
{
}
