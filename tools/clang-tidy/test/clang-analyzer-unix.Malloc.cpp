#
include
"
structures
.
h
"
void
test_malloc
(
)
{
int
*
p
=
(
int
*
)
malloc
(
1
)
;
free
(
p
)
;
free
(
p
)
;
}
void
test_use_after_free
(
)
{
int
*
p
=
(
int
*
)
malloc
(
sizeof
(
int
)
)
;
free
(
p
)
;
*
p
=
1
;
}
void
test_leak
(
)
{
int
*
p
=
(
int
*
)
malloc
(
1
)
;
if
(
p
)
return
;
}
void
test_free_local
(
)
{
int
a
[
]
=
{
1
}
;
free
(
a
)
;
}
void
test_free_offset
(
)
{
int
*
p
=
(
int
*
)
malloc
(
sizeof
(
char
)
)
;
p
=
p
-
1
;
free
(
p
)
;
}
