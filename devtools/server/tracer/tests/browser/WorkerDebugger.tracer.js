"
use
strict
"
;
try
{
const
dbg
=
new
Debugger
(
global
)
;
const
[
debuggee
]
=
dbg
.
getDebuggees
(
)
;
const
{
JSTracer
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
devtools
/
server
/
tracer
/
tracer
.
sys
.
mjs
"
{
global
:
"
contextual
"
}
)
;
const
frames
=
[
]
;
const
listener
=
{
onTracingFrame
(
args
)
{
frames
.
push
(
args
)
;
return
true
;
}
}
;
JSTracer
.
addTracingListener
(
listener
)
;
JSTracer
.
startTracing
(
{
global
prefix
:
"
testWorkerPrefix
"
}
)
;
debuggee
.
executeInGlobal
(
"
foo
(
)
"
)
;
JSTracer
.
stopTracing
(
)
;
JSTracer
.
removeTracingListener
(
listener
)
;
postMessage
(
JSON
.
stringify
(
frames
)
)
;
}
catch
(
e
)
{
dump
(
"
Exception
while
running
debugger
test
script
:
"
+
e
+
"
\
n
"
+
e
.
stack
+
"
\
n
"
)
;
}
