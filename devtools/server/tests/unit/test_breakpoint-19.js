"
use
strict
"
;
const
URL
=
"
test
.
js
"
;
function
setUpCode
(
debuggee
)
{
Cu
.
evalInSandbox
(
"
"
+
function
test
(
)
{
var
a
=
1
;
debugger
;
}
+
"
\
ndebugger
;
"
debuggee
"
1
.
8
"
URL
)
;
}
add_task
(
threadClientTest
(
async
(
{
threadClient
debuggee
client
}
)
=
>
{
const
source
=
await
getSource
(
threadClient
URL
)
;
const
[
response
]
=
await
setBreakpoint
(
source
{
line
:
2
}
)
;
ok
(
!
response
.
error
)
;
const
actor
=
response
.
actor
;
ok
(
actor
)
;
await
executeOnNextTickAndWaitForPause
(
(
)
=
>
setUpCode
(
debuggee
)
client
)
;
await
resume
(
threadClient
)
;
const
packet
=
await
executeOnNextTickAndWaitForPause
(
debuggee
.
test
client
)
;
equal
(
packet
.
why
.
type
"
breakpoint
"
)
;
notEqual
(
packet
.
why
.
actors
.
indexOf
(
actor
)
-
1
)
;
}
)
)
;
