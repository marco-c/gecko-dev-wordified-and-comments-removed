"
use
strict
"
;
add_task
(
threadClientTest
(
(
{
client
}
)
=
>
{
return
new
Promise
(
resolve
=
>
{
const
onClosed
=
function
(
)
{
client
.
removeListener
(
"
closed
"
onClosed
)
;
ok
(
true
"
Client
emitted
'
closed
'
event
"
)
;
client
.
close
(
)
.
then
(
function
(
)
{
ok
(
true
"
client
.
close
(
)
successfully
called
its
callback
"
)
;
resolve
(
)
;
}
)
;
}
;
client
.
addListener
(
"
closed
"
onClosed
)
;
client
.
transport
.
close
(
)
;
}
)
;
}
)
)
;
