"
use
strict
"
;
add_task
(
async
function
(
)
{
let
client
=
await
startTestDebuggerServer
(
"
promises
-
actor
-
test
"
)
;
let
response
=
await
listTabs
(
client
)
;
let
targetTab
=
findTab
(
response
.
tabs
"
promises
-
actor
-
test
"
)
;
Assert
.
ok
(
targetTab
"
Found
our
target
tab
.
"
)
;
await
new
Promise
(
resolve
=
>
{
client
.
request
(
{
to
:
targetTab
.
actor
type
:
"
attach
"
}
response
=
>
{
Assert
.
ok
(
!
(
"
error
"
in
response
)
"
Expect
no
error
in
response
.
"
)
;
Assert
.
equal
(
response
.
from
targetTab
.
actor
"
Expect
the
target
TabActor
in
response
form
field
.
"
)
;
Assert
.
equal
(
response
.
type
"
tabAttached
"
"
Expect
tabAttached
in
the
response
type
.
"
)
;
Assert
.
ok
(
typeof
response
.
promisesActor
=
=
=
"
string
"
"
Should
have
a
tab
context
PromisesActor
.
"
)
;
resolve
(
)
;
}
)
;
}
)
;
let
chromeActors
=
await
getChromeActors
(
client
)
;
Assert
.
ok
(
typeof
chromeActors
.
promisesActor
=
=
=
"
string
"
"
Should
have
a
chrome
context
PromisesActor
.
"
)
;
}
)
;
