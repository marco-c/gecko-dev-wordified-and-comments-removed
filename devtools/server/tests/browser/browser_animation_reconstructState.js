"
use
strict
"
;
add_task
(
async
function
(
)
{
const
{
target
walker
animations
}
=
await
initAnimationsFrontForUrl
(
MAIN_DOMAIN
+
"
animation
.
html
"
)
;
await
playerHasCompleteStateAtAllTimes
(
walker
animations
)
;
await
target
.
destroy
(
)
;
gBrowser
.
removeCurrentTab
(
)
;
}
)
;
async
function
playerHasCompleteStateAtAllTimes
(
walker
animations
)
{
const
node
=
await
walker
.
querySelector
(
walker
.
rootNode
"
.
simple
-
animation
"
)
;
const
[
player
]
=
await
animations
.
getAnimationPlayersForNode
(
node
)
;
const
keys
=
Object
.
keys
(
player
.
initialState
)
;
for
(
let
i
=
0
;
i
<
10
;
i
+
+
)
{
await
player
.
refreshState
(
)
;
keys
.
forEach
(
key
=
>
{
Assert
.
notStrictEqual
(
typeof
player
.
state
[
key
]
"
undefined
"
"
The
state
retrieved
has
key
"
+
key
)
;
}
)
;
}
}
