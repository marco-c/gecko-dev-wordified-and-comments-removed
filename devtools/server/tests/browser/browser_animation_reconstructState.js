"
use
strict
"
;
add_task
(
async
function
(
)
{
let
{
client
walker
animations
}
=
await
initAnimationsFrontForUrl
(
MAIN_DOMAIN
+
"
animation
.
html
"
)
;
await
playerHasCompleteStateAtAllTimes
(
walker
animations
)
;
await
client
.
close
(
)
;
gBrowser
.
removeCurrentTab
(
)
;
}
)
;
async
function
playerHasCompleteStateAtAllTimes
(
walker
animations
)
{
let
node
=
await
walker
.
querySelector
(
walker
.
rootNode
"
.
simple
-
animation
"
)
;
let
[
player
]
=
await
animations
.
getAnimationPlayersForNode
(
node
)
;
await
player
.
ready
(
)
;
let
keys
=
Object
.
keys
(
player
.
initialState
)
;
for
(
let
i
=
0
;
i
<
10
;
i
+
+
)
{
await
player
.
refreshState
(
)
;
keys
.
forEach
(
key
=
>
{
ok
(
typeof
player
.
state
[
key
]
!
=
=
"
undefined
"
"
The
state
retrieved
has
key
"
+
key
)
;
}
)
;
}
}
