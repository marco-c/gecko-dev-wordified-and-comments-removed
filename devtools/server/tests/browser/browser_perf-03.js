"
use
strict
"
;
add_task
(
async
function
(
)
{
const
{
front
client
}
=
await
initPerfFront
(
)
;
is
(
await
front
.
isLockedForPrivateBrowsing
(
)
false
"
The
profiler
is
not
locked
for
private
browsing
.
"
)
;
const
profilerLocked
=
once
(
front
"
profile
-
locked
-
by
-
private
-
browsing
"
)
;
const
privateWindow
=
await
BrowserTestUtils
.
openNewBrowserWindow
(
{
private
:
true
}
)
;
await
profilerLocked
;
is
(
await
front
.
isLockedForPrivateBrowsing
(
)
true
"
The
profiler
is
now
locked
because
of
private
browsing
.
"
)
;
const
profilerUnlocked
=
once
(
front
"
profile
-
unlocked
-
from
-
private
-
browsing
"
)
;
await
BrowserTestUtils
.
closeWindow
(
privateWindow
)
;
await
profilerUnlocked
;
is
(
await
front
.
isLockedForPrivateBrowsing
(
)
false
"
The
profiler
is
available
again
after
closing
the
private
browsing
window
.
"
)
;
await
front
.
destroy
(
)
;
await
client
.
close
(
)
;
}
)
;
