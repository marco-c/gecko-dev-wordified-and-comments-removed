"
use
strict
"
;
add_task
(
async
function
test_extensionStorage_disabled_for_non_extension_target
(
)
{
if
(
isFissionEnabled
(
)
)
{
ok
(
true
"
This
test
is
not
relevant
when
fission
is
enabled
as
we
aren
'
t
using
listStores
"
)
;
return
;
}
info
(
"
Setting
up
and
connecting
DevTools
Server
and
Client
in
main
process
"
)
;
info
(
"
Opening
a
non
-
extension
page
in
a
tab
"
)
;
const
target
=
await
addTabTarget
(
"
data
:
text
/
html
;
charset
=
utf
-
8
"
)
;
info
(
"
Getting
all
stores
for
the
target
process
"
)
;
const
storageFront
=
await
target
.
getFront
(
"
storage
"
)
;
const
stores
=
await
storageFront
.
listStores
(
)
;
ok
(
!
(
"
extensionStorage
"
in
stores
)
"
Should
not
have
an
extensionStorage
store
when
non
-
extension
process
is
targeted
"
)
;
await
target
.
destroy
(
)
;
gBrowser
.
removeCurrentTab
(
)
;
}
)
;
