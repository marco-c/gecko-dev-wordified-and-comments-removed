"
use
strict
"
;
const
{
accessibility
:
{
AUDIT_TYPE
:
{
TEXT_LABEL
}
SCORES
:
{
FAIL
}
ISSUE_TYPE
:
{
[
TEXT_LABEL
]
:
{
FRAME_NO_NAME
}
}
}
}
=
require
(
"
devtools
/
shared
/
constants
"
)
;
add_task
(
async
function
(
)
{
const
{
target
walker
accessibility
}
=
await
initAccessibilityFrontForUrl
(
{
MAIN_DOMAIN
}
doc_accessibility_text_label_audit_frame
.
html
)
;
const
a11yWalker
=
await
accessibility
.
getWalker
(
)
;
await
accessibility
.
enable
(
)
;
const
tests
=
[
[
"
Frame
with
no
name
"
"
#
frame
-
1
"
{
score
:
FAIL
issue
:
FRAME_NO_NAME
}
]
[
"
Frame
with
aria
-
label
"
"
#
frame
-
2
"
null
]
]
;
for
(
const
[
description
selector
expected
]
of
tests
)
{
info
(
description
)
;
const
node
=
await
walker
.
querySelector
(
walker
.
rootNode
selector
)
;
const
front
=
await
a11yWalker
.
getAccessibleFor
(
node
)
;
const
audit
=
await
front
.
audit
(
{
types
:
[
TEXT_LABEL
]
}
)
;
Assert
.
deepEqual
(
audit
[
TEXT_LABEL
]
expected
Audit
result
for
{
selector
}
is
correct
.
)
;
}
await
accessibility
.
disable
(
)
;
await
waitForA11yShutdown
(
)
;
await
target
.
destroy
(
)
;
gBrowser
.
removeCurrentTab
(
)
;
}
)
;
