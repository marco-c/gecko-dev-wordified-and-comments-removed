"
use
strict
"
;
requestLongerTimeout
(
2
)
;
add_task
(
async
function
(
)
{
const
{
front
client
}
=
await
initPerfFront
(
)
;
is
(
await
front
.
isSupportedPlatform
(
)
true
"
This
test
only
runs
on
supported
platforms
.
"
)
;
is
(
await
front
.
isActive
(
)
false
"
The
profiler
is
not
active
yet
.
"
)
;
const
profilerStarted
=
once
(
front
"
profiler
-
started
"
)
;
await
front
.
startProfiler
(
)
;
await
profilerStarted
;
is
(
await
front
.
isActive
(
)
true
"
The
profiler
was
started
.
"
)
;
const
profilerStopped1
=
once
(
front
"
profiler
-
stopped
"
)
;
const
profile
=
await
front
.
getProfileAndStopProfiler
(
)
;
await
profilerStopped1
;
is
(
await
front
.
isActive
(
)
false
"
The
profiler
was
stopped
.
"
)
;
ok
(
"
threads
"
in
profile
"
The
actor
was
used
to
record
a
profile
.
"
)
;
await
front
.
startProfiler
(
)
;
is
(
await
front
.
isActive
(
)
true
"
The
profiler
was
re
-
started
.
"
)
;
const
profilerStopped2
=
once
(
front
"
profiler
-
stopped
"
)
;
await
front
.
stopProfilerAndDiscardProfile
(
)
;
await
profilerStopped2
;
is
(
await
front
.
isActive
(
)
false
"
The
profiler
was
stopped
and
the
profile
discarded
.
"
)
;
await
front
.
destroy
(
)
;
await
client
.
close
(
)
;
}
)
;
