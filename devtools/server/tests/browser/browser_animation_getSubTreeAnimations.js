"
use
strict
"
;
const
URL
=
MAIN_DOMAIN
+
"
animation
.
html
"
;
Services
.
scriptloader
.
loadSubScript
(
"
chrome
:
/
/
mochitests
/
content
/
browser
/
devtools
/
client
/
inspector
/
test
/
shared
-
head
.
js
"
this
)
;
add_task
(
async
function
(
)
{
info
(
"
Creating
a
test
document
with
2
iframes
containing
animated
nodes
"
)
;
const
{
inspector
target
walker
animations
}
=
await
initAnimationsFrontForUrl
(
"
data
:
text
/
html
;
charset
=
utf
-
8
"
+
"
<
iframe
id
=
'
iframe
'
src
=
'
"
+
URL
+
"
'
>
<
/
iframe
>
"
)
;
info
(
"
Try
retrieving
all
animations
from
the
root
doc
'
s
<
body
>
node
"
)
;
const
rootBody
=
await
walker
.
querySelector
(
walker
.
rootNode
"
body
"
)
;
let
players
=
await
animations
.
getAnimationPlayersForNode
(
rootBody
)
;
is
(
players
.
length
0
"
The
node
has
no
animation
players
"
)
;
info
(
"
Retrieve
all
animations
from
the
iframe
'
s
<
body
>
node
"
)
;
const
frameBody
=
await
getNodeFrontInFrames
(
[
"
#
iframe
"
"
body
"
]
inspector
)
;
const
animationsForFrame
=
await
frameBody
.
targetFront
.
getFront
(
"
animations
"
)
;
players
=
await
animationsForFrame
.
getAnimationPlayersForNode
(
frameBody
)
;
Assert
.
greaterOrEqual
(
players
.
length
4
"
All
subtree
animations
were
retrieved
"
)
;
await
target
.
destroy
(
)
;
gBrowser
.
removeCurrentTab
(
)
;
}
)
;
