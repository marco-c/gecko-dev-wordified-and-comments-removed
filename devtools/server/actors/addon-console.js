"
use
strict
"
;
var
{
ConsoleAPIListener
}
=
require
(
"
devtools
/
server
/
actors
/
webconsole
/
listeners
"
)
;
var
{
update
}
=
require
(
"
devtools
/
shared
/
DevToolsUtils
"
)
;
loader
.
lazyRequireGetter
(
this
"
WebConsoleActor
"
"
devtools
/
server
/
actors
/
webconsole
"
true
)
;
function
AddonConsoleActor
(
addon
connection
parentActor
)
{
this
.
addon
=
addon
;
WebConsoleActor
.
call
(
this
connection
parentActor
)
;
}
AddonConsoleActor
.
prototype
=
Object
.
create
(
WebConsoleActor
.
prototype
)
;
update
(
AddonConsoleActor
.
prototype
{
constructor
:
AddonConsoleActor
actorPrefix
:
"
addonConsole
"
addon
:
null
get
window
(
)
{
return
this
.
parentActor
.
global
;
}
destroy
(
)
{
WebConsoleActor
.
prototype
.
destroy
.
call
(
this
)
;
this
.
addon
=
null
;
}
onStartListeners
:
function
ACAOnStartListeners
(
request
)
{
let
startedListeners
=
[
]
;
while
(
request
.
listeners
.
length
>
0
)
{
let
listener
=
request
.
listeners
.
shift
(
)
;
switch
(
listener
)
{
case
"
ConsoleAPI
"
:
if
(
!
this
.
consoleAPIListener
)
{
this
.
consoleAPIListener
=
new
ConsoleAPIListener
(
null
this
{
addonId
:
this
.
addon
.
id
}
)
;
this
.
consoleAPIListener
.
init
(
)
;
}
startedListeners
.
push
(
listener
)
;
break
;
}
}
return
{
startedListeners
:
startedListeners
nativeConsoleAPI
:
true
traits
:
this
.
traits
}
;
}
}
)
;
AddonConsoleActor
.
prototype
.
requestTypes
=
Object
.
create
(
WebConsoleActor
.
prototype
.
requestTypes
)
;
AddonConsoleActor
.
prototype
.
requestTypes
.
startListeners
=
AddonConsoleActor
.
prototype
.
onStartListeners
;
exports
.
AddonConsoleActor
=
AddonConsoleActor
;
