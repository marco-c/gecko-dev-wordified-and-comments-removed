"
use
strict
"
;
class
StdoutTracingListener
{
constructor
(
{
targetActor
traceValues
traceActor
}
)
{
this
.
targetActor
=
targetActor
;
this
.
traceValues
=
traceValues
;
this
.
sourcesManager
=
targetActor
.
sourcesManager
;
this
.
traceActor
=
traceActor
;
}
stop
(
)
{
}
onTracingToggled
(
enabled
)
{
if
(
!
enabled
)
{
this
.
traceActor
.
stopTracing
(
)
;
}
return
true
;
}
onTracingPending
(
)
{
return
true
;
}
onTracingDOMMutation
(
{
depth
prefix
type
caller
element
}
)
{
return
true
;
}
onTracingFrameStep
(
{
frame
depth
prefix
}
)
{
const
{
script
}
=
frame
;
const
{
lineNumber
columnNumber
}
=
script
.
getOffsetMetadata
(
frame
.
offset
)
;
const
url
=
script
.
source
.
url
;
const
columnBase
=
script
.
format
=
=
=
"
wasm
"
?
0
:
1
;
const
column
=
columnNumber
-
columnBase
;
if
(
this
.
sourcesManager
.
isBlackBoxed
(
url
lineNumber
column
)
)
{
return
false
;
}
return
true
;
}
onTracingFrame
(
{
frame
depth
formatedDisplayName
prefix
currentDOMEvent
}
)
{
const
{
script
}
=
frame
;
const
{
lineNumber
columnNumber
}
=
script
.
getOffsetMetadata
(
frame
.
offset
)
;
const
url
=
script
.
source
.
url
;
const
columnBase
=
script
.
format
=
=
=
"
wasm
"
?
0
:
1
;
const
column
=
columnNumber
-
columnBase
;
if
(
this
.
sourcesManager
.
isBlackBoxed
(
url
lineNumber
column
)
)
{
return
false
;
}
return
true
;
}
onTracingFrameExit
(
{
frameId
frame
depth
formatedDisplayName
prefix
why
rv
}
)
{
const
{
script
}
=
frame
;
const
{
lineNumber
columnNumber
}
=
script
.
getOffsetMetadata
(
frame
.
offset
)
;
const
url
=
script
.
source
.
url
;
const
columnBase
=
script
.
format
=
=
=
"
wasm
"
?
0
:
1
;
const
column
=
columnNumber
-
columnBase
;
if
(
this
.
sourcesManager
.
isBlackBoxed
(
url
lineNumber
column
)
)
{
return
false
;
}
return
true
;
}
}
exports
.
StdoutTracingListener
=
StdoutTracingListener
;
