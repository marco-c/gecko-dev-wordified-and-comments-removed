"
use
strict
"
;
let
gWorker
;
let
gCallback
;
let
gNextConnectionId
=
1
;
function
Initialize
(
callback
)
{
gWorker
=
new
Worker
(
"
connection
-
worker
.
js
"
)
;
gWorker
.
addEventListener
(
"
message
"
onMessage
)
;
gCallback
=
callback
;
}
function
onMessage
(
evt
)
{
gCallback
(
evt
.
data
.
id
evt
.
data
.
buf
)
;
}
function
Connect
(
channelId
address
callback
)
{
const
id
=
gNextConnectionId
+
+
;
gWorker
.
postMessage
(
{
type
:
"
connect
"
id
channelId
address
}
)
;
return
id
;
}
function
SendMessage
(
id
buf
)
{
gWorker
.
postMessage
(
{
type
:
"
send
"
id
buf
}
)
;
}
var
EXPORTED_SYMBOLS
=
[
"
Initialize
"
"
Connect
"
"
SendMessage
"
]
;
