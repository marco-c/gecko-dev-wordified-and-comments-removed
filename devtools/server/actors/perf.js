"
use
strict
"
;
const
{
Actor
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
protocol
.
js
"
)
;
const
{
perfSpec
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
specs
/
perf
.
js
"
)
;
const
{
actorBridgeWithSpec
}
=
require
(
"
resource
:
/
/
devtools
/
server
/
actors
/
common
.
js
"
)
;
const
{
ActorReadyGeckoProfilerInterface
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
performance
-
new
/
gecko
-
profiler
-
interface
.
js
"
)
;
function
_bridgeEvents
(
actor
names
)
{
for
(
const
name
of
names
)
{
actor
.
bridge
.
on
(
name
(
.
.
.
args
)
=
>
actor
.
emit
(
name
.
.
.
args
)
)
;
}
}
exports
.
PerfActor
=
class
PerfActor
extends
Actor
{
constructor
(
conn
targetActor
)
{
super
(
conn
perfSpec
)
;
this
.
bridge
=
new
ActorReadyGeckoProfilerInterface
(
)
;
_bridgeEvents
(
this
[
"
profiler
-
started
"
"
profiler
-
stopped
"
]
)
;
}
destroy
(
)
{
super
.
destroy
(
)
;
this
.
bridge
.
destroy
(
)
;
}
startProfiler
=
actorBridgeWithSpec
(
"
startProfiler
"
)
;
stopProfilerAndDiscardProfile
=
actorBridgeWithSpec
(
"
stopProfilerAndDiscardProfile
"
)
;
getSymbolTable
=
actorBridgeWithSpec
(
"
getSymbolTable
"
)
;
getProfileAndStopProfiler
=
actorBridgeWithSpec
(
"
getProfileAndStopProfiler
"
)
;
isActive
=
actorBridgeWithSpec
(
"
isActive
"
)
;
isSupportedPlatform
=
actorBridgeWithSpec
(
"
isSupportedPlatform
"
)
;
getSupportedFeatures
=
actorBridgeWithSpec
(
"
getSupportedFeatures
"
)
;
}
;
