"
use
strict
"
;
const
protocol
=
require
(
"
devtools
/
shared
/
protocol
"
)
;
const
{
method
custom
Arg
Option
RetVal
}
=
protocol
;
const
{
Cu
CC
components
}
=
require
(
"
chrome
"
)
;
const
Services
=
require
(
"
Services
"
)
;
const
{
DebuggerServer
}
=
require
(
"
devtools
/
server
/
main
"
)
;
const
{
registerActor
unregisterActor
}
=
require
(
"
devtools
/
server
/
actors
/
utils
/
actor
-
registry
-
utils
"
)
;
const
{
actorActorSpec
actorRegistrySpec
}
=
require
(
"
devtools
/
shared
/
specs
/
actor
-
registry
"
)
;
const
ActorActor
=
protocol
.
ActorClass
(
actorActorSpec
{
initialize
:
function
(
conn
options
)
{
protocol
.
Actor
.
prototype
.
initialize
.
call
(
this
conn
)
;
this
.
options
=
options
;
}
unregister
:
function
(
)
{
unregisterActor
(
this
.
options
)
;
}
}
)
;
const
ActorRegistryActor
=
protocol
.
ActorClass
(
actorRegistrySpec
{
initialize
:
function
(
conn
)
{
protocol
.
Actor
.
prototype
.
initialize
.
call
(
this
conn
)
;
}
registerActor
:
function
(
sourceText
fileName
options
)
{
return
registerActor
(
sourceText
fileName
options
)
.
then
(
(
)
=
>
{
let
{
constructor
type
}
=
options
;
return
ActorActor
(
this
.
conn
{
name
:
constructor
tab
:
type
.
tab
global
:
type
.
global
}
)
;
}
)
;
}
}
)
;
exports
.
ActorRegistryActor
=
ActorRegistryActor
;
