"
use
strict
"
;
const
{
Actor
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
protocol
.
js
"
)
;
const
{
breakpointListSpec
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
specs
/
breakpoint
-
list
.
js
"
)
;
const
{
SessionDataHelpers
}
=
require
(
"
resource
:
/
/
devtools
/
server
/
actors
/
watcher
/
SessionDataHelpers
.
jsm
"
)
;
const
{
SUPPORTED_DATA
}
=
SessionDataHelpers
;
const
{
BREAKPOINTS
XHR_BREAKPOINTS
EVENT_BREAKPOINTS
}
=
SUPPORTED_DATA
;
class
BreakpointListActor
extends
Actor
{
constructor
(
watcherActor
)
{
super
(
watcherActor
.
conn
breakpointListSpec
)
;
this
.
watcherActor
=
watcherActor
;
}
setBreakpoint
(
location
options
)
{
return
this
.
watcherActor
.
addDataEntry
(
BREAKPOINTS
[
{
location
options
}
]
)
;
}
removeBreakpoint
(
location
options
)
{
return
this
.
watcherActor
.
removeDataEntry
(
BREAKPOINTS
[
{
location
options
}
]
)
;
}
setXHRBreakpoint
(
path
method
)
{
return
this
.
watcherActor
.
addDataEntry
(
XHR_BREAKPOINTS
[
{
path
method
}
]
)
;
}
removeXHRBreakpoint
(
path
method
)
{
return
this
.
watcherActor
.
removeDataEntry
(
XHR_BREAKPOINTS
[
{
path
method
}
]
)
;
}
setActiveEventBreakpoints
(
ids
)
{
const
existingIds
=
this
.
watcherActor
.
getSessionDataForType
(
EVENT_BREAKPOINTS
)
|
|
[
]
;
const
addIds
=
ids
.
filter
(
id
=
>
!
existingIds
.
includes
(
id
)
)
;
const
removeIds
=
existingIds
.
filter
(
id
=
>
!
ids
.
includes
(
id
)
)
;
if
(
addIds
.
length
)
{
this
.
watcherActor
.
addDataEntry
(
EVENT_BREAKPOINTS
addIds
)
;
}
if
(
removeIds
.
length
)
{
this
.
watcherActor
.
removeDataEntry
(
EVENT_BREAKPOINTS
removeIds
)
;
}
}
}
exports
.
BreakpointListActor
=
BreakpointListActor
;
