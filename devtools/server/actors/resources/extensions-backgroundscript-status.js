"
use
strict
"
;
loader
.
lazyImporter
(
this
"
ExtensionParent
"
"
resource
:
/
/
gre
/
modules
/
ExtensionParent
.
jsm
"
)
;
const
{
TYPES
:
{
EXTENSIONS_BGSCRIPT_STATUS
}
}
=
require
(
"
devtools
/
server
/
actors
/
resources
/
index
"
)
;
class
ExtensionsBackgroundScriptStatusWatcher
{
async
watch
(
rootActor
{
onAvailable
onUpdated
}
)
{
this
.
rootActor
=
rootActor
;
this
.
onAvailable
=
onAvailable
;
this
.
onUpdated
=
onUpdated
;
this
.
unwatchBackgroundStatusUpdates
=
ExtensionParent
.
DebugUtils
.
watchBackgroundScriptStatusUpdates
(
this
.
onBackgroundScriptStatus
)
;
}
onBackgroundScriptStatus
=
(
addonId
isRunning
)
=
>
{
this
.
onAvailable
(
[
{
resourceType
:
EXTENSIONS_BGSCRIPT_STATUS
payload
:
{
addonId
isRunning
}
}
]
)
;
}
;
destroy
(
)
{
this
.
unwatchBackgroundStatusUpdates
?
.
(
)
;
}
}
module
.
exports
=
ExtensionsBackgroundScriptStatusWatcher
;
