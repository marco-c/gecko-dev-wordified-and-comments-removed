"
use
strict
"
;
var
{
Cr
}
=
require
(
"
chrome
"
)
;
var
{
BrowsingContextTargetActor
browsingContextTargetPrototype
}
=
require
(
"
devtools
/
server
/
actors
/
targets
/
browsing
-
context
"
)
;
const
{
extend
}
=
require
(
"
devtools
/
shared
/
extend
"
)
;
const
{
ActorClassWithSpec
}
=
require
(
"
devtools
/
shared
/
protocol
"
)
;
const
{
frameTargetSpec
}
=
require
(
"
devtools
/
shared
/
specs
/
targets
/
frame
"
)
;
const
frameTargetPrototype
=
extend
(
{
}
browsingContextTargetPrototype
)
;
frameTargetPrototype
.
initialize
=
function
(
connection
docShell
)
{
BrowsingContextTargetActor
.
prototype
.
initialize
.
call
(
this
connection
)
;
this
.
_messageManager
=
docShell
.
messageManager
;
this
.
traits
.
reconfigure
=
false
;
this
.
_sendForm
=
this
.
_sendForm
.
bind
(
this
)
;
this
.
_messageManager
.
addMessageListener
(
"
debug
:
form
"
this
.
_sendForm
)
;
Object
.
defineProperty
(
this
"
docShell
"
{
value
:
docShell
configurable
:
true
}
)
;
}
;
Object
.
defineProperty
(
frameTargetPrototype
"
title
"
{
get
:
function
(
)
{
return
this
.
window
.
document
.
title
;
}
enumerable
:
true
configurable
:
true
}
)
;
frameTargetPrototype
.
exit
=
function
(
)
{
if
(
this
.
_sendForm
)
{
try
{
this
.
_messageManager
.
removeMessageListener
(
"
debug
:
form
"
this
.
_sendForm
)
;
}
catch
(
e
)
{
if
(
e
.
result
!
=
Cr
.
NS_ERROR_NULL_POINTER
)
{
throw
e
;
}
}
this
.
_sendForm
=
null
;
}
BrowsingContextTargetActor
.
prototype
.
exit
.
call
(
this
)
;
this
.
_messageManager
=
null
;
}
;
frameTargetPrototype
.
_sendForm
=
function
(
)
{
this
.
_messageManager
.
sendAsyncMessage
(
"
debug
:
form
"
this
.
form
(
)
)
;
}
;
exports
.
FrameTargetActor
=
ActorClassWithSpec
(
frameTargetSpec
frameTargetPrototype
)
;
