"
use
strict
"
;
const
BackgroundJSM
=
ChromeUtils
.
import
(
"
resource
:
/
/
devtools
/
client
/
performance
-
new
/
popup
/
background
.
jsm
.
js
"
)
;
registerCleanupFunction
(
(
)
=
>
{
BackgroundJSM
.
revertRecordingSettings
(
)
;
}
)
;
const
{
require
}
=
ChromeUtils
.
importESModule
(
"
resource
:
/
/
devtools
/
shared
/
loader
/
Loader
.
sys
.
mjs
"
)
;
{
const
{
getEnvironmentVariable
}
=
require
(
"
resource
:
/
/
devtools
/
client
/
performance
-
new
/
browser
.
js
"
)
;
if
(
getEnvironmentVariable
(
"
MOZ_PROFILER_SHUTDOWN
"
)
)
{
throw
new
Error
(
"
These
tests
cannot
be
run
with
shutdown
profiling
as
they
rely
on
manipulating
"
+
"
the
state
of
the
profiler
.
"
)
;
}
if
(
getEnvironmentVariable
(
"
MOZ_PROFILER_STARTUP
"
)
)
{
throw
new
Error
(
"
These
tests
cannot
be
run
with
startup
profiling
as
they
rely
on
manipulating
"
+
"
the
state
of
the
profiler
.
"
)
;
}
}
Services
.
scriptloader
.
loadSubScript
(
"
chrome
:
/
/
mochitests
/
content
/
browser
/
devtools
/
client
/
performance
-
new
/
test
/
browser
/
helpers
.
js
"
this
)
;
