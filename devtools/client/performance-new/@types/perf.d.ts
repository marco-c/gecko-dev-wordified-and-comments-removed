import
{
Reducer
as
ReduxReducer
Store
as
ReduxStore
}
from
"
resource
:
/
/
devtools
/
client
/
shared
/
vendor
/
redux
.
js
"
;
export
interface
PanelWindow
{
gToolbox
?
:
any
;
gStore
?
:
Store
;
gInit
(
perfFront
:
PerfFront
traits
:
RootTraits
pageContext
:
PageContext
openAboutProfiling
:
(
)
=
>
void
)
:
Promise
<
void
>
;
gDestroy
(
)
:
void
;
gIsPanelDestroyed
?
:
boolean
;
}
export
interface
Target
{
client
:
any
;
}
export
interface
Toolbox
{
target
:
Target
;
}
export
interface
Commands
{
client
:
any
;
targetCommand
:
{
targetFront
:
{
getTrait
(
traitName
:
string
)
:
unknown
;
}
;
}
;
}
export
interface
PerfFront
{
startProfiler
:
(
options
:
RecordingSettings
)
=
>
Promise
<
boolean
>
;
getProfileAndStopProfiler
:
(
)
=
>
Promise
<
MockedExports
.
ProfileAndAdditionalInformation
>
;
stopProfilerAndDiscardProfile
:
(
)
=
>
Promise
<
void
>
;
getSymbolTable
:
(
path
:
string
breakpadId
:
string
)
=
>
Promise
<
[
number
[
]
number
[
]
number
[
]
]
>
;
isActive
:
(
)
=
>
Promise
<
boolean
>
;
isSupportedPlatform
:
(
)
=
>
Promise
<
boolean
>
;
on
:
(
type
:
string
listener
:
(
)
=
>
void
)
=
>
void
;
off
:
(
type
:
string
listener
:
(
)
=
>
void
)
=
>
void
;
destroy
:
(
)
=
>
void
;
getSupportedFeatures
:
(
)
=
>
Promise
<
string
[
]
>
;
}
export
interface
PreferenceFront
{
clearUserPref
:
(
prefName
:
string
)
=
>
Promise
<
void
>
;
getStringPref
:
(
prefName
:
string
)
=
>
Promise
<
string
>
;
setStringPref
:
(
prefName
:
string
value
:
string
)
=
>
Promise
<
void
>
;
getCharPref
:
(
prefName
:
string
)
=
>
Promise
<
string
>
;
setCharPref
:
(
prefName
:
string
value
:
string
)
=
>
Promise
<
void
>
;
getIntPref
:
(
prefName
:
string
)
=
>
Promise
<
number
>
;
setIntPref
:
(
prefName
:
string
value
:
number
)
=
>
Promise
<
void
>
;
}
export
interface
RootTraits
{
}
export
type
RecordingState
=
|
"
not
-
yet
-
known
"
|
"
available
-
to
-
record
"
|
"
request
-
to
-
start
-
recording
"
|
"
request
-
to
-
get
-
profile
-
and
-
stop
-
profiler
"
|
"
request
-
to
-
stop
-
profiler
"
|
"
recording
"
;
export
type
PageContext
=
|
"
devtools
"
|
"
devtools
-
remote
"
|
"
aboutlogging
"
|
"
aboutprofiling
"
|
"
aboutprofiling
-
remote
"
;
export
type
PrefPostfix
=
"
"
|
"
.
remote
"
;
export
interface
State
{
recordingState
:
RecordingState
;
recordingUnexpectedlyStopped
:
boolean
;
isSupportedPlatform
:
boolean
|
null
;
recordingSettings
:
RecordingSettings
;
initializedValues
:
InitializedValues
|
null
;
promptEnvRestart
:
null
|
string
;
}
export
type
Selector
<
T
>
=
(
state
:
State
)
=
>
T
;
export
type
ThunkDispatch
=
<
Returns
>
(
action
:
ThunkAction
<
Returns
>
)
=
>
Returns
;
export
type
PlainDispatch
=
(
action
:
Action
)
=
>
Action
;
export
type
GetState
=
(
)
=
>
State
;
export
type
SymbolTableAsTuple
=
[
Uint32Array
Uint32Array
Uint8Array
]
;
export
type
ProfilerFaviconData
=
{
data
:
ArrayBuffer
;
mimeType
:
string
;
}
;
export
type
Dispatch
=
PlainDispatch
&
ThunkDispatch
;
export
type
ThunkAction
<
Returns
>
=
(
{
dispatch
getState
}
:
{
dispatch
:
Dispatch
;
getState
:
GetState
;
}
)
=
>
Returns
;
export
interface
Library
{
start
:
number
;
end
:
number
;
offset
:
number
;
name
:
string
;
path
:
string
;
debugName
:
string
;
debugPath
:
string
;
breakpadId
:
string
;
arch
:
string
;
}
export
type
GetSymbolTableCallback
=
(
debugName
:
string
breakpadId
:
string
)
=
>
Promise
<
SymbolTableAsTuple
>
;
export
interface
SymbolicationService
{
getSymbolTable
:
GetSymbolTableCallback
;
querySymbolicationApi
:
(
path
:
string
requestJson
:
string
)
=
>
Promise
<
string
>
;
}
export
type
OnProfileReceived
=
(
profileAndAdditionalInformation
:
MockedExports
.
ProfileAndAdditionalInformation
|
null
error
?
:
Error
|
string
)
=
>
void
;
export
type
GetActiveBrowserID
=
(
)
=
>
number
;
export
interface
RecordingSettings
{
presetName
:
string
;
entries
:
number
;
interval
:
number
;
features
:
string
[
]
;
threads
:
string
[
]
;
objdirs
:
string
[
]
;
duration
?
:
number
;
}
export
type
Reducer
<
S
>
=
(
state
:
S
|
undefined
action
:
Action
)
=
>
S
;
export
interface
InitializedValues
{
presets
:
Presets
;
pageContext
:
PageContext
;
supportedFeatures
:
string
[
]
;
openRemoteDevTools
?
:
(
)
=
>
void
;
}
export
type
Store
=
ReduxStore
<
State
Action
>
;
export
type
Action
=
|
{
type
:
"
REPORT_PROFILER_READY
"
;
isActive
:
boolean
;
}
|
{
type
:
"
REPORT_PROFILER_STARTED
"
;
}
|
{
type
:
"
REPORT_PROFILER_STOPPED
"
;
}
|
{
type
:
"
REQUESTING_TO_START_RECORDING
"
;
}
|
{
type
:
"
REQUESTING_TO_STOP_RECORDING
"
;
}
|
{
type
:
"
REQUESTING_PROFILE
"
;
}
|
{
type
:
"
OBTAINED_PROFILE
"
;
}
|
{
type
:
"
CHANGE_INTERVAL
"
;
interval
:
number
;
}
|
{
type
:
"
CHANGE_ENTRIES
"
;
entries
:
number
;
}
|
{
type
:
"
CHANGE_FEATURES
"
;
features
:
string
[
]
;
promptEnvRestart
:
string
|
null
;
}
|
{
type
:
"
CHANGE_THREADS
"
;
threads
:
string
[
]
;
}
|
{
type
:
"
CHANGE_OBJDIRS
"
;
objdirs
:
string
[
]
;
}
|
{
type
:
"
INITIALIZE_STORE
"
;
isSupportedPlatform
:
boolean
;
presets
:
Presets
;
pageContext
:
PageContext
;
openRemoteDevTools
?
:
(
)
=
>
void
;
supportedFeatures
:
string
[
]
;
}
|
{
type
:
"
CHANGE_PRESET
"
;
presetName
:
string
;
preset
:
PresetDefinition
|
undefined
;
}
|
{
type
:
"
UPDATE_SETTINGS_FROM_PREFERENCES
"
;
recordingSettingsFromPreferences
:
RecordingSettings
;
}
;
export
interface
InitializeStoreValues
{
isSupportedPlatform
:
boolean
;
presets
:
Presets
;
pageContext
:
PageContext
;
supportedFeatures
:
string
[
]
;
openRemoteDevTools
?
:
(
)
=
>
void
;
}
export
type
PopupBackgroundFeatures
=
{
[
feature
:
string
]
:
boolean
}
;
export
interface
ContentFrameMessageManager
{
addMessageListener
:
(
event
:
string
listener
:
(
event
:
any
)
=
>
void
)
=
>
void
;
addEventListener
:
(
event
:
string
listener
:
(
event
:
any
)
=
>
void
)
=
>
void
;
sendAsyncMessage
:
(
name
:
string
data
:
any
)
=
>
void
;
}
export
interface
PerformancePref
{
Preset
:
"
devtools
.
performance
.
recording
.
preset
"
;
Entries
:
"
devtools
.
performance
.
recording
.
entries
"
;
Interval
:
"
devtools
.
performance
.
recording
.
interval
"
;
Features
:
"
devtools
.
performance
.
recording
.
features
"
;
Threads
:
"
devtools
.
performance
.
recording
.
threads
"
;
ObjDirs
:
"
devtools
.
performance
.
recording
.
objdirs
"
;
Duration
:
"
devtools
.
performance
.
recording
.
duration
"
;
UIBaseUrl
:
"
devtools
.
performance
.
recording
.
ui
-
base
-
url
"
;
UIBaseUrlPathPref
:
"
devtools
.
performance
.
recording
.
ui
-
base
-
url
-
path
"
;
UIEnableActiveTabView
:
"
devtools
.
performance
.
recording
.
active
-
tab
-
view
.
enabled
"
;
PopupIntroDisplayed
:
"
devtools
.
performance
.
popup
.
intro
-
displayed
"
;
PopupFeatureFlag
:
"
devtools
.
performance
.
popup
.
feature
-
flag
"
;
AboutProfilingHasDeveloperOptions
:
"
devtools
.
performance
.
aboutprofiling
.
has
-
developer
-
options
"
;
}
export
type
PrefObserverFunction
=
(
aSubject
:
nsIPrefBranch
aTopic
:
"
nsPref
:
changed
"
aData
:
string
)
=
>
unknown
;
export
type
PrefObserver
=
|
PrefObserverFunction
|
{
observe
:
PrefObserverFunction
}
;
export
type
NumberScaler
=
(
value
:
number
)
=
>
number
;
export
interface
ScaleFunctions
{
fromFractionToValue
:
NumberScaler
;
fromValueToFraction
:
NumberScaler
;
fromFractionToSingleDigitValue
:
NumberScaler
;
steps
:
number
;
}
export
type
ProfilerViewMode
=
"
full
"
|
"
active
-
tab
"
|
"
origins
"
;
export
type
ProfilerPanel
=
|
"
calltree
"
|
"
flame
-
graph
"
|
"
stack
-
chart
"
|
"
marker
-
chart
"
|
"
marker
-
table
"
|
"
network
-
chart
"
|
"
js
-
tracer
"
;
export
interface
PresetDefinition
{
entries
:
number
;
interval
:
number
;
features
:
string
[
]
;
threads
:
string
[
]
;
duration
:
number
;
profilerViewMode
?
:
ProfilerViewMode
;
l10nIds
:
{
popup
:
{
label
:
string
;
description
:
string
;
}
;
devtools
:
{
label
:
string
;
description
:
string
;
}
;
}
;
}
export
interface
Presets
{
[
presetName
:
string
]
:
PresetDefinition
;
}
type
MessageFromFrontend
=
{
requestId
:
number
;
}
&
RequestFromFrontend
;
export
type
RequestFromFrontend
=
|
StatusQueryRequest
|
EnableMenuButtonRequest
|
GetProfileRequest
|
GetExternalMarkersRequest
|
GetExternalPowerTracksRequest
|
GetSymbolTableRequest
|
QuerySymbolicationApiRequest
|
GetPageFaviconsRequest
|
OpenScriptInTabDebuggerRequest
;
type
StatusQueryRequest
=
{
type
:
"
STATUS_QUERY
"
}
;
type
EnableMenuButtonRequest
=
{
type
:
"
ENABLE_MENU_BUTTON
"
}
;
type
GetProfileRequest
=
{
type
:
"
GET_PROFILE
"
}
;
type
GetExternalMarkersRequest
=
{
type
:
"
GET_EXTERNAL_MARKERS
"
;
startTime
:
number
;
endTime
:
number
;
}
;
type
GetExternalPowerTracksRequest
=
{
type
:
"
GET_EXTERNAL_POWER_TRACKS
"
;
startTime
:
number
;
endTime
:
number
;
}
;
type
GetSymbolTableRequest
=
{
type
:
"
GET_SYMBOL_TABLE
"
;
debugName
:
string
;
breakpadId
:
string
;
}
;
type
QuerySymbolicationApiRequest
=
{
type
:
"
QUERY_SYMBOLICATION_API
"
;
path
:
string
;
requestJson
:
string
;
}
;
type
GetPageFaviconsRequest
=
{
type
:
"
GET_PAGE_FAVICONS
"
;
pageUrls
:
Array
<
string
>
;
}
;
type
OpenScriptInTabDebuggerRequest
=
{
type
:
"
OPEN_SCRIPT_IN_DEBUGGER
"
;
tabId
:
number
;
scriptUrl
:
string
;
line
:
number
;
column
:
number
;
}
;
export
type
MessageToFrontend
<
R
>
=
|
OutOfBandErrorMessageToFrontend
|
ErrorResponseMessageToFrontend
|
SuccessResponseMessageToFrontend
<
R
>
;
type
OutOfBandErrorMessageToFrontend
=
{
errno
:
number
;
error
:
string
;
}
;
type
ErrorResponseMessageToFrontend
=
{
type
:
"
ERROR_RESPONSE
"
;
requestId
:
number
;
error
:
string
;
}
;
type
SuccessResponseMessageToFrontend
<
R
>
=
{
type
:
"
SUCCESS_RESPONSE
"
;
requestId
:
number
;
response
:
R
;
}
;
export
type
ResponseToFrontend
=
|
StatusQueryResponse
|
EnableMenuButtonResponse
|
GetProfileResponse
|
GetExternalMarkersResponse
|
GetExternalPowerTracksResponse
|
GetSymbolTableResponse
|
QuerySymbolicationApiResponse
|
GetPageFaviconsResponse
|
OpenScriptInTabDebuggerResponse
;
type
StatusQueryResponse
=
{
menuButtonIsEnabled
:
boolean
;
version
:
number
;
}
;
type
EnableMenuButtonResponse
=
void
;
type
GetProfileResponse
=
ArrayBuffer
;
type
GetExternalMarkersResponse
=
Array
<
object
>
;
type
GetExternalPowerTracksResponse
=
Array
<
object
>
;
type
GetSymbolTableResponse
=
SymbolTableAsTuple
;
type
QuerySymbolicationApiResponse
=
string
;
type
GetPageFaviconsResponse
=
Array
<
ProfilerFaviconData
|
null
>
;
type
OpenScriptInTabDebuggerResponse
=
void
;
export
class
ProfilerWebChannel
{
constructor
(
id
:
string
url
:
MockedExports
.
nsIURI
)
;
send
:
(
message
:
MessageToFrontend
<
ResponseToFrontend
>
target
:
MockedExports
.
WebChannelTarget
)
=
>
void
;
listen
:
(
handler
:
(
idle
:
string
message
:
MessageFromFrontend
target
:
MockedExports
.
WebChannelTarget
)
=
>
void
)
=
>
void
;
}
export
type
ProfilerBrowserInfo
=
{
profileCaptureResult
:
ProfileCaptureResult
;
symbolicationService
:
SymbolicationService
|
null
;
}
;
export
type
ProfileCaptureResult
=
|
{
type
:
"
SUCCESS
"
;
profile
:
ArrayBuffer
;
}
|
{
type
:
"
ERROR
"
;
error
:
Error
;
}
;
export
interface
FeatureDescription
{
name
:
string
;
value
:
string
;
title
:
string
;
recommended
?
:
boolean
;
experimental
?
:
boolean
;
disabledReason
?
:
string
;
}
export
type
LibInfoMapKey
=
string
;
export
type
LibInfoMapValue
=
{
name
:
string
;
path
:
string
;
debugName
:
string
;
debugPath
:
string
;
breakpadId
:
string
;
arch
:
string
;
}
;
export
type
SymbolicationWorkerInitialMessage
=
{
request
:
SymbolicationWorkerRequest
;
libInfoMap
:
Map
<
LibInfoMapKey
LibInfoMapValue
>
;
objdirs
:
string
[
]
;
module
:
WebAssembly
.
Module
;
}
;
export
type
SymbolicationWorkerRequest
=
|
{
type
:
"
GET_SYMBOL_TABLE
"
;
debugName
:
string
;
breakpadId
:
string
;
}
|
{
type
:
"
QUERY_SYMBOLICATION_API
"
;
path
:
string
;
requestJson
:
string
;
}
;
export
type
SymbolicationWorkerError
=
{
name
:
string
;
message
:
string
;
fileName
?
:
string
;
lineNumber
?
:
number
;
}
;
export
type
SymbolicationWorkerReplyData
<
R
>
=
|
{
result
:
R
;
}
|
{
error
:
SymbolicationWorkerError
;
}
;
export
interface
FileHandle
{
getLength
:
(
)
=
>
number
;
readBytesInto
:
(
dest
:
Uint8Array
offset
:
number
)
=
>
void
;
drop
:
(
)
=
>
void
;
}
export
interface
BulkSending
{
stream
:
nsIAsyncOutputStream
;
done
:
(
err
:
void
|
Error
)
=
>
void
;
copyFrom
:
(
inputStream
:
nsIInputStream
)
=
>
Promise
<
void
>
;
copyFromBuffer
:
(
inputBuffer
:
ArrayBuffer
)
=
>
Promise
<
void
>
;
}
export
interface
BulkReceiving
{
actor
:
string
;
type
:
string
;
length
:
number
;
stream
:
nsIAsyncInputStream
;
done
:
(
err
:
void
|
Error
)
=
>
void
;
copyTo
:
(
outputStream
:
nsIAsyncOutputStream
)
=
>
Promise
<
void
>
;
copyToBuffer
:
(
outputBuffer
:
ArrayBuffer
)
=
>
Promise
<
void
>
;
}
