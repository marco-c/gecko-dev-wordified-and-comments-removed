"
use
strict
"
;
const
{
ADD_REQUEST
CLEAR_REQUESTS
CLONE_SELECTED_REQUEST
REMOVE_SELECTED_CUSTOM_REQUEST
SEND_CUSTOM_REQUEST
UPDATE_REQUEST
}
=
require
(
"
.
.
/
constants
"
)
;
const
{
getSelectedRequest
}
=
require
(
"
.
.
/
selectors
/
index
"
)
;
function
addRequest
(
id
data
batch
)
{
return
{
type
:
ADD_REQUEST
id
data
meta
:
{
batch
}
}
;
}
function
updateRequest
(
id
data
batch
)
{
return
{
type
:
UPDATE_REQUEST
id
data
meta
:
{
batch
}
}
;
}
function
cloneSelectedRequest
(
)
{
return
{
type
:
CLONE_SELECTED_REQUEST
}
;
}
function
sendCustomRequest
(
)
{
if
(
!
NetMonitorController
.
supportsCustomRequest
)
{
return
cloneSelectedRequest
(
)
;
}
return
(
dispatch
getState
)
=
>
{
const
selected
=
getSelectedRequest
(
getState
(
)
)
;
if
(
!
selected
)
{
return
;
}
let
data
=
{
url
:
selected
.
url
method
:
selected
.
method
httpVersion
:
selected
.
httpVersion
}
;
if
(
selected
.
requestHeaders
)
{
data
.
headers
=
selected
.
requestHeaders
.
headers
;
}
if
(
selected
.
requestPostData
)
{
data
.
body
=
selected
.
requestPostData
.
postData
.
text
;
}
NetMonitorController
.
webConsoleClient
.
sendHTTPRequest
(
data
(
response
)
=
>
{
return
dispatch
(
{
type
:
SEND_CUSTOM_REQUEST
id
:
response
.
eventActor
.
actor
}
)
;
}
)
;
}
;
}
function
removeSelectedCustomRequest
(
)
{
return
{
type
:
REMOVE_SELECTED_CUSTOM_REQUEST
}
;
}
function
clearRequests
(
)
{
return
{
type
:
CLEAR_REQUESTS
}
;
}
module
.
exports
=
{
addRequest
clearRequests
cloneSelectedRequest
removeSelectedCustomRequest
sendCustomRequest
updateRequest
}
;
