"
use
strict
"
;
add_task
(
function
*
(
)
{
let
{
tab
monitor
}
=
yield
initNetMonitor
(
CUSTOM_GET_URL
)
;
let
{
document
NetMonitorView
}
=
monitor
.
panelWin
;
let
{
RequestsMenu
}
=
NetMonitorView
;
RequestsMenu
.
lazyUpdate
=
false
;
info
(
"
Performing
a
secure
request
.
"
)
;
const
REQUESTS_URL
=
"
https
:
/
/
example
.
com
"
+
CORS_SJS_PATH
;
let
wait
=
waitForNetworkEvents
(
monitor
1
)
;
yield
ContentTask
.
spawn
(
tab
.
linkedBrowser
REQUESTS_URL
function
*
(
url
)
{
content
.
wrappedJSObject
.
performRequests
(
1
url
)
;
}
)
;
yield
wait
;
wait
=
waitForDOM
(
document
"
#
security
-
panel
"
)
;
EventUtils
.
sendMouseEvent
(
{
type
:
"
mousedown
"
}
document
.
querySelector
(
"
.
network
-
details
-
panel
-
toggle
"
)
)
;
document
.
querySelector
(
"
#
security
-
tab
"
)
.
click
(
)
;
yield
wait
;
let
tabpanel
=
document
.
querySelector
(
"
#
security
-
panel
"
)
;
let
textboxes
=
tabpanel
.
querySelectorAll
(
"
.
textbox
-
input
"
)
;
let
protocol
=
textboxes
[
0
]
.
value
;
ok
(
protocol
.
startsWith
(
"
TLS
"
)
"
The
protocol
"
+
protocol
+
"
seems
valid
.
"
)
;
let
suite
=
textboxes
[
1
]
.
value
;
ok
(
suite
.
startsWith
(
"
TLS_
"
)
"
The
suite
"
+
suite
+
"
seems
valid
.
"
)
;
is
(
tabpanel
.
querySelectorAll
(
"
.
treeLabel
.
objectLabel
"
)
[
1
]
.
textContent
"
Host
example
.
com
:
"
"
Label
has
the
expected
value
.
"
)
;
is
(
textboxes
[
2
]
.
value
"
Disabled
"
"
Label
has
the
expected
value
.
"
)
;
is
(
textboxes
[
3
]
.
value
"
Disabled
"
"
Label
has
the
expected
value
.
"
)
;
is
(
textboxes
[
4
]
.
value
"
example
.
com
"
"
Label
has
the
expected
value
.
"
)
;
is
(
textboxes
[
5
]
.
value
"
<
Not
Available
>
"
"
Label
has
the
expected
value
.
"
)
;
is
(
textboxes
[
6
]
.
value
"
<
Not
Available
>
"
"
Label
has
the
expected
value
.
"
)
;
is
(
textboxes
[
7
]
.
value
"
Temporary
Certificate
Authority
"
"
Label
has
the
expected
value
.
"
)
;
is
(
textboxes
[
8
]
.
value
"
Mozilla
Testing
"
"
Label
has
the
expected
value
.
"
)
;
is
(
textboxes
[
9
]
.
value
"
Profile
Guided
Optimization
"
"
Label
has
the
expected
value
.
"
)
;
isnot
(
textboxes
[
10
]
.
value
"
"
"
Label
was
not
empty
.
"
)
;
isnot
(
textboxes
[
11
]
.
value
"
"
"
Label
was
not
empty
.
"
)
;
isnot
(
textboxes
[
12
]
.
value
"
"
"
Label
was
not
empty
.
"
)
;
isnot
(
textboxes
[
13
]
.
value
"
"
"
Label
was
not
empty
.
"
)
;
yield
teardown
(
monitor
)
;
}
)
;
