"
use
strict
"
;
const
{
WS_ADD_FRAME
WS_SELECT_FRAME
WS_OPEN_FRAME_DETAILS
}
=
require
(
"
.
.
/
constants
"
)
;
function
WebSockets
(
)
{
return
{
frames
:
new
Map
(
)
selectedFrame
:
null
frameDetailsOpen
:
false
}
;
}
function
addFrame
(
state
action
)
{
const
nextState
=
{
.
.
.
state
}
;
const
newFrame
=
{
httpChannelId
:
action
.
httpChannelId
.
.
.
action
.
data
}
;
nextState
.
frames
=
mapSet
(
state
.
frames
newFrame
.
httpChannelId
newFrame
)
;
return
nextState
;
}
function
selectFrame
(
state
action
)
{
return
{
.
.
.
state
selectedFrame
:
action
.
frame
frameDetailsOpen
:
action
.
open
}
;
}
function
openFrameDetails
(
state
action
)
{
return
{
.
.
.
state
frameDetailsOpen
:
action
.
open
}
;
}
function
mapSet
(
map
key
value
)
{
const
newMap
=
new
Map
(
map
)
;
if
(
newMap
.
has
(
key
)
)
{
const
framesArray
=
[
.
.
.
newMap
.
get
(
key
)
]
;
framesArray
.
push
(
value
)
;
newMap
.
set
(
key
framesArray
)
;
return
newMap
;
}
return
newMap
.
set
(
key
[
value
]
)
;
}
function
webSockets
(
state
=
WebSockets
(
)
action
)
{
switch
(
action
.
type
)
{
case
WS_ADD_FRAME
:
return
addFrame
(
state
action
)
;
case
WS_SELECT_FRAME
:
return
selectFrame
(
state
action
)
;
case
WS_OPEN_FRAME_DETAILS
:
return
openFrameDetails
(
state
action
)
;
default
:
return
state
;
}
}
module
.
exports
=
{
WebSockets
webSockets
}
;
