"
use
strict
"
;
add_task
(
async
(
)
=
>
{
const
{
monitor
}
=
await
initNetMonitor
(
SIMPLE_URL
{
requestCount
:
1
}
)
;
info
(
"
Starting
test
.
.
.
"
)
;
const
{
document
actions
store
windowRequire
}
=
monitor
.
panelWin
;
const
Actions
=
windowRequire
(
"
devtools
/
client
/
netmonitor
/
src
/
actions
/
index
"
)
;
const
{
HarImporter
}
=
windowRequire
(
"
devtools
/
client
/
netmonitor
/
src
/
har
/
har
-
importer
"
)
;
store
.
dispatch
(
Actions
.
batchEnable
(
false
)
)
;
const
invalidHarJSON
=
{
log
:
{
version
:
"
1
.
2
"
pages
:
[
{
title
:
"
bla
"
}
]
entries
:
[
{
request
:
{
method
:
"
POST
"
url
:
"
https
:
/
/
bla
.
com
"
httpVersion
:
"
"
headers
:
[
]
cookies
:
[
]
queryString
:
[
]
}
response
:
{
content
:
{
size
:
1231
text
:
'
{
"
requests
"
:
[
{
"
uri
"
:
"
https
:
/
/
bla
.
com
"
}
]
}
'
}
headers
:
[
]
}
timings
:
{
}
cache
:
{
}
}
]
}
}
;
const
importer
=
new
HarImporter
(
actions
)
;
importer
.
import
(
JSON
.
stringify
(
invalidHarJSON
)
)
;
const
waitForResponsePanelOpen
=
waitUntil
(
(
)
=
>
document
.
querySelector
(
"
#
response
-
panel
"
)
)
;
EventUtils
.
sendMouseEvent
(
{
type
:
"
mousedown
"
}
document
.
querySelector
(
"
.
request
-
list
-
item
"
)
)
;
clickOnSidebarTab
(
document
"
response
"
)
;
await
waitForResponsePanelOpen
;
ok
(
true
"
The
response
panel
opened
"
)
;
return
teardown
(
monitor
)
;
}
)
;
