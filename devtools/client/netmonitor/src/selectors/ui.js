"
use
strict
"
;
const
{
createSelector
}
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
reselect
"
)
;
const
{
REQUESTS_WATERFALL
}
=
require
(
"
.
.
/
constants
"
)
;
const
EPSILON
=
0
.
001
;
const
getWaterfallScale
=
createSelector
(
state
=
>
state
.
requests
state
=
>
state
.
timingMarkers
state
=
>
state
.
ui
(
requests
timingMarkers
ui
)
=
>
{
if
(
requests
.
firstStartedMs
=
=
=
+
Infinity
|
|
ui
.
waterfallWidth
=
=
=
null
)
{
return
null
;
}
const
lastEventMs
=
Math
.
max
(
requests
.
lastEndedMs
timingMarkers
.
firstDocumentDOMContentLoadedTimestamp
timingMarkers
.
firstDocumentLoadTimestamp
)
;
const
longestWidth
=
lastEventMs
-
requests
.
firstStartedMs
;
return
Math
.
min
(
Math
.
max
(
(
ui
.
waterfallWidth
-
REQUESTS_WATERFALL
.
LABEL_WIDTH
-
20
)
/
longestWidth
EPSILON
)
1
)
;
}
)
;
module
.
exports
=
{
getWaterfallScale
}
;
