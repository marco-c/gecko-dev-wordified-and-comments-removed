"
use
strict
"
;
const
{
TYPES
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
commands
/
resource
/
resource
-
command
.
js
"
)
;
class
HarMetadataCollector
{
#
commands
;
#
initialURL
;
#
navigationRequests
;
constructor
(
commands
)
{
this
.
#
commands
=
commands
;
}
destroy
(
)
{
this
.
clear
(
)
;
this
.
#
commands
.
resourceCommand
.
unwatchResources
(
[
TYPES
.
NETWORK_EVENT
]
{
onAvailable
:
this
.
#
onResourceAvailable
}
)
;
}
clear
(
)
{
this
.
#
initialURL
=
this
.
#
commands
.
targetCommand
.
targetFront
.
url
;
this
.
#
navigationRequests
=
[
]
;
}
async
connect
(
)
{
this
.
clear
(
)
;
await
this
.
#
commands
.
resourceCommand
.
watchResources
(
[
TYPES
.
NETWORK_EVENT
]
{
onAvailable
:
this
.
#
onResourceAvailable
}
)
;
}
getHarData
(
)
{
return
{
initialURL
:
this
.
#
initialURL
navigationRequests
:
this
.
#
navigationRequests
}
;
}
#
onResourceAvailable
=
resources
=
>
{
for
(
const
resource
of
resources
)
{
if
(
resource
.
resourceType
=
=
=
TYPES
.
NETWORK_EVENT
&
&
resource
.
isNavigationRequest
)
{
this
.
#
navigationRequests
.
push
(
resource
)
;
}
}
}
;
}
exports
.
HarMetadataCollector
=
HarMetadataCollector
;
