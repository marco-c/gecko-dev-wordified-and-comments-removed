"
use
strict
"
;
const
Services
=
require
(
"
Services
"
)
;
const
{
ACTIVITY_TYPE
OPEN_NETWORK_DETAILS
RESIZE_NETWORK_DETAILS
ENABLE_PERSISTENT_LOGS
DISABLE_BROWSER_CACHE
OPEN_STATISTICS
RESET_COLUMNS
SELECT_DETAILS_PANEL_TAB
SELECT_ACTION_BAR_TAB
TOGGLE_COLUMN
WATERFALL_RESIZE
SET_COLUMNS_WIDTH
}
=
require
(
"
devtools
/
client
/
netmonitor
/
src
/
constants
"
)
;
const
{
getDisplayedRequests
}
=
require
(
"
devtools
/
client
/
netmonitor
/
src
/
selectors
/
index
"
)
;
const
DEVTOOLS_DISABLE_CACHE_PREF
=
"
devtools
.
cache
.
disabled
"
;
function
openNetworkDetails
(
open
)
{
return
(
dispatch
getState
)
=
>
{
const
visibleRequestItems
=
getDisplayedRequests
(
getState
(
)
)
;
const
defaultSelectedId
=
visibleRequestItems
.
length
?
visibleRequestItems
[
0
]
.
id
:
null
;
return
dispatch
(
{
type
:
OPEN_NETWORK_DETAILS
open
defaultSelectedId
}
)
;
}
;
}
function
resizeNetworkDetails
(
width
height
)
{
return
{
type
:
RESIZE_NETWORK_DETAILS
width
height
}
;
}
function
enablePersistentLogs
(
enabled
skipTelemetry
=
false
)
{
return
{
type
:
ENABLE_PERSISTENT_LOGS
enabled
skipTelemetry
}
;
}
function
disableBrowserCache
(
disabled
)
{
return
{
type
:
DISABLE_BROWSER_CACHE
disabled
}
;
}
function
openStatistics
(
connector
open
)
{
if
(
open
)
{
connector
.
triggerActivity
(
ACTIVITY_TYPE
.
RELOAD
.
WITH_CACHE_ENABLED
)
;
}
else
if
(
Services
.
prefs
.
getBoolPref
(
DEVTOOLS_DISABLE_CACHE_PREF
)
)
{
connector
.
triggerActivity
(
ACTIVITY_TYPE
.
DISABLE_CACHE
)
;
}
return
{
type
:
OPEN_STATISTICS
open
}
;
}
function
resetColumns
(
)
{
return
{
type
:
RESET_COLUMNS
}
;
}
function
resizeWaterfall
(
width
)
{
return
{
type
:
WATERFALL_RESIZE
width
}
;
}
function
selectDetailsPanelTab
(
id
)
{
return
{
type
:
SELECT_DETAILS_PANEL_TAB
id
}
;
}
function
selectActionBarTab
(
id
)
{
return
{
type
:
SELECT_ACTION_BAR_TAB
id
}
;
}
function
toggleColumn
(
column
)
{
return
{
type
:
TOGGLE_COLUMN
column
}
;
}
function
setColumnsWidth
(
widths
)
{
return
{
type
:
SET_COLUMNS_WIDTH
widths
}
;
}
function
toggleNetworkDetails
(
)
{
return
(
dispatch
getState
)
=
>
dispatch
(
openNetworkDetails
(
!
getState
(
)
.
ui
.
networkDetailsOpen
)
)
;
}
function
togglePersistentLogs
(
)
{
return
(
dispatch
getState
)
=
>
dispatch
(
enablePersistentLogs
(
!
getState
(
)
.
ui
.
persistentLogsEnabled
)
)
;
}
function
toggleBrowserCache
(
)
{
return
(
dispatch
getState
)
=
>
dispatch
(
disableBrowserCache
(
!
getState
(
)
.
ui
.
browserCacheDisabled
)
)
;
}
function
toggleStatistics
(
connector
)
{
return
(
dispatch
getState
)
=
>
dispatch
(
openStatistics
(
connector
!
getState
(
)
.
ui
.
statisticsOpen
)
)
;
}
module
.
exports
=
{
openNetworkDetails
resizeNetworkDetails
enablePersistentLogs
disableBrowserCache
openStatistics
resetColumns
resizeWaterfall
selectDetailsPanelTab
selectActionBarTab
toggleColumn
setColumnsWidth
toggleNetworkDetails
togglePersistentLogs
toggleBrowserCache
toggleStatistics
}
;
