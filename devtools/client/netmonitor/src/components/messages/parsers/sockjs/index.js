"
use
strict
"
;
function
parseSockJS
(
msg
)
{
const
type
=
msg
.
slice
(
0
1
)
;
const
content
=
msg
.
slice
(
1
)
;
switch
(
type
)
{
case
"
o
"
:
return
{
type
:
"
open
"
}
;
case
"
h
"
:
return
{
type
:
"
heartbeat
"
}
;
}
let
payload
;
if
(
content
)
{
try
{
payload
=
JSON
.
parse
(
content
)
;
}
catch
(
e
)
{
return
null
;
}
}
if
(
typeof
payload
=
=
=
"
undefined
"
)
{
return
null
;
}
switch
(
type
)
{
case
"
a
"
:
return
{
type
:
"
message
"
data
:
payload
}
;
case
"
m
"
:
return
{
type
:
"
message
"
data
:
payload
}
;
case
"
c
"
:
{
const
[
code
message
]
=
payload
;
return
{
type
:
"
close
"
code
message
}
;
}
default
:
return
null
;
}
}
module
.
exports
=
{
parseSockJS
}
;
