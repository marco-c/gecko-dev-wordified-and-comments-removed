"
use
strict
"
;
const
{
BrowserLoader
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
devtools
/
shared
/
loader
/
browser
-
loader
.
js
"
)
;
const
require
=
(
window
.
windowRequire
=
BrowserLoader
(
{
baseURI
:
"
resource
:
/
/
devtools
/
client
/
netmonitor
/
"
window
}
)
.
require
)
;
const
{
NetMonitorAPI
}
=
require
(
"
resource
:
/
/
devtools
/
client
/
netmonitor
/
src
/
api
.
js
"
)
;
const
{
NetMonitorApp
}
=
require
(
"
resource
:
/
/
devtools
/
client
/
netmonitor
/
src
/
app
.
js
"
)
;
const
EventEmitter
=
require
(
"
resource
:
/
/
devtools
/
shared
/
event
-
emitter
.
js
"
)
;
EventEmitter
.
decorate
(
window
)
;
function
initialize
(
api
)
{
const
app
=
new
NetMonitorApp
(
api
)
;
window
.
Netmonitor
=
app
;
window
.
api
=
api
;
window
.
store
=
app
.
api
.
store
;
window
.
connector
=
app
.
api
.
connector
;
window
.
actions
=
app
.
api
.
actions
;
return
app
;
}
const
href
=
window
.
location
.
href
.
replace
(
/
chrome
:
/
"
http
:
/
/
"
)
;
const
url
=
new
window
.
URL
(
href
)
;
if
(
window
.
location
.
protocol
=
=
=
"
chrome
:
"
&
&
url
.
search
.
length
>
1
)
{
const
{
descriptorFromURL
}
=
require
(
"
resource
:
/
/
devtools
/
client
/
framework
/
descriptor
-
from
-
url
.
js
"
)
;
const
{
createCommandsDictionary
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
commands
/
index
.
js
"
)
;
(
async
function
(
)
{
try
{
const
descriptor
=
await
descriptorFromURL
(
url
)
;
const
target
=
await
descriptor
.
getTarget
(
)
;
const
commands
=
await
createCommandsDictionary
(
descriptor
)
;
const
toolbox
=
{
target
viewSourceInDebugger
(
)
{
throw
new
Error
(
"
toolbox
.
viewSourceInDebugger
is
not
implement
from
a
tab
"
)
;
}
commands
}
;
const
api
=
new
NetMonitorAPI
(
)
;
await
api
.
connect
(
toolbox
)
;
const
app
=
window
.
initialize
(
api
)
;
app
.
bootstrap
(
{
toolbox
document
:
window
.
document
}
)
;
}
catch
(
err
)
{
window
.
alert
(
"
Unable
to
start
the
network
monitor
:
"
+
err
)
;
}
}
)
(
)
;
}
