function
isFrameSelected
(
dbg
index
title
)
{
const
frame
=
findElement
(
dbg
"
frame
"
index
)
;
const
frame
=
dbg
.
selectors
.
getSelectedFrame
(
dbg
.
getState
(
)
)
;
const
elSelected
=
frame
.
classList
.
contains
(
"
selected
"
)
;
const
titleSelected
=
frame
.
displayName
=
=
title
;
return
elSelected
&
&
titleSelected
;
}
function
toggleButton
(
dbg
)
{
const
callStackBody
=
findElement
(
dbg
"
callStackBody
"
)
;
return
callStackBody
.
querySelector
(
"
.
show
-
more
"
)
;
}
add_task
(
async
function
(
)
{
const
dbg
=
await
initDebugger
(
"
doc
-
script
-
switching
.
html
"
)
;
toggleCallStack
(
dbg
)
;
const
notPaused
=
findElement
(
dbg
"
callStackBody
"
)
.
innerText
;
is
(
notPaused
"
Not
Paused
"
"
Not
paused
message
is
shown
"
)
;
invokeInTab
(
"
firstCall
"
)
;
await
waitForPaused
(
dbg
)
;
ok
(
isFrameSelected
(
dbg
1
"
secondCall
"
)
"
the
first
frame
is
selected
"
)
;
let
button
=
toggleButton
(
dbg
)
;
ok
(
!
button
"
toggle
button
shouldn
'
t
be
there
"
)
;
}
)
;
add_task
(
async
function
(
)
{
const
dbg
=
await
initDebugger
(
"
doc
-
frames
.
html
"
)
;
toggleCallStack
(
dbg
)
;
invokeInTab
(
"
startRecursion
"
)
;
await
waitForPaused
(
dbg
)
;
ok
(
isFrameSelected
(
dbg
1
"
recurseA
"
)
"
the
first
frame
is
selected
"
)
;
let
button
=
toggleButton
(
dbg
)
;
let
frames
=
findAllElements
(
dbg
"
frames
"
)
;
is
(
button
.
innerText
"
Expand
Rows
"
"
toggle
button
should
be
expand
"
)
;
is
(
frames
.
length
7
"
There
should
be
at
most
seven
frames
"
)
;
button
.
click
(
)
;
button
=
toggleButton
(
dbg
)
;
frames
=
findAllElements
(
dbg
"
frames
"
)
;
is
(
button
.
innerText
"
Collapse
Rows
"
"
toggle
button
should
be
collapsed
"
)
;
is
(
frames
.
length
22
"
All
of
the
frames
should
be
shown
"
)
;
}
)
;
