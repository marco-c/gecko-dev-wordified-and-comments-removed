const
{
PromiseTestUtils
}
=
scopedCuImport
(
"
resource
:
/
/
testing
-
common
/
PromiseTestUtils
.
jsm
"
)
;
PromiseTestUtils
.
whitelistRejectionsGlobally
(
/
NS_ERROR_NOT_INITIALIZED
/
)
;
function
clickGutter
(
dbg
line
)
{
clickElement
(
dbg
"
gutter
"
line
)
;
}
add_task
(
async
function
(
)
{
const
dbg
=
await
initDebugger
(
"
doc
-
scripts
.
html
"
"
simple1
.
js
"
)
;
const
{
selectors
:
{
getBreakpoint
getBreakpointCount
}
getState
}
=
dbg
;
const
source
=
findSource
(
dbg
"
simple1
.
js
"
)
;
await
selectSource
(
dbg
source
.
url
)
;
clickGutter
(
dbg
4
)
;
await
waitForDispatch
(
dbg
"
ADD_BREAKPOINT
"
)
;
is
(
getBreakpointCount
(
getState
(
)
)
1
"
One
breakpoint
exists
"
)
;
assertEditorBreakpoint
(
dbg
4
true
)
;
clickGutter
(
dbg
4
)
;
await
waitForDispatch
(
dbg
"
REMOVE_BREAKPOINT
"
)
;
is
(
getBreakpointCount
(
getState
(
)
)
0
"
No
breakpoints
exist
"
)
;
assertEditorBreakpoint
(
dbg
4
false
)
;
}
)
;
