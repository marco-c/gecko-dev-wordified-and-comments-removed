import
{
getSymbols
}
from
"
.
.
/
getSymbols
"
;
import
{
setSource
}
from
"
.
.
/
sources
"
;
import
type
{
Source
}
from
"
.
.
/
.
.
/
.
.
/
types
"
;
function
formatLocation
(
loc
)
{
if
(
!
loc
)
{
return
"
"
;
}
const
{
start
end
}
=
loc
;
const
startLoc
=
(
{
start
.
line
}
{
start
.
column
}
)
;
const
endLoc
=
(
{
end
.
line
}
{
end
.
column
}
)
;
return
[
{
startLoc
}
{
endLoc
}
]
;
}
function
summarize
(
symbol
)
{
if
(
typeof
symbol
=
=
"
boolean
"
)
{
return
symbol
?
"
true
"
:
"
false
"
;
}
const
loc
=
formatLocation
(
symbol
.
location
)
;
const
params
=
symbol
.
parameterNames
?
(
{
symbol
.
parameterNames
.
join
(
"
"
)
}
)
:
"
"
;
const
expression
=
symbol
.
expression
|
|
"
"
;
const
klass
=
symbol
.
klass
|
|
"
"
;
const
name
=
symbol
.
name
=
=
undefined
?
"
"
:
symbol
.
name
;
const
names
=
symbol
.
specifiers
?
symbol
.
specifiers
.
join
(
"
"
)
:
"
"
;
const
values
=
symbol
.
values
?
symbol
.
values
.
join
(
"
"
)
:
"
"
;
const
index
=
symbol
.
index
?
symbol
.
index
:
"
"
;
return
{
loc
}
{
expression
}
{
name
}
{
params
}
{
klass
}
{
names
}
{
values
}
{
index
}
.
trim
(
)
;
}
const
bools
=
[
"
hasJsx
"
"
hasTypes
"
"
loading
"
]
;
function
formatBool
(
name
symbols
)
{
return
{
name
}
:
{
symbols
[
name
]
?
"
true
"
:
"
false
"
}
;
}
function
formatKey
(
name
:
string
symbols
:
any
)
{
if
(
bools
.
includes
(
name
)
)
{
return
formatBool
(
name
symbols
)
;
}
return
{
name
}
:
\
n
{
symbols
[
name
]
.
map
(
summarize
)
.
join
(
"
\
n
"
)
}
;
}
export
function
formatSymbols
(
source
:
Source
)
{
setSource
(
source
)
;
const
symbols
=
getSymbols
(
source
.
id
)
;
return
Object
.
keys
(
symbols
)
.
map
(
name
=
>
formatKey
(
name
symbols
)
)
.
join
(
"
\
n
\
n
"
)
;
}
