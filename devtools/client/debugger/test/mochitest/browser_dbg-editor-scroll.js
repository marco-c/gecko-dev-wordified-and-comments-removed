"
use
strict
"
;
requestLongerTimeout
(
2
)
;
add_task
(
async
function
(
)
{
const
dbg
=
await
initDebugger
(
"
doc
-
editor
-
scroll
.
html
"
)
;
await
selectSource
(
dbg
"
simple1
.
js
"
)
;
await
addBreakpoint
(
dbg
"
simple1
.
js
"
26
)
;
info
(
"
Open
long
file
scroll
down
to
line
below
the
fold
"
)
;
await
selectSource
(
dbg
"
long
.
js
"
)
;
await
scrollEditorIntoView
(
dbg
24
0
)
;
ok
(
isScrolledPositionVisible
(
dbg
24
)
"
Scroll
position
is
visible
"
)
;
info
(
"
Ensure
vertical
scroll
is
the
same
after
switching
documents
"
)
;
let
onScrolled
=
waitForScrolling
(
dbg
)
;
await
selectSource
(
dbg
"
simple1
.
js
"
)
;
await
onScrolled
;
ok
(
isScrolledPositionVisible
(
dbg
0
)
"
Scrolled
to
the
top
of
the
editor
"
)
;
onScrolled
=
waitForScrolling
(
dbg
)
;
await
selectSource
(
dbg
"
long
.
js
"
)
;
await
onScrolled
;
ok
(
isScrolledPositionVisible
(
dbg
24
)
"
Scroll
position
is
visible
"
)
;
info
(
"
Trigger
a
pause
click
on
a
frame
ensure
the
right
line
is
selected
"
)
;
onScrolled
=
waitForScrolling
(
dbg
)
;
invokeInTab
(
"
doNamedEval
"
)
;
await
waitForPaused
(
dbg
)
;
await
onScrolled
;
ok
(
isScrolledPositionVisible
(
dbg
26
)
"
Frame
scrolled
down
to
correct
location
"
)
;
info
(
"
Navigating
while
paused
goes
to
the
correct
location
"
)
;
onScrolled
=
waitForScrolling
(
dbg
)
;
await
selectSource
(
dbg
"
long
.
js
"
)
;
await
onScrolled
;
ok
(
isScrolledPositionVisible
(
dbg
24
)
"
Scroll
position
is
visible
"
)
;
info
(
"
Open
new
source
ensure
it
'
s
at
0
scroll
"
)
;
onScrolled
=
waitForScrolling
(
dbg
)
;
await
selectSource
(
dbg
"
frames
.
js
"
)
;
await
onScrolled
;
ok
(
isScrolledPositionVisible
(
dbg
0
)
"
Scrolled
to
the
top
of
the
editor
"
)
;
}
)
;
