"
use
strict
"
;
const
TEST_COM_URI
=
URL_ROOT_COM
+
"
examples
/
doc_dbg
-
fission
-
frame
-
sources
.
html
"
;
add_task
(
async
function
(
)
{
const
dbg
=
await
initDebuggerWithAbsoluteURL
(
TEST_COM_URI
"
simple1
.
js
"
"
simple2
.
js
"
)
;
pressKey
(
dbg
"
projectSearch
"
)
;
type
(
dbg
"
foo
"
)
;
pressKey
(
dbg
"
Enter
"
)
;
await
waitForState
(
dbg
state
=
>
state
.
projectTextSearch
.
status
=
=
=
"
DONE
"
)
;
const
fileResults
=
findAllElements
(
dbg
"
projectSearchFileResults
"
)
;
const
matches
=
findAllElements
(
dbg
"
projectSearchExpandedResults
"
)
;
is
(
fileResults
.
length
2
"
Two
results
found
"
)
is
(
matches
.
length
6
"
Total
no
of
matches
found
"
)
;
assertFileResult
(
"
simple1
.
js
"
5
)
;
assertFileResult
(
"
simple2
.
js
"
1
)
;
function
assertFileResult
(
fileMatched
noOfMatches
)
{
const
match
=
[
.
.
.
fileResults
]
.
find
(
result
=
>
result
.
querySelector
(
"
.
file
-
path
"
)
.
innerText
.
includes
(
fileMatched
)
)
;
ok
(
match
Matches
were
found
in
{
fileMatched
}
file
.
)
;
const
matchText
=
noOfMatches
>
1
?
"
matches
"
:
"
match
"
;
is
(
match
.
querySelector
(
"
.
matches
-
summary
"
)
.
innerText
.
trim
(
)
(
{
noOfMatches
}
{
matchText
}
)
{
noOfMatches
}
{
matchText
}
were
found
in
{
fileMatched
}
file
.
)
;
}
}
)
;
