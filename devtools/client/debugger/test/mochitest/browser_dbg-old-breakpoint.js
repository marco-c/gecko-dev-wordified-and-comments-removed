"
use
strict
"
;
add_task
(
async
function
(
)
{
clearDebuggerPreferences
(
)
;
const
pending
=
{
bp1
:
{
location
:
{
sourceId
:
"
"
sourceUrl
:
{
EXAMPLE_URL
}
nowhere2
.
js
line
:
5
column
:
0
}
generatedLocation
:
{
sourceUrl
:
{
EXAMPLE_URL
}
simple1
.
js
line
:
4
column
:
0
}
options
:
{
}
disabled
:
false
}
bp2
:
{
location
:
{
sourceId
:
"
"
sourceUrl
:
{
EXAMPLE_URL
}
nowhere
.
js
line
:
5
column
:
0
}
generatedLocation
:
{
sourceUrl
:
{
EXAMPLE_URL
}
simple3
.
js
line
:
2
column
:
0
}
options
:
{
}
disabled
:
false
}
}
;
asyncStorage
.
setItem
(
"
debugger
.
pending
-
breakpoints
"
pending
)
;
const
toolbox
=
await
openNewTabAndToolbox
(
{
EXAMPLE_URL
}
doc
-
scripts
.
html
"
jsdebugger
"
)
;
const
dbg
=
createDebuggerContext
(
toolbox
)
;
await
selectSource
(
dbg
"
doc
-
scripts
.
html
"
)
;
const
onBreakpoint
=
waitForDispatch
(
dbg
.
store
"
SET_BREAKPOINT
"
2
)
;
const
breakpointsVisible
=
await
waitForState
(
dbg
state
=
>
dbg
.
selectors
.
getBreakpointCount
(
state
)
=
=
2
)
;
await
waitUntil
(
async
(
)
=
>
{
invokeInTab
(
"
main
"
)
;
return
isPaused
(
dbg
)
;
}
)
;
ok
(
true
"
Paused
at
unmapped
breakpoint
"
)
;
await
Promise
.
any
(
[
breakpointsVisible
onBreakpoint
]
)
;
is
(
dbg
.
selectors
.
getBreakpointCount
(
)
2
"
Unmapped
breakpoints
shown
in
UI
"
)
;
}
)
;
add_task
(
async
function
(
)
{
clearDebuggerPreferences
(
)
;
const
pending
=
{
bp1
:
{
location
:
{
sourceId
:
"
"
sourceUrl
:
"
webpack
:
/
/
/
entry
.
js
"
line
:
15
column
:
0
}
generatedLocation
:
{
sourceUrl
:
{
EXAMPLE_URL
}
sourcemaps
/
bundle
.
js
line
:
47
column
:
16
}
options
:
{
}
disabled
:
false
}
}
;
asyncStorage
.
setItem
(
"
debugger
.
pending
-
breakpoints
"
pending
)
;
const
toolbox
=
await
openNewTabAndToolbox
(
{
EXAMPLE_URL
}
doc
-
sourcemaps
.
html
"
jsdebugger
"
)
;
const
dbg
=
createDebuggerContext
(
toolbox
)
;
await
waitForState
(
dbg
state
=
>
{
const
bps
=
dbg
.
selectors
.
getBreakpointsList
(
state
)
;
return
(
bps
.
length
=
=
1
&
&
bps
[
0
]
.
location
.
source
.
url
.
includes
(
"
entry
.
js
"
)
&
&
bps
[
0
]
.
location
.
line
=
=
15
)
;
}
)
;
ok
(
true
"
removed
old
breakpoint
during
sync
"
)
;
await
waitForRequestsToSettle
(
dbg
)
;
}
)
;
