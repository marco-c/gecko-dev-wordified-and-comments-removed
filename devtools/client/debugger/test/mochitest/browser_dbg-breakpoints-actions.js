function
openFirstBreakpointContextMenu
(
dbg
)
{
rightClickElement
(
dbg
"
breakpointItem
"
2
)
;
}
add_task
(
async
function
(
)
{
const
dbg
=
await
initDebugger
(
"
doc
-
scripts
.
html
"
"
simple2
"
)
;
await
selectSource
(
dbg
"
simple2
"
)
;
await
waitForSelectedSource
(
dbg
"
simple2
"
)
;
await
addBreakpoint
(
dbg
"
simple2
"
3
)
;
openFirstBreakpointContextMenu
(
dbg
)
;
selectContextMenuItem
(
dbg
selectors
.
breakpointContextMenu
.
remove
)
;
await
waitForState
(
dbg
state
=
>
dbg
.
selectors
.
getBreakpointCount
(
)
=
=
=
0
)
;
ok
(
true
"
successfully
removed
the
breakpoint
"
)
;
}
)
;
add_task
(
async
function
(
)
{
const
dbg
=
await
initDebugger
(
"
doc
-
scripts
.
html
"
)
;
await
selectSource
(
dbg
"
simple1
"
)
;
await
waitForSelectedSource
(
dbg
"
simple1
"
)
;
await
addBreakpoint
(
dbg
"
simple1
"
4
)
;
await
addBreakpoint
(
dbg
"
simple1
"
5
)
;
await
addBreakpoint
(
dbg
"
simple1
"
6
)
;
openFirstBreakpointContextMenu
(
dbg
)
;
let
dispatched
=
waitForDispatch
(
dbg
"
SET_BREAKPOINT
"
1
)
;
selectContextMenuItem
(
dbg
selectors
.
breakpointContextMenu
.
disableOthers
)
;
await
waitForState
(
dbg
state
=
>
dbg
.
selectors
.
getBreakpointsList
(
)
.
every
(
bp
=
>
(
bp
.
location
.
line
!
=
=
4
)
=
=
=
bp
.
disabled
)
)
;
await
dispatched
;
ok
(
true
"
breakpoint
at
4
is
the
only
enabled
breakpoint
"
)
;
openFirstBreakpointContextMenu
(
dbg
)
;
dispatched
=
waitForDispatch
(
dbg
"
SET_BREAKPOINT
"
)
;
selectContextMenuItem
(
dbg
selectors
.
breakpointContextMenu
.
disableAll
)
;
await
waitForState
(
dbg
state
=
>
dbg
.
selectors
.
getBreakpointsList
(
)
.
every
(
bp
=
>
bp
.
disabled
)
)
;
await
dispatched
;
ok
(
true
"
all
breakpoints
are
disabled
"
)
;
openFirstBreakpointContextMenu
(
dbg
)
;
dispatched
=
waitForDispatch
(
dbg
"
SET_BREAKPOINT
"
2
)
;
selectContextMenuItem
(
dbg
selectors
.
breakpointContextMenu
.
enableOthers
)
;
await
waitForState
(
dbg
state
=
>
dbg
.
selectors
.
getBreakpointsList
(
)
.
every
(
bp
=
>
(
bp
.
location
.
line
=
=
=
4
)
=
=
=
bp
.
disabled
)
)
;
await
dispatched
;
ok
(
true
"
all
breakpoints
except
line
1
are
enabled
"
)
;
openFirstBreakpointContextMenu
(
dbg
)
;
dispatched
=
waitForDispatch
(
dbg
"
REMOVE_BREAKPOINT
"
2
)
;
selectContextMenuItem
(
dbg
selectors
.
breakpointContextMenu
.
removeOthers
)
;
await
waitForState
(
dbg
state
=
>
dbg
.
selectors
.
getBreakpointsList
(
)
.
length
=
=
=
1
&
&
dbg
.
selectors
.
getBreakpointsList
(
)
[
0
]
.
location
.
line
=
=
=
4
)
;
await
dispatched
;
ok
(
true
"
remaining
breakpoint
should
be
on
line
4
"
)
;
}
)
;
