"
use
strict
"
;
add_task
(
async
function
(
)
{
await
pushPref
(
"
devtools
.
toolbox
.
footer
.
height
"
500
)
;
const
dbg
=
await
initDebugger
(
"
doc
-
preview
-
getter
.
html
"
"
preview
-
getter
.
js
"
)
;
await
loadAndAddBreakpoint
(
dbg
"
preview
-
getter
.
js
"
5
5
)
;
invokeInTab
(
"
funcA
"
)
;
await
waitForPaused
(
dbg
)
;
info
(
"
Hovers
over
'
this
'
token
to
display
the
preview
.
"
)
;
const
{
tokenEl
}
=
await
tryHovering
(
dbg
5
5
"
previewPopup
"
)
;
info
(
"
Wait
for
properties
to
be
loaded
"
)
;
await
waitUntil
(
(
)
=
>
dbg
.
win
.
document
.
querySelectorAll
(
"
.
preview
-
popup
.
node
"
)
.
length
>
1
)
;
info
(
"
Invokes
getter
and
waits
for
the
element
to
be
rendered
"
)
;
await
clickElement
(
dbg
"
previewPopupInvokeGetterButton
"
)
;
await
waitForAllElements
(
dbg
"
previewPopupObjectNumber
"
2
)
;
await
clickElement
(
dbg
"
previewPopupInvokeGetterButton
"
)
;
await
waitForAllElements
(
dbg
"
previewPopupObjectObject
"
4
)
;
const
getterButtonEls
=
findAllElements
(
dbg
"
previewPopupInvokeGetterButton
"
)
;
const
previewObjectNumberEls
=
findAllElements
(
dbg
"
previewPopupObjectNumber
"
)
;
const
previewObjectObjectEls
=
findAllElements
(
dbg
"
previewPopupObjectObject
"
)
;
is
(
getterButtonEls
.
length
0
"
There
are
no
getter
buttons
in
the
preview
.
"
)
;
is
(
previewObjectNumberEls
.
length
2
"
Getters
were
invoked
and
two
numerical
values
are
displayed
as
expected
.
"
)
;
is
(
previewObjectObjectEls
.
length
4
"
Getters
were
invoked
and
three
object
values
are
displayed
as
expected
.
"
)
;
await
closePreviewForToken
(
dbg
tokenEl
)
;
}
)
;
