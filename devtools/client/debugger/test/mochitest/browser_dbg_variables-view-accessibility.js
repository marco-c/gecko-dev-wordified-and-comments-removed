var
gTab
gPanel
gDebugger
;
var
gVariablesView
;
function
test
(
)
{
initDebugger
(
)
.
then
(
(
[
aTab
aPanel
]
)
=
>
{
gTab
=
aTab
;
gPanel
=
aPanel
;
gDebugger
=
gPanel
.
panelWin
;
gVariablesView
=
gDebugger
.
DebuggerView
.
Variables
;
performTest
(
)
.
catch
(
aError
=
>
{
ok
(
false
"
Got
an
error
:
"
+
aError
.
message
+
"
\
n
"
+
aError
.
stack
)
;
}
)
;
}
)
;
}
function
performTest
(
)
{
let
arr
=
[
42
true
"
nasu
"
undefined
null
[
0
1
2
]
{
prop1
:
9
prop2
:
8
}
]
;
let
obj
=
{
p0
:
42
p1
:
true
p2
:
"
nasu
"
p3
:
undefined
p4
:
null
p5
:
[
3
4
5
]
p6
:
{
prop1
:
7
prop2
:
6
}
get
p7
(
)
{
return
arr
;
}
set
p8
(
value
)
{
arr
[
0
]
=
value
;
}
}
;
let
test
=
{
someProp0
:
42
someProp1
:
true
someProp2
:
"
nasu
"
someProp3
:
undefined
someProp4
:
null
someProp5
:
arr
someProp6
:
obj
get
someProp7
(
)
{
return
arr
;
}
set
someProp7
(
value
)
{
arr
[
0
]
=
value
;
}
}
;
gVariablesView
.
eval
=
function
(
)
{
}
;
gVariablesView
.
switch
=
function
(
)
{
}
;
gVariablesView
.
delete
=
function
(
)
{
}
;
gVariablesView
.
rawObject
=
test
;
gVariablesView
.
scrollPageSize
=
5
;
return
Task
.
spawn
(
function
*
(
)
{
yield
waitForTick
(
)
;
gVariablesView
.
focusFirstVisibleItem
(
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
gVariablesView
.
focusNextItem
(
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp1
"
"
The
'
someProp1
'
item
should
be
focused
.
"
)
;
gVariablesView
.
focusPrevItem
(
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
yield
synthesizeKeyAndWaitForTick
(
"
KEY_ArrowDown
"
)
;
is
(
gVariablesView
.
_parent
.
scrollTop
0
"
The
'
variables
'
view
shouldn
'
t
scroll
when
pressing
the
DOWN
key
.
"
)
;
yield
synthesizeKeyAndWaitForTick
(
"
KEY_ArrowUp
"
)
;
is
(
gVariablesView
.
_parent
.
scrollTop
0
"
The
'
variables
'
view
shouldn
'
t
scroll
when
pressing
the
UP
key
.
"
)
;
yield
synthesizeKeyAndWaitForElement
(
"
KEY_Enter
"
{
}
"
.
element
-
value
-
input
"
true
)
;
yield
synthesizeKeyAndWaitForElement
(
"
KEY_Escape
"
{
}
"
.
element
-
value
-
input
"
false
)
;
yield
synthesizeKeyAndWaitForElement
(
"
KEY_Enter
"
{
shiftKey
:
true
}
"
.
element
-
name
-
input
"
true
)
;
yield
synthesizeKeyAndWaitForElement
(
"
KEY_Escape
"
{
}
"
.
element
-
name
-
input
"
false
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp1
"
"
The
'
someProp1
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_End
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Home
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp1
"
"
The
'
someProp1
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp2
"
"
The
'
someProp2
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp1
"
"
The
'
someProp1
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Home
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Home
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Home
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_End
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_End
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_End
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Home
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp1
"
"
The
'
someProp1
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_End
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
false
"
The
'
someProp5
'
item
should
not
be
expanded
yet
.
"
)
;
yield
synthesizeKeyAndWaitForTick
(
"
KEY_ArrowRight
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
true
"
The
'
someProp5
'
item
should
now
be
expanded
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_store
.
size
9
"
There
should
be
9
properties
in
the
selected
variable
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_enumItems
.
length
7
"
There
should
be
7
enumerable
properties
in
the
selected
variable
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_nonEnumItems
.
length
2
"
There
should
be
2
non
-
enumerable
properties
in
the
selected
variable
.
"
)
;
yield
waitForChildNodes
(
gVariablesView
.
getFocusedItem
(
)
.
_enum
7
)
;
yield
waitForChildNodes
(
gVariablesView
.
getFocusedItem
(
)
.
_nonenum
2
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowRight
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
0
"
"
The
'
0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowRight
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
0
"
"
The
'
0
'
item
should
still
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
5
"
"
The
'
5
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
false
"
The
'
5
'
item
should
not
be
expanded
yet
.
"
)
;
yield
synthesizeKeyAndWaitForTick
(
"
KEY_ArrowRight
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
5
"
"
The
'
5
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
true
"
The
'
5
'
item
should
now
be
expanded
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_store
.
size
5
"
There
should
be
5
properties
in
the
selected
variable
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_enumItems
.
length
3
"
There
should
be
3
enumerable
properties
in
the
selected
variable
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_nonEnumItems
.
length
2
"
There
should
be
2
non
-
enumerable
properties
in
the
selected
variable
.
"
)
;
yield
waitForChildNodes
(
gVariablesView
.
getFocusedItem
(
)
.
_enum
3
)
;
yield
waitForChildNodes
(
gVariablesView
.
getFocusedItem
(
)
.
_nonenum
2
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowRight
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
0
"
"
The
'
0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowRight
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
0
"
"
The
'
0
'
item
should
still
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
6
"
"
The
'
6
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
false
"
The
'
6
'
item
should
not
be
expanded
yet
.
"
)
;
yield
synthesizeKeyAndWaitForTick
(
"
KEY_ArrowRight
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
6
"
"
The
'
6
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
true
"
The
'
6
'
item
should
now
be
expanded
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_store
.
size
3
"
There
should
be
3
properties
in
the
selected
variable
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_enumItems
.
length
2
"
There
should
be
2
enumerable
properties
in
the
selected
variable
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
_nonEnumItems
.
length
1
"
There
should
be
1
non
-
enumerable
properties
in
the
selected
variable
.
"
)
;
yield
waitForChildNodes
(
gVariablesView
.
getFocusedItem
(
)
.
_enum
2
)
;
yield
waitForChildNodes
(
gVariablesView
.
getFocusedItem
(
)
.
_nonenum
1
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowRight
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
prop1
"
"
The
'
prop1
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowRight
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
prop1
"
"
The
'
prop1
'
item
should
still
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp6
"
"
The
'
someProp6
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
false
"
The
'
someProp6
'
item
should
not
be
expanded
yet
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowLeft
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp6
"
"
The
'
someProp6
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowLeft
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
true
"
The
'
6
'
item
should
still
be
expanded
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowLeft
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
still
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
expanded
false
"
The
'
6
'
item
should
still
not
be
expanded
anymore
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowLeft
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
still
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp4
"
"
The
'
someProp4
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp3
"
"
The
'
someProp3
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp2
"
"
The
'
someProp2
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp1
"
"
The
'
someProp1
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp0
"
"
The
'
someProp0
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_PageDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp5
"
"
The
'
someProp5
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp6
"
"
The
'
someProp6
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp7
"
"
The
'
someProp7
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
get
"
"
The
'
get
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
set
"
"
The
'
set
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowDown
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
item
should
be
focused
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Backspace
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
__proto__
"
"
The
'
__proto__
'
variable
should
still
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
value
"
[
object
Object
]
"
"
The
'
__proto__
'
variable
should
not
have
an
empty
value
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
visible
false
"
The
'
__proto__
'
variable
should
be
hidden
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
set
"
"
The
'
set
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
value
"
[
object
Object
]
"
"
The
'
set
'
item
should
not
have
an
empty
value
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
visible
true
"
The
'
set
'
item
should
be
visible
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Backspace
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
set
"
"
The
'
set
'
item
should
still
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
value
"
[
object
Object
]
"
"
The
'
set
'
item
should
not
have
an
empty
value
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
visible
true
"
The
'
set
'
item
should
be
visible
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
twisty
false
"
The
'
set
'
item
should
be
disabled
and
have
a
hidden
twisty
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
get
"
"
The
'
get
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
value
"
[
object
Object
]
"
"
The
'
get
'
item
should
not
have
an
empty
value
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
visible
true
"
The
'
get
'
item
should
be
visible
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Backspace
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
get
"
"
The
'
get
'
item
should
still
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
value
"
[
object
Object
]
"
"
The
'
get
'
item
should
not
have
an
empty
value
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
visible
true
"
The
'
get
'
item
should
be
visible
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
twisty
false
"
The
'
get
'
item
should
be
disabled
and
have
a
hidden
twisty
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_ArrowUp
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp7
"
"
The
'
someProp7
'
item
should
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
value
undefined
"
The
'
someProp7
'
variable
should
have
an
empty
value
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
visible
true
"
The
'
someProp7
'
variable
should
be
visible
.
"
)
;
EventUtils
.
synthesizeKey
(
"
KEY_Backspace
"
{
}
gDebugger
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
name
"
someProp7
"
"
The
'
someProp7
'
variable
should
still
be
focused
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
value
undefined
"
The
'
someProp7
'
variable
should
have
an
empty
value
.
"
)
;
is
(
gVariablesView
.
getFocusedItem
(
)
.
visible
false
"
The
'
someProp7
'
variable
should
be
hidden
.
"
)
;
gVariablesView
.
focusFirstVisibleItem
(
)
;
let
copied
=
promise
.
defer
(
)
;
let
expectedValue
=
gVariablesView
.
getFocusedItem
(
)
.
name
+
gVariablesView
.
getFocusedItem
(
)
.
separatorStr
+
gVariablesView
.
getFocusedItem
(
)
.
value
;
waitForClipboard
(
expectedValue
function
setup
(
)
{
EventUtils
.
synthesizeKey
(
"
C
"
{
metaKey
:
true
}
gDebugger
)
;
}
copied
.
resolve
copied
.
reject
)
;
try
{
yield
copied
.
promise
;
ok
(
true
"
Ctrl
-
C
copied
the
selected
item
to
the
clipboard
.
"
)
;
}
catch
(
e
)
{
ok
(
false
"
Ctrl
-
C
didn
'
t
copy
the
selected
item
to
the
clipboard
.
"
)
;
}
yield
closeDebuggerAndFinish
(
gPanel
)
;
}
)
;
}
registerCleanupFunction
(
function
(
)
{
gTab
=
null
;
gPanel
=
null
;
gDebugger
=
null
;
gVariablesView
=
null
;
}
)
;
function
synthesizeKeyAndWaitForElement
(
aKey
aModifiers
aSelector
aExistence
)
{
EventUtils
.
synthesizeKey
(
aKey
aModifiers
gDebugger
)
;
return
waitForElement
(
aSelector
aExistence
)
;
}
function
synthesizeKeyAndWaitForTick
(
aKey
aModifiers
)
{
EventUtils
.
synthesizeKey
(
aKey
aModifiers
gDebugger
)
;
return
waitForTick
(
)
;
}
function
waitForElement
(
aSelector
aExistence
)
{
return
waitForPredicate
(
(
)
=
>
{
return
!
!
gVariablesView
.
_list
.
querySelector
(
aSelector
)
=
=
aExistence
;
}
)
;
}
function
waitForChildNodes
(
aTarget
aCount
)
{
return
waitForPredicate
(
(
)
=
>
{
return
aTarget
.
childNodes
.
length
=
=
aCount
;
}
)
;
}
function
waitForPredicate
(
aPredicate
aInterval
=
10
)
{
let
deferred
=
promise
.
defer
(
)
;
let
count
=
0
;
let
intervalID
=
window
.
setInterval
(
(
)
=
>
{
if
(
+
+
count
>
1000
)
{
deferred
.
reject
(
"
Timed
out
while
polling
for
the
element
.
"
)
;
window
.
clearInterval
(
intervalID
)
;
return
;
}
if
(
!
aPredicate
(
)
)
{
return
;
}
window
.
clearInterval
(
intervalID
)
;
deferred
.
resolve
(
)
;
}
aInterval
)
;
return
deferred
.
promise
;
}
