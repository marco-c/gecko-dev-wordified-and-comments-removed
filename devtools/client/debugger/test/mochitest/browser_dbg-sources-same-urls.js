add_task
(
async
function
(
)
{
const
dbg
=
await
initDebugger
(
"
doc
-
sources
-
multiple
-
workers
.
html
"
"
shared
-
worker
"
"
simple
-
worker
"
"
simple
-
worker
"
)
;
const
{
selectors
:
{
getSelectedSource
}
getState
}
=
dbg
;
await
assertSourceCount
(
dbg
6
)
;
await
clickElement
(
dbg
"
sourceDirectoryLabel
"
4
)
;
await
assertSourceCount
(
dbg
8
)
;
await
clickElement
(
dbg
"
sourceDirectoryLabel
"
6
)
;
await
assertSourceCount
(
dbg
9
)
;
await
clickElement
(
dbg
"
sourceDirectoryLabel
"
8
)
;
await
assertSourceCount
(
dbg
11
)
;
await
clickElement
(
dbg
"
sourceDirectoryLabel
"
10
)
;
await
assertSourceCount
(
dbg
12
)
;
await
clickElement
(
dbg
"
sourceDirectoryLabel
"
12
)
;
await
assertSourceCount
(
dbg
14
)
;
await
clickElement
(
dbg
"
sourceDirectoryLabel
"
14
)
;
await
assertSourceCount
(
dbg
15
)
;
const
selectedSharedWorkerSource
=
waitForDispatch
(
dbg
"
SET_FOCUSED_SOURCE_ITEM
"
)
;
await
clickElement
(
dbg
"
sourceNode
"
7
)
;
await
selectedSharedWorkerSource
;
const
sharedWorkerSource
=
getSelectedSource
(
)
.
url
;
ok
(
sharedWorkerSource
.
includes
(
"
shared
-
worker
.
js
"
)
"
shared
worker
source
is
selected
"
)
;
const
selectedSimpleWorkerSource
=
waitForDispatch
(
dbg
"
SET_FOCUSED_SOURCE_ITEM
"
)
;
await
clickElement
(
dbg
"
sourceNode
"
15
)
;
await
selectedSimpleWorkerSource
;
const
firstSimpleWorkerSourceNode
=
findElement
(
dbg
"
sourceNode
"
11
)
;
ok
(
!
firstSimpleWorkerSourceNode
.
classList
.
contains
(
"
focused
"
)
The
first
simple
worker
source
is
not
selected
)
;
const
secondSimpleWorkerSourceNode
=
findElement
(
dbg
"
sourceNode
"
15
)
;
ok
(
secondSimpleWorkerSourceNode
.
classList
.
contains
(
"
focused
"
)
The
second
simple
worker
source
is
selected
)
;
}
)
;
