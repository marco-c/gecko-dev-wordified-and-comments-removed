"
use
strict
"
;
add_task
(
async
function
(
)
{
const
dbg
=
await
initDebugger
(
"
doc
-
scripts
.
html
"
"
simple2
.
js
"
)
;
await
selectSource
(
dbg
"
simple2
.
js
"
1
)
;
clickElement
(
dbg
"
CodeMirrorLines
"
)
;
await
waitForElementWithSelector
(
dbg
"
.
CodeMirror
-
code
"
)
;
getCM
(
dbg
)
.
setSelection
(
{
line
:
0
ch
:
0
}
{
line
:
8
ch
:
0
}
)
;
rightClickElement
(
dbg
"
CodeMirrorLines
"
)
;
await
waitForContextMenu
(
dbg
)
;
selectContextMenuItem
(
dbg
"
#
node
-
menu
-
evaluate
-
in
-
console
"
)
;
await
waitForConsolePanelChange
(
dbg
)
;
await
hasConsoleMessage
(
dbg
"
undefined
"
)
;
}
)
;
function
waitForConsolePanelChange
(
dbg
)
{
const
{
toolbox
}
=
dbg
;
return
new
Promise
(
resolve
=
>
{
toolbox
.
getPanelWhenReady
(
"
webconsole
"
)
.
then
(
(
)
=
>
{
ok
(
toolbox
.
webconsolePanel
"
Console
is
shown
.
"
)
;
resolve
(
toolbox
.
webconsolePanel
)
;
}
)
;
}
)
;
}
