const
TAB_URL
=
EXAMPLE_URL
+
"
doc_pretty
-
print
.
html
"
;
function
test
(
)
{
initDebugger
(
TAB_URL
)
.
then
(
(
[
aTab
aPanel
]
)
=
>
{
const
gTab
=
aTab
;
const
gPanel
=
aPanel
;
const
gDebugger
=
gPanel
.
panelWin
;
const
gEditor
=
gDebugger
.
DebuggerView
.
editor
;
const
gSources
=
gDebugger
.
DebuggerView
.
Sources
;
const
queries
=
gDebugger
.
require
(
'
.
/
content
/
queries
'
)
;
const
getState
=
gDebugger
.
DebuggerController
.
getState
;
Task
.
spawn
(
function
*
(
)
{
yield
waitForSourceShown
(
gPanel
"
code_ugly
.
js
"
)
;
ok
(
!
gEditor
.
getText
(
)
.
includes
(
"
\
n
"
)
"
The
source
shouldn
'
t
be
pretty
printed
yet
.
"
)
;
yield
toggleBlackBoxing
(
gPanel
)
;
yield
waitForTick
(
)
;
gDebugger
.
document
.
getElementById
(
"
pretty
-
print
"
)
.
click
(
)
;
yield
waitForTick
(
)
;
const
source
=
queries
.
getSelectedSource
(
getState
(
)
)
;
const
{
text
}
=
queries
.
getSourceText
(
getState
(
)
source
.
actor
)
;
ok
(
!
text
.
includes
(
"
\
n
"
)
)
;
closeDebuggerAndFinish
(
gPanel
)
;
}
)
;
}
)
;
}
