import
type
{
ThreadContext
}
from
"
.
.
/
.
.
/
types
"
;
import
type
{
ThunkArgs
}
from
"
.
.
/
types
"
;
import
{
isValidThreadContext
}
from
"
.
.
/
.
.
/
utils
/
context
"
;
export
function
fetchFrames
(
cx
:
ThreadContext
)
{
return
async
function
(
{
dispatch
client
getState
}
:
ThunkArgs
)
{
const
{
thread
}
=
cx
;
let
frames
;
try
{
frames
=
await
client
.
getFrames
(
thread
)
;
}
catch
(
e
)
{
if
(
isValidThreadContext
(
getState
(
)
cx
)
)
{
throw
new
Error
(
"
Thread
context
is
still
valid
"
)
;
}
}
dispatch
(
{
type
:
"
FETCHED_FRAMES
"
thread
frames
cx
}
)
;
}
;
}
