import
{
correctIndentation
}
from
"
.
/
indentation
"
;
import
{
getGrip
getFront
}
from
"
.
/
evaluation
-
result
"
;
const
UNAVAILABLE_GRIP
=
{
unavailable
:
true
}
;
export
function
wrapExpression
(
input
)
{
return
correctIndentation
(
try
{
{
input
}
}
catch
(
e
)
{
e
}
)
;
}
function
isUnavailable
(
value
)
{
return
(
value
&
&
!
!
value
.
isError
&
&
(
value
.
class
=
=
=
"
ReferenceError
"
|
|
value
.
class
=
=
=
"
TypeError
"
)
)
;
}
export
function
getExpressionResultGripAndFront
(
expression
)
{
const
{
value
}
=
expression
;
if
(
!
value
)
{
return
{
expressionResultGrip
:
UNAVAILABLE_GRIP
}
;
}
const
expressionResultReturn
=
value
.
exception
|
|
value
.
result
;
const
valueGrip
=
getGrip
(
expressionResultReturn
)
;
if
(
!
valueGrip
|
|
isUnavailable
(
valueGrip
)
)
{
return
{
expressionResultGrip
:
UNAVAILABLE_GRIP
}
;
}
if
(
valueGrip
.
isError
)
{
const
{
name
message
}
=
valueGrip
.
preview
;
return
{
expressionResultGrip
:
{
name
}
:
{
message
}
}
;
}
return
{
expressionResultGrip
:
valueGrip
expressionResultFront
:
getFront
(
expressionResultReturn
)
}
;
}
