import
{
getShouldSelectOriginalLocation
}
from
"
.
/
sources
"
;
import
{
getBlackBoxRanges
}
from
"
.
/
source
-
blackbox
"
;
import
{
getCurrentThreadFrames
}
from
"
.
/
pause
"
;
import
{
annotateFrames
}
from
"
.
.
/
utils
/
pause
/
frames
"
;
import
{
isFrameBlackBoxed
}
from
"
.
.
/
utils
/
source
"
;
import
{
createSelector
}
from
"
reselect
"
;
function
hackFrameLocation
(
frame
shouldSelectOriginalLocation
)
{
if
(
!
shouldSelectOriginalLocation
&
&
frame
.
generatedLocation
&
&
frame
.
generatedLocation
!
=
frame
.
location
)
{
return
{
.
.
.
frame
location
:
frame
.
generatedLocation
}
;
}
return
frame
;
}
export
function
formatCallStackFrames
(
frames
shouldSelectOriginalLocation
blackboxedRanges
)
{
if
(
!
frames
)
{
return
null
;
}
const
hackedFrames
=
frames
.
map
(
frame
=
>
hackFrameLocation
(
frame
shouldSelectOriginalLocation
)
)
.
filter
(
frame
=
>
!
isFrameBlackBoxed
(
frame
blackboxedRanges
)
)
;
return
annotateFrames
(
hackedFrames
)
;
}
export
const
getCallStackFrames
=
createSelector
(
getCurrentThreadFrames
getShouldSelectOriginalLocation
getBlackBoxRanges
formatCallStackFrames
)
;
