"
use
strict
"
;
const
{
AUDIT
AUDIT_PROGRESS
AUDITING
FILTER_TOGGLE
}
=
require
(
"
.
.
/
constants
"
)
;
exports
.
filterToggle
=
filter
=
>
dispatch
=
>
dispatch
(
{
filter
type
:
FILTER_TOGGLE
}
)
;
exports
.
auditing
=
filter
=
>
dispatch
=
>
{
const
auditing
=
[
filter
]
;
return
dispatch
(
{
auditing
type
:
AUDITING
}
)
;
}
;
exports
.
audit
=
(
walker
filter
)
=
>
dispatch
=
>
new
Promise
(
resolve
=
>
{
const
types
=
[
filter
]
;
const
auditEventHandler
=
(
{
type
ancestries
progress
}
)
=
>
{
switch
(
type
)
{
case
"
error
"
:
walker
.
off
(
"
audit
-
event
"
auditEventHandler
)
;
dispatch
(
{
type
:
AUDIT
error
:
true
}
)
;
resolve
(
)
;
break
;
case
"
completed
"
:
walker
.
off
(
"
audit
-
event
"
auditEventHandler
)
;
dispatch
(
{
type
:
AUDIT
response
:
ancestries
}
)
;
resolve
(
)
;
break
;
case
"
progress
"
:
dispatch
(
{
type
:
AUDIT_PROGRESS
progress
}
)
;
break
;
default
:
break
;
}
}
;
walker
.
on
(
"
audit
-
event
"
auditEventHandler
)
;
walker
.
startAudit
(
{
types
}
)
;
}
)
;
