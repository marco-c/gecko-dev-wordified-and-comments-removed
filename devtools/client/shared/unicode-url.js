"
use
strict
"
;
const
idnService
=
Cc
[
"
mozilla
.
org
/
network
/
idn
-
service
;
1
"
]
.
getService
(
Ci
.
nsIIDNService
)
;
function
getUnicodeHostname
(
hostname
)
{
return
idnService
.
convertToDisplayIDN
(
hostname
)
;
}
function
getUnicodeUrlPath
(
urlPath
)
{
try
{
return
decodeURIComponent
(
urlPath
)
;
}
catch
(
err
)
{
}
return
urlPath
;
}
function
getUnicodeUrl
(
url
)
{
try
{
let
urlObject
;
if
(
typeof
url
=
=
=
"
string
"
)
{
urlObject
=
new
URL
(
url
)
;
}
else
{
urlObject
=
url
;
url
=
urlObject
.
href
;
}
const
{
protocol
hostname
}
=
urlObject
;
if
(
protocol
=
=
=
"
data
:
"
)
{
return
url
;
}
const
readableHostname
=
getUnicodeHostname
(
hostname
)
;
url
=
decodeURIComponent
(
url
)
;
return
url
.
replace
(
hostname
readableHostname
)
;
}
catch
(
err
)
{
}
return
url
;
}
module
.
exports
=
{
getUnicodeHostname
getUnicodeUrlPath
getUnicodeUrl
}
;
