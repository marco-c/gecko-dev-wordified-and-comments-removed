"
use
strict
"
;
const
{
DOM
:
dom
createClass
PropTypes
}
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
"
)
;
const
{
getSourceNames
parseURL
isScratchpadScheme
}
=
require
(
"
devtools
/
client
/
shared
/
source
-
utils
"
)
;
const
{
LocalizationHelper
}
=
require
(
"
devtools
/
client
/
shared
/
l10n
"
)
;
const
l10n
=
new
LocalizationHelper
(
"
chrome
:
/
/
devtools
/
locale
/
components
.
properties
"
)
;
const
webl10n
=
new
LocalizationHelper
(
"
chrome
:
/
/
devtools
/
locale
/
webconsole
.
properties
"
)
;
module
.
exports
=
createClass
(
{
displayName
:
"
Frame
"
propTypes
:
{
frame
:
PropTypes
.
shape
(
{
functionDisplayName
:
PropTypes
.
string
source
:
PropTypes
.
string
.
isRequired
line
:
PropTypes
.
oneOfType
(
[
PropTypes
.
string
PropTypes
.
number
]
)
column
:
PropTypes
.
oneOfType
(
[
PropTypes
.
string
PropTypes
.
number
]
)
}
)
.
isRequired
onClick
:
PropTypes
.
func
.
isRequired
showFunctionName
:
PropTypes
.
bool
showAnonymousFunctionName
:
PropTypes
.
bool
showHost
:
PropTypes
.
bool
showEmptyPathAsHost
:
PropTypes
.
bool
showFullSourceUrl
:
PropTypes
.
bool
}
getDefaultProps
(
)
{
return
{
showFunctionName
:
false
showAnonymousFunctionName
:
false
showHost
:
false
showEmptyPathAsHost
:
false
showFullSourceUrl
:
false
}
;
}
render
(
)
{
let
{
onClick
frame
showFunctionName
showAnonymousFunctionName
showHost
showEmptyPathAsHost
showFullSourceUrl
}
=
this
.
props
;
let
source
=
frame
.
source
?
String
(
frame
.
source
)
:
"
"
;
let
line
=
frame
.
line
!
=
void
0
?
Number
(
frame
.
line
)
:
null
;
let
column
=
frame
.
column
!
=
void
0
?
Number
(
frame
.
column
)
:
null
;
const
{
short
long
host
}
=
getSourceNames
(
source
)
;
const
isLinkable
=
!
!
(
isScratchpadScheme
(
source
)
|
|
parseURL
(
source
)
)
;
const
elements
=
[
]
;
const
sourceElements
=
[
]
;
let
sourceEl
;
let
tooltip
=
long
;
if
(
isLinkable
&
&
line
)
{
tooltip
+
=
:
{
line
}
;
if
(
column
)
{
tooltip
+
=
:
{
column
}
;
}
}
let
attributes
=
{
"
data
-
url
"
:
long
className
:
"
frame
-
link
"
}
;
if
(
showFunctionName
)
{
let
functionDisplayName
=
frame
.
functionDisplayName
;
if
(
!
functionDisplayName
&
&
showAnonymousFunctionName
)
{
functionDisplayName
=
webl10n
.
getStr
(
"
stacktrace
.
anonymousFunction
"
)
;
}
if
(
functionDisplayName
)
{
elements
.
push
(
dom
.
span
(
{
className
:
"
frame
-
link
-
function
-
display
-
name
"
}
functionDisplayName
)
)
;
}
}
let
displaySource
=
showFullSourceUrl
?
long
:
short
;
if
(
showEmptyPathAsHost
&
&
(
displaySource
=
=
=
"
"
|
|
displaySource
=
=
=
"
/
"
)
)
{
displaySource
=
host
;
}
sourceElements
.
push
(
dom
.
span
(
{
className
:
"
frame
-
link
-
filename
"
}
displaySource
)
)
;
if
(
isLinkable
&
&
line
)
{
let
lineInfo
=
:
{
line
}
;
attributes
[
"
data
-
line
"
]
=
line
;
if
(
column
)
{
lineInfo
+
=
:
{
column
}
;
attributes
[
"
data
-
column
"
]
=
column
;
}
sourceElements
.
push
(
dom
.
span
(
{
className
:
"
frame
-
link
-
line
"
}
lineInfo
)
)
;
}
if
(
isLinkable
)
{
sourceEl
=
dom
.
a
(
{
onClick
:
e
=
>
{
e
.
preventDefault
(
)
;
onClick
(
frame
)
;
}
href
:
source
className
:
"
frame
-
link
-
source
"
draggable
:
false
title
:
l10n
.
getFormatStr
(
"
frame
.
viewsourceindebugger
"
tooltip
)
}
sourceElements
)
;
}
else
{
sourceEl
=
dom
.
span
(
{
className
:
"
frame
-
link
-
source
"
title
:
tooltip
}
sourceElements
)
;
}
elements
.
push
(
sourceEl
)
;
if
(
showHost
&
&
host
)
{
elements
.
push
(
dom
.
span
(
{
className
:
"
frame
-
link
-
host
"
}
host
)
)
;
}
return
dom
.
span
(
attributes
.
.
.
elements
)
;
}
}
)
;
