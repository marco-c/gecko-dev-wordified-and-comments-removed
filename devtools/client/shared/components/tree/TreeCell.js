import
{
Component
}
from
"
resource
:
/
/
devtools
/
client
/
shared
/
vendor
/
react
.
mjs
"
;
import
*
as
PropTypes
from
"
resource
:
/
/
devtools
/
client
/
shared
/
vendor
/
react
-
prop
-
types
.
mjs
"
;
import
*
as
dom
from
"
resource
:
/
/
devtools
/
client
/
shared
/
vendor
/
react
-
dom
-
factories
.
mjs
"
;
const
{
input
span
td
}
=
dom
;
class
TreeCell
extends
Component
{
static
get
propTypes
(
)
{
return
{
value
:
PropTypes
.
any
decorator
:
PropTypes
.
object
id
:
PropTypes
.
string
.
isRequired
member
:
PropTypes
.
object
.
isRequired
renderValue
:
PropTypes
.
func
.
isRequired
enableInput
:
PropTypes
.
bool
}
;
}
constructor
(
props
)
{
super
(
props
)
;
this
.
state
=
{
inputEnabled
:
false
}
;
this
.
getCellClass
=
this
.
getCellClass
.
bind
(
this
)
;
this
.
updateInputEnabled
=
this
.
updateInputEnabled
.
bind
(
this
)
;
}
shouldComponentUpdate
(
nextProps
nextState
)
{
return
(
this
.
props
.
value
!
=
=
nextProps
.
value
|
|
this
.
state
!
=
=
nextState
|
|
this
.
props
.
member
.
open
!
=
=
nextProps
.
member
.
open
)
;
}
getCellClass
(
object
id
)
{
const
decorator
=
this
.
props
.
decorator
;
if
(
!
decorator
|
|
!
decorator
.
getCellClass
)
{
return
[
]
;
}
let
classNames
=
decorator
.
getCellClass
(
object
id
)
;
if
(
!
classNames
)
{
return
[
]
;
}
if
(
typeof
classNames
=
=
"
string
"
)
{
classNames
=
[
classNames
]
;
}
return
classNames
;
}
updateInputEnabled
(
evt
)
{
this
.
setState
(
Object
.
assign
(
{
}
this
.
state
{
inputEnabled
:
evt
.
target
.
nodeName
.
toLowerCase
(
)
!
=
=
"
input
"
}
)
)
;
}
render
(
)
{
let
{
member
id
value
decorator
renderValue
enableInput
}
=
this
.
props
;
const
type
=
member
.
type
|
|
"
"
;
const
classNames
=
this
.
getCellClass
(
member
.
object
id
)
|
|
[
]
;
classNames
.
push
(
"
treeValueCell
"
)
;
classNames
.
push
(
type
+
"
Cell
"
)
;
renderValue
=
renderValue
|
|
defaultRenderValue
;
if
(
decorator
?
.
renderValue
)
{
renderValue
=
decorator
.
renderValue
(
member
.
object
id
)
|
|
renderValue
;
}
const
props
=
Object
.
assign
(
{
}
this
.
props
{
object
:
value
}
)
;
let
cellElement
;
if
(
enableInput
&
&
this
.
state
.
inputEnabled
&
&
type
!
=
=
"
object
"
)
{
classNames
.
push
(
"
inputEnabled
"
)
;
cellElement
=
input
(
{
autoFocus
:
true
onBlur
:
this
.
updateInputEnabled
readOnly
:
true
value
"
aria
-
labelledby
"
:
id
}
)
;
}
else
{
cellElement
=
span
(
{
onClick
:
type
!
=
=
"
object
"
?
this
.
updateInputEnabled
:
null
}
renderValue
(
props
)
)
;
}
return
td
(
{
className
:
classNames
.
join
(
"
"
)
role
:
"
presentation
"
}
cellElement
)
;
}
}
const
defaultRenderValue
=
props
=
>
{
return
props
.
object
+
"
"
;
}
;
export
default
TreeCell
;
