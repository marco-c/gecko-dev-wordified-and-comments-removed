"
use
strict
"
;
define
(
function
(
require
exports
module
)
{
const
{
Component
}
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
"
)
;
const
dom
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
-
dom
-
factories
"
)
;
const
PropTypes
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
-
prop
-
types
"
)
;
const
{
findDOMNode
}
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
-
dom
"
)
;
class
Tabs
extends
Component
{
static
get
propTypes
(
)
{
return
{
className
:
PropTypes
.
oneOfType
(
[
PropTypes
.
array
PropTypes
.
string
PropTypes
.
object
]
)
tabActive
:
PropTypes
.
number
onMount
:
PropTypes
.
func
onBeforeChange
:
PropTypes
.
func
onAfterChange
:
PropTypes
.
func
children
:
PropTypes
.
oneOfType
(
[
PropTypes
.
array
PropTypes
.
element
]
)
.
isRequired
showAllTabsMenu
:
PropTypes
.
bool
onAllTabsMenuClick
:
PropTypes
.
func
renderOnlySelected
:
PropTypes
.
bool
}
;
}
static
get
defaultProps
(
)
{
return
{
tabActive
:
0
showAllTabsMenu
:
false
renderOnlySelected
:
false
}
;
}
constructor
(
props
)
{
super
(
props
)
;
this
.
state
=
{
tabActive
:
props
.
tabActive
created
:
[
]
overflow
:
false
}
;
this
.
onOverflow
=
this
.
onOverflow
.
bind
(
this
)
;
this
.
onUnderflow
=
this
.
onUnderflow
.
bind
(
this
)
;
this
.
onKeyDown
=
this
.
onKeyDown
.
bind
(
this
)
;
this
.
onClickTab
=
this
.
onClickTab
.
bind
(
this
)
;
this
.
setActive
=
this
.
setActive
.
bind
(
this
)
;
this
.
renderMenuItems
=
this
.
renderMenuItems
.
bind
(
this
)
;
this
.
renderPanels
=
this
.
renderPanels
.
bind
(
this
)
;
}
componentDidMount
(
)
{
let
node
=
findDOMNode
(
this
)
;
node
.
addEventListener
(
"
keydown
"
this
.
onKeyDown
)
;
if
(
this
.
props
.
showAllTabsMenu
)
{
node
.
addEventListener
(
"
overflow
"
this
.
onOverflow
)
;
node
.
addEventListener
(
"
underflow
"
this
.
onUnderflow
)
;
}
let
index
=
this
.
state
.
tabActive
;
if
(
this
.
props
.
onMount
)
{
this
.
props
.
onMount
(
index
)
;
}
}
componentWillReceiveProps
(
nextProps
)
{
let
{
children
tabActive
}
=
nextProps
;
let
panels
=
children
.
filter
(
panel
=
>
panel
)
;
let
created
=
[
.
.
.
this
.
state
.
created
]
;
if
(
this
.
state
.
created
.
length
!
=
panels
.
length
)
{
created
=
panels
.
map
(
panel
=
>
{
let
createdEntry
=
this
.
state
.
created
.
find
(
entry
=
>
{
return
entry
&
&
entry
.
tabId
=
=
=
panel
.
props
.
id
;
}
)
;
let
isCreated
=
!
!
createdEntry
&
&
createdEntry
.
isCreated
;
let
tabId
=
panel
.
props
.
id
;
return
{
isCreated
tabId
}
;
}
)
;
}
if
(
typeof
tabActive
=
=
=
"
number
"
)
{
tabActive
=
(
tabActive
<
panels
.
length
&
&
tabActive
>
=
0
)
?
tabActive
:
0
;
created
[
tabActive
]
=
Object
.
assign
(
{
}
created
[
tabActive
]
{
isCreated
:
true
}
)
;
this
.
setState
(
{
tabActive
}
)
;
}
this
.
setState
(
{
created
}
)
;
}
componentWillUnmount
(
)
{
let
node
=
findDOMNode
(
this
)
;
node
.
removeEventListener
(
"
keydown
"
this
.
onKeyDown
)
;
if
(
this
.
props
.
showAllTabsMenu
)
{
node
.
removeEventListener
(
"
overflow
"
this
.
onOverflow
)
;
node
.
removeEventListener
(
"
underflow
"
this
.
onUnderflow
)
;
}
}
onOverflow
(
event
)
{
if
(
event
.
target
.
classList
.
contains
(
"
tabs
-
menu
"
)
)
{
this
.
setState
(
{
overflow
:
true
}
)
;
}
}
onUnderflow
(
event
)
{
if
(
event
.
target
.
classList
.
contains
(
"
tabs
-
menu
"
)
)
{
this
.
setState
(
{
overflow
:
false
}
)
;
}
}
onKeyDown
(
event
)
{
if
(
!
event
.
target
.
closest
(
"
.
tabs
-
menu
-
item
"
)
)
{
return
;
}
let
tabActive
=
this
.
state
.
tabActive
;
let
tabCount
=
this
.
props
.
children
.
length
;
switch
(
event
.
code
)
{
case
"
ArrowRight
"
:
tabActive
=
Math
.
min
(
tabCount
-
1
tabActive
+
1
)
;
break
;
case
"
ArrowLeft
"
:
tabActive
=
Math
.
max
(
0
tabActive
-
1
)
;
break
;
}
if
(
this
.
state
.
tabActive
!
=
tabActive
)
{
this
.
setActive
(
tabActive
)
;
}
}
onClickTab
(
index
event
)
{
this
.
setActive
(
index
)
;
if
(
event
)
{
event
.
preventDefault
(
)
;
}
}
setActive
(
index
)
{
let
onAfterChange
=
this
.
props
.
onAfterChange
;
let
onBeforeChange
=
this
.
props
.
onBeforeChange
;
if
(
onBeforeChange
)
{
let
cancel
=
onBeforeChange
(
index
)
;
if
(
cancel
)
{
return
;
}
}
let
created
=
[
.
.
.
this
.
state
.
created
]
;
created
[
index
]
=
Object
.
assign
(
{
}
created
[
index
]
{
isCreated
:
true
}
)
;
let
newState
=
Object
.
assign
(
{
}
this
.
state
{
created
tabActive
:
index
}
)
;
this
.
setState
(
newState
(
)
=
>
{
let
node
=
findDOMNode
(
this
)
;
let
selectedTab
=
node
.
querySelector
(
"
.
is
-
active
>
a
"
)
;
if
(
selectedTab
)
{
selectedTab
.
focus
(
)
;
}
if
(
onAfterChange
)
{
onAfterChange
(
index
)
;
}
}
)
;
}
renderMenuItems
(
)
{
if
(
!
this
.
props
.
children
)
{
throw
new
Error
(
"
There
must
be
at
least
one
Tab
"
)
;
}
if
(
!
Array
.
isArray
(
this
.
props
.
children
)
)
{
this
.
props
.
children
=
[
this
.
props
.
children
]
;
}
let
tabs
=
this
.
props
.
children
.
map
(
(
tab
)
=
>
typeof
tab
=
=
=
"
function
"
?
tab
(
)
:
tab
)
.
filter
(
(
tab
)
=
>
tab
)
.
map
(
(
tab
index
)
=
>
{
let
{
id
className
:
tabClassName
title
badge
showBadge
}
=
tab
.
props
;
let
ref
=
"
tab
-
menu
-
"
+
index
;
let
isTabSelected
=
this
.
state
.
tabActive
=
=
=
index
;
let
className
=
[
"
tabs
-
menu
-
item
"
tabClassName
isTabSelected
?
"
is
-
active
"
:
"
"
]
.
join
(
"
"
)
;
return
(
dom
.
li
(
{
className
key
:
index
ref
role
:
"
presentation
"
}
dom
.
span
(
{
className
:
"
devtools
-
tab
-
line
"
}
)
dom
.
a
(
{
id
:
id
?
id
+
"
-
tab
"
:
"
tab
-
"
+
index
tabIndex
:
isTabSelected
?
0
:
-
1
title
"
aria
-
controls
"
:
id
?
id
+
"
-
panel
"
:
"
panel
-
"
+
index
"
aria
-
selected
"
:
isTabSelected
role
:
"
tab
"
onClick
:
this
.
onClickTab
.
bind
(
this
index
)
}
title
badge
&
&
!
isTabSelected
&
&
showBadge
(
)
?
dom
.
span
(
{
className
:
"
tab
-
badge
"
}
badge
)
:
null
)
)
)
;
}
)
;
let
allTabsMenu
=
this
.
state
.
overflow
?
(
dom
.
div
(
{
className
:
"
all
-
tabs
-
menu
"
onClick
:
this
.
props
.
onAllTabsMenuClick
}
)
)
:
null
;
return
(
dom
.
nav
(
{
className
:
"
tabs
-
navigation
"
}
dom
.
ul
(
{
className
:
"
tabs
-
menu
"
role
:
"
tablist
"
}
tabs
)
allTabsMenu
)
)
;
}
renderPanels
(
)
{
let
{
children
renderOnlySelected
}
=
this
.
props
;
if
(
!
children
)
{
throw
new
Error
(
"
There
must
be
at
least
one
Tab
"
)
;
}
if
(
!
Array
.
isArray
(
children
)
)
{
children
=
[
children
]
;
}
let
selectedIndex
=
this
.
state
.
tabActive
;
let
panels
=
children
.
map
(
(
tab
)
=
>
typeof
tab
=
=
=
"
function
"
?
tab
(
)
:
tab
)
.
filter
(
(
tab
)
=
>
tab
)
.
map
(
(
tab
index
)
=
>
{
let
selected
=
selectedIndex
=
=
=
index
;
if
(
renderOnlySelected
&
&
!
selected
)
{
return
null
;
}
let
id
=
tab
.
props
.
id
;
let
isCreated
=
this
.
state
.
created
[
index
]
&
&
this
.
state
.
created
[
index
]
.
isCreated
;
let
style
=
{
visibility
:
selected
?
"
visible
"
:
"
hidden
"
height
:
selected
?
"
100
%
"
:
"
0
"
}
;
if
(
typeof
tab
.
panel
=
=
"
function
"
&
&
selected
)
{
tab
.
panel
=
tab
.
panel
(
tab
)
;
}
let
panel
=
tab
.
panel
|
|
tab
;
return
(
dom
.
div
(
{
id
:
id
?
id
+
"
-
panel
"
:
"
panel
-
"
+
index
key
:
id
style
:
style
className
:
selected
?
"
tab
-
panel
-
box
"
:
"
tab
-
panel
-
box
hidden
"
role
:
"
tabpanel
"
"
aria
-
labelledby
"
:
id
?
id
+
"
-
tab
"
:
"
tab
-
"
+
index
}
(
selected
|
|
isCreated
)
?
panel
:
null
)
)
;
}
)
;
return
(
dom
.
div
(
{
className
:
"
panels
"
}
panels
)
)
;
}
render
(
)
{
return
(
dom
.
div
(
{
className
:
[
"
tabs
"
this
.
props
.
className
]
.
join
(
"
"
)
}
this
.
renderMenuItems
(
)
this
.
renderPanels
(
)
)
)
;
}
}
class
Panel
extends
Component
{
static
get
propTypes
(
)
{
return
{
id
:
PropTypes
.
string
.
isRequired
className
:
PropTypes
.
string
title
:
PropTypes
.
string
.
isRequired
children
:
PropTypes
.
oneOfType
(
[
PropTypes
.
array
PropTypes
.
element
]
)
.
isRequired
}
;
}
render
(
)
{
return
dom
.
div
(
{
className
:
"
tab
-
panel
"
}
this
.
props
.
children
)
;
}
}
exports
.
TabPanel
=
Panel
;
exports
.
Tabs
=
Tabs
;
}
)
;
