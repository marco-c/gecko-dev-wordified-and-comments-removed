"
use
strict
"
;
const
{
DOM
:
dom
createClass
PropTypes
}
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
"
)
;
const
{
KeyShortcuts
}
=
require
(
"
devtools
/
client
/
shared
/
key
-
shortcuts
"
)
;
module
.
exports
=
createClass
(
{
displayName
:
"
SearchBox
"
propTypes
:
{
delay
:
PropTypes
.
number
keyShortcut
:
PropTypes
.
string
onChange
:
PropTypes
.
func
placeholder
:
PropTypes
.
string
type
:
PropTypes
.
string
}
getInitialState
(
)
{
return
{
value
:
"
"
}
;
}
componentDidMount
(
)
{
if
(
!
this
.
props
.
keyShortcut
)
{
return
;
}
this
.
shortcuts
=
new
KeyShortcuts
(
{
window
}
)
;
this
.
shortcuts
.
on
(
this
.
props
.
keyShortcut
(
name
event
)
=
>
{
event
.
preventDefault
(
)
;
this
.
refs
.
input
.
focus
(
)
;
}
)
;
}
componentWillUnmount
(
)
{
this
.
shortcuts
.
destroy
(
)
;
if
(
this
.
searchTimeout
)
{
clearTimeout
(
this
.
searchTimeout
)
;
}
}
onChange
(
)
{
if
(
this
.
state
.
value
!
=
=
this
.
refs
.
input
.
value
)
{
this
.
setState
(
{
value
:
this
.
refs
.
input
.
value
}
)
;
}
if
(
!
this
.
props
.
delay
)
{
this
.
props
.
onChange
(
this
.
state
.
value
)
;
return
;
}
if
(
this
.
searchTimeout
)
{
clearTimeout
(
this
.
searchTimeout
)
;
}
this
.
searchTimeout
=
setTimeout
(
(
)
=
>
{
this
.
searchTimeout
=
null
;
this
.
props
.
onChange
(
this
.
state
.
value
)
;
}
this
.
props
.
delay
)
;
}
onClearButtonClick
(
)
{
this
.
refs
.
input
.
value
=
"
"
;
this
.
onChange
(
)
;
}
render
(
)
{
let
{
type
=
"
search
"
placeholder
}
=
this
.
props
;
let
{
value
}
=
this
.
state
;
let
divClassList
=
[
"
devtools
-
searchbox
"
"
has
-
clear
-
btn
"
]
;
let
inputClassList
=
[
devtools
-
{
type
}
input
]
;
if
(
value
!
=
=
"
"
)
{
inputClassList
.
push
(
"
filled
"
)
;
}
return
dom
.
div
(
{
className
:
divClassList
.
join
(
"
"
)
}
dom
.
input
(
{
className
:
inputClassList
.
join
(
"
"
)
onChange
:
this
.
onChange
placeholder
ref
:
"
input
"
value
}
)
dom
.
button
(
{
className
:
"
devtools
-
searchinput
-
clear
"
hidden
:
value
=
=
"
"
onClick
:
this
.
onClearButtonClick
}
)
)
;
}
}
)
;
