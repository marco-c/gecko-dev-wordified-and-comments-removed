"
use
strict
"
;
const
{
Ci
}
=
require
(
"
chrome
"
)
;
const
Services
=
require
(
"
Services
"
)
;
const
KeyShortcuts
=
require
(
"
devtools
/
client
/
shared
/
key
-
shortcuts
"
)
;
const
ZOOM_PREF
=
"
devtools
.
toolbox
.
zoomValue
"
;
const
MIN_ZOOM
=
0
.
5
;
const
MAX_ZOOM
=
2
;
const
{
LocalizationHelper
}
=
require
(
"
devtools
/
shared
/
l10n
"
)
;
const
L10N
=
new
LocalizationHelper
(
"
devtools
/
client
/
locales
/
toolbox
.
properties
"
)
;
exports
.
register
=
function
(
window
)
{
const
shortcuts
=
new
KeyShortcuts
(
{
window
}
)
;
const
docShell
=
window
.
QueryInterface
(
Ci
.
nsIInterfaceRequestor
)
.
getInterface
(
Ci
.
nsIWebNavigation
)
.
QueryInterface
(
Ci
.
nsIDocShell
)
;
const
contViewer
=
docShell
.
contentViewer
;
let
zoomValue
=
parseFloat
(
Services
.
prefs
.
getCharPref
(
ZOOM_PREF
)
)
;
const
zoomIn
=
function
(
event
)
{
setZoom
(
zoomValue
+
0
.
1
)
;
event
.
preventDefault
(
)
;
}
;
const
zoomOut
=
function
(
event
)
{
setZoom
(
zoomValue
-
0
.
1
)
;
event
.
preventDefault
(
)
;
}
;
const
zoomReset
=
function
(
event
)
{
setZoom
(
1
)
;
event
.
preventDefault
(
)
;
}
;
const
setZoom
=
function
(
newValue
)
{
zoomValue
=
Math
.
max
(
newValue
MIN_ZOOM
)
;
zoomValue
=
Math
.
min
(
zoomValue
MAX_ZOOM
)
;
zoomValue
=
Math
.
round
(
zoomValue
*
10
)
/
10
;
contViewer
.
fullZoom
=
zoomValue
;
Services
.
prefs
.
setCharPref
(
ZOOM_PREF
zoomValue
)
;
}
;
setZoom
(
zoomValue
)
;
shortcuts
.
on
(
L10N
.
getStr
(
"
toolbox
.
zoomIn
.
key
"
)
zoomIn
)
;
const
zoomIn2
=
L10N
.
getStr
(
"
toolbox
.
zoomIn2
.
key
"
)
;
if
(
zoomIn2
)
{
shortcuts
.
on
(
zoomIn2
zoomIn
)
;
}
shortcuts
.
on
(
L10N
.
getStr
(
"
toolbox
.
zoomOut
.
key
"
)
zoomOut
)
;
const
zoomOut2
=
L10N
.
getStr
(
"
toolbox
.
zoomOut2
.
key
"
)
;
if
(
zoomOut2
)
{
shortcuts
.
on
(
zoomOut2
zoomOut
)
;
}
shortcuts
.
on
(
L10N
.
getStr
(
"
toolbox
.
zoomReset
.
key
"
)
zoomReset
)
;
const
zoomReset2
=
L10N
.
getStr
(
"
toolbox
.
zoomReset2
.
key
"
)
;
if
(
zoomReset2
)
{
shortcuts
.
on
(
zoomReset2
zoomReset
)
;
}
}
;
