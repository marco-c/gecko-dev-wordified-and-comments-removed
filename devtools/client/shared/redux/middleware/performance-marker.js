"
use
strict
"
;
const
ChromeUtils
=
require
(
"
ChromeUtils
"
)
;
const
{
Cu
}
=
require
(
"
chrome
"
)
;
function
createPerformanceMarkerMiddleware
(
cases
)
{
return
function
(
store
)
{
return
next
=
>
action
=
>
{
const
condition
=
cases
[
action
.
type
]
;
const
shouldAddProfileMarker
=
!
!
condition
;
const
startTime
=
shouldAddProfileMarker
?
Cu
.
now
(
)
:
null
;
const
newState
=
next
(
action
)
;
if
(
shouldAddProfileMarker
)
{
ChromeUtils
.
addProfilerMarker
(
{
condition
.
label
}
{
condition
.
sessionId
}
startTime
condition
.
getMarkerDescription
?
condition
.
getMarkerDescription
(
{
action
state
:
store
.
getState
(
)
}
)
:
"
"
)
;
}
return
newState
;
}
;
}
;
}
module
.
exports
=
{
createPerformanceMarkerMiddleware
}
;
