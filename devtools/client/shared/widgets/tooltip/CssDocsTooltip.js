"
use
strict
"
;
const
{
HTMLTooltip
}
=
require
(
"
devtools
/
client
/
shared
/
widgets
/
tooltip
/
HTMLTooltip
"
)
;
const
{
MdnDocsWidget
}
=
require
(
"
devtools
/
client
/
shared
/
widgets
/
MdnDocsWidget
"
)
;
const
{
KeyShortcuts
}
=
require
(
"
devtools
/
client
/
shared
/
key
-
shortcuts
"
)
;
const
XHTML_NS
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
;
const
TOOLTIP_WIDTH
=
418
;
const
TOOLTIP_HEIGHT
=
308
;
function
CssDocsTooltip
(
toolboxDoc
)
{
this
.
tooltip
=
new
HTMLTooltip
(
toolboxDoc
{
type
:
"
arrow
"
consumeOutsideClicks
:
true
autofocus
:
true
useXulWrapper
:
true
stylesheet
:
"
chrome
:
/
/
devtools
/
content
/
shared
/
widgets
/
mdn
-
docs
.
css
"
}
)
;
this
.
widget
=
this
.
setMdnDocsContent
(
)
;
this
.
_onVisitLink
=
this
.
_onVisitLink
.
bind
(
this
)
;
this
.
widget
.
on
(
"
visitlink
"
this
.
_onVisitLink
)
;
this
.
shortcuts
=
new
KeyShortcuts
(
{
window
:
this
.
tooltip
.
topWindow
}
)
;
this
.
_onShortcut
=
this
.
_onShortcut
.
bind
(
this
)
;
this
.
shortcuts
.
on
(
"
Escape
"
this
.
_onShortcut
)
;
}
CssDocsTooltip
.
prototype
=
{
show
:
function
(
anchor
propertyName
)
{
this
.
tooltip
.
once
(
"
shown
"
(
)
=
>
{
this
.
widget
.
loadCssDocs
(
propertyName
)
;
}
)
;
this
.
tooltip
.
show
(
anchor
)
;
}
hide
:
function
(
)
{
this
.
tooltip
.
hide
(
)
;
}
_onShortcut
:
function
(
shortcut
event
)
{
if
(
!
this
.
tooltip
.
isVisible
(
)
)
{
return
;
}
event
.
stopPropagation
(
)
;
event
.
preventDefault
(
)
;
this
.
hide
(
)
;
}
_onVisitLink
:
function
(
)
{
this
.
hide
(
)
;
}
setMdnDocsContent
:
function
(
)
{
let
container
=
this
.
tooltip
.
doc
.
createElementNS
(
XHTML_NS
"
div
"
)
;
container
.
setAttribute
(
"
class
"
"
mdn
-
container
theme
-
body
"
)
;
this
.
tooltip
.
setContent
(
container
{
width
:
TOOLTIP_WIDTH
height
:
TOOLTIP_HEIGHT
}
)
;
return
new
MdnDocsWidget
(
container
)
;
}
destroy
:
function
(
)
{
this
.
widget
.
off
(
"
visitlink
"
this
.
_onVisitLink
)
;
this
.
widget
.
destroy
(
)
;
this
.
shortcuts
.
destroy
(
)
;
this
.
tooltip
.
destroy
(
)
;
}
}
;
module
.
exports
=
CssDocsTooltip
;
