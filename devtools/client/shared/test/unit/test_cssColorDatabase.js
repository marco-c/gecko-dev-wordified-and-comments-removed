"
use
strict
"
;
var
Cu
=
Components
.
utils
;
var
Ci
=
Components
.
interfaces
;
var
Cc
=
Components
.
classes
;
var
{
require
}
=
Cu
.
import
(
"
resource
:
/
/
devtools
/
shared
/
Loader
.
jsm
"
{
}
)
;
const
DOMUtils
=
Cc
[
"
mozilla
.
org
/
inspector
/
dom
-
utils
;
1
"
]
.
getService
(
Ci
.
inIDOMUtils
)
;
const
{
colorUtils
}
=
require
(
"
devtools
/
shared
/
css
-
color
"
)
;
const
{
cssColors
}
=
require
(
"
devtools
/
shared
/
css
-
color
-
db
"
)
;
function
isValid
(
colorName
)
{
ok
(
colorUtils
.
isValidCSSColor
(
colorName
)
colorName
+
"
is
valid
in
database
"
)
;
ok
(
DOMUtils
.
isValidCSSColor
(
colorName
)
colorName
+
"
is
valid
in
DOMUtils
"
)
;
}
function
checkOne
(
colorName
checkName
)
{
let
ours
=
colorUtils
.
colorToRGBA
(
colorName
)
;
let
fromDom
=
DOMUtils
.
colorToRGBA
(
colorName
)
;
deepEqual
(
ours
fromDom
colorName
+
"
agrees
with
DOMUtils
"
)
;
isValid
(
colorName
)
;
if
(
checkName
)
{
let
{
r
g
b
}
=
ours
;
let
ourName
=
colorUtils
.
rgbToColorName
(
r
g
b
)
;
let
domName
=
DOMUtils
.
rgbToColorName
(
r
g
b
)
;
equal
(
ourName
domName
colorName
+
"
canonical
name
agrees
with
DOMUtils
"
)
;
}
}
function
run_test
(
)
{
for
(
let
name
in
cssColors
)
{
checkOne
(
name
true
)
;
}
checkOne
(
"
transparent
"
false
)
;
let
names
=
DOMUtils
.
getCSSValuesForProperty
(
"
background
-
color
"
)
;
for
(
let
name
of
names
)
{
if
(
name
!
=
=
"
hsl
"
&
&
name
!
=
=
"
hsla
"
&
&
name
!
=
=
"
rgb
"
&
&
name
!
=
=
"
rgba
"
&
&
name
!
=
=
"
inherit
"
&
&
name
!
=
=
"
initial
"
&
&
name
!
=
=
"
unset
"
)
{
checkOne
(
name
true
)
;
}
}
}
