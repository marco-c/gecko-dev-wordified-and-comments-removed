"
use
strict
"
;
const
{
PrefsHelper
}
=
require
(
"
devtools
/
client
/
shared
/
prefs
"
)
;
function
test
(
)
{
const
Prefs
=
new
PrefsHelper
(
"
prefs
.
helper
.
test
"
{
float
:
[
"
Float
"
"
float
"
]
json
:
[
"
Json
"
"
json
"
]
jsonWithSpecialChar
:
[
"
Json
"
"
jsonWithSpecialChar
"
]
}
)
;
Prefs
.
registerObserver
(
)
;
Services
.
prefs
.
setCharPref
(
"
prefs
.
helper
.
test
.
json
"
'
{
"
a
"
:
1
}
'
)
;
is
(
Prefs
.
json
.
a
1
"
The
JSON
pref
value
is
correctly
casted
on
get
.
"
)
;
Prefs
.
json
=
{
b
:
2
}
;
is
(
Prefs
.
json
.
a
undefined
"
The
JSON
pref
value
is
correctly
casted
on
set
(
1
)
.
"
)
;
is
(
Prefs
.
json
.
b
2
"
The
JSON
pref
value
is
correctly
casted
on
set
(
2
)
.
"
)
;
Services
.
prefs
.
setStringPref
(
"
prefs
.
helper
.
test
.
jsonWithSpecialChar
"
{
"
hello
"
:
"
"
}
)
;
is
(
Prefs
.
jsonWithSpecialChar
.
hello
"
"
"
The
JSON
pref
value
with
a
special
character
is
correctly
stored
.
"
)
;
Prefs
.
jsonWithSpecialChar
=
{
bye
:
"
"
}
;
is
(
Prefs
.
jsonWithSpecialChar
.
hello
undefined
"
The
JSON
with
the
special
characters
pref
value
is
correctly
set
.
(
1
)
"
)
;
is
(
Prefs
.
jsonWithSpecialChar
.
bye
"
"
"
The
JSON
with
the
special
characters
pref
value
is
correctly
set
.
(
2
)
"
)
;
Services
.
prefs
.
setCharPref
(
"
prefs
.
helper
.
test
.
float
"
"
3
.
14
"
)
;
is
(
Prefs
.
float
3
.
14
"
The
float
pref
value
is
correctly
casted
on
get
.
"
)
;
Prefs
.
float
=
6
.
28
;
is
(
Prefs
.
float
6
.
28
"
The
float
pref
value
is
correctly
casted
on
set
.
"
)
;
Prefs
.
unregisterObserver
(
)
;
Services
.
prefs
.
clearUserPref
(
"
prefs
.
helper
.
test
.
float
"
)
;
Services
.
prefs
.
clearUserPref
(
"
prefs
.
helper
.
test
.
json
"
)
;
Services
.
prefs
.
clearUserPref
(
"
prefs
.
helper
.
test
.
jsonWithSpecialChar
"
)
;
finish
(
)
;
}
