"
use
strict
"
;
(
function
(
exports
)
{
const
{
require
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
devtools
/
shared
/
Loader
.
jsm
"
)
;
exports
.
getTestActor
=
async
function
(
toolbox
)
{
const
client
=
toolbox
.
target
.
client
;
return
getTestActor
(
client
toolbox
.
target
.
localTab
toolbox
)
;
}
;
exports
.
getTestActorWithoutToolbox
=
async
function
(
tab
)
{
const
{
DevToolsServer
}
=
require
(
"
devtools
/
server
/
devtools
-
server
"
)
;
const
{
DevToolsClient
}
=
require
(
"
devtools
/
shared
/
client
/
devtools
-
client
"
)
;
DevToolsServer
.
init
(
)
;
DevToolsServer
.
registerAllActors
(
)
;
const
client
=
new
DevToolsClient
(
DevToolsServer
.
connectPipe
(
)
)
;
await
client
.
connect
(
)
;
await
client
.
mainRoot
.
getTab
(
{
tab
}
)
;
return
getTestActor
(
client
tab
)
;
}
;
const
getTestActor
=
async
function
(
client
tab
toolbox
=
null
)
{
const
targetFront
=
await
client
.
mainRoot
.
getTab
(
{
tab
}
)
;
const
testActorFront
=
await
targetFront
.
getFront
(
"
test
"
)
;
let
highlighter
;
if
(
toolbox
)
{
highlighter
=
(
await
toolbox
.
target
.
getFront
(
"
inspector
"
)
)
.
highlighter
;
testActorFront
.
setHighlighter
(
highlighter
)
;
}
return
testActorFront
;
}
;
}
)
(
this
)
;
