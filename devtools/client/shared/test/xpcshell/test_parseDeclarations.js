"
use
strict
"
;
const
{
parseDeclarations
_parseCommentDeclarations
parseNamedDeclarations
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
css
/
parsing
-
utils
.
js
"
)
;
const
{
isCssPropertyKnown
}
=
require
(
"
resource
:
/
/
devtools
/
server
/
actors
/
css
-
properties
.
js
"
)
;
const
TEST_DATA
=
[
{
input
:
"
p
:
v
;
"
expected
:
[
{
name
:
"
p
"
value
:
"
v
"
priority
:
"
"
offsets
:
[
0
4
]
declarationText
:
"
p
:
v
;
"
}
]
}
{
input
:
"
this
:
is
;
a
:
test
;
"
expected
:
[
{
name
:
"
this
"
value
:
"
is
"
priority
:
"
"
offsets
:
[
0
8
]
declarationText
:
"
this
:
is
;
"
}
{
name
:
"
a
"
value
:
"
test
"
priority
:
"
"
offsets
:
[
8
15
]
declarationText
:
"
a
:
test
;
"
}
]
}
{
input
:
"
name
:
value
;
"
expected
:
[
{
name
:
"
name
"
value
:
"
value
"
priority
:
"
"
offsets
:
[
0
11
]
declarationText
:
"
name
:
value
;
"
}
]
}
{
input
:
"
name
:
value
"
expected
:
[
{
name
:
"
name
"
value
:
"
value
"
priority
:
"
"
offsets
:
[
0
10
]
declarationText
:
"
name
:
value
"
}
]
}
{
input
:
"
p1
:
v1
;
\
t
\
t
\
n
p2
:
v2
;
\
n
\
n
\
n
\
n
\
t
p3
:
v3
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
"
priority
:
"
"
offsets
:
[
0
9
]
declarationText
:
"
p1
:
v1
;
"
}
{
name
:
"
p2
"
value
:
"
v2
"
priority
:
"
"
offsets
:
[
16
22
]
declarationText
:
"
p2
:
v2
;
"
}
{
name
:
"
p3
"
value
:
"
v3
"
priority
:
"
"
offsets
:
[
32
45
]
declarationText
:
"
p3
:
v3
;
"
}
]
}
{
input
:
"
p1
:
v1
;
p2
:
v2
!
important
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
"
priority
:
"
"
offsets
:
[
0
7
]
declarationText
:
"
p1
:
v1
;
"
}
{
name
:
"
p2
"
value
:
"
v2
"
priority
:
"
important
"
offsets
:
[
8
26
]
declarationText
:
"
p2
:
v2
!
important
;
"
}
]
}
{
input
:
"
p1
:
v1
!
important
;
p2
:
v2
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
"
priority
:
"
important
"
offsets
:
[
0
18
]
declarationText
:
"
p1
:
v1
!
important
;
"
}
{
name
:
"
p2
"
value
:
"
v2
"
priority
:
"
"
offsets
:
[
19
25
]
declarationText
:
"
p2
:
v2
"
}
]
}
{
input
:
"
p1
:
v1
!
important
;
p2
:
v2
!
important
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
"
priority
:
"
important
"
offsets
:
[
0
20
]
declarationText
:
"
p1
:
v1
!
important
;
"
}
{
name
:
"
p2
"
value
:
"
v2
"
priority
:
"
important
"
offsets
:
[
21
40
]
declarationText
:
"
p2
:
v2
!
important
;
"
}
]
}
{
input
:
"
p1
:
v1
!
/
*
comment
*
/
important
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
"
priority
:
"
important
"
offsets
:
[
0
29
]
declarationText
:
"
p1
:
v1
!
/
*
comment
*
/
important
;
"
}
]
}
{
input
:
"
p1
:
v1
!
important
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
"
priority
:
"
important
"
offsets
:
[
0
17
]
declarationText
:
"
p1
:
v1
!
important
"
}
]
}
{
input
:
"
p1
:
v1
!
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
!
"
priority
:
"
"
offsets
:
[
0
8
]
declarationText
:
"
p1
:
v1
!
"
}
]
}
{
input
:
"
p1
:
v1
important
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
important
"
priority
:
"
"
offsets
:
[
0
17
]
declarationText
:
"
p1
:
v1
important
;
"
}
]
}
{
input
:
"
p1
:
v1
!
important
v2
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
!
important
v2
"
priority
:
"
"
offsets
:
[
0
21
]
declarationText
:
"
p1
:
v1
!
important
v2
;
"
}
]
}
{
input
:
"
p1
:
v1
!
important
v2
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
!
important
v2
"
priority
:
"
"
offsets
:
[
0
25
]
declarationText
:
"
p1
:
v1
!
important
v2
;
"
}
]
}
{
input
:
"
p1
:
v1
!
/
*
comment
*
/
important
v2
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
!
important
v2
"
priority
:
"
"
offsets
:
[
0
36
]
declarationText
:
"
p1
:
v1
!
/
*
comment
*
/
important
v2
;
"
}
]
}
{
input
:
"
p1
:
v1
!
/
*
hi
*
/
important
v2
;
"
expected
:
[
{
name
:
"
p1
"
value
:
"
v1
!
important
v2
"
priority
:
"
"
offsets
:
[
0
27
]
declarationText
:
"
p1
:
v1
!
/
*
hi
*
/
important
v2
;
"
}
]
}
{
input
:
"
background
-
image
:
url
(
.
.
/
.
.
/
relative
/
image
.
png
)
"
expected
:
[
{
name
:
"
background
-
image
"
value
:
"
url
(
.
.
/
.
.
/
relative
/
image
.
png
)
"
priority
:
"
"
offsets
:
[
0
47
]
declarationText
:
"
background
-
image
:
url
(
.
.
/
.
.
/
relative
/
image
.
png
)
"
}
]
}
{
input
:
"
background
-
image
:
url
(
http
:
/
/
site
.
com
/
test
.
png
)
"
expected
:
[
{
name
:
"
background
-
image
"
value
:
"
url
(
http
:
/
/
site
.
com
/
test
.
png
)
"
priority
:
"
"
offsets
:
[
0
47
]
declarationText
:
"
background
-
image
:
url
(
http
:
/
/
site
.
com
/
test
.
png
)
"
}
]
}
{
input
:
"
background
-
image
:
url
(
wow
.
gif
)
"
expected
:
[
{
name
:
"
background
-
image
"
value
:
"
url
(
wow
.
gif
)
"
priority
:
"
"
offsets
:
[
0
30
]
declarationText
:
"
background
-
image
:
url
(
wow
.
gif
)
"
}
]
}
{
input
:
'
background
:
red
url
(
"
http
:
/
/
site
.
com
/
image
{
}
:
;
.
png
?
id
=
4
#
wat
"
)
'
+
"
repeat
top
right
"
expected
:
[
{
name
:
"
background
"
value
:
'
red
url
(
"
http
:
/
/
site
.
com
/
image
{
}
:
;
.
png
?
id
=
4
#
wat
"
)
'
+
"
repeat
top
right
"
priority
:
"
"
offsets
:
[
0
78
]
declarationText
:
'
background
:
red
url
(
"
http
:
/
/
site
.
com
/
image
{
}
:
;
.
png
?
id
=
4
#
wat
"
)
'
+
"
repeat
top
right
"
}
]
}
{
input
:
"
"
expected
:
[
]
}
{
input
:
"
\
n
\
n
\
n
\
n
\
t
\
t
\
t
\
t
"
expected
:
[
]
}
{
input
:
null
throws
:
true
}
{
input
:
undefined
throws
:
true
}
{
input
:
'
content
:
"
;
color
:
red
;
}
selector
{
color
:
yellow
;
"
'
expected
:
[
{
name
:
"
content
"
value
:
'
"
;
color
:
red
;
}
selector
{
color
:
yellow
;
"
'
priority
:
"
"
offsets
:
[
0
45
]
declarationText
:
'
content
:
"
;
color
:
red
;
}
selector
{
color
:
yellow
;
"
'
}
]
}
{
input
:
"
body
{
color
:
red
;
}
p
{
color
:
blue
;
}
"
expected
:
[
]
}
{
input
:
"
color
:
red
:
font
:
arial
;
"
expected
:
[
{
name
:
"
color
"
value
:
"
red
:
font
:
arial
"
priority
:
"
"
offsets
:
[
0
26
]
}
]
}
{
input
:
"
background
:
red
;
;
;
;
;
"
expected
:
[
{
name
:
"
background
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
0
16
]
declarationText
:
"
background
:
red
;
"
}
]
}
{
input
:
"
background
:
;
"
expected
:
[
{
name
:
"
background
"
value
:
"
"
priority
:
"
"
offsets
:
[
0
12
]
}
]
}
{
input
:
"
;
;
;
;
;
"
expected
:
[
]
}
{
input
:
"
:
;
:
;
"
expected
:
[
]
}
{
input
:
"
color
"
expected
:
[
{
name
:
"
color
"
value
:
"
"
priority
:
"
"
offsets
:
[
0
5
]
}
]
}
{
input
:
"
color
:
blue
;
font
"
expected
:
[
{
name
:
"
color
"
value
:
"
blue
"
priority
:
"
"
offsets
:
[
0
11
]
declarationText
:
"
color
:
blue
;
"
}
{
name
:
"
font
"
value
:
"
"
priority
:
"
"
offsets
:
[
11
15
]
}
]
}
{
input
:
"
color
:
blue
;
font
:
"
expected
:
[
{
name
:
"
color
"
value
:
"
blue
"
priority
:
"
"
offsets
:
[
0
11
]
declarationText
:
"
color
:
blue
;
"
}
{
name
:
"
font
"
value
:
"
"
priority
:
"
"
offsets
:
[
11
16
]
}
]
}
{
input
:
"
Arial
;
color
:
blue
;
"
expected
:
[
{
name
:
"
"
value
:
"
Arial
"
priority
:
"
"
offsets
:
[
0
6
]
}
{
name
:
"
color
"
value
:
"
blue
"
priority
:
"
"
offsets
:
[
6
17
]
declarationText
:
"
color
:
blue
;
"
}
]
}
{
input
:
"
color
:
#
333
"
expected
:
[
{
name
:
"
color
"
value
:
"
#
333
"
priority
:
"
"
offsets
:
[
0
11
]
declarationText
:
"
color
:
#
333
"
}
]
}
{
input
:
"
color
:
#
456789
"
expected
:
[
{
name
:
"
color
"
value
:
"
#
456789
"
priority
:
"
"
offsets
:
[
0
14
]
declarationText
:
"
color
:
#
456789
"
}
]
}
{
input
:
"
wat
:
#
XYZ
"
expected
:
[
{
name
:
"
wat
"
value
:
"
#
XYZ
"
priority
:
"
"
offsets
:
[
0
9
]
declarationText
:
"
wat
:
#
XYZ
"
}
]
}
{
input
:
"
content
:
\
"
this
is
a
'
string
'
\
"
"
expected
:
[
{
name
:
"
content
"
value
:
"
\
"
this
is
a
'
string
'
\
"
"
priority
:
"
"
offsets
:
[
0
29
]
declarationText
:
"
content
:
\
"
this
is
a
'
string
'
\
"
"
}
]
}
{
input
:
'
content
:
"
this
is
a
\
\
"
string
\
\
"
"
'
expected
:
[
{
name
:
"
content
"
value
:
'
"
this
is
a
\
\
"
string
\
\
"
"
'
priority
:
"
"
offsets
:
[
0
31
]
declarationText
:
'
content
:
"
this
is
a
\
\
"
string
\
\
"
"
'
}
]
}
{
input
:
"
content
:
'
this
is
a
\
"
string
\
"
'
"
expected
:
[
{
name
:
"
content
"
value
:
"
'
this
is
a
\
"
string
\
"
'
"
priority
:
"
"
offsets
:
[
0
29
]
declarationText
:
"
content
:
'
this
is
a
\
"
string
\
"
'
"
}
]
}
{
input
:
"
content
:
'
this
is
a
\
\
'
string
\
\
'
'
"
expected
:
[
{
name
:
"
content
"
value
:
"
'
this
is
a
\
\
'
string
\
\
'
'
"
priority
:
"
"
offsets
:
[
0
31
]
declarationText
:
"
content
:
'
this
is
a
\
\
'
string
\
\
'
'
"
}
]
}
{
input
:
"
content
:
'
this
\
\
'
is
a
\
"
really
strange
string
'
"
expected
:
[
{
name
:
"
content
"
value
:
"
'
this
\
\
'
is
a
\
"
really
strange
string
'
"
priority
:
"
"
offsets
:
[
0
47
]
declarationText
:
"
content
:
'
this
\
\
'
is
a
\
"
really
strange
string
'
"
}
]
}
{
input
:
'
content
:
"
a
not
s
\
\
o
very
long
title
"
'
expected
:
[
{
name
:
"
content
"
value
:
'
"
a
not
s
\
\
o
very
long
title
"
'
priority
:
"
"
offsets
:
[
0
46
]
declarationText
:
'
content
:
"
a
not
s
\
\
o
very
long
title
"
'
}
]
}
{
input
:
"
width
:
calc
(
(
100
%
-
3em
)
/
2
)
"
expected
:
[
{
name
:
"
width
"
value
:
"
calc
(
(
100
%
-
3em
)
/
2
)
"
priority
:
"
"
offsets
:
[
0
29
]
declarationText
:
"
width
:
calc
(
(
100
%
-
3em
)
/
2
)
"
}
]
}
{
parseComments
:
true
input
:
"
width
:
5
;
/
*
background
:
green
;
*
/
background
:
red
;
"
expected
:
[
{
name
:
"
width
"
value
:
"
5
"
priority
:
"
"
offsets
:
[
0
9
]
declarationText
:
"
width
:
5
;
"
}
{
name
:
"
background
"
value
:
"
green
"
priority
:
"
"
offsets
:
[
13
31
]
declarationText
:
"
background
:
green
;
"
commentOffsets
:
[
10
34
]
}
{
name
:
"
background
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
35
51
]
declarationText
:
"
background
:
red
;
"
}
]
}
{
parseComments
:
true
input
:
"
width
:
5
;
/
*
background
something
:
green
;
*
/
background
:
red
;
"
expected
:
[
{
name
:
"
width
"
value
:
"
5
"
priority
:
"
"
offsets
:
[
0
9
]
declarationText
:
"
width
:
5
;
"
}
{
name
:
"
background
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
45
61
]
declarationText
:
"
background
:
red
;
"
}
]
}
{
parseComments
:
true
input
:
"
width
:
5
;
/
*
background
:
*
/
background
:
red
;
"
expected
:
[
{
name
:
"
width
"
value
:
"
5
"
priority
:
"
"
offsets
:
[
0
9
]
declarationText
:
"
width
:
5
;
"
}
{
name
:
"
background
"
value
:
"
"
priority
:
"
"
offsets
:
[
13
24
]
commentOffsets
:
[
10
27
]
}
{
name
:
"
background
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
28
44
]
declarationText
:
"
background
:
red
;
"
}
]
}
{
parseComments
:
true
input
:
"
width
:
5
;
/
*
background
:
yellow
*
/
background
:
red
;
"
expected
:
[
{
name
:
"
width
"
value
:
"
5
"
priority
:
"
"
offsets
:
[
0
9
]
declarationText
:
"
width
:
5
;
"
}
{
name
:
"
background
"
value
:
"
yellow
"
priority
:
"
"
offsets
:
[
13
31
]
declarationText
:
"
background
:
yellow
"
commentOffsets
:
[
10
34
]
}
{
name
:
"
background
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
35
51
]
declarationText
:
"
background
:
red
;
"
}
]
}
{
parseComments
:
true
input
:
"
/
*
content
:
'
*
\
\
/
'
;
*
/
"
expected
:
[
{
name
:
"
content
"
value
:
"
'
*
/
'
"
priority
:
"
"
offsets
:
[
3
18
]
declarationText
:
"
content
:
'
*
\
\
/
'
;
"
commentOffsets
:
[
0
21
]
}
]
}
{
parseComments
:
true
input
:
"
/
*
content
:
'
*
\
\
/
'
*
/
"
expected
:
[
{
name
:
"
content
"
value
:
"
'
*
/
'
"
priority
:
"
"
offsets
:
[
3
17
]
declarationText
:
"
content
:
'
*
\
\
/
'
"
commentOffsets
:
[
0
20
]
}
]
}
{
parseComments
:
true
input
:
"
/
*
color
:
/
\
\
*
comment
*
\
\
/
red
;
*
/
"
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
3
30
]
declarationText
:
"
color
:
/
\
\
*
comment
*
\
\
/
red
;
"
commentOffsets
:
[
0
33
]
}
]
}
{
parseComments
:
true
input
:
"
<
!
-
-
color
:
red
;
-
-
>
color
:
blue
;
"
expected
:
[
{
name
:
"
<
!
-
-
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
0
16
]
}
{
name
:
"
-
-
>
color
"
value
:
"
blue
"
priority
:
"
"
offsets
:
[
17
33
]
}
]
}
{
parseComments
:
true
input
:
"
/
*
*
/
"
expected
:
[
]
}
{
parseComments
:
true
input
:
"
/
*
!
walrus
:
zebra
;
*
/
"
expected
:
[
{
name
:
"
walrus
"
value
:
"
zebra
"
priority
:
"
"
offsets
:
[
4
18
]
declarationText
:
"
walrus
:
zebra
;
"
commentOffsets
:
[
0
21
]
}
]
}
{
input
:
"
color
:
blue
\
\
9
no
\
\
_need
"
expected
:
[
{
name
:
"
color
"
value
:
"
blue
\
\
9
no_need
"
priority
:
"
"
offsets
:
[
0
23
]
declarationText
:
"
color
:
blue
\
\
9
no
\
\
_need
"
}
]
}
{
parseComments
:
true
input
:
"
stroke
-
dasharray
:
1
/
*
ThisIsAComment
*
/
2
;
"
expected
:
[
{
name
:
"
stroke
-
dasharray
"
value
:
"
1
2
"
priority
:
"
"
offsets
:
[
0
39
]
declarationText
:
"
stroke
-
dasharray
:
1
/
*
ThisIsAComment
*
/
2
;
"
}
]
}
{
input
:
"
\
u00a0vertical
-
align
:
top
"
expected
:
[
{
name
:
"
\
u00a0vertical
-
align
"
value
:
"
top
"
priority
:
"
"
offsets
:
[
0
20
]
declarationText
:
"
\
u00a0vertical
-
align
:
top
"
}
]
}
{
input
:
-
-
foo
:
(
:
doodle
{
grid
:
30x1
/
18vmin
;
}
:
container
{
perspective
:
30vmin
;
}
place
-
cell
:
center
;
size
:
100
%
;
:
after
:
before
{
content
:
'
'
;
size
:
100
%
;
position
:
absolute
;
border
:
2
.
4vmin
solid
var
(
-
-
color
)
;
border
-
image
:
radial
-
gradient
(
var
(
-
-
color
)
transparent
60
%
)
;
border
-
image
-
width
:
4
;
transform
:
rotate
(
pn
(
0
5deg
)
)
;
}
will
-
change
:
transform
opacity
;
animation
:
scale
-
up
15s
linear
infinite
;
animation
-
delay
:
calc
(
-
15s
/
size
(
)
*
i
(
)
)
;
box
-
shadow
:
inset
0
0
1em
var
(
-
-
color
)
;
border
-
radius
:
50
%
;
filter
:
var
(
-
-
filter
)
;
keyframes
scale
-
up
{
0
%
100
%
{
transform
:
translateZ
(
0
)
scale
(
0
)
rotate
(
0
)
;
opacity
:
0
;
}
50
%
{
opacity
:
1
;
}
99
%
{
transform
:
translateZ
(
30vmin
)
scale
(
1
)
rotate
(
-
270deg
)
;
}
}
)
;
expected
:
[
{
name
:
"
-
-
foo
"
value
:
"
(
:
doodle
{
grid
:
30x1
/
18vmin
;
}
:
container
{
perspective
:
30vmin
;
}
"
+
"
place
-
cell
:
center
;
size
:
100
%
;
:
after
:
before
{
content
:
'
'
;
size
:
"
+
"
100
%
;
position
:
absolute
;
border
:
2
.
4vmin
solid
var
(
-
-
color
)
;
"
+
"
border
-
image
:
radial
-
gradient
(
var
(
-
-
color
)
transparent
60
%
)
;
"
+
"
border
-
image
-
width
:
4
;
transform
:
rotate
(
pn
(
0
5deg
)
)
;
}
will
-
change
:
"
+
"
transform
opacity
;
animation
:
scale
-
up
15s
linear
infinite
;
"
+
"
animation
-
delay
:
calc
(
-
15s
/
size
(
)
*
i
(
)
)
;
box
-
shadow
:
inset
0
0
1em
"
+
"
var
(
-
-
color
)
;
border
-
radius
:
50
%
;
filter
:
var
(
-
-
filter
)
;
keyframes
"
+
"
scale
-
up
{
0
%
100
%
{
transform
:
translateZ
(
0
)
scale
(
0
)
rotate
(
0
)
;
"
+
"
opacity
:
0
;
}
50
%
{
opacity
:
1
;
}
99
%
{
transform
:
translateZ
(
30vmin
)
"
+
"
scale
(
1
)
rotate
(
-
270deg
)
;
}
}
)
"
priority
:
"
"
offsets
:
[
0
1036
]
}
]
}
{
input
:
color
:
red
;
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
div
:
hover
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
#
myEl
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
.
myEl
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
&
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
>
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
&
:
hover
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
:
not
(
&
)
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
[
class
]
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
&
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
+
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
~
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
*
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
!
important
;
&
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
important
"
offsets
:
[
7
29
]
declarationText
:
"
color
:
red
!
important
;
"
}
]
}
{
input
:
color
:
red
;
/
*
nested
rules
*
/
&
div
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
media
(
orientation
:
landscape
)
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
media
screen
{
background
:
blue
;
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
&
div
{
&
.
active
{
border
:
1px
;
}
padding
:
10px
;
}
background
:
gold
;
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
{
name
:
"
background
"
value
:
"
gold
"
priority
:
"
"
offsets
:
[
121
138
]
declarationText
:
"
background
:
gold
;
"
}
]
}
{
input
:
color
:
red
;
layer
{
background
:
yellow
;
media
screen
{
&
{
border
-
color
:
blue
;
}
}
}
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
]
}
{
input
:
color
:
red
;
.
active
{
border
:
1px
;
}
&
div
{
padding
:
10px
;
}
border
-
color
:
cyan
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
{
name
:
"
border
-
color
"
value
:
"
cyan
"
priority
:
"
"
offsets
:
[
114
132
]
declarationText
:
"
border
-
color
:
cyan
"
}
]
}
{
input
:
color
:
red
;
.
active
{
border
:
1px
;
}
background
:
gold
;
&
div
{
padding
:
10px
;
}
border
-
color
:
cyan
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
{
name
:
"
background
"
value
:
"
gold
"
priority
:
"
"
offsets
:
[
70
87
]
declarationText
:
"
background
:
gold
;
"
}
{
name
:
"
border
-
color
"
value
:
"
cyan
"
priority
:
"
"
offsets
:
[
138
156
]
declarationText
:
"
border
-
color
:
cyan
"
}
]
}
{
input
:
color
:
red
;
&
div
{
content
:
"
}
"
color
:
blue
;
}
background
:
gold
;
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
{
name
:
"
background
"
value
:
"
gold
"
priority
:
"
"
offsets
:
[
88
105
]
declarationText
:
"
background
:
gold
;
"
}
]
}
{
input
:
color
:
red
;
+
.
foo
{
[
class
=
"
}
"
]
{
padding
:
10px
;
}
}
background
:
gold
;
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
{
name
:
"
background
"
value
:
"
gold
"
priority
:
"
"
offsets
:
[
105
122
]
declarationText
:
"
background
:
gold
;
"
}
]
}
{
input
:
color
:
red
;
+
.
foo
{
background
:
url
(
"
img
.
png
?
x
=
}
"
)
}
background
:
gold
;
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
{
name
:
"
background
"
value
:
"
gold
"
priority
:
"
"
offsets
:
[
87
104
]
declarationText
:
"
background
:
gold
;
"
}
]
}
{
input
:
color
:
red
;
+
.
foo
{
/
*
Check
}
*
/
padding
:
10px
;
}
background
:
gold
;
expected
:
[
{
name
:
"
color
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
7
18
]
declarationText
:
"
color
:
red
;
"
}
{
name
:
"
background
"
value
:
"
gold
"
priority
:
"
"
offsets
:
[
93
110
]
declarationText
:
"
background
:
gold
;
"
}
]
}
{
parseComments
:
true
input
:
"
width
:
5
;
/
*
div
{
color
:
cyan
;
}
*
/
background
:
red
;
"
expected
:
[
{
name
:
"
width
"
value
:
"
5
"
priority
:
"
"
offsets
:
[
0
9
]
declarationText
:
"
width
:
5
;
"
}
{
name
:
"
background
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
37
53
]
declarationText
:
"
background
:
red
;
"
}
]
}
{
parseComments
:
true
input
:
"
width
:
5
;
/
*
padding
:
12px
;
div
{
color
:
cyan
;
}
margin
:
1em
;
*
/
background
:
red
;
"
expected
:
[
{
name
:
"
width
"
value
:
"
5
"
priority
:
"
"
offsets
:
[
0
9
]
declarationText
:
"
width
:
5
;
"
}
{
name
:
"
padding
"
value
:
"
12px
"
priority
:
"
"
offsets
:
[
13
27
]
declarationText
:
"
padding
:
12px
;
"
}
{
name
:
"
margin
"
value
:
"
1em
"
priority
:
"
"
offsets
:
[
49
61
]
declarationText
:
"
margin
:
1em
;
"
}
{
name
:
"
background
"
value
:
"
red
"
priority
:
"
"
offsets
:
[
65
81
]
declarationText
:
"
background
:
red
;
"
}
]
}
]
;
function
run_test
(
)
{
run_basic_tests
(
)
;
run_comment_tests
(
)
;
run_named_tests
(
)
;
}
function
run_basic_tests
(
)
{
for
(
const
test
of
TEST_DATA
)
{
info
(
"
Test
input
string
"
+
test
.
input
)
;
let
output
;
try
{
output
=
parseDeclarations
(
isCssPropertyKnown
test
.
input
test
.
parseComments
)
;
}
catch
(
e
)
{
info
(
"
parseDeclarations
threw
an
exception
with
the
given
input
"
+
"
string
"
)
;
if
(
test
.
throws
)
{
info
(
"
Exception
expected
"
)
;
Assert
.
ok
(
true
)
;
}
else
{
info
(
"
Exception
unexpected
\
n
"
+
e
)
;
Assert
.
ok
(
false
)
;
}
}
if
(
output
)
{
assertOutput
(
test
.
input
output
test
.
expected
)
;
}
}
}
const
COMMENT_DATA
=
[
{
input
:
"
content
:
'
hi
"
expected
:
[
{
name
:
"
content
"
value
:
"
'
hi
"
priority
:
"
"
terminator
:
"
'
;
"
offsets
:
[
2
14
]
colonOffsets
:
[
9
11
]
commentOffsets
:
[
0
16
]
}
]
}
{
input
:
"
text
that
once
confounded
the
parser
;
"
expected
:
[
]
}
]
;
function
run_comment_tests
(
)
{
for
(
const
test
of
COMMENT_DATA
)
{
info
(
"
Test
input
string
"
+
test
.
input
)
;
const
output
=
_parseCommentDeclarations
(
isCssPropertyKnown
test
.
input
0
test
.
input
.
length
+
4
)
;
deepEqual
(
output
test
.
expected
)
;
}
}
const
NAMED_DATA
=
[
{
input
:
"
position
:
absolute
;
top50px
;
height
:
50px
;
"
expected
:
[
{
name
:
"
position
"
value
:
"
absolute
"
priority
:
"
"
terminator
:
"
"
offsets
:
[
0
18
]
colonOffsets
:
[
8
9
]
}
{
name
:
"
height
"
value
:
"
50px
"
priority
:
"
"
terminator
:
"
"
offsets
:
[
26
38
]
colonOffsets
:
[
32
33
]
}
]
}
]
;
function
run_named_tests
(
)
{
for
(
const
test
of
NAMED_DATA
)
{
info
(
"
Test
input
string
"
+
test
.
input
)
;
const
output
=
parseNamedDeclarations
(
isCssPropertyKnown
test
.
input
true
)
;
info
(
JSON
.
stringify
(
output
)
)
;
deepEqual
(
output
test
.
expected
)
;
}
}
function
assertOutput
(
input
actual
expected
)
{
if
(
actual
.
length
=
=
=
expected
.
length
)
{
for
(
let
i
=
0
;
i
<
expected
.
length
;
i
+
+
)
{
Assert
.
ok
(
!
!
actual
[
i
]
)
;
info
(
"
Check
that
the
output
item
has
the
expected
name
"
+
"
value
and
priority
"
)
;
Assert
.
equal
(
expected
[
i
]
.
name
actual
[
i
]
.
name
)
;
Assert
.
equal
(
expected
[
i
]
.
value
actual
[
i
]
.
value
)
;
Assert
.
equal
(
expected
[
i
]
.
priority
actual
[
i
]
.
priority
)
;
deepEqual
(
expected
[
i
]
.
offsets
actual
[
i
]
.
offsets
)
;
if
(
"
commentOffsets
"
in
expected
[
i
]
)
{
deepEqual
(
expected
[
i
]
.
commentOffsets
actual
[
i
]
.
commentOffsets
)
;
}
if
(
expected
[
i
]
.
declarationText
)
{
Assert
.
equal
(
input
.
substring
(
expected
[
i
]
.
offsets
[
0
]
expected
[
i
]
.
offsets
[
1
]
)
expected
[
i
]
.
declarationText
)
;
}
}
}
else
{
for
(
const
prop
of
actual
)
{
info
(
"
Actual
output
contained
:
{
name
:
"
+
prop
.
name
+
"
value
:
"
+
prop
.
value
+
"
priority
:
"
+
prop
.
priority
+
"
}
"
)
;
}
Assert
.
equal
(
actual
.
length
expected
.
length
)
;
}
}
