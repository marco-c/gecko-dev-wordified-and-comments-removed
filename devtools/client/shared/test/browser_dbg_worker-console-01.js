"
use
strict
"
;
Services
.
scriptloader
.
loadSubScript
(
"
chrome
:
/
/
mochitests
/
content
/
browser
/
devtools
/
client
/
shared
/
test
/
helper_workers
.
js
"
this
)
;
var
TAB_URL
=
EXAMPLE_URL
+
"
doc_WorkerTargetActor
.
attachThread
-
tab
.
html
"
;
var
WORKER_URL
=
"
code_WorkerTargetActor
.
attachThread
-
worker
.
js
"
;
add_task
(
async
function
testNormalExecution
(
)
{
const
{
client
tab
workerClient
toolbox
}
=
await
initWorkerDebugger
(
TAB_URL
WORKER_URL
)
;
const
jsterm
=
await
getSplitConsole
(
toolbox
)
;
const
executed
=
await
jsterm
.
execute
(
"
this
.
location
.
toString
(
)
"
)
;
ok
(
executed
.
textContent
.
includes
(
WORKER_URL
)
"
Evaluating
the
global
'
s
location
works
"
)
;
terminateWorkerInTab
(
tab
WORKER_URL
)
;
await
waitForWorkerClose
(
workerClient
)
;
await
gDevTools
.
closeToolbox
(
TargetFactory
.
forWorker
(
workerClient
)
)
;
await
close
(
client
)
;
await
removeTab
(
tab
)
;
}
)
;
