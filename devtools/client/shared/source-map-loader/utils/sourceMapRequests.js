"
use
strict
"
;
const
{
generatedToOriginalId
}
=
require
(
"
resource
:
/
/
devtools
/
client
/
shared
/
source
-
map
-
loader
/
utils
/
index
.
js
"
)
;
const
sourceMapRequests
=
new
Map
(
)
;
function
clearSourceMaps
(
)
{
for
(
const
[
metadataPromise
]
of
sourceMapRequests
)
{
metadataPromise
.
then
(
metadata
=
>
{
if
(
metadata
)
{
metadata
.
map
.
destroy
(
)
;
}
}
(
)
=
>
{
}
)
;
}
sourceMapRequests
.
clear
(
)
;
}
function
getSourceMapWithMetadata
(
generatedSourceId
)
{
return
sourceMapRequests
.
get
(
generatedSourceId
)
;
}
function
getSourceMap
(
generatedSourceId
)
{
const
request
=
getSourceMapWithMetadata
(
generatedSourceId
)
;
if
(
!
request
)
{
return
null
;
}
return
request
.
then
(
result
=
>
result
?
.
map
)
;
}
function
setSourceMap
(
generatedId
request
)
{
sourceMapRequests
.
set
(
generatedId
request
.
then
(
map
=
>
{
if
(
!
map
|
|
!
map
.
sources
)
{
return
null
;
}
const
urlsById
=
new
Map
(
)
;
const
sources
=
[
]
;
let
ignoreListUrls
=
[
]
;
if
(
map
.
x_google_ignoreList
?
.
length
)
{
ignoreListUrls
=
map
.
x_google_ignoreList
.
map
(
sourceIndex
=
>
map
.
sources
[
sourceIndex
]
)
;
}
for
(
const
url
of
map
.
sources
)
{
const
id
=
generatedToOriginalId
(
generatedId
url
)
;
urlsById
.
set
(
id
url
)
;
sources
.
push
(
{
id
url
}
)
;
}
return
{
map
urlsById
sources
ignoreListUrls
}
;
}
)
)
;
}
module
.
exports
=
{
clearSourceMaps
getSourceMapWithMetadata
getSourceMap
setSourceMap
}
;
