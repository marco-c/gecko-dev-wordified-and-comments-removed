"
use
strict
"
;
const
Services
=
require
(
"
Services
"
)
;
const
{
gDevTools
}
=
require
(
"
devtools
/
client
/
framework
/
devtools
"
)
;
const
variableFileContents
=
require
(
"
raw
!
devtools
/
client
/
themes
/
variables
.
css
"
)
;
const
THEME_SELECTOR_STRINGS
=
{
light
:
"
:
root
.
theme
-
light
{
"
dark
:
"
:
root
.
theme
-
dark
{
"
firebug
:
"
:
root
.
theme
-
firebug
{
"
}
;
function
getThemeFile
(
name
)
{
let
selector
=
THEME_SELECTOR_STRINGS
[
name
]
|
|
THEME_SELECTOR_STRINGS
.
light
;
let
theme
=
variableFileContents
;
theme
=
theme
.
substring
(
theme
.
indexOf
(
selector
)
)
;
theme
=
theme
.
substring
(
0
theme
.
indexOf
(
"
}
"
)
)
;
return
theme
;
}
const
getTheme
=
exports
.
getTheme
=
(
)
=
>
{
return
Services
.
prefs
.
getCharPref
(
"
devtools
.
theme
"
)
;
}
;
const
getColor
=
exports
.
getColor
=
(
type
theme
)
=
>
{
let
themeName
=
theme
|
|
getTheme
(
)
;
let
themeFile
=
getThemeFile
(
themeName
)
;
let
match
=
themeFile
.
match
(
new
RegExp
(
"
-
-
theme
-
"
+
type
+
"
:
(
.
*
)
;
"
)
)
;
return
match
?
match
[
1
]
:
null
;
}
;
const
setTheme
=
exports
.
setTheme
=
(
newTheme
)
=
>
{
let
oldTheme
=
getTheme
(
)
;
Services
.
prefs
.
setCharPref
(
"
devtools
.
theme
"
newTheme
)
;
gDevTools
.
emit
(
"
pref
-
changed
"
{
pref
:
"
devtools
.
theme
"
newValue
:
newTheme
oldValue
:
oldTheme
}
)
;
}
;
