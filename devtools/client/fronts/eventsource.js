"
use
strict
"
;
const
{
FrontClassWithSpec
registerFront
}
=
require
(
"
devtools
/
shared
/
protocol
"
)
;
const
{
eventSourceSpec
}
=
require
(
"
devtools
/
shared
/
specs
/
eventsource
"
)
;
class
EventSourceFront
extends
FrontClassWithSpec
(
eventSourceSpec
)
{
constructor
(
client
targetFront
parentFront
)
{
super
(
client
targetFront
parentFront
)
;
this
.
_onEventSourceConnectionClosed
=
this
.
_onEventSourceConnectionClosed
.
bind
(
this
)
;
this
.
_onEventReceived
=
this
.
_onEventReceived
.
bind
(
this
)
;
this
.
formAttributeName
=
"
eventSourceActor
"
;
this
.
on
(
"
serverEventSourceConnectionClosed
"
this
.
_onEventSourceConnectionClosed
)
;
this
.
on
(
"
serverEventReceived
"
this
.
_onEventReceived
)
;
}
destroy
(
)
{
this
.
off
(
"
serverEventSourceConnectionClosed
"
)
;
this
.
off
(
"
serverEventReceived
"
)
;
return
super
.
destroy
(
)
;
}
async
_onEventSourceConnectionClosed
(
httpChannelId
)
{
this
.
emit
(
"
eventSourceConnectionClosed
"
httpChannelId
)
;
}
async
_onEventReceived
(
httpChannelId
data
)
{
this
.
emit
(
"
eventReceived
"
httpChannelId
data
)
;
}
}
exports
.
EventSourceFront
=
EventSourceFront
;
registerFront
(
EventSourceFront
)
;
