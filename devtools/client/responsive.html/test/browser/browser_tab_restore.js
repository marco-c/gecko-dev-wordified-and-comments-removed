"
use
strict
"
;
const
TEST_URL
=
"
http
:
/
/
example
.
com
/
"
;
const
ss
=
Cc
[
"
mozilla
.
org
/
browser
/
sessionstore
;
1
"
]
.
getService
(
Ci
.
nsISessionStore
)
;
const
{
TabStateFlusher
}
=
Cu
.
import
(
"
resource
:
/
/
/
modules
/
sessionstore
/
TabStateFlusher
.
jsm
"
{
}
)
;
add_task
(
function
*
(
)
{
let
tab
=
yield
addTab
(
TEST_URL
)
;
yield
TabStateFlusher
.
flush
(
tab
.
linkedBrowser
)
;
let
{
ui
}
=
yield
openRDM
(
tab
)
;
yield
removeTab
(
tab
)
;
is
(
ui
.
destroyed
true
"
RDM
closed
"
)
;
tab
=
ss
.
undoCloseTab
(
window
0
)
;
yield
once
(
tab
"
SSTabRestored
"
)
;
is
(
tab
.
linkedBrowser
.
documentURI
.
spec
TEST_URL
"
Restored
tab
location
to
test
page
"
)
;
yield
removeTab
(
tab
)
;
}
)
;
