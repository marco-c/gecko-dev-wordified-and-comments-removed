"
use
strict
"
;
const
{
filter
map
merge
}
=
require
(
"
sdk
/
event
/
utils
"
)
;
const
{
events
:
browserEvents
}
=
require
(
"
sdk
/
browser
/
events
"
)
;
const
{
events
:
tabEvents
}
=
require
(
"
sdk
/
tab
/
events
"
)
;
const
{
getTabs
getActiveTab
getOwnerWindow
}
=
require
(
"
sdk
/
tabs
/
utils
"
)
;
const
tabSelect
=
filter
(
tabEvents
e
=
>
e
.
type
=
=
=
"
TabSelect
"
)
;
const
tabClose
=
filter
(
tabEvents
e
=
>
e
.
type
=
=
=
"
TabClose
"
)
;
const
windowOpen
=
filter
(
browserEvents
e
=
>
e
.
type
=
=
=
"
load
"
)
;
const
windowClose
=
filter
(
browserEvents
e
=
>
e
.
type
=
=
=
"
close
"
)
;
const
activate
=
merge
(
[
map
(
tabSelect
(
{
target
}
)
=
>
target
)
map
(
windowOpen
(
{
target
}
)
=
>
getActiveTab
(
target
)
)
]
)
;
exports
.
activate
=
activate
;
const
close
=
merge
(
[
map
(
tabClose
(
{
target
}
)
=
>
(
{
window
:
getOwnerWindow
(
target
)
tabs
:
[
target
]
}
)
)
map
(
windowClose
(
{
target
}
)
=
>
(
{
window
:
target
tabs
:
getTabs
(
target
)
}
)
)
]
)
;
exports
.
close
=
close
;
