function
test
(
)
{
waitForExplicitFinish
(
)
;
gBrowser
.
selectedTab
=
BrowserTestUtils
.
addTab
(
gBrowser
)
;
BrowserTestUtils
.
browserLoaded
(
gBrowser
.
selectedBrowser
)
.
then
(
function
(
)
{
openScratchpad
(
runTests
)
;
}
)
;
gBrowser
.
loadURI
(
"
data
:
text
/
html
;
charset
=
utf8
<
p
>
test
long
string
in
Scratchpad
<
/
p
>
"
)
;
}
function
runTests
(
)
{
const
sp
=
gScratchpadWindow
.
Scratchpad
;
sp
.
setText
(
"
'
0
'
.
repeat
(
10000
)
"
)
;
sp
.
display
(
)
.
then
(
(
)
=
>
{
is
(
sp
.
getText
(
)
"
'
0
'
.
repeat
(
10000
)
\
n
"
+
"
/
*
\
n
"
+
"
0
"
.
repeat
(
10000
)
+
"
\
n
*
/
"
"
display
(
)
ing
a
long
string
works
"
)
;
finish
(
)
;
}
)
;
}
