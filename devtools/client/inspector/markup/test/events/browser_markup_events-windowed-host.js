"
use
strict
"
;
const
TEST_URL
=
URL_ROOT
+
"
doc_markup_events
-
overflow
.
html
"
;
add_task
(
async
function
(
)
{
info
(
"
Switch
to
2
pane
inspector
to
avoid
sidebar
width
issues
with
opening
events
"
)
;
await
pushPref
(
"
devtools
.
inspector
.
three
-
pane
-
enabled
"
false
)
;
const
{
inspector
toolbox
}
=
await
openInspectorForURL
(
TEST_URL
)
;
await
runTests
(
inspector
)
;
await
toolbox
.
switchHost
(
"
window
"
)
;
await
wait
(
1000
)
;
await
runTests
(
inspector
)
;
await
toolbox
.
switchHost
(
"
bottom
"
)
;
await
wait
(
1000
)
;
await
runTests
(
inspector
)
;
await
toolbox
.
destroy
(
)
;
}
)
;
async
function
runTests
(
inspector
)
{
const
markupContainer
=
await
getContainerForSelector
(
"
#
events
"
inspector
)
;
const
evHolder
=
markupContainer
.
elt
.
querySelector
(
"
.
inspector
-
badge
.
interactive
[
data
-
event
]
"
)
;
const
tooltip
=
inspector
.
markup
.
eventDetailsTooltip
;
info
(
"
Clicking
to
open
event
tooltip
.
"
)
;
const
onTooltipShown
=
tooltip
.
once
(
"
shown
"
)
;
EventUtils
.
synthesizeMouseAtCenter
(
evHolder
{
}
inspector
.
markup
.
doc
.
defaultView
)
;
await
onTooltipShown
;
ok
(
tooltip
.
isVisible
(
)
"
EventTooltip
visible
.
"
)
;
info
(
"
Click
on
another
tag
to
hide
the
event
tooltip
"
)
;
const
onTooltipHidden
=
tooltip
.
once
(
"
hidden
"
)
;
const
script
=
await
getContainerForSelector
(
"
script
"
inspector
)
;
const
tag
=
script
.
elt
.
querySelector
(
"
.
tag
"
)
;
EventUtils
.
synthesizeMouseAtCenter
(
tag
{
}
inspector
.
markup
.
doc
.
defaultView
)
;
await
onTooltipHidden
;
ok
(
!
tooltip
.
isVisible
(
)
"
EventTooltip
hidden
.
"
)
;
}
