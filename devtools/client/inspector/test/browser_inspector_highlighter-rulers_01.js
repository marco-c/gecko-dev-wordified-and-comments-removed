"
use
strict
"
;
const
TEST_URL
=
"
data
:
text
/
html
;
charset
=
utf
-
8
"
+
"
<
div
style
=
'
position
:
absolute
;
left
:
0
;
top
:
0
;
"
+
"
width
:
40000px
;
height
:
8000px
'
>
<
/
div
>
"
;
const
ID
=
"
rulers
-
highlighter
-
"
;
const
RULERS_MAX_X_AXIS
=
10000
;
const
RULERS_MAX_Y_AXIS
=
15000
;
const
RULERS_TEXT_STEP
=
100
;
add_task
(
async
function
(
)
{
const
{
inspector
testActor
}
=
await
openInspectorForURL
(
TEST_URL
)
;
const
front
=
inspector
.
inspector
;
const
highlighter
=
await
front
.
getHighlighterByType
(
"
RulersHighlighter
"
)
;
await
isHiddenByDefault
(
highlighter
inspector
testActor
)
;
await
hasRightLabelsContent
(
highlighter
inspector
testActor
)
;
await
highlighter
.
finalize
(
)
;
}
)
;
async
function
isHiddenByDefault
(
highlighterFront
inspector
testActor
)
{
info
(
"
Checking
the
highlighter
is
hidden
by
default
"
)
;
let
hidden
=
await
testActor
.
getHighlighterNodeAttribute
(
ID
+
"
elements
"
"
hidden
"
highlighterFront
)
;
is
(
hidden
"
true
"
"
highlighter
is
hidden
by
default
"
)
;
info
(
"
Checking
the
highlighter
is
displayed
when
asked
"
)
;
const
body
=
await
getNodeFront
(
"
body
"
inspector
)
;
await
highlighterFront
.
show
(
body
)
;
hidden
=
await
testActor
.
getHighlighterNodeAttribute
(
ID
+
"
elements
"
"
hidden
"
highlighterFront
)
;
isnot
(
hidden
"
true
"
"
highlighter
is
visible
after
show
"
)
;
}
async
function
hasRightLabelsContent
(
highlighterFront
inspector
testActor
)
{
info
(
"
Checking
the
rulers
have
the
proper
text
based
on
rulers
'
size
"
)
;
const
contentX
=
await
testActor
.
getHighlighterNodeTextContent
(
{
ID
}
x
-
axis
-
text
highlighterFront
)
;
const
contentY
=
await
testActor
.
getHighlighterNodeTextContent
(
{
ID
}
y
-
axis
-
text
highlighterFront
)
;
let
expectedX
=
"
"
;
for
(
let
i
=
RULERS_TEXT_STEP
;
i
<
RULERS_MAX_X_AXIS
;
i
+
=
RULERS_TEXT_STEP
)
{
expectedX
+
=
i
;
}
is
(
contentX
expectedX
"
x
axis
text
content
is
correct
"
)
;
let
expectedY
=
"
"
;
for
(
let
i
=
RULERS_TEXT_STEP
;
i
<
RULERS_MAX_Y_AXIS
;
i
+
=
RULERS_TEXT_STEP
)
{
expectedY
+
=
i
;
}
is
(
contentY
expectedY
"
y
axis
text
content
is
correct
"
)
;
}
