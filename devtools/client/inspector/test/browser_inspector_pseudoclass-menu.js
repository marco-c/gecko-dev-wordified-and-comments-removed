"
use
strict
"
;
const
TEST_URI
=
"
data
:
text
/
html
;
charset
=
UTF
-
8
"
+
"
pseudo
-
class
lock
node
menu
tests
"
+
"
<
div
>
test
div
<
/
div
>
"
;
const
PSEUDOS
=
[
"
hover
"
"
active
"
"
focus
"
]
;
add_task
(
async
function
(
)
{
let
{
inspector
testActor
}
=
await
openInspectorForURL
(
TEST_URI
)
;
await
selectNode
(
"
div
"
inspector
)
;
let
allMenuItems
=
openContextMenuAndGetAllItems
(
inspector
)
;
await
testMenuItems
(
testActor
allMenuItems
inspector
)
;
}
)
;
async
function
testMenuItems
(
testActor
allMenuItems
inspector
)
{
for
(
let
pseudo
of
PSEUDOS
)
{
let
menuItem
=
allMenuItems
.
find
(
item
=
>
item
.
id
=
=
=
"
node
-
menu
-
pseudo
-
"
+
pseudo
)
;
ok
(
menuItem
"
:
"
+
pseudo
+
"
menuitem
exists
"
)
;
is
(
menuItem
.
disabled
false
"
:
"
+
pseudo
+
"
menuitem
is
enabled
"
)
;
let
onPseudo
=
inspector
.
selection
.
once
(
"
pseudoclass
"
)
;
let
onRefresh
=
inspector
.
once
(
"
rule
-
view
-
refreshed
"
)
;
let
onMutations
=
once
(
inspector
.
walker
"
mutations
"
)
;
menuItem
.
click
(
)
;
await
onPseudo
;
await
onRefresh
;
await
onMutations
;
let
hasLock
=
await
testActor
.
hasPseudoClassLock
(
"
div
"
"
:
"
+
pseudo
)
;
ok
(
hasLock
"
pseudo
-
class
lock
has
been
applied
"
)
;
}
}
