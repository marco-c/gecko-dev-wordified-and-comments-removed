"
use
strict
"
;
const
TEST_URI
=
<
style
>
property
-
-
my
-
registered
-
color
{
syntax
:
"
<
color
>
"
;
inherits
:
true
;
initial
-
value
:
blue
;
}
property
-
-
my
-
unset
-
registered
-
color
{
syntax
:
"
<
color
>
"
;
inherits
:
true
;
initial
-
value
:
lavender
;
}
h1
[
data
-
test
=
"
top
-
level
"
]
{
color
:
tomato
;
transition
:
all
1s
;
starting
-
style
{
color
:
gold
;
}
}
starting
-
style
{
body
[
data
-
test
=
"
in
-
starting
-
style
"
]
{
color
:
navy
;
}
layer
{
body
[
data
-
test
=
"
in
-
starting
-
style
-
layer
"
]
{
color
:
hotpink
;
}
}
h1
[
data
-
test
=
"
in
-
starting
-
style
"
]
{
background
-
color
:
salmon
;
}
main
[
data
-
test
=
"
in
-
starting
-
style
"
]
{
-
-
my
-
color
:
black
!
important
;
-
-
my
-
overridden
-
color
:
black
;
-
-
my
-
registered
-
color
:
black
!
important
;
-
-
check
-
my
-
color
:
var
(
-
-
my
-
color
)
;
-
-
check
-
my
-
overridden
-
color
:
var
(
-
-
my
-
overridden
-
color
)
;
-
-
check
-
my
-
registered
-
color
:
var
(
-
-
my
-
registered
-
color
)
;
-
-
check
-
my
-
unset
-
registered
-
color
:
var
(
-
-
my
-
unset
-
registered
-
color
)
;
background
-
color
:
dodgerblue
;
padding
-
top
:
1px
;
margin
-
top
:
1px
!
important
;
outline
-
color
:
dodgerblue
;
}
layer
{
main
[
data
-
test
=
"
in
-
starting
-
style
-
layer
"
]
{
background
-
color
:
forestgreen
;
padding
-
top
:
4px
;
margin
-
top
:
4px
;
outline
-
color
:
forestgreen
!
important
;
}
}
layer
{
main
[
data
-
test
=
"
in
-
starting
-
style
-
layer
-
2
"
]
{
background
-
color
:
cyan
;
padding
-
top
:
5px
;
margin
-
top
:
5px
;
outline
-
color
:
cyan
!
important
;
}
}
}
main
[
data
-
test
=
"
top
-
level
"
]
{
-
-
my
-
color
:
white
;
-
-
my
-
overridden
-
color
:
white
!
important
;
-
-
my
-
registered
-
color
:
white
;
-
-
empty
-
start
:
1px
;
-
-
check
-
my
-
overridden
-
color
:
var
(
-
-
my
-
overridden
-
color
)
;
-
-
check
-
my
-
registered
-
color
:
var
(
-
-
my
-
registered
-
color
)
;
-
-
check
-
empty
-
start
:
var
(
-
-
empty
-
start
)
;
color
:
var
(
-
-
my
-
color
)
;
background
-
color
:
firebrick
;
padding
-
top
:
2px
!
important
;
margin
-
top
:
2px
;
transition
:
all
1s
1000s
;
outline
-
color
:
firebrick
;
outline
-
width
:
5px
;
outline
-
style
:
solid
;
outline
-
offset
:
10px
;
starting
-
style
{
-
-
empty
-
start
:
;
background
-
color
:
goldenrod
;
padding
-
top
:
3px
;
margin
-
top
:
3px
;
outline
-
color
:
goldenrod
;
}
}
<
/
style
>
<
h1
>
Hello
starting
-
style
!
<
/
h1
>
<
main
>
Testing
override
<
/
main
>
;
add_task
(
async
function
(
)
{
await
pushPref
(
"
layout
.
css
.
starting
-
style
-
at
-
rules
.
enabled
"
true
)
;
await
addTab
(
"
https
:
/
/
example
.
com
/
document
-
builder
.
sjs
?
html
=
"
+
encodeURIComponent
(
TEST_URI
)
)
;
const
{
inspector
view
}
=
await
openRuleView
(
)
;
await
selectNode
(
"
body
"
inspector
)
;
await
checkRuleViewContent
(
view
[
{
selector
:
element
ancestorRulesData
:
null
declarations
:
[
]
}
{
selector
:
body
~
~
[
data
-
test
=
"
in
-
starting
-
style
"
]
~
~
ancestorRulesData
:
[
"
starting
-
style
{
"
]
declarations
:
[
{
name
:
"
color
"
value
:
"
navy
"
}
]
}
{
selector
:
body
~
~
[
data
-
test
=
"
in
-
starting
-
style
-
layer
"
]
~
~
ancestorRulesData
:
[
"
starting
-
style
{
"
"
layer
{
"
]
declarations
:
[
{
name
:
"
color
"
value
:
"
hotpink
"
overridden
:
true
}
]
}
{
header
:
"
property
"
}
]
)
;
await
selectNode
(
"
h1
"
inspector
)
;
await
checkRuleViewContent
(
view
[
{
selector
:
element
ancestorRulesData
:
null
declarations
:
[
]
}
{
selector
:
h1
~
~
[
data
-
test
=
"
in
-
starting
-
style
"
]
~
~
ancestorRulesData
:
[
"
starting
-
style
{
"
]
declarations
:
[
{
name
:
"
background
-
color
"
value
:
"
salmon
"
}
]
}
{
selector
:
ancestorRulesData
:
[
h1
[
data
-
test
=
"
top
-
level
"
]
{
"
starting
-
style
{
"
]
declarations
:
[
{
name
:
"
color
"
value
:
"
gold
"
}
]
}
{
selector
:
h1
~
~
[
data
-
test
=
"
top
-
level
"
]
~
~
ancestorRulesData
:
null
declarations
:
[
{
name
:
"
color
"
value
:
"
tomato
"
}
{
name
:
"
transition
"
value
:
"
all
1s
"
}
]
}
{
header
:
"
property
"
}
]
)
;
await
selectNode
(
"
main
"
inspector
)
;
await
checkRuleViewContent
(
view
[
{
selector
:
element
ancestorRulesData
:
null
declarations
:
[
]
}
{
selector
:
ancestorRulesData
:
[
main
[
data
-
test
=
"
top
-
level
"
]
{
"
starting
-
style
{
"
]
declarations
:
[
{
name
:
"
-
-
empty
-
start
"
value
:
"
"
}
{
name
:
"
background
-
color
"
value
:
"
goldenrod
"
overridden
:
false
}
{
name
:
"
padding
-
top
"
value
:
"
3px
"
overridden
:
true
}
{
name
:
"
margin
-
top
"
value
:
"
3px
"
overridden
:
true
}
{
name
:
"
outline
-
color
"
value
:
"
goldenrod
"
overridden
:
true
}
]
}
{
selector
:
main
~
~
[
data
-
test
=
"
top
-
level
"
]
~
~
ancestorRulesData
:
null
declarations
:
[
{
name
:
"
-
-
my
-
color
"
value
:
"
white
"
}
{
name
:
"
-
-
my
-
overridden
-
color
"
value
:
"
white
!
important
"
}
{
name
:
"
-
-
my
-
registered
-
color
"
value
:
"
white
"
}
{
name
:
"
-
-
empty
-
start
"
value
:
"
1px
"
}
{
name
:
"
-
-
check
-
my
-
overridden
-
color
"
value
:
"
var
(
-
-
my
-
overridden
-
color
)
"
}
{
name
:
"
-
-
check
-
my
-
registered
-
color
"
value
:
"
var
(
-
-
my
-
registered
-
color
)
"
}
{
name
:
"
-
-
check
-
empty
-
start
"
value
:
"
var
(
-
-
empty
-
start
)
"
}
{
name
:
"
color
"
value
:
"
var
(
-
-
my
-
color
)
"
}
{
name
:
"
background
-
color
"
value
:
"
firebrick
"
overridden
:
false
}
{
name
:
"
padding
-
top
"
value
:
"
2px
!
important
"
overridden
:
false
}
{
name
:
"
margin
-
top
"
value
:
"
2px
"
overridden
:
false
}
{
name
:
"
transition
"
value
:
"
all
1s
1000s
"
}
{
name
:
"
outline
-
color
"
value
:
"
firebrick
"
overridden
:
false
}
{
name
:
"
outline
-
width
"
value
:
"
5px
"
}
{
name
:
"
outline
-
style
"
value
:
"
solid
"
}
{
name
:
"
outline
-
offset
"
value
:
"
10px
"
}
]
}
{
selector
:
main
~
~
[
data
-
test
=
"
in
-
starting
-
style
"
]
~
~
ancestorRulesData
:
[
"
starting
-
style
{
"
]
declarations
:
[
{
name
:
"
-
-
my
-
color
"
value
:
"
black
!
important
"
}
{
name
:
"
-
-
my
-
overridden
-
color
"
value
:
"
black
"
overridden
:
true
}
{
name
:
"
-
-
my
-
registered
-
color
"
value
:
"
black
!
important
"
}
{
name
:
"
-
-
check
-
my
-
color
"
value
:
"
var
(
-
-
my
-
color
)
"
}
{
name
:
"
-
-
check
-
my
-
overridden
-
color
"
value
:
"
var
(
-
-
my
-
overridden
-
color
)
"
overridden
:
true
}
{
name
:
"
-
-
check
-
my
-
registered
-
color
"
value
:
"
var
(
-
-
my
-
registered
-
color
)
"
overridden
:
true
}
{
name
:
"
-
-
check
-
my
-
unset
-
registered
-
color
"
value
:
"
var
(
-
-
my
-
unset
-
registered
-
color
)
"
}
{
name
:
"
background
-
color
"
value
:
"
dodgerblue
"
overridden
:
true
}
{
name
:
"
padding
-
top
"
value
:
"
1px
"
overridden
:
true
}
{
name
:
"
margin
-
top
"
value
:
"
1px
!
important
"
overridden
:
false
}
{
name
:
"
outline
-
color
"
value
:
"
dodgerblue
"
overridden
:
true
}
]
}
{
selector
:
main
~
~
[
data
-
test
=
"
in
-
starting
-
style
-
layer
-
2
"
]
~
~
ancestorRulesData
:
[
starting
-
style
{
"
layer
{
"
]
declarations
:
[
{
name
:
"
background
-
color
"
value
:
"
cyan
"
overridden
:
true
}
{
name
:
"
padding
-
top
"
value
:
"
5px
"
overridden
:
true
}
{
name
:
"
margin
-
top
"
value
:
"
5px
"
overridden
:
true
}
{
name
:
"
outline
-
color
"
value
:
"
cyan
!
important
"
overridden
:
true
}
]
}
{
selector
:
main
~
~
[
data
-
test
=
"
in
-
starting
-
style
-
layer
"
]
~
~
ancestorRulesData
:
[
starting
-
style
{
"
layer
{
"
]
declarations
:
[
{
name
:
"
background
-
color
"
value
:
"
forestgreen
"
overridden
:
true
}
{
name
:
"
padding
-
top
"
value
:
"
4px
"
overridden
:
true
}
{
name
:
"
margin
-
top
"
value
:
"
4px
"
overridden
:
true
}
{
name
:
"
outline
-
color
"
value
:
"
forestgreen
!
important
"
overridden
:
false
}
]
}
{
header
:
"
property
"
}
]
)
;
info
(
"
Check
that
CSS
variables
set
in
starting
-
style
are
not
impacting
the
var
(
)
tooltip
"
)
;
ok
(
!
isPropertyOverridden
(
view
2
{
"
-
-
my
-
color
"
:
"
white
"
}
)
"
-
-
my
-
color
value
in
top
level
rule
is
not
overridden
"
)
;
info
(
"
Check
var
(
)
in
regular
rule
for
a
variable
set
in
both
regular
and
starting
-
style
rule
"
)
;
await
assertVariableTooltipForProperty
(
view
main
[
data
-
test
=
"
top
-
level
"
]
"
color
"
{
header
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
white
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
white
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
white
<
/
span
>
'
+
'
<
/
span
>
'
computed
:
null
startingStyle
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
black
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
black
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
black
<
/
span
>
'
+
'
<
/
span
>
'
}
)
;
info
(
"
Check
var
(
)
in
starting
-
style
rule
for
a
variable
set
in
both
regular
and
starting
-
style
rule
"
)
;
await
assertVariableTooltipForProperty
(
view
main
[
data
-
test
=
"
in
-
starting
-
style
"
]
"
-
-
check
-
my
-
color
"
{
header
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
black
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
black
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
black
<
/
span
>
'
+
'
<
/
span
>
'
computed
:
null
startingStyle
:
null
}
)
;
info
(
"
Check
var
(
)
in
both
regular
and
starting
-
style
rule
for
a
variable
overridden
in
regular
rule
"
)
;
ok
(
isPropertyOverridden
(
view
3
{
"
-
-
my
-
overridden
-
color
"
:
"
black
"
}
)
"
-
-
my
-
overridden
-
color
in
top
-
level
starting
style
rule
is
overridden
"
)
;
await
assertVariableTooltipForProperty
(
view
main
[
data
-
test
=
"
top
-
level
"
]
"
-
-
check
-
my
-
overridden
-
color
"
{
header
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
white
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
white
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
white
<
/
span
>
'
+
'
<
/
span
>
'
computed
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
white
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
white
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
white
<
/
span
>
'
+
'
<
/
span
>
'
startingStyle
:
null
}
)
;
await
assertVariableTooltipForProperty
(
view
main
[
data
-
test
=
"
in
-
starting
-
style
"
]
"
-
-
check
-
my
-
overridden
-
color
"
{
header
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
white
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
white
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
white
<
/
span
>
'
+
'
<
/
span
>
'
computed
:
null
startingStyle
:
null
}
)
;
info
(
"
Check
var
(
)
for
a
registered
property
in
both
regular
and
starting
-
style
rule
"
)
;
await
assertVariableTooltipForProperty
(
view
main
[
data
-
test
=
"
top
-
level
"
]
"
-
-
check
-
my
-
registered
-
color
"
{
header
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
white
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
white
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
white
<
/
span
>
'
+
'
<
/
span
>
'
computed
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
rgb
(
255
255
255
)
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
rgb
(
255
255
255
)
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
rgb
(
255
255
255
)
<
/
span
>
'
+
'
<
/
span
>
'
startingStyle
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
black
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
black
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
black
<
/
span
>
'
+
'
<
/
span
>
'
registeredProperty
:
{
syntax
:
"
&
lt
;
color
&
gt
;
"
inherits
:
"
true
"
"
initial
-
value
"
:
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
blue
"
class
=
"
color
-
swatch
-
container
"
>
+
<
span
+
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
+
style
=
"
background
-
color
:
blue
"
>
+
<
/
span
>
+
<
span
class
=
"
ruleview
-
color
"
>
blue
<
/
span
>
+
<
/
span
>
}
}
)
;
await
assertVariableTooltipForProperty
(
view
main
[
data
-
test
=
"
in
-
starting
-
style
"
]
"
-
-
check
-
my
-
registered
-
color
"
{
header
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
black
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
black
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
black
<
/
span
>
'
+
'
<
/
span
>
'
computed
:
null
startingStyle
:
null
registeredProperty
:
{
syntax
:
"
&
lt
;
color
&
gt
;
"
inherits
:
"
true
"
"
initial
-
value
"
:
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
blue
"
class
=
"
color
-
swatch
-
container
"
>
+
<
span
+
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
+
style
=
"
background
-
color
:
blue
"
>
+
<
/
span
>
+
<
span
class
=
"
ruleview
-
color
"
>
blue
<
/
span
>
+
<
/
span
>
}
}
)
;
info
(
"
Check
var
(
)
for
a
unset
registered
property
in
starting
-
style
rule
"
)
;
await
assertVariableTooltipForProperty
(
view
main
[
data
-
test
=
"
in
-
starting
-
style
"
]
"
-
-
check
-
my
-
unset
-
registered
-
color
"
{
header
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
lavender
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
lavender
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
lavender
<
/
span
>
'
+
'
<
/
span
>
'
startingStyle
:
null
registeredProperty
:
{
syntax
:
"
&
lt
;
color
&
gt
;
"
inherits
:
"
true
"
"
initial
-
value
"
:
'
<
span
xmlns
=
"
http
:
/
/
www
.
w3
.
org
/
1999
/
xhtml
"
data
-
color
=
"
lavender
"
class
=
"
color
-
swatch
-
container
"
>
'
+
'
<
span
class
=
"
inspector
-
swatch
inspector
-
colorswatch
"
style
=
"
background
-
color
:
lavender
"
>
'
+
'
<
/
span
>
'
+
'
<
span
class
=
"
ruleview
-
color
"
>
lavender
<
/
span
>
'
+
'
<
/
span
>
'
}
}
)
;
info
(
"
Check
var
(
)
for
a
empty
variable
in
regular
rule
"
)
;
await
assertVariableTooltipForProperty
(
view
main
[
data
-
test
=
"
top
-
level
"
]
"
-
-
check
-
empty
-
start
"
{
header
:
"
1px
"
startingStyle
:
"
&
lt
;
empty
&
gt
;
"
startingStyleClasses
:
[
"
empty
-
css
-
variable
"
]
}
)
;
}
)
;
function
isPropertyOverridden
(
view
ruleIndex
property
)
{
return
getTextProperty
(
view
ruleIndex
property
)
.
editor
.
element
.
classList
.
contains
(
"
ruleview
-
overridden
"
)
;
}
