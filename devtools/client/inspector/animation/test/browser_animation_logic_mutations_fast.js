"
use
strict
"
;
add_task
(
async
function
(
)
{
const
tab
=
await
addTab
(
URL_ROOT
+
"
doc_mutations_fast
.
html
"
)
;
const
{
inspector
}
=
await
openAnimationInspector
(
)
;
info
(
"
Check
state
of
the
animation
inspector
after
fast
mutations
"
)
;
const
animationsFinished
=
waitForAnimations
(
inspector
)
;
await
startFastMutations
(
tab
)
;
ok
(
inspector
.
panelWin
.
document
.
getElementById
(
"
animation
-
container
"
)
"
Animation
inspector
should
be
live
"
)
;
await
animationsFinished
;
}
)
;
async
function
startFastMutations
(
tab
)
{
await
ContentTask
.
spawn
(
tab
.
linkedBrowser
{
}
async
function
(
)
{
await
content
.
wrappedJSObject
.
startFastMutations
(
)
;
}
)
;
}
function
waitForAnimations
(
inspector
)
{
let
count
=
1
;
inspector
.
animationinspector
.
animationsFront
.
on
(
"
mutations
"
(
)
=
>
count
+
+
)
;
return
waitForDispatch
(
inspector
"
UPDATE_ANIMATIONS
"
(
)
=
>
count
)
;
}
