"
use
strict
"
;
requestLongerTimeout
(
5
)
;
add_task
(
async
function
(
)
{
await
addTab
(
URL_ROOT
+
"
doc_multiple_property_types
.
html
"
)
;
const
{
panel
inspector
}
=
await
openAnimationInspector
(
)
;
const
timelineComponent
=
panel
.
animationsTimelineComponent
;
const
animationDetailEl
=
timelineComponent
.
rootWrapperEl
.
querySelector
(
"
.
animation
-
detail
"
)
;
const
splitboxControlledEl
=
timelineComponent
.
rootWrapperEl
.
querySelector
(
"
.
controlled
"
)
;
ok
(
animationDetailEl
"
The
animation
-
detail
element
should
exist
"
)
;
const
win
=
timelineComponent
.
rootWrapperEl
.
ownerGlobal
;
is
(
win
.
getComputedStyle
(
splitboxControlledEl
)
.
display
"
none
"
"
The
animation
-
detail
element
should
be
hidden
at
first
"
+
"
if
multiple
animations
were
displayed
"
)
;
await
clickOnAnimation
(
panel
0
)
;
isnot
(
win
.
getComputedStyle
(
splitboxControlledEl
)
.
display
"
none
"
"
The
animation
-
detail
element
should
be
displayed
after
clicked
on
an
animation
"
)
;
await
selectNodeAndWaitForAnimations
(
"
#
target1
"
inspector
)
;
ok
(
animationDetailEl
.
querySelector
(
"
.
property
"
)
"
The
property
in
animation
-
detail
element
should
be
displayed
"
)
;
const
previousHeight
=
animationDetailEl
.
offsetHeight
;
await
clickCloseButtonForDetailPanel
(
timelineComponent
animationDetailEl
)
;
is
(
win
.
getComputedStyle
(
splitboxControlledEl
)
.
display
"
none
"
"
animation
-
detail
element
should
not
display
"
)
;
await
selectNodeAndWaitForAnimations
(
"
#
target2
"
inspector
)
;
isnot
(
win
.
getComputedStyle
(
splitboxControlledEl
)
.
display
"
none
"
"
animation
-
detail
element
should
display
"
)
;
is
(
animationDetailEl
.
offsetHeight
previousHeight
"
The
height
of
animation
-
detail
should
keep
the
height
"
)
;
await
selectNodeAndWaitForAnimations
(
"
#
target1
"
inspector
)
;
await
clickTimelineRewindButton
(
panel
)
;
ok
(
animationDetailEl
.
querySelector
(
"
.
property
"
)
"
The
property
in
animation
-
detail
element
should
stay
as
is
"
)
;
await
clickCloseButtonForDetailPanel
(
timelineComponent
animationDetailEl
)
;
await
clickOnAnimation
(
panel
0
)
;
isnot
(
win
.
getComputedStyle
(
splitboxControlledEl
)
.
display
"
none
"
"
animation
-
detail
element
should
display
again
"
)
;
}
)
;
async
function
clickCloseButtonForDetailPanel
(
timeline
element
)
{
const
button
=
element
.
querySelector
(
"
.
animation
-
detail
-
header
button
"
)
;
const
onclosed
=
timeline
.
once
(
"
animation
-
detail
-
closed
"
)
;
EventUtils
.
sendMouseEvent
(
{
type
:
"
click
"
}
button
element
.
ownerDocument
.
defaultView
)
;
return
onclosed
;
}
