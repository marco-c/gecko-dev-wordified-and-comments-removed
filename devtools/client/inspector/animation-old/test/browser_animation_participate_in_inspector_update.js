"
use
strict
"
;
requestLongerTimeout
(
2
)
;
add_task
(
async
function
(
)
{
await
addTab
(
URL_ROOT
+
"
doc_simple_animation
.
html
"
)
;
let
{
inspector
panel
controller
}
=
await
openAnimationInspector
(
)
;
info
(
"
Listen
for
the
players
-
updated
ui
-
updated
and
"
+
"
inspector
-
updated
events
"
)
;
let
receivedEvents
=
[
]
;
controller
.
once
(
controller
.
PLAYERS_UPDATED_EVENT
(
)
=
>
{
receivedEvents
.
push
(
controller
.
PLAYERS_UPDATED_EVENT
)
;
}
)
;
panel
.
once
(
panel
.
UI_UPDATED_EVENT
(
)
=
>
{
receivedEvents
.
push
(
panel
.
UI_UPDATED_EVENT
)
;
}
)
;
inspector
.
once
(
"
inspector
-
updated
"
(
)
=
>
{
receivedEvents
.
push
(
"
inspector
-
updated
"
)
;
}
)
;
info
(
"
Selecting
an
animated
node
"
)
;
let
node
=
await
getNodeFront
(
"
.
animated
"
inspector
)
;
await
selectNodeAndWaitForAnimations
(
node
inspector
)
;
info
(
"
Check
that
all
events
were
received
"
)
;
is
(
receivedEvents
.
length
3
"
3
events
were
received
"
)
;
is
(
receivedEvents
[
2
]
"
inspector
-
updated
"
"
The
third
event
received
was
the
inspector
-
updated
event
"
)
;
ok
(
receivedEvents
.
includes
(
controller
.
PLAYERS_UPDATED_EVENT
)
"
The
players
-
updated
event
was
received
"
)
;
ok
(
receivedEvents
.
includes
(
panel
.
UI_UPDATED_EVENT
)
"
The
ui
-
updated
event
was
received
"
)
;
}
)
;
