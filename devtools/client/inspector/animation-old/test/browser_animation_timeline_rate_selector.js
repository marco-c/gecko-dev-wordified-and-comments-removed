"
use
strict
"
;
requestLongerTimeout
(
2
)
;
add_task
(
async
function
(
)
{
await
addTab
(
URL_ROOT
+
"
doc_simple_animation
.
html
"
)
;
const
{
panel
controller
inspector
toolbox
}
=
await
openAnimationInspector
(
)
;
disableHighlighter
(
toolbox
)
;
const
select
=
panel
.
rateSelectorEl
.
firstChild
;
ok
(
select
"
The
rate
selector
exists
"
)
;
info
(
"
Change
all
of
the
current
animations
'
rates
to
0
.
5
"
)
;
await
changeTimelinePlaybackRate
(
panel
.
5
)
;
checkAllAnimationsRatesChanged
(
controller
select
.
5
)
;
info
(
"
Select
just
one
animated
node
and
change
its
rate
only
"
)
;
await
selectNodeAndWaitForAnimations
(
"
.
animated
"
inspector
)
;
await
changeTimelinePlaybackRate
(
panel
2
)
;
checkAllAnimationsRatesChanged
(
controller
select
2
)
;
info
(
"
Select
the
<
body
>
again
it
should
now
have
mixed
-
rates
animations
"
)
;
await
selectNodeAndWaitForAnimations
(
"
body
"
inspector
)
;
is
(
select
.
value
"
"
"
The
selected
rate
is
empty
"
)
;
info
(
"
Change
the
rate
for
these
mixed
-
rate
animations
"
)
;
await
changeTimelinePlaybackRate
(
panel
1
)
;
checkAllAnimationsRatesChanged
(
controller
select
1
)
;
}
)
;
function
checkAllAnimationsRatesChanged
(
{
animationPlayers
}
select
rate
)
{
ok
(
animationPlayers
.
every
(
(
{
state
}
)
=
>
state
.
playbackRate
=
=
=
rate
)
"
All
animations
'
rates
have
been
set
to
"
+
rate
)
;
is
(
select
.
value
rate
"
The
right
value
is
displayed
in
the
select
"
)
;
}
