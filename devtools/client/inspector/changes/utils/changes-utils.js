"
use
strict
"
;
const
{
getFormatStr
getStr
}
=
require
(
"
.
/
l10n
"
)
;
function
getSourceHash
(
source
)
{
const
{
type
index
href
}
=
source
;
return
{
type
}
{
index
}
{
href
}
;
}
function
getRuleHash
(
ruleData
)
{
const
{
selectors
=
[
]
ancestors
=
[
]
ruleIndex
}
=
ruleData
;
const
atRules
=
ancestors
.
reduce
(
(
acc
rule
)
=
>
{
acc
+
=
{
rule
.
typeName
}
{
(
rule
.
conditionText
|
|
rule
.
name
|
|
rule
.
keyText
)
}
;
return
acc
;
}
"
"
)
;
return
{
atRules
}
{
selectors
}
{
ruleIndex
}
;
}
function
getSourceForDisplay
(
source
)
{
let
href
;
switch
(
source
.
type
)
{
case
"
element
"
:
href
=
getStr
(
"
changes
.
elementStyleLabel
"
)
;
break
;
case
"
inline
"
:
href
=
getFormatStr
(
"
changes
.
inlineStyleSheetLabel
"
#
{
source
.
index
}
)
;
break
;
case
"
stylesheet
"
:
const
url
=
new
URL
(
source
.
href
)
;
href
=
url
.
pathname
.
substring
(
url
.
pathname
.
lastIndexOf
(
"
/
"
)
+
1
)
;
break
;
}
return
href
;
}
module
.
exports
.
getSourceForDisplay
=
getSourceForDisplay
;
module
.
exports
.
getSourceHash
=
getSourceHash
;
module
.
exports
.
getRuleHash
=
getRuleHash
;
