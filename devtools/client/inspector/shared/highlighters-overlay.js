"
use
strict
"
;
const
Services
=
require
(
"
Services
"
)
;
const
EventEmitter
=
require
(
"
devtools
/
shared
/
old
-
event
-
emitter
"
)
;
const
{
VIEW_NODE_VALUE_TYPE
VIEW_NODE_SHAPE_POINT_TYPE
}
=
require
(
"
devtools
/
client
/
inspector
/
shared
/
node
-
types
"
)
;
const
DEFAULT_GRID_COLOR
=
"
#
4B0082
"
;
const
INSET_POINT_TYPES
=
[
"
top
"
"
right
"
"
bottom
"
"
left
"
]
;
class
HighlightersOverlay
{
constructor
(
inspector
)
{
this
.
inspector
=
inspector
;
this
.
highlighters
=
{
}
;
this
.
highlighterUtils
=
this
.
inspector
.
toolbox
.
highlighterUtils
;
this
.
supportsHighlighters
=
this
.
highlighterUtils
.
supportsCustomHighlighters
(
)
;
this
.
flexboxHighlighterShown
=
null
;
this
.
geometryEditorHighlighterShown
=
null
;
this
.
gridHighlighterShown
=
null
;
this
.
hoveredHighlighterShown
=
null
;
this
.
selectorHighlighterShown
=
null
;
this
.
shapesHighlighterShown
=
null
;
this
.
state
=
{
flexbox
:
{
}
grid
:
{
}
shapes
:
{
}
}
;
this
.
onClick
=
this
.
onClick
.
bind
(
this
)
;
this
.
onMarkupMutation
=
this
.
onMarkupMutation
.
bind
(
this
)
;
this
.
onMouseMove
=
this
.
onMouseMove
.
bind
(
this
)
;
this
.
onMouseOut
=
this
.
onMouseOut
.
bind
(
this
)
;
this
.
onWillNavigate
=
this
.
onWillNavigate
.
bind
(
this
)
;
this
.
hideFlexboxHighlighter
=
this
.
hideFlexboxHighlighter
.
bind
(
this
)
;
this
.
hideGridHighlighter
=
this
.
hideGridHighlighter
.
bind
(
this
)
;
this
.
hideShapesHighlighter
=
this
.
hideShapesHighlighter
.
bind
(
this
)
;
this
.
showFlexboxHighlighter
=
this
.
showFlexboxHighlighter
.
bind
(
this
)
;
this
.
showGridHighlighter
=
this
.
showGridHighlighter
.
bind
(
this
)
;
this
.
showShapesHighlighter
=
this
.
showShapesHighlighter
.
bind
(
this
)
;
this
.
_handleRejection
=
this
.
_handleRejection
.
bind
(
this
)
;
this
.
_onHighlighterEvent
=
this
.
_onHighlighterEvent
.
bind
(
this
)
;
this
.
inspector
.
on
(
"
markupmutation
"
this
.
onMarkupMutation
)
;
this
.
inspector
.
target
.
on
(
"
will
-
navigate
"
this
.
onWillNavigate
)
;
EventEmitter
.
decorate
(
this
)
;
}
isRuleView
(
node
)
{
return
!
!
node
.
closest
(
"
#
ruleview
-
panel
"
)
;
}
addToView
(
view
)
{
if
(
!
this
.
supportsHighlighters
)
{
return
;
}
let
el
=
view
.
element
;
el
.
addEventListener
(
"
click
"
this
.
onClick
true
)
;
el
.
addEventListener
(
"
mousemove
"
this
.
onMouseMove
)
;
el
.
addEventListener
(
"
mouseout
"
this
.
onMouseOut
)
;
el
.
ownerDocument
.
defaultView
.
addEventListener
(
"
mouseout
"
this
.
onMouseOut
)
;
}
removeFromView
(
view
)
{
if
(
!
this
.
supportsHighlighters
)
{
return
;
}
let
el
=
view
.
element
;
el
.
removeEventListener
(
"
click
"
this
.
onClick
true
)
;
el
.
removeEventListener
(
"
mousemove
"
this
.
onMouseMove
)
;
el
.
removeEventListener
(
"
mouseout
"
this
.
onMouseOut
)
;
}
async
toggleShapesHighlighter
(
node
options
=
{
}
)
{
options
.
transformMode
=
options
.
ctrlOrMetaPressed
;
if
(
node
=
=
this
.
shapesHighlighterShown
&
&
options
.
mode
=
=
=
this
.
state
.
shapes
.
options
.
mode
)
{
if
(
!
options
.
ctrlOrMetaPressed
)
{
await
this
.
hideShapesHighlighter
(
node
)
;
return
;
}
options
.
transformMode
=
!
this
.
state
.
shapes
.
options
.
transformMode
;
}
await
this
.
showShapesHighlighter
(
node
options
)
;
}
async
showShapesHighlighter
(
node
options
)
{
let
highlighter
=
await
this
.
_getHighlighter
(
"
ShapesHighlighter
"
)
;
if
(
!
highlighter
)
{
return
;
}
let
isShown
=
await
highlighter
.
show
(
node
options
)
;
if
(
!
isShown
)
{
return
;
}
this
.
shapesHighlighterShown
=
node
;
let
{
mode
}
=
options
;
this
.
_toggleRuleViewIcon
(
node
false
"
.
ruleview
-
shapeswatch
"
)
;
this
.
_toggleRuleViewIcon
(
node
true
.
ruleview
-
shapeswatch
[
data
-
mode
=
'
{
mode
}
'
]
)
;
try
{
let
{
url
}
=
this
.
inspector
.
target
;
let
selector
=
await
node
.
getUniqueSelector
(
)
;
this
.
state
.
shapes
=
{
selector
options
url
}
;
this
.
shapesHighlighterShown
=
node
;
this
.
emit
(
"
shapes
-
highlighter
-
shown
"
node
options
)
;
}
catch
(
e
)
{
this
.
_handleRejection
(
e
)
;
}
}
async
hideShapesHighlighter
(
node
)
{
if
(
!
this
.
shapesHighlighterShown
|
|
!
this
.
highlighters
.
ShapesHighlighter
)
{
return
;
}
this
.
_toggleRuleViewIcon
(
node
false
"
.
ruleview
-
shapeswatch
"
)
;
await
this
.
highlighters
.
ShapesHighlighter
.
hide
(
)
;
this
.
emit
(
"
shapes
-
highlighter
-
hidden
"
this
.
shapesHighlighterShown
this
.
state
.
shapes
.
options
)
;
this
.
shapesHighlighterShown
=
null
;
this
.
state
.
shapes
=
{
}
;
}
async
hoverPointShapesHighlighter
(
node
point
)
{
if
(
node
=
=
this
.
shapesHighlighterShown
)
{
let
options
=
Object
.
assign
(
{
}
this
.
state
.
shapes
.
options
)
;
options
.
hoverPoint
=
point
;
await
this
.
showShapesHighlighter
(
node
options
)
;
}
}
highlightRuleViewShapePoint
(
point
)
{
let
view
=
this
.
inspector
.
getPanel
(
"
ruleview
"
)
.
view
;
let
ruleViewEl
=
view
.
element
;
let
selector
=
.
ruleview
-
shape
-
point
.
active
;
for
(
let
pointNode
of
ruleViewEl
.
querySelectorAll
(
selector
)
)
{
this
.
_toggleShapePointActive
(
pointNode
false
)
;
}
if
(
point
!
=
=
null
&
&
point
!
=
=
undefined
)
{
selector
=
(
INSET_POINT_TYPES
.
includes
(
point
)
)
?
.
ruleview
-
shape
-
point
.
{
point
}
:
.
ruleview
-
shape
-
point
[
data
-
point
=
'
{
point
}
'
]
;
for
(
let
pointNode
of
ruleViewEl
.
querySelectorAll
(
selector
)
)
{
let
nodeInfo
=
view
.
getNodeInfo
(
pointNode
)
;
if
(
this
.
isRuleViewShapePoint
(
nodeInfo
)
)
{
this
.
_toggleShapePointActive
(
pointNode
true
)
;
}
}
}
}
async
toggleFlexboxHighlighter
(
node
options
=
{
}
)
{
if
(
node
=
=
this
.
flexboxHighlighterShown
)
{
await
this
.
hideFlexboxHighlighter
(
node
)
;
return
;
}
await
this
.
showFlexboxHighlighter
(
node
options
)
;
}
async
showFlexboxHighlighter
(
node
options
)
{
let
highlighter
=
await
this
.
_getHighlighter
(
"
FlexboxHighlighter
"
)
;
if
(
!
highlighter
)
{
return
;
}
let
isShown
=
await
highlighter
.
show
(
node
options
)
;
if
(
!
isShown
)
{
return
;
}
this
.
_toggleRuleViewIcon
(
node
true
"
.
ruleview
-
flex
"
)
;
try
{
let
{
url
}
=
this
.
inspector
.
target
;
let
selector
=
await
node
.
getUniqueSelector
(
)
;
this
.
state
.
flexbox
=
{
selector
options
url
}
;
this
.
flexboxHighlighterShown
=
node
;
this
.
emit
(
"
flexbox
-
highlighter
-
shown
"
node
options
)
;
}
catch
(
e
)
{
this
.
_handleRejection
(
e
)
;
}
}
async
hideFlexboxHighlighter
(
node
)
{
if
(
!
this
.
flexboxHighlighterShown
|
|
!
this
.
highlighters
.
FlexboxHighlighter
)
{
return
;
}
this
.
_toggleRuleViewIcon
(
node
false
"
.
ruleview
-
flex
"
)
;
await
this
.
highlighters
.
FlexboxHighlighter
.
hide
(
)
;
this
.
emit
(
"
flexbox
-
highlighter
-
hidden
"
this
.
flexboxHighlighterShown
)
;
this
.
flexboxHighlighterShown
=
null
;
this
.
state
.
flexbox
=
null
;
}
async
toggleGridHighlighter
(
node
options
=
{
}
trigger
)
{
if
(
node
=
=
this
.
gridHighlighterShown
)
{
await
this
.
hideGridHighlighter
(
node
)
;
return
;
}
await
this
.
showGridHighlighter
(
node
options
trigger
)
;
}
async
showGridHighlighter
(
node
options
trigger
)
{
let
highlighter
=
await
this
.
_getHighlighter
(
"
CssGridHighlighter
"
)
;
if
(
!
highlighter
)
{
return
;
}
let
isShown
=
await
highlighter
.
show
(
node
options
)
;
if
(
!
isShown
)
{
return
;
}
this
.
_toggleRuleViewIcon
(
node
true
"
.
ruleview
-
grid
"
)
;
if
(
trigger
=
=
"
grid
"
)
{
Services
.
telemetry
.
scalarAdd
(
"
devtools
.
grid
.
gridinspector
.
opened
"
1
)
;
}
else
if
(
trigger
=
=
"
rule
"
)
{
Services
.
telemetry
.
scalarAdd
(
"
devtools
.
rules
.
gridinspector
.
opened
"
1
)
;
}
try
{
let
{
url
}
=
this
.
inspector
.
target
;
let
selector
=
await
node
.
getUniqueSelector
(
)
;
this
.
state
.
grid
=
{
selector
options
url
}
;
this
.
gridHighlighterShown
=
node
;
this
.
emit
(
"
grid
-
highlighter
-
shown
"
node
options
)
;
}
catch
(
e
)
{
this
.
_handleRejection
(
e
)
;
}
}
async
hideGridHighlighter
(
node
)
{
if
(
!
this
.
gridHighlighterShown
|
|
!
this
.
highlighters
.
CssGridHighlighter
)
{
return
;
}
this
.
_toggleRuleViewIcon
(
node
false
"
.
ruleview
-
grid
"
)
;
await
this
.
highlighters
.
CssGridHighlighter
.
hide
(
)
;
this
.
emit
(
"
grid
-
highlighter
-
hidden
"
this
.
gridHighlighterShown
this
.
state
.
grid
.
options
)
;
this
.
gridHighlighterShown
=
null
;
this
.
state
.
grid
=
{
}
;
}
async
toggleGeometryHighlighter
(
node
)
{
if
(
node
=
=
this
.
geometryEditorHighlighterShown
)
{
await
this
.
hideGeometryEditor
(
)
;
return
;
}
await
this
.
showGeometryEditor
(
node
)
;
}
async
showGeometryEditor
(
node
)
{
let
highlighter
=
await
this
.
_getHighlighter
(
"
GeometryEditorHighlighter
"
)
;
if
(
!
highlighter
)
{
return
;
}
let
isShown
=
await
highlighter
.
show
(
node
)
;
if
(
!
isShown
)
{
return
;
}
this
.
emit
(
"
geometry
-
editor
-
highlighter
-
shown
"
)
;
this
.
geometryEditorHighlighterShown
=
node
;
}
async
hideGeometryEditor
(
)
{
if
(
!
this
.
geometryEditorHighlighterShown
|
|
!
this
.
highlighters
.
GeometryEditorHighlighter
)
{
return
;
}
await
this
.
highlighters
.
GeometryEditorHighlighter
.
hide
(
)
;
this
.
emit
(
"
geometry
-
editor
-
highlighter
-
hidden
"
)
;
this
.
geometryEditorHighlighterShown
=
null
;
}
_onHighlighterEvent
(
data
)
{
if
(
data
.
type
=
=
=
"
shape
-
hover
-
on
"
)
{
this
.
state
.
shapes
.
hoverPoint
=
data
.
point
;
this
.
emit
(
"
hover
-
shape
-
point
"
data
.
point
)
;
}
else
if
(
data
.
type
=
=
=
"
shape
-
hover
-
off
"
)
{
this
.
state
.
shapes
.
hoverPoint
=
null
;
this
.
emit
(
"
hover
-
shape
-
point
"
null
)
;
}
this
.
emit
(
"
highlighter
-
event
-
handled
"
)
;
}
async
restoreFlexboxState
(
)
{
try
{
await
this
.
restoreState
(
"
flexbox
"
this
.
state
.
flexbox
this
.
showFlexboxHighlighter
)
;
}
catch
(
e
)
{
this
.
_handleRejection
(
e
)
;
}
}
async
restoreGridState
(
)
{
try
{
await
this
.
restoreState
(
"
grid
"
this
.
state
.
grid
this
.
showGridHighlighter
)
;
}
catch
(
e
)
{
this
.
_handleRejection
(
e
)
;
}
}
async
restoreShapeState
(
)
{
try
{
await
this
.
restoreState
(
"
shapes
"
this
.
state
.
shapes
this
.
showShapesHighlighter
)
;
}
catch
(
e
)
{
this
.
_handleRejection
(
e
)
;
}
}
async
restoreState
(
name
state
showFunction
)
{
let
{
selector
options
url
}
=
state
;
if
(
!
selector
|
|
url
!
=
=
this
.
inspector
.
target
.
url
)
{
this
.
emit
(
{
name
}
-
state
-
restored
{
restored
:
false
}
)
;
return
;
}
let
walker
=
this
.
inspector
.
walker
;
let
rootNode
=
await
walker
.
getRootNode
(
)
;
let
nodeFront
=
await
walker
.
querySelector
(
rootNode
selector
)
;
if
(
nodeFront
)
{
if
(
options
.
hoverPoint
)
{
options
.
hoverPoint
=
null
;
}
await
showFunction
(
nodeFront
options
)
;
this
.
emit
(
{
name
}
-
state
-
restored
{
restored
:
true
}
)
;
}
this
.
emit
(
{
name
}
-
state
-
restored
{
restored
:
false
}
)
;
}
async
_getHighlighter
(
type
)
{
let
utils
=
this
.
highlighterUtils
;
if
(
this
.
highlighters
[
type
]
)
{
return
this
.
highlighters
[
type
]
;
}
let
highlighter
;
try
{
highlighter
=
await
utils
.
getHighlighterByType
(
type
)
;
}
catch
(
e
)
{
}
if
(
!
highlighter
)
{
return
null
;
}
highlighter
.
on
(
"
highlighter
-
event
"
this
.
_onHighlighterEvent
)
;
this
.
highlighters
[
type
]
=
highlighter
;
return
highlighter
;
}
_handleRejection
(
error
)
{
if
(
!
this
.
destroyed
)
{
console
.
error
(
error
)
;
}
}
_toggleRuleViewIcon
(
node
active
selector
)
{
if
(
this
.
inspector
.
selection
.
nodeFront
!
=
node
)
{
return
;
}
let
ruleViewEl
=
this
.
inspector
.
getPanel
(
"
ruleview
"
)
.
view
.
element
;
for
(
let
icon
of
ruleViewEl
.
querySelectorAll
(
selector
)
)
{
icon
.
classList
.
toggle
(
"
active
"
active
)
;
}
}
_toggleShapePointActive
(
node
active
)
{
if
(
this
.
inspector
.
selection
.
nodeFront
!
=
this
.
shapesHighlighterShown
)
{
return
;
}
node
.
classList
.
toggle
(
"
active
"
active
)
;
}
_hideHoveredHighlighter
(
)
{
if
(
!
this
.
hoveredHighlighterShown
|
|
!
this
.
highlighters
[
this
.
hoveredHighlighterShown
]
)
{
return
;
}
let
onHidden
=
this
.
highlighters
[
this
.
hoveredHighlighterShown
]
.
hide
(
)
;
if
(
onHidden
)
{
onHidden
.
catch
(
console
.
error
)
;
}
this
.
hoveredHighlighterShown
=
null
;
this
.
emit
(
"
highlighter
-
hidden
"
)
;
}
async
_hideHighlighterIfDeadNode
(
node
hideHighlighter
)
{
if
(
!
node
)
{
return
;
}
try
{
let
isInTree
=
await
this
.
inspector
.
walker
.
isInDOMTree
(
node
)
;
if
(
!
isInTree
)
{
hideHighlighter
(
node
)
;
}
}
catch
(
e
)
{
console
.
error
(
e
)
;
}
}
_isComputedViewTransform
(
nodeInfo
)
{
if
(
nodeInfo
.
view
!
=
"
computed
"
)
{
return
false
;
}
return
nodeInfo
.
type
=
=
=
VIEW_NODE_VALUE_TYPE
&
&
nodeInfo
.
value
.
property
=
=
=
"
transform
"
;
}
_isRuleViewDisplayFlex
(
node
)
{
return
this
.
isRuleView
(
node
)
&
&
node
.
classList
.
contains
(
"
ruleview
-
flex
"
)
;
}
_isRuleViewDisplayGrid
(
node
)
{
return
this
.
isRuleView
(
node
)
&
&
node
.
classList
.
contains
(
"
ruleview
-
grid
"
)
;
}
_isRuleViewShape
(
node
)
{
return
this
.
isRuleView
(
node
)
&
&
node
.
classList
.
contains
(
"
ruleview
-
shapeswatch
"
)
;
}
_isRuleViewTransform
(
nodeInfo
)
{
if
(
nodeInfo
.
view
!
=
"
rule
"
)
{
return
false
;
}
let
isTransform
=
nodeInfo
.
type
=
=
=
VIEW_NODE_VALUE_TYPE
&
&
nodeInfo
.
value
.
property
=
=
=
"
transform
"
;
let
isEnabled
=
nodeInfo
.
value
.
enabled
&
&
!
nodeInfo
.
value
.
overridden
&
&
!
nodeInfo
.
value
.
pseudoElement
;
return
isTransform
&
&
isEnabled
;
}
isRuleViewShapePoint
(
nodeInfo
)
{
if
(
nodeInfo
.
view
!
=
"
rule
"
)
{
return
false
;
}
let
isShape
=
nodeInfo
.
type
=
=
=
VIEW_NODE_SHAPE_POINT_TYPE
&
&
(
nodeInfo
.
value
.
property
=
=
=
"
clip
-
path
"
|
|
nodeInfo
.
value
.
property
=
=
=
"
shape
-
outside
"
)
;
let
isEnabled
=
nodeInfo
.
value
.
enabled
&
&
!
nodeInfo
.
value
.
overridden
&
&
!
nodeInfo
.
value
.
pseudoElement
;
return
isShape
&
&
isEnabled
&
&
nodeInfo
.
value
.
toggleActive
&
&
!
this
.
state
.
shapes
.
options
.
transformMode
;
}
onClick
(
event
)
{
if
(
this
.
_isRuleViewDisplayGrid
(
event
.
target
)
)
{
event
.
stopPropagation
(
)
;
let
{
store
}
=
this
.
inspector
;
let
{
grids
highlighterSettings
}
=
store
.
getState
(
)
;
let
grid
=
grids
.
find
(
g
=
>
g
.
nodeFront
=
=
this
.
inspector
.
selection
.
nodeFront
)
;
highlighterSettings
.
color
=
grid
?
grid
.
color
:
DEFAULT_GRID_COLOR
;
this
.
toggleGridHighlighter
(
this
.
inspector
.
selection
.
nodeFront
highlighterSettings
"
rule
"
)
;
}
else
if
(
this
.
_isRuleViewDisplayFlex
(
event
.
target
)
)
{
event
.
stopPropagation
(
)
;
this
.
toggleFlexboxHighlighter
(
this
.
inspector
.
selection
.
nodeFront
)
;
}
else
if
(
this
.
_isRuleViewShape
(
event
.
target
)
)
{
event
.
stopPropagation
(
)
;
let
settings
=
{
mode
:
event
.
target
.
dataset
.
mode
ctrlOrMetaPressed
:
event
.
metaKey
|
|
event
.
ctrlKey
}
;
this
.
toggleShapesHighlighter
(
this
.
inspector
.
selection
.
nodeFront
settings
)
;
}
}
onMouseMove
(
event
)
{
if
(
event
.
target
=
=
=
this
.
_lastHovered
)
{
return
;
}
this
.
_hideHoveredHighlighter
(
)
;
this
.
_lastHovered
=
event
.
target
;
let
view
=
this
.
isRuleView
(
this
.
_lastHovered
)
?
this
.
inspector
.
getPanel
(
"
ruleview
"
)
.
view
:
this
.
inspector
.
getPanel
(
"
computedview
"
)
.
computedView
;
let
nodeInfo
=
view
.
getNodeInfo
(
event
.
target
)
;
if
(
!
nodeInfo
)
{
return
;
}
if
(
this
.
isRuleViewShapePoint
(
nodeInfo
)
)
{
let
{
point
}
=
nodeInfo
.
value
;
this
.
hoverPointShapesHighlighter
(
this
.
inspector
.
selection
.
nodeFront
point
)
;
this
.
emit
(
"
hover
-
shape
-
point
"
point
)
;
return
;
}
let
type
;
if
(
this
.
_isRuleViewTransform
(
nodeInfo
)
|
|
this
.
_isComputedViewTransform
(
nodeInfo
)
)
{
type
=
"
CssTransformHighlighter
"
;
}
if
(
type
)
{
this
.
hoveredHighlighterShown
=
type
;
let
node
=
this
.
inspector
.
selection
.
nodeFront
;
this
.
_getHighlighter
(
type
)
.
then
(
highlighter
=
>
highlighter
.
show
(
node
)
)
.
then
(
shown
=
>
{
if
(
shown
)
{
this
.
emit
(
"
highlighter
-
shown
"
)
;
}
}
)
;
}
}
onMouseOut
(
event
)
{
if
(
!
this
.
_lastHovered
|
|
(
event
&
&
this
.
_lastHovered
.
contains
(
event
.
relatedTarget
)
)
)
{
return
;
}
let
view
=
this
.
isRuleView
(
this
.
_lastHovered
)
?
this
.
inspector
.
getPanel
(
"
ruleview
"
)
.
view
:
this
.
inspector
.
getPanel
(
"
computedview
"
)
.
computedView
;
let
nodeInfo
=
view
.
getNodeInfo
(
this
.
_lastHovered
)
;
if
(
nodeInfo
&
&
this
.
isRuleViewShapePoint
(
nodeInfo
)
)
{
this
.
hoverPointShapesHighlighter
(
this
.
inspector
.
selection
.
nodeFront
null
)
;
this
.
emit
(
"
hover
-
shape
-
point
"
null
)
;
}
this
.
_lastHovered
=
null
;
this
.
_hideHoveredHighlighter
(
)
;
}
async
onMarkupMutation
(
evt
mutations
)
{
let
hasInterestingMutation
=
mutations
.
some
(
mut
=
>
mut
.
type
=
=
=
"
childList
"
)
;
if
(
!
hasInterestingMutation
)
{
return
;
}
this
.
_hideHighlighterIfDeadNode
(
this
.
flexboxHighlighterShown
this
.
hideFlexboxHighlighter
)
;
this
.
_hideHighlighterIfDeadNode
(
this
.
gridHighlighterShown
this
.
hideGridHighlighter
)
;
this
.
_hideHighlighterIfDeadNode
(
this
.
shapesHighlighterShown
this
.
hideShapesHighlighter
)
;
}
onWillNavigate
(
)
{
this
.
flexboxHighlighterShown
=
null
;
this
.
geometryEditorHighlighterShown
=
null
;
this
.
gridHighlighterShown
=
null
;
this
.
hoveredHighlighterShown
=
null
;
this
.
selectorHighlighterShown
=
null
;
this
.
shapesHighlighterShown
=
null
;
}
destroy
(
)
{
for
(
let
type
in
this
.
highlighters
)
{
if
(
this
.
highlighters
[
type
]
)
{
if
(
this
.
highlighters
[
type
]
.
off
)
{
this
.
highlighters
[
type
]
.
off
(
"
highlighter
-
event
"
this
.
_onHighlighterEvent
)
;
}
this
.
highlighters
[
type
]
.
finalize
(
)
;
this
.
highlighters
[
type
]
=
null
;
}
}
this
.
inspector
.
off
(
"
markupmutation
"
this
.
onMarkupMutation
)
;
this
.
inspector
.
target
.
off
(
"
will
-
navigate
"
this
.
onWillNavigate
)
;
this
.
_lastHovered
=
null
;
this
.
inspector
=
null
;
this
.
highlighters
=
null
;
this
.
highlighterUtils
=
null
;
this
.
supportsHighlighters
=
null
;
this
.
state
=
null
;
this
.
flexboxHighlighterShown
=
null
;
this
.
geometryEditorHighlighterShown
=
null
;
this
.
gridHighlighterShown
=
null
;
this
.
hoveredHighlighterShown
=
null
;
this
.
selectorHighlighterShown
=
null
;
this
.
shapesHighlighterShown
=
null
;
this
.
destroyed
=
true
;
}
}
module
.
exports
=
HighlightersOverlay
;
