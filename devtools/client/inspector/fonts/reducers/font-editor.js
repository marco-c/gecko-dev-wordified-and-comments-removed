"
use
strict
"
;
const
{
getStr
}
=
require
(
"
.
.
/
utils
/
l10n
"
)
;
const
{
APPLY_FONT_VARIATION_INSTANCE
RESET_EDITOR
UPDATE_AXIS_VALUE
UPDATE_CUSTOM_INSTANCE
UPDATE_EDITOR_STATE
UPDATE_EDITOR_VISIBILITY
}
=
require
(
"
.
.
/
actions
/
index
"
)
;
const
INITIAL_STATE
=
{
axes
:
{
}
customInstanceValues
:
[
]
fonts
:
[
]
instance
:
{
name
:
getStr
(
"
fontinspector
.
customInstanceName
"
)
values
:
[
]
}
isVisible
:
false
properties
:
{
}
selector
:
"
"
}
;
let
reducers
=
{
[
APPLY_FONT_VARIATION_INSTANCE
]
(
state
{
name
values
}
)
{
let
newState
=
{
.
.
.
state
}
;
newState
.
instance
.
name
=
name
;
newState
.
instance
.
values
=
values
;
if
(
Array
.
isArray
(
values
)
&
&
values
.
length
)
{
newState
.
axes
=
values
.
reduce
(
(
acc
value
)
=
>
{
acc
[
value
.
axis
]
=
value
.
value
;
return
acc
;
}
{
}
)
;
}
return
newState
;
}
[
RESET_EDITOR
]
(
state
)
{
return
{
.
.
.
INITIAL_STATE
}
;
}
[
UPDATE_AXIS_VALUE
]
(
state
{
axis
value
}
)
{
let
newState
=
{
.
.
.
state
}
;
newState
.
axes
[
axis
]
=
value
;
return
newState
;
}
[
UPDATE_CUSTOM_INSTANCE
]
(
state
)
{
const
newState
=
{
.
.
.
state
}
;
newState
.
customInstanceValues
=
Object
.
keys
(
state
.
axes
)
.
map
(
axis
=
>
{
return
{
axis
:
[
axis
]
value
:
state
.
axes
[
axis
]
}
;
}
)
;
return
newState
;
}
[
UPDATE_EDITOR_STATE
]
(
state
{
fonts
properties
}
)
{
let
axes
=
{
}
;
if
(
properties
[
"
font
-
variation
-
settings
"
]
)
{
axes
=
properties
[
"
font
-
variation
-
settings
"
]
.
split
(
"
"
)
.
reduce
(
(
acc
pair
)
=
>
{
pair
=
pair
.
split
(
/
[
"
'
]
/
)
.
filter
(
part
=
>
part
.
trim
(
)
!
=
=
"
"
)
;
const
tag
=
pair
[
0
]
.
trim
(
)
;
const
value
=
pair
[
1
]
.
trim
(
)
;
acc
[
tag
]
=
value
;
return
acc
;
}
{
}
)
;
}
return
{
.
.
.
state
axes
fonts
properties
}
;
}
[
UPDATE_EDITOR_VISIBILITY
]
(
state
{
isVisible
selector
}
)
{
return
{
.
.
.
state
isVisible
selector
}
;
}
}
;
module
.
exports
=
function
(
state
=
INITIAL_STATE
action
)
{
let
reducer
=
reducers
[
action
.
type
]
;
if
(
!
reducer
)
{
return
state
;
}
return
reducer
(
state
action
)
;
}
;
