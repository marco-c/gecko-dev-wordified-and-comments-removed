"
use
strict
"
;
const
{
appendAndWaitForPaint
}
=
require
(
"
devtools
/
client
/
performance
/
test
/
helpers
/
dom
-
utils
"
)
;
const
{
synthesizeCustomTreeClass
}
=
require
(
"
devtools
/
client
/
performance
/
test
/
helpers
/
synth
-
utils
"
)
;
const
{
once
}
=
require
(
"
devtools
/
client
/
performance
/
test
/
helpers
/
event
-
utils
"
)
;
add_task
(
async
function
(
)
{
let
{
MyCustomTreeItem
myDataSrc
}
=
synthesizeCustomTreeClass
(
)
;
let
container
=
document
.
createElement
(
"
vbox
"
)
;
await
appendAndWaitForPaint
(
gBrowser
.
selectedBrowser
.
parentNode
container
)
;
let
treeRoot
=
new
MyCustomTreeItem
(
myDataSrc
{
parent
:
null
}
)
;
treeRoot
.
attachTo
(
container
)
;
let
originalTreeRootExpandedState
=
treeRoot
.
expanded
;
info
(
"
Double
clicking
on
the
root
item
arrow
and
waiting
for
focus
event
.
"
)
;
let
receivedFocusEvent
=
once
(
treeRoot
"
focus
"
)
;
dblclick
(
treeRoot
.
target
.
querySelector
(
"
.
arrow
"
)
)
;
await
receivedFocusEvent
;
is
(
treeRoot
.
expanded
originalTreeRootExpandedState
"
A
double
click
on
the
arrow
was
ignored
.
"
)
;
container
.
remove
(
)
;
}
)
;
