"
use
strict
"
;
const
{
SIMPLE_URL
}
=
require
(
"
devtools
/
client
/
performance
/
test
/
helpers
/
urls
"
)
;
const
{
initPerformanceInNewTab
teardownToolboxAndRemoveTab
}
=
require
(
"
devtools
/
client
/
performance
/
test
/
helpers
/
panel
-
utils
"
)
;
const
{
startRecording
stopRecording
}
=
require
(
"
devtools
/
client
/
performance
/
test
/
helpers
/
actions
"
)
;
const
{
once
}
=
require
(
"
devtools
/
client
/
performance
/
test
/
helpers
/
event
-
utils
"
)
;
add_task
(
function
*
(
)
{
let
{
panel
}
=
yield
initPerformanceInNewTab
(
{
url
:
SIMPLE_URL
win
:
window
}
)
;
let
{
EVENTS
PerformanceController
RecordingsView
}
=
panel
.
panelWin
;
yield
startRecording
(
panel
)
;
yield
stopRecording
(
panel
)
;
yield
startRecording
(
panel
)
;
info
(
"
Selecting
recording
#
0
and
waiting
for
it
to
be
displayed
.
"
)
;
let
selected
=
once
(
PerformanceController
EVENTS
.
RECORDING_SELECTED
)
;
RecordingsView
.
selectedIndex
=
0
;
yield
selected
;
ok
(
(
"
#
main
-
record
-
button
"
)
.
classList
.
contains
(
"
checked
"
)
"
Button
is
still
checked
after
selecting
another
item
.
"
)
;
ok
(
!
(
"
#
main
-
record
-
button
"
)
.
hasAttribute
(
"
disabled
"
)
"
Button
is
not
locked
after
selecting
another
item
.
"
)
;
yield
stopRecording
(
panel
)
;
yield
teardownToolboxAndRemoveTab
(
panel
)
;
}
)
;
