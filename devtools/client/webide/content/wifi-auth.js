"
use
strict
"
;
const
{
require
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
devtools
/
shared
/
Loader
.
jsm
"
)
;
const
QR
=
require
(
"
devtools
/
shared
/
qrcode
/
index
"
)
;
window
.
addEventListener
(
"
load
"
function
(
)
{
document
.
getElementById
(
"
close
"
)
.
onclick
=
(
)
=
>
window
.
close
(
)
;
document
.
getElementById
(
"
no
-
scanner
"
)
.
onclick
=
showToken
;
document
.
getElementById
(
"
yes
-
scanner
"
)
.
onclick
=
hideToken
;
buildUI
(
)
;
}
{
once
:
true
}
)
;
function
buildUI
(
)
{
const
{
oob
}
=
window
.
arguments
[
0
]
;
createQR
(
oob
)
;
createToken
(
oob
)
;
}
function
createQR
(
oob
)
{
const
oobData
=
JSON
.
stringify
(
oob
)
;
const
imgData
=
QR
.
encodeToDataURI
(
oobData
"
L
"
)
;
document
.
querySelector
(
"
#
qr
-
code
img
"
)
.
src
=
imgData
.
src
;
}
function
createToken
(
oob
)
{
const
token
=
oob
.
sha256
.
replace
(
/
:
/
g
"
"
)
.
toLowerCase
(
)
+
oob
.
k
;
document
.
querySelector
(
"
#
token
pre
"
)
.
textContent
=
token
;
}
function
showToken
(
)
{
document
.
querySelector
(
"
body
"
)
.
setAttribute
(
"
token
"
"
true
"
)
;
}
function
hideToken
(
)
{
document
.
querySelector
(
"
body
"
)
.
removeAttribute
(
"
token
"
)
;
}
