"
use
strict
"
;
const
storeItems
=
[
[
[
"
indexedDB
"
"
http
:
/
/
test1
.
example
.
org
"
]
[
"
idb1
(
default
)
"
"
idb2
(
default
)
"
]
]
[
[
"
indexedDB
"
"
http
:
/
/
test1
.
example
.
org
"
"
idb1
(
default
)
"
]
[
"
obj1
"
"
obj2
"
]
]
[
[
"
indexedDB
"
"
http
:
/
/
test1
.
example
.
org
"
"
idb2
(
default
)
"
]
[
]
]
[
[
"
indexedDB
"
"
http
:
/
/
test1
.
example
.
org
"
"
idb1
(
default
)
"
"
obj1
"
]
[
1
2
3
]
]
[
[
"
indexedDB
"
"
http
:
/
/
test1
.
example
.
org
"
"
idb1
(
default
)
"
"
obj2
"
]
[
1
]
]
]
;
function
testTree
(
)
{
let
doc
=
gPanelWindow
.
document
;
for
(
let
[
item
]
of
storeItems
)
{
ok
(
doc
.
querySelector
(
[
data
-
id
=
'
{
JSON
.
stringify
(
item
)
}
'
]
)
Tree
item
{
item
}
should
be
present
in
the
storage
tree
)
;
}
}
let
testTables
=
async
function
(
)
{
let
doc
=
gPanelWindow
.
document
;
gUI
.
tree
.
expandAll
(
)
;
for
(
let
[
item
ids
]
of
storeItems
)
{
await
selectTreeItem
(
item
)
;
is
(
doc
.
querySelectorAll
(
"
.
table
-
widget
-
wrapper
:
first
-
of
-
type
.
table
-
widget
-
cell
"
)
.
length
ids
.
length
"
Number
of
items
in
table
is
correct
"
)
;
for
(
let
id
of
ids
)
{
ok
(
doc
.
querySelector
(
"
.
table
-
widget
-
cell
[
data
-
id
=
'
"
+
id
+
"
'
]
"
)
Table
item
{
id
}
should
be
present
)
;
}
}
}
;
add_task
(
async
function
(
)
{
await
openTabAndSetupStorage
(
MAIN_DOMAIN
+
"
storage
-
empty
-
objectstores
.
html
"
)
;
testTree
(
)
;
await
testTables
(
)
;
await
finishTests
(
)
;
}
)
;
