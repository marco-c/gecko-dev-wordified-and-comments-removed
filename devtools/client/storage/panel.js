"
use
strict
"
;
const
EventEmitter
=
require
(
"
devtools
/
shared
/
event
-
emitter
"
)
;
loader
.
lazyRequireGetter
(
this
"
StorageUI
"
"
devtools
/
client
/
storage
/
ui
"
true
)
;
class
StoragePanel
{
constructor
(
panelWin
toolbox
)
{
EventEmitter
.
decorate
(
this
)
;
this
.
_toolbox
=
toolbox
;
this
.
_target
=
toolbox
.
target
;
this
.
_panelWin
=
panelWin
;
this
.
destroy
=
this
.
destroy
.
bind
(
this
)
;
}
get
target
(
)
{
return
this
.
_toolbox
.
target
;
}
get
panelWindow
(
)
{
return
this
.
_panelWin
;
}
async
open
(
)
{
this
.
target
.
on
(
"
close
"
this
.
destroy
)
;
this
.
_front
=
await
this
.
target
.
getFront
(
"
storage
"
)
;
this
.
UI
=
new
StorageUI
(
this
.
_front
this
.
_target
this
.
_panelWin
this
.
_toolbox
)
;
this
.
isReady
=
true
;
this
.
emit
(
"
ready
"
)
;
return
this
;
}
destroy
(
)
{
if
(
this
.
_destroyed
)
{
return
;
}
this
.
_destroyed
=
true
;
this
.
UI
.
destroy
(
)
;
this
.
UI
=
null
;
this
.
_front
.
destroy
(
)
;
this
.
_front
=
null
;
this
.
_target
.
off
(
"
close
"
this
.
destroy
)
;
this
.
_target
=
null
;
this
.
_toolbox
=
null
;
this
.
_panelWin
=
null
;
}
}
exports
.
StoragePanel
=
StoragePanel
;
