"
use
strict
"
;
requestLongerTimeout
(
2
)
;
var
{
Toolbox
}
=
require
(
"
devtools
/
client
/
framework
/
toolbox
"
)
;
const
{
LocalizationHelper
}
=
require
(
"
devtools
/
shared
/
l10n
"
)
;
const
L10N
=
new
LocalizationHelper
(
"
devtools
/
client
/
locales
/
toolbox
.
properties
"
)
;
add_task
(
function
*
(
)
{
let
tab
=
yield
addTab
(
"
about
:
blank
"
)
;
let
target
=
TargetFactory
.
forTab
(
tab
)
;
yield
target
.
makeRemote
(
)
;
let
toolIDs
=
gDevTools
.
getToolDefinitionArray
(
)
.
filter
(
def
=
>
def
.
isTargetSupported
(
target
)
)
.
map
(
def
=
>
def
.
id
)
;
let
toolbox
=
yield
gDevTools
.
showToolbox
(
target
toolIDs
[
0
]
Toolbox
.
HostType
.
BOTTOM
)
;
let
nextShortcut
=
L10N
.
getStr
(
"
toolbox
.
nextTool
.
key
"
)
;
let
prevShortcut
=
L10N
.
getStr
(
"
toolbox
.
previousTool
.
key
"
)
;
for
(
let
i
=
1
;
i
<
toolIDs
.
length
;
i
+
+
)
{
yield
testShortcuts
(
toolbox
i
nextShortcut
toolIDs
)
;
}
for
(
let
i
=
0
;
i
<
toolIDs
.
length
;
i
+
+
)
{
yield
testShortcuts
(
toolbox
i
nextShortcut
toolIDs
)
;
}
for
(
let
i
=
toolIDs
.
length
-
2
;
i
>
=
0
;
i
-
-
)
{
yield
testShortcuts
(
toolbox
i
prevShortcut
toolIDs
)
;
}
for
(
let
i
=
toolIDs
.
length
-
1
;
i
>
=
0
;
i
-
-
)
{
yield
testShortcuts
(
toolbox
i
prevShortcut
toolIDs
)
;
}
yield
toolbox
.
destroy
(
)
;
gBrowser
.
removeCurrentTab
(
)
;
}
)
;
function
*
testShortcuts
(
toolbox
index
shortcut
toolIDs
)
{
info
(
"
Testing
shortcut
to
switch
to
tool
"
+
index
+
"
:
"
+
toolIDs
[
index
]
+
"
using
shortcut
"
+
shortcut
)
;
let
onToolSelected
=
toolbox
.
once
(
"
select
"
)
;
synthesizeKeyShortcut
(
shortcut
)
;
let
id
=
yield
onToolSelected
;
info
(
"
toolbox
-
select
event
from
"
+
id
)
;
is
(
toolIDs
.
indexOf
(
id
)
index
"
Correct
tool
is
selected
on
pressing
the
shortcut
for
"
+
id
)
;
}
