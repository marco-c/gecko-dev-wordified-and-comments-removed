"
use
strict
"
;
const
PAGE_URL
=
{
URL_ROOT
}
doc_empty
-
tab
-
01
.
html
;
const
JS_URL
=
URL_ROOT
+
"
code_bundle_late_script
.
js
"
;
const
ORIGINAL_URL
=
"
webpack
:
/
/
/
code_late_script
.
js
"
;
const
GENERATED_LINE
=
107
;
const
ORIGINAL_LINE
=
11
;
add_task
(
async
function
(
)
{
const
toolbox
=
await
openNewTabAndToolbox
(
PAGE_URL
"
webconsole
"
)
;
const
service
=
toolbox
.
sourceMapURLService
;
const
scriptMapped
=
new
Promise
(
resolve
=
>
{
let
count
=
0
;
service
.
subscribeByURL
(
JS_URL
GENERATED_LINE
undefined
originalLocation
=
>
{
if
(
count
=
=
=
0
)
{
resolve
(
originalLocation
)
;
}
count
+
=
1
;
return
(
)
=
>
{
}
;
}
)
;
}
)
;
const
sourceSeen
=
waitForSourceLoad
(
toolbox
JS_URL
)
;
await
createScript
(
JS_URL
)
;
await
sourceSeen
;
const
{
url
line
}
=
await
scriptMapped
;
is
(
url
ORIGINAL_URL
"
check
mapped
URL
"
)
;
is
(
line
ORIGINAL_LINE
"
check
mapped
line
number
"
)
;
await
toolbox
.
destroy
(
)
;
gBrowser
.
removeCurrentTab
(
)
;
finish
(
)
;
}
)
;
