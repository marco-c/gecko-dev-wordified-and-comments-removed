"
use
strict
"
;
const
TEST_URL
=
"
http
:
/
/
example
.
com
/
browser
/
devtools
/
client
/
framework
/
test
/
allocations
/
reloaded
-
page
.
html
"
;
async
function
testScript
(
)
{
const
onReloaded
=
BrowserTestUtils
.
browserLoaded
(
gBrowser
.
selectedBrowser
)
;
gBrowser
.
reloadTab
(
gBrowser
.
selectedTab
)
;
await
onReloaded
;
await
new
Promise
(
resolve
=
>
setTimeout
(
resolve
1000
)
)
;
}
add_task
(
async
function
(
)
{
const
tab
=
await
addTab
(
TEST_URL
)
;
await
testScript
(
)
;
await
startRecordingAllocations
(
{
alsoRecordContentProcess
:
true
}
)
;
for
(
let
i
=
0
;
i
<
10
;
i
+
+
)
{
await
testScript
(
)
;
}
await
stopRecordingAllocations
(
"
reload
-
no
-
devtools
"
{
alsoRecordContentProcess
:
true
}
)
;
gBrowser
.
removeTab
(
tab
)
;
}
)
;
