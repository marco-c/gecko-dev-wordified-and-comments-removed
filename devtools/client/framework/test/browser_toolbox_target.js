add_task
(
function
*
(
)
{
let
iframe
=
document
.
createElement
(
"
browser
"
)
;
iframe
.
setAttribute
(
"
type
"
"
content
"
)
;
document
.
documentElement
.
appendChild
(
iframe
)
;
let
onLoad
=
once
(
iframe
"
load
"
true
)
;
iframe
.
setAttribute
(
"
src
"
"
data
:
text
/
html
document
to
debug
"
)
;
yield
onLoad
;
is
(
iframe
.
contentWindow
.
document
.
body
.
innerHTML
"
document
to
debug
"
)
;
let
toolboxIframe
=
document
.
createElement
(
"
iframe
"
)
;
document
.
documentElement
.
appendChild
(
toolboxIframe
)
;
toolboxIframe
.
target
=
iframe
;
let
onToolboxReady
=
gDevTools
.
once
(
"
toolbox
-
ready
"
)
;
onLoad
=
once
(
toolboxIframe
"
load
"
true
)
;
toolboxIframe
.
setAttribute
(
"
src
"
"
about
:
devtools
-
toolbox
?
target
"
)
;
yield
onLoad
;
info
(
"
Waiting
for
toolbox
-
ready
"
)
;
let
toolbox
=
yield
onToolboxReady
;
let
onToolboxDestroyed
=
gDevTools
.
once
(
"
toolbox
-
destroyed
"
)
;
let
onTabActorDetached
=
once
(
toolbox
.
target
.
client
"
tabDetached
"
)
;
info
(
"
Removing
the
iframes
"
)
;
toolboxIframe
.
remove
(
)
;
info
(
"
Waiting
for
toolbox
-
destroyed
"
)
;
yield
onToolboxDestroyed
;
info
(
"
Toolbox
destroyed
"
)
;
yield
onTabActorDetached
;
iframe
.
remove
(
)
;
}
)
;
