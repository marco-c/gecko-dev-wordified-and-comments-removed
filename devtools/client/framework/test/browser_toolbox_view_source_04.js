var
URL
=
{
URL_ROOT
}
doc_viewsource
.
html
;
async
function
viewSource
(
)
{
const
toolbox
=
await
openNewTabAndToolbox
(
URL
)
;
const
win
=
await
openScratchpadWindow
(
)
;
const
{
Scratchpad
:
scratchpad
}
=
win
;
scratchpad
.
setText
(
"
E
G
B
C
B
\
nA
B
A
G
A
B
\
nG
E
"
)
;
const
scratchpadURL
=
scratchpad
.
uniqueName
;
await
toolbox
.
selectTool
(
"
webconsole
"
)
;
await
toolbox
.
viewSourceInScratchpad
(
scratchpadURL
2
)
;
is
(
scratchpad
.
editor
.
getCursor
(
)
.
line
2
"
The
correct
line
is
highlighted
in
scratchpad
'
s
editor
.
"
)
;
win
.
close
(
)
;
await
closeToolboxAndTab
(
toolbox
)
;
finish
(
)
;
}
function
test
(
)
{
viewSource
(
)
.
then
(
finish
aError
=
>
{
ok
(
false
"
Got
an
error
:
"
+
aError
.
message
+
"
\
n
"
+
aError
.
stack
)
;
finish
(
)
;
}
)
;
}
