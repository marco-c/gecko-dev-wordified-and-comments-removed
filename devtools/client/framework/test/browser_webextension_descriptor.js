"
use
strict
"
;
add_task
(
async
function
test_webextension_descriptors
(
)
{
const
extension
=
ExtensionTestUtils
.
loadExtension
(
{
useAddonManager
:
"
temporary
"
manifest
:
{
name
:
"
Descriptor
extension
"
}
}
)
;
await
extension
.
startup
(
)
;
const
commands
=
await
CommandsFactory
.
forAddon
(
extension
.
id
)
;
const
descriptor
=
commands
.
descriptorFront
;
ok
(
descriptor
"
webextension
descriptor
has
been
found
"
)
;
is
(
descriptor
.
name
"
Descriptor
extension
"
"
Descriptor
name
is
correct
"
)
;
is
(
descriptor
.
debuggable
true
"
Descriptor
debuggable
attribute
is
correct
"
)
;
const
onDestroyed
=
descriptor
.
once
(
"
descriptor
-
destroyed
"
)
;
info
(
"
Uninstall
the
extension
"
)
;
await
extension
.
unload
(
)
;
info
(
"
Wait
for
the
descriptor
to
be
destroyed
"
)
;
await
onDestroyed
;
await
commands
.
destroy
(
)
;
}
)
;
