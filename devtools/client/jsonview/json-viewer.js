"
use
strict
"
;
define
(
function
(
require
exports
module
)
{
const
{
render
}
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
-
dom
"
)
;
const
{
createFactories
}
=
require
(
"
devtools
/
client
/
shared
/
react
-
utils
"
)
;
const
{
MainTabbedArea
}
=
createFactories
(
require
(
"
.
/
components
/
main
-
tabbed
-
area
"
)
)
;
const
json
=
document
.
getElementById
(
"
json
"
)
;
let
jsonData
;
let
prettyURL
;
try
{
jsonData
=
JSON
.
parse
(
json
.
textContent
)
;
}
catch
(
err
)
{
jsonData
=
err
;
}
let
input
=
{
jsonText
:
json
.
textContent
jsonPretty
:
null
json
:
jsonData
headers
:
JSONView
.
headers
tabActive
:
0
prettified
:
false
}
;
json
.
remove
(
)
;
input
.
actions
=
{
onCopyJson
:
function
(
)
{
dispatchEvent
(
"
copy
"
input
.
prettified
?
input
.
jsonPretty
:
input
.
jsonText
)
;
}
onSaveJson
:
function
(
)
{
if
(
input
.
prettified
&
&
!
prettyURL
)
{
prettyURL
=
URL
.
createObjectURL
(
new
window
.
Blob
(
[
input
.
jsonPretty
]
)
)
;
}
dispatchEvent
(
"
save
"
input
.
prettified
?
prettyURL
:
null
)
;
}
onCopyHeaders
:
function
(
)
{
dispatchEvent
(
"
copy
-
headers
"
input
.
headers
)
;
}
onSearch
:
function
(
value
)
{
theApp
.
setState
(
{
searchFilter
:
value
}
)
;
}
onPrettify
:
function
(
data
)
{
if
(
jsonData
instanceof
Error
)
{
return
;
}
if
(
input
.
prettified
)
{
theApp
.
setState
(
{
jsonText
:
input
.
jsonText
}
)
;
}
else
{
if
(
!
input
.
jsonPretty
)
{
input
.
jsonPretty
=
JSON
.
stringify
(
jsonData
null
"
"
)
;
}
theApp
.
setState
(
{
jsonText
:
input
.
jsonPretty
}
)
;
}
input
.
prettified
=
!
input
.
prettified
;
}
}
;
function
dispatchEvent
(
type
value
)
{
let
data
=
{
detail
:
{
type
value
}
}
;
let
contentMessageEvent
=
new
CustomEvent
(
"
contentMessage
"
data
)
;
window
.
dispatchEvent
(
contentMessageEvent
)
;
}
let
content
=
document
.
getElementById
(
"
content
"
)
;
let
theApp
=
render
(
MainTabbedArea
(
input
)
content
)
;
let
event
=
new
CustomEvent
(
"
JSONViewInitialized
"
{
}
)
;
JSONView
.
initialized
=
true
;
window
.
dispatchEvent
(
event
)
;
}
)
;
