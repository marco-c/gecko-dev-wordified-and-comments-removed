"
use
strict
"
;
add_task
(
function
*
(
)
{
info
(
"
Test
UTF
-
8
JSON
started
"
)
;
const
encodedChar
=
"
%
E2
%
9D
%
A4
"
;
const
TEST_JSON_URL
=
"
data
:
application
/
json
;
charset
=
ANSI
[
\
"
"
+
encodedChar
+
"
\
"
]
"
;
yield
addJsonViewTab
(
TEST_JSON_URL
)
;
let
countBefore
=
yield
getElementCount
(
"
.
jsonPanelBox
.
treeTable
.
treeRow
"
)
;
is
(
countBefore
1
"
There
must
be
one
row
.
"
)
;
let
objectCellCount
=
yield
getElementCount
(
"
.
jsonPanelBox
.
treeTable
.
stringCell
"
)
;
is
(
objectCellCount
1
"
There
must
be
one
string
cell
.
"
)
;
let
objectCellText
=
yield
getElementText
(
"
.
jsonPanelBox
.
treeTable
.
stringCell
"
)
;
is
(
objectCellText
JSON
.
stringify
(
decodeURIComponent
(
encodedChar
)
)
"
The
source
has
been
parsed
as
UTF
-
8
ignoring
the
charset
parameter
.
"
)
;
}
)
;
