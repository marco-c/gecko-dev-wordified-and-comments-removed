"
use
strict
"
;
const
TEST_URI
=
{
URL_ROOT
}
doc_toolbox_rule_view
.
html
;
addRDMTaskWithPreAndPost
(
TEST_URI
async
function
pre_task
(
)
{
info
(
"
Open
the
rule
-
view
and
select
the
test
node
before
opening
RDM
"
)
;
const
ruleViewValues
=
await
openRuleView
(
)
;
const
{
inspector
view
}
=
ruleViewValues
;
await
selectNode
(
"
div
"
inspector
)
;
is
(
numberOfRules
(
view
)
2
"
Rule
view
has
two
rules
.
"
)
;
return
ruleViewValues
;
}
async
function
task
(
{
preTaskValue
}
)
{
const
{
inspector
view
}
=
preTaskValue
;
info
(
"
Reload
the
current
page
"
)
;
const
onNewRoot
=
inspector
.
once
(
"
new
-
root
"
)
;
const
onRuleViewRefreshed
=
inspector
.
once
(
"
rule
-
view
-
refreshed
"
)
;
await
refreshTab
(
)
;
await
onNewRoot
;
await
inspector
.
markup
.
_waitForChildren
(
)
;
await
onRuleViewRefreshed
;
await
new
Promise
(
resolve
=
>
{
view
.
styleWindow
.
requestAnimationFrame
(
(
)
=
>
{
view
.
styleWindow
.
requestAnimationFrame
(
resolve
)
;
}
)
;
}
)
;
is
(
numberOfRules
(
view
)
2
"
Rule
view
still
has
two
rules
and
is
not
empty
.
"
)
;
}
null
)
;
function
numberOfRules
(
ruleView
)
{
return
ruleView
.
element
.
querySelectorAll
(
"
.
ruleview
-
code
"
)
.
length
;
}
