"
use
strict
"
;
var
imgClass
=
"
.
service
-
worker
-
disabled
.
warning
"
;
add_task
(
async
function
(
)
{
await
new
Promise
(
done
=
>
{
info
(
"
disable
service
workers
"
)
;
let
options
=
{
"
set
"
:
[
[
"
dom
.
serviceWorkers
.
enabled
"
false
]
]
}
;
SpecialPowers
.
pushPrefEnv
(
options
done
)
;
}
)
;
let
{
tab
document
}
=
await
openAboutDebugging
(
"
workers
"
)
;
let
img
=
document
.
querySelector
(
imgClass
)
;
ok
(
img
"
warning
message
is
rendered
"
)
;
await
closeAboutDebugging
(
tab
)
;
}
)
;
add_task
(
async
function
(
)
{
await
new
Promise
(
done
=
>
{
info
(
"
set
private
browsing
mode
as
default
"
)
;
let
options
=
{
"
set
"
:
[
[
"
browser
.
privatebrowsing
.
autostart
"
true
]
]
}
;
SpecialPowers
.
pushPrefEnv
(
options
done
)
;
}
)
;
let
{
tab
document
}
=
await
openAboutDebugging
(
"
workers
"
)
;
let
img
=
document
.
querySelector
(
imgClass
)
;
ok
(
img
"
warning
message
is
rendered
"
)
;
await
closeAboutDebugging
(
tab
)
;
}
)
;
add_task
(
async
function
(
)
{
info
(
"
Opening
a
new
private
window
"
)
;
let
win
=
OpenBrowserWindow
(
{
private
:
true
}
)
;
await
waitForDelayedStartupFinished
(
win
)
;
let
{
tab
document
}
=
await
openAboutDebugging
(
"
workers
"
win
)
;
let
img
=
document
.
querySelector
(
imgClass
)
;
ok
(
img
"
warning
message
is
rendered
"
)
;
await
closeAboutDebugging
(
tab
)
;
win
.
close
(
)
;
}
)
;
