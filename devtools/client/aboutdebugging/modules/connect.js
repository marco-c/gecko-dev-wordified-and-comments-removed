"
use
strict
"
;
const
{
clientFromURL
}
=
require
(
"
devtools
/
client
/
framework
/
target
-
from
-
url
"
)
;
const
{
DebuggerServer
}
=
require
(
"
devtools
/
server
/
main
"
)
;
const
TYPE
=
{
LOCAL
:
"
LOCAL
"
REMOTE
:
"
REMOTE
"
}
;
function
createDescriptorFromURL
(
url
)
{
const
params
=
url
.
searchParams
;
const
host
=
params
.
get
(
"
host
"
)
;
const
port
=
params
.
get
(
"
port
"
)
;
let
descriptor
;
if
(
host
&
&
port
)
{
descriptor
=
{
type
:
TYPE
.
REMOTE
params
:
{
host
port
}
}
;
}
else
{
descriptor
=
{
type
:
TYPE
.
LOCAL
params
:
{
}
}
;
}
return
descriptor
;
}
exports
.
createClient
=
async
function
(
)
{
const
href
=
window
.
location
.
href
;
const
url
=
new
window
.
URL
(
href
.
replace
(
"
about
:
"
"
http
:
/
/
"
)
)
;
const
connect
=
createDescriptorFromURL
(
url
)
;
const
client
=
await
clientFromURL
(
url
)
;
DebuggerServer
.
allowChromeProcess
=
true
;
return
{
client
connect
}
;
}
;
