"
use
strict
"
;
function
getElementText
(
el
)
{
if
(
!
el
)
{
return
null
;
}
const
doc
=
el
.
ownerDocument
;
const
win
=
doc
&
&
doc
.
defaultView
;
if
(
!
win
)
{
return
el
.
textContent
;
}
const
selection
=
win
.
getSelection
(
)
;
const
currentSelectedRange
=
!
selection
.
isCollapsed
&
&
selection
.
getRangeAt
(
0
)
;
selection
.
removeAllRanges
(
)
;
const
range
=
doc
.
createRange
(
)
;
range
.
selectNode
(
el
)
;
selection
.
addRange
(
range
)
;
const
text
=
selection
.
toString
(
)
;
selection
.
removeRange
(
range
)
;
if
(
currentSelectedRange
)
{
selection
.
addRange
(
currentSelectedRange
)
;
}
return
text
;
}
module
.
exports
=
{
getElementText
}
;
