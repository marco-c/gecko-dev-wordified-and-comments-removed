"
use
strict
"
;
let
ReactDOM
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
-
dom
"
)
;
let
React
=
require
(
"
devtools
/
client
/
shared
/
vendor
/
react
"
)
;
var
TestUtils
=
React
.
addons
.
TestUtils
;
const
actions
=
require
(
"
devtools
/
client
/
webconsole
/
new
-
console
-
output
/
actions
/
index
"
)
;
const
{
configureStore
}
=
require
(
"
devtools
/
client
/
webconsole
/
new
-
console
-
output
/
store
"
)
;
const
{
IdGenerator
}
=
require
(
"
devtools
/
client
/
webconsole
/
new
-
console
-
output
/
utils
/
id
-
generator
"
)
;
const
{
stubPackets
}
=
require
(
"
devtools
/
client
/
webconsole
/
new
-
console
-
output
/
test
/
fixtures
/
stubs
/
index
"
)
;
const
{
getAllMessagesById
}
=
require
(
"
devtools
/
client
/
webconsole
/
new
-
console
-
output
/
selectors
/
messages
"
)
;
function
setupActions
(
)
{
const
wrappedActions
=
Object
.
assign
(
{
}
actions
)
;
const
idGenerator
=
new
IdGenerator
(
)
;
wrappedActions
.
messageAdd
=
(
packet
)
=
>
{
return
actions
.
messageAdd
(
packet
idGenerator
)
;
}
;
return
wrappedActions
;
}
function
setupStore
(
input
=
[
]
hud
options
)
{
const
store
=
configureStore
(
hud
options
)
;
input
.
forEach
(
(
cmd
)
=
>
{
store
.
dispatch
(
actions
.
messageAdd
(
stubPackets
.
get
(
cmd
)
)
)
;
}
)
;
return
store
;
}
function
renderComponent
(
component
props
)
{
const
el
=
React
.
createElement
(
component
props
{
}
)
;
const
wrappedEl
=
React
.
DOM
.
span
(
{
}
[
el
]
)
;
const
renderedComponent
=
TestUtils
.
renderIntoDocument
(
wrappedEl
)
;
return
ReactDOM
.
findDOMNode
(
renderedComponent
)
.
children
[
0
]
;
}
function
shallowRenderComponent
(
component
props
)
{
const
el
=
React
.
createElement
(
component
props
)
;
const
renderer
=
TestUtils
.
createRenderer
(
)
;
renderer
.
render
(
el
{
}
)
;
return
renderer
.
getRenderOutput
(
)
;
}
function
clonePacket
(
packet
)
{
return
JSON
.
parse
(
JSON
.
stringify
(
packet
)
)
;
}
function
getMessageAt
(
state
index
)
{
const
messages
=
getAllMessagesById
(
state
)
;
return
messages
.
get
(
[
.
.
.
messages
.
keys
(
)
]
[
index
]
)
;
}
module
.
exports
=
{
clonePacket
getMessageAt
renderComponent
setupActions
setupStore
shallowRenderComponent
}
;
