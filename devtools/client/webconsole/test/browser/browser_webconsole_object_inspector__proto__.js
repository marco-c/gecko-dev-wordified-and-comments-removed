"
use
strict
"
;
const
TEST_URI
=
"
data
:
text
/
html
;
charset
=
utf8
<
!
DOCTYPE
html
>
<
h1
>
test
Object
Inspector
__proto__
<
/
h1
>
"
;
add_task
(
async
function
(
)
{
const
hud
=
await
openNewTabAndConsole
(
TEST_URI
)
;
logAllStoreChanges
(
hud
)
;
await
SpecialPowers
.
spawn
(
gBrowser
.
selectedBrowser
[
]
function
(
)
{
const
obj
=
Object
.
create
(
null
)
;
obj
.
__proto__
=
[
]
;
content
.
wrappedJSObject
.
console
.
log
(
"
oi
-
test
"
obj
)
;
}
)
;
const
node
=
await
waitFor
(
(
)
=
>
findMessage
(
hud
"
oi
-
test
"
)
)
;
const
objectInspector
=
node
.
querySelector
(
"
.
tree
"
)
;
ok
(
objectInspector
"
Object
is
printed
in
the
console
"
)
;
is
(
objectInspector
.
textContent
.
trim
(
)
"
Object
{
__proto__
:
[
]
}
"
"
Object
is
displayed
as
expected
"
)
;
objectInspector
.
querySelector
(
"
.
arrow
"
)
.
click
(
)
;
await
waitFor
(
(
)
=
>
node
.
querySelectorAll
(
"
.
tree
-
node
"
)
.
length
=
=
=
2
)
;
const
__proto__Node
=
node
.
querySelector
(
"
.
tree
-
node
:
last
-
of
-
type
"
)
;
ok
(
__proto__Node
.
textContent
.
includes
(
"
__proto__
:
Array
[
]
"
)
"
__proto__
node
is
displayed
as
expected
"
)
;
}
)
;
