"
use
strict
"
;
add_task
(
async
function
(
)
{
await
pushPref
(
"
security
.
allow_parent_unrestricted_js_loads
"
true
)
;
const
hud
=
await
BrowserConsoleManager
.
toggleBrowserConsole
(
)
;
ok
(
hud
"
browser
console
opened
"
)
;
execute
(
hud
"
window
.
nukedSandbox
=
Cu
.
Sandbox
(
null
)
;
Cu
.
nukeSandbox
(
nukedSandbox
)
;
"
)
;
await
executeAndWaitForResultMessage
(
hud
"
nukedSandbox
"
"
DeadObject
"
)
;
const
msg
=
await
executeAndWaitForErrorMessage
(
hud
"
nukedSandbox
.
hello
"
"
can
'
t
access
dead
object
"
)
;
const
anchor
=
msg
.
node
.
querySelector
(
"
a
"
)
;
is
(
anchor
.
textContent
"
[
Learn
More
]
"
"
Link
text
is
correct
"
)
;
await
executeAndWaitForResultMessage
(
hud
"
delete
window
.
nukedSandbox
;
1
+
1
"
"
2
"
)
;
}
)
;
