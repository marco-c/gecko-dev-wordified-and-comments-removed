"
use
strict
"
;
const
TEST_URI
=
"
http
:
/
/
example
.
com
/
browser
/
devtools
/
client
/
webconsole
/
"
+
"
test
/
mochitest
/
test
-
console
.
html
"
;
add_task
(
async
function
(
)
{
const
tab
=
await
addTab
(
TEST_URI
)
;
const
browser
=
tab
.
linkedBrowser
;
const
hud
=
await
openConsole
(
)
;
await
jstermSetValueAndComplete
(
hud
.
jsterm
"
doc
"
)
;
let
errorWhileClosing
=
false
;
function
errorListener
(
)
{
errorWhileClosing
=
true
;
}
browser
.
addEventListener
(
"
error
"
errorListener
)
;
const
onToolboxDestroyed
=
gDevTools
.
once
(
"
toolbox
-
destroyed
"
)
;
hud
.
jsterm
.
focus
(
)
;
EventUtils
.
synthesizeKey
(
"
i
"
{
accelKey
:
true
[
Services
.
appinfo
.
OS
=
=
"
Darwin
"
?
"
altKey
"
:
"
shiftKey
"
]
:
true
}
)
;
await
onToolboxDestroyed
;
browser
.
removeEventListener
(
"
error
"
errorListener
)
;
is
(
errorWhileClosing
false
"
no
error
while
closing
the
WebConsole
"
)
;
}
)
;
