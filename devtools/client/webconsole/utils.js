"
use
strict
"
;
const
{
Cc
Ci
}
=
require
(
"
chrome
"
)
;
const
Services
=
require
(
"
Services
"
)
;
const
CONSOLE_ENTRY_THRESHOLD
=
5
;
var
WebConsoleUtils
=
{
CONSOLE_ENTRY_THRESHOLD
supportsString
:
function
(
string
)
{
const
str
=
Cc
[
"
mozilla
.
org
/
supports
-
string
;
1
"
]
.
createInstance
(
Ci
.
nsISupportsString
)
;
str
.
data
=
string
;
return
str
;
}
copyTextStyles
:
function
(
from
to
)
{
const
win
=
from
.
ownerDocument
.
defaultView
;
const
style
=
win
.
getComputedStyle
(
from
)
;
to
.
style
.
fontFamily
=
style
.
fontFamily
;
to
.
style
.
fontSize
=
style
.
fontSize
;
to
.
style
.
fontWeight
=
style
.
fontWeight
;
to
.
style
.
fontStyle
=
style
.
fontStyle
;
}
_usageCount
:
0
get
usageCount
(
)
{
if
(
WebConsoleUtils
.
_usageCount
<
CONSOLE_ENTRY_THRESHOLD
)
{
WebConsoleUtils
.
_usageCount
=
Services
.
prefs
.
getIntPref
(
"
devtools
.
selfxss
.
count
"
)
;
if
(
Services
.
prefs
.
getBoolPref
(
"
devtools
.
chrome
.
enabled
"
)
)
{
WebConsoleUtils
.
usageCount
=
CONSOLE_ENTRY_THRESHOLD
;
}
}
return
WebConsoleUtils
.
_usageCount
;
}
set
usageCount
(
newUC
)
{
if
(
newUC
<
=
CONSOLE_ENTRY_THRESHOLD
)
{
WebConsoleUtils
.
_usageCount
=
newUC
;
Services
.
prefs
.
setIntPref
(
"
devtools
.
selfxss
.
count
"
newUC
)
;
}
}
}
;
exports
.
Utils
=
WebConsoleUtils
;
