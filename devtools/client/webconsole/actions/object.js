"
use
strict
"
;
loader
.
lazyServiceGetter
(
this
"
clipboardHelper
"
"
mozilla
.
org
/
widget
/
clipboardhelper
;
1
"
"
nsIClipboardHelper
"
)
;
function
storeAsGlobal
(
actor
)
{
return
async
(
{
commands
hud
}
)
=
>
{
const
evalString
=
{
let
i
=
0
;
while
(
this
.
hasOwnProperty
(
"
temp
"
+
i
)
&
&
i
<
1000
)
{
i
+
+
;
}
this
[
"
temp
"
+
i
]
=
_self
;
"
temp
"
+
i
;
}
;
const
res
=
await
commands
.
scriptCommand
.
execute
(
evalString
{
selectedObjectActor
:
actor
}
)
;
if
(
hud
.
toolbox
)
{
const
objectFront
=
commands
.
client
.
getFrontByID
(
actor
)
;
if
(
objectFront
)
{
const
targetActorID
=
objectFront
.
targetFront
?
.
actorID
;
if
(
targetActorID
)
{
hud
.
toolbox
.
selectTarget
(
targetActorID
)
;
}
}
}
hud
.
focusInput
(
)
;
hud
.
setInputValue
(
res
.
result
)
;
}
;
}
function
copyMessageObject
(
actor
variableText
)
{
return
async
(
{
commands
}
)
=
>
{
if
(
actor
)
{
const
res
=
await
commands
.
scriptCommand
.
execute
(
"
copy
(
_self
)
"
{
selectedObjectActor
:
actor
}
)
;
clipboardHelper
.
copyString
(
res
.
helperResult
.
value
)
;
}
else
{
clipboardHelper
.
copyString
(
variableText
)
;
}
}
;
}
module
.
exports
=
{
storeAsGlobal
copyMessageObject
}
;
