"
use
strict
"
;
const
{
START_WORKER
UNREGISTER_WORKER
UPDATE_CAN_DEBUG_WORKERS
UPDATE_WORKERS
}
=
require
(
"
devtools
/
client
/
application
/
src
/
constants
"
)
;
function
WorkersState
(
)
{
return
{
list
:
[
]
canDebugWorkers
:
false
}
;
}
function
buildWorkerDataFromFronts
(
{
registration
workers
}
)
{
return
{
id
:
registration
.
id
lastUpdateTime
:
registration
.
lastUpdateTime
registrationFront
:
registration
scope
:
registration
.
scope
workers
:
workers
.
map
(
worker
=
>
(
{
id
:
worker
.
id
url
:
worker
.
url
state
:
worker
.
state
stateText
:
worker
.
stateText
registrationFront
:
registration
workerDescriptorFront
:
worker
.
workerDescriptorFront
}
)
)
}
;
}
function
workersReducer
(
state
=
WorkersState
(
)
action
)
{
switch
(
action
.
type
)
{
case
UPDATE_CAN_DEBUG_WORKERS
:
{
return
Object
.
assign
(
{
}
state
{
canDebugWorkers
:
action
.
canDebugWorkers
}
)
;
}
case
UPDATE_WORKERS
:
{
const
{
workers
}
=
action
;
return
Object
.
assign
(
{
}
state
{
list
:
workers
.
map
(
buildWorkerDataFromFronts
)
.
flat
(
)
}
)
;
}
case
START_WORKER
:
case
UNREGISTER_WORKER
:
return
state
;
default
:
return
state
;
}
}
module
.
exports
=
{
WorkersState
workersReducer
}
;
