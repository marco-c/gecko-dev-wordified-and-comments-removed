"
use
strict
"
;
const
promise
=
require
(
"
devtools
/
shared
/
deprecated
-
sync
-
thenables
"
)
;
const
eventSource
=
require
(
"
devtools
/
shared
/
client
/
event
-
source
"
)
;
const
{
arg
DebuggerClient
}
=
require
(
"
devtools
/
shared
/
client
/
debugger
-
client
"
)
;
function
BreakpointClient
(
client
sourceClient
actor
location
options
)
{
this
.
_client
=
client
;
this
.
_actor
=
actor
;
this
.
location
=
location
;
this
.
location
.
actor
=
sourceClient
.
actor
;
this
.
location
.
url
=
sourceClient
.
url
;
this
.
source
=
sourceClient
;
this
.
request
=
this
.
_client
.
request
;
this
.
options
=
options
;
}
BreakpointClient
.
prototype
=
{
_actor
:
null
get
actor
(
)
{
return
this
.
_actor
;
}
get
_transport
(
)
{
return
this
.
_client
.
_transport
;
}
remove
:
DebuggerClient
.
requester
(
{
type
:
"
delete
"
}
)
setOptionsRequester
:
DebuggerClient
.
requester
(
{
type
:
"
setOptions
"
options
:
arg
(
0
)
}
{
before
(
packet
)
{
this
.
options
=
packet
.
options
;
return
packet
;
}
}
)
setOptions
:
function
(
options
)
{
if
(
this
.
_client
.
mainRoot
.
traits
.
nativeLogpoints
)
{
this
.
setOptionsRequester
(
options
)
;
}
else
{
const
deferred
=
promise
.
defer
(
)
;
const
info
=
{
line
:
this
.
location
.
line
column
:
this
.
location
.
column
options
}
;
this
.
remove
(
response
=
>
{
if
(
response
&
&
response
.
error
)
{
deferred
.
reject
(
response
)
;
return
;
}
deferred
.
resolve
(
this
.
source
.
setBreakpoint
(
info
)
.
then
(
(
[
newBreakpoint
]
)
=
>
{
return
newBreakpoint
;
}
)
)
;
}
)
;
}
}
}
;
eventSource
(
BreakpointClient
.
prototype
)
;
module
.
exports
=
BreakpointClient
;
