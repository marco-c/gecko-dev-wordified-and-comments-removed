"
use
strict
"
;
const
{
Cc
Ci
}
=
require
(
"
chrome
"
)
;
const
PSEUDOURI
=
"
indexeddb
:
/
/
fx
-
devtools
"
;
const
principaluri
=
Cc
[
"
mozilla
.
org
/
network
/
io
-
service
;
1
"
]
.
getService
(
Ci
.
nsIIOService
)
.
newURI
(
PSEUDOURI
)
;
const
ssm
=
Cc
[
"
mozilla
.
org
/
scriptsecuritymanager
;
1
"
]
.
getService
(
Ci
.
nsIScriptSecurityManager
)
;
const
principal
=
ssm
.
createCodebasePrincipal
(
principaluri
{
}
)
;
exports
.
createDevToolsIndexedDB
=
function
(
indexedDB
)
{
return
Object
.
freeze
(
{
open
(
name
version
)
{
let
options
=
{
storage
:
"
persistent
"
}
;
if
(
typeof
version
=
=
=
"
number
"
)
{
options
.
version
=
version
;
}
return
indexedDB
.
openForPrincipal
(
principal
name
options
)
;
}
deleteDatabase
(
name
)
{
return
indexedDB
.
deleteForPrincipal
(
principal
name
{
storage
:
"
persistent
"
}
)
;
}
cmp
:
indexedDB
.
cmp
.
bind
(
indexedDB
)
}
)
;
}
;
