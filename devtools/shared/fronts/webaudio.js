"
use
strict
"
;
const
{
audionodeSpec
webAudioSpec
AUTOMATION_METHODS
NODE_CREATION_METHODS
NODE_ROUTING_METHODS
}
=
require
(
"
devtools
/
shared
/
specs
/
webaudio
"
)
;
const
{
FrontClassWithSpec
registerFront
}
=
require
(
"
devtools
/
shared
/
protocol
"
)
;
loader
.
lazyRequireGetter
(
this
"
AUDIO_NODE_DEFINITION
"
"
devtools
/
server
/
actors
/
utils
/
audionodes
.
json
"
)
;
class
AudioNodeFront
extends
FrontClassWithSpec
(
audionodeSpec
)
{
form
(
form
)
{
this
.
actorID
=
form
.
actor
;
this
.
type
=
form
.
type
;
this
.
source
=
form
.
source
;
this
.
bypassable
=
form
.
bypassable
;
}
}
exports
.
AudioNodeFront
=
AudioNodeFront
;
registerFront
(
AudioNodeFront
)
;
class
WebAudioFront
extends
FrontClassWithSpec
(
webAudioSpec
)
{
constructor
(
client
)
{
super
(
client
)
;
this
.
before
(
"
create
-
node
"
this
.
_onCreateNode
.
bind
(
this
)
)
;
this
.
formAttributeName
=
"
webaudioActor
"
;
}
_onCreateNode
(
audionode
)
{
if
(
!
audionode
.
type
)
{
return
audionode
.
getType
(
)
.
then
(
type
=
>
{
audionode
.
type
=
type
;
audionode
.
source
=
!
!
AUDIO_NODE_DEFINITION
[
type
]
.
source
;
audionode
.
bypassable
=
!
AUDIO_NODE_DEFINITION
[
type
]
.
unbypassable
;
}
)
;
}
return
null
;
}
}
WebAudioFront
.
AUTOMATION_METHODS
=
new
Set
(
AUTOMATION_METHODS
)
;
WebAudioFront
.
NODE_CREATION_METHODS
=
new
Set
(
NODE_CREATION_METHODS
)
;
WebAudioFront
.
NODE_ROUTING_METHODS
=
new
Set
(
NODE_ROUTING_METHODS
)
;
exports
.
WebAudioFront
=
WebAudioFront
;
registerFront
(
WebAudioFront
)
;
