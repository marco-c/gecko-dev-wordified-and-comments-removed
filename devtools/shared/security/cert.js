"
use
strict
"
;
var
{
Ci
Cc
}
=
require
(
"
chrome
"
)
;
var
defer
=
require
(
"
devtools
/
shared
/
defer
"
)
;
var
DevToolsUtils
=
require
(
"
devtools
/
shared
/
DevToolsUtils
"
)
;
DevToolsUtils
.
defineLazyGetter
(
this
"
localCertService
"
(
)
=
>
{
Cc
[
"
mozilla
.
org
/
psm
;
1
"
]
.
getService
(
Ci
.
nsISupports
)
;
return
Cc
[
"
mozilla
.
org
/
security
/
local
-
cert
-
service
;
1
"
]
.
getService
(
Ci
.
nsILocalCertService
)
;
}
)
;
const
localCertName
=
"
devtools
"
;
exports
.
local
=
{
getOrCreate
(
)
{
let
deferred
=
defer
(
)
;
localCertService
.
getOrCreateCert
(
localCertName
{
handleCert
:
function
(
cert
rv
)
{
if
(
rv
)
{
deferred
.
reject
(
rv
)
;
return
;
}
deferred
.
resolve
(
cert
)
;
}
}
)
;
return
deferred
.
promise
;
}
remove
(
)
{
let
deferred
=
defer
(
)
;
localCertService
.
removeCert
(
localCertName
{
handleCert
:
function
(
rv
)
{
if
(
rv
)
{
deferred
.
reject
(
rv
)
;
return
;
}
deferred
.
resolve
(
)
;
}
}
)
;
return
deferred
.
promise
;
}
}
;
