"
use
strict
"
;
const
{
ResourceWatcher
}
=
require
(
"
devtools
/
shared
/
resources
/
resource
-
watcher
"
)
;
module
.
exports
=
async
function
(
{
targetFront
onAvailable
}
)
{
if
(
!
targetFront
.
hasActor
(
"
styleSheets
"
)
)
{
return
;
}
const
styleSheetsFront
=
await
targetFront
.
getFront
(
"
stylesheets
"
)
;
try
{
const
styleSheets
=
await
styleSheetsFront
.
getStyleSheets
(
)
;
onAvailable
(
styleSheets
.
map
(
styleSheet
=
>
toResource
(
styleSheet
false
)
)
)
;
styleSheetsFront
.
on
(
"
stylesheet
-
added
"
(
styleSheet
isNew
)
=
>
{
onAvailable
(
[
toResource
(
styleSheet
isNew
)
]
)
;
}
)
;
}
catch
(
e
)
{
console
.
warn
(
"
fetching
stylesheets
failed
"
e
)
;
}
}
;
function
toResource
(
styleSheet
isNew
)
{
return
{
resourceType
:
ResourceWatcher
.
TYPES
.
STYLESHEET
styleSheet
isNew
}
;
}
