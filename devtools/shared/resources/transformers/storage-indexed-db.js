"
use
strict
"
;
module
.
exports
=
function
(
{
resource
targetFront
}
)
{
const
SAFE_HOSTS_PREFIXES_REGEX
=
/
^
(
about
:
|
https
?
:
|
file
:
|
moz
-
extension
:
)
/
;
const
{
hosts
}
=
resource
;
if
(
!
targetFront
.
chrome
)
{
const
newHosts
=
{
}
;
for
(
const
[
host
dbs
]
of
Object
.
entries
(
hosts
)
)
{
if
(
SAFE_HOSTS_PREFIXES_REGEX
.
test
(
host
)
)
{
newHosts
[
host
]
=
dbs
;
}
}
resource
.
hosts
=
newHosts
;
}
return
resource
;
}
;
