"
use
strict
"
;
const
{
Cu
components
}
=
require
(
"
chrome
"
)
;
function
describeNthCaller
(
n
)
{
if
(
isWorker
)
{
return
"
"
;
}
let
caller
=
components
.
stack
;
while
(
n
>
=
0
)
{
-
-
n
;
caller
=
caller
.
caller
;
}
let
func
=
caller
.
name
;
let
file
=
caller
.
filename
;
if
(
file
.
includes
(
"
-
>
"
)
)
{
file
=
caller
.
filename
.
split
(
/
-
>
/
)
[
1
]
;
}
let
path
=
file
+
"
:
"
+
caller
.
lineNumber
;
return
func
+
"
(
)
-
>
"
+
path
;
}
function
getStack
(
)
{
return
components
.
stack
.
caller
;
}
function
callFunctionWithAsyncStack
(
callee
stack
id
)
{
if
(
isWorker
)
{
return
callee
(
)
;
}
return
Cu
.
callFunctionWithAsyncStack
(
callee
stack
id
)
;
}
exports
.
callFunctionWithAsyncStack
=
callFunctionWithAsyncStack
;
exports
.
describeNthCaller
=
describeNthCaller
;
exports
.
getStack
=
getStack
;
