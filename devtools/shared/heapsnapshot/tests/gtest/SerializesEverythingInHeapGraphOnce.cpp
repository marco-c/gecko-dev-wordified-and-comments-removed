#
include
"
DevTools
.
h
"
DEF_TEST
(
SerializesEverythingInHeapGraphOnce
{
FakeNode
nodeA
;
FakeNode
nodeB
;
FakeNode
nodeC
;
FakeNode
nodeD
;
AddEdge
(
nodeA
nodeB
)
;
AddEdge
(
nodeB
nodeC
)
;
AddEdge
(
nodeC
nodeD
)
;
AddEdge
(
nodeD
nodeA
)
;
:
:
testing
:
:
NiceMock
<
MockWriter
>
writer
;
ExpectWriteNode
(
writer
nodeA
)
;
ExpectWriteNode
(
writer
nodeB
)
;
ExpectWriteNode
(
writer
nodeC
)
;
ExpectWriteNode
(
writer
nodeD
)
;
JS
:
:
AutoCheckCannotGC
noGC
(
rt
)
;
ASSERT_TRUE
(
WriteHeapGraph
(
cx
JS
:
:
ubi
:
:
Node
(
&
nodeA
)
writer
false
nullptr
noGC
)
)
;
}
)
;
