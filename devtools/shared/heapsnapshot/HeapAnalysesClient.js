"
use
strict
"
;
const
DevToolsUtils
=
require
(
"
resource
:
/
/
devtools
/
shared
/
DevToolsUtils
.
js
"
)
;
const
{
DevToolsWorker
}
=
require
(
"
resource
:
/
/
devtools
/
shared
/
worker
/
worker
.
js
"
)
;
const
WORKER_URL
=
"
resource
:
/
/
devtools
/
shared
/
heapsnapshot
/
HeapAnalysesWorker
.
js
"
;
var
workerCounter
=
0
;
const
HeapAnalysesClient
=
(
module
.
exports
=
function
(
)
{
this
.
_worker
=
new
DevToolsWorker
(
WORKER_URL
{
name
:
HeapAnalyses
-
{
workerCounter
+
+
}
verbose
:
DevToolsUtils
.
dumpv
.
wantVerbose
}
)
;
}
)
;
HeapAnalysesClient
.
prototype
.
destroy
=
function
(
)
{
this
.
_worker
.
destroy
(
)
;
this
.
_worker
=
null
;
}
;
HeapAnalysesClient
.
prototype
.
readHeapSnapshot
=
function
(
snapshotFilePath
)
{
return
this
.
_worker
.
performTask
(
"
readHeapSnapshot
"
{
snapshotFilePath
}
)
;
}
;
HeapAnalysesClient
.
prototype
.
deleteHeapSnapshot
=
function
(
snapshotFilePath
)
{
return
this
.
_worker
.
performTask
(
"
deleteHeapSnapshot
"
{
snapshotFilePath
}
)
;
}
;
HeapAnalysesClient
.
prototype
.
getCreationTime
=
function
(
snapshotFilePath
)
{
return
this
.
_worker
.
performTask
(
"
getCreationTime
"
snapshotFilePath
)
;
}
;
HeapAnalysesClient
.
prototype
.
takeCensus
=
function
(
snapshotFilePath
censusOptions
requestOptions
=
{
}
)
{
return
this
.
_worker
.
performTask
(
"
takeCensus
"
{
snapshotFilePath
censusOptions
requestOptions
}
)
;
}
;
HeapAnalysesClient
.
prototype
.
getCensusIndividuals
=
function
(
opts
)
{
return
this
.
_worker
.
performTask
(
"
getCensusIndividuals
"
opts
)
;
}
;
HeapAnalysesClient
.
prototype
.
takeCensusDiff
=
function
(
firstSnapshotFilePath
secondSnapshotFilePath
censusOptions
requestOptions
=
{
}
)
{
return
this
.
_worker
.
performTask
(
"
takeCensusDiff
"
{
firstSnapshotFilePath
secondSnapshotFilePath
censusOptions
requestOptions
}
)
;
}
;
HeapAnalysesClient
.
prototype
.
computeDominatorTree
=
function
(
snapshotFilePath
)
{
return
this
.
_worker
.
performTask
(
"
computeDominatorTree
"
snapshotFilePath
)
;
}
;
HeapAnalysesClient
.
prototype
.
getDominatorTree
=
function
(
opts
)
{
return
this
.
_worker
.
performTask
(
"
getDominatorTree
"
opts
)
;
}
;
HeapAnalysesClient
.
prototype
.
getImmediatelyDominated
=
function
(
opts
)
{
return
this
.
_worker
.
performTask
(
"
getImmediatelyDominated
"
opts
)
;
}
;
