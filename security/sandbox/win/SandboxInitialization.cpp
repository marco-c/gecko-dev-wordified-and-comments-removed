#
include
"
SandboxInitialization
.
h
"
#
include
"
sandbox
/
win
/
src
/
sandbox_factory
.
h
"
namespace
mozilla
{
namespace
sandboxing
{
static
sandbox
:
:
TargetServices
*
InitializeTargetServices
(
)
{
sandbox
:
:
TargetServices
*
targetServices
=
sandbox
:
:
SandboxFactory
:
:
GetTargetServices
(
)
;
if
(
!
targetServices
)
{
return
nullptr
;
}
if
(
targetServices
-
>
Init
(
)
!
=
sandbox
:
:
SBOX_ALL_OK
)
{
return
nullptr
;
}
return
targetServices
;
}
sandbox
:
:
TargetServices
*
GetInitializedTargetServices
(
)
{
static
sandbox
:
:
TargetServices
*
sInitializedTargetServices
=
InitializeTargetServices
(
)
;
return
sInitializedTargetServices
;
}
void
LowerSandbox
(
)
{
GetInitializedTargetServices
(
)
-
>
LowerToken
(
)
;
}
}
}
