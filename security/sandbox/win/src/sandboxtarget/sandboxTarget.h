#
ifndef
__SECURITY_SANDBOX_SANDBOXTARGET_H__
#
define
__SECURITY_SANDBOX_SANDBOXTARGET_H__
#
include
<
windows
.
h
>
#
include
"
mozilla
/
Assertions
.
h
"
namespace
sandbox
{
class
TargetServices
;
}
namespace
mozilla
{
class
SandboxTarget
{
public
:
static
SandboxTarget
*
Instance
(
)
;
void
SetTargetServices
(
sandbox
:
:
TargetServices
*
aTargetServices
)
{
MOZ_ASSERT
(
aTargetServices
)
;
MOZ_ASSERT
(
!
mTargetServices
"
Sandbox
TargetServices
must
only
be
set
once
.
"
)
;
mTargetServices
=
aTargetServices
;
}
void
StartSandbox
(
)
;
bool
BrokerDuplicateHandle
(
HANDLE
aSourceHandle
DWORD
aTargetProcessId
HANDLE
*
aTargetHandle
DWORD
aDesiredAccess
DWORD
aOptions
)
;
protected
:
SandboxTarget
(
)
:
mTargetServices
(
nullptr
)
{
}
sandbox
:
:
TargetServices
*
mTargetServices
;
}
;
}
#
endif
