#
include
"
sandboxTarget
.
h
"
#
include
"
sandbox
/
win
/
src
/
sandbox
.
h
"
namespace
mozilla
{
SandboxTarget
*
SandboxTarget
:
:
Instance
(
)
{
static
SandboxTarget
sb
;
return
&
sb
;
}
void
SandboxTarget
:
:
StartSandbox
(
)
{
if
(
mTargetServices
)
{
mTargetServices
-
>
LowerToken
(
)
;
}
}
bool
SandboxTarget
:
:
BrokerDuplicateHandle
(
HANDLE
aSourceHandle
DWORD
aTargetProcessId
HANDLE
*
aTargetHandle
DWORD
aDesiredAccess
DWORD
aOptions
)
{
if
(
!
mTargetServices
)
{
return
false
;
}
sandbox
:
:
ResultCode
result
=
mTargetServices
-
>
DuplicateHandle
(
aSourceHandle
aTargetProcessId
aTargetHandle
aDesiredAccess
aOptions
)
;
return
(
sandbox
:
:
SBOX_ALL_OK
=
=
result
)
;
}
}
