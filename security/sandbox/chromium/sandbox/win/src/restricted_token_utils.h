#
ifndef
SANDBOX_SRC_RESTRICTED_TOKEN_UTILS_H__
#
define
SANDBOX_SRC_RESTRICTED_TOKEN_UTILS_H__
#
include
<
accctrl
.
h
>
#
include
<
windows
.
h
>
#
include
"
base
/
win
/
scoped_handle
.
h
"
#
include
"
sandbox
/
win
/
src
/
restricted_token
.
h
"
#
include
"
sandbox
/
win
/
src
/
security_level
.
h
"
namespace
sandbox
{
enum
TokenType
{
IMPERSONATION
=
0
PRIMARY
}
;
DWORD
CreateRestrictedToken
(
HANDLE
effective_token
TokenLevel
security_level
IntegrityLevel
integrity_level
TokenType
token_type
bool
lockdown_default_dacl
PSID
unique_restricted_sid
bool
use_restricting_sids
base
:
:
win
:
:
ScopedHandle
*
token
)
;
DWORD
SetObjectIntegrityLabel
(
HANDLE
handle
SE_OBJECT_TYPE
type
const
wchar_t
*
ace_access
const
wchar_t
*
integrity_level_sid
)
;
DWORD
SetTokenIntegrityLevel
(
HANDLE
token
IntegrityLevel
integrity_level
)
;
const
wchar_t
*
GetIntegrityLevelString
(
IntegrityLevel
integrity_level
)
;
DWORD
SetProcessIntegrityLevel
(
IntegrityLevel
integrity_level
)
;
DWORD
HardenTokenIntegrityLevelPolicy
(
HANDLE
token
)
;
DWORD
HardenProcessIntegrityLevelPolicy
(
)
;
DWORD
CreateLowBoxToken
(
HANDLE
base_token
TokenType
token_type
PSECURITY_CAPABILITIES
security_capabilities
PHANDLE
saved_handles
DWORD
saved_handles_count
base
:
:
win
:
:
ScopedHandle
*
token
)
;
DWORD
CreateLowBoxObjectDirectory
(
PSID
lowbox_sid
bool
open_directory
base
:
:
win
:
:
ScopedHandle
*
directory
)
;
}
#
endif
