#
ifndef
SANDBOX_SRC_JOB_H_
#
define
SANDBOX_SRC_JOB_H_
#
include
<
stddef
.
h
>
#
include
"
base
/
macros
.
h
"
#
include
"
base
/
win
/
scoped_handle
.
h
"
#
include
"
sandbox
/
win
/
src
/
restricted_token_utils
.
h
"
namespace
sandbox
{
class
Job
{
public
:
Job
(
)
;
~
Job
(
)
;
DWORD
Init
(
JobLevel
security_level
const
wchar_t
*
job_name
DWORD
ui_exceptions
size_t
memory_limit
)
;
DWORD
AssignProcessToJob
(
HANDLE
process_handle
)
;
DWORD
UserHandleGrantAccess
(
HANDLE
handle
)
;
base
:
:
win
:
:
ScopedHandle
Take
(
)
;
private
:
base
:
:
win
:
:
ScopedHandle
job_handle_
;
DISALLOW_COPY_AND_ASSIGN
(
Job
)
;
}
;
}
#
endif
