#
ifndef
SANDBOX_WIN_SRC_PROCESS_MITIGATIONS_H_
#
define
SANDBOX_WIN_SRC_PROCESS_MITIGATIONS_H_
#
include
<
windows
.
h
>
#
include
<
stddef
.
h
>
#
include
"
sandbox
/
win
/
src
/
security_level
.
h
"
namespace
sandbox
{
void
SetStartingMitigations
(
MitigationFlags
starting_flags
)
;
bool
RatchetDownSecurityMitigations
(
MitigationFlags
additional_flags
)
;
bool
LockDownSecurityMitigations
(
MitigationFlags
additional_flags
)
;
bool
ApplyMitigationsToCurrentThread
(
MitigationFlags
flags
)
;
MitigationFlags
FilterPostStartupProcessMitigations
(
MitigationFlags
flags
)
;
void
ConvertProcessMitigationsToPolicy
(
MitigationFlags
flags
DWORD64
*
policy_flags
size_t
*
size
)
;
void
ConvertProcessMitigationsToComponentFilter
(
MitigationFlags
flags
COMPONENT_FILTER
*
filter
)
;
bool
ApplyProcessMitigationsToSuspendedProcess
(
HANDLE
process
MitigationFlags
flags
)
;
MitigationFlags
GetAllowedPostStartupProcessMitigations
(
)
;
bool
CanSetProcessMitigationsPostStartup
(
MitigationFlags
flags
)
;
bool
CanSetProcessMitigationsPreStartup
(
MitigationFlags
flags
)
;
bool
CanSetMitigationsPerThread
(
MitigationFlags
flags
)
;
}
#
endif
