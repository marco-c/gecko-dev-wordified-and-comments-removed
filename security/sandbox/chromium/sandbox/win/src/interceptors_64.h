#
ifndef
SANDBOX_WIN_SRC_INTERCEPTORS_64_H_
#
define
SANDBOX_WIN_SRC_INTERCEPTORS_64_H_
#
include
"
sandbox
/
win
/
src
/
nt_internals
.
h
"
#
include
"
sandbox
/
win
/
src
/
sandbox_types
.
h
"
namespace
sandbox
{
extern
"
C
"
{
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtMapViewOfSection64
(
HANDLE
section
HANDLE
process
PVOID
*
base
ULONG_PTR
zero_bits
SIZE_T
commit_size
PLARGE_INTEGER
offset
PSIZE_T
view_size
SECTION_INHERIT
inherit
ULONG
allocation_type
ULONG
protect
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtUnmapViewOfSection64
(
HANDLE
process
PVOID
base
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtSetInformationThread64
(
HANDLE
thread
NT_THREAD_INFORMATION_CLASS
thread_info_class
PVOID
thread_information
ULONG
thread_information_bytes
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenThreadToken64
(
HANDLE
thread
ACCESS_MASK
desired_access
BOOLEAN
open_as_self
PHANDLE
token
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenThreadTokenEx64
(
HANDLE
thread
ACCESS_MASK
desired_access
BOOLEAN
open_as_self
ULONG
handle_attributes
PHANDLE
token
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtCreateFile64
(
PHANDLE
file
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
PIO_STATUS_BLOCK
io_status
PLARGE_INTEGER
allocation_size
ULONG
file_attributes
ULONG
sharing
ULONG
disposition
ULONG
options
PVOID
ea_buffer
ULONG
ea_length
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenFile64
(
PHANDLE
file
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
PIO_STATUS_BLOCK
io_status
ULONG
sharing
ULONG
options
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtQueryAttributesFile64
(
POBJECT_ATTRIBUTES
object_attributes
PFILE_BASIC_INFORMATION
file_attributes
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtQueryFullAttributesFile64
(
POBJECT_ATTRIBUTES
object_attributes
PFILE_NETWORK_OPEN_INFORMATION
file_attributes
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtSetInformationFile64
(
HANDLE
file
PIO_STATUS_BLOCK
io_status
PVOID
file_information
ULONG
length
FILE_INFORMATION_CLASS
file_information_class
)
;
SANDBOX_INTERCEPT
HANDLE
WINAPI
TargetCreateNamedPipeW64
(
LPCWSTR
pipe_name
DWORD
open_mode
DWORD
pipe_mode
DWORD
max_instance
DWORD
out_buffer_size
DWORD
in_buffer_size
DWORD
default_timeout
LPSECURITY_ATTRIBUTES
security_attributes
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenThread64
(
PHANDLE
thread
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
PCLIENT_ID
client_id
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenProcess64
(
PHANDLE
process
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
PCLIENT_ID
client_id
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenProcessToken64
(
HANDLE
process
ACCESS_MASK
desired_access
PHANDLE
token
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenProcessTokenEx64
(
HANDLE
process
ACCESS_MASK
desired_access
ULONG
handle_attributes
PHANDLE
token
)
;
SANDBOX_INTERCEPT
BOOL
WINAPI
TargetCreateProcessW64
(
LPCWSTR
application_name
LPWSTR
command_line
LPSECURITY_ATTRIBUTES
process_attributes
LPSECURITY_ATTRIBUTES
thread_attributes
BOOL
inherit_handles
DWORD
flags
LPVOID
environment
LPCWSTR
current_directory
LPSTARTUPINFOW
startup_info
LPPROCESS_INFORMATION
process_information
)
;
SANDBOX_INTERCEPT
BOOL
WINAPI
TargetCreateProcessA64
(
LPCSTR
application_name
LPSTR
command_line
LPSECURITY_ATTRIBUTES
process_attributes
LPSECURITY_ATTRIBUTES
thread_attributes
BOOL
inherit_handles
DWORD
flags
LPVOID
environment
LPCSTR
current_directory
LPSTARTUPINFOA
startup_info
LPPROCESS_INFORMATION
process_information
)
;
SANDBOX_INTERCEPT
HANDLE
WINAPI
TargetCreateThread64
(
LPSECURITY_ATTRIBUTES
thread_attributes
SIZE_T
stack_size
LPTHREAD_START_ROUTINE
start_address
PVOID
parameter
DWORD
creation_flags
LPDWORD
thread_id
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtCreateKey64
(
PHANDLE
key
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
ULONG
title_index
PUNICODE_STRING
class_name
ULONG
create_options
PULONG
disposition
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenKey64
(
PHANDLE
key
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenKeyEx64
(
PHANDLE
key
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
ULONG
open_options
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtCreateEvent64
(
PHANDLE
event_handle
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
EVENT_TYPE
event_type
BOOLEAN
initial_state
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetNtOpenEvent64
(
PHANDLE
event_handle
ACCESS_MASK
desired_access
POBJECT_ATTRIBUTES
object_attributes
)
;
SANDBOX_INTERCEPT
BOOL
WINAPI
TargetGdiDllInitialize64
(
HANDLE
dll
DWORD
reason
)
;
SANDBOX_INTERCEPT
HGDIOBJ
WINAPI
TargetGetStockObject64
(
int
object
)
;
SANDBOX_INTERCEPT
ATOM
WINAPI
TargetRegisterClassW64
(
const
WNDCLASS
*
wnd_class
)
;
SANDBOX_INTERCEPT
BOOL
WINAPI
TargetEnumDisplayMonitors64
(
HDC
hdc
LPCRECT
lprcClip
MONITORENUMPROC
lpfnEnum
LPARAM
dwData
)
;
SANDBOX_INTERCEPT
BOOL
WINAPI
TargetEnumDisplayDevicesA64
(
LPCSTR
lpDevice
DWORD
iDevNum
PDISPLAY_DEVICEA
lpDisplayDevice
DWORD
dwFlags
)
;
SANDBOX_INTERCEPT
BOOL
WINAPI
TargetGetMonitorInfoA64
(
HMONITOR
hMonitor
LPMONITORINFO
lpmi
)
;
SANDBOX_INTERCEPT
BOOL
WINAPI
TargetGetMonitorInfoW64
(
HMONITOR
hMonitor
LPMONITORINFO
lpmi
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetGetSuggestedOPMProtectedOutputArraySize64
(
PUNICODE_STRING
device_name
DWORD
*
suggested_output_array_size
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetCreateOPMProtectedOutputs64
(
PUNICODE_STRING
device_name
DXGKMDT_OPM_VIDEO_OUTPUT_SEMANTICS
vos
DWORD
protected_output_array_size
DWORD
*
num_output_handles
OPM_PROTECTED_OUTPUT_HANDLE
*
protected_output_array
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetGetCertificate64
(
PUNICODE_STRING
device_name
DXGKMDT_CERTIFICATE_TYPE
certificate_type
BYTE
*
certificate
ULONG
certificate_length
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetGetCertificateSize64
(
PUNICODE_STRING
device_name
DXGKMDT_CERTIFICATE_TYPE
certificate_type
ULONG
*
certificate_length
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetGetCertificateByHandle64
(
OPM_PROTECTED_OUTPUT_HANDLE
protected_output
DXGKMDT_CERTIFICATE_TYPE
certificate_type
BYTE
*
certificate
ULONG
certificate_length
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetGetCertificateSizeByHandle64
(
OPM_PROTECTED_OUTPUT_HANDLE
protected_output
DXGKMDT_CERTIFICATE_TYPE
certificate_type
ULONG
*
certificate_length
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetDestroyOPMProtectedOutput64
(
OPM_PROTECTED_OUTPUT_HANDLE
protected_output
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetGetOPMInformation64
(
OPM_PROTECTED_OUTPUT_HANDLE
protected_output
const
DXGKMDT_OPM_GET_INFO_PARAMETERS
*
parameters
DXGKMDT_OPM_REQUESTED_INFORMATION
*
requested_info
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetGetOPMRandomNumber64
(
OPM_PROTECTED_OUTPUT_HANDLE
protected_output
DXGKMDT_OPM_RANDOM_NUMBER
*
random_number
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetSetOPMSigningKeyAndSequenceNumbers64
(
OPM_PROTECTED_OUTPUT_HANDLE
protected_output
const
DXGKMDT_OPM_ENCRYPTED_PARAMETERS
*
parameters
)
;
SANDBOX_INTERCEPT
NTSTATUS
WINAPI
TargetConfigureOPMProtectedOutput64
(
OPM_PROTECTED_OUTPUT_HANDLE
protected_output
const
DXGKMDT_OPM_CONFIGURE_PARAMETERS
*
parameters
ULONG
additional_parameters_size
const
BYTE
*
additional_parameters
)
;
}
}
#
endif
