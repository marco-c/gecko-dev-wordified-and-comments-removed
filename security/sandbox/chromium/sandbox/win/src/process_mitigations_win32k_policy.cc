#
include
"
sandbox
/
win
/
src
/
process_mitigations_win32k_policy
.
h
"
#
include
<
stddef
.
h
>
#
include
"
sandbox
/
win
/
src
/
process_mitigations_win32k_interception
.
h
"
namespace
sandbox
{
bool
ProcessMitigationsWin32KLockdownPolicy
:
:
GenerateRules
(
LowLevelPolicy
*
policy
)
{
PolicyRule
rule
(
FAKE_SUCCESS
)
;
if
(
!
policy
-
>
AddRule
(
IpcTag
:
:
GDI_GDIDLLINITIALIZE
&
rule
)
)
return
false
;
if
(
!
policy
-
>
AddRule
(
IpcTag
:
:
GDI_GETSTOCKOBJECT
&
rule
)
)
return
false
;
if
(
!
policy
-
>
AddRule
(
IpcTag
:
:
USER_GETFOREGROUNDWINDOW
&
rule
)
)
return
false
;
if
(
!
policy
-
>
AddRule
(
IpcTag
:
:
USER_REGISTERCLASSW
&
rule
)
)
return
false
;
return
true
;
}
}
