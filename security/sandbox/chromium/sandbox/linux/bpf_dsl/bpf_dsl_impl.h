#
ifndef
SANDBOX_LINUX_BPF_DSL_BPF_DSL_IMPL_H_
#
define
SANDBOX_LINUX_BPF_DSL_BPF_DSL_IMPL_H_
#
include
"
base
/
macros
.
h
"
#
include
"
base
/
memory
/
ref_counted
.
h
"
#
include
"
sandbox
/
linux
/
bpf_dsl
/
codegen
.
h
"
#
include
"
sandbox
/
sandbox_export
.
h
"
namespace
sandbox
{
namespace
bpf_dsl
{
class
ErrorCode
;
class
PolicyCompiler
;
namespace
internal
{
class
BoolExprImpl
:
public
base
:
:
RefCounted
<
BoolExprImpl
>
{
public
:
virtual
CodeGen
:
:
Node
Compile
(
PolicyCompiler
*
pc
CodeGen
:
:
Node
then_node
CodeGen
:
:
Node
else_node
)
const
=
0
;
protected
:
BoolExprImpl
(
)
{
}
virtual
~
BoolExprImpl
(
)
{
}
private
:
friend
class
base
:
:
RefCounted
<
BoolExprImpl
>
;
DISALLOW_COPY_AND_ASSIGN
(
BoolExprImpl
)
;
}
;
class
ResultExprImpl
:
public
base
:
:
RefCounted
<
ResultExprImpl
>
{
public
:
virtual
CodeGen
:
:
Node
Compile
(
PolicyCompiler
*
pc
)
const
=
0
;
virtual
bool
HasUnsafeTraps
(
)
const
;
virtual
bool
IsAllow
(
)
const
;
virtual
bool
IsDeny
(
)
const
;
protected
:
ResultExprImpl
(
)
{
}
virtual
~
ResultExprImpl
(
)
{
}
private
:
friend
class
base
:
:
RefCounted
<
ResultExprImpl
>
;
DISALLOW_COPY_AND_ASSIGN
(
ResultExprImpl
)
;
}
;
}
}
}
#
endif
