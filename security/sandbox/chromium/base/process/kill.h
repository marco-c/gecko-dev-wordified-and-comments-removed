#
ifndef
BASE_PROCESS_KILL_H_
#
define
BASE_PROCESS_KILL_H_
#
include
"
base
/
files
/
file_path
.
h
"
#
include
"
base
/
process
/
process
.
h
"
#
include
"
base
/
process
/
process_handle
.
h
"
#
include
"
base
/
time
/
time
.
h
"
#
include
"
build
/
build_config
.
h
"
namespace
base
{
class
ProcessFilter
;
#
if
defined
(
OS_WIN
)
namespace
win
{
const
DWORD
kSandboxFatalMemoryExceeded
=
7012
;
const
DWORD
kNormalTerminationExitCode
=
0
;
const
DWORD
kDebuggerInactiveExitCode
=
0xC0000354
;
const
DWORD
kKeyboardInterruptExitCode
=
0xC000013A
;
const
DWORD
kDebuggerTerminatedExitCode
=
0x40010004
;
const
DWORD
kProcessKilledExitCode
=
1
;
}
#
endif
enum
TerminationStatus
{
TERMINATION_STATUS_NORMAL_TERMINATION
TERMINATION_STATUS_ABNORMAL_TERMINATION
TERMINATION_STATUS_PROCESS_WAS_KILLED
TERMINATION_STATUS_PROCESS_CRASHED
TERMINATION_STATUS_STILL_RUNNING
#
if
defined
(
OS_CHROMEOS
)
TERMINATION_STATUS_PROCESS_WAS_KILLED_BY_OOM
#
endif
#
if
defined
(
OS_ANDROID
)
TERMINATION_STATUS_OOM_PROTECTED
#
endif
TERMINATION_STATUS_LAUNCH_FAILED
TERMINATION_STATUS_OOM
TERMINATION_STATUS_MAX_ENUM
}
;
BASE_EXPORT
bool
KillProcesses
(
const
FilePath
:
:
StringType
&
executable_name
int
exit_code
const
ProcessFilter
*
filter
)
;
#
if
defined
(
OS_POSIX
)
BASE_EXPORT
bool
KillProcessGroup
(
ProcessHandle
process_group_id
)
;
#
endif
BASE_EXPORT
TerminationStatus
GetTerminationStatus
(
ProcessHandle
handle
int
*
exit_code
)
;
#
if
defined
(
OS_POSIX
)
BASE_EXPORT
TerminationStatus
GetKnownDeadTerminationStatus
(
ProcessHandle
handle
int
*
exit_code
)
;
#
if
defined
(
OS_LINUX
)
BASE_EXPORT
void
EnsureProcessGetsReaped
(
Process
process
)
;
#
endif
#
endif
BASE_EXPORT
void
EnsureProcessTerminated
(
Process
process
)
;
#
if
!
defined
(
OS_FUCHSIA
)
BASE_EXPORT
bool
WaitForProcessesToExit
(
const
FilePath
:
:
StringType
&
executable_name
base
:
:
TimeDelta
wait
const
ProcessFilter
*
filter
)
;
BASE_EXPORT
bool
CleanupProcesses
(
const
FilePath
:
:
StringType
&
executable_name
base
:
:
TimeDelta
wait
int
exit_code
const
ProcessFilter
*
filter
)
;
#
endif
}
#
endif
