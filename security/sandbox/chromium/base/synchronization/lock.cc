#
include
"
base
/
synchronization
/
lock
.
h
"
#
if
DCHECK_IS_ON
(
)
#
include
"
base
/
threading
/
platform_thread
.
h
"
#
endif
#
if
DCHECK_IS_ON
(
)
namespace
base
{
Lock
:
:
Lock
(
)
:
lock_
(
)
{
}
Lock
:
:
~
Lock
(
)
{
DCHECK
(
owning_thread_ref_
.
is_null
(
)
)
;
}
void
Lock
:
:
AssertAcquired
(
)
const
{
DCHECK_EQ
(
owning_thread_ref_
PlatformThread
:
:
CurrentRef
(
)
)
;
}
void
Lock
:
:
AssertNotHeld
(
)
const
{
DCHECK
(
owning_thread_ref_
.
is_null
(
)
)
;
}
void
Lock
:
:
CheckHeldAndUnmark
(
)
{
DCHECK_EQ
(
owning_thread_ref_
PlatformThread
:
:
CurrentRef
(
)
)
;
owning_thread_ref_
=
PlatformThreadRef
(
)
;
}
void
Lock
:
:
CheckUnheldAndMark
(
)
{
DCHECK
(
owning_thread_ref_
.
is_null
(
)
)
;
owning_thread_ref_
=
PlatformThread
:
:
CurrentRef
(
)
;
}
}
#
endif
