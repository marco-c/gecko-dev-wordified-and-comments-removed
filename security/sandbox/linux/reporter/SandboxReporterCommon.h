#
ifndef
mozilla_SandboxReporterCommon_h
#
define
mozilla_SandboxReporterCommon_h
#
include
"
mozilla
/
IntegerTypeTraits
.
h
"
#
include
"
mozilla
/
Types
.
h
"
#
include
<
sys
/
types
.
h
>
namespace
mozilla
{
static
const
size_t
kSandboxSyscallArguments
=
6
;
static
const
int
kSandboxReporterFileDesc
=
5
;
struct
SandboxReport
{
enum
class
ProcType
:
uint8_t
{
CONTENT
FILE
MEDIA_PLUGIN
RDD
SOCKET_PROCESS
}
;
using
ULong
=
UnsignedStdintTypeForSize
<
sizeof
(
unsigned
long
)
>
:
:
Type
;
struct
timespec
mTime
;
pid_t
mPid
;
pid_t
mTid
;
ProcType
mProcType
;
ULong
mSyscall
;
ULong
mArgs
[
kSandboxSyscallArguments
]
;
SandboxReport
(
)
:
mPid
(
0
)
{
}
bool
IsValid
(
)
const
{
return
mPid
>
0
;
}
}
;
}
#
endif
