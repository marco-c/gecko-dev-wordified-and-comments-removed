#
ifndef
mozilla_SandboxBrokerPolicyFactory_h
#
define
mozilla_SandboxBrokerPolicyFactory_h
#
include
"
mozilla
/
SandboxBroker
.
h
"
#
include
<
mutex
>
namespace
mozilla
{
class
SandboxBrokerPolicyFactory
{
public
:
SandboxBrokerPolicyFactory
(
)
=
default
;
UniquePtr
<
SandboxBroker
:
:
Policy
>
GetContentPolicy
(
int
aPid
bool
aFileProcess
)
;
static
UniquePtr
<
SandboxBroker
:
:
Policy
>
GetRDDPolicy
(
int
aPid
)
;
static
UniquePtr
<
SandboxBroker
:
:
Policy
>
GetSocketProcessPolicy
(
int
aPid
)
;
static
UniquePtr
<
SandboxBroker
:
:
Policy
>
GetUtilityProcessPolicy
(
int
aPid
)
;
private
:
UniquePtr
<
const
SandboxBroker
:
:
Policy
>
mCommonContentPolicy
;
std
:
:
once_flag
mContentInited
;
void
InitContentPolicy
(
)
;
}
;
}
#
endif
