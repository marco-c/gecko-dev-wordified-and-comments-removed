#
ifndef
mozilla_SandboxBrokerCommon_h
#
define
mozilla_SandboxBrokerCommon_h
#
include
<
sys
/
types
.
h
>
#
include
<
stdint
.
h
>
struct
iovec
;
namespace
mozilla
{
class
SandboxBrokerCommon
{
public
:
enum
Operation
{
SANDBOX_FILE_OPEN
SANDBOX_FILE_ACCESS
SANDBOX_FILE_STAT
SANDBOX_FILE_CHMOD
SANDBOX_FILE_LINK
SANDBOX_FILE_SYMLINK
SANDBOX_FILE_MKDIR
SANDBOX_FILE_RENAME
SANDBOX_FILE_RMDIR
SANDBOX_FILE_UNLINK
SANDBOX_FILE_READLINK
SANDBOX_SOCKET_CONNECT
SANDBOX_SOCKET_CONNECT_ABSTRACT
}
;
static
const
char
*
OperationDescription
[
]
;
struct
Request
{
Operation
mOp
;
int
mFlags
;
uint64_t
mId
;
size_t
mBufSize
;
}
;
struct
Response
{
int
mError
;
}
;
static
const
size_t
kMaxPathLen
=
4096
;
static
ssize_t
RecvWithFd
(
int
aFd
const
iovec
*
aIO
size_t
aNumIO
int
*
aPassedFdPtr
)
;
static
ssize_t
SendWithFd
(
int
aFd
const
iovec
*
aIO
size_t
aNumIO
int
aPassedFd
)
;
}
;
}
#
endif
