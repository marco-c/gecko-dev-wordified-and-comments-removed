#
ifndef
mozilla_Sandbox_h
#
define
mozilla_Sandbox_h
#
include
"
mozilla
/
Types
.
h
"
#
include
"
nsXULAppAPI
.
h
"
#
include
<
vector
>
namespace
mozilla
{
namespace
ipc
{
class
FileDescriptor
;
}
MOZ_EXPORT
void
SandboxEarlyInit
(
)
;
#
ifdef
MOZ_CONTENT_SANDBOX
struct
ContentProcessSandboxParams
{
int
mLevel
=
0
;
int
mBrokerFd
=
-
1
;
bool
mFileProcess
=
false
;
std
:
:
vector
<
int
>
mSyscallWhitelist
;
static
ContentProcessSandboxParams
ForThisProcess
(
const
Maybe
<
ipc
:
:
FileDescriptor
>
&
aBroker
)
;
}
;
MOZ_EXPORT
bool
SetContentProcessSandbox
(
ContentProcessSandboxParams
&
&
aParams
)
;
#
endif
#
ifdef
MOZ_GMP_SANDBOX
MOZ_EXPORT
void
SetMediaPluginSandbox
(
const
char
*
aFilePath
)
;
#
endif
MOZ_EXPORT
void
SetRemoteDataDecoderSandbox
(
int
aBroker
)
;
}
#
endif
