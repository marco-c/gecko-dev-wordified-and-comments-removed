#
ifndef
scoped_ptrs_smime_h__
#
define
scoped_ptrs_smime_h__
#
include
<
memory
>
#
include
"
smime
.
h
"
struct
ScopedDeleteSmime
{
void
operator
(
)
(
NSSCMSMessage
*
id
)
{
NSS_CMSMessage_Destroy
(
id
)
;
}
}
;
template
<
class
T
>
struct
ScopedMaybeDeleteSmime
{
void
operator
(
)
(
T
*
ptr
)
{
if
(
ptr
)
{
ScopedDeleteSmime
del
;
del
(
ptr
)
;
}
}
}
;
#
define
SCOPED
(
x
)
\
typedef
std
:
:
unique_ptr
<
x
ScopedMaybeDeleteSmime
<
x
>
>
Scoped
#
#
x
SCOPED
(
NSSCMSMessage
)
;
#
undef
SCOPED
#
endif
