#
include
"
mpi_helper
.
h
"
extern
"
C
"
int
LLVMFuzzerTestOneInput
(
const
uint8_t
*
data
size_t
size
)
{
if
(
size
<
3
)
{
return
0
;
}
INIT_NUMBERS
assert
(
mp_add
(
&
a
&
b
&
c
)
=
=
MP_OKAY
)
;
(
void
)
BN_add
(
C
A
B
)
;
check_equal
(
C
&
c
max_size
)
;
mp_neg
(
&
b
&
b
)
;
assert
(
mp_sub
(
&
a
&
b
&
r
)
=
=
MP_OKAY
)
;
bool
eq
=
mp_cmp
(
&
r
&
c
)
=
=
0
;
if
(
!
eq
)
{
char
rC
[
max_size
]
cC
[
max_size
]
aC
[
max_size
]
bC
[
max_size
]
;
mp_tohex
(
&
r
rC
)
;
mp_tohex
(
&
c
cC
)
;
mp_tohex
(
&
a
aC
)
;
mp_tohex
(
&
b
bC
)
;
std
:
:
cout
<
<
"
a
=
"
<
<
std
:
:
hex
<
<
aC
<
<
std
:
:
endl
;
std
:
:
cout
<
<
"
-
b
=
"
<
<
std
:
:
hex
<
<
bC
<
<
std
:
:
endl
;
std
:
:
cout
<
<
"
a
+
b
=
"
<
<
std
:
:
hex
<
<
cC
<
<
std
:
:
endl
;
std
:
:
cout
<
<
"
a
-
-
b
=
"
<
<
std
:
:
hex
<
<
rC
<
<
std
:
:
endl
;
}
assert
(
eq
)
;
CLEANUP_AND_RETURN
}
