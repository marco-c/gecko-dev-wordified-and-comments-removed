#
include
"
tls_client_config
.
h
"
const
uint64_t
CONFIG_FAIL_CERT_AUTH
=
1
;
const
uint64_t
CONFIG_ENABLE_EXTENDED_MS
=
2
;
const
uint64_t
CONFIG_REQUIRE_DH_NAMED_GROUPS
=
4
;
const
uint64_t
CONFIG_ENABLE_FALSE_START
=
8
;
ClientConfig
:
:
ClientConfig
(
const
uint8_t
*
data
size_t
len
)
{
for
(
size_t
i
=
0
;
i
<
len
;
i
+
+
)
{
config_
^
=
static_cast
<
uint64_t
>
(
data
[
i
]
)
<
<
(
8
*
(
i
%
8
)
)
;
}
}
bool
ClientConfig
:
:
FailCertificateAuthentication
(
)
{
return
config_
&
CONFIG_FAIL_CERT_AUTH
;
}
bool
ClientConfig
:
:
EnableExtendedMasterSecret
(
)
{
return
config_
&
CONFIG_ENABLE_EXTENDED_MS
;
}
bool
ClientConfig
:
:
RequireDhNamedGroups
(
)
{
return
config_
&
CONFIG_REQUIRE_DH_NAMED_GROUPS
;
}
bool
ClientConfig
:
:
EnableFalseStart
(
)
{
return
config_
&
CONFIG_ENABLE_FALSE_START
;
}
