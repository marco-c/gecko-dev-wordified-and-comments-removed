#
ifndef
_RIJNDAEL_H_
#
define
_RIJNDAEL_H_
1
#
include
"
blapii
.
h
"
#
include
<
stdint
.
h
>
#
ifdef
NSS_X86_OR_X64
#
include
<
wmmintrin
.
h
>
#
endif
typedef
void
AESBlockFunc
(
AESContext
*
cx
unsigned
char
*
output
const
unsigned
char
*
input
)
;
#
define
RIJNDAEL_NUM_ROUNDS
(
Nk
Nb
)
\
(
PR_MAX
(
Nk
Nb
)
+
6
)
#
define
RIJNDAEL_MAX_EXP_KEY_SIZE
(
4
*
15
)
struct
AESContextStr
{
union
{
#
if
defined
(
NSS_X86_OR_X64
)
__m128i
keySchedule
[
15
]
;
#
endif
PRUint32
expandedKey
[
RIJNDAEL_MAX_EXP_KEY_SIZE
]
;
}
;
unsigned
int
Nb
;
unsigned
int
Nr
;
freeblCipherFunc
worker
;
unsigned
char
iv
[
AES_BLOCK_SIZE
]
;
freeblDestroyFunc
destroy
;
void
*
worker_cx
;
PRBool
isBlock
;
int
mode
;
void
*
mem
;
}
;
#
endif
