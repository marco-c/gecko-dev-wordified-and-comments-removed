#
ifdef
FREEBL_NO_DEPEND
#
include
"
stubs
.
h
"
#
endif
#
include
"
crypto_primitives
.
h
"
#
if
defined
(
__GNUC__
)
&
&
(
defined
(
__x86_64__
)
|
|
defined
(
__x86_64
)
)
__inline__
PRUint64
swap8b
(
PRUint64
value
)
{
__asm__
(
"
bswapq
%
0
"
:
"
+
r
"
(
value
)
)
;
return
(
value
)
;
}
#
elif
defined
(
IS_LITTLE_ENDIAN
)
&
&
!
defined
(
_MSC_VER
)
&
&
!
__has_builtin
(
__builtin_bswap64
)
&
&
!
(
(
defined
(
__GNUC__
)
&
&
(
__GNUC__
>
4
|
|
(
__GNUC__
=
=
4
&
&
__GNUC_MINOR__
>
=
3
)
)
)
)
PRUint64
swap8b
(
PRUint64
x
)
{
PRUint64
t1
=
x
;
t1
=
(
(
t1
&
SHA_MASK8
)
<
<
8
)
|
(
(
t1
>
>
8
)
&
SHA_MASK8
)
;
t1
=
(
(
t1
&
SHA_MASK16
)
<
<
16
)
|
(
(
t1
>
>
16
)
&
SHA_MASK16
)
;
return
(
t1
>
>
32
)
|
(
t1
<
<
32
)
;
}
#
endif
