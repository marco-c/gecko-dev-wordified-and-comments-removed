#
include
"
libcrux_mlkem768_portable
.
h
"
#
include
"
internal
/
libcrux_mlkem_portable
.
h
"
static
void
decapsulate_67
(
libcrux_ml_kem_types_MlKemPrivateKey_55
*
private_key
libcrux_ml_kem_mlkem768_MlKem768Ciphertext
*
ciphertext
uint8_t
ret
[
32U
]
)
{
libcrux_ml_kem_ind_cca_decapsulate_1f
(
private_key
ciphertext
ret
)
;
}
void
libcrux_ml_kem_mlkem768_portable_decapsulate
(
libcrux_ml_kem_types_MlKemPrivateKey_55
*
private_key
libcrux_ml_kem_mlkem768_MlKem768Ciphertext
*
ciphertext
uint8_t
ret
[
32U
]
)
{
decapsulate_67
(
private_key
ciphertext
ret
)
;
}
static
tuple_3c
encapsulate_02
(
libcrux_ml_kem_types_MlKemPublicKey_15
*
public_key
uint8_t
randomness
[
32U
]
)
{
libcrux_ml_kem_types_MlKemPublicKey_15
*
uu____0
=
public_key
;
uint8_t
copy_of_randomness
[
32U
]
;
memcpy
(
copy_of_randomness
randomness
(
size_t
)
32U
*
sizeof
(
uint8_t
)
)
;
return
libcrux_ml_kem_ind_cca_encapsulate_eb
(
uu____0
copy_of_randomness
)
;
}
tuple_3c
libcrux_ml_kem_mlkem768_portable_encapsulate
(
libcrux_ml_kem_types_MlKemPublicKey_15
*
public_key
uint8_t
randomness
[
32U
]
)
{
libcrux_ml_kem_types_MlKemPublicKey_15
*
uu____0
=
public_key
;
uint8_t
copy_of_randomness
[
32U
]
;
memcpy
(
copy_of_randomness
randomness
(
size_t
)
32U
*
sizeof
(
uint8_t
)
)
;
return
encapsulate_02
(
uu____0
copy_of_randomness
)
;
}
static
libcrux_ml_kem_mlkem768_MlKem768KeyPair
generate_keypair_87
(
uint8_t
randomness
[
64U
]
)
{
uint8_t
copy_of_randomness
[
64U
]
;
memcpy
(
copy_of_randomness
randomness
(
size_t
)
64U
*
sizeof
(
uint8_t
)
)
;
return
libcrux_ml_kem_ind_cca_generate_keypair_f6
(
copy_of_randomness
)
;
}
libcrux_ml_kem_mlkem768_MlKem768KeyPair
libcrux_ml_kem_mlkem768_portable_generate_key_pair
(
uint8_t
randomness
[
64U
]
)
{
uint8_t
copy_of_randomness
[
64U
]
;
memcpy
(
copy_of_randomness
randomness
(
size_t
)
64U
*
sizeof
(
uint8_t
)
)
;
return
generate_keypair_87
(
copy_of_randomness
)
;
}
static
KRML_MUSTINLINE
bool
validate_private_key_e8
(
libcrux_ml_kem_types_MlKemPrivateKey_55
*
private_key
libcrux_ml_kem_mlkem768_MlKem768Ciphertext
*
ciphertext
)
{
return
libcrux_ml_kem_ind_cca_validate_private_key_05
(
private_key
ciphertext
)
;
}
bool
libcrux_ml_kem_mlkem768_portable_validate_private_key
(
libcrux_ml_kem_types_MlKemPrivateKey_55
*
private_key
libcrux_ml_kem_mlkem768_MlKem768Ciphertext
*
ciphertext
)
{
return
validate_private_key_e8
(
private_key
ciphertext
)
;
}
static
KRML_MUSTINLINE
bool
validate_public_key_7d
(
uint8_t
*
public_key
)
{
return
libcrux_ml_kem_ind_cca_validate_public_key_b7
(
public_key
)
;
}
bool
libcrux_ml_kem_mlkem768_portable_validate_public_key
(
libcrux_ml_kem_types_MlKemPublicKey_15
*
public_key
)
{
return
validate_public_key_7d
(
public_key
-
>
value
)
;
}
