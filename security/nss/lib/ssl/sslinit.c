#
include
"
prtypes
.
h
"
#
include
"
prinit
.
h
"
#
include
"
seccomon
.
h
"
#
include
"
secerr
.
h
"
#
include
"
ssl
.
h
"
#
include
"
sslimpl
.
h
"
#
include
"
sslproto
.
h
"
static
int
ssl_isInited
=
0
;
static
PRCallOnceType
ssl_init
=
{
0
}
;
PRStatus
ssl_InitCallOnce
(
void
*
arg
)
{
int
*
error
=
(
int
*
)
arg
;
SECStatus
rv
;
rv
=
ssl_InitializePRErrorTable
(
)
;
if
(
rv
!
=
SECSuccess
)
{
*
error
=
SEC_ERROR_NO_MEMORY
;
return
PR_FAILURE
;
}
#
ifdef
DEBUG
ssl3_CheckCipherSuiteOrderConsistency
(
)
;
#
endif
rv
=
ssl3_ApplyNSSPolicy
(
)
;
if
(
rv
!
=
SECSuccess
)
{
*
error
=
PORT_GetError
(
)
;
return
PR_FAILURE
;
}
return
PR_SUCCESS
;
}
SECStatus
ssl_Init
(
void
)
{
PRStatus
nrv
;
if
(
!
ssl_isInited
)
{
int
error
;
nrv
=
PR_CallOnceWithArg
(
&
ssl_init
ssl_InitCallOnce
&
error
)
;
if
(
nrv
!
=
PR_SUCCESS
)
{
PORT_SetError
(
error
)
;
return
SECFailure
;
}
ssl_isInited
=
1
;
}
return
SECSuccess
;
}
