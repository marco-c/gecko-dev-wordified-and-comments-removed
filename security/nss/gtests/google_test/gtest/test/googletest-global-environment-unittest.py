"
"
"
Unit
test
for
Google
Test
'
s
global
test
environment
behavior
.
A
user
can
specify
a
global
test
environment
via
testing
:
:
AddGlobalTestEnvironment
.
Failures
in
the
global
environment
should
result
in
all
unit
tests
being
skipped
.
This
script
tests
such
functionality
by
invoking
googletest
-
global
-
environment
-
unittest_
(
a
program
written
with
Google
Test
)
.
"
"
"
import
gtest_test_utils
def
RunAndReturnOutput
(
)
:
  
"
"
"
Runs
the
test
program
and
returns
its
output
.
"
"
"
  
return
gtest_test_utils
.
Subprocess
(
[
      
gtest_test_utils
.
GetTestExecutablePath
(
          
'
googletest
-
global
-
environment
-
unittest_
'
)
  
]
)
.
output
class
GTestGlobalEnvironmentUnitTest
(
gtest_test_utils
.
TestCase
)
:
  
"
"
"
Tests
global
test
environment
failures
.
"
"
"
  
def
testEnvironmentSetUpFails
(
self
)
:
    
"
"
"
Tests
the
behavior
of
not
specifying
the
fail_fast
.
"
"
"
    
txt
=
RunAndReturnOutput
(
)
    
self
.
assertIn
(
'
Canned
environment
setup
error
'
txt
)
    
self
.
assertIn
(
'
[
SKIPPED
]
1
test
'
txt
)
    
self
.
assertIn
(
'
[
PASSED
]
0
tests
'
txt
)
    
self
.
assertNotIn
(
'
Unexpected
call
'
txt
)
if
__name__
=
=
'
__main__
'
:
  
gtest_test_utils
.
Main
(
)
