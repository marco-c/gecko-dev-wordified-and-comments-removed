#
include
"
blapi
.
h
"
#
include
"
gtest
/
gtest
.
h
"
namespace
nss_test
{
class
DHTest
:
public
:
:
testing
:
:
Test
{
protected
:
void
TestGenParamSuccess
(
int
size
)
{
DHParams
*
params
;
for
(
int
i
=
0
;
i
<
10
;
i
+
+
)
{
EXPECT_EQ
(
SECSuccess
DH_GenParam
(
size
&
params
)
)
;
PORT_FreeArena
(
params
-
>
arena
PR_TRUE
)
;
}
}
}
;
TEST_F
(
DHTest
DhGenParamSuccessTest16
)
{
TestGenParamSuccess
(
16
)
;
}
TEST_F
(
DHTest
DhGenParamSuccessTest224
)
{
TestGenParamSuccess
(
224
)
;
}
TEST_F
(
DHTest
DhGenParamSuccessTest256
)
{
TestGenParamSuccess
(
256
)
;
}
}
