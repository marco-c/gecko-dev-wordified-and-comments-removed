#
include
"
libssl_internals
.
h
"
#
include
"
seccomon
.
h
"
#
include
"
ssl
.
h
"
#
include
"
sslimpl
.
h
"
SECStatus
SSLInt_IncrementClientHandshakeVersion
(
PRFileDesc
*
fd
)
{
sslSocket
*
ss
=
(
sslSocket
*
)
fd
-
>
secret
;
if
(
!
ss
)
{
return
SECFailure
;
}
+
+
ss
-
>
clientHelloVersion
;
return
SECSuccess
;
}
PRUint32
SSLInt_DetermineKEABits
(
PRUint16
serverKeyBits
SSLAuthType
authAlgorithm
)
{
if
(
authAlgorithm
=
=
ssl_auth_ecdsa
)
{
return
serverKeyBits
;
}
PORT_Assert
(
authAlgorithm
=
=
ssl_auth_rsa
)
;
PRUint32
minKeaBits
;
#
ifdef
NSS_ECC_MORE_THAN_SUITE_B
minKeaBits
=
192U
;
#
else
minKeaBits
=
256U
;
#
endif
return
PR_MAX
(
SSL_RSASTRENGTH_TO_ECSTRENGTH
(
serverKeyBits
)
minKeaBits
)
;
}
