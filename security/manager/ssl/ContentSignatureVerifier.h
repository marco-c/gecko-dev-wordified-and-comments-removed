#
ifndef
ContentSignatureVerifier_h
#
define
ContentSignatureVerifier_h
#
include
"
nsIContentSignatureVerifier
.
h
"
#
include
"
nsString
.
h
"
#
define
NS_CONTENTSIGNATUREVERIFIER_CID
\
{
\
0x45a5fe2f
0xc350
0x4b86
{
\
0x96
0x2d
0x02
0xd5
0xaa
0xaa
0x95
0x5a
\
}
\
}
#
define
NS_CONTENTSIGNATUREVERIFIER_CONTRACTID
\
"
mozilla
.
org
/
security
/
contentsignatureverifier
;
1
"
class
ContentSignatureVerifier
final
:
public
nsIContentSignatureVerifier
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSICONTENTSIGNATUREVERIFIER
private
:
~
ContentSignatureVerifier
(
)
=
default
;
nsresult
VerifyContentSignatureInternal
(
const
nsACString
&
aData
const
nsACString
&
aCSHeader
const
nsACString
&
aCertChain
const
nsACString
&
aHostname
mozilla
:
:
Telemetry
:
:
LABELS_CONTENT_SIGNATURE_VERIFICATION_ERRORS
&
aErrorLabel
nsACString
&
aCertFingerprint
uint32_t
&
aErrorValue
)
;
nsresult
ParseContentSignatureHeader
(
const
nsACString
&
aContentSignatureHeader
nsCString
&
aSignature
)
;
}
;
#
endif
