#
ifndef
ContentSignatureVerifier_h
#
define
ContentSignatureVerifier_h
#
include
"
cert
.
h
"
#
include
"
CSTrustDomain
.
h
"
#
include
"
nsIContentSignatureVerifier
.
h
"
#
include
"
nsNSSShutDown
.
h
"
#
include
"
ScopedNSSTypes
.
h
"
#
define
NS_CONTENTSIGNATUREVERIFIER_CID
\
{
0x45a5fe2f
0xc350
0x4b86
\
{
0x96
0x2d
0x02
0xd5
0xaa
0xaa
0x95
0x5a
}
}
#
define
NS_CONTENTSIGNATUREVERIFIER_CONTRACTID
\
"
mozilla
.
org
/
security
/
contentsignatureverifier
;
1
"
class
ContentSignatureVerifier
final
:
public
nsIContentSignatureVerifier
public
nsNSSShutDownObject
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSICONTENTSIGNATUREVERIFIER
ContentSignatureVerifier
(
)
:
mCx
(
nullptr
)
mMutex
(
"
CSVerifier
:
:
mMutex
"
)
{
}
virtual
void
virtualDestroyNSSReference
(
)
override
{
destructorSafeDestroyNSSReference
(
)
;
}
private
:
~
ContentSignatureVerifier
(
)
;
nsresult
UpdateInternal
(
const
nsACString
&
aData
MutexAutoLock
&
const
nsNSSShutDownPreventionLock
&
)
;
void
destructorSafeDestroyNSSReference
(
)
{
mCx
=
nullptr
;
mKey
=
nullptr
;
}
nsresult
ParseContentSignatureHeader
(
const
nsACString
&
aContentSignatureHeader
)
;
mozilla
:
:
UniqueVFYContext
mCx
;
nsCString
mSignature
;
mozilla
:
:
UniqueSECKEYPublicKey
mKey
;
mozilla
:
:
Mutex
mMutex
;
}
;
#
endif
