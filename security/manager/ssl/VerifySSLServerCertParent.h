#
ifndef
mozilla_psm_VerifySSLServerCertParent_h__
#
define
mozilla_psm_VerifySSLServerCertParent_h__
#
include
"
mozilla
/
psm
/
PVerifySSLServerCertParent
.
h
"
#
include
"
mozpkix
/
Time
.
h
"
#
include
"
ScopedNSSTypes
.
h
"
#
include
"
SharedCertVerifier
.
h
"
class
nsNSSSocketInfo
;
namespace
mozilla
{
namespace
psm
{
class
VerifySSLServerCertParent
:
public
PVerifySSLServerCertParent
{
public
:
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
VerifySSLServerCertParent
override
)
VerifySSLServerCertParent
(
)
;
bool
Dispatch
(
nsTArray
<
ByteArray
>
&
&
aPeerCertChain
const
nsACString
&
aHostName
const
int32_t
&
aPort
const
OriginAttributes
&
aOriginAttributes
const
Maybe
<
ByteArray
>
&
aStapledOCSPResponse
const
Maybe
<
ByteArray
>
&
aSctsFromTLSExtension
const
Maybe
<
DelegatedCredentialInfoArg
>
&
aDcInfo
const
uint32_t
&
aProviderFlags
const
uint32_t
&
aCertVerifierFlags
)
;
void
OnVerifiedSSLServerCert
(
const
nsTArray
<
ByteArray
>
&
aBuiltCertChain
uint16_t
aCertificateTransparencyStatus
uint8_t
aEVStatus
bool
aSucceeded
PRErrorCode
aFinalError
uint32_t
aOverridableErrorCategory
bool
aIsBuiltCertChainRootBuiltInRoot
)
;
private
:
virtual
~
VerifySSLServerCertParent
(
)
;
void
ActorDestroy
(
ActorDestroyReason
aWhy
)
override
;
nsCOMPtr
<
nsIEventTarget
>
mBackgroundThread
;
}
;
}
}
#
endif
