"
use
strict
"
;
function
run_test
(
)
{
let
SSService
=
Cc
[
"
mozilla
.
org
/
ssservice
;
1
"
]
.
getService
(
Ci
.
nsISiteSecurityService
)
;
let
uri
=
Services
.
io
.
newURI
(
"
https
:
/
/
includesubdomains
.
preloaded
.
test
"
)
;
ok
(
SSService
.
isSecureURI
(
uri
)
)
;
let
longUri
=
Services
.
io
.
newURI
(
"
https
:
/
/
a
.
b
.
c
.
d
.
e
.
f
.
g
.
h
.
i
.
j
.
k
.
l
.
m
.
n
.
o
.
p
.
q
.
r
.
s
.
t
.
u
.
v
.
w
.
x
.
y
.
z
.
a
.
b
.
c
.
d
.
e
.
f
.
g
.
h
.
i
.
j
.
k
.
l
.
m
.
n
.
o
.
p
.
q
.
r
.
s
.
t
.
u
.
v
.
w
.
x
.
y
.
z
.
a
.
b
.
c
.
d
.
e
.
f
.
g
.
h
.
i
.
j
.
k
.
l
.
m
.
n
.
o
.
p
.
q
.
r
.
s
.
t
.
u
.
v
.
w
.
x
.
y
.
z
.
a
.
b
.
c
.
d
.
e
.
f
.
g
.
h
.
i
.
j
.
k
.
l
.
m
.
n
.
o
.
p
.
q
.
r
.
s
.
t
.
u
.
v
.
w
.
x
.
y
.
z
.
a
.
b
.
c
.
d
.
e
.
f
.
g
.
includesubdomains
.
preloaded
.
test
"
)
;
ok
(
!
SSService
.
isSecureURI
(
longUri
)
)
;
let
offsetSeconds
=
19
*
7
*
24
*
60
*
60
;
Services
.
prefs
.
setIntPref
(
"
test
.
currentTimeOffsetSeconds
"
offsetSeconds
)
;
ok
(
!
SSService
.
isSecureURI
(
uri
)
)
;
Services
.
prefs
.
clearUserPref
(
"
test
.
currentTimeOffsetSeconds
"
)
;
ok
(
SSService
.
isSecureURI
(
uri
)
)
;
}
