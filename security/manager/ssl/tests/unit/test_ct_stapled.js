"
use
strict
"
;
do_get_profile
(
)
;
function
run_test
(
)
{
Services
.
prefs
.
setIntPref
(
"
security
.
pki
.
certificate_transparency
.
mode
"
1
)
;
let
rootCert
=
constructCertFromFile
(
"
test_ct
/
test
-
ca
.
pem
"
)
;
Services
.
prefs
.
setCharPref
(
"
security
.
test
.
built_in_root_hash
"
rootCert
.
sha256Fingerprint
)
;
add_tls_server_setup
(
"
OCSPStaplingServer
"
"
test_ct
"
)
;
add_ct_test
(
"
ct
-
via
-
ocsp
.
example
.
com
"
Ci
.
nsITransportSecurityInfo
.
CERTIFICATE_TRANSPARENCY_POLICY_COMPLIANT
)
;
add_ct_test
(
"
ct
-
via
-
tls
.
example
.
com
"
Ci
.
nsITransportSecurityInfo
.
CERTIFICATE_TRANSPARENCY_POLICY_COMPLIANT
)
;
add_ct_test
(
"
ct
-
tampered
.
example
.
com
"
Ci
.
nsITransportSecurityInfo
.
CERTIFICATE_TRANSPARENCY_POLICY_NOT_ENOUGH_SCTS
)
;
run_next_test
(
)
;
}
