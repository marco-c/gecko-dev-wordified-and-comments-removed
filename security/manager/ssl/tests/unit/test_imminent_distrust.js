"
use
strict
"
;
function
shouldBeImminentlyDistrusted
(
aTransportSecurityInfo
)
{
let
isDistrust
=
aTransportSecurityInfo
.
securityState
&
Ci
.
nsIWebProgressListener
.
STATE_CERT_DISTRUST_IMMINENT
;
Assert
.
ok
(
isDistrust
"
This
host
should
be
imminently
distrusted
"
)
;
}
function
shouldNotBeImminentlyDistrusted
(
aTransportSecurityInfo
)
{
let
isDistrust
=
aTransportSecurityInfo
.
securityState
&
Ci
.
nsIWebProgressListener
.
STATE_CERT_DISTRUST_IMMINENT
;
Assert
.
ok
(
!
isDistrust
"
This
host
should
not
be
imminently
distrusted
"
)
;
}
do_get_profile
(
)
;
add_tls_server_setup
(
"
BadCertAndPinningServer
"
"
bad_certs
"
)
;
add_connection_test
(
"
imminently
-
distrusted
.
example
.
com
"
PRErrorCodeSuccess
null
shouldBeImminentlyDistrusted
)
;
add_connection_test
(
"
include
-
subdomains
.
pinning
.
example
.
com
"
PRErrorCodeSuccess
null
shouldNotBeImminentlyDistrusted
)
;
