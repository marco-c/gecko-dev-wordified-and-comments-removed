"
use
strict
"
;
function
run_test
(
)
{
let
SSService
=
Cc
[
"
mozilla
.
org
/
ssservice
;
1
"
]
.
getService
(
Ci
.
nsISiteSecurityService
)
;
ok
(
!
SSService
.
isSecureURI
(
Ci
.
nsISiteSecurityService
.
HEADER_HSTS
Services
.
io
.
newURI
(
"
https
:
/
/
chart
.
apis
.
google
.
com
"
)
0
)
)
;
ok
(
!
SSService
.
isSecureURI
(
Ci
.
nsISiteSecurityService
.
HEADER_HSTS
Services
.
io
.
newURI
(
"
https
:
/
/
CHART
.
APIS
.
GOOGLE
.
COM
"
)
0
)
)
;
ok
(
!
SSService
.
isSecureURI
(
Ci
.
nsISiteSecurityService
.
HEADER_HSTS
Services
.
io
.
newURI
(
"
https
:
/
/
sub
.
chart
.
apis
.
google
.
com
"
)
0
)
)
;
ok
(
!
SSService
.
isSecureURI
(
Ci
.
nsISiteSecurityService
.
HEADER_HSTS
Services
.
io
.
newURI
(
"
https
:
/
/
SUB
.
CHART
.
APIS
.
GOOGLE
.
COM
"
)
0
)
)
;
ok
(
SSService
.
isSecureURI
(
Ci
.
nsISiteSecurityService
.
HEADER_HSTS
Services
.
io
.
newURI
(
"
https
:
/
/
example
.
apis
.
google
.
com
"
)
0
)
)
;
ok
(
SSService
.
isSecureURI
(
Ci
.
nsISiteSecurityService
.
HEADER_HSTS
Services
.
io
.
newURI
(
"
https
:
/
/
EXAMPLE
.
APIS
.
GOOGLE
.
COM
"
)
0
)
)
;
ok
(
SSService
.
isSecureURI
(
Ci
.
nsISiteSecurityService
.
HEADER_HSTS
Services
.
io
.
newURI
(
"
https
:
/
/
sub
.
example
.
apis
.
google
.
com
"
)
0
)
)
;
ok
(
SSService
.
isSecureURI
(
Ci
.
nsISiteSecurityService
.
HEADER_HSTS
Services
.
io
.
newURI
(
"
https
:
/
/
SUB
.
EXAMPLE
.
APIS
.
GOOGLE
.
COM
"
)
0
)
)
;
}
