"
use
strict
"
;
function
shouldBeImminentlyDistrusted
(
aTransportSecurityInfo
)
{
let
isDistrust
=
aTransportSecurityInfo
.
securityState
&
Ci
.
nsIWebProgressListener
.
STATE_CERT_DISTRUST_IMMINENT
;
Assert
.
ok
(
isDistrust
"
This
host
should
be
imminently
distrusted
"
)
;
}
function
shouldNotBeImminentlyDistrusted
(
aTransportSecurityInfo
)
{
let
isDistrust
=
aTransportSecurityInfo
.
securityState
&
Ci
.
nsIWebProgressListener
.
STATE_CERT_DISTRUST_IMMINENT
;
Assert
.
ok
(
!
isDistrust
"
This
host
should
not
be
imminently
distrusted
"
)
;
}
do_get_profile
(
)
;
add_tls_server_setup
(
"
SymantecSanctionsServer
"
"
test_symantec_apple_google
"
)
;
add_connection_test
(
"
symantec
-
whitelist
-
after
-
cutoff
.
example
.
com
"
PRErrorCodeSuccess
null
shouldNotBeImminentlyDistrusted
)
;
add_connection_test
(
"
symantec
-
whitelist
-
before
-
cutoff
.
example
.
com
"
PRErrorCodeSuccess
null
shouldNotBeImminentlyDistrusted
)
;
add_connection_test
(
"
symantec
-
not
-
whitelisted
-
after
-
cutoff
.
example
.
com
"
PRErrorCodeSuccess
null
shouldBeImminentlyDistrusted
)
;
add_connection_test
(
"
symantec
-
not
-
whitelisted
-
before
-
cutoff
.
example
.
com
"
SEC_ERROR_UNKNOWN_ISSUER
null
null
)
;
