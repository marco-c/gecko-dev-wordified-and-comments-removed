"
use
strict
"
;
add_task
(
async
function
(
)
{
do_get_profile
(
)
;
let
certDB
=
Cc
[
"
mozilla
.
org
/
security
/
x509certdb
;
1
"
]
.
getService
(
Ci
.
nsIX509CertDB
)
;
addCertFromFile
(
certDB
"
bad_certs
/
test
-
ca
.
pem
"
"
CTu
"
)
;
let
threeWeeksFromNowInSeconds
=
Date
.
now
(
)
/
1000
+
3
*
7
*
24
*
60
*
60
;
let
ee
=
constructCertFromFile
(
"
bad_certs
/
default
-
ee
.
pem
"
)
;
await
checkCertErrorGenericAtTime
(
certDB
ee
PRErrorCodeSuccess
Ci
.
nsIX509CertDB
.
verifyUsageTLSServer
threeWeeksFromNowInSeconds
false
"
test
.
example
.
com
"
)
;
}
)
;
