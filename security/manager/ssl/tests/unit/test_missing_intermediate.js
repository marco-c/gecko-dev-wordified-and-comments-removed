"
use
strict
"
;
do_get_profile
(
)
;
const
certdb
=
Cc
[
"
mozilla
.
org
/
security
/
x509certdb
;
1
"
]
.
getService
(
Ci
.
nsIX509CertDB
)
;
function
run_test
(
)
{
addCertFromFile
(
certdb
"
bad_certs
/
test
-
ca
.
pem
"
"
CTu
"
)
;
add_tls_server_setup
(
"
BadCertServer
"
"
bad_certs
"
)
;
add_connection_test
(
"
ee
-
from
-
missing
-
intermediate
.
example
.
com
"
SEC_ERROR_UNKNOWN_ISSUER
)
;
add_test
(
(
)
=
>
{
addCertFromFile
(
certdb
"
test_missing_intermediate
/
missing
-
intermediate
.
pem
"
"
"
)
;
run_next_test
(
)
;
}
)
;
add_connection_test
(
"
ee
-
from
-
missing
-
intermediate
.
example
.
com
"
PRErrorCodeSuccess
)
;
run_next_test
(
)
;
}
