"
use
strict
"
;
function
run_test
(
)
{
if
(
!
AppConstants
.
MOZ_NEW_CERT_STORAGE
)
{
return
;
}
let
certStorage
=
Cc
[
"
mozilla
.
org
/
security
/
certstorage
;
1
"
]
.
getService
(
Ci
.
nsICertStorage
)
;
ok
(
!
certStorage
.
isBlocklistFresh
(
)
"
checking
blocklist
freshness
shouldn
'
t
crash
"
)
;
Services
.
prefs
.
setIntPref
(
"
services
.
blocklist
.
onecrl
.
checked
"
-
2
)
;
Services
.
prefs
.
setIntPref
(
"
security
.
onecrl
.
maximum_staleness_in_seconds
"
-
7
)
;
ok
(
!
certStorage
.
isBlocklistFresh
(
)
"
checking
blocklist
freshness
still
shouldn
'
t
crash
"
)
;
Services
.
prefs
.
clearUserPref
(
"
services
.
blocklist
.
onecrl
.
checked
"
)
;
ok
(
!
certStorage
.
isBlocklistFresh
(
)
"
checking
blocklist
freshness
again
shouldn
'
t
crash
"
)
;
}
