#
ifndef
PublicKeyPinningService_h
#
define
PublicKeyPinningService_h
#
include
"
CertVerifier
.
h
"
#
include
"
ScopedNSSTypes
.
h
"
#
include
"
cert
.
h
"
#
include
"
nsNSSCertificate
.
h
"
#
include
"
nsString
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
mozpkix
/
Time
.
h
"
namespace
mozilla
{
class
OriginAttributes
;
}
using
mozilla
:
:
OriginAttributes
;
namespace
mozilla
{
namespace
psm
{
class
PublicKeyPinningService
{
public
:
static
nsresult
ChainHasValidPins
(
const
nsTArray
<
RefPtr
<
nsIX509Cert
>
>
&
certList
const
char
*
hostname
mozilla
:
:
pkix
:
:
Time
time
bool
enforceTestMode
const
OriginAttributes
&
originAttributes
bool
&
chainHasValidPins
PinningTelemetryInfo
*
pinningTelemetryInfo
)
;
static
nsresult
ChainMatchesPinset
(
const
nsTArray
<
RefPtr
<
nsIX509Cert
>
>
&
certList
const
nsTArray
<
nsCString
>
&
aSHA256keys
bool
&
chainMatchesPinset
)
;
static
nsresult
HostHasPins
(
const
char
*
hostname
mozilla
:
:
pkix
:
:
Time
time
bool
enforceTestMode
const
OriginAttributes
&
originAttributes
bool
&
hostHasPins
)
;
static
nsAutoCString
CanonicalizeHostname
(
const
char
*
hostname
)
;
}
;
}
}
#
endif
