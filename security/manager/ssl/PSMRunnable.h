#
ifndef
PSMRunnable_h
#
define
PSMRunnable_h
#
include
"
mozilla
/
Monitor
.
h
"
#
include
"
nsThreadUtils
.
h
"
#
include
"
nsIObserver
.
h
"
#
include
"
nsProxyRelease
.
h
"
namespace
mozilla
{
namespace
psm
{
class
SyncRunnableBase
:
public
Runnable
{
public
:
NS_DECL_NSIRUNNABLE
nsresult
DispatchToMainThreadAndWait
(
)
;
protected
:
SyncRunnableBase
(
)
;
virtual
void
RunOnTargetThread
(
)
=
0
;
private
:
mozilla
:
:
Monitor
monitor
MOZ_UNANNOTATED
;
}
;
class
NotifyObserverRunnable
:
public
Runnable
{
public
:
NotifyObserverRunnable
(
nsIObserver
*
observer
const
char
*
topicStringLiteral
)
:
Runnable
(
"
psm
:
:
NotifyObserverRunnable
"
)
mObserver
(
new
nsMainThreadPtrHolder
<
nsIObserver
>
(
"
psm
:
:
NotifyObserverRunnable
:
:
mObserver
"
observer
)
)
mTopic
(
topicStringLiteral
)
{
}
NS_DECL_NSIRUNNABLE
private
:
nsMainThreadPtrHandle
<
nsIObserver
>
mObserver
;
const
char
*
const
mTopic
;
}
;
}
}
#
endif
