#
ifndef
nsNSSCertificate_h
#
define
nsNSSCertificate_h
#
include
<
functional
>
#
include
<
vector
>
#
include
"
ScopedNSSTypes
.
h
"
#
include
"
certt
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIClassInfo
.
h
"
#
include
"
nsISerializable
.
h
"
#
include
"
nsIX509Cert
.
h
"
#
include
"
nsStringFwd
.
h
"
class
nsINSSComponent
;
class
nsNSSCertificate
final
:
public
nsIX509Cert
public
nsISerializable
public
nsIClassInfo
{
public
:
NS_DECL_THREADSAFE_ISUPPORTS
NS_DECL_NSIX509CERT
NS_DECL_NSISERIALIZABLE
NS_DECL_NSICLASSINFO
explicit
nsNSSCertificate
(
CERTCertificate
*
cert
)
;
nsNSSCertificate
(
)
;
static
nsNSSCertificate
*
Create
(
CERTCertificate
*
cert
=
nullptr
)
;
static
nsNSSCertificate
*
ConstructFromDER
(
char
*
certDER
int
derLen
)
;
private
:
virtual
~
nsNSSCertificate
(
)
=
default
;
mozilla
:
:
UniqueCERTCertificate
mCert
;
uint32_t
mCertType
;
bool
InitFromDER
(
char
*
certDER
int
derLen
)
;
nsresult
GetCertificateHash
(
nsAString
&
aFingerprint
SECOidTag
aHashAlg
)
;
}
;
#
define
NS_X509CERT_CID
\
{
/
*
660a3226
-
915c
-
4ffb
-
bb20
-
8985a632df05
*
/
\
0x660a3226
0x915c
0x4ffb
{
\
0xbb
0x20
0x89
0x85
0xa6
0x32
0xdf
0x05
\
}
\
}
#
endif
