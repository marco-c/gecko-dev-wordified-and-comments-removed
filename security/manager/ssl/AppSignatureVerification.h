#
ifndef
AppSignatureVerification_h
#
define
AppSignatureVerification_h
#
include
"
mozpkix
/
pkix
.
h
"
#
include
"
mozpkix
/
pkixnss
.
h
"
#
include
"
mozpkix
/
pkixutil
.
h
"
mozilla
:
:
Span
<
const
uint8_t
>
GetPKCS7SignerCert
(
NSSCMSSignerInfo
*
signerInfo
nsTArray
<
mozilla
:
:
Span
<
const
uint8_t
>
>
&
collectedCerts
)
;
NSSCMSSignedData
*
GetSignedDataContent
(
NSSCMSMessage
*
cmsg
)
;
void
CollectCertificates
(
NSSCMSSignedData
*
signedData
nsTArray
<
mozilla
:
:
Span
<
const
uint8_t
>
>
&
collectedCerts
)
;
nsresult
VerifySignatureFromCertificate
(
mozilla
:
:
Span
<
const
uint8_t
>
signerCertSpan
NSSCMSSignerInfo
*
signerInfo
SECItem
*
detachedDigest
)
;
void
GetAllSignerInfosForSupportedDigestAlgorithms
(
NSSCMSSignedData
*
signedData
nsTArray
<
std
:
:
tuple
<
NSSCMSSignerInfo
*
SECOidTag
>
>
&
signerInfos
)
;
#
endif
