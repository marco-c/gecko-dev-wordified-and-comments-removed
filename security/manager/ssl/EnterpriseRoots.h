#
ifndef
EnterpriseRoots_h
#
define
EnterpriseRoots_h
#
include
"
ErrorList
.
h
"
#
include
"
ScopedNSSTypes
.
h
"
#
ifdef
XP_WIN
#
include
"
windows
.
h
"
#
include
"
wincrypt
.
h
"
#
endif
nsresult
GatherEnterpriseRoots
(
mozilla
:
:
UniqueCERTCertList
&
result
)
;
#
ifdef
XP_WIN
mozilla
:
:
UniqueCERTCertificate
PCCERT_CONTEXTToCERTCertificate
(
PCCERT_CONTEXT
pccert
)
;
extern
const
wchar_t
*
kWindowsDefaultRootStoreName
;
extern
const
nsLiteralCString
kMicrosoftFamilySafetyCN
;
class
ScopedCertStore
final
{
public
:
explicit
ScopedCertStore
(
HCERTSTORE
certstore
)
:
certstore
(
certstore
)
{
}
~
ScopedCertStore
(
)
{
CertCloseStore
(
certstore
0
)
;
}
HCERTSTORE
get
(
)
{
return
certstore
;
}
private
:
ScopedCertStore
(
const
ScopedCertStore
&
)
=
delete
;
ScopedCertStore
&
operator
=
(
const
ScopedCertStore
&
)
=
delete
;
HCERTSTORE
certstore
;
}
;
#
endif
#
endif
