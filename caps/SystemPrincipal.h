#
ifndef
mozilla_SystemPrincipal_h
#
define
mozilla_SystemPrincipal_h
#
include
"
nsIPrincipal
.
h
"
#
include
"
nsJSPrincipals
.
h
"
#
include
"
mozilla
/
BasePrincipal
.
h
"
#
define
NS_SYSTEMPRINCIPAL_CID
\
{
0x4a6212db
0xaccb
0x11d3
{
0xb7
0x65
0x0
0x60
0xb0
0xb6
0xce
0xcb
}
}
#
define
NS_SYSTEMPRINCIPAL_CONTRACTID
"
mozilla
.
org
/
systemprincipal
;
1
"
class
nsScriptSecurityManager
;
namespace
mozilla
{
class
SystemPrincipal
final
:
public
BasePrincipal
public
nsISerializable
{
SystemPrincipal
(
)
;
public
:
static
already_AddRefed
<
SystemPrincipal
>
Get
(
)
;
static
PrincipalKind
Kind
(
)
{
return
eSystemPrincipal
;
}
NS_IMETHOD_
(
MozExternalRefCountType
)
AddRef
(
)
override
{
return
nsJSPrincipals
:
:
AddRef
(
)
;
}
;
NS_IMETHOD_
(
MozExternalRefCountType
)
Release
(
)
override
{
return
nsJSPrincipals
:
:
Release
(
)
;
}
;
NS_DECL_NSISERIALIZABLE
NS_IMETHOD
QueryInterface
(
REFNSIID
aIID
void
*
*
aInstancePtr
)
override
;
NS_IMETHOD
GetURI
(
nsIURI
*
*
aURI
)
override
;
NS_IMETHOD
GetDomain
(
nsIURI
*
*
aDomain
)
override
;
NS_IMETHOD
SetDomain
(
nsIURI
*
aDomain
)
override
;
NS_IMETHOD
GetBaseDomain
(
nsACString
&
aBaseDomain
)
override
;
NS_IMETHOD
GetAddonId
(
nsAString
&
aAddonId
)
override
;
NS_IMETHOD
GetIsOriginPotentiallyTrustworthy
(
bool
*
aResult
)
override
;
virtual
nsresult
GetScriptLocation
(
nsACString
&
aStr
)
override
;
nsresult
GetSiteIdentifier
(
SiteIdentifier
&
aSite
)
override
{
aSite
.
Init
(
this
)
;
return
NS_OK
;
}
protected
:
friend
class
:
:
nsScriptSecurityManager
;
virtual
~
SystemPrincipal
(
)
=
default
;
static
already_AddRefed
<
SystemPrincipal
>
Init
(
)
;
static
void
Shutdown
(
)
;
bool
SubsumesInternal
(
nsIPrincipal
*
aOther
DocumentDomainConsideration
aConsideration
)
override
{
return
true
;
}
bool
MayLoadInternal
(
nsIURI
*
aURI
)
override
{
return
true
;
}
}
;
}
#
endif
