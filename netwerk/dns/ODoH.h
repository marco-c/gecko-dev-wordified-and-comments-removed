#
ifndef
mozilla_net_ODoH_h
#
define
mozilla_net_ODoH_h
#
include
"
TRR
.
h
"
namespace
mozilla
{
namespace
net
{
class
ODoH
final
:
public
TRR
{
public
:
explicit
ODoH
(
AHostResolver
*
aResolver
nsHostRecord
*
aRec
enum
TrrType
aType
)
:
TRR
(
aResolver
aRec
aType
)
{
}
explicit
ODoH
(
AHostResolver
*
aResolver
nsHostRecord
*
aRec
nsCString
&
aHost
enum
TrrType
&
aType
unsigned
int
aLoopCount
bool
aPB
)
:
TRR
(
aResolver
aRec
aHost
aType
aLoopCount
aPB
)
{
}
NS_IMETHOD
Run
(
)
override
;
NS_IMETHOD
GetInterface
(
const
nsIID
&
void
*
*
)
override
{
return
NS_ERROR_NO_INTERFACE
;
}
protected
:
virtual
~
ODoH
(
)
=
default
;
virtual
DNSPacket
*
GetOrCreateDNSPacket
(
)
override
;
virtual
nsresult
CreateQueryURI
(
nsIURI
*
*
aOutURI
)
override
;
virtual
const
char
*
ContentType
(
)
const
override
{
return
"
application
/
oblivious
-
dns
-
message
"
;
}
virtual
DNSResolverType
ResolverType
(
)
const
override
{
return
DNSResolverType
:
:
ODoH
;
}
virtual
bool
MaybeBlockRequest
(
)
override
{
return
false
;
}
;
virtual
void
RecordProcessingTime
(
nsIChannel
*
aChannel
)
override
{
}
virtual
void
ReportStatus
(
nsresult
aStatusCode
)
override
{
}
virtual
void
HandleTimeout
(
)
override
;
virtual
void
HandleEncodeError
(
nsresult
aStatusCode
)
override
;
virtual
void
HandleDecodeError
(
nsresult
aStatusCode
)
override
;
bool
mTriedDownloadODoHConfigs
=
false
;
}
;
}
}
#
endif
