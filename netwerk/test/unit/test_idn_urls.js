"
use
strict
"
;
const
testcases
=
[
[
"
cuill
re
"
"
xn
-
-
cuillre
-
6xa
"
false
true
true
]
[
"
gruz
ere
"
"
xn
-
-
gruzere
-
ogea
"
false
false
false
]
[
"
I
NY
"
"
xn
-
-
iny
-
zx5a
"
false
false
false
]
[
"
"
"
xn
-
-
08j4gylj12hz80b0uhfup
"
false
true
true
]
[
"
"
"
xn
-
-
lsa83dealbred
"
false
true
true
]
[
"
-
in
-
Russian
"
"
xn
-
-
-
in
-
russian
-
1jg071b0a8bb4cpd
"
false
false
false
]
[
"
war
-
and
-
"
"
xn
-
-
war
-
and
-
-
b9g3b7b3h
"
false
false
false
]
[
"
"
"
xn
-
-
f9dt7l
"
false
false
false
]
[
"
"
"
xn
-
-
4o7a6e1x64c
"
false
false
false
]
[
"
"
"
xn
-
-
hxa3ahjw4a
"
false
true
true
]
[
"
icrelationship
"
"
xn
-
-
icrelationship
-
96j4t9a3cwe2e
"
false
false
false
]
[
"
space
"
"
xn
-
-
space
-
h9dui0b0ga2j1562b
"
false
false
false
]
[
"
"
"
xn
-
-
d2b1ag0dl
"
false
true
true
]
[
"
"
"
xn
-
-
y9aaa1d0ai1cq964f8dwa2o1a
"
false
false
false
]
[
"
123
"
"
xn
-
-
123
-
mhh3em2hra
"
false
true
true
]
[
"
123
"
"
xn
-
-
123
-
phh3em2hra
"
false
true
true
]
[
"
chairman
"
"
xn
-
-
chairman
-
k65r
"
false
true
true
]
[
"
sauce
"
"
xn
-
-
sauce
-
6j9ii40v
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb6w0in486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb4w0ip486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb6w0ip486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb6w0ir486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb4w0ir486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb4w0it486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb6w0ik486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb4w0im486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb9w0ik486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb6w0in486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb1w0ip486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb4w0ip486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb1wvhsbx330n
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb9w0ir486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb9w0im486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb6w0ip486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb6w0iu486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb6w0ir486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb1w0iu486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb1w0iw486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
ub4bpb1w0ir486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb4w0ir486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb4w0iw486d
"
false
true
true
]
[
"
van
"
"
xn
-
-
van
-
rb4bpb4w0it486d
"
false
true
true
]
[
"
123
"
"
xn
-
-
123
-
u68dy61b
"
false
true
true
]
[
"
123
"
"
xn
-
-
123
-
x68dy61b
"
false
true
true
]
[
"
super
"
"
super8
"
true
true
true
]
[
"
"
"
xn
-
-
j50icd
"
false
true
true
]
[
"
\
uD840
\
uDC00
\
uD840
\
uDC01
\
uD840
\
uDC02
"
"
xn
-
-
j50icd
"
false
true
true
]
[
"
\
uD840
\
uDC00
\
uD840
\
uDC01
\
uD840
"
"
xn
-
-
zn7c0336bda
"
false
false
false
]
[
"
super
"
"
xn
-
-
super
-
k2l
"
false
false
true
]
[
"
ab
"
"
xn
-
-
ab
-
x5f
"
false
false
true
]
[
"
8
"
"
xn
-
-
8
-
70d2cp0j6dtd
"
false
true
true
]
[
"
5
"
"
xn
-
-
5
-
h3d7c
"
false
true
true
]
[
"
"
"
xn
-
-
8hbae38c
"
false
false
false
]
[
"
"
"
xn
-
-
uis754h
"
false
true
true
]
[
"
"
"
xn
-
-
chq31v
"
false
true
true
]
[
"
"
"
xn
-
-
chq31vsl1b
"
false
true
true
]
[
"
"
"
xn
-
-
chq31vrl1b
"
false
true
true
]
[
"
bopomofo
"
"
xn
-
-
bopomofo
-
hj5gkalm1637i876cuw0brk5f
"
false
true
true
]
[
"
bopomofo
"
"
xn
-
-
bopomofo
-
8i5gkalm9637i876cuw0brk5f
"
false
true
true
]
[
"
bopomofo
"
"
xn
-
-
bopomofo
-
hj5gkalm9637i876cuw0brk5f
"
false
true
true
]
[
"
bopomofo
"
"
xn
-
-
bopomofo
-
hj5gkalm3737i876cuw0brk5f
"
false
true
true
]
[
"
bopomofo
"
"
xn
-
-
bopomofo
-
8i5gkalm3737i876cuw0brk5f
"
false
true
true
]
[
"
bopomofo
"
"
xn
-
-
bopomofo
-
8i5gkalm1837i876cuw0brk5f
"
false
true
true
]
[
"
"
"
xn
-
-
jckteuaez1shij0450gylvccz9asi4e
"
false
false
false
]
[
"
"
"
xn
-
-
jckteuaez6shij5350gylvccz9asi4e
"
false
false
false
]
[
"
"
"
xn
-
-
jckteuaez1shij4450gylvccz9asi4e
"
false
false
false
]
[
"
"
"
xn
-
-
jckteuaez1shij9450gylvccz9asi4e
"
false
false
false
]
[
"
"
"
xn
-
-
jckteuaez6shij0450gylvccz9asi4e
"
false
false
false
]
[
"
"
"
xn
-
-
jckteuaez6shij4450gylvccz9asi4e
"
false
false
false
]
[
"
hangul
"
"
xn
-
-
hangul
-
2m5ti09k79ze
"
false
true
true
]
[
"
hangul
"
"
xn
-
-
hangul
-
2m5to09k79ze
"
false
true
true
]
[
"
hangul
"
"
xn
-
-
hangul
-
2m5th09k79ze
"
false
true
true
]
[
"
hangul
"
"
xn
-
-
hangul
-
8m5t898k79ze
"
false
true
true
]
[
"
hangul
"
"
xn
-
-
hangul
-
8m5ti09k79ze
"
false
true
true
]
[
"
hangul
"
"
xn
-
-
hangul
-
8m5th09k79ze
"
false
true
true
]
[
"
"
"
xn
-
-
qck1c2d4a9266lkmzb
"
false
false
false
]
[
"
"
"
xn
-
-
qck1c2d4a2366lkmzb
"
false
false
false
]
[
"
"
"
xn
-
-
22cdjb2fanb9fyepcbbb9dwh4a3igze4fdcd
"
false
true
true
]
[
"
.
ascii
"
"
xn
-
-
google
.
ascii
"
false
true
true
]
[
"
ascii
.
"
"
ascii
.
xn
-
-
google
"
false
true
true
]
[
"
123
.
"
"
xn
-
-
123
-
u68dy61b
.
xn
-
-
google
"
false
true
true
]
[
"
.
123
"
"
xn
-
-
google
.
xn
-
-
123
-
u68dy61b
"
false
true
true
]
[
"
xn
-
-
accountlogin
.
"
"
xn
-
-
accountlogin
.
xn
-
-
google
"
false
true
true
]
[
"
.
xn
-
-
accountlogin
"
"
xn
-
-
google
.
xn
-
-
accountlogin
"
false
true
true
]
[
"
goo
\
u0650gle
"
"
xn
-
-
google
-
yri
"
false
false
false
]
[
"
"
"
xn
-
-
mgbc0a5a6cxbzabt
"
false
true
true
]
[
"
goo
\
u05b4gle
"
"
xn
-
-
google
-
rvh
"
false
false
false
]
[
"
na
\
u0131
\
u0308ve
"
"
xn
-
-
nave
-
mza04z
"
false
false
false
]
[
"
d
\
u0131
\
u0302ner
"
"
xn
-
-
dner
-
lza40z
"
false
false
false
]
[
"
na
\
u00efve
.
com
"
"
xn
-
-
nave
-
6pa
.
com
"
false
true
true
]
[
"
d
\
u00eener
.
com
"
"
xn
-
-
dner
-
0pa
.
com
"
false
true
true
]
]
;
const
profiles
=
[
"
ASCII
"
"
high
"
"
moderate
"
]
;
function
run_test
(
)
{
var
pbi
=
Cc
[
"
mozilla
.
org
/
preferences
-
service
;
1
"
]
.
getService
(
Ci
.
nsIPrefBranch
)
;
var
oldProfile
=
pbi
.
getCharPref
(
"
network
.
IDN
.
restriction_profile
"
"
moderate
"
)
;
var
oldWhitelistCom
=
pbi
.
getBoolPref
(
"
network
.
IDN
.
whitelist
.
com
"
false
)
;
var
idnService
=
Cc
[
"
mozilla
.
org
/
network
/
idn
-
service
;
1
"
]
.
getService
(
Ci
.
nsIIDNService
)
;
for
(
var
i
=
0
;
i
<
profiles
.
length
;
+
+
i
)
{
pbi
.
setCharPref
(
"
network
.
IDN
.
restriction_profile
"
profiles
[
i
]
)
;
pbi
.
setBoolPref
(
"
network
.
IDN
.
whitelist
.
com
"
false
)
;
dump
(
"
testing
"
+
profiles
[
i
]
+
"
profile
"
)
;
for
(
var
j
=
0
;
j
<
testcases
.
length
;
+
+
j
)
{
var
test
=
testcases
[
j
]
;
var
URL
=
test
[
0
]
+
"
.
com
"
;
var
punycodeURL
=
test
[
1
]
+
"
.
com
"
;
var
expectedUnicode
=
test
[
2
+
i
]
;
var
isASCII
=
{
}
;
var
result
;
try
{
result
=
idnService
.
convertToDisplayIDN
(
URL
isASCII
)
;
}
catch
(
e
)
{
result
=
"
.
com
"
;
}
if
(
punycodeURL
.
substr
(
0
4
)
=
=
"
xn
-
-
"
|
|
punycodeURL
.
indexOf
(
"
.
xn
-
-
"
)
>
0
)
{
Assert
.
equal
(
escape
(
result
)
expectedUnicode
?
escape
(
URL
)
:
escape
(
punycodeURL
)
)
;
result
=
idnService
.
convertToDisplayIDN
(
punycodeURL
isASCII
)
;
Assert
.
equal
(
escape
(
result
)
expectedUnicode
?
escape
(
URL
)
:
escape
(
punycodeURL
)
)
;
}
else
{
Assert
.
equal
(
escape
(
result
)
escape
(
punycodeURL
)
)
;
}
}
}
pbi
.
setBoolPref
(
"
network
.
IDN
.
whitelist
.
com
"
oldWhitelistCom
)
;
pbi
.
setCharPref
(
"
network
.
IDN
.
restriction_profile
"
oldProfile
)
;
}
