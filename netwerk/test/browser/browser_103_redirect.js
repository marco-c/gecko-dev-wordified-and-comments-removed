"
use
strict
"
;
Services
.
prefs
.
setBoolPref
(
"
network
.
early
-
hints
.
enabled
"
true
)
;
const
{
test_hint_preload
}
=
ChromeUtils
.
import
(
"
resource
:
/
/
testing
-
common
/
early_hint_preload_test_helper
.
jsm
"
)
;
add_task
(
async
function
test_103_redirect_same_origin
(
)
{
await
test_hint_preload
(
"
test_103_redirect_same_origin
"
"
https
:
/
/
example
.
com
"
"
https
:
/
/
example
.
com
/
browser
/
netwerk
/
test
/
browser
/
early_hint_redirect
.
sjs
?
https
:
/
/
example
.
com
/
browser
/
netwerk
/
test
/
browser
/
early_hint_pixel
.
sjs
"
{
hinted
:
2
normal
:
0
}
)
;
}
)
;
add_task
(
async
function
test_103_redirect_cross_origin
(
)
{
await
test_hint_preload
(
"
test_103_redirect_cross_origin
"
"
https
:
/
/
example
.
com
"
"
https
:
/
/
example
.
com
/
browser
/
netwerk
/
test
/
browser
/
early_hint_redirect
.
sjs
?
https
:
/
/
example
.
net
/
browser
/
netwerk
/
test
/
browser
/
early_hint_pixel
.
sjs
"
{
hinted
:
2
normal
:
0
}
)
;
}
)
;
add_task
(
async
function
test_103_redirect_insecure_cross_origin
(
)
{
await
test_hint_preload
(
"
test_103_redirect_insecure_cross_origin
"
"
https
:
/
/
example
.
com
"
"
https
:
/
/
example
.
com
/
browser
/
netwerk
/
test
/
browser
/
early_hint_redirect
.
sjs
?
http
:
/
/
mochi
.
test
:
8888
/
browser
/
netwerk
/
test
/
browser
/
early_hint_pixel
.
sjs
"
{
hinted
:
1
normal
:
1
}
)
;
}
)
;
add_task
(
async
function
test_103_preload_redirect_mixed_content
(
)
{
await
test_hint_preload
(
"
test_103_preload_redirect_mixed_content
"
"
https
:
/
/
example
.
org
"
"
https
:
/
/
example
.
org
/
browser
/
netwerk
/
test
/
browser
/
early_hint_redirect
.
sjs
?
http
:
/
/
example
.
org
/
browser
/
netwerk
/
test
/
browser
/
early_hint_pixel
.
sjs
"
{
hinted
:
1
normal
:
1
}
)
;
}
)
;
