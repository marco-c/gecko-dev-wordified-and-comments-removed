"
use
strict
"
;
add_task
(
async
function
test_set_tab_offline
(
)
{
await
BrowserTestUtils
.
withNewTab
(
"
https
:
/
/
example
.
com
"
async
browser
=
>
{
gBrowser
.
selectedBrowser
.
browsingContext
.
forceOffline
=
true
;
await
SpecialPowers
.
spawn
(
browser
[
]
async
(
)
=
>
{
try
{
await
content
.
fetch
(
"
https
:
/
/
example
.
com
/
empty
.
html
"
)
;
ok
(
false
"
Should
not
load
since
tab
is
offline
"
)
;
}
catch
(
err
)
{
is
(
err
.
name
"
TypeError
"
"
Should
fail
since
tab
is
offline
"
)
;
}
}
)
;
}
)
;
}
)
;
add_task
(
async
function
test_set_tab_online
(
)
{
await
BrowserTestUtils
.
withNewTab
(
"
https
:
/
/
example
.
com
"
async
browser
=
>
{
gBrowser
.
selectedBrowser
.
browsingContext
.
forceOffline
=
false
;
await
SpecialPowers
.
spawn
(
browser
[
]
async
(
)
=
>
{
try
{
await
content
.
fetch
(
"
https
:
/
/
example
.
com
/
empty
.
html
"
)
;
ok
(
true
"
Should
load
since
tab
is
online
"
)
;
}
catch
(
err
)
{
ok
(
false
"
Should
not
fail
since
tab
is
online
"
)
;
}
}
)
;
}
)
;
}
)
;
