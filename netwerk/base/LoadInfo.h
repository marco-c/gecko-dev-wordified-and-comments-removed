#
ifndef
mozilla_LoadInfo_h
#
define
mozilla_LoadInfo_h
#
include
"
nsIContentPolicy
.
h
"
#
include
"
nsILoadInfo
.
h
"
#
include
"
nsIPrincipal
.
h
"
#
include
"
nsIWeakReferenceUtils
.
h
"
#
include
"
nsIURI
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
mozilla
/
BasePrincipal
.
h
"
class
nsINode
;
class
nsXMLHttpRequest
;
namespace
mozilla
{
namespace
net
{
class
OptionalLoadInfoArgs
;
}
namespace
ipc
{
nsresult
LoadInfoArgsToLoadInfo
(
const
mozilla
:
:
net
:
:
OptionalLoadInfoArgs
&
aLoadInfoArgs
nsILoadInfo
*
*
outLoadInfo
)
;
}
class
MOZ_EXPORT
LoadInfo
final
:
public
nsILoadInfo
{
public
:
NS_DECL_ISUPPORTS
NS_DECL_NSILOADINFO
LoadInfo
(
nsIPrincipal
*
aLoadingPrincipal
nsIPrincipal
*
aTriggeringPrincipal
nsINode
*
aLoadingContext
nsSecurityFlags
aSecurityFlags
nsContentPolicyType
aContentPolicyType
)
;
already_AddRefed
<
nsILoadInfo
>
Clone
(
)
const
;
already_AddRefed
<
nsILoadInfo
>
CloneForNewRequest
(
)
const
;
private
:
LoadInfo
(
nsIPrincipal
*
aLoadingPrincipal
nsIPrincipal
*
aTriggeringPrincipal
nsSecurityFlags
aSecurityFlags
nsContentPolicyType
aContentPolicyType
bool
aUpgradeInsecureRequests
uint64_t
aInnerWindowID
uint64_t
aOuterWindowID
uint64_t
aParentOuterWindowID
bool
aEnforceSecurity
bool
aInitialSecurityCheckDone
const
OriginAttributes
&
aOriginAttributes
nsTArray
<
nsCOMPtr
<
nsIPrincipal
>
>
&
aRedirectChainIncludingInternalRedirects
nsTArray
<
nsCOMPtr
<
nsIPrincipal
>
>
&
aRedirectChain
)
;
LoadInfo
(
const
LoadInfo
&
rhs
)
;
friend
nsresult
mozilla
:
:
ipc
:
:
LoadInfoArgsToLoadInfo
(
const
mozilla
:
:
net
:
:
OptionalLoadInfoArgs
&
aLoadInfoArgs
nsILoadInfo
*
*
outLoadInfo
)
;
~
LoadInfo
(
)
;
void
SetWithCredentialsSecFlag
(
)
;
friend
class
:
:
nsXMLHttpRequest
;
nsCOMPtr
<
nsIPrincipal
>
mLoadingPrincipal
;
nsCOMPtr
<
nsIPrincipal
>
mTriggeringPrincipal
;
nsWeakPtr
mLoadingContext
;
nsSecurityFlags
mSecurityFlags
;
nsContentPolicyType
mInternalContentPolicyType
;
LoadTainting
mTainting
;
bool
mUpgradeInsecureRequests
;
uint64_t
mInnerWindowID
;
uint64_t
mOuterWindowID
;
uint64_t
mParentOuterWindowID
;
bool
mEnforceSecurity
;
bool
mInitialSecurityCheckDone
;
OriginAttributes
mOriginAttributes
;
nsTArray
<
nsCOMPtr
<
nsIPrincipal
>
>
mRedirectChainIncludingInternalRedirects
;
nsTArray
<
nsCOMPtr
<
nsIPrincipal
>
>
mRedirectChain
;
}
;
}
#
endif
