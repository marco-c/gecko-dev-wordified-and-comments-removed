#
ifndef
mozilla_net_InterceptionInfo_h
#
define
mozilla_net_InterceptionInfo_h
#
include
"
nsIContentSecurityPolicy
.
h
"
#
include
"
nsIInterceptionInfo
.
h
"
#
include
"
nsIPrincipal
.
h
"
#
include
"
nsIRedirectHistoryEntry
.
h
"
#
include
"
nsTArray
.
h
"
#
include
"
nsCOMPtr
.
h
"
namespace
mozilla
:
:
net
{
using
RedirectHistoryArray
=
nsTArray
<
nsCOMPtr
<
nsIRedirectHistoryEntry
>
>
;
class
InterceptionInfo
final
:
public
nsIInterceptionInfo
{
public
:
NS_DECL_THREADSAFE_ISUPPORTS
NS_DECL_NSIINTERCEPTIONINFO
InterceptionInfo
(
nsIPrincipal
*
aTriggeringPrincipal
nsContentPolicyType
aContentPolicyType
const
RedirectHistoryArray
&
aRedirectChain
bool
aFromThirdParty
)
;
using
nsIInterceptionInfo
:
:
GetExtContentPolicyType
;
private
:
~
InterceptionInfo
(
)
=
default
;
nsCOMPtr
<
nsIPrincipal
>
mTriggeringPrincipal
;
nsContentPolicyType
mContentPolicyType
{
nsIContentPolicy
:
:
TYPE_INVALID
}
;
RedirectHistoryArray
mRedirectChain
;
bool
mFromThirdParty
=
false
;
}
;
}
#
endif
