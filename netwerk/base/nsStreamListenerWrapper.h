#
ifndef
nsStreamListenerWrapper_h__
#
define
nsStreamListenerWrapper_h__
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsIStreamListener
.
h
"
#
include
"
nsIThreadRetargetableStreamListener
.
h
"
#
include
"
nsIMultiPartChannel
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
namespace
mozilla
{
namespace
net
{
class
nsStreamListenerWrapper
final
:
public
nsIStreamListener
public
nsIMultiPartChannelListener
public
nsIThreadRetargetableStreamListener
{
public
:
explicit
nsStreamListenerWrapper
(
nsIStreamListener
*
listener
)
:
mListener
(
listener
)
{
MOZ_ASSERT
(
mListener
"
no
stream
listener
specified
"
)
;
}
NS_DECL_THREADSAFE_ISUPPORTS
NS_FORWARD_SAFE_NSISTREAMLISTENER
(
mListener
)
NS_DECL_NSIMULTIPARTCHANNELLISTENER
NS_DECL_NSITHREADRETARGETABLESTREAMLISTENER
NS_IMETHOD
OnStartRequest
(
nsIRequest
*
aRequest
)
override
{
return
mListener
-
>
OnStartRequest
(
aRequest
)
;
}
NS_IMETHOD
OnStopRequest
(
nsIRequest
*
aRequest
nsresult
aStatusCode
)
override
{
nsresult
rv
=
mListener
-
>
OnStopRequest
(
aRequest
aStatusCode
)
;
mListener
=
nullptr
;
return
rv
;
}
private
:
~
nsStreamListenerWrapper
(
)
=
default
;
nsCOMPtr
<
nsIStreamListener
>
mListener
;
}
;
}
}
#
endif
