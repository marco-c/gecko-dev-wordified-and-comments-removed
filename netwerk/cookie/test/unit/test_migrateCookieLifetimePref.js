add_task
(
async
function
migrateSanitizationPrefsClearCleaningPrefs
(
)
{
Services
.
prefs
.
setIntPref
(
"
network
.
cookie
.
lifetimePolicy
"
2
)
;
Services
.
prefs
.
setBoolPref
(
"
privacy
.
sanitize
.
sanitizeOnShutdown
"
false
)
;
Services
.
prefs
.
setBoolPref
(
"
privacy
.
clearOnShutdown
.
cache
"
false
)
;
Services
.
prefs
.
setBoolPref
(
"
privacy
.
clearOnShutdown
.
cookies
"
false
)
;
Services
.
prefs
.
setBoolPref
(
"
privacy
.
clearOnShutdown
.
offlineApps
"
false
)
;
Services
.
prefs
.
setBoolPref
(
"
privacy
.
clearOnShutdown
.
downloads
"
true
)
;
Services
.
prefs
.
setBoolPref
(
"
privacy
.
clearOnShutdown
.
sessions
"
true
)
;
Services
.
cookies
;
Assert
.
equal
(
Services
.
prefs
.
getIntPref
(
"
network
.
cookie
.
lifetimePolicy
"
0
)
0
"
Cookie
lifetime
policy
is
off
"
)
;
Assert
.
ok
(
Services
.
prefs
.
getBoolPref
(
"
privacy
.
sanitize
.
sanitizeOnShutdown
"
)
"
Sanitize
on
shutdown
is
set
"
)
;
Assert
.
ok
(
Services
.
prefs
.
getBoolPref
(
"
privacy
.
clearOnShutdown
.
cookies
"
)
"
Clearing
cookies
on
shutdown
is
selected
"
)
;
Assert
.
ok
(
Services
.
prefs
.
getBoolPref
(
"
privacy
.
clearOnShutdown
.
cache
"
)
"
Clearing
cache
on
shutdown
is
still
selected
"
)
;
Assert
.
ok
(
Services
.
prefs
.
getBoolPref
(
"
privacy
.
clearOnShutdown
.
offlineApps
"
)
"
Clearing
offline
apps
on
shutdown
is
selected
"
)
;
Assert
.
ok
(
!
Services
.
prefs
.
getBoolPref
(
"
privacy
.
clearOnShutdown
.
downloads
"
)
"
Clearing
downloads
on
shutdown
is
not
set
anymore
"
)
;
Assert
.
ok
(
!
Services
.
prefs
.
getBoolPref
(
"
privacy
.
clearOnShutdown
.
sessions
"
)
"
Clearing
active
logins
on
shutdown
is
not
set
anymore
"
)
;
Services
.
prefs
.
resetPrefs
(
)
;
delete
Services
.
cookies
;
}
)
;
