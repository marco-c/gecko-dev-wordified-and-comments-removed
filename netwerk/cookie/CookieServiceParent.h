#
ifndef
mozilla_net_CookieServiceParent_h
#
define
mozilla_net_CookieServiceParent_h
#
include
"
mozilla
/
net
/
PCookieServiceParent
.
h
"
class
nsCookie
;
class
nsICookie
;
class
nsCookieService
;
namespace
mozilla
{
class
OriginAttributes
;
}
namespace
mozilla
{
namespace
net
{
class
CookieServiceParent
:
public
PCookieServiceParent
{
public
:
CookieServiceParent
(
)
;
virtual
~
CookieServiceParent
(
)
=
default
;
void
TrackCookieLoad
(
nsIChannel
*
aChannel
)
;
void
RemoveBatchDeletedCookies
(
nsIArray
*
aCookieList
)
;
void
RemoveAll
(
)
;
void
RemoveCookie
(
nsICookie
*
aCookie
)
;
void
AddCookie
(
nsICookie
*
aCookie
)
;
bool
ProcessingCookie
(
)
{
return
mProcessingCookie
;
}
protected
:
virtual
void
ActorDestroy
(
ActorDestroyReason
aWhy
)
override
;
virtual
mozilla
:
:
ipc
:
:
IPCResult
RecvGetCookieString
(
const
URIParams
&
aHost
const
bool
&
aIsForeign
const
bool
&
aIsTrackingResource
const
bool
&
aFirstPartyStorageAccessGranted
const
bool
&
aIsSafeTopLevelNav
const
bool
&
aIsSameSiteForeign
const
OriginAttributes
&
aAttrs
nsCString
*
aResult
)
override
;
virtual
mozilla
:
:
ipc
:
:
IPCResult
RecvSetCookieString
(
const
URIParams
&
aHost
const
URIParams
&
aChannelURI
const
bool
&
aIsForeign
const
bool
&
aIsTrackingResource
const
bool
&
aFirstPartyStorageAccessGranted
const
nsCString
&
aCookieString
const
nsCString
&
aServerTime
const
OriginAttributes
&
aAttrs
const
bool
&
aFromHttp
)
override
;
virtual
mozilla
:
:
ipc
:
:
IPCResult
RecvPrepareCookieList
(
const
URIParams
&
aHost
const
bool
&
aIsForeign
const
bool
&
aIsTackingResource
const
bool
&
aFirstPartyStorageAccessGranted
const
bool
&
aIsSafeTopLevelNav
const
bool
&
aIsSameSiteForeign
const
OriginAttributes
&
aAttrs
)
override
;
void
SerialializeCookieList
(
const
nsTArray
<
nsCookie
*
>
&
aFoundCookieList
nsTArray
<
CookieStruct
>
&
aCookiesList
nsIURI
*
aHostURI
)
;
RefPtr
<
nsCookieService
>
mCookieService
;
bool
mProcessingCookie
;
}
;
}
}
#
endif
