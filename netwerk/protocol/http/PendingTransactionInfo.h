#
ifndef
PendingTransactionInfo_h__
#
define
PendingTransactionInfo_h__
#
include
"
HalfOpenSocket
.
h
"
namespace
mozilla
{
namespace
net
{
class
PendingTransactionInfo
final
:
public
ARefBase
{
public
:
explicit
PendingTransactionInfo
(
nsHttpTransaction
*
trans
)
:
mTransaction
(
trans
)
{
}
NS_INLINE_DECL_THREADSAFE_REFCOUNTING
(
PendingTransactionInfo
override
)
void
PrintDiagnostics
(
nsCString
&
log
)
;
bool
IsAlreadyClaimedInitializingConn
(
)
;
void
AbandonHalfOpenAndForgetActiveConn
(
)
;
bool
TryClaimingHalfOpen
(
HalfOpenSocket
*
sock
)
;
bool
TryClaimingActiveConn
(
HttpConnectionBase
*
conn
)
;
void
AddHalfOpen
(
HalfOpenSocket
*
sock
)
;
nsHttpTransaction
*
Transaction
(
)
const
{
return
mTransaction
;
}
private
:
RefPtr
<
nsHttpTransaction
>
mTransaction
;
nsWeakPtr
mHalfOpen
;
nsWeakPtr
mActiveConn
;
~
PendingTransactionInfo
(
)
;
}
;
class
PendingComparator
{
public
:
bool
Equals
(
const
PendingTransactionInfo
*
aPendingTrans
const
nsAHttpTransaction
*
aTrans
)
const
{
return
aPendingTrans
-
>
Transaction
(
)
=
=
aTrans
;
}
}
;
}
}
#
endif
