#
ifndef
mozilla_LayerTimelineMarker_h_
#
define
mozilla_LayerTimelineMarker_h_
#
include
"
TimelineMarker
.
h
"
#
include
"
mozilla
/
dom
/
ProfileTimelineMarkerBinding
.
h
"
#
include
"
mozilla
/
mozalloc_oom
.
h
"
#
include
"
nsRegion
.
h
"
namespace
mozilla
{
class
LayerTimelineMarker
:
public
TimelineMarker
{
public
:
explicit
LayerTimelineMarker
(
const
nsIntRegion
&
aRegion
)
:
TimelineMarker
(
"
Layer
"
MarkerTracingType
:
:
HELPER_EVENT
)
mRegion
(
aRegion
)
{
}
void
AddLayerRectangles
(
dom
:
:
Sequence
<
dom
:
:
ProfileTimelineLayerRect
>
&
aRectangles
)
{
for
(
auto
iter
=
mRegion
.
RectIter
(
)
;
!
iter
.
Done
(
)
;
iter
.
Next
(
)
)
{
const
nsIntRect
&
iterRect
=
iter
.
Get
(
)
;
dom
:
:
ProfileTimelineLayerRect
rect
;
rect
.
mX
=
iterRect
.
X
(
)
;
rect
.
mY
=
iterRect
.
Y
(
)
;
rect
.
mWidth
=
iterRect
.
Width
(
)
;
rect
.
mHeight
=
iterRect
.
Height
(
)
;
if
(
!
aRectangles
.
AppendElement
(
rect
fallible
)
)
{
mozalloc_handle_oom
(
0
)
;
}
}
}
private
:
nsIntRegion
mRegion
;
}
;
}
#
endif
