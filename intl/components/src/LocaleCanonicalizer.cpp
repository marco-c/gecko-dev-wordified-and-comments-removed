#
include
"
mozilla
/
intl
/
LocaleCanonicalizer
.
h
"
#
include
<
cstdio
>
#
include
"
unicode
/
uloc
.
h
"
namespace
mozilla
:
:
intl
{
ICUResult
LocaleCanonicalizer
:
:
CanonicalizeICULevel1
(
const
char
*
aLocaleIn
LocaleCanonicalizer
:
:
Vector
&
aLocaleOut
)
{
auto
result
=
FillVectorWithICUCall
(
aLocaleOut
[
&
aLocaleIn
]
(
char
*
target
int32_t
length
UErrorCode
*
status
)
{
return
uloc_canonicalize
(
aLocaleIn
target
length
status
)
;
}
)
;
if
(
result
.
isErr
(
)
)
{
return
Err
(
result
.
unwrapErr
(
)
)
;
}
for
(
auto
byte
:
aLocaleOut
)
{
if
(
static_cast
<
unsigned
char
>
(
byte
)
>
127
)
{
return
Err
(
ICUError
:
:
InternalError
)
;
}
}
return
Ok
(
)
;
}
}
