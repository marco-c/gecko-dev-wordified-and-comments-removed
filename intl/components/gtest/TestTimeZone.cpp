#
include
"
gtest
/
gtest
.
h
"
#
include
"
mozilla
/
intl
/
TimeZone
.
h
"
#
include
"
mozilla
/
Maybe
.
h
"
#
include
"
mozilla
/
Span
.
h
"
#
include
"
TestBuffer
.
h
"
namespace
mozilla
:
:
intl
{
TEST
(
IntlTimeZone
SystemDependentTests
)
{
auto
timeZone
=
TimeZone
:
:
TryCreate
(
Some
(
MakeStringSpan
(
u
"
GMT
+
3
"
)
)
)
.
unwrap
(
)
;
TestBuffer
<
char16_t
>
buffer
;
timeZone
-
>
GetRawOffsetMs
(
)
.
unwrap
(
)
;
TimeZone
:
:
GetDefaultTimeZone
(
buffer
)
.
unwrap
(
)
;
}
TEST
(
IntlTimeZone
GetCanonicalTimeZoneID
)
{
TestBuffer
<
char16_t
>
buffer
;
TimeZone
:
:
GetCanonicalTimeZoneID
(
MakeStringSpan
(
u
"
America
/
Chicago
"
)
buffer
)
.
unwrap
(
)
;
ASSERT_EQ
(
buffer
.
get_string_view
(
)
u
"
America
/
Chicago
"
)
;
TimeZone
:
:
GetCanonicalTimeZoneID
(
MakeStringSpan
(
u
"
Europe
/
Belfast
"
)
buffer
)
.
unwrap
(
)
;
ASSERT_EQ
(
buffer
.
get_string_view
(
)
u
"
Europe
/
London
"
)
;
ASSERT_TRUE
(
TimeZone
:
:
GetCanonicalTimeZoneID
(
MakeStringSpan
(
u
"
Not
a
time
zone
"
)
buffer
)
.
isErr
(
)
)
;
}
}
