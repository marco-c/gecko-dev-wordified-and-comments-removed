#
include
"
unicode
/
utypes
.
h
"
#
include
"
unicode
/
uspoof
.
h
"
#
include
"
unicode
/
unorm
.
h
"
#
include
"
unicode
/
uregex
.
h
"
#
include
"
unicode
/
ustring
.
h
"
#
include
"
cmemory
.
h
"
#
include
"
uspoof_impl
.
h
"
#
include
"
uhash
.
h
"
#
include
"
uvector
.
h
"
#
include
"
uassert
.
h
"
#
include
"
uarrsort
.
h
"
#
include
"
uspoof_conf
.
h
"
#
if
!
UCONFIG_NO_NORMALIZATION
U_NAMESPACE_USE
U_CFUNC
void
uspoof_internalInitStatics
(
UErrorCode
*
status
)
;
U_CAPI
USpoofChecker
*
U_EXPORT2
uspoof_openFromSource
(
const
char
*
confusables
int32_t
confusablesLen
const
char
*
int32_t
int32_t
*
errorType
UParseError
*
pe
UErrorCode
*
status
)
{
uspoof_internalInitStatics
(
status
)
;
if
(
U_FAILURE
(
*
status
)
)
{
return
nullptr
;
}
#
if
UCONFIG_NO_REGULAR_EXPRESSIONS
*
status
=
U_UNSUPPORTED_ERROR
;
return
nullptr
;
#
else
if
(
errorType
!
=
nullptr
)
{
*
errorType
=
0
;
}
if
(
pe
!
=
nullptr
)
{
pe
-
>
line
=
0
;
pe
-
>
offset
=
0
;
pe
-
>
preContext
[
0
]
=
0
;
pe
-
>
postContext
[
0
]
=
0
;
}
SpoofData
*
newSpoofData
=
new
SpoofData
(
*
status
)
;
if
(
newSpoofData
=
=
nullptr
)
{
*
status
=
U_MEMORY_ALLOCATION_ERROR
;
return
nullptr
;
}
if
(
U_FAILURE
(
*
status
)
)
{
delete
newSpoofData
;
return
nullptr
;
}
SpoofImpl
*
This
=
new
SpoofImpl
(
newSpoofData
*
status
)
;
if
(
This
=
=
nullptr
)
{
*
status
=
U_MEMORY_ALLOCATION_ERROR
;
delete
newSpoofData
;
return
nullptr
;
}
if
(
U_FAILURE
(
*
status
)
)
{
delete
This
;
return
nullptr
;
}
ConfusabledataBuilder
:
:
buildConfusableData
(
This
confusables
confusablesLen
errorType
pe
*
status
)
;
if
(
U_FAILURE
(
*
status
)
)
{
delete
This
;
This
=
nullptr
;
}
return
(
USpoofChecker
*
)
This
;
#
endif
}
#
endif
