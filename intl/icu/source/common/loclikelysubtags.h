#
ifndef
__LOCLIKELYSUBTAGS_H__
#
define
__LOCLIKELYSUBTAGS_H__
#
include
<
utility
>
#
include
"
unicode
/
utypes
.
h
"
#
include
"
unicode
/
bytestrie
.
h
"
#
include
"
unicode
/
locid
.
h
"
#
include
"
unicode
/
uobject
.
h
"
#
include
"
unicode
/
ures
.
h
"
#
include
"
lsr
.
h
"
#
include
"
uhash
.
h
"
U_NAMESPACE_BEGIN
struct
XLikelySubtagsData
;
class
CharStringMap
final
:
public
UMemory
{
public
:
CharStringMap
(
)
:
map
(
nullptr
)
{
}
CharStringMap
(
int32_t
size
UErrorCode
&
errorCode
)
{
map
=
uhash_openSize
(
uhash_hashChars
uhash_compareChars
uhash_compareChars
size
&
errorCode
)
;
}
CharStringMap
(
CharStringMap
&
&
other
)
U_NOEXCEPT
:
map
(
other
.
map
)
{
other
.
map
=
nullptr
;
}
CharStringMap
(
const
CharStringMap
&
other
)
=
delete
;
~
CharStringMap
(
)
{
uhash_close
(
map
)
;
}
CharStringMap
&
operator
=
(
CharStringMap
&
&
other
)
U_NOEXCEPT
{
map
=
other
.
map
;
other
.
map
=
nullptr
;
return
*
this
;
}
CharStringMap
&
operator
=
(
const
CharStringMap
&
other
)
=
delete
;
const
char
*
get
(
const
char
*
key
)
const
{
return
static_cast
<
const
char
*
>
(
uhash_get
(
map
key
)
)
;
}
void
put
(
const
char
*
key
const
char
*
value
UErrorCode
&
errorCode
)
{
uhash_put
(
map
const_cast
<
char
*
>
(
key
)
const_cast
<
char
*
>
(
value
)
&
errorCode
)
;
}
private
:
UHashtable
*
map
;
}
;
struct
LocaleDistanceData
{
LocaleDistanceData
(
)
=
default
;
LocaleDistanceData
(
LocaleDistanceData
&
&
data
)
;
~
LocaleDistanceData
(
)
;
const
uint8_t
*
distanceTrieBytes
=
nullptr
;
const
uint8_t
*
regionToPartitions
=
nullptr
;
const
char
*
*
partitions
=
nullptr
;
const
LSR
*
paradigms
=
nullptr
;
int32_t
paradigmsLength
=
0
;
const
int32_t
*
distances
=
nullptr
;
private
:
LocaleDistanceData
&
operator
=
(
const
LocaleDistanceData
&
)
=
delete
;
}
;
class
XLikelySubtags
final
:
public
UMemory
{
public
:
~
XLikelySubtags
(
)
;
static
constexpr
int32_t
SKIP_SCRIPT
=
1
;
static
const
XLikelySubtags
*
getSingleton
(
UErrorCode
&
errorCode
)
;
LSR
makeMaximizedLsrFrom
(
const
Locale
&
locale
UErrorCode
&
errorCode
)
const
;
#
if
0
LSR
minimizeSubtags
(
const
char
*
languageIn
const
char
*
scriptIn
const
char
*
regionIn
ULocale
.
Minimize
fieldToFavor
UErrorCode
&
errorCode
)
const
;
#
endif
const
LocaleDistanceData
&
getDistanceData
(
)
const
{
return
distanceData
;
}
private
:
XLikelySubtags
(
XLikelySubtagsData
&
data
)
;
XLikelySubtags
(
const
XLikelySubtags
&
other
)
=
delete
;
XLikelySubtags
&
operator
=
(
const
XLikelySubtags
&
other
)
=
delete
;
static
void
initLikelySubtags
(
UErrorCode
&
errorCode
)
;
LSR
makeMaximizedLsr
(
const
char
*
language
const
char
*
script
const
char
*
region
const
char
*
variant
UErrorCode
&
errorCode
)
const
;
LSR
maximize
(
const
char
*
language
const
char
*
script
const
char
*
region
)
const
;
static
int32_t
trieNext
(
BytesTrie
&
iter
const
char
*
s
int32_t
i
)
;
UResourceBundle
*
langInfoBundle
;
CharString
*
strings
;
CharStringMap
languageAliases
;
CharStringMap
regionAliases
;
BytesTrie
trie
;
uint64_t
trieUndState
;
uint64_t
trieUndZzzzState
;
int32_t
defaultLsrIndex
;
uint64_t
trieFirstLetterStates
[
26
]
;
const
LSR
*
lsrs
;
#
if
U_DEBUG
int32_t
lsrsLength
;
#
endif
LocaleDistanceData
distanceData
;
}
;
U_NAMESPACE_END
#
endif
