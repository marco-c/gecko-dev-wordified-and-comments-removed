#
include
"
OSPreferences
.
h
"
#
include
"
nsWin32Locale
.
h
"
using
namespace
mozilla
:
:
intl
;
bool
OSPreferences
:
:
ReadSystemLocales
(
nsTArray
<
nsCString
>
&
aLocaleList
)
{
MOZ_ASSERT
(
aLocaleList
.
IsEmpty
(
)
)
;
nsAutoString
locale
;
LCID
win_lcid
=
GetSystemDefaultLCID
(
)
;
nsWin32Locale
:
:
GetXPLocale
(
win_lcid
locale
)
;
NS_LossyConvertUTF16toASCII
loc
(
locale
)
;
if
(
CanonicalizeLanguageTag
(
loc
)
)
{
aLocaleList
.
AppendElement
(
loc
)
;
return
true
;
}
return
false
;
}
