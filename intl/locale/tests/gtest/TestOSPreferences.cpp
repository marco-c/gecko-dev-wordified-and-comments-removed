#
include
"
gtest
/
gtest
.
h
"
#
include
"
mozilla
/
ArrayUtils
.
h
"
#
include
"
mozilla
/
intl
/
OSPreferences
.
h
"
using
namespace
mozilla
:
:
intl
;
TEST
(
Intl_Locale_OSPreferences
GetSystemLocales
)
{
nsTArray
<
nsCString
>
systemLocales
;
ASSERT_TRUE
(
NS_SUCCEEDED
(
OSPreferences
:
:
GetInstance
(
)
-
>
GetSystemLocales
(
systemLocales
)
)
)
;
ASSERT_FALSE
(
systemLocales
.
IsEmpty
(
)
)
;
}
TEST
(
Intl_Locale_OSPreferences
GetRegionalPrefsLocales
)
{
nsTArray
<
nsCString
>
rgLocales
;
ASSERT_TRUE
(
NS_SUCCEEDED
(
OSPreferences
:
:
GetInstance
(
)
-
>
GetRegionalPrefsLocales
(
rgLocales
)
)
)
;
ASSERT_FALSE
(
rgLocales
.
IsEmpty
(
)
)
;
}
TEST
(
Intl_Locale_OSPreferences
GetDateTimePattern
)
{
nsAutoCString
pattern
;
OSPreferences
*
osprefs
=
OSPreferences
:
:
GetInstance
(
)
;
struct
Test
{
int
dateStyle
;
int
timeStyle
;
const
char
*
locale
;
}
;
Test
tests
[
]
=
{
{
0
0
"
"
}
{
1
0
"
pl
"
}
{
2
0
"
de
-
DE
"
}
{
3
0
"
fr
"
}
{
4
0
"
ar
"
}
{
0
1
"
"
}
{
0
2
"
it
"
}
{
0
3
"
"
}
{
0
4
"
ru
"
}
{
4
1
"
"
}
{
3
2
"
cs
"
}
{
2
3
"
"
}
{
1
4
"
ja
"
}
}
;
for
(
unsigned
i
=
0
;
i
<
mozilla
:
:
ArrayLength
(
tests
)
;
i
+
+
)
{
const
Test
&
t
=
tests
[
i
]
;
if
(
NS_SUCCEEDED
(
osprefs
-
>
GetDateTimePattern
(
t
.
dateStyle
t
.
timeStyle
nsDependentCString
(
t
.
locale
)
pattern
)
)
)
{
ASSERT_TRUE
(
(
t
.
dateStyle
=
=
0
&
&
t
.
timeStyle
=
=
0
)
|
|
!
pattern
.
IsEmpty
(
)
)
;
}
}
ASSERT_TRUE
(
1
)
;
}
