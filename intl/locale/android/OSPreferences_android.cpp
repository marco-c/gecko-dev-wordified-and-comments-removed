#
include
"
OSPreferences
.
h
"
#
include
"
mozilla
/
Preferences
.
h
"
#
include
"
FennecJNIWrappers
.
h
"
#
include
"
GeneratedJNIWrappers
.
h
"
using
namespace
mozilla
:
:
intl
;
OSPreferences
:
:
OSPreferences
(
)
{
}
OSPreferences
:
:
~
OSPreferences
(
)
{
}
bool
OSPreferences
:
:
ReadSystemLocales
(
nsTArray
<
nsCString
>
&
aLocaleList
)
{
if
(
!
mozilla
:
:
jni
:
:
IsAvailable
(
)
)
{
return
false
;
}
auto
locales
=
mozilla
:
:
jni
:
:
IsFennec
(
)
?
java
:
:
BrowserLocaleManager
:
:
GetLocales
(
)
:
java
:
:
GeckoAppShell
:
:
GetDefaultLocales
(
)
;
if
(
locales
)
{
for
(
size_t
i
=
0
;
i
<
locales
-
>
Length
(
)
;
i
+
+
)
{
jni
:
:
String
:
:
LocalRef
locale
=
locales
-
>
GetElement
(
i
)
;
aLocaleList
.
AppendElement
(
locale
-
>
ToCString
(
)
)
;
}
return
true
;
}
return
false
;
}
bool
OSPreferences
:
:
ReadRegionalPrefsLocales
(
nsTArray
<
nsCString
>
&
aLocaleList
)
{
return
ReadSystemLocales
(
aLocaleList
)
;
}
bool
OSPreferences
:
:
ReadDateTimePattern
(
DateTimeFormatStyle
aDateStyle
DateTimeFormatStyle
aTimeStyle
const
nsACString
&
aLocale
nsAString
&
aRetVal
)
{
return
false
;
}
