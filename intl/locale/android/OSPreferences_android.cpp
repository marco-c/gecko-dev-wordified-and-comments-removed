#
include
"
OSPreferences
.
h
"
#
include
"
mozilla
/
Preferences
.
h
"
#
include
"
mozilla
/
java
/
GeckoAppShellWrappers
.
h
"
using
namespace
mozilla
:
:
intl
;
OSPreferences
:
:
OSPreferences
(
)
{
}
bool
OSPreferences
:
:
ReadSystemLocales
(
nsTArray
<
nsCString
>
&
aLocaleList
)
{
if
(
!
mozilla
:
:
jni
:
:
IsAvailable
(
)
)
{
return
false
;
}
auto
locales
=
java
:
:
GeckoAppShell
:
:
GetDefaultLocales
(
)
;
if
(
locales
)
{
for
(
size_t
i
=
0
;
i
<
locales
-
>
Length
(
)
;
i
+
+
)
{
jni
:
:
String
:
:
LocalRef
locale
=
locales
-
>
GetElement
(
i
)
;
aLocaleList
.
AppendElement
(
locale
-
>
ToCString
(
)
)
;
}
return
true
;
}
return
false
;
}
bool
OSPreferences
:
:
ReadRegionalPrefsLocales
(
nsTArray
<
nsCString
>
&
aLocaleList
)
{
return
ReadSystemLocales
(
aLocaleList
)
;
}
bool
OSPreferences
:
:
ReadDateTimePattern
(
DateTimeFormatStyle
aDateStyle
DateTimeFormatStyle
aTimeStyle
const
nsACString
&
aLocale
nsACString
&
aRetVal
)
{
if
(
!
mozilla
:
:
jni
:
:
IsAvailable
(
)
)
{
return
false
;
}
nsAutoCString
skeleton
;
if
(
!
GetDateTimeSkeletonForStyle
(
aDateStyle
aTimeStyle
aLocale
skeleton
)
)
{
return
false
;
}
OverrideSkeletonHourCycle
(
java
:
:
GeckoAppShell
:
:
GetIs24HourFormat
(
)
skeleton
)
;
if
(
!
GetPatternForSkeleton
(
skeleton
aLocale
aRetVal
)
)
{
return
false
;
}
return
true
;
}
void
OSPreferences
:
:
RemoveObservers
(
)
{
}
