#
ifndef
mozilla_ReentrancyGuard_h
#
define
mozilla_ReentrancyGuard_h
#
include
"
mozilla
/
Assertions
.
h
"
#
include
"
mozilla
/
Attributes
.
h
"
namespace
mozilla
{
class
MOZ_RAII
ReentrancyGuard
{
#
ifdef
DEBUG
bool
&
mEntered
;
#
endif
public
:
template
<
class
T
>
#
ifdef
DEBUG
explicit
ReentrancyGuard
(
T
&
aObj
)
:
mEntered
(
aObj
.
mEntered
)
#
else
explicit
ReentrancyGuard
(
T
&
)
#
endif
{
#
ifdef
DEBUG
MOZ_ASSERT
(
!
mEntered
)
;
mEntered
=
true
;
#
endif
}
~
ReentrancyGuard
(
)
{
#
ifdef
DEBUG
mEntered
=
false
;
#
endif
}
private
:
ReentrancyGuard
(
const
ReentrancyGuard
&
)
=
delete
;
void
operator
=
(
const
ReentrancyGuard
&
)
=
delete
;
}
;
}
#
endif
