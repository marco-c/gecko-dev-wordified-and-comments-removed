#
ifndef
PlaceholderTransaction_h
#
define
PlaceholderTransaction_h
#
include
"
EditAggregateTransaction
.
h
"
#
include
"
mozilla
/
EditorUtils
.
h
"
#
include
"
mozilla
/
UniquePtr
.
h
"
#
include
"
nsIAbsorbingTransaction
.
h
"
#
include
"
nsIDOMNode
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsWeakPtr
.
h
"
#
include
"
nsWeakReference
.
h
"
namespace
mozilla
{
class
CompositionTransaction
;
class
PlaceholderTransaction
final
:
public
EditAggregateTransaction
public
nsIAbsorbingTransaction
public
nsSupportsWeakReference
{
public
:
NS_DECL_ISUPPORTS_INHERITED
PlaceholderTransaction
(
EditorBase
&
aEditorBase
nsIAtom
*
aName
UniquePtr
<
SelectionState
>
aSelState
)
;
NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED
(
PlaceholderTransaction
EditAggregateTransaction
)
NS_DECL_EDITTRANSACTIONBASE
NS_IMETHOD
RedoTransaction
(
)
override
;
NS_IMETHOD
Merge
(
nsITransaction
*
aTransaction
bool
*
aDidMerge
)
override
;
NS_IMETHOD
GetTxnName
(
nsIAtom
*
*
aName
)
override
;
NS_IMETHOD
StartSelectionEquals
(
SelectionState
*
aSelState
bool
*
aResult
)
override
;
NS_IMETHOD
EndPlaceHolderBatch
(
)
override
;
NS_IMETHOD
ForwardEndBatchTo
(
nsIAbsorbingTransaction
*
aForwardingAddress
)
override
;
NS_IMETHOD
Commit
(
)
override
;
nsresult
RememberEndingSelection
(
)
;
protected
:
virtual
~
PlaceholderTransaction
(
)
;
bool
mAbsorb
;
nsWeakPtr
mForwarding
;
mozilla
:
:
CompositionTransaction
*
mCompositionTransaction
;
bool
mCommitted
;
UniquePtr
<
SelectionState
>
mStartSel
;
SelectionState
mEndSel
;
EditorBase
&
mEditorBase
;
}
;
}
#
endif
