#
ifndef
InsertNodeTransaction_h
#
define
InsertNodeTransaction_h
#
include
"
EditTransactionBase
.
h
"
#
include
"
EditorDOMPoint
.
h
"
#
include
"
EditorForwards
.
h
"
#
include
"
nsCOMPtr
.
h
"
#
include
"
nsCycleCollectionParticipant
.
h
"
#
include
"
nsIContent
.
h
"
#
include
"
nsISupportsImpl
.
h
"
namespace
mozilla
{
class
EditorBase
;
class
InsertNodeTransaction
final
:
public
EditTransactionBase
{
protected
:
template
<
typename
PT
typename
CT
>
InsertNodeTransaction
(
EditorBase
&
aEditorBase
nsIContent
&
aContentToInsert
const
EditorDOMPointBase
<
PT
CT
>
&
aPointToInsert
)
;
public
:
template
<
typename
PT
typename
CT
>
static
already_AddRefed
<
InsertNodeTransaction
>
Create
(
EditorBase
&
aEditorBase
nsIContent
&
aContentToInsert
const
EditorDOMPointBase
<
PT
CT
>
&
aPointToInsert
)
;
NS_DECL_ISUPPORTS_INHERITED
NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED
(
InsertNodeTransaction
EditTransactionBase
)
NS_DECL_EDITTRANSACTIONBASE
NS_DECL_EDITTRANSACTIONBASE_GETASMETHODS_OVERRIDE
(
InsertNodeTransaction
)
MOZ_CAN_RUN_SCRIPT
NS_IMETHOD
RedoTransaction
(
)
override
;
template
<
typename
EditorDOMPointType
>
EditorDOMPointType
SuggestPointToPutCaret
(
)
const
{
if
(
MOZ_UNLIKELY
(
!
mPointToInsert
.
IsSet
(
)
|
|
!
mContentToInsert
)
)
{
return
EditorDOMPointType
(
)
;
}
return
EditorDOMPointType
:
:
After
(
mContentToInsert
)
;
}
friend
std
:
:
ostream
&
operator
<
<
(
std
:
:
ostream
&
aStream
const
InsertNodeTransaction
&
aTransaction
)
;
protected
:
virtual
~
InsertNodeTransaction
(
)
=
default
;
nsCOMPtr
<
nsIContent
>
mContentToInsert
;
EditorDOMPoint
mPointToInsert
;
RefPtr
<
EditorBase
>
mEditorBase
;
}
;
}
#
endif
