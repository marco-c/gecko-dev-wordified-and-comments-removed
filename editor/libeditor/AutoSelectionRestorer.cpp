#
include
"
AutoSelectionRestorer
.
h
"
namespace
mozilla
{
AutoSelectionRestorer
:
:
AutoSelectionRestorer
(
EditorBase
*
aEditor
)
{
if
(
!
aEditor
)
{
return
;
}
if
(
aEditor
-
>
ArePreservingSelection
(
)
)
{
return
;
}
MOZ_ASSERT
(
aEditor
-
>
IsEditActionDataAvailable
(
)
)
;
mEditor
=
aEditor
;
mEditor
-
>
PreserveSelectionAcrossActions
(
)
;
}
AutoSelectionRestorer
:
:
~
AutoSelectionRestorer
(
)
{
if
(
!
mEditor
|
|
!
mEditor
-
>
ArePreservingSelection
(
)
)
{
return
;
}
DebugOnly
<
nsresult
>
rvIgnored
=
mEditor
-
>
RestorePreservedSelection
(
)
;
NS_WARNING_ASSERTION
(
NS_SUCCEEDED
(
rvIgnored
)
"
EditorBase
:
:
RestorePreservedSelection
(
)
failed
but
ignored
"
)
;
}
void
AutoSelectionRestorer
:
:
Abort
(
)
{
if
(
mEditor
)
{
mEditor
-
>
StopPreservingSelection
(
)
;
}
}
}
